(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4abce85e"],{"256d":function(e,t,a){"use strict";var n=a("f317"),r=a.n(n);r.a},"3e9f":function(e,t,a){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var n=a("1d80"),r=a("5899"),o="["+r+"]",i=RegExp("^"+o+o+"*"),l=RegExp(o+o+"*$"),s=function(e){return function(t){var a=String(n(t));return 1&e&&(a=a.replace(i,"")),2&e&&(a=a.replace(l,"")),a}};e.exports={start:s(1),end:s(2),trim:s(3)}},"5b8e":function(e,t,a){"use strict";var n=a("9678"),r=a.n(n);r.a},7132:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},r=[],o={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},i=o,l=(a("5b8e"),a("2877")),s=Object(l["a"])(i,n,r,!1,null,null,null),c=s.exports,d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},u=[],f=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),h=f,p=(a("d4c2"),Object(l["a"])(h,d,u,!1,null,null,null)),m=p.exports;a.d(t,"a",(function(){return m}))},8024:function(e,t,a){"use strict";var n=a("e039"),r=a.n(n);r.a},"81d5":function(e,t,a){"use strict";var n=a("7b0b"),r=a("23cb"),o=a("50c4");e.exports=function(e){var t=n(this),a=o(t.length),i=arguments.length,l=r(i>1?arguments[1]:void 0,a),s=i>2?arguments[2]:void 0,c=void 0===s?a:r(s,a);while(c>l)t[l++]=e;return t}},9678:function(e,t,a){},a5dc:function(e,t,a){"use strict";var n=a("3e9f"),r=a.n(n);r.a},a9e3:function(e,t,a){"use strict";var n=a("83ab"),r=a("da84"),o=a("94ca"),i=a("6eeb"),l=a("5135"),s=a("c6b6"),c=a("7156"),d=a("c04e"),u=a("d039"),f=a("7c73"),h=a("241c").f,p=a("06cf").f,m=a("9bf2").f,g=a("58a8").trim,b="Number",v=r[b],y=v.prototype,w=s(f(y))==b,N=function(e){var t,a,n,r,o,i,l,s,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+c}for(o=c.slice(2),i=o.length,l=0;l<i;l++)if(s=o.charCodeAt(l),s<48||s>r)return NaN;return parseInt(o,n)}return+c};if(o(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var k,x=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof x&&(w?u((function(){y.valueOf.call(a)})):s(a)!=b)?c(new v(N(t)),a,x):N(t)},M=n?h(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;M.length>S;S++)l(v,k=M[S])&&!l(x,k)&&m(x,k,p(v,k));x.prototype=y,y.constructor=x,i(r,b,x)}},aa0f:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"agent-mgmt"},[a("biz-header",{attrs:{slot:"top",operations:e.operations,filters:e.filters},on:{operate:e.handleOperate,"filter-data-change":e.handleFilterDataChange},slot:"top"}),a("expand-table",{ref:"expandTable",staticStyle:{height:"95%","min-height":"95%"},attrs:{data:e.tableData,loading:e.loading,isSearch:e.isSearch},on:{"expand-change":e.expandChange,delete:e.handleDeleteClick,"row-click":e.handleRowClick,handleAdmin:e.handleAdmin,handleAgent:e.handleAgent}}),a("biz-pagination",{attrs:{pagination:e.pagination}}),a("div",{attrs:{slot:"float"},slot:"float"},[a("biz-popup-tabs",{attrs:{open:e.open},on:{close:function(t){e.open=!1}},model:{value:e.tabSection,callback:function(t){e.tabSection=t},expression:"tabSection"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"baseinfo"}},[a("robot-function-base-info",{attrs:{itemId:e.itemId,row:e.row,parentId:e.parentId,parentName:e.parentName,grade:e.grade},on:{operationSuccess:e.handleOperationSuccess}})],1)],1)],1)],1)},r=[],o=(a("4160"),a("b0c0"),a("a9e3"),a("d3b7"),a("159b"),a("5530")),i=a("b85c"),l=a("f36f"),s=a("04d3"),c=a("7132"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"agent-mgmt__base-info"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"上级功能",prop:"parentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formModel.parentName,callback:function(t){e.$set(e.formModel,"parentName",t)},expression:"formModel.parentName"}})],1),a("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入门店名称"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{staticClass:"isRequired",attrs:{label:"关键字",prop:"keyWords"}},[a("div",{staticClass:"add-tag"},[a("el-input",{attrs:{maxlength:18,placeholder:"请输入自定义关键字"},model:{value:e.newMarketTagName,callback:function(t){e.newMarketTagName=t},expression:"newMarketTagName"}}),a("el-button",{attrs:{type:"primary"},on:{click:e.addRecommendMarketTagByButton}},[e._v("添加")])],1),a("div",{staticClass:"tag-group"},e._l(e.tags,(function(t,n){return a("el-tag",{key:n,attrs:{closable:"",size:"mini"},on:{close:function(a){return e.removeMarketTag(t)}}},[e._v(" "+e._s(t))])})),1)]),a("el-form-item",{attrs:{label:"启用",prop:"state"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#ff7300","inactive-color":"#d9d9d9"},model:{value:e.formModel.valiable,callback:function(t){e.$set(e.formModel,"valiable",t)},expression:"formModel.valiable"}})],1)],1)],1)},u=[],f=(a("99af"),a("a15b"),a("fb6a"),a("ac1f"),a("1276"),a("ddb0"),a("8330")),h=a("1ab1"),p=a("2f62"),m={operations:[{label:"保存",name:"save",type:"primary",auth:""}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},newMarketTagName:"",tags:[]},g=function(){return{id:"",parentId:"",parentName:"",grade:"",name:"",keys:"",valiable:"1"}},b={data:{loading:!1,formModel:g()},events:{handleOperate:function(e){this[e]()}},methods:{initModel:function(e){e?(e.parentName=this.parentName,this.formModel=Object.assign(this.getDefaultModel(),e),"0"===e.grade?this.formModel.grade="一级":"1"===e.grade?this.formModel.grade="二级":this.formModel.grade="三级"):(this.resetModel(),this.formModel.parentId=this.parentId,this.formModel.parentName=this.parentName,this.formModel.grade=String(Number(this.grade)+1),"0"===this.formModel.grade?this.formModel.grade="一级":"1"===this.formModel.grade?this.formModel.grade="二级":this.formModel.grade="三级"),this.$refs.form.resetFields(),this.tags=this.formModel.keys?this.formModel.keys.split(","):[]},addRecommendMarketTagByButton:function(e){if(""!==this.newMarketTagName){e=this.newMarketTagName;var t,a=Object(i["a"])(this.tags);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n===e)return void this.$message.warning("该标签已存在，请重新添加")}}catch(r){a.e(r)}finally{a.f()}this.tags.push(e),this.newMarketTagName=""}else this.$message.warning("请输入自定义关键字")},removeMarketTag:function(e){for(var t=0;t<this.tags.length;t++){var a=this.tags[t];if(a===e)break}this.tags=this.tags.slice(0,t).concat(this.tags.slice(t+1))},query:function(){this.initModel(this.row)},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return g()},getSaveParams:function(){var e=this.tags.join(",");return{id:this.formModel.id,parentId:this.parentId,grade:this.grade,name:this.formModel.name,keys:e,valiable:this.formModel.valiable}},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0;var n=function(t){e.$message.success("保存成功"),e.formModel.id||(e.formModel.id=t.id),e.$emit("operationSuccess",e.formModel.id)},r=function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)},o=function(t){e.loading=!1};e.formModel.id?h["a"].put("/admin/reception/receptionBusseniessFunction.jhtml",e.getSaveParams()).then(n).catch(r).finally(o):h["a"].post("/admin/reception/receptionBusseniessFunction.jhtml",e.getSaveParams()).then(n).catch(r).finally(o)}))}}},v={name:"AgentBaseInfo",components:{BizSaveButton:f["a"],BizGrid:l["a"]},data:function(){return Object(o["a"])(Object(o["a"])(Object(o["a"])({},m),b.data),{},{rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],phone:[{required:!0,message:"电话不能少于5位,不能大于11位",trigger:"blur",min:5,max:11},{pattern:/^[-0-9]*$/,message:"请输入数字",trigger:"blur"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}},row:{type:Object,default:function(){return{}}},parentId:{type:String,default:function(){return""}},parentName:{type:String},grade:{type:String}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(p["c"])(["getUser"])),b.methods),b.events),watch:{itemId:function(e,t){e.id?this.query():this.initModel()}},created:function(){}},y=v,w=(a("a5dc"),a("2877")),N=Object(w["a"])(y,d,u,!1,null,null,null),k=N.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"expandTable",staticClass:"expand-table",staticStyle:{width:"100%","min-height":"100%"},attrs:{size:"small","tooltip-effect":"dark","row-key":"id",height:"auto",border:e.showBorder,data:e.data,"show-header":e.showHeader,rowClassName:e.setClassName,"cell-class-name":e.cellClassName,"expand-row-keys":e.expandedRowKeys},on:{"expand-change":e.expandChangeHandler,"row-click":e.rowClickHandler}},[e.isSearch?a("el-table-column",{attrs:{type:"expand",label:e.maxLevel,width:"100","class-name":"1"===e.hasChild?"cell"+e.layer:"cell0"+e.layer},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.subList.length>0?a("expand-table",{staticClass:"expand-table-child",attrs:{height:"auto",hasChild:t.row.hasChild,layer:e.layer+1,data:t.row.subList,"show-header":!1,"show-border":!1,"expand-row-keys":e.expandedRowKeys},on:{delete:e.handleDeleteClick,"expand-change":e.expandChangeHandler,"row-click":e.rowClickHandler}}):e._e()]}}],null,!1,2632119594)}):e._e(),a("el-table-column",{attrs:{label:"功能名称",prop:"name","class-name":"first-name"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),a("el-table-column",{attrs:{label:"关键字",prop:"address"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(""!==t.row.keys?t.row.keys:"--"))]}}])}),a("el-table-column",{attrs:{label:"启用",prop:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("1"===t.row.valiable?"√":"X"))]}}])}),a("el-table-column",{attrs:{prop:"tag",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleAgent(a,t.row)}}},[e._v("添加功能")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDeleteClick(a,t.row)}}},[e._v("删除")])]}}])})],1)},M=[],S=(a("cb29"),a("caad"),a("2532"),{name:"ExpandTable",filters:{},props:{showHeader:{type:Boolean,default:!0},isSearch:{type:Boolean,default:!0},hasChild:{type:String,default:"1"},data:{type:Array,default:function(){return[]}},height:{type:String,default:"100%"},loading:{type:Boolean,default:!1},showBorder:{type:Boolean,default:!0},layer:{type:Number,default:0},expandedRowKeys:{type:Array,default:function(){return[]}}},data:function(){return{maxLevel:"1",currentLevel:1,className:""}},components:{},computed:Object(o["a"])(Object(o["a"])({},Object(p["c"])("Authority",["currentAuth"])),{},{hasAuthAdmin:function(){return this.currentAuth.includes("admin:agent.usermanage")},hasAuthDel:function(){return this.currentAuth.includes("admin:agent.delete")},hasAuthAdd:function(){return this.currentAuth.includes("admin:agent.add")}}),watch:{},mounted:function(){var e=document.documentElement.clientHeight||window.innerHeight,t=String(e-205);document.querySelectorAll(".el-table__body-wrapper")[0].style.height=t+"px",document.querySelectorAll(".el-table__body-wrapper")[0].style.overflowX="hidden",document.querySelectorAll(".el-table__body-wrapper")[0].style.overflowY="auto"},updated:function(){this.doLayout()},methods:{setClassName:function(e){var t=e.row;e.index;return t.hasChild>0?"expand":"noexpand"},cellClassName:function(e){var t=e.row;e.column,e.rowIndex,e.columnIndex;return"row"+t.id},doLayout:function(){document.querySelectorAll(".expand-table-child .el-table__body-wrapper").forEach((function(e){e.style.height="auto"})),document.querySelectorAll(".el-table__expand-icon").forEach((function(e){e.children[0].className="iconfont biz-icon-i-web-zk1"}))},handleAgent:function(e,t){this.$emit("handleAgent",e,t)},formatTreeLayer:function(e,t){var a=[];return t&&(a.push(new Array(t).fill("|").join(" ")),a.push("--")),a.push(e),a.join("")},expandChangeHandler:function(e,t){this.doLayout(),this.className&&this.className.split(".")[1]!=="row"+e.id&&(document.querySelector(this.className).children[0].children[0].style.color="#666666"),this.className=".row"+e.id,document.querySelector(this.className).children[0].children[0].style.color="#ff7300";var a=[];console.log("this.currentLevel"+this.currentLevel),console.log("row.grade"+this.currentLevel),t&&t.length>0?this.currentLevel=Number(e.grade)+1:this.currentLevel=Number(e.grade);for(var n=0;n<=this.currentLevel;n++)a.push(n+1);this.maxLevel=a.join(" "),console.log(this.$refs.expandTable),this.$emit("expand-change",e,t)},rowClickHandler:function(e){this.$emit("row-click",e)},handleDeleteClick:function(e,t){this.$emit("delete",e,t)}}}),I=S,_=(a("256d"),Object(w["a"])(I,x,M,!1,null,null,null)),C=_.exports,O={stepkey:"",t:"",percentage:0,disabled:!1,count:0,total:0,tagCatrgoryId:"",importResult:[],importLoading:!1,successCount:0,failCount:0,itemId:{id:""},row:{},parentId:"",parentName:"",grade:"",selections:[],open:!1,openPlatform:!1},A={loading:!1,tableData:[],isSearch:!0,currentRow:{},tabName:"1",pagination:{pageSize:1e3,pageSizes:[1e3],currentPage:1,total:9},tabSection:"baseinfo",operations:[{label:"新增",name:"add",type:"primary"},{label:"刷新",name:"refresh",type:""}],filters:[{type:"input",label:"",placeholder:"请输入功能名称",name:"searchValue",value:""}]},$={expandChange:function(e){this.currentRow=e,this.query(e)},getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",cooperationType:"1",searchValue:this.filters[0].value,state:""}},download:function(){window.open("/upload/mode/V服爱车_代理商导入模板.xlsx")},clearTimeOut:function(){window.clearTimeout(this.t)},restProcess:function(){this.total=0,this.count=0,this.stepkey="",this.percentage=0},handleImport:function(){var e=this,t="/admin/cooperationInfo/agent/importProgress.jhtml";h["a"].get(t,{}).then((function(t){t.data.total||(e.total=0,e.count=0,e.stepkey="",e.percentage=0),t.data.total&&(e.total=Number(t.data.total||0),e.count=Number(t.data.count||0),e.stepkey=t.data.remark,e.percentage=Number(t.data.rate),e.$refs.importFile.title=t.data.title),t.data&&t.data.rate&&"100"===t.data.rate?(e.clearTimeOut(),e.$refs.importFile.showCurrentInfo=!1,e.$refs.importFile.title="导入完成",e.$refs.importFile.uploadingVisible=!0,t.data&&t.data.results&&t.data.results.length>0&&(e.importResult=t.data.results,e.$refs.importFile.uploadingVisible=!1,e.$refs.importFile.importingVisible=!0,e.getList())):t.data&&t.data.rate&&"100"!==t.data.rate&&(e.t&&e.clearTimeOut(),e.t=setTimeout(e.handleImport,2e3),e.$refs.importFile.uploadingVisible=!0,e.$refs.importFile.showCurrentInfo=!0,e.disabled=!0)})).catch((function(e){console.log(e),console.log("code错误")}))},query:function(){var e=this;this.loading=!0,h["a"].get("/admin/reception/receptionBusseniessFunction.jhtml",this.getQueryParams()).then((function(t){e.loading=!1,e.tableData=t.data;var a,n=Object(i["a"])(e.tableData);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(r.subList.length>0){r.hasChild="1";var o,l=Object(i["a"])(r.subList);try{for(l.s();!(o=l.n()).done;){var s=o.value;if(s.parentName=r.name,s.subList.length>0){s.hasChild="1";var c,d=Object(i["a"])(s.subList);try{for(d.s();!(c=d.n()).done;){var u=c.value;u.parentName=s.name}}catch(f){d.e(f)}finally{d.f()}}}}catch(f){l.e(f)}finally{l.f()}}}}catch(f){n.e(f)}finally{n.f()}e.pagination.total=Number(t.data.length)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},refresh:function(){this.query()},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,h["a"].delete("/admin/reception/receptionBusseniessFunction.jhtml",{id:e[0]}).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")},add:function(){this.itemId={id:""},this.row={},this.tabName="1",this.open=!0}},j={handleOperationSuccess:function(e){this.itemId={id:String(e)},this.query()},handleOperate:function(e){this[e]()},handleFilterDataChange:function(){this.query()},handleRowClick:function(e,t,a){this.itemId={id:String(e.id)},this.row=e,this.parentId=e.parentId,this.parentName=e.parentName,this.grade=e.grade,this.tabSection="baseinfo",this.open=!0},handleDeleteClick:function(e,t){e.stopPropagation(),this.deleteItem([t.id])},handleAdmin:function(e,t){this.$router.push({path:this.$route.fullPath+"/admin-setting",query:{cooperationId:t.id}})},handleAgent:function(e,t){this.itemId={id:""},this.row={},this.parentId=t.id,this.parentName=t.name,this.grade=t.grade,this.tabName="baseinfo",this.open=!0}},T={name:"AgentMgmt",components:{BizHeader:s["d"],BizGrid:l["a"],BizPopupTabs:c["a"],RobotFunctionBaseInfo:k,ExpandTable:C,BizPagination:s["f"]},props:{},data:function(){return Object(o["a"])(Object(o["a"])({},O),A)},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(p["c"])(["getUser"])),$),j),created:function(){this.query()}},B=T,z=(a("8024"),Object(w["a"])(B,n,r,!1,null,null,null));t["default"]=z.exports},cb29:function(e,t,a){var n=a("23e7"),r=a("81d5"),o=a("44d2");n({target:"Array",proto:!0},{fill:r}),o("fill")},d4c2:function(e,t,a){"use strict";var n=a("e725"),r=a.n(n);r.a},e039:function(e,t,a){},e725:function(e,t,a){},f317:function(e,t,a){}}]);