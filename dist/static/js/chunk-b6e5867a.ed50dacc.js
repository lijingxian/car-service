(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b6e5867a"],{2497:function(e,t,a){"use strict";var n=a("4360"),i=a("a18c");t["a"]=function(e,t){return function(a){var l=a.data;"100"===l.resultCode?e(l):"709"===l.resultCode?(n["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",n["a"].getters.currentUser),i["a"].push("/login")):t(l)}}},"339f":function(e,t,a){},4292:function(e,t,a){"use strict";var n=a("66d2"),i=a.n(n);i.a},"5c40":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-pagination"},[a("el-pagination",{attrs:{"page-sizes":e.pageSizes,"page-size":e.pagination.pageSize,total:e.pagination.total,"current-page":e.pagination.currentPage,"pager-count":e.pagination.pagerCount||7,layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},i=[],l={name:"BizPagination",props:{pagination:{type:Object,required:!0}},data:function(){return{pageSizes:[10,20,50,100],pageSize:20}},methods:{handleSizeChange:function(e){this.$emit("handleSizeChange",e),this.$emit("size-change",e)},handleCurrentChange:function(e){this.$emit("handleCurrentChange",e),this.$emit("current-change",e)},initData:function(){this.pageSizes=this.pagination.pageSizes||[10,20,50,100],this.pageSize=this.pagination.pageSize||20}},watch:{pagination:function(e){e.pageSizes&&this.initData()}},created:function(){this.initData()}},s=l,r=(a("ea5e"),a("2877")),o=Object(r["a"])(s,n,i,!1,null,null,null);t["a"]=o.exports},"66d2":function(e,t,a){},"7e5b":function(e,t,a){"use strict";a("d81d"),a("ac1f"),a("841c");var n=a("2497"),i=a("bc3a"),l=a.n(i),s=a("c596");t["a"]={getNavInfo:function(e,t,a){l.a.get(s["g"].federationMgmt.nav,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},list:function(e,t,a){l.a.get(s["g"].federationMgmt.List_storeOrOperator,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},listMap:function(e,t,a){l.a.get(s["g"].federationMgmt.List_storeOrOperator_Map,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},parentCompanyAndStore:function(e,t,a){l.a.get(s["g"].federationMgmt.parentCompanyAndStore,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},query:function(e,t,a){l.a.get(s["g"].federationMgmt.storeOrOperatorInfo,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},update:function(e,t,a){l.a.put(s["g"].federationMgmt.storeOrOperatorInfo,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},add:function(e,t,a){l.a.post(s["g"].federationMgmt.storeOrOperatorInfo,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},active:function(e,t,a){l.a.get(s["g"].federationMgmt.opera,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},updateOperator:function(e,t,a){l.a.put(s["g"].federationMgmt.operator,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},addOperator:function(e,t,a){l.a.post(s["g"].federationMgmt.operator,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){l.a.delete(s["g"].federationMgmt.storeOrOperatorInfo,{data:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryIntroduce:function(e,t,a){l.a.get(s["g"].federationMgmt.introduce,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},listAdditiveStore:function(e,t,a){l.a.get(s["g"].federationMgmt.listAdditiveStore,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},updateIntroduce:function(e,t,a){l.a.post(s["g"].federationMgmt.introduce,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getPayments:function(e,t,a){function i(e){return console.log(e),e.content.map((function(e){return e}))}l.a.get(s["g"].federationMgmt.paymentMethodShopList,{params:{shopId:e.shopId||""}}).then(Object(n["a"])(t,a,i)).catch((function(e){console.error(e)}))},editPayments:function(e,t,a){function i(e){return e}var r=new FormData;r.append("paymentMethods",JSON.stringify(e)),l.a.post(s["g"].federationMgmt.updatePaymentShopMethods,r,{}).then(Object(n["a"])(t,a,i)).catch((function(e){console.error(e)}))},getVrAsset:function(e,t,a){l.a.get(s["g"].federationMgmt.search,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},uploadShopPictures:function(e,t,a){var i={medialist:e.vrlist},r={shopId:e.shopId,vrlist:JSON.stringify(i)};l.a.post(s["g"].federationMgmt.uploadPictures,r).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},uploadShopZip:function(e,t,a){var i=this,r=new FormData;r.append("shopId",e.shopId),r.append("multipartFile",e.file),l.a.post(s["g"].federationMgmt.uploadZip,r,{timeout:9e6,progress:function(e){i.vr_data=~~(100*e.loaded/e.total)}}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryKpi:function(e,t,a){l.a.get(s["g"].federationMgmt.statisticsAnalysis,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))}}},8027:function(e,t,a){},"8c35":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-table-filter"},e._l(e.filters,(function(t,n){return a("div",{key:n,staticClass:"filter-wrap"},[a("label",{staticClass:"filter-label",class:t.class},[e._v(e._s(t.label))]),"select"===t.type?a("div",{staticClass:"biz-select",class:t.class},[a("el-select",{attrs:{size:"mini",filterable:t.filterable,multiple:t.multiple,"collapse-tags":t.collapseTags,disabled:t.disabled||!1},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"cascader"===t.type?a("div",{staticClass:"biz-cascader",class:t.class},[a("el-cascader",{attrs:{filterable:t.filterable,"change-on-select":!!t.changeOnSelect&&t.changeOnSelect,placeholder:"全部",size:"mini","show-all-levels":!!t.showAllLevels&&t.showAllLevels,props:e.cascaderProps,value:t.value,options:t.options,clearable:!0},on:{change:e.handleCascaderChange,"active-item-change":e.activeItemChange}})],1):e._e(),"switch"===t.type?a("div",{staticClass:"biz-switch",class:t.class},[a("el-switch",{attrs:{size:"mini","active-text":t.activeText,"active-value":t.activeValue,"inactive-text":t.inactiveText,"inactive-value":t.inactiveValue},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"input"===t.type?a("div",{staticClass:"biz-input",class:t.class},[a("el-input",{attrs:{size:"mini",placeholder:t.placeholder},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.inputSearch(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}},[e._l(t.select,(function(t){return a("el-select",{key:t.index,attrs:{slot:"prepend"},on:{change:e.inputOptionChange},slot:"prepend",model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"select.value"}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.inputSearch},slot:"append"})],2)],1):e._e(),"inputValue"===t.type?a("div",{staticClass:"biz-input",class:t.class},[a("el-input",{attrs:{size:"mini",placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"year"===t.type?a("div",{staticClass:"biz-year",class:t.class},[a("el-date-picker",{attrs:{size:"mini",align:"right",type:"year",clearable:!1!==t.clearable,"value-format":"yyyy",placeholder:"选择年"},on:{change:function(a){return e.dateChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"date"===t.type?a("div",{staticClass:"biz-date",class:t.class},[a("el-date-picker",{attrs:{"unlink-panels":"","start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,clearable:!1!==t.clearable,size:"mini","value-format":"yyyy-MM-dd",type:"date","range-separator":"至"},on:{change:function(a){return e.dateChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"daterange"===t.type?a("div",{staticClass:"biz-date-range",class:t.class},[a("el-date-picker",{attrs:{"unlink-panels":"","start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,clearable:!1!==t.clearable,size:"mini","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至"},on:{change:function(a){return e.dateRangeChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"datetimerange"===t.type?a("div",{staticClass:"biz-date-time-range",class:t.class},[a("el-date-picker",{attrs:{"start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,clearable:!1!==t.clearable,"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange",size:"mini","range-separator":"至"},on:{change:function(a){return e.dateRangeChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"timerange"===t.type?a("div",{staticClass:"biz-time-range",class:t.class},[a("el-time-picker",{attrs:{"is-range":"","start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,clearable:!1!==t.clearable,placeholder:"选择时间范围","value-format":"HH:mm:ss",size:"mini"},on:{change:function(a){return e.dateRangeChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"inputrange"===t.type?a("div",{staticClass:"biz-input-range",class:t.class},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"",size:"mini"},model:{value:t.value1,callback:function(a){e.$set(t,"value1",e._n(a))},expression:"filter.value1"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.selectValue,callback:function(a){e.$set(t,"selectValue",a)},expression:"filter.selectValue"}},e._l(t.selectOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("div",{staticClass:"last-slot",attrs:{slot:"append"},slot:"append"},[a("span",{staticClass:"range"},[e._v("-")]),a("el-input",{attrs:{placeholder:"","controls-position":"right"},model:{value:t.value2,callback:function(a){e.$set(t,"value2",e._n(a))},expression:"filter.value2"}})],1)],1)],1):e._e(),"single"===t.type?a("div",{class:t.class},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(a){return e.indicatorChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}},e._l(t.options,(function(t){return a("el-radio-button",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e(),"radio"===t.type?a("div",{class:t.class},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(a){return e.indicatorChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}},e._l(t.options,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e()])})),0)},i=[],l=(a("c975"),a("d81d"),a("b85c")),s={name:"BizFilter",data:function(){return{daterange:{Clearable:!1},cascaderProps:{label:"label",value:"value",children:"children"}}},props:{filters:{type:Array,default:function(){return[]}}},computed:{watchFilters:function(){var e,t=[],a=Object(l["a"])(this.filters);try{for(a.s();!(e=a.n()).done;){var n=e.value;"input"!==n.type&&-1===["year","date","daterange","datetimerange","timerange","cascader"].indexOf(n.type)&&("select"===n.type||"single"===n.type?t.push({value:n.value}):t.push(n))}}catch(i){a.e(i)}finally{a.f()}return t}},watch:{watchFilters:{handler:function(){this.filters.map((function(e){})),this.$emit("filterDataChange",this.filters)},deep:!0,immediate:!1}},methods:{handleCascaderChange:function(e){this.$emit("cascader-change",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},inputOptionChange:function(e){this.$emit("input-option-change",this.filters)},inputSearch:function(){this.$emit("filterDataChange",this.filters)},indicatorChanged:function(e,t){this.$emit("indicatorDataChange",this.filters)},dateRangeChanged:function(e,t){var a=this;null===e?this.$nextTick((function(){t.value=[],a.$emit("filterDataChange",a.filters)})):this.$emit("filterDataChange",this.filters)},dateChanged:function(e,t){var a=this;null===e?this.$nextTick((function(){t.value="",a.$emit("filterDataChange",a.filters)})):this.$emit("filterDataChange",this.filters)}}},r=s,o=(a("4292"),a("2877")),c=Object(o["a"])(r,n,i,!1,null,null,null);t["a"]=c.exports},d02a:function(e,t,a){"use strict";var n=a("8027"),i=a.n(n);i.a},d3a2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"federation-statistics-analysis"},[a("biz-chart",{attrs:{chartData:e.chartData,filters:e.filters,loading:e.loading,showSearch:!1},on:{filterDataChange:e.filterDataChange}})],1)},i=[],l=(a("99af"),a("fb6a"),a("ade3")),s=a("562e"),r=a("7e5b"),o={name:"CouponKpiReport",data:function(){return{today:"",loading:!0,filters:[{type:"select",label:"查看类型",value:"month",options:[{value:"day",label:"按日"},{value:"month",label:"按月"}]},{type:"select",label:"统计指标",value:"total",options:[{value:"total",label:"运营商累计数"},{value:"increase",label:"运营商新增数"}]},{type:"daterange",label:"日期区间：",value:["2011-11-11","2012-12-12"]}],chartData:{}}},methods:{init:function(){var e=this,t=new Date(this.filters[2].value[0]),a=new Date(this.filters[2].value[1]);if("month"===this.filters[0].value&&t.getFullYear()===a.getFullYear()&&t.getMonth()===a.getMonth())return this.$message({message:"按月查询时起止时间请选择不同月份",showClose:!0,type:"warning"}),void(this.filters[0].value="day");if(this.filters[2].value[0]>this.today||this.filters[2].value[1]>this.today)return this.$message.warning({message:"不能选择将来的时间",showClose:!0}),this.filters[0].value="month",void this.getFormatDate();this.loading=!0;var n={kpiCategory:"company",dateType:this.filters[0].value,kpiType:this.filters[1].value,beginDate:this.filters[2].value[0],endDate:this.filters[2].value[1]};r["a"].queryKpi(n,(function(t){e.loading=!1,e.chartData=e.dataFormat(t)}),(function(t){e.loading=!1,"779"===t.resultCode&&(e.filters[0].value="month"),e.$message({showClose:!0,message:t.errorMessage,type:"danger"}),console.log("ERR_INIT: ",t)}))},filterDataChange:function(e){this.filters=e,this.init()},dataFormat:function(e){for(var t=[],a=0;a<e.histogram.length;a++){var n;t.push((n={"日期":"day"===this.filters[0].value?e.histogram[a].xValue.slice(5,10):e.histogram[a].xValue},Object(l["a"])(n,this.kpiName[0],e.histogram[a].yValue),Object(l["a"])(n,this.kpiName[1],0===e.lineChat.length?"":"0"===e.lineChat[a].yValue?"0":e.lineChat[a].yValue/100),n))}var i={type:"histogram",data:{columns:["日期",this.kpiName[0],this.kpiName[1]],rows:t},settings:{metrics:[this.kpiName[0],0===e.lineChat.length?"":this.kpiName[1]],showLine:this.kpiName[1],yAxisType:["normal","percent"],yAxisName:[this.kpiName[0],0===e.lineChat.length?"":this.kpiName[1]]}};return 0!==e.lineChat.length&&(i.settings.axisSite={right:[this.kpiName[1]]}),i},getFormatDate:function(){var e=new Date;this.filters[2].value[1]="".concat(e.getFullYear(),"-").concat(e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,"-").concat(e.getDate()<10?"0"+e.getDate():e.getDate()),this.today=this.filters[2].value[1];var t=function(){var e=new Date;return e.setMonth(e.getMonth()-6),"".concat(e.getFullYear(),"-").concat(e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,"-").concat(e.getDate()<10?"0"+e.getDate():e.getDate())};this.filters[2].value[0]=t()}},computed:{kpiName:function(){return"total"===this.filters[1].value?["  运营商累计数","增长率"]:"increase"===this.filters[1].value?["  运营商新增数","留存率"]:[]}},created:function(){this.getFormatDate(),this.init()},components:{BizChart:s["a"]}},c=o,u=(a("d02a"),a("2877")),h=Object(u["a"])(c,n,i,!1,null,null,null);t["default"]=h.exports},ea5e:function(e,t,a){"use strict";var n=a("339f"),i=a.n(n);i.a}}]);