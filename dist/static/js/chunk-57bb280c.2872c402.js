(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57bb280c"],{"1fe5":function(e,t,i){},"2b9a":function(e,t,i){},"3e77":function(e,t,i){"use strict";var s=i("888f"),r=i.n(s);r.a},"443b":function(e,t,i){"use strict";i("4de4");var s=i("c596"),r=i("1ab1"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{"append-to-body":"",visible:e.visible,title:"自定义列","custom-class":"biz-columns",width:"500px"},on:{close:e.onClose}},[i("div",{staticClass:"columns-wrap"},[i("biz-flex-table",{ref:"table",attrs:{checkable:!1,tableData:e.tableData},on:{"selection-change":e.selectionChangeHandler}},[i("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.getSelectable}}),i("el-table-column",{attrs:{label:"信息",prop:"name"}}),i("el-table-column",{attrs:{prop:"tag",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.$index;return[i("el-button",{attrs:{icon:"el-icon-sort-up",type:"text",disabled:0===s},on:{click:function(t){return e.onUp(s)}}}),i("el-button",{attrs:{icon:"el-icon-sort-down",type:"text",disabled:s===e.tableData.length-1},on:{click:function(t){return e.onBottom(s)}}})]}}])})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.onClose}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)])},a=[],n=(i("7db0"),i("a434"),i("b85c")),l=i("04d3"),c={name:"biz-columns",components:{BizFlexTable:l["c"]},props:{visible:Boolean,tableId:String},data:function(){return{id:"",tableName:"",selections:[],tableData:[]}},computed:{},watch:{visible:function(e){e?this.makeRowDisplayable():this.saveSelection()},tableId:function(){this.getTableColumns()}},mounted:function(){this.getTableColumns()},methods:{getTableColumns:function(){var e=this;r["a"].get(s["g"].user.columns,{tableId:this.tableId}).then((function(t){e.tableData=t.data.columnDatas,e.id=t.data.id,e.tableName=t.data.tableName}))},getSelectable:function(e){return e.isEditable},selectionChangeHandler:function(e){this.selections=e},saveSelection:function(){var e,t=this,i=Object(n["a"])(this.tableData);try{for(i.s();!(e=i.n()).done;){var s=e.value;s.displayable=!1}}catch(l){i.e(l)}finally{i.f()}var r,o=Object(n["a"])(this.selections);try{var a=function(){var e=r.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(o.s();!(r=o.n()).done;)a()}catch(l){o.e(l)}finally{o.f()}},onUp:function(e){this.tableData[e]=this.tableData.splice(e-1,1,this.tableData[e])[0]},onBottom:function(e){this.tableData[e]=this.tableData.splice(e+1,1,this.tableData[e])[0]},onClose:function(){this.$emit("update:visible",!1)},update:function(){var e,t=this,i=Object(n["a"])(this.tableData);try{for(i.s();!(e=i.n()).done;){var o=e.value;o.displayable=!1}}catch(p){i.e(p)}finally{i.f()}var a,l=Object(n["a"])(this.selections);try{var c=function(){var e=a.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(l.s();!(a=l.n()).done;)c()}catch(p){l.e(p)}finally{l.f()}var d={columnDatas:this.tableData,id:this.id,tableId:this.tableId,tableName:this.tableName};console.log(d),r["a"].put(s["g"].user.columns,d).then((function(e){t.$emit("update"),t.$emit("update:visible",!1)}))},makeRowDisplayable:function(){var e=this;setTimeout((function(){var t,i=Object(n["a"])(e.tableData);try{for(i.s();!(t=i.n()).done;){var s=t.value;e.$refs.table.$refs.table.toggleRowSelection(s,s.displayable)}}catch(r){i.e(r)}finally{i.f()}}),20)}}},d=c,p=(i("ec6b"),i("2877")),u=Object(p["a"])(d,o,a,!1,null,null,null),m=u.exports,f=m;t["a"]={components:{BizColumnOperation:l["a"],BizColumns:f},data:function(){return{columnsSettingVisible:!1,columns:[]}},created:function(){this.getTableId(),this.getColumns()},methods:{onCustomColumns:function(){this.columnsSettingVisible=!0},getColumns:function(){var e=this;console.log(12),r["a"].get(s["A"].columns,{tableId:this.tableId}).then((function(t){e.columns=[],setTimeout((function(){e.columns=t.data.columnDatas.filter((function(e){return e.displayable})),e.$refs.table&&setTimeout((function(){e.$refs.table.doLayout()}),50)}),20)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getTableId:function(){}}}},"45e9":function(e,t,i){},6975:function(e,t,i){"use strict";var s=i("f65f"),r=i.n(s);r.a},8244:function(e,t,i){"use strict";var s=i("1fe5"),r=i.n(s);r.a},"888f":function(e,t,i){},"9b3f":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"afterSale-process"},[e._l(e.refunds,(function(t,s){return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:t.id},[i("div",{staticClass:"refundsHead"},[i("div",{staticClass:"refundsContent"},[i("img",{staticClass:"image",attrs:{src:t.orderItem.thumbnail,width:"20px"}}),i("label",[e._v(e._s(t.orderItem.fullName))]),"2"!==t.type?i("label",{staticClass:"price"},[e._v("￥"+e._s(t.amount))]):e._e(),i("label",{staticClass:"refundsState"},[e._v(e._s(e.refundsStates[t.state]))])])]),i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新申请",status:"0"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(t.refundsRecords,(function(r){return"0"==r.type?i("div",{key:r.id},["1"===t.type?i("p",[e._v("买家申请退货")]):e._e(),"0"===t.type?i("p",[e._v("买家申请退款")]):e._e(),"2"===t.type?i("p",[e._v("买家申请换货")]):e._e(),"2"!==t.type?i("p",[e._v("退款原因："+e._s(t.reason))]):e._e(),"2"!==t.type?i("p",[e._v("退款金额："+e._s(t.amount))]):e._e(),"2"!==t.type?i("p",[e._v("退款说明："+e._s(t.explain))]):e._e(),"2"===t.type?i("p",[e._v("换货原因："+e._s(t.reason))]):e._e(),"2"===t.type?i("p",[e._v("换货数量："+e._s(t.orderItem.quantity))]):e._e(),"2"===t.type?i("p",[e._v("换货地址："+e._s(t.receiverAddress))]):e._e(),"2"===t.type?i("p",[e._v("换货说明："+e._s(t.explain))]):e._e(),i("div",{staticStyle:{display:"flex"}},[e._v(" 凭证： "),e._l(t.refundsImages,(function(t){return i("div",{key:t,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:t,height:"100"},on:{click:function(i){return e.enlarge(t)}}})])})),i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})])],2),i("p",[e._v(e._s(t.createDate))]),"0"===t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree(s)}}},[e._v("同意")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse(s)}}},[e._v("拒绝")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"agreeForm_"+s}},[i("table",{staticClass:"agreeContent",attrs:{id:"agreeContent_"+s}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"2"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("input",{attrs:{type:"hidden",name:"refundType"},domProps:{value:t.type}}),i("tr",[i("th",[e._v("售后详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),"2"===t.type||"1"===t.type?i("tr",[i("th",[e._v("收货地址：")]),i("el-card",[i("div",{staticClass:"left",on:{click:e.clickAdress}},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",{staticStyle:{float:"right"}},[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit(s)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"refuseForm_"+s}},[i("table",{staticClass:"refuseContent",attrs:{id:"refuseContent_"+s}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"1"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit(s)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),0)]),i("el-step",{attrs:{title:"售后中",status:"2"===t.refundsRecords[0].type||"3"===t.refundsRecords[0].type||"7"===t.refundsRecords[0].type||"8"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(s){return"2"===s.type&&"2"!==t.type?i("div",{key:s.id},[i("p",[e._v("卖家同意退货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(s.details))]),i("p",[e._v(e._s(s.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(s){return"2"===s.type&&"2"===t.type?i("div",{key:s.id},[i("p",[e._v("卖家同意换货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(s.details))]),i("p",[e._v(e._s(s.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(r){return"3"===r.type?i("div",{key:r.id},[i("p",[e._v("买家已退货，等待卖家收货")]),i("p",[e._v("物流公司："+e._s(r.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(r.trackingNo))]),"2"!==t.type?i("p",[e._v("退款说明："+e._s(r.details))]):e._e(),i("p",[e._v(e._s(r.happenDate))]),e._l(t.returnsImages,(function(s){return"2"!==t.type?i("div",{key:s,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:s,height:"100"},on:{click:function(t){return e.enlarge(s)}}})]):e._e()})),"2"!==t.type?i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})]):e._e(),"3"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree1(s)}}},[e._v("确认收货")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse1(s)}}},[e._v("拒绝收货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"refuseForm1_"+s}},[i("table",{staticClass:"refuseContent1",attrs:{id:"refuseContent1_"+s}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"4"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit1(s)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"agreeForm1_"+s}},[i("table",{staticClass:"agreeContent1",attrs:{id:"agreeContent1_"+s}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),"2"!==t.type?i("input",{attrs:{type:"hidden",name:"state",value:"5"}}):e._e(),"2"===t.type?i("input",{attrs:{type:"hidden",name:"state",value:"7"}}):e._e(),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("收货详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit1(s)}}},[e._v("确定")]):e._e()],1)])],2):e._e()})),e._l(t.refundsRecords,(function(r){return"7"===r.type?i("div",{key:r.id},[i("p",[e._v("卖家已收到买家的换货商品，待发出换货商品")]),i("p",[e._v(e._s(r.happenDate))]),"7"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shipping(s)}}},[e._v("发货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"shippingForm_"+s}},[i("table",{staticClass:"shippingContent1",attrs:{id:"shippingContent1_"+s}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"8"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("物流公司:")]),i("td",[i("select",{directives:[{name:"model",rawName:"v-model",value:e.deliveryId,expression:"deliveryId"}],staticStyle:{width:"225px"},attrs:{name:"deliveryId"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.deliveryId=t.target.multiple?i:i[0]}}},e._l(e.deliveryCorps,(function(e,t){return i("option",{key:t,attrs:{label:e.name},domProps:{value:e.id}})})),0)])]),i("tr",[i("th",[e._v("物流单号:")]),i("td",[i("input",{attrs:{type:"text",name:"trackingNo",onKeyUp:"value=value.replace(/[\\W]/g,'')"}})])]),i("tr",[i("th",[e._v("物流费用:")]),i("td",[i("input",{attrs:{type:"text",name:"tackingAmount",onkeyup:"this.value=this.value.replace(/[^\\d.]/g,'')"}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shippingSubmit1(s)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),e._l(t.refundsRecords,(function(t){return"8"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家已发出换新货，等待买家收货")]),i("p",[e._v("物流公司："+e._s(t.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(t.trackingNo))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"售后完成",status:"1"===t.refundsRecords[0].type||"4"===t.refundsRecords[0].type||"5"===t.refundsRecords[0].type||"6"===t.refundsRecords[0].type||"9"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(t){return"5"==t.type?i("div",{key:t.id},[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("退款金额："+e._s(t.amount))]),i("p",[e._v("售后详情："+e._s(t.details))])]):e._e()})),e._l(t.refundsRecords,(function(s){return"6"==s.type&&"2"!==t.type?i("div",{key:s.id},[i("p",[e._v("买家取消退货")])]):e._e()})),e._l(t.refundsRecords,(function(s){return"6"==s.type&&"2"===t.type?i("div",{key:s.id},[i("p",[e._v("买家取消换货")])]):e._e()})),e._l(t.refundsRecords,(function(t){return"1"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝售后申请")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"4"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝收货")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"9"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已确认收货，换货完成")])]):e._e()}))],2)])],1)],1)})),0===e.refunds.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],2)},r=[],o=(i("d3b7"),i("5530")),a=i("e42c"),n=i("624d"),l=i.n(n),c=i("f36f"),d=i("f260"),p=i.n(d),u=i("2f62"),m=i("1ab1"),f=i("c596"),g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"bill-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return i("el-card",{key:t.id},[i("div",{on:{click:function(i){return e.selectItem(t)}}},[i("div",{staticClass:"top"},[i("span",[e._v(e._s(t.consignee))]),i("span",[e._v(e._s(t.phone))])]),i("div",{staticClass:"content"},[i("span",[e._v(e._s(t.areaName+t.address))])])]),i("div",{staticClass:"bottom"},["1"===t.isDefault?i("div",[e._v("默认")]):e._e(),"0"===t.isDefault?i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(i){e.$set(t,"isDefault",i)},expression:"receiver.isDefault"}},[e._v("设为默认 ")]):e._e(),i("div",{staticClass:"handler"},[i("i",{staticClass:"el-icon-edit-outline",on:{click:function(i){return e.editForm(t)}}},[e._v("编辑")]),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"省市"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},v=[],h=i("8330"),b=i("ce2e"),y={components:{BizSaveButton:h["a"],BizAreaSelect:b["a"],BizGrid:c["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(o["a"])(Object(o["a"])({},Object(u["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+p.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(o["a"])(Object(o["a"])({},Object(u["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){m["a"].delete(f["g"].hypermarketMgmt.receiver,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};m["a"].post(f["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};m["a"].put(f["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.updateSelAddress(e),this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};m["a"].get(f["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},_=y,w=(i("d79d"),i("2877")),I=Object(w["a"])(_,g,v,!1,null,null,null),S=I.exports,C={components:{BizGrid:c["a"],BillInfo:S},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{activeStep:0,loading:!1,dialogVisiable:!1,refunds:[],refundsRecords:[],refundsImages:[],formData:[],getAddress:{},refundType:"",refundId:"",orderId:"",message:"",imageValue:"",imgStyle:"",deliveryId:"",trackingNo:"",tackingAmount:"",currentState:"",active:"",defaultImage:l.a,showShippingEditor:!1,deliveryCorps:[],refundsStates:{0:"未确认",1:"拒绝退款退货/换货申请",2:"同意退/换货申请",3:"买家发货",4:"卖家拒收",5:"卖家退款",6:"取消退款",7:"卖家发货",8:"买家收货"}}},computed:Object(o["a"])(Object(o["a"])({},Object(u["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+p.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.initData(),this.getAddressList()},watch:{itemId:function(e){this.initData()}},methods:{clickAdress:function(){console.log(1111),this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};m["a"].get(f["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},initData:function(){var e=this,t={orderId:this.itemId};a["a"].viewOrderRefunds(t,(function(t){e.refunds=t.refunds}),(function(e){console.log(e)}))},close:function(){document.querySelector(".overlay").style.display="none"},enlarge:function(e){document.querySelector(".overlay").style.display="block",this.imageValue=e||l.a,this.imgStyle="position: absolute; top: 100px; right: 150px;padding:20px;height: 500px;background:#fff"},agree:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="block";for(var s=document.getElementById(t).getElementsByTagName("input"),r=0;r<s.length-1;r++)this.refundType=s[1].value;document.getElementById(i).style.display="none"},refuse:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agree1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="block",document.getElementById(i).style.display="none"},refuse1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agreeSubmit:function(e){var t=this,i="agreeForm_"+e,s={orderId:this.itemId,depotReceiverId:this.getAddress.id,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[4].value,remarks:document.getElementById(i)[5].value};this.loading=!0,a["a"].refundsAudit(s,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},refuseSubmit:function(e){var t=this,i="refuseForm_"+e,s={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(s),this.loading=!0,a["a"].refundsAudit(s,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),t.loading=!1,document.getElementById(i).style.display="none"}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},agreeSubmit1:function(e){var t=this;this.loading=!0;var i="agreeForm1_"+e,s={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(s),a["a"].refundsAudit(s,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage),t.loading=!1}))},refuseSubmit1:function(e){var t=this;this.loading=!0;var i="refuseForm1_"+e,s={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};a["a"].refundsAudit(s,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},shipping:function(e){var t="shippingContent1_"+e;document.getElementById(t).style.display="block",this.init()},init:function(){var e=this;a["a"].viewOrder({orderId:this.itemId},(function(t){e.deliveryCorps=t.deliveryCorps}),(function(t){e.$message.warning(t.errorMessage)}))},shippingSubmit1:function(e){var t=this;this.loading=!0;var i="shippingForm_"+e,s={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:"",remarks:"",deliveryId:document.getElementById(i)[3].value,trackingNo:document.getElementById(i)[4].value,tackingAmount:document.getElementById(i)[5].value};a["a"].refundsAudit(s,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},messageClick:function(){this.initData(),this.message=""}}},M=C,k=(i("6975"),Object(w["a"])(M,s,r,!1,null,null,null));t["a"]=k.exports},ae8e:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"order-mgmt-list-supplier"},[i("div",{staticClass:"toggle-btn",on:{click:e.isShow}},[e._v(" "+e._s(e.toggleRecommendTxt)+" "),i("div",{staticClass:"iconfont biz-icon-i-web-zd1",class:{"rotate-180":e.showRecommend}})]),i("biz-flex-table",{ref:"table",staticClass:"order-mgmt-tabel",attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,loading:e.loading,pagination:e.pagination,isMergeInvoice:!0},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"selection-change":e.handleSelectionChange,select:e.select,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[i("div",{staticClass:"operate-container",attrs:{slot:"operation"},slot:"operation"},[i("el-radio-group",{attrs:{size:"mini"},on:{change:e.onChangeDateType},model:{value:e.curSelectDateType,callback:function(t){e.curSelectDateType=t},expression:"curSelectDateType"}},e._l(e.dateTypeList,(function(t){return i("el-radio-button",{key:t,attrs:{label:t}},[e._v(e._s(t))])})),1)],1),i("el-table-column",{attrs:{label:"订单信息","min-width":"215px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"order-content"},[i("div",{staticStyle:{display:"flex"}},[i("div",{staticClass:"customer-info"},[e._v(e._s(t.row.sn))]),"purchaseOrder"===t.row.dType?i("i",{staticClass:"iconfont biz-icon-i-web-md",staticStyle:{"font-size":"32px",color:"#ff7300"}}):e._e(),"1"===t.row.isMerged?i("i",{staticClass:"iconfont biz-icon-i-web-bing",staticStyle:{"font-size":"30px",color:"#ff7300"}}):e._e(),"1"===t.row.isTransfered?i("i",{staticClass:"iconfont biz-icon-i-web-zhuan",staticStyle:{"font-size":"30px",color:"rgb(135, 208, 104)"}}):e._e()]),i("div",[e._v("创建日期："+e._s(t.row.orderTime))]),i("div",[e._v("状态："+e._s(e.getOrderStatus(t.row)))]),i("div",{staticClass:"shop-over"},[e._v("所属店铺："+e._s(t.row.shop.name))])])]}}])}),i("el-table-column",{attrs:{label:"金额","min-width":"100px",prop:"amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"100%"}},[i("div",{staticClass:"overflow"},[e._v(" 不含税： ")]),i("div",{staticClass:"overflow"},[e._v(" 税额： ")]),i("div",{staticClass:"overflow"},[e._v(" 含税："+e._s(t.row.amount)+" ")])])]}}])}),i("el-table-column",{attrs:{label:"商品信息","min-width":"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[i("div",{staticStyle:{width:"100%"}},e._l(t.row.orderItems.length>0?[t.row.orderItems[0]]:[],(function(s){return i("div",{key:s.sn,staticClass:"product-info-content"},[s.thumbnail&&" "!==s.thumbnail?i("img",{attrs:{src:s.thumbnail,onerror:e.errorImg}}):i("img",{attrs:{src:"/resources/admin/images/default/product-default-100.png"}}),i("div",{staticClass:"wrapper"},[i("div",{staticClass:"titleClass",attrs:{title:s.name}},[e._v(e._s(s.name))]),i("div",[e._v(e._s(s.product?s.product.barCode:""))]),i("div",[e._v("单价(不含税)：")]),i("div",[e._v("单价(含税)："+e._s(s.price))])]),i("div",{staticClass:"amount"},[e._v(e._s(s.quantity)+e._s(t.row.orderItems.length>1?"...":""))])])})),0)])]}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("biz-column-operation",{attrs:{row:t.row}},["9"===t.row.type?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.refundsHandler(t.row)}}},[e._v("退款")]):e._e(),"11"===t.row.type&&"1"===t.row.shippingWay||"12"===t.row.type&&"1"===t.row.shippingWay?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.paymentHandler(t.row)}}},[e._v("付款")]):e._e(),"3"===t.row.type&&"0"===t.row.shippingWay||"2"===t.row.type&&"1"===t.row.shippingWay||"13"===t.row.type?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.shippingHandler(t.row)}}},[e._v("发货")]):e._e(),"6"===t.row.type||t.row.invoiceId?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.invoiceHandler(t.row)}}},[e._v("补开发票")]),"1"==t.row.type||"2"==t.row.type?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.closeOrder(t.row)}}},[e._v("关闭")]):e._e(),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.certificate(t.row)}}},[e._v("凭证")])],1)]}}])})],1),i("el-popover",{ref:"confirmOrder",attrs:{placement:"top-start","min-width":"300"},model:{value:e.visiable,callback:function(t){e.visiable=t},expression:"visiable"}},[i("p",[i("i",{staticClass:"el-icon-warning",staticStyle:{color:"#ff7300","margin-right":"10px"}}),e._v("您要确认此订单么? ")]),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini",type:"text"}},[e._v("确定")])],1)]),i("biz-popup-tabs",{attrs:{open:e.open},on:{close:function(t){e.open=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[i("base-info",{ref:"baseInfo",attrs:{itemId:e.itemId,isEdit:e.isEdit,isPend:e.isPend,handler:e.handler,open:e.open,activeNames:e.activeNames},on:{xrorder:e.xrorder,operationSuccess:e.operationSuccess}})],1),i("el-tab-pane",{attrs:{label:"商品信息",name:"productinfo"}},[i("product-info",{ref:"productinfo",attrs:{itemId:e.itemId,isEdit:e.isEdit},on:{setOrderItems:e.setOrderItems,operationSuccess:e.operationSuccess}})],1),e.itemId?i("el-tab-pane",{attrs:{label:"订单进度",name:"loginfo"}},[i("order-logs",{ref:"loginfo",attrs:{itemId:e.itemId,isEdit:e.isEdit,paymentMethodName:e.paymentMethodName},on:{logistics:e.logistics}})],1):e._e(),e.itemId?i("el-tab-pane",{attrs:{label:"物流信息",name:"logisticsinfo"}},[i("logistics-info",{ref:"logisticsinfo",attrs:{itemId:e.itemId,open:e.open,handler:e.handler,shippings:e.shippings},on:{operationSuccess:e.getList,goToOrderLogs:e.goToOrderLogs}})],1):e._e(),e.itemId?i("el-tab-pane",{attrs:{label:"售后进度",name:"afterprocess"}},[i("after-process",{ref:"afterprocess",attrs:{itemId:e.itemId,isEdit:e.isEdit},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId&&"6"!==e.orderState?i("el-tab-pane",{attrs:{label:"发票",name:"invoice"}},[i("invoice-info",{ref:"invoice",attrs:{itemId:e.itemId,invoiceInfoId:e.invoiceInfoId,invoiceId:e.invoiceId,price:e.price,open:e.open,userId:e.userId,isEdit:e.isEdit,orderIds:e.orderIds},on:{operationSuccess:e.refreshList}})],1):e._e()],1),i("biz-popup-tabs",{attrs:{open:e.openInvocie},on:{close:function(t){e.openInvocie=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"发票",name:"invoice"}},[i("invoice-info",{ref:"invoice",attrs:{itemId:e.itemId,invoiceInfoId:e.invoiceInfoId,invoiceId:e.invoiceId,price:e.price,open:e.openInvocie,userId:e.userId,isEdit:e.isEdit,orderIds:e.orderIds},on:{operationSuccess:e.refreshList}})],1)],1),i("el-dialog",{attrs:{visible:e.dialogTableVisible,center:"",width:"1200px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("结算时间："+e._s(e.form.orderTime))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("会员姓名："+e._s(e.form.member?e.form.member.name:""))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("会员电话："+e._s(e.form.member?e.form.member.mobile:""))])])],1),e.userCard.sn?i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("会员卡号："+e._s(e.userCard.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("会员卡余额："+e._s(e.userCard.balance))])])],1):e._e(),e.userCard.sn?i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("赠送V豆："+e._s(e.form.giftBean))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("赠送积分："+e._s(e.form.point))])])],1):e._e(),e.userCard.bean?i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("V豆总和："+e._s(e.userCard.bean))])]),i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("积分总和："+e._s(e.userCard.point))])])],1):e._e(),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[e.userCard.sn?i("div",{staticClass:"grid-content bg-purple"},[e._v("抵扣V豆："+e._s(e.form.bean))]):e._e()]),i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("备注："+e._s(e.form.remarks))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"fullName",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.fullName))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:3}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("运费：￥"+e._s(e.form.freight))])]),i("el-col",{attrs:{span:5}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("优惠金额：￥"+e._s(e.form.couponDiscount))])]),i("el-col",{attrs:{span:5}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("调整金额：￥"+e._s(e.form.offsetAmount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("实收金额：￥"+e._s(e.form.amountPaid))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1),i("el-dialog",{attrs:{visible:e.showCloseOrder,center:"","append-to-body":"","custom-class":"close-order-dialog"},on:{"update:visible":function(t){e.showCloseOrder=t}}},[i("div",[i("div",[e._v("请您在与客户沟通一致的前提下使用此功能，订单关闭后，不能恢复")]),i("div",{staticClass:"reson-container"},[i("span",{staticClass:"start"},[e._v("*")]),i("span",[e._v("请选择关闭订单的理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择关闭理由"},model:{value:e.curSelectCloseReason,callback:function(t){e.curSelectCloseReason=t},expression:"curSelectCloseReason"}},e._l(e.reasonList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("div",{staticClass:"deccription"},[i("span",{staticClass:"dec-label"},[e._v("备注：")]),i("el-input",{attrs:{placeholder:"请输入备注",type:"textarea",rows:4},model:{value:e.closeDeccription,callback:function(t){e.closeDeccription=t},expression:"closeDeccription"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.cancelClose}},[e._v("取消")]),i("el-button",{on:{click:e.confirmClose}},[e._v("确定关闭")])],1)]),i("el-dialog",{attrs:{visible:e.showIframe,center:"",width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.showIframe=t}}},[i("iframe",{staticStyle:{height:"600px",width:"100%"},attrs:{src:e.iframeSrc,frameborder:"0"}})])],1)},r=[],o=(i("99af"),i("4160"),i("c975"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("ac1f"),i("3ca3"),i("466d"),i("1276"),i("159b"),i("ddb0"),i("2b3d"),i("96cf"),i("1da1")),a=i("5530"),n=i("7132"),l=i("04d3"),c=i("e42c"),d=i("447a"),p=i("ae8d"),u=i("9b3f"),m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-log-info"},["在线支付"!==e.paymentMethodName?i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v("待商家确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v("商家已确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"AuditPassed"===t.type?i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v("审核者："+e._s(t.operator))]),i("p",[e._v(e._s(t.createTime))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"执行",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,s){return i("div",{key:s},["6"===t.state?i("div",[i("p",[e._v("自动派单")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason))])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("自动派单")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v("用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile))]):e._e(),t.dispatchRecord?i("div",[e._v(e._s(t.dispatchRecord.createDate))]):e._e(),t.refuseRecord?i("div",[e._v(e._s(t.refuseRecord.reason))]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks))]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已出发")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已到达")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"3"===t.state?i("div",[i("p",[e._v("完成救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"4"===t.state?i("div",[i("p",[e._v("取消救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已执行")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.shippings,(function(t){return e.shippings&&e.shippings.length>0?i("div",{key:t.id},["1"===t.shippingStatus?i("p",[e._v("订单已部分发货")]):e._e(),"1"!==t.shippingStatus?i("p",[e._v("订单已执行")]):e._e(),i("p",[e._v(e._s(t.shippingDate))]),i("p",[e._v("物流公司："+e._s(t.logistics))]),i("p",[e._v("物流单号："+e._s(t.expressSn))]),i("p",[e._v(" 收货人："+e._s(t.consignee)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(i){return e.certificate(t.id)}}},[e._v("凭证")])],1),e._l(t.shippingItems,(function(t,s){return i("p",{key:s},[e._v(e._s(t.name)+"*"+e._s(t.quantity))])})),e.devProcessShippings&&e.devProcessShippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.devProcessShippings.shippingTraces,(function(t,s){return i("div",{key:s,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.devProcessShippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()],2):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"payment"===t.type?i("div",{key:t.id},[i("p",[e._v("支付方式："+e._s(e.paymentMethodName))]),i("p",[e._v("付款方式："+e._s(e.paymentType))]),e._l(e.payments,(function(t){return i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v(e._s("0"===t.paymentStatus?"未支付":"1"===t.paymentStatus?"部分支付":"已支付"))]),i("p",[e._v(e._s(t.paymentDate))]),i("p",[e._v("付款金额：￥"+e._s(t.amount))]),i("p",[e._v("手续费："+e._s(t.fee))]),i("p",[e._v("交易号："+e._s(t.sn))])])}))],2):e._e()})),0)]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v("交易完成")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已评价")]),e._l(e.reviews,(function(t,s){return i("div",{key:s},["0"===t.reviewType?i("div",[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("商品："+e._s(t.product.name))]),i("p",[e._v("评分："+e._s(t.score)+"分")]),i("p",[e._v("评语："+e._s(t.content))]),e._l(t.images,(function(t,s){return i("div",{key:s,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v("店铺评分")]),i("p",[e._v("服务态度："+e._s(t.serviceAttitude)+"分")]),i("p",[e._v("服务速度："+e._s(t.serviceSpeed)+"分")]),i("p",[e._v("专业技能："+e._s(t.professional)+"分")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已关闭")]),i("p",[e._v("关闭理由："+e._s(t.content))]),i("p",[e._v("备注："+e._s(t.memo))]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]):e._e()],1):e._e(),"在线支付"===e.paymentMethodName?i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v("待商家确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v("商家已确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"payment"===t.type?i("div",{key:t.id},[i("p",[e._v("支付方式："+e._s(e.paymentMethodName))]),i("p",[e._v("付款方式："+e._s(e.paymentType))]),e._l(e.payments,(function(t){return i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v(e._s("0"===t.paymentStatus?"未支付":"1"===t.paymentStatus?"部分支付":"已支付"))]),i("p",[e._v(e._s(t.paymentDate))]),i("p",[e._v("付款金额：￥"+e._s(t.amount))]),i("p",[e._v("手续费："+e._s(t.fee))]),i("p",[e._v("交易号："+e._s(t.sn))])])}))],2):e._e()})),0)]),i("el-step",{attrs:{title:"执行",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,s){return i("div",{key:s},["6"===t.state?i("div",[i("p",[e._v("自动派单")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason))])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("自动派单")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v("用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile))]):e._e(),t.dispatchRecord?i("div",[e._v(e._s(t.dispatchRecord.createDate))]):e._e(),t.refuseRecord?i("div",[e._v(e._s(t.refuseRecord.reason))]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks))]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已出发")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已到达")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"3"===t.state?i("div",[i("p",[e._v("完成救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"4"===t.state?i("div",[i("p",[e._v("取消救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已执行")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.shippings,(function(t){return e.shippings&&e.shippings.length>0?i("div",{key:t.id},["1"===t.shippingStatus?i("p",[e._v("订单已部分发货")]):e._e(),"1"!==t.shippingStatus?i("p",[e._v("订单已执行")]):e._e(),i("p",[e._v(e._s(t.shippingDate))]),i("p",[e._v("物流公司："+e._s(t.logistics))]),i("p",[e._v("物流单号："+e._s(t.expressSn))]),i("p",[e._v(" 收货人："+e._s(t.consignee)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(i){return e.certificate(t.id)}}},[e._v("凭证")])],1),e._l(t.shippingItems,(function(t,s){return i("p",{key:s},[e._v(e._s(t.name)+"*"+e._s(t.quantity))])})),e.devProcessShippings&&e.devProcessShippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.devProcessShippings.shippingTraces,(function(t,s){return i("div",{key:s,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.devProcessShippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()],2):e._e()}))],2)]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v("交易完成")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已评价")]),e._l(e.reviews,(function(t,s){return i("div",{key:s},["0"===t.reviewType?i("div",[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("商品："+e._s(t.product.name))]),i("p",[e._v("评分："+e._s(t.score)+"分")]),i("p",[e._v("评语："+e._s(t.content))]),e._l(t.images,(function(t,s){return i("div",{key:s,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v("店铺评分")]),i("p",[e._v("服务态度："+e._s(t.serviceAttitude)+"分")]),i("p",[e._v("服务速度："+e._s(t.serviceSpeed)+"分")]),i("p",[e._v("专业技能："+e._s(t.professional)+"分")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已关闭")]),i("p",[e._v("关闭理由："+e._s(t.content))]),i("p",[e._v("备注："+e._s(t.memo))]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]):e._e()],1):e._e(),i("el-dialog",{attrs:{title:"",visible:e.outerVisible,"append-to-body":""},on:{"update:visible":function(t){e.outerVisible=t}}},[i("img",{attrs:{src:e.larImg,width:"100%"}})]),i("el-dialog",{attrs:{visible:e.dialogShipping,center:"",width:"1200px","append-to-body":"","custom-class":"printDialog"},on:{"update:visible":function(t){e.dialogShipping=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单状态："+e._s("1"===e.shippingsPrint.shippingStatus?"订单已部分发货":"订单已执行"))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("发货时间："+e._s(e.shippingsPrint.shippingDate?e.shippingsPrint.shippingDate.split(" ")[0]:""))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.shippingsPrint.logistics))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shippingsPrint.expressSn))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流费用："+e._s(e.shippingsPrint.freight))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingsPrint.consignee))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingsPrint.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货地址："+e._s(e.shippingsPrint.address))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1)],1)},f=[],g=i("f36f"),v=i("f260"),h=i.n(v),b=i("1ab1"),y=i("225d"),_=i("2f62"),w=i("bc3a"),I=i.n(w),S={name:"NewsMgmt",props:{itemId:{type:String},paymentMethodName:{type:String,default:"在线支付"}},data:function(){return{orderItems:[],loading:!1,open:!1,outerVisible:!1,active:"",larImg:"",orderLogs:[],reviews:[],shippings:[],payments:[],dialogShipping:!1,form:{},title:"",gridData:[],shippingsPrint:"",memberRescueStates:[],paymentMethodNameReal:"",devProcessShippings:"",type:"",amount:"",amountpaid:"",paymentType:"",latestMemberRescueState:"",workers:[],sn:"",consignee:"",fee:"",operator:"",trackingNo:"",deliveryCorp:"",orderId:"",workerId:"",dispathButton:!1,redispathButton:!1,cbp_tmlabel:!1,imgStyle:"",imageValue:"",shippingId:"",currentState:"",preState:"",create:!1,cancel:!1,confirm:!1,service:!1,shipping:!1,payment:!1,complete:!1,review:!1,isCreate:!1,isConfirm:!1,isService:!1,isPayment:!1,isComplete:!1,isReview:!1,isCancel:!1}},components:{BizGrid:g["a"],vueEasyPrint:y["a"]},computed:{styleObject:function(){return{height:"200px",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+h.a+") 50% 50% / 200px no-repeat"}}},watch:{itemId:function(e){this.getList()}},created:function(){this.getList()},methods:Object(a["a"])(Object(a["a"])({},Object(_["c"])(["getUser"])),{},{operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.getList()},print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,s,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={shippingId:e.shippingId},t.prev=1,t.next=4,I.a.post("/admin/purchaseOrder/voucher/export/shipping.jhtml",i,{responseType:"blob"});case 4:return s=t.sent,console.log("response => ",s),r=new Blob([s.data],{type:"application/vnd.ms-excel"}),o=decodeURI(s.headers["content-disposition"].split("filename=")[1]),a=document.createElement("a"),a.download=o.match(/"(\S*)"/)[1],a.style.display="none",a.href=URL.createObjectURL(r),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),s=t.getMonth()+1,r=t.getDate(),o=i+"-"+(s<10?"0"+s:s)+"-"+(r<10?"0"+r:r);return o},devProcess:function(){"新悦物流"===this.deliveryCorp&&this.$emit("logistics",this.orderItems[0].product.vins[0].number),"block"===this.$refs.devProcess[0].style.display?this.$refs.devProcess[0].style.display="none":this.$refs.devProcess[0].style.display="block"},certificate:function(e){var t=this,i={shippingId:e};b["a"].get("/admin/purchaseOrder/voucher/shipping.jhtml",i).then((function(i){t.dialogShipping=!0,t.title=t.getUser().shop?t.getUser().shop.name+"发货单":"发货单",t.form=i.order,t.shippingId=e,t.shippingsPrint=i.shipping,t.gridData=i.shipping.shippingItems})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},enlarge:function(e){this.larImg=e,this.outerVisible=!0},getList:function(e){var t=this;this.loading=!0;var i={orderId:e||this.itemId};c["a"].viewOrderlogs(i,(function(e){t.orderItems=e.order.orderItems,t.loading=!1,t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.payments=e.payments,e.payments&&e.payments.length>1?t.amountpaid=Number(e.payments[0].amount)+Number(e.payments[1].amount):t.amountpaid="",t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,t.shippings=e.shippings,t.devProcessShippings=e.shippings&&e.shippings[0],e.payments&&(t.paymentType=e.payments.length>0?e.payments[0].paymentType:"",t.amount=e.payments.length>0?e.payments[0].amount:"",t.fee=e.payments.length>0?e.payments[0].fee:"",t.sn=e.payments.length>0?e.payments[0].sn:""),e.shippings&&(t.deliveryCorp=e.shippings.length>0?e.shippings[0].logistics:"",t.trackingNo=e.shippings.length>0?e.shippings[0].expressSn:"",t.operator=e.shippings.length>0?e.shippings[0].consignee:""),t.consignee=e.order.consignee||"",t.currentState=e.orderLogs[e.orderLogs.length-1].type,e.orderLogs.length>1&&(t.preState=e.orderLogs[e.orderLogs.length-2].type),"create"===t.currentState||"confirm"===t.currentState?t.active="1":"service"===t.currentState||"shipping"===t.currentState?t.active="2":"payment"===t.currentState?t.active="3":"complete"===t.currentState?t.active="4":"review"===t.currentState?t.active="5":"cancel"===t.currentState&&(t.active="6"),!t.latestMemberRescueState||"0"!==t.latestMemberRescueState.state&&"1"!==t.dispathType?(t.dispathButton=!0,t.cbp_tmlabel=!1):(t.dispathButton=!1,t.cbp_tmlabel=!0),t.latestMemberRescueState&&"3"!==t.latestMemberRescueState.state&&"8"!==t.latestMemberRescueState.state&&"9"!==t.latestMemberRescueState.state&&"4"!==t.latestMemberRescueState.state&&"0"!==t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0,t.isCreate=!1,t.isPayment=!1,t.isComplete=!1,t.isReview=!1,t.isCancel=!1,t.isService=!1,e.orderLogs.forEach((function(e){"create"===e.type&&(t.isCreate=!0),"payment"===e.type&&(t.isPayment=!0),"complete"===e.type&&(t.isComplete=!0),"review"===e.type&&(t.isReview=!0),"cancel"===e.type&&(t.isCancel=!0),"service"===e.type&&(t.isService=!0),"shipping"===e.type&&(t.isService=!0),"confirm"===e.type&&(t.isService=!0)}))}),(function(e){console.log(e)}))},getRescueList:function(e){var t=this;this.loading=!0;var i={orderId:e||this.itemId};c["a"].rescueOrderLogs(i,(function(e){t.loading=!1,t.orderLogs=e.orderLog,t.reviews=e.reviews,t.payments=e.payments,e.payments&&e.payments.length>1?t.amountpaid=Number(e.payments[0].amount)+Number(e.payments[1].amount):t.amountpaid="",t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,t.shippings=e.order.shippings&&e.order.shippings[0],e.order.payments&&(t.paymentType=e.order.payments.length>0?e.order.payments[0].paymentType:"",t.amount=e.order.payments.length>0?e.order.payments[0].amount:"",t.fee=e.order.payments.length>0?e.order.payments[0].fee:"",t.sn=e.order.payments.length>0?e.order.payments[0].sn:""),e.order.shippings&&(t.deliveryCorp=e.order.shippings.length>0?e.order.shippings[0].logistics:"",t.trackingNo=e.order.shippings.length>0?e.order.shippings[0].expressSn:"",t.operator=e.order.shippings.length>0?e.order.shippings[0].consignee:""),t.consignee=e.order.consignee||"",t.currentState=e.orderLogs[e.orderLogs.length-1].type,e.orderLogs.length>1&&(t.preState=e.orderLogs[e.orderLogs.length-2].type),"create"===t.currentState||"confirm"===t.currentState?t.active="1":"service"===t.currentState||"shipping"===t.currentState?t.active="2":"payment"===t.currentState?t.active="3":"complete"===t.currentState?t.active="4":"review"===t.currentState?t.active="5":"cancel"===t.currentState&&(t.active="6"),"0"===t.latestMemberRescueState.state||"1"===t.dispathType?(t.dispathButton=!1,t.cbp_tmlabel=!0):(t.dispathButton=!0,t.cbp_tmlabel=!1),"3"!==t.latestMemberRescueState.state&&"8"!==t.latestMemberRescueState.state&&"9"!==t.latestMemberRescueState.state&&"4"!==t.latestMemberRescueState.state&&"0"!==t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0,t.isCreate=!1,t.isPayment=!1,t.isComplete=!1,t.isReview=!1,t.isCancel=!1,t.isService=!1,e.orderLogs.forEach((function(e){"create"===e.type&&(t.isCreate=!0),"payment"===e.type&&(t.isPayment=!0),"complete"===e.type&&(t.isComplete=!0),"review"===e.type&&(t.isReview=!0),"cancel"===e.type&&(t.isCancel=!0),"service"===e.type&&(t.isService=!0),"shipping"===e.type&&(t.isService=!0),"confirm"===e.type&&(t.isService=!0)}))}),(function(e){console.log(e)}))},dispath:function(e){var t=this;this.id=this.itemId||"",c["a"].rescuerDispath({orderId:this.id,workerId:this.workerId},(function(e){c["a"].rescueOrderLogs({orderId:t.id,dispathType:"0"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,"0"===t.latestMemberRescueState.state||"7"===t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))}),(function(e){console.log(e)}))},rdispath:function(e){var t=this;this.id=this.itemId||"",c["a"].rescueOrderLogs({orderId:this.id,dispathType:"1"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,t.cbp_tmlabel=!0}),(function(e){console.log(e)}))}})},C=S,M=(i("bc9e"),i("2877")),k=Object(M["a"])(C,m,f,!1,null,null,null),x=k.exports,T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-info-supplier"},[e.isEdit&&e.judgeState?i("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}},[i("template",{slot:"operation"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.handleSuccess,"on-error":e.handleError,data:{type:"0"},"file-list":e.fileList,name:"file",action:"/admin/file/uploads.jhtml"}},[e.invoiceMode?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"}},[e._v("上传电子发票")]):e._e()],1)],1)],2):e._e(),i("div",{staticClass:"invoiceInfo"},[e._v("发票详情")]),i("el-form",{ref:"formModel",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"发票类型",prop:"invoiceType"}},[i("el-select",{attrs:{placeholder:"请选择发票类型",disabled:!0},on:{change:e.invoiceTypeChange},model:{value:e.formModel.invoiceType,callback:function(t){e.$set(e.formModel,"invoiceType",t)},expression:"formModel.invoiceType"}},[i("el-option",{attrs:{label:"个人",value:"0"}}),i("el-option",{attrs:{label:"增值税普通发票",value:"1"}}),i("el-option",{attrs:{label:"增值税专用发票",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"发票抬头",prop:"invoiceTitle"}},[i("el-input",{attrs:{placeholder:"请输入发票抬头",disabled:!0},model:{value:e.formModel.invoiceTitle,callback:function(t){e.$set(e.formModel,"invoiceTitle",t)},expression:"formModel.invoiceTitle"}}),""===e.formModel.invoiceState?i("el-button",{attrs:{size:"mini",type:""},on:{click:e.selectInvoice}},[e._v("选择")]):e._e()],1),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"纳税人识别号",prop:"code"}},[i("el-input",{attrs:{placeholder:"请输入纳税人识别号",disabled:!0},model:{value:e.formModel.code,callback:function(t){e.$set(e.formModel,"code",t)},expression:"formModel.code"}})],1):e._e(),i("el-form-item",{attrs:{label:"发票金额",prop:"invoiceAmount"}},[i("el-input",{attrs:{placeholder:"请输入发票金额",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.invoiceAmount,callback:function(t){e.$set(e.formModel,"invoiceAmount",t)},expression:"formModel.invoiceAmount"}})],1),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"注册地址",prop:"registerAddress"}},[i("el-input",{attrs:{placeholder:"请输入注册地址",disabled:!0},model:{value:e.formModel.registerAddress,callback:function(t){e.$set(e.formModel,"registerAddress",t)},expression:"formModel.registerAddress"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"注册电话",prop:"registerMobile"}},[i("el-input",{attrs:{placeholder:"请输入注册电话",disabled:!0},model:{value:e.formModel.registerMobile,callback:function(t){e.$set(e.formModel,"registerMobile",t)},expression:"formModel.registerMobile"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[i("el-input",{attrs:{placeholder:"请输入开户银行",disabled:!0},model:{value:e.formModel.bank,callback:function(t){e.$set(e.formModel,"bank",t)},expression:"formModel.bank"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"银行账户",prop:"account"}},[i("el-input",{attrs:{placeholder:"请输入银行账户",disabled:!0},model:{value:e.formModel.account,callback:function(t){e.$set(e.formModel,"account",t)},expression:"formModel.account"}})],1):e._e(),i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("获取方式")]),i("el-form-item",{attrs:{label:"发票类型",prop:"invoiceMode"}},[i("el-radio-group",{attrs:{disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.invoiceMode,callback:function(t){e.$set(e.formModel,"invoiceMode",t)},expression:"formModel.invoiceMode"}},[i("el-radio",{attrs:{label:"0"}},[e._v("纸质发票")]),i("el-radio",{attrs:{label:"1"}},[e._v("电子发票")])],1)],1),"1"===e.formModel.invoiceMode?i("div",[i("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[i("el-input",{attrs:{placeholder:"请输入电子邮箱",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.email,callback:function(t){e.$set(e.formModel,"email",t)},expression:"formModel.email"}})],1)],1):e._e(),"0"===e.formModel.invoiceMode?i("div",[i("el-form-item",{attrs:{label:"是否邮寄",prop:"needMail"}},[i("el-radio-group",{attrs:{disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.needMail,callback:function(t){e.$set(e.formModel,"needMail",t)},expression:"formModel.needMail"}},[i("el-radio",{attrs:{label:"1"}},[e._v("是")]),i("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),"1"===e.formModel.needMail?i("div",[i("el-form-item",{attrs:{label:"收票人",prop:"contacts"}},[i("el-input",{attrs:{placeholder:"请输入收票人",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.contacts,callback:function(t){e.$set(e.formModel,"contacts",t)},expression:"formModel.contacts"}})],1),i("el-form-item",{attrs:{label:"收件人电话",prop:"mobile"}},[i("el-input",{attrs:{maxlength:"13",placeholder:"请输入电话",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),i("el-form-item",{attrs:{label:"所在地",prop:"area"}},[i("biz-area-select",{attrs:{areaId:e.formModel.area.id,disabled:""!==e.formModel.invoiceState},on:{areaChanged:e.areaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{placeholder:"请输入地址",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1)],1):e._e()],1):e._e(),e.logs&&e.logs.length>0?i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("发票进度")]):e._e(),e.logs&&e.logs.length>0?i("div",{staticClass:"order-track-new",staticStyle:{"padding-left":"30px","padding-top":"15px"}},[i("el-steps",{attrs:{direction:"vertical","finish-status":"success",space:"30px"}},[i("el-step",{attrs:{title:"已申请",status:"1"===e.active?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,s){return"0"===t.type?i("div",{key:s,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)]),i("el-step",{attrs:{title:"已开票",status:"2"===e.active1?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,s){return"1"===t.type?i("div",{key:s,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)]),i("el-step",{attrs:{title:"已邮寄",status:"3"===e.active2?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,s){return"2"===t.type?i("div",{key:s,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)])],1)],1):e._e(),"1"===e.formModel.invoiceMerged?i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("合并明细")]):e._e(),"1"===e.formModel.invoiceMerged?i("div",{staticStyle:{"margin-top":"10px"}},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{size:"small",data:e.formModel.purchaseOrders,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[i("el-table-column",{attrs:{prop:"sn",label:"订单编号"}}),i("el-table-column",{attrs:{prop:"amount",label:"订单金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.amount))]}}],null,!1,2031540991)})],1)],1):e._e()],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showInvoiceExpress,center:"","append-to-body":"","custom-class":"close-invoice-dialog",title:"发票邮寄",width:"500px"},on:{"update:visible":function(t){e.showInvoiceExpress=t}}},[i("div",{staticClass:"reson-container"},[i("span",{staticStyle:{"margin-left":"40px"}},[e._v("请填写发票邮寄的物流公司和快递单号信息")]),i("el-form",{ref:"formModel",staticStyle:{"margin-top":"40px"},attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"快递公司",prop:"express"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择快递公司"},on:{change:e.expressChange},model:{value:e.formModel.express,callback:function(t){e.$set(e.formModel,"express",t)},expression:"formModel.express"}},e._l(e.deliverys,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"快递单号",prop:"expressCode"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入快递单号"},model:{value:e.formModel.expressCode,callback:function(t){e.$set(e.formModel,"expressCode",t)},expression:"formModel.expressCode"}})],1)],1)],1),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showInvoiceExpress=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange()}}},[e._v("确定")])],1)]),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showLogisticsFollowing,center:"","append-to-body":"","custom-class":"close-follow-dialog",title:"物流跟踪"},on:{"update:visible":function(t){e.showLogisticsFollowing=t}}},[i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[e.getTraces?i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0):e._e(),this.shippingTraces&&0===this.shippingTraces.length?i("ul",[i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v(" 物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s("暂无轨迹"))])]),i("div",{staticClass:"i-item"},[e._v("快递公司："+e._s(e.expressName))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]):e._e()])])]),i("el-dialog",{attrs:{visible:e.dialogVisiableInvoice,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableInvoice=t}}},[i("invoice-info-dialog",{on:{selectedInvoice:e.selectedInvoice}})],1),i("el-dialog",{staticClass:"show-file",attrs:{"append-to-body":"",visible:e.previewInvoice,width:"950px"},on:{close:function(t){e.previewInvoice=!1}}},[i("div",[i("img",{style:e.imgStyle,attrs:{src:e.formModel.path,alt:""}})]),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.returnUpload,"on-error":e.handleError,data:{type:"0"},"file-list":e.fileList,limit:1,name:"file",action:"/admin/file/uploads.jhtml"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重新上传")])],1)],1)]),i("el-dialog",{staticClass:"before-upload",attrs:{"append-to-body":"",visible:e.uploadReview,width:"950px"},on:{close:e.cancelUplod}},[i("div",[i("img",{style:e.imgStyle,attrs:{src:e.formModel.path,alt:""}})]),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.uploadReview=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.conformUpload}},[e._v("确定上传")])],1)])],1)},R=[],D=(i("d81d"),i("ce2e")),$=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"invoice-info-order-supplier"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.invoiceList,(function(t){return i("el-card",{key:t.id},[i("div",[i("div",{staticClass:"radio-i",on:{click:function(i){return e.applyFor(t)}}},[i("el-radio",{attrs:{label:"1",size:"mini"},on:{change:function(i){return e.selectChange(t)}},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"invoice.checked"}},[i("span",{staticStyle:{color:"#ffffff"}},[e._v(".")])]),i("div",[i("div",{staticClass:"default"},[i("span",[e._v("发票抬头：")]),i("span",[e._v(e._s(t.invoiceTitle))]),"1"===t.isDefault?i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"mini"}},[e._v("默认")]):e._e()],1),i("div",{staticStyle:{"padding-top":"10px"}},[i("span",[e._v("发票类型：")]),i("span",[e._v(e._s("0"===t.invoiceType?"个人":"1"===t.invoiceType?"增值税普通发票":"2"===t.invoiceType?"增值税专用发票":""))])]),i("div",{staticStyle:{padding:"10px 0px"}},[i("span",[e._v("联系人：")]),i("span",[e._v(e._s(t.contacts))])]),i("div",[i("span",[e._v("联系电话：")]),i("span",[e._v(e._s(t.mobile))])]),i("div",{staticClass:"content-d"},[i("span",[e._v("详细地址：")]),i("span",[e._v(e._s(t.areaName+t.address))])])])],1),i("div",{staticClass:"bottom-d"},["0"===t.isDefault?i("span",{on:{click:function(i){return i.stopPropagation(),e.setDefault(t)}}},[e._v("设为默认")]):e._e(),i("span",{on:{click:function(i){return i.stopPropagation(),e.editForm(t)}}},[e._v("编辑")]),i("span",{on:{click:function(i){return i.stopPropagation(),e.deleteForm(t.id)}}},[e._v("删除")])])])])})),0===e.invoiceList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"发票信息"}}),i("el-form-item",{attrs:{label:"发票类型",prop:"consignee"}},[i("el-select",{model:{value:e.form.invoiceType,callback:function(t){e.$set(e.form,"invoiceType",t)},expression:"form.invoiceType"}},[i("el-option",{attrs:{label:"个人",value:"0"}}),i("el-option",{attrs:{label:"增值税普通发票",value:"1"}}),i("el-option",{attrs:{label:"增值税专用发票",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"发票抬头",prop:"invoiceTitle"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.invoiceTitle,callback:function(t){e.$set(e.form,"invoiceTitle",t)},expression:"form.invoiceTitle"}})],1),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"纳税人识别号",prop:"code"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"注册地址",prop:"registerAddress"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.registerAddress,callback:function(t){e.$set(e.form,"registerAddress",t)},expression:"form.registerAddress"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"注册电话",prop:"registerMobile"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.registerMobile,callback:function(t){e.$set(e.form,"registerMobile",t)},expression:"form.registerMobile"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.bank,callback:function(t){e.$set(e.form,"bank",t)},expression:"form.bank"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"银行账户",prop:"account"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1):e._e(),i("el-form-item",{attrs:{label:"邮寄地址"}}),i("el-form-item",{attrs:{label:"联系人",prop:"contacts"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.contacts,callback:function(t){e.$set(e.form,"contacts",t)},expression:"form.contacts"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"所在地区"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},L=[],E=i("8330"),O=i("c596"),z={components:{BizSaveButton:E["a"],BizAreaSelect:D["a"]},data:function(){return{invoiceList:[],invoiceInfoId:"",checked:"1",showForm:!1,dialogVisiable:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{invoiceType:[{required:!0,message:"请输入发票类型",trigger:"blur"}],invoiceTitle:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],code:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入注册地址",trigger:"blur"}],registerMobile:[{required:!0,message:"请输入注册电话",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],account:[{required:!0,message:"请输入银行账户",trigger:"blur"}],contacts:[{required:!0,message:"请输入联系人",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},props:{orderIds:{type:Array},invoiceAmount:{type:Number}},computed:Object(a["a"])(Object(a["a"])({},Object(_["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+h.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(a["a"])(Object(a["a"])({},Object(_["d"])("Order",["updateCurInvoice"])),{},{operate:function(e){this[e]()},applyFor:function(e){this.invoiceInfoId=e.id,this.$emit("selectedInvoice",e),this.updateCurInvoice(e)},cancle:function(){this.dialogVisiable=!1},close:function(){this.dialogVisiable=!1,this.$emit("close")},selectChange:function(e){this.invoiceList.map((function(t){t.id!==e.id&&(t.checked="0")}))},getDetaultModel:function(){return{account:"",address:"",areaId:"",area:{id:"1568"},areaName:"",bank:"",code:"",contacts:"",invoiceTitle:"",invoiceType:"0",isDefault:"",mobile:"",registerAddress:"",registerMobile:""}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除发票?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){b["a"].delete(O["g"].hypermarketMgmt.invoiceInfo,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,invoice:this.form};b["a"].post(O["g"].hypermarketMgmt.invoiceInfo,t).then((function(t){e.$message.success("添加成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateCurInvoice(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,invoice:this.form};b["a"].put(O["g"].hypermarketMgmt.invoiceInfo,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateCurInvoice(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};b["a"].get(O["g"].hypermarketMgmt.invoiceInfos,t).then((function(t){e.invoiceList=t.invoices||[],e.invoiceList.map((function(t){e.$set(t,"checked",t.isDefault)}))})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},N=z,B=(i("bf95"),Object(M["a"])(N,$,L,!1,null,null,null)),P=B.exports,j={name:"invoiceInfo",props:{itemId:{type:String},orderIds:{type:Array},userId:{type:String},price:{type:String},invoiceInfoId:{type:String},invoiceId:{type:String},open:{type:Boolean,default:function(){return!0}},isEdit:{type:Boolean,default:function(){return!0}},fileList:{type:Array,default:function(){return[]}}},components:{BizHeader:l["d"],BizGrid:g["a"],InvoiceInfoDialog:P,BizAreaSelect:D["a"]},data:function(){var e=this;return{loading:!1,formLoading:!1,isFirst:!0,expressName:"",expressSn:"",active:"",active1:"",active2:"",active3:"",showInvoiceExpress:!1,showLogisticsFollowing:!1,dialogVisiableInvoice:!1,shippingSn:"",shippingTraces:[],previewInvoice:!1,uploadReview:!1,logs:[],formModel:{id:"",invoiceType:"",invoiceTitle:"",price:"",code:"",registerAddress:"",registerMobile:"",bank:"",account:"",invoiceMode:"0",invoiceAmount:"",createDate:"",needMail:"0",contacts:"",mobile:"",area:{id:"1568"},address:"",express:"",expressCode:"",freight:"",zipCode:"",email:"",path:""},operations:[{label:"确认提交",name:"save",type:"primary",disabled:!1,class:"show"},{label:"撤销",name:"cancel",type:"primary",disabled:!1,class:"hidden"}],deliverys:[],rules:{mobile:[{required:!0,message:"电话不能少于5位",trigger:"blur",min:5},{pattern:/^[-0-9]*$/,message:"请输入数字",trigger:"blur"}],invoiceType:[{required:!0,message:"请选择发票类型",trigger:"blur"}],invoiceTitle:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],invoiceAmount:[{required:!0,message:"请输入发票金额",trigger:"blur"}],code:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入注册地址",trigger:"blur"}],registerMobile:[{required:!0,message:"请输入注册电话",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],account:[{required:!0,message:"请输入银行账户",trigger:"blur"}],needMail:[{required:!0,message:"请选择是否邮寄",trigger:"blur"}],contacts:[{required:!0,message:"请输入收票人",trigger:"blur"}],number:[{required:!0,message:"请输入电话",trigger:"blur"}],area:[{required:!0,message:"请选择所在地",trigger:"blur"},{trigger:"blur",validator:function(t,i,s){e.formModel.area.id?s():s(new Error("请选择所在地"))}}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],express:[{required:!0,message:"请选择快递公司",trigger:"blur"}],expressCode:[{required:!0,message:"请输入快递单号",trigger:"blur"}],freight:[{required:!0,message:"请输入物流费用",trigger:"blur"}]}}},watch:{open:function(e,t){this.formModel=this.clear(),console.log("11111111111111===="),e&&(this.$refs.formModel.clearValidate(),console.log(this.invoiceInfoId),console.log(this.invoiceId),this.invoiceInfoId&&!this.invoiceId?this.getInvoiceInit():this.getList())}},computed:Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(_["c"])(["getUser"])),Object(_["c"])("Order",["orderConfim","orderInfo","curInvoice","payment","defaultReceive","clickItemSelect"])),{},{judgeState:function(){if(console.log("invoiceState="+this.formModel.invoiceState),null!==this.formModel.invoiceState&&""!==this.formModel.invoiceState){if("2"===this.formModel.invoiceState||"3"===this.formModel.invoiceState)return!1;if("0"===this.formModel.needMail&&"1"===this.formModel.invoiceState)return!1}return!0},invoiceMode:function(){return"1"===this.formModel.invoiceMode&&"0"===this.formModel.invoiceState},showShippinig:function(){return"1"===this.formModel.invoiceState||"2"===this.formModel.invoiceState||"3"===this.formModel.invoiceState},getTraces:function(){return!!(this.shippingTraces&&this.shippingTraces.length>0)},imgStyle:function(){return{width:"100%",height:"100%"}}}),mounted:function(){console.log("22222222222222===="),this.invoiceInfoId&&!this.invoiceId?this.getInvoiceInit():this.getList()},methods:Object(a["a"])(Object(a["a"])({},Object(_["d"])("Order",["updateClickItemSelect"])),{},{clear:function(){return{id:"",invoiceType:"",invoiceTitle:"",price:"",code:"",registerAddress:"",registerMobile:"",bank:"",account:"",invoiceAmount:"",createDate:"",invoiceMode:"0",needMail:"0",contacts:"",mobile:"",area:{id:"1568"},address:"",express:"",expressCode:"",freight:"",zipCode:"",email:"",path:""}},cancelUplod:function(){this.uploadReview=!1},handleSuccess:function(e,t,i){console.log(e+"1111111"),e.fis&&e.fis[0]&&(this.fileList.push({uid:t.uid,url:e.fis[0].url}),this.formModel.path=e.fis[0].url),this.uploadReview=!0},conformUpload:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="1",c["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("上传成功"),e.getList(),e.$emit("operationSuccess"),e.uploadReview=!1}),(function(t){e.$message.warning(t.errorMessage)}))},handleError:function(e,t,i){e?this.$message.warning(e):this.$message.warning("发生错误")},selectedInvoice:function(e){this.dialogVisiableInvoice=!1,this.formModel.invoiceType=e.invoiceType,this.formModel.invoiceTitle=e.invoiceTitle,this.formModel.code=e.code,this.formModel.registerAddress=e.registerAddress,this.formModel.registerMobile=e.registerMobile,this.formModel.bank=e.bank,this.formModel.account=e.account,this.formModel.mobile=e.mobile,this.formModel.contacts=e.contacts,this.formModel.area.id=e.area.id,this.formModel.address=e.address},selectInvoice:function(){this.updateClickItemSelect(!0),this.dialogVisiableInvoice=!0},cancel:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="4",c["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("撤销成功"),e.formModel.invoiceState="",e.getList(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},expressInfo:function(){var e=this,t={userId:this.userId,shippingSn:this.shippingSn,shopId:this.getUser.shop.id};b["a"].get("/admin/purchaseOrder/logistics.jhtml",t).then((function(t){e.shippingTraces=t.shipping.shippingTraces,e.expressSn=t.shipping.expressSn,e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage),e.loading=!1}))},statusChange:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="2",c["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("保存成功"),e.showInvoiceExpress=!1,e.getList(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},returnUpload:function(e,t,i){var s=this;e.fis&&e.fis[0]&&(this.fileList.push({uid:t.uid,url:e.fis[0].url}),this.formModel.path=e.fis[0].url,this.formModel.orderId=this.itemId,this.formModel.invoiceState="1",c["a"].invoiceDetailUpdate(this.formModel,(function(e){s.$message.success("上传成功"),s.previewInvoice=!1,s.getList(),s.$emit("operationSuccess")}),(function(e){s.$message.warning(e.errorMessage)})))},invoiceTypeChange:function(){this.$refs.formModel.clearValidate("invoiceType")},expressChange:function(){this.$refs.formModel.clearValidate("express")},getLogs:function(){var e=this,t={userId:this.userId,orderId:this.itemId};b["a"].get("/rest/invoice/invoice.jhtml",t).then((function(t){e.logs=t.invoice.logs,e.active="",e.active1="",e.active2="",t.invoice.logs&&t.invoice.logs.length>0&&t.invoice.logs.forEach((function(t,i){"0"===t.type&&(e.active="1"),"1"===t.type&&(e.active1="2"),"2"===t.type&&(e.active2="3")})),e.shippingSn=t.invoice.shippingSn})).catch((function(e){console.log("ERR: ",e)})).finally((function(){}))},areaChanged:function(e){this.formModel.area.id=e,this.isFirst&&(this.formModel.area.id="1568",this.isFirst=!1)},getInvoiceInit:function(){var e=this;c["a"].invoiceInfoDefault({userId:this.userId||""},(function(t){e.formModel=Object.assign(e.clear(),t.invoiceInfo),console.log("this.price"),e.$set(e.formModel,"invoiceAmount",e.price),e.$set(e.formModel,"invoiceMode","0"),e.operations[1].class="hidden",e.operations[0].label="确认提交",e.logs=[],e.formModel.area.id||(e.formModel.area.id="1568")}),(function(t){console.log(t),e.loading=!1,console.log("code错误")}))},getList:function(){var e=this;this.loading=!0,this.showForm=!1,c["a"].invoiceByOrder({orderId:this.itemId||""},(function(t){e.formModel=Object.assign(e.clear(),t.invoice),"0"===e.formModel.invoiceMode?e.formModel.invoiceState?"0"===e.formModel.invoiceState?(e.operations[0].label="确认已开票",e.operations[0].class="show",e.operations[1].label="撤销",e.operations[1].class="show"):"1"===e.formModel.invoiceState?(e.operations[0].label="邮寄",e.operations[0].class="show",e.operations[1].class="hidden"):"2"===e.formModel.invoiceState?(e.operations[0].label="物流跟踪",e.operations[0].class="show",e.operations[1].class="hidden"):"4"===e.formModel.invoiceState?(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].label="已撤销",e.operations[1].class="show",e.formModel.invoiceState=""):e.operations[1].class="hidden":(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].class="hidden"):e.formModel.invoiceState?"0"===e.formModel.invoiceState?(e.operations[0].label="",e.operations[1].label="撤销",e.operations[1].class="show",e.operations[0].class="hidden"):"5"===e.formModel.invoiceState?(e.operations[0].label="查看电子发票",e.operations[0].class="show",e.operations[1].class="hidden"):"4"===e.formModel.invoiceState?(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].label="已撤销",e.operations[1].class="show",e.formModel.invoiceState=""):e.operations[1].class="hidden":(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].class="hidden"),e.formModel.area.id||(e.formModel.area.id="1568"),e.deliverys=t.deliverys,e.deliverys.map((function(i){i.id===t.invoice.express&&(e.expressName=i.name)})),e.getLogs(),e.loading=!1}),(function(t){e.formModel=e.clear(),e.loading=!1}))},handleOperate:function(e){this[e]()},save:function(){var e=this;this.$refs.formModel.validate((function(t){t&&(e.loading=!0,console.log("id="),console.log(e.formModel.id),e.$set(e.formModel,"orderIds",e.orderIds),e.formModel.id?("0"===e.formModel.invoiceMode?"0"===e.formModel.invoiceState?e.formModel.invoiceState="1":"1"===e.formModel.invoiceState?e.formModel.invoiceState="2":"2"===e.formModel.invoiceState?e.formModel.invoiceState="3":e.formModel.invoiceState="0":"0"===e.formModel.invoiceState?e.formModel.invoiceState="1":"4"!==e.formModel.invoiceState&&""!==e.formModel.invoiceState||(e.formModel.invoiceState="0"),"0"===e.formModel.invoiceMode?"2"===e.formModel.invoiceState?(e.formModel.express="",e.formModel.expressCode="",e.loading=!1,e.showInvoiceExpress=!0):"3"===e.formModel.invoiceState?(e.formModel.invoiceState="2",e.expressInfo(),e.showLogisticsFollowing=!0):(e.formModel.orderId=e.itemId,c["a"].invoiceDetailUpdate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage),"3"===e.formModel.invoiceState?e.formModel.invoiceState="2":"2"===e.formModel.invoiceState?e.formModel.invoiceState="1":(e.formModel.invoiceState,e.formModel.invoiceState="0")}))):"5"===e.formModel.invoiceState?(e.getList(),e.previewInvoice=!0,e.loading=!1):(e.formModel.orderId=e.itemId,c["a"].invoiceDetailUpdate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})))):(e.formModel.invoiceState="0",e.formModel.orderId=e.itemId,c["a"].invoiceDetailCreate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))))}))}})},A=j,q=(i("3e77"),Object(M["a"])(A,T,R,!1,null,null,null)),U=q.exports,F=i("ce0c"),V=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"logistics-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}):e._e(),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.shippings,size:"small"}},[i("el-table-column",{attrs:{label:"配送方式",prop:"shippingMethod","min-width":"80"}}),i("el-table-column",{attrs:{label:"物流公司",prop:"logistics","min-width":"80"}}),i("el-table-column",{attrs:{label:"物流单号",prop:"expressSn","min-width":"80"}}),i("el-table-column",{attrs:{label:"物流费用",prop:"freight","min-width":"80"}}),i("el-table-column",{attrs:{label:"收货地址",prop:"address","min-width":"80"}}),i("el-table-column",{attrs:{label:"商品",prop:"","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[i("div",{staticStyle:{width:"100%","margin-right":"30px"}},e._l(t.row.shippingItems,(function(t){return i("div",{key:t.id},[e._v(e._s(t.name)+"x"+e._s(t.quantity))])})),0)])]}}])}),i("el-table-column",{attrs:{prop:"title",label:"操作","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.detailClickHandler(t.row)}}},[e._v("详情")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.certificate(t.row.id)}}},[e._v("凭证")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.followClickHandler(t.row)}}},[e._v("物流跟踪")])],1)]}}])})],1),i("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showLogistics,expression:"showLogistics"}],ref:"logisticsForm",attrs:{size:"small","label-width":"110px",model:e.form,rules:e.rules,"inline-message":!0}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.orderItems,size:"small"}},[i("el-table-column",{attrs:{label:"商品",prop:"name","min-width":"80"}}),i("el-table-column",{attrs:{label:"条码",prop:"barCode","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))])}}])}),i("el-table-column",{attrs:{label:"已发货数量","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e._v(e._s(t.row.shippedQuantity))])}}])}),e.isShipped?e._e():i("el-table-column",{attrs:{label:"本次发货数量"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input-number",{attrs:{size:"mini",min:0,disabled:e.isShipped||t.row.isDisabled},model:{value:t.row.unShippedQuantity,callback:function(i){e.$set(t.row,"unShippedQuantity",i)},expression:"scope.row.unShippedQuantity"}})],1)])}}],null,!1,120378921)})],1),i("el-form-item",{attrs:{label:"配送方式",prop:"shippingMethodId"}},[e.isShipped?e._e():i("el-select",{attrs:{placeholder:"请选择配送方式",disabled:e.isShipped},model:{value:e.form.shippingMethodId,callback:function(t){e.$set(e.form,"shippingMethodId",t)},expression:"form.shippingMethodId"}},[i("el-option",{attrs:{label:"空",value:""}}),e._l(e.shippingMethod,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],2),e.isShipped?i("el-input",{attrs:{disabled:e.isShipped},model:{value:e.form.shippingMethodName,callback:function(t){e.$set(e.form,"shippingMethodName",t)},expression:"form.shippingMethodName"}}):e._e()],1),i("el-form-item",{attrs:{label:"零担物流",prop:"isLCL"}},[i("el-switch",{attrs:{disabled:e.isShipped,"active-value":"1","inactive-value":"0","active-color":"#ff7300","inactive-color":"#d9d9d9"},model:{value:e.form.isLCL,callback:function(t){e.$set(e.form,"isLCL",t)},expression:"form.isLCL"}})],1),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"物流公司",prop:"deliveryCorpId"}},[i("el-select",{attrs:{filterable:"",disabled:e.isShipped,placeholder:"请选择物流公司"},model:{value:e.form.deliveryCorpId,callback:function(t){e.$set(e.form,"deliveryCorpId",t)},expression:"form.deliveryCorpId"}},e._l(e.deliveryCorps,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"物流单号",prop:"expressSn"}},[i("el-input",{attrs:{disabled:e.isShipped||"1"===e.form.isLCL,placeholder:"请输入物流单号"},model:{value:e.form.expressSn,callback:function(t){e.$set(e.form,"expressSn",t)},expression:"form.expressSn"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"物流费用",prop:"freight"}},[i("el-input-number",{attrs:{min:0,disabled:e.isShipped,placeholder:"请输入物流费用"},model:{value:e.form.freight,callback:function(t){e.$set(e.form,"freight",t)},expression:"form.freight"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"收货店铺",prop:"receiveStore"}},[i("el-input",{attrs:{disabled:e.isShipped,placeholder:"请输入收货店铺"},model:{value:e.form.receiveStore,callback:function(t){e.$set(e.form,"receiveStore",t)},expression:"form.receiveStore"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"收货地址",prop:"address"}},[i("el-input",{attrs:{disabled:e.isShipped,placeholder:"请输入收货地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"收货人",prop:"consignee"}},[i("el-input",{attrs:{disabled:e.isShipped,placeholder:"请输入收货人"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"电话",prop:"phone"}},[i("el-input",{attrs:{disabled:e.isShipped,placeholder:"请输入电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1):e._e(),i("div",{staticClass:"close-button"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showLogistics=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1),i("el-dialog",{attrs:{visible:e.dialogShipping,center:"",width:"1200px","append-to-body":"","custom-class":"printDialog"},on:{"update:visible":function(t){e.dialogShipping=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.formShipping.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单状态："+e._s("1"===e.shippingsPrint.shippingStatus?"订单已部分发货":"订单已执行"))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("发货时间："+e._s(e.shippingsPrint.shippingDate?e.shippingsPrint.shippingDate.split(" ")[0]:""))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.shippingsPrint.logistics))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shippingsPrint.expressSn))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流费用："+e._s(e.shippingsPrint.freight))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingsPrint.consignee))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingsPrint.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货地址："+e._s(e.shippingsPrint.address))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1)],1)},H=[],Q={name:"LogisticsInfo",components:{BizSaveButton:E["a"],BizGrid:g["a"],vueEasyPrint:y["a"]},data:function(){return{operations:[{label:"添加",name:"addLogistics",type:"primary"}],rules:{freight:[{required:!0,message:"请输入物流费用",trigger:"blur"}],address:[{required:!0,message:"请输入收货地址",trigger:"blur"}],consignee:[{required:!0,message:"请输入收货人",trigger:"blur"}],receiveStore:[{required:!0,message:"请输入收货店铺",trigger:"blur"}],phone:[{required:!0,message:"请输入电话",trigger:"blur"}]},logisticsList:[],isShipped:!1,detailList:[],showLogistics:!1,loading:!1,orderItems:[],form:{shippings:[],orderItems:[],shippingMethodId:"",isLCL:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",receiveStore:"",phone:"",shippingMethodName:""},dialogShipping:!1,formShipping:{},title:"",gridData:[],shippingsPrint:"",shippingMethod:[],deliveryCorps:[],paymentTypes:[],paymentMethods:[],shippingId:"",showDelivery:!1,showReceiver:!1,flag:!0}},computed:{},props:{itemId:{type:String},open:{type:Boolean,default:function(){return!1}},isEdit:{type:Boolean,default:function(){return!0}},handler:{type:String}},created:function(){},mounted:function(){this.init()},methods:Object(a["a"])(Object(a["a"])({},Object(_["c"])(["getUser"])),{},{getDefaultForm:function(){return{shippings:[],orderItems:[],shippingMethodId:"",isLCL:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",receiveStore:"",phone:"",shippingMethodName:""}},print:function(){this.$refs.easyPrint.print()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),s=t.getMonth()+1,r=t.getDate(),o=i+"-"+(s<10?"0"+s:s)+"-"+(r<10?"0"+r:r);return o},printExport:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,s,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={shippingId:e.shippingId},t.prev=1,t.next=4,I.a.post("/admin/purchaseOrder/voucher/export/shipping.jhtml",i,{responseType:"blob"});case 4:return s=t.sent,console.log("response => ",s),r=new Blob([s.data],{type:"application/vnd.ms-excel"}),o=decodeURI(s.headers["content-disposition"].split("filename=")[1]),a=document.createElement("a"),a.download=o.match(/"(\S*)"/)[1],a.style.display="none",a.href=URL.createObjectURL(r),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},certificate:function(e){var t=this,i={shippingId:e};b["a"].get("/admin/purchaseOrder/voucher/shipping.jhtml",i).then((function(i){t.dialogShipping=!0,t.title=t.getUser().shop?t.getUser().shop.name+"发货单":"发货单",t.formShipping=i.order,t.shippingId=e,t.shippingsPrint=i.shipping,t.gridData=i.shipping.shippingItems})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},addLogistics:function(){this.isShipped=!1,this.form.shippingMethodId="",this.form.isLCL="",this.form.deliveryCorpId="",this.form.expressSn="",this.form.freight="",this.form.address="",this.form.consignee="",this.form.receiveStore="",this.form.phone="",this.showLogistics=!0,this.init()},init:function(){var e=this;console.log("init"),c["a"].viewOrder({orderId:this.itemId},(function(t){e.form.address=t.order.address,e.form.consignee=t.order.consignee,e.form.receiveStore=t.order.receiveStore,e.form.phone=t.order.phone,e.form.shippings=t.order.shippings,e.form.orderItems=t.order.orderItems,e.form.orderItems.forEach((function(e,t){"0"===e.unShippedQuantity?e.isDisabled=!0:e.isDisabled=!1})),e.orderItems=t.order.orderItems,console.log(e.form),e.shippingMethod=t.shippingMethods,e.deliveryCorps=t.deliveryCorps}),(function(t){e.$message.warning(t.errorMessage)}))},save:function(){var e=this;this.$refs.logisticsForm.validate((function(t,i){if(!t)return!1;e.loading=!0;var s="";e.shippingMethod.map((function(t){t.id===e.form.shippingMethodId&&(s=t.name)}));var r="";e.deliveryCorps.map((function(t){t.id===e.form.deliveryCorpId&&(r=t.name)}));var o=[];if(e.form.orderItems.forEach((function(e,t){0===e.unShippedQuantity&&o.push(e)})),o.length===e.form.orderItems.length)return e.$message.warning("本次发货数量不能为0"),e.loading=!1,!1;var a={id:e.itemId,shippingMethodId:e.form.shippingMethodId,isLCL:e.form.isLCL,deliveryCorpId:e.form.deliveryCorpId,expressSn:e.form.expressSn,freight:e.form.freight,address:e.form.address,consignee:e.form.consignee,receiveStore:e.form.receiveStore,phone:e.form.phone,shippingMethod:s,logistics:r,shippingItems:e.form.orderItems.map((function(e){return{orderItemId:e.id,quantity:e.unShippedQuantity,name:e.name}}))},n=function(t){e.$message.success("保存成功"),e.init(),e.$emit("operationSuccess",e.form.id),e.showLogistics=!1,e.loading=!1},l=function(t){t.errorMessage&&e.$message.warning(t.errorMessage),e.loading=!1},c=function(t){e.loading=!1};b["a"].put("/admin/purchaseOrderManage/partialShipping.jhtml",a).then(n).catch(l).finally(c)}))},detailClickHandler:function(e){var t=this;console.log(e),this.isShipped=!0,e.shippingItems.map((function(e){t.orderItems.map((function(t){e.name===t.name&&(e.product=t.product)})),e.shippedQuantity=e.quantity})),this.form.orderItems=e.shippingItems,this.form.isLCL=e.isLCL,this.form.deliveryCorpId=e.deliveryCorpId,this.form.expressSn=e.expressSn,this.form.freight=e.freight,this.form.address=e.address,this.form.consignee=e.consignee,this.form.receiveStore=e.receiveStore,this.form.phone=e.phone,this.form.shippingMethodName=e.shippingMethod,this.shippingMethod.map((function(e){e.name===t.form.shippingMethodName&&(t.form.shippingMethodId=e.id,"1"===e.isNeedDelivery&&(t.showDelivery=!0))})),this.showLogistics=!0},followClickHandler:function(){this.$emit("goToOrderLogs")},operateHandler:function(e){this[e]()}}),watch:{itemId:function(e){this.showLogistics=!1,this.init(),"shipping"===this.handler?this.showLogistics=!0:this.showLogistics=!1},form:{deep:!0,immediate:!0,handler:function(e){var t=this;this.showDelivery=!1,this.showReceiver=!1,this.shippingMethod.map((function(i){i.id===e.shippingMethodId&&"1"===i.isNeedDelivery&&(t.showDelivery=!0),i.id===e.shippingMethodId&&"1"===i.isNeedReceiver&&(t.showReceiver=!0)}))}}}},W=Q,G=(i("8244"),Object(M["a"])(W,V,H,!1,null,null,null)),K=G.exports,Y=i("443b"),J={name:"OrderMgmtList",data:function(){return{iframeSrc:"",shippings:"",showIframe:!1,closeDeccription:"",curSelectCloseReason:"",errorImg:'this.src="'+i("b89e")+'"',curSelectDateType:"全部",dateTypeList:["全部","今日订单","近一周订单","近一月订单","近三月订单"],reasonList:[{label:"长时间联系不到客户，交易不成功",value:"长时间联系不到客户，交易不成功"},{label:"客户购买意向不明确，取消交易",value:"客户购买意向不明确，取消交易"},{label:"客户已通过其他渠道支付款项",value:"客户已通过其他渠道支付款项"},{label:"客户不想买了",value:"客户不想买了"},{label:"重复订单",value:"重复订单"},{label:"缺货，订单无法完成",value:"缺货，订单无法完成"},{label:"其他理由",value:"其他理由"}],tabName:"info",memberInfo:!1,openInvocie:!1,itemId:"",userId:"",title:"",handler:"",memberId:{id:""},editShopIds:[],isEdit:!0,isPend:!1,form:{},userCard:{},paymentMethodName:"",orderType:"",orderState:"",invoiceState:"",invoiceInfoId:"",invoiceId:"",price:"",realName:"",defaultTab:"0",activeNames:["1"],orderIds:[],loading:!1,visiable:!1,open:!1,openSetting:!1,dialogTableVisible:!1,selections:[],operations:[{label:"刷新",name:"refresh",type:""},{label:"导出",name:"export",type:""},{label:"合并开票",name:"mergeInvioce",type:"",disabled:!0}],filters:[{type:"select",label:"状态",name:"state",value:"",class:"hidden",options:[{value:"",label:"全部"},{value:"1",label:"待商家确认"},{value:"2",label:"商家已确认"},{value:"3",label:"买家已付款"},{value:"4",label:"订单已执行"},{value:"5",label:"交易完成"},{value:"6",label:"订单关闭"},{value:"7",label:"已评价"},{value:"9",label:"退款退货中"},{value:"12",label:"部分支付"},{value:"13",label:"部分发货"}]},{type:"select",label:"发票",name:"invoiceState",value:"",class:"hidden",options:[{value:"",label:"全部"},{value:"0",label:"待开票"},{value:"1",label:"待邮寄"}]},{type:"select",label:"时间类型",name:"dateType",value:"0",class:"hidden",options:[{value:"0",label:"创建时间"},{value:"1",label:"完成时间"}]},{type:"daterange",label:"日期",class:"hidden",name:"publishDate",value:[]},{type:"input",label:"",placeholder:"请输入订单编号/姓名/电话/条码",name:"searchValue",value:""}],tableData:[],gridData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9},showCloseOrder:!1,showRecommend:!1}},mixins:[Y["a"]],components:{BizPopupTabs:n["a"],BizFlexTable:l["c"],BaseInfo:d["a"],ProductInfo:p["a"],vueEasyPrint:y["a"],AfterProcess:u["a"],OrderLogs:x,InvoiceInfo:U,LogisticsInfo:K},created:function(){this.getList(),this.queryOrderKpi()},watch:{},computed:{toggleRecommendTxt:function(){var e=this.showRecommend;return e?"收起":"筛选"}},mounted:function(){},methods:Object(a["a"])(Object(a["a"])({},Object(_["c"])(["getUser"])),{},{isShow:function(){this.showRecommend?(this.filters[0].class="hidden",this.filters[1].class="hidden",this.filters[2].class="hidden",this.filters[3].class="hidden"):(this.filters[0].class="show",this.filters[1].class="show",this.filters[2].class="show",this.filters[3].class="show"),this.showRecommend=!this.showRecommend},goToOrderLogs:function(){this.tabName="loginfo",this.open=!0},xrorder:function(){this.iframeSrc="http://122.143.21.152/xymx/userinajLoginAction.action?name=jianwl&&pwd=123456",this.showIframe=!0},logistics:function(e){this.iframeSrc="http://122.143.21.152/xymx/getzaitupageDeliveryAction.action?num="+e,this.showIframe=!0},operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.itemId="",this.getList()},operationSuccess:function(){this.open=!1,this.getList()},getType:function(e){switch(e){case"0":return"车品订单";case"1":return"充值订单";case"2":return"服务订单";case"3":return"一键救援订单";case"4":return"服务订单";case"5":return"服务订单";case"6":return"预约置换订单";case"7":return"贷款购车订单";case"8":return"试乘试驾订单";case"9":return"整车订单";case"10":return"普通订单";case"17":return"优惠券订单";default:return""}},onChangeDateType:function(e){switch(e){case"今日订单":this.filters[3].value=[F["a"].today(),F["a"].today()];break;case"近一周订单":this.filters[3].value=[F["a"].getBeforeWeek(),F["a"].today()];break;case"近一月订单":this.filters[3].value=[F["a"].getPreOneMonthDay(),F["a"].today()];break;case"近三月订单":this.filters[3].value=[F["a"].getPreThreeMonthDay(),F["a"].today()];break;default:this.filters[3].value=[];break}this.getList()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),s=t.getMonth()+1,r=t.getDate(),o=i+"-"+(s<10?"0"+s:s)+"-"+(r<10?"0"+r:r);return o},setOrderItems:function(e){this.tabName="info",this.$refs.baseInfo.setOrderItems(e)},cancelClose:function(){this.showCloseOrder=!1},confirmClose:function(){var e=this;this.curSelectCloseReason?(this.showCloseOrder=!1,this.loading=!0,c["a"].closeOrder({orderId:this.itemId,shopId:window.top.SHOP_ID||"",reason:this.curSelectCloseReason,memo:this.closeDeccription},(function(t){e.loading=!1,e.$message.success("操作成功"),e.getList()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))):this.$message.warning("请选择关闭理由")},print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,s,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={orderId:e.orderId},t.prev=1,t.next=4,I.a.post("/admin/purchaseOrder/voucher/export/settlement.jhtml",i,{responseType:"blob"});case 4:return s=t.sent,console.log("response => ",s),r=new Blob([s.data],{type:"application/vnd.ms-excel"}),o=decodeURI(s.headers["content-disposition"].split("filename=")[1]),a=document.createElement("a"),a.download=o.match(/"(\S*)"/)[1],a.style.display="none",a.href=URL.createObjectURL(r),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},certificate:function(e){var t=this;window.dType=e.dType,c["a"].certificate({orderId:e.id,shopId:window.top.SHOP_ID||""},(function(i){t.dialogTableVisible=!0,t.title=t.getUser().shop?t.getUser().shop.name+"结算单":"结算单",t.form=i.order,t.orderId=e.id,t.realName=i.adminCurrent?i.adminCurrent.realName:"",t.userCard=i.userCard,t.gridData=i.order.orderItems}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},queryOrderKpi:function(){var e=this,t={type:"1",shopId:window.top.SHOP_ID||""};b["a"].get("/admin/purchaseOrderManage/kpi.jhtml",t).then((function(t){e.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:"今日新增".concat(t.data.dayNewAdd,"条，待审核").concat(t.data.dayUnconfirmed,"条，待发货").concat(t.data.dayConfirmed,"条"),duration:3e3})})).catch((function(t){e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},export:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,s,r,o,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=[],e.selections&&e.selections.length>0&&e.selections.forEach((function(e){i.push(e.id)})),s={ids:i,orderId:e.$route.query.id||"",dateType:e.filters[2].value,searchValue:e.filters[4].value,orderType:e.orderType,state:e.filters[0].value,invoiceState:e.filters[1].value||"",beginTime:e.filters[3].value[0]?e.filters[3].value[0]+" 00:00:00":"",endTime:e.filters[3].value[1]?e.filters[3].value[1]+" 23:59:59":"",pageNumber:e.pagination.currentPage,pageSize:e.pagination.pageSize},t.prev=3,t.next=6,I.a.post("/admin/purchaseOrderManage/supplierSalesOrders/export.jhtml",s,{responseType:"blob"});case 6:return r=t.sent,console.log("response => ",r),o=new Blob([r.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(r.headers["content-disposition"])),a=decodeURI(r.headers["content-disposition"].split("filename=")[1]),n=document.createElement("a"),n.download=a.match(/"(\S*)"/)[1],n.style.display="none",n.href=URL.createObjectURL(o),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n),t.abrupt("return");case 22:throw t.prev=22,t.t0=t["catch"](3),new Error(t.t0);case 25:case"end":return t.stop()}}),t,null,[[3,22]])})))()},rowClick:function(e,t,i){var s=this;this.tabName="info",this.orderState=e.type,this.itemId=e.id,this.userId=e.member.id,this.activeNames=["1"],this.open=!0,this.handler="",this.orderIds=[e.id],this.price=0,this.price=(Number(e.amount)+Number(this.price)).toFixed(2),this.invoiceInfoId=e.invoiceInfoId,this.invoiceId=e.invoiceId,window.dType="purchaseOrder",this.paymentMethodName=e.paymentMethodName,this.$nextTick((function(){s.$refs.loginfo.refresh(s.itemId)})),this.isPend=!1,this.shippings=e.shippings},getList:function(){var e=this,t={orderId:this.$route.query.id||"",dateType:this.filters[2].value,searchValue:this.filters[4].value,orderType:this.orderType,state:this.filters[0].value,invoiceState:this.filters[1].value||"",beginTime:this.filters[3].value[0]?this.filters[3].value[0]+" 00:00:00":"",endTime:this.filters[3].value[1]?this.filters[3].value[1]+" 23:59:59":"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};this.loading=!0,b["a"].get("/admin/purchaseOrderManage/supplierSalesOrders.jhtml",t).then((function(t){console.log(t),e.tableData=t.dataList,e.pagination.total=Number(t.total),e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t)})).finally((function(t){e.loading=!1}))},refreshList:function(){var e=this,t={orderId:this.$route.query.id||"",dateType:this.filters[2].value,searchValue:this.filters[4].value,orderType:this.orderType,state:this.filters[0].value,invoiceState:this.filters[1].value||"",beginTime:this.filters[3].value[0]?this.filters[3].value[0]+" 00:00:00":"",endTime:this.filters[3].value[1]?this.filters[3].value[1]+" 23:59:59":"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};b["a"].get("/admin/purchaseOrderManage/supplierSalesOrders.jhtml",t).then((function(t){console.log(t),e.tableData=t.dataList,e.pagination.total=Number(t.total)})).catch((function(t){e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},paymentHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.tabName="info",this.itemId=e.id,this.activeNames=["3"],this.handler="payment",this.open=!0},refundsHandler:function(e){var t=this;window.dType="purchaseOrder",this.orderState=e.type,this.itemId=e.id,this.tabName="afterprocess",this.open=!0,this.$nextTick((function(){t.$refs.afterprocess.initData()}))},serviceHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.tabName="productinfo",this.itemId=e.id,this.activeNames=["2"],this.handler="service",this.open=!0},excuteHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.tabName="info",this.itemId=e.id,this.activeNames=["2"],this.handler="service",this.open=!0},shippingHandler:function(e){var t=this;window.dType=e.dType,this.orderState=e.type,this.tabName="logisticsinfo",this.itemId=e.id,this.handler="shipping",this.open=!0,this.$nextTick((function(){t.$refs.logisticsinfo.init()}))},invoiceHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.open=!0,this.tabName="invoice",this.orderIds=[e.id],this.itemId=e.id,this.userId=e.member.id,this.invoiceInfoId=e.invoiceInfoId,this.invoiceId=e.invoiceId,this.price=e.amount},mergeInvioce:function(){var e=this;window.dType="purchaseOrder",this.itemId=this.selections[0].id,this.invoiceInfoId=this.selections[0].invoiceInfoId,this.invoiceId=this.selections[0].invoiceId,this.userId=this.selections[0].member.id,this.orderState="1",this.openInvocie=!0,this.tabName="invoice",this.orderIds=[],this.price=0,this.selections.forEach((function(t){e.orderIds.push(t.id),e.price=Number(t.amount)+Number(e.price)})),this.price=this.price.toFixed(2)},closeOrder:function(e){window.dType=e.dType,this.itemId=e.id,this.showCloseOrder=!0,this.curSelectCloseReason="",this.closeDeccription=""},select:function(e,t){console.log(t)},handleSelectionChange:function(e){this.operations[2].disabled=!0,this.selections=e,e.length>0&&(this.operations[2].disabled=!1);var t=[];for(var i in this.selections)-1===t.indexOf(this.selections[i].agent.id)&&t.push(this.selections[i].agent.id);t.length>1&&(this.operations[2].disabled=!0)},filterDataChange:function(e){this.pagination.currentPage=1,this.refresh()},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},getOrderStatus:function(e){switch(e.type){case"13":return"部分发货";case"12":return"部分支付";case"11":return"卖家已发货";case"10":return"退款退货完成";case"9":return"退款退货中";case"8":return"已过期";case"7":return"已评价";case"6":return"订单关闭";case"5":return"交易完成";case"4":return"订单已执行";case"3":return"买家已付款";case"2":return"商家已确认";case"1":return"待商家确认";default:return"无"}},getInvoiceStatus:function(e){switch(e.invoiceState){case"5":return"已开票";case"4":return"已撤销";case"3":return"已签收";case"2":return"已邮寄";case"1":return"待邮寄";case"0":return"待开票";default:return"未申请"}}})},X=J,Z=(i("c59b"),Object(M["a"])(X,s,r,!1,null,null,null));t["default"]=Z.exports},b547:function(e,t,i){},b89e:function(e,t,i){e.exports=i.p+"static/img/pic_default_fail.876971c2.png"},bc9e:function(e,t,i){"use strict";var s=i("d7bd"),r=i.n(s);r.a},bf95:function(e,t,i){"use strict";var s=i("45e9"),r=i.n(s);r.a},c59b:function(e,t,i){"use strict";var s=i("e7a9"),r=i.n(s);r.a},d79d:function(e,t,i){"use strict";var s=i("2b9a"),r=i.n(s);r.a},d7bd:function(e,t,i){},e7a9:function(e,t,i){},ec6b:function(e,t,i){"use strict";var s=i("b547"),r=i.n(s);r.a},f65f:function(e,t,i){}}]);