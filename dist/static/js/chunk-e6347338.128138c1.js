(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e6347338"],{"0943":function(e,t,a){"use strict";var i=a("1fac"),o=a.n(i);o.a},"0a3d":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-fence-map"},[a("div",{staticClass:"fencemap",attrs:{id:"fencemap"}})])}],n=(a("99af"),a("d81d"),a("ac1f"),a("1276"),{name:"BizFenceMap",components:{},props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:function(){return"0"}},carState:{type:Object,default:function(){return{}}},icon:{type:Object,default:function(){return{}}}},data:function(){return{params:{rectLng1:"",rectLat1:"",rectLng2:"",rectLat2:"",rectLng3:"",rectLat3:"",rectLng4:"",rectLat4:"",circleLng:"",circleLat:"",radius:"",polygon:"",area:""},fenceType:"",overlaysCache:[],styleOptions:{strokeColor:"red",fillColor:"red",strokeWeight:3,strokeOpacity:.8,fillOpacity:.6,strokeStyle:"solid"}}},watch:{value:{handler:function(e,t){}},carState:{deep:!0,handler:function(e,t){this.initLocation(e)}},type:{deep:!0,handler:function(e,t){for(var a=0;a<e.length;a++)t[a]!==e[a]&&(this.fenceType=e[a],this.initFence())}}},methods:{init:function(e){var t=this;this.$BMap=window.BMap,this.map=new this.$BMap.Map("fencemap"),e&&e.longitude&&e.latitude?this.point=new this.$BMap.Point(e.longitude,e.latitude):this.point=new this.$BMap.Point(125.31364243,43.89833761),this.map.enableScrollWheelZoom(!0),this.map.addControl(new window.BMap.CityListControl({anchor:window.BMAP_ANCHOR_TOP_LEFT,offset:this.$BMap.Size(10,20)}));var a=[],i=function(e){for(var i=0;i<a.length;i++)t.map.removeOverlay(a[i]);if(a.push(e.overlay),"circle"===e.drawingMode){t.params.circleLng=e.overlay.getCenter().lng,t.params.circleLat=e.overlay.getCenter().lat,t.params.radius=e.overlay.getRadius(),t.$emit("paramsChange",t.params);for(var o=e.overlay.getPath().length,n=[],l=0;l<o;l++)n.push([e.overlay.getPath()[l].lng,e.overlay.getPath()[l].lat]);t.overlaysCache=n,t.map.clearOverlays(),a.push(e.overlay);var r=t.overlaysCache,s=[];for(var c in r)s.push(new t.$BMap.Point(r[c][0],r[c][1]));var d=s,u=new t.$BMap.Polygon(d,t.styleOptions);t.map.addOverlay(u)}else if("rectangle"===e.drawingMode){if(void 0!==e.overlay.getPath()||null!==e.overlay.getPath()){t.params.rectLng1=e.overlay.getPath()[0].lng,t.params.rectLat1=e.overlay.getPath()[0].lat,t.params.rectLng2=e.overlay.getPath()[1].lng,t.params.rectLat2=e.overlay.getPath()[1].lat,t.params.rectLng3=e.overlay.getPath()[2].lng,t.params.rectLat3=e.overlay.getPath()[2].lat,t.params.rectLng4=e.overlay.getPath()[3].lng,t.params.rectLat4=e.overlay.getPath()[3].lat,t.$emit("paramsChange",t.params);for(var p=e.overlay.getPath().length,h=[],g=0;g<p;g++)h.push([e.overlay.getPath()[g].lng,e.overlay.getPath()[g].lat]);t.overlaysCache=h,t.map.clearOverlays(),a.push(e.overlay);var m=t.overlaysCache,f=[];for(var v in m)f.push(new t.$BMap.Point(m[v][0],m[v][1]));var b=f,y=new t.$BMap.Polygon(b,t.styleOptions);t.map.addOverlay(y)}}else if("polygon"===e.drawingMode){t.showLatLon(e.overlay.getPath()),t.map.clearOverlays(),a.push(e.overlay);var M=t.overlaysCache,w=[];for(var C in M)w.push(new t.$BMap.Point(M[C][0],M[C][1]));var I=w,S=new t.$BMap.Polygon(I,t.styleOptions);t.map.addOverlay(S),S.enableEditing(),S.addEventListener("lineupdate",(function(e){t.showLatLon(e.currentTarget.getPath())}))}};if("2"!==this.fenceType){var o=new window.BMapLib.DrawingManager(this.map,{isOpen:!1,enableDrawingTool:!0,drawingToolOptions:{anchor:window.BMAP_ANCHOR_TOP_RIGHT,offset:new this.$BMap.Size(5,5),drawingModes:["0"===this.fenceType?window.BMAP_DRAWING_CIRCLE:"1"===this.fenceType?window.BMAP_DRAWING_RECTANGLE:"3"===this.fenceType?window.BMAP_DRAWING_POLYGON:""]},circleOptions:this.styleOptions,polylineOptions:this.styleOptions,polygonOptions:this.styleOptions,rectangleOptions:this.styleOptions});o.addEventListener("overlaycomplete",i)}if(this.icon.path){var n=new this.$BMap.Icon(this.icon.path+"/map_grey.png",new this.$BMap.Size(40,82)),l=new this.$BMap.Marker(this.point,{icon:n});this.map.addOverlay(l)}else{var r=new this.$BMap.Marker(this.point);this.map.addOverlay(r)}},initFence:function(){var e=this,t=[],a=function(a){for(var i=0;i<t.length;i++)e.map.removeOverlay(t[i]);if(t.push(a.overlay),"circle"===a.drawingMode)e.params.circleLng=a.overlay.getCenter().lng,e.params.circleLat=a.overlay.getCenter().lat,e.params.radius=a.overlay.getRadius(),e.$emit("paramsChange",e.params);else if("rectangle"===a.drawingMode)void 0===a.overlay.getPath()&&null===a.overlay.getPath()||(e.params.rectLng1=a.overlay.getPath()[0].lng,e.params.rectLat1=a.overlay.getPath()[0].lat,e.params.rectLng2=a.overlay.getPath()[1].lng,e.params.rectLat2=a.overlay.getPath()[1].lat,e.params.rectLng3=a.overlay.getPath()[2].lng,e.params.rectLat3=a.overlay.getPath()[2].lat,e.params.rectLng4=a.overlay.getPath()[3].lng,e.params.rectLat4=a.overlay.getPath()[3].lat,e.$emit("paramsChange",e.params));else if("polygon"===a.drawingMode){e.showLatLon(a.overlay.getPath()),e.map.clearOverlays(),t.push(a.overlay);var o=e.overlaysCache,n=[];for(var l in o)n.push(new e.$BMap.Point(o[l][0],o[l][1]));var r=n,s=new e.$BMap.Polygon(r,e.styleOptions);e.map.addOverlay(s),s.enableEditing(),s.addEventListener("lineupdate",(function(t){e.showLatLon(t.currentTarget.getPath())}))}};if("2"!==this.fenceType){var i=new window.BMapLib.DrawingManager(this.map,{isOpen:!1,enableDrawingTool:!0,drawingToolOptions:{anchor:window.BMAP_ANCHOR_TOP_RIGHT,offset:new this.$BMap.Size(5,5),drawingModes:["0"===this.fenceType?window.BMAP_DRAWING_CIRCLE:"1"===this.fenceType?window.BMAP_DRAWING_RECTANGLE:"3"===this.fenceType?window.BMAP_DRAWING_POLYGON:""]},circleOptions:this.styleOptions,polylineOptions:this.styleOptions,polygonOptions:this.styleOptions,rectangleOptions:this.styleOptions});i.addEventListener("overlaycomplete",a)}if(this.icon.path){var o=new this.$BMap.Icon(this.icon.path+"/map_grey.png",new this.$BMap.Size(40,82)),n=new this.$BMap.Marker(this.point,{icon:o});this.map.addOverlay(n)}else{var l=new this.$BMap.Marker(this.point);this.map.addOverlay(l)}},showLatLon:function(e){for(var t=e.length,a="",i=[],o=0;o<t;o++)i.push([e[o].lng,e[o].lat]),a+=e[o].lng+","+e[o].lat+";";this.overlaysCache=i,this.params.polygon=a,this.$emit("paramsChange",this.params)},clearOverlays:function(){this.map.clearOverlays()},initLocation:function(e){if(e&&e.longitude&&e.latitude&&(this.point=new this.$BMap.Point(e.longitude,e.latitude)),this.map.centerAndZoom(this.point,13),this.map.enableScrollWheelZoom(!0),this.map.clearOverlays(),this.icon.path){var t=new this.$BMap.Icon(this.icon.path+"/map_grey.png",new this.$BMap.Size(40,82)),a=new this.$BMap.Marker(this.point,{icon:t});this.map.addOverlay(a)}else{var i=new this.$BMap.Marker(this.point);this.map.addOverlay(i)}this.initFence()},initEditFenceMap:function(e){var t=this;if(this.fenceType=e.type,this.init(this.carState),"0"===e.type){var a=new this.$BMap.Circle(new this.$BMap.Point(e.circleLng,e.circleLat),e.radius,{strokeColor:"red",fillColor:"red",strokeWeight:3,strokeOpacity:.8,fillOpacity:.3,strokeStyle:"solid"});if(this.map.addOverlay(a),e.circleLng&&e.circleLat){var i=new this.$BMap.Point(e.circleLng,e.circleLat);this.map.centerAndZoom(i,13)}}else if("1"===e.type){var o=new this.$BMap.Polygon([new this.$BMap.Point(e.rectLng1,e.rectLat1),new this.$BMap.Point(e.rectLng2,e.rectLat2),new this.$BMap.Point(e.rectLng3,e.rectLat3),new this.$BMap.Point(e.rectLng4,e.rectLat4)],{strokeColor:"red",fillColor:"red",strokeWeight:3,strokeOpacity:.8,fillOpacity:.3,strokeStyle:"solid"});if(this.map.addOverlay(o),e.rectLng1&&e.rectLat1){var n=new this.$BMap.Point(e.rectLng1,e.rectLat1);this.map.centerAndZoom(n,13)}}else if("3"===e.type){var l=[];l=e.polygon.split(";");for(var r=[],s=0;s<l.length;s++){var c=[];c=l[s].split(","),r.push(new this.$BMap.Point(c[0],c[1]))}var d=r,u=new this.$BMap.Polygon(d,this.styleOptions);this.map.addOverlay(u),r.length>0&&this.map.centerAndZoom(r[0],13)}else if("2"===e.type)if(this.$nextTick((function(){var a=new t.$BMap.Boundary;a.get(e.fullName,(function(e){t.map.clearOverlays();var a=e.boundaries.length;if(0!==a){for(var i=[],o=0;o<a;o++){var n=new t.$BMap.Polygon(e.boundaries[o],t.styleOptions);t.map.addOverlay(n),i=i.concat(n.getPath())}t.map.setViewport(i)}}))})),this.icon.path){var p=new this.$BMap.Icon(this.icon.path+"/map_grey.png",new this.$BMap.Size(40,82)),h=new this.$BMap.Marker(this.point,{icon:p});this.map.addOverlay(h)}else{var g=new this.$BMap.Marker(this.point);this.map.addOverlay(g)}}},created:function(){this.fenceType=this.type},mounted:function(){this.init(this.carState)}}),l=n,r=(a("d05d"),a("2877")),s=Object(r["a"])(l,i,o,!1,null,null,null),c=s.exports;a.d(t,"a",(function(){return c}))},"1fac":function(e,t,a){},2497:function(e,t,a){"use strict";var i=a("4360"),o=a("a18c");t["a"]=function(e,t){return function(a){var n=a.data;"100"===n.resultCode?e(n):"709"===n.resultCode?(i["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",i["a"].getters.currentUser),o["a"].push("/login")):t(n)}}},"25eb":function(e,t,a){var i=a("23e7"),o=a("c20d");i({target:"Number",stat:!0,forced:Number.parseInt!=o},{parseInt:o})},"274b":function(e,t,a){},"38c8":function(e,t,a){},"39ec":function(e,t,a){"use strict";var i=a("78a1"),o=a.n(i);o.a},"3fad":function(e,t,a){"use strict";var i=a("274b"),o=a.n(i);o.a},"439f":function(e,t,a){"use strict";a("4160"),a("159b");t["a"]={clearMessageBoxes:function(){var e=document.querySelectorAll(".el-message");e.forEach((function(e){e.remove()}))}}},4516:function(e,t,a){"use strict";var i=a("ad62"),o=a.n(i);o.a},"45cd":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vehicle-mgmt-all-vehicle"},[i("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,pagination:e.pagination,tableData:e.tableData,loading:e.loading},on:{operate:e.operateHandler,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"selection-change":e.selectionChangeHandler,"filter-data-change":e.filterDataChangeHandler,"row-click":e.rowOperationClickHandler}},[i("el-table-column",{attrs:{label:"名称","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"customer-info"},[t.row.head?i("img",{attrs:{src:t.row.head}}):i("img",{attrs:{src:a("624d")}}),i("div",{staticClass:"wrapper"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.handleRouterPush(a,t.row)}}},[e._v(" "+e._s(t.row.name)+" ")])],1)])]}}])}),i("el-table-column",{attrs:{prop:"area.name",label:"地址","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"customer-info"},[e._v(" "+e._s(t.row.area&&t.row.area.name?t.row.area.name:"北京市朝阳区")+" ")])]}}])}),i("el-table-column",{attrs:{prop:"memberCount",label:"成员数"}}),i("el-table-column",{attrs:{prop:"shop.name",label:"所属店铺","min-width":"130"}}),i("el-table-column",{attrs:{prop:"owner.name",label:"管理员","min-width":"100"}}),i("el-table-column",{attrs:{prop:"tag",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return"1"===t.row.unionConfig.editable||"shop"!==e.getUser().roleLevel?[e.hasAuthDel?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.deleteHandler(a,t.row)}}},[e._v(" 删除 ")]):e._e()]:void 0}}],null,!0)})],1),i("div",{attrs:{slot:"float"},slot:"float"},[i("el-dialog",{attrs:{title:"导入",visible:e.dialogUploadVisible,width:"500px"},on:{"update:visible":function(t){e.dialogUploadVisible=t}}},[i("el-form",{ref:"uploadForm",attrs:{size:"small","label-width":"110px",model:e.uploadModel,rules:e.uploadRules}},[i("el-form-item",{attrs:{label:"导入文件",prop:"file",value:e.uploadModel.file}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.uploadModel.file,expression:"uploadModel.file"}]},[e._v(e._s(e.uploadModel.file))]),i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.handleFileUploadSuccess,data:e.fileData,name:"file",action:"/admin/file/uploads.jhtml"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1),i("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.uploadOperations},on:{operate:e.operateHandler}})],1),i("motorcade-popup",{attrs:{open:e.open,itemId:e.itemId,isEdit:e.isEdit},on:{close:function(t){e.open=!1},operationSuccess:e.operationSuccess}})],1)],1)},o=[],n=(a("4160"),a("caad"),a("d81d"),a("b0c0"),a("a9e3"),a("25eb"),a("2532"),a("159b"),a("5530")),l=a("04d3"),r=a("8330"),s=a("2f62"),c=a("d0124"),d=a("1ab1"),u=a("2497"),p=a("bc3a"),h=a.n(p),g=a("c596"),m={query:function(e,t,a){h.a.get(g["g"].vehicleMgmt.VehicleMgmtMotorcade_query,{params:e}).then(Object(u["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){h.a.delete(g["g"].vehicleMgmt.MotorcadeBaseInfo_motorcade,{data:e}).then(Object(u["a"])(t,a)).catch((function(e){console.error(e)}))},upload:function(e,t,a){h.a.post(g["g"].vehicleMgmt.MotorcadeBaseInfo_motorcade,e).then(Object(u["a"])(t,a)).catch((function(e){console.error(e)}))}},f={name:"VehicleMgmtMotorcade",components:{BizFlexTable:l["c"],BizSaveButton:r["a"],MotorcadePopup:c["a"]},props:{},data:function(){return{itemId:{id:""},classId:"",selections:[],editShopIds:[],open:!1,loading:!1,isEdit:!0,tableData:[],operations:[{label:"新增",name:"add",type:"primary",auth:["caradmin:operateFleet.add"]},{label:"删除",name:"delete",type:"",disabled:!0,auth:["caradmin:operateFleet.delete"]},{label:"刷新",name:"refresh",type:""}],filters:[{type:"select",label:"所属店铺",name:"shopName",filterable:!0,value:"",options:[]},{type:"input",label:"",placeholder:"请输入名称",name:"searchValue",value:""}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogUploadVisible:!1,uploadModel:this.getDefaultUploadForm(),uploadRules:{file:[{required:!0,message:"请选择上传文件",trigger:"blur"}]},uploadOperations:[{label:"取消",name:"cancelUpload"},{label:"保存",name:"saveUpload",type:"primary",auth:["caradmin:operateFleet.edit"]}],fileData:{type:"0"}}},computed:Object(n["a"])(Object(n["a"])({},Object(s["c"])("Authority",["currentAuth"])),{},{hasAuthDel:function(){return this.currentAuth.includes("caradmin:operateFleet.delete")}}),methods:Object(n["a"])(Object(n["a"])({},Object(s["c"])(["getUser"])),{},{deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,m.delete({ids:e},(function(e){t.loading=!1,t.$message.success("删除成功"),t.query()}),(function(e){t.$message.warning(e.errorMessage),t.loading=!1}))}))},getEditableStores:function(){var e=this;d["a"].get(g["j"].editableStores,{resourceType:"7"}).then((function(t){e.editShopIds=[],t.dataList.map((function(t){e.editShopIds.push(t.id)}))})).catch((function(e){console.log(e),console.log("code错误")}))},queryShopList:function(){var e=this;d["a"].get("/admin/member/json/findEShops.jhtml",{shopId:window.top.SHOP_ID||"",sourceType:"7"}).then((function(t){var a=t.shops;a.map((function(e){e.value=e.id,e.label=e.name})),a.unshift({value:"",label:"全部"}),e.$set(e.filters[0],"options",a)})).catch((function(t){console.log(t),console.log("code错误"),"店铺不存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},operationSuccess:function(){this.open=!1,this.query()},operateHandler:function(e){this[e]()},pageSizeChange:function(e){this.pagination.pageSize=e,this.pagination.currentPage=1,this.query()},currentPageChange:function(e){this.pagination.currentPage=e,this.query()},rowOperationClickHandler:function(e,t,a){"操作"!==a.label&&("0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel?this.isEdit=!1:this.isEdit=!0,this.itemId={id:e.id,userId:this.getUser().id},this.open=!0)},selectionChangeHandler:function(e){this.selections=e,this.operations[1].disabled=!0,this.operations[0].disabled=!1,(e.length>0||"shop"!==this.getUser().roleLevel)&&(this.operations[1].disabled=!1)},filterDataChangeHandler:function(){this.pagination.currentPage=1,this.query()},deleteHandler:function(e,t){this.deleteItem([t.id])},handleRouterPush:function(e,t){e.stopPropagation(),this.$router.push({name:"vehicle-mgmt-motorcade-vehicle",params:{groupId:t.id}})},refresh:function(){this.query()},getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,searchShopId:this.filters[0].value,searchValue:this.filters[1].value,fleetType:"group"}},query:function(){var e=this;this.loading=!0,m.query(this.getQueryParams(),(function(t){if(e.tableData=t.content,e.$set(e.pagination,"total",Number.parseInt(t.total)),!e.inited){var a="已建立车队数 "+t.fleetCount+", 车队车辆总数 "+t.memberTotalCount;e.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:a,duration:3e3}),e.inited=!0}e.loading=!1}),(function(t){console.log(t),console.log("code错误"),e.loading=!1,"店铺不存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},add:function(){this.open=!0,this.itemId={id:""}},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一个车队")},getDefaultUploadForm:function(){return{file:""}},cancelUpload:function(){this.dialogUploadVisible=!1},saveUpload:function(){var e=this;this.$refs.uploadForm.validate((function(t,a){if(!t)return!1;m.upload({file:e.uploadModel.file},(function(t){e.$message.success("保存成功")}),(function(t){e.$message.warning(t.errorMessage)}))}))},handleFileUploadSuccess:function(e){console.log(e),this.uploadModel.file=e.fis[0].url}}),created:function(){this.query(),this.queryShopList(),this.getEditableStores()}},v=f,b=(a("8983"),a("2877")),y=Object(b["a"])(v,i,o,!1,null,null,null);t["default"]=y.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var i=a("1d80"),o=a("5899"),n="["+o+"]",l=RegExp("^"+n+n+"*"),r=RegExp(n+n+"*$"),s=function(e){return function(t){var a=String(i(t));return 1&e&&(a=a.replace(l,"")),2&e&&(a=a.replace(r,"")),a}};e.exports={start:s(1),end:s(2),trim:s(3)}},"5b8e":function(e,t,a){"use strict";var i=a("9678"),o=a.n(i);o.a},6401:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-empty-table",style:e.emptyStyle})},o=[],n=a("f260"),l=a.n(n),r={name:"",data:function(){return{EmptyImg:l.a}},components:{},computed:{emptyStyle:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+l.a+") 50% 50% / auto 200px no-repeat"}}},methods:{},mounted:function(){}},s=r,c=a("2877"),d=Object(c["a"])(s,i,o,!1,null,null,null);t["a"]=d.exports},"697f":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),a("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?a("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},o=[],n=(a("99af"),a("4160"),a("c975"),a("a434"),a("a9e3"),a("159b"),a("04d3")),l={name:"BizDialogSelector",components:{BizFlexTable:n["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var a=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(a,1),this.innerSelection.splice(a,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a>=0&&t.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},r=l,s=(a("0943"),a("2877")),c=Object(s["a"])(r,i,o,!1,null,null,null);t["a"]=c.exports},7132:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},o=[],n={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},l=n,r=(a("5b8e"),a("2877")),s=Object(r["a"])(l,i,o,!1,null,null,null),c=s.exports,d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},u=[],p=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),h=p,g=(a("d4c2"),Object(r["a"])(h,d,u,!1,null,null,null)),m=g.exports;a.d(t,"a",(function(){return m}))},"78a1":function(e,t,a){},8983:function(e,t,a){"use strict";var i=a("38c8"),o=a.n(i);o.a},"92a6":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),l=a("c596");t["a"]={query:function(e,t,a){n.a.get(l["g"].vehicleMgmt.VehicleElecFence_query,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryRule:function(e,t,a){n.a.get(l["g"].vehicleMgmt.VehicleElecFence_fence,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},deleteRule:function(e,t,a){n.a.delete(l["g"].vehicleMgmt.VehicleElecFence_fence,{data:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateRule:function(e,t,a){n.a.put(l["g"].vehicleMgmt.VehicleElecFence_fence,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},addRule:function(e,t,a){n.a.post(l["g"].vehicleMgmt.VehicleElecFence_fence,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},9678:function(e,t,a){},"9ecb":function(e,t,a){},a9e3:function(e,t,a){"use strict";var i=a("83ab"),o=a("da84"),n=a("94ca"),l=a("6eeb"),r=a("5135"),s=a("c6b6"),c=a("7156"),d=a("c04e"),u=a("d039"),p=a("7c73"),h=a("241c").f,g=a("06cf").f,m=a("9bf2").f,f=a("58a8").trim,v="Number",b=o[v],y=b.prototype,M=s(p(y))==v,w=function(e){var t,a,i,o,n,l,r,s,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=f(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+c}for(n=c.slice(2),l=n.length,r=0;r<l;r++)if(s=n.charCodeAt(r),s<48||s>o)return NaN;return parseInt(n,i)}return+c};if(n(v,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var C,I=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof I&&(M?u((function(){y.valueOf.call(a)})):s(a)!=v)?c(new b(w(t)),a,I):w(t)},S=i?h(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),P=0;S.length>P;P++)r(b,C=S[P])&&!r(I,C)&&m(I,C,g(b,C));I.prototype=y,y.constructor=I,l(o,v,I)}},ad62:function(e,t,a){},af3f:function(e,t,a){"use strict";var i=a("697f");t["a"]=i["a"]},c20d:function(e,t,a){var i=a("da84"),o=a("58a8").trim,n=a("5899"),l=i.parseInt,r=/^[+-]?0[Xx]/,s=8!==l(n+"08")||22!==l(n+"0x16");e.exports=s?function(e,t){var a=o(String(e));return l(a,t>>>0||(r.test(a)?16:10))}:l},d0124:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("motorcade-base-info",{attrs:{itemId:e.itemId,isEdit:e.isEdit},on:{operationSuccess:e.operationSuccess}})],1),e.itemId.id?a("el-tab-pane",{attrs:{label:"公告",name:"1"}},[a("motorcade-notice",{attrs:{itemId:e.itemId,isEdit:e.isEdit},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId.id?a("el-tab-pane",{attrs:{label:"电子围栏",name:"2"}},[a("vehicle-elec-fence",{attrs:{itemId:e.itemId,isMotorcade:!0,motorcadeId:e.itemId,isEdit:e.isEdit},on:{operationSuccess:e.operationSuccess}})],1):e._e()],1)},o=[],n=a("7132"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"vehicle-mgmt-motorcade__base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{size:"small","label-width":"130px",model:e.formModel,rules:e.rules,disabled:!e.isEdit,"inline-message":!0}},[a("el-form-item",{attrs:{label:"所属店铺",prop:"shop"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.shop.id,callback:function(t){e.$set(e.formModel.shop,"id",t)},expression:"formModel.shop.id"}},e._l(e.shopList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"车队名称",prop:"name"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"请输入车队名称"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"简介"}},[a("el-input",{attrs:{type:"textarea",maxlength:"100",placeholder:"请输入车队简介"},model:{value:e.formModel.remark,callback:function(t){e.$set(e.formModel,"remark",t)},expression:"formModel.remark"}})],1),a("el-form-item",{attrs:{label:"地址",prop:"lngBaidu",value:e.formModel.lngBaidu}},[a("biz-area-select",{attrs:{areaId:e.formModel.area.id},on:{areaChanged:e.handleAreaChanged}})],1),a("el-form-item",{attrs:{label:"头像",prop:"head",value:e.formModel.head}},[a("biz-avatar-uploader-new",{model:{value:e.formModel.head,callback:function(t){e.$set(e.formModel,"head",t)},expression:"formModel.head"}})],1),a("el-form-item",{attrs:{label:"成员",prop:"memberIds",value:e.formModel.memberIds}},[a("el-input",{attrs:{readonly:""},model:{value:e.formModel.memberIds.length,callback:function(t){e.$set(e.formModel.memberIds,"length",t)},expression:"formModel.memberIds.length"}},[a("el-button",{attrs:{slot:"append"},on:{click:e.handleMemberClick},slot:"append"},[e._v("选择")])],1),a("member-vehicle-picker",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"memberPicker",attrs:{fleetId:e.fleetId,title:"成员选择",all:!1},on:{"on-confirm":e.handleConfirm}})],1),a("el-form-item",[a("div",{attrs:{slot:"label"},slot:"label"},[e._v(" 开启费用审核 "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:onTimePop",arg:"onTimePop"}],attrs:{type:"text",size:"small"}},[a("i",{staticClass:"iconfont el-icon-question"})]),a("el-popover",{ref:"onTimePop",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"开启费用审核后该车队人员提交用车账单时需要管理员确认是否审核通过，关闭费用审核则所有用车账单自动设置为审核通过"}})],1),a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","inactive-color":"#d9d9d9","active-color":"#87d068"},model:{value:e.formModel.needVerify,callback:function(t){e.$set(e.formModel,"needVerify",t)},expression:"formModel.needVerify"}})],1),a("el-form-item",{attrs:{label:"群二维码"}},[a("div",[a("img",{directives:[{name:"show",rawName:"v-show",value:e.formModel.id,expression:"formModel.id"}],staticStyle:{width:"210px",position:"relative"},attrs:{src:e.formModel.qrCode}})]),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.formModel.id,expression:"!formModel.id"}],staticStyle:{color:"#999"}},[e._v("建立车队后系统生成车队唯一二维码标识")])])],1)],1)},r=[],s=(a("99af"),a("d81d"),a("b0c0"),a("f36f")),c=a("8330"),d=a("f8b2"),u=a("c17f"),p=a("ce2e"),h=a("2497"),g=a("bc3a"),m=a.n(g),f=a("c596"),v={query:function(e,t,a){m.a.get(f["g"].vehicleMgmt.MotorcadeBaseInfo_query,{params:e}).then(Object(h["a"])(t,a)).catch((function(e){console.error(e)}))},queryShopList:function(e,t,a){m.a.get(f["g"].vehicleMgmt.Component_queryShops,{params:e}).then(Object(h["a"])(t,a)).catch((function(e){console.error(e)}))},add:function(e,t,a){m.a.post(f["g"].vehicleMgmt.MotorcadeBaseInfo_motorcade,e).then(Object(h["a"])(t,a)).catch((function(e){console.error(e)}))},update:function(e,t,a){m.a.put(f["g"].vehicleMgmt.MotorcadeBaseInfo_motorcade,e).then(Object(h["a"])(t,a)).catch((function(e){console.error(e)}))}},b={name:"MotorcadeBaseInfo",components:{BizSaveButton:c["a"],BizGrid:s["a"],BizAvatarUploaderNew:u["b"],BizAreaSelect:p["a"],MemberVehiclePicker:d["a"]},data:function(){var e=this;return{loading:!1,fleetId:"",pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},operations:[{label:"保存",name:"save",type:"primary",auth:["caradmin:operateFleet.edit"]}],rules:{shop:[{required:!0,validator:function(t,a,i){e.formModel.shop.id?i():i(new Error("请选择所属店铺"))}}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]},shopList:[],formModel:this.getDefaultModel()}},props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},created:function(){this.itemId.id&&this.query(),this.queryShopList()},methods:{query:function(){var e=this;v.query({id:this.itemId.id,terminalTypeId:"2"},(function(t){var a=Object.assign(e.getDefaultModel(),t.content);e.formModel=a,e.fleetId=e.formModel.id;var i=!0;e.shopList.map((function(t){t.id===e.formModel.shop.id&&(i=!1)})),i&&(e.shopList=e.shopList.concat([{name:e.formModel.shop.name,id:e.formModel.shop.id}])),e.$refs.form.resetFields()}),(function(e){console.log(e),console.log("code错误")}))},queryShopList:function(){var e=this;v.queryShopList({},(function(t){e.shopList=t.storeList}),(function(e){console.log(e),console.log("code错误")}))},getSaveParams:function(){return{id:this.formModel.id,name:this.formModel.name,head:this.formModel.head,remark:this.formModel.remark,areaId:this.formModel.area.id,needVerify:this.formModel.needVerify,shopId:this.formModel.shop.id,memberIds:this.formModel.memberIds}},resetModel:function(){var e=this.getDefaultModel();e.shop.id=this.shopList[0]&&this.shopList[0].id?this.shopList[0].id:"",this.formModel=e},getDefaultModel:function(){return{head:"",memberIds:[],shop:{id:""},area:{id:"1568"}}},operateHandler:function(e){this[e]()},handleAddressChange:function(e){this.formModel.address=e},handleAreaChanged:function(e){this.formModel.area.id=e},handleMemberClick:function(e){this.$refs.memberPicker.selectionKeys=this.formModel.memberIds,this.$refs.memberPicker.showDialog=!0},handleConfirm:function(e){this.$set(this.formModel,"memberIds",e)},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0,e.formModel.id?v.update(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),e.loading=!1})):v.add(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),e.loading=!1}))}))}},computed:{point:{get:function(){return{lng:this.formModel.lngBaidu,lat:this.formModel.latBaidu}},set:function(e){e&&(this.formModel.lngBaidu=e.lng,this.formModel.latBaidu=e.lat)}}},watch:{itemId:function(e,t){this.$refs.form.$el.scrollTop=0,e.id?this.query():(this.resetModel(),this.$refs.form.resetFields())}}},y=b,M=(a("4516"),a("2877")),w=Object(M["a"])(y,l,r,!1,null,null,null),C=w.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"vehicle-mgmt-all-vehicle__notice"},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,disabled:!e.isEdit}},[a("el-form-item",{attrs:{label:"公告标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入4-20字公告标题"},model:{value:e.formModel.title,callback:function(t){e.$set(e.formModel,"title",t)},expression:"formModel.title"}})],1),a("el-form-item",{attrs:{label:"公告内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入公告内容"},model:{value:e.formModel.content,callback:function(t){e.$set(e.formModel,"content",t)},expression:"formModel.content"}})],1)],1),e.isEdit?a("biz-save-button",{attrs:{operations:e.innerOperations},on:{operate:e.operateHandler}}):e._e()],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"notice-list"},[e._l(e.list,(function(t){return[a("div",{key:t.id,staticClass:"notice-item"},[a("div",{staticClass:"title"},[e._v(e._s(t.title))]),a("div",{staticClass:"date"},[e._v(e._s(t.sendTime))]),a("div",{staticClass:"content"},[e._v(e._s(t.content))]),e.isEdit?a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleDeleteClick(a,t)}}},[a("i",{staticClass:"iconfont biz-icon-iconfontshanchu1"})]):e._e()],1)]}))],2)],1)},S=[],P={query:function(e,t,a){m.a.get(f["g"].vehicleMgmt.MotorcadeNotice_query,{params:e}).then(Object(h["a"])(t,a)).catch((function(e){console.error(e)}))},add:function(e,t,a){m.a.post(f["g"].vehicleMgmt.MotorcadeNotice_notice,e).then(Object(h["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){m.a.delete(f["g"].vehicleMgmt.MotorcadeNotice_notice,{data:e}).then(Object(h["a"])(t,a)).catch((function(e){console.error(e)}))}},$={name:"MotorcadeNotice",components:{BizSaveButton:c["a"],BizGrid:s["a"]},data:function(){return{loading:!1,pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},rules:{title:[{required:!0,message:"请输入公告标题",trigger:"blur"},{min:4,max:20,message:"长度不小于4位，不大于20位",trigger:"blur"}],content:[{required:!0,message:"请输入公告内容",trigger:"blur"},{min:10,max:500,message:"长度不小于10位，不大于500位",trigger:"blur"}]},formModel:this.getDefaultModel(),list:[],innerOperations:[{label:"发布",name:"save",type:"primary",auth:["caradmin:operateFleet.edit"]}]}},props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},created:function(){},methods:{init:function(){this.itemId.id?this.query():this.list=[]},query:function(){var e=this;this.loading=!0,P.query({fleetId:this.itemId.id},(function(t){e.list=t.content,e.resetModel(),e.loading=!1}),(function(t){console.log(t),console.log("code错误"),e.loading=!1}))},getSaveParams:function(){return{fleetId:this.itemId.id,title:this.formModel.title,content:this.formModel.content}},resetModel:function(){this.formModel=this.getDefaultModel(),this.$refs.form&&this.$refs.form.resetFields()},getDefaultModel:function(){return{title:"",content:""}},operateHandler:function(e){this[e]()},handleDeleteClick:function(e,t){var a=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){P.delete({ids:[t.id]},(function(e){a.$message.success("删除成功"),a.query()}),(function(e){a.$message.warning(e.errorMessage)}))}))},add:function(){this.resetModel(),this.$refs.form.resetFields()},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;P.add(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.query(),e.resetModel()}),(function(t){e.$message.warning(t.errorMessage)}))}))}},computed:{},watch:{itemId:function(e,t){this.init()}},mounted:function(){this.init()}},L=$,_=(a("3fad"),Object(M["a"])(L,I,S,!1,null,null,null)),O=_.exports,k=a("ea3d"),D=a("439f"),B={name:"MotorcadePopup",components:{BizPopupTabs:n["a"],MotorcadeBaseInfo:C,MotorcadeNotice:O,VehicleElecFence:k["a"]},props:{open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}},itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{tabSelection:"0"}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)}},watch:{open:function(e){var t=this;e&&setTimeout((function(){t.tabSelection="0",t.$message({showClose:!0,message:t.itemId.id?"车队名称、简介、地址、头像等基本信息均在此修改哦":"填写车队基本信息、选择车辆至车队后点击保存，车队就创建成功啦"})}),500)},tabSelection:function(e){switch(this.$refs.dataStreamTab&&this.$refs.dataStreamTab.clearInterval(),D["a"].clearMessageBoxes(),e){case"0":this.$message({showClose:!0,message:this.itemId.id?"车队名称、简介、地址、头像等基本信息均在此修改哦":"填写车队基本信息、选择车辆至车队后点击保存，车队就创建成功啦"});break;case"1":this.$message({showClose:!0,message:"您可在此发布公告，车队成员将在群聊中查看到此公告"});break;case"2":this.$message({showClose:!0,message:"新建、删除、修改电子围栏，实现对车队车辆的监控"});break}}}},z=B,T=Object(M["a"])(z,i,o,!1,null,null,null);t["a"]=T.exports},d05d:function(e,t,a){"use strict";var i=a("9ecb"),o=a.n(i);o.a},d4c2:function(e,t,a){"use strict";var i=a("e725"),o=a.n(i);o.a},e4c3:function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),l=a("c596");t["a"]={queryPeople:function(e,t,a){n.a.get(l["g"].vehicleMgmt.Component_queryPeople,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryVehicles:function(e,t,a,o){n.a.get(e,{params:t}).then(Object(i["a"])(a,o)).catch((function(e){console.error(e)}))}}},e725:function(e,t,a){},ea3d:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"vehicle-mgmt-all-vehicle__vehicle-elec-fence"},[e.isEdit?a("biz-header",{attrs:{slot:"top",operations:e.ruleTableOperations},on:{operate:e.operateHandler,rowClick:e.rowEditClickHandler},slot:"top"}):e._e(),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"100%",size:"small"},on:{"selection-change":e.selectionChangeHandler}},[a("biz-empty-table-tab",{attrs:{slot:"empty"},slot:"empty"}),a("el-table-column",{attrs:{type:"selection",width:"30"}}),a("el-table-column",{attrs:{prop:"name",label:"围栏名称"}}),a("el-table-column",{attrs:{prop:"count",label:"监控车辆数量",width:"100"}}),a("el-table-column",{attrs:{prop:"terminalCount",label:"监控设备数量",width:"100"}}),a("el-table-column",{attrs:{prop:"title",label:"操作","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return e.isEdit?[e.isCar?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.monitorState(t.row)}}},[e._v(" "+e._s("0"===t.row.state?"监控":"取消监控")+" ")]):e._e(),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.rowEditClickHandler(t.row,a)}}},[e._v(" 编辑 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.rowDeleteClickHandler(a,t.row)}}},[e._v(" 删除 ")])]:void 0}}],null,!0)})],1),a("el-dialog",{staticClass:"vehicle-elec-fence__details-dialog",attrs:{slot:"float",title:"电子围栏",visible:e.dialogVisible,fullscreen:!0,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}},slot:"float"},[a("div",{staticClass:"details-dialog__content"},[a("div",{staticClass:"dialog-form"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.ruleLoading,expression:"ruleLoading"}],ref:"ruleForm",attrs:{size:"small","label-width":"110px",model:e.ruleModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"围栏名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入围栏名称"},model:{value:e.ruleModel.name,callback:function(t){e.$set(e.ruleModel,"name",t)},expression:"ruleModel.name"}})],1),a("el-form-item",{attrs:{label:"启用",prop:"isEnabled"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","inactive-color":"#d9d9d9","active-color":"#87d068"},model:{value:e.ruleModel.isEnabled,callback:function(t){e.$set(e.ruleModel,"isEnabled",t)},expression:"ruleModel.isEnabled"}})],1),a("el-form-item",{attrs:{label:"触发方式",prop:"triggerMethod"}},[a("el-radio-group",{model:{value:e.ruleModel.triggerMethod,callback:function(t){e.$set(e.ruleModel,"triggerMethod",t)},expression:"ruleModel.triggerMethod"}},[a("el-radio",{attrs:{label:"0"}},[e._v("进围栏")]),a("el-radio",{attrs:{label:"1"}},[e._v("出围栏")]),a("el-radio",{attrs:{label:"2"}},[e._v("进出围栏")])],1)],1),a("el-form-item",{attrs:{label:"围栏类型",prop:"type"}},[a("el-radio-group",{on:{change:e.typeChange},model:{value:e.ruleModel.type,callback:function(t){e.$set(e.ruleModel,"type",t)},expression:"ruleModel.type"}},[a("el-radio",{attrs:{label:"0"}},[e._v("圆形")]),a("el-radio",{attrs:{label:"1"}},[e._v("矩形")]),a("el-radio",{attrs:{label:"3"}},[e._v("多边形")]),a("el-radio",{attrs:{label:"2"}},[e._v("行政区划")])],1),a("biz-area-select",{directives:[{name:"show",rawName:"v-show",value:"2"===e.ruleModel.type,expression:"ruleModel.type === '2'"}],attrs:{areaId:e.ruleModel.areaId},on:{areaChanged:e.areaChanged}})],1),a("el-form-item",{attrs:{label:"超速限制",prop:"overspeed"}},[a("el-input",{attrs:{type:"number",min:"0"},model:{value:e.ruleModel.overspeed,callback:function(t){e.$set(e.ruleModel,"overspeed",t)},expression:"ruleModel.overspeed"}})],1),a("el-form-item",{attrs:{label:"围栏种类",prop:"category"}},[a("el-radio-group",{model:{value:e.ruleModel.category,callback:function(t){e.$set(e.ruleModel,"category",t)},expression:"ruleModel.category"}},[a("el-radio",{attrs:{label:"0"}},[e._v("个人")]),a("el-radio",{directives:[{name:"show",rawName:"v-show",value:e.isMotorcadeMode(),expression:"isMotorcadeMode()"}],attrs:{label:"1"}},[e._v("车队")])],1)],1),a("el-form-item",{attrs:{label:"监控车辆"}},[a("vehicle-picker",{attrs:{motorcadeId:e.motorcadeId.id,userId:e.itemId.userId},model:{value:e.ruleModel.carIds,callback:function(t){e.$set(e.ruleModel,"carIds",t)},expression:"ruleModel.carIds"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.isMotorcadeMode(),expression:"!isMotorcadeMode()"}],attrs:{label:"监控设备"}},[a("terminal-picker",{attrs:{motorcadeId:e.motorcadeId.id,userId:e.itemId.userId},model:{value:e.ruleModel.terminalIds,callback:function(t){e.$set(e.ruleModel,"terminalIds",t)},expression:"ruleModel.terminalIds"}})],1),a("el-form-item",{attrs:{prop:"startTime"}},[a("div",{staticStyle:{display:"inline-block"},attrs:{slot:"label"},slot:"label"},[e._v(" 开始时间 "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:startTime",arg:"startTime"}],attrs:{type:"text",size:"small"}},[a("i",{staticClass:"iconfont el-icon-question"})]),a("el-popover",{ref:"startTime",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"您可设置开始时间和结束时间，在此时间段内车辆出发围栏报警时将提示到车主"}})],1),a("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"01:00",end:"23:00"},placeholder:"选择时间"},model:{value:e.ruleModel.startTime,callback:function(t){e.$set(e.ruleModel,"startTime",t)},expression:"ruleModel.startTime"}})],1),a("el-form-item",{attrs:{prop:"endTime"}},[a("div",{staticStyle:{display:"inline-block"},attrs:{slot:"label"},slot:"label"},[e._v(" 结束时间 "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:endTime",arg:"endTime"}],attrs:{type:"text",size:"small"}},[a("i",{staticClass:"iconfont el-icon-question"})]),a("el-popover",{ref:"endTime",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"您可设置开始时间和结束时间，在此时间段内车辆出发围栏报警时将提示到车主"}})],1),a("el-time-select",{attrs:{"picker-options":{start:"00:59",step:"01:00",end:"23:59"},placeholder:"选择时间"},model:{value:e.ruleModel.endTime,callback:function(t){e.$set(e.ruleModel,"endTime",t)},expression:"ruleModel.endTime"}})],1)],1),e.isEdit?a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.ruleOperations},on:{operate:e.operateHandler}}):e._e()],1),a("biz-fence-map",{ref:"fenceMap",attrs:{type:e.type,carState:e.carState,icon:e.icon},on:{paramsChange:e.paramsChange}})],1)])],1)},o=[],n=(a("4160"),a("d81d"),a("b0c0"),a("a9e3"),a("25eb"),a("d3b7"),a("159b"),a("f36f")),l=a("04d3"),r=a("0a3d"),s=a("8330"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vehicle-mgmt-vehicle__vehicle-picker"},[a("el-input",{attrs:{placeholder:"请输入内容",value:e.textComputed,readonly:"readonly"}},[a("el-button",{attrs:{slot:"append"},on:{click:e.clickHandler},slot:"append"},[e._v("选择")])],1),e.motorcadeId?a("biz-dialog-selector",{attrs:{slot:"float",title:"车辆选择",visibility:e.showDialog,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,keyField:"id",selectionKeys:e.value,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[a("el-table-column",{attrs:{prop:"orderNum",label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"plateNumber",label:"车牌号"}}),a("el-table-column",{attrs:{prop:"member.name",label:"车主"}}),a("el-table-column",{attrs:{prop:"member.phone",label:"电话"}})],1):e._e(),e.motorcadeId?e._e():a("biz-dialog-selector",{attrs:{slot:"float",title:"车辆选择",visibility:e.showDialog,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,keyField:"id",selectionKeys:e.value,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[a("el-table-column",{attrs:{prop:"sn",label:"车牌号"}}),a("el-table-column",{attrs:{prop:"owner",label:"车主姓名"}}),a("el-table-column",{attrs:{prop:"ownerUuid",label:"车主电话"}})],1)],1)},d=[],u=a("af3f"),p=a("e4c3"),h={name:"VehicleMgmtVehiclePicker",components:{BizDialogSelector:u["a"]},model:{prop:"value",event:"input"},props:{value:{type:Array},motorcadeId:{type:String,required:!0},userId:{type:String}},data:function(){return{showDialog:!1,dialogLoading:!1,dialogTableData:[],dialogPagination:{pageSize:1e3,currentPage:1,pageSizes:[1e3],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入姓名/手机号",name:"searchValue",value:""}]}},computed:{textComputed:function(){return"已选择 "+this.value.length+" 辆车"}},methods:{queryVehicles:function(e){var t=this;this.dialogLoading=!0;var a="";a=this.motorcadeId?"/admin/fence/fleetMonitorItems.jhtml":"/admin/fence/personalMonitorItems.jhtml",p["a"].queryVehicles(a,e,(function(e){if(t.motorcadeId)t.dialogTableData=e.dataList,t.$set(t.dialogPagination,"total",parseInt(e.dataList.length));else{var a=[];e.dataList.map((function(e){"0"===e.produceType&&a.push(e)})),t.dialogTableData=a,t.$set(t.dialogPagination,"total",parseInt(a.length))}t.dialogLoading=!1}),(function(e){console.log(e),console.log("code错误"),t.$message.warning(e.errorMessage)}))},clickHandler:function(e){this.showDialog=!0},confirmedHandler:function(e,t){this.$emit("input",e),this.$emit("on-confirm",e)},getDialogQueryParams:function(){return{fleetId:this.motorcadeId,userId:this.userId,pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value}},openedHandler:function(){this.dialogPagination.currentPage=1,this.dialogPagination.pageSize=20,this.dialogFilters=[{type:"input",label:"",placeholder:"请输入车牌号",name:"searchValue",value:""}],this.queryVehicles(this.getDialogQueryParams())},dialogFilterDataChange:function(e){this.queryVehicles(this.getDialogQueryParams())},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),this.queryVehicles(this.getDialogQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),this.queryVehicles(this.getDialogQueryParams())}}},g=h,m=a("2877"),f=Object(m["a"])(g,c,d,!1,null,null,null),v=f.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vehicle-mgmt-vehicle__vehicle-picker"},[a("el-input",{attrs:{placeholder:"请输入内容",value:e.textComputed,readonly:"readonly"}},[a("el-button",{attrs:{slot:"append"},on:{click:e.clickHandler},slot:"append"},[e._v("选择")])],1),e.motorcadeId?a("biz-dialog-selector",{attrs:{slot:"float",title:"设备选择",visibility:e.showDialog,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,keyField:"id",selectionKeys:e.value,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[a("el-table-column",{attrs:{prop:"orderNum",label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"plateNumber",label:"车牌号"}}),a("el-table-column",{attrs:{prop:"member.name",label:"车主"}}),a("el-table-column",{attrs:{prop:"member.phone",label:"电话"}})],1):e._e(),e.motorcadeId?e._e():a("biz-dialog-selector",{attrs:{slot:"float",title:"设备选择",visibility:e.showDialog,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,keyField:"id",selectionKeys:e.value,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[a("el-table-column",{attrs:{prop:"name",label:"终端名称",width:"100"}}),a("el-table-column",{attrs:{prop:"sn",label:"序列号",width:"100"}}),a("el-table-column",{attrs:{prop:"originalId",label:"终端分类"}}),a("el-table-column",{attrs:{prop:"owner",label:"所有者姓名"}}),a("el-table-column",{attrs:{prop:"ownerUuid",label:"所有者电话"}})],1)],1)},y=[],M={name:"VehicleMgmtVehiclePicker",components:{BizDialogSelector:u["a"]},model:{prop:"value",event:"input"},props:{value:{type:Array},motorcadeId:{type:String,required:!0},userId:{type:String}},data:function(){return{showDialog:!1,dialogLoading:!1,dialogTableData:[],dialogPagination:{pageSize:1e3,currentPage:1,pageSizes:[1e3],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入姓名/手机号",name:"searchValue",value:""}]}},computed:{textComputed:function(){return"已选择 "+this.value.length+"个设备"}},methods:{queryVehicles:function(e){var t=this;this.dialogLoading=!0;var a="";a=this.motorcadeId?"/admin/fence/fleetMonitorItems.jhtml":"/admin/fence/personalMonitorItems.jhtml",p["a"].queryVehicles(a,e,(function(e){if(t.motorcadeId)t.dialogTableData=e.dataList,t.$set(t.dialogPagination,"total",parseInt(e.dataList.length));else{var a=[];e.dataList.map((function(e){"1"===e.produceType&&a.push(e)})),t.dialogTableData=a,t.$set(t.dialogPagination,"total",parseInt(a.length))}t.dialogLoading=!1}),(function(e){console.log(e),console.log("code错误"),t.$message.warning(e.errorMessage)}))},clickHandler:function(e){this.showDialog=!0},confirmedHandler:function(e,t){this.$emit("input",e),this.$emit("on-confirm",e)},getDialogQueryParams:function(){return{fleetId:this.motorcadeId,userId:this.userId,pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value}},openedHandler:function(){this.dialogPagination.currentPage=1,this.dialogPagination.pageSize=20,this.dialogFilters=[{type:"input",label:"",placeholder:"请输入序列号",name:"searchValue",value:""}],this.queryVehicles(this.getDialogQueryParams())},dialogFilterDataChange:function(e){this.queryVehicles(this.getDialogQueryParams())},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),this.queryVehicles(this.getDialogQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),this.queryVehicles(this.getDialogQueryParams())}}},w=M,C=Object(m["a"])(w,b,y,!1,null,null,null),I=C.exports,S=a("ce2e"),P=a("6401"),$=a("92a6"),L=a("1ab1"),_={name:"VehicleElecFence",components:{BizSaveButton:s["a"],BizHeader:l["d"],BizFenceMap:r["a"],BizGrid:n["a"],VehiclePicker:v,TerminalPicker:I,BizAreaSelect:S["a"],BizEmptyTableTab:P["a"]},props:{itemId:{type:Object,default:function(){return{id:"",userId:""}}},isEdit:{type:Boolean,default:function(){return!0}},motorcadeId:{type:Object,default:function(){return{id:""}}},isMotorcade:{type:Boolean,default:function(){return!1}},carState:{type:Object,default:function(){return{}}},icon:{type:Object,default:function(){return{}}},isCar:{type:Boolean,default:function(){return!1}}},data:function(){var e=this;return{isFirst:!0,ruleTableOperations:[{label:"新建",name:"addOperate",type:"primary",auth:["admin:car.edit"]},{label:"删除",name:"deleteOperate",type:"",disabled:!0,auth:["admin:car.edit"]}],tableData:[],type:"0",dialogVisible:!1,ruleLoading:!1,ruleModel:this.getDefaultModel(),rules:{name:[{required:!0,message:"请输入围栏名称/长度不大于16位",max:16,trigger:"blur"}],isEnabled:[{required:!0,message:"请选择启用状态",trigger:"blur"}],triggerMethod:[{required:!0,message:"请选择触发方式",trigger:"blur"}],type:[{required:!0,message:"请选择围栏类型",trigger:"blur"}],overspeed:[{trigger:"blur",validator:function(t,a,i){Number(e.ruleModel.overspeed)>=1||"undefined"===typeof e.ruleModel.overspeed||""===e.ruleModel.overspeed?i():i(new Error("请输入大于0的正整数"))}}],category:[{required:!0,message:"请选择围栏种类",trigger:"blur"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"blur"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"blur"}]},ruleOperations:[{label:"取消",name:"cancelRuleOperate"},{label:"保存",name:"saveRuleOperate",type:"primary"}]}},created:function(){},methods:{isMotorcadeMode:function(){return!!this.isMotorcade},monitorState:function(e){var t=this;L["a"].put("/admin/fence/monitorState.jhtml",{fenceId:e.id,carId:this.itemId.id,state:"0"===e.state?"1":"0"}).then((function(e){t.$message.success("操作成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},init:function(){this.itemId.id?(this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.query()):this.tableData=[]},query:function(){var e=this;$["a"].query({fleetId:this.isMotorcadeMode()?this.itemId.id:"",userId:this.itemId.userId,category:this.isMotorcadeMode()?"1":"0",carId:this.isMotorcadeMode()?"":this.itemId.id},(function(t){e.tableData=t.fences,e.selections=[]}),(function(e){console.log(e),console.log("code错误")}))},queryRule:function(e){var t=this;this.ruleLoading=!0,$["a"].queryRule({id:e},(function(e){t.ruleModel=Object.assign(t.getDefaultModel(),e.fence),t.ruleModel.carIds=[],t.ruleModel.terminalIds=[],e.fence.cars.map((function(e){t.ruleModel.carIds.push(e.id)})),e.fence.terminals.map((function(e){t.ruleModel.terminalIds.push(e.id)})),t.$refs.fenceMap.initEditFenceMap(t.ruleModel),t.ruleLoading=!1}),(function(e){console.log(e),console.log("code错误"),t.ruleLoading=!1}))},getSaveParams:function(){var e=this.ruleModel.carIds.map((function(e){return{id:e}})),t=this.ruleModel.terminalIds.map((function(e){return{id:e}}));return{fence:{id:this.ruleModel.id,name:this.ruleModel.name,category:this.ruleModel.category,fleetId:this.motorcadeId.id,type:this.ruleModel.type,triggerMethod:this.ruleModel.triggerMethod,overspeed:Number.parseInt(this.ruleModel.overspeed),cars:e,terminals:t,startTime:this.ruleModel.startTime,endTime:this.ruleModel.endTime,isEnabled:this.ruleModel.isEnabled,areaId:this.ruleModel.areaId,rectLng1:this.ruleModel.rectLng1,rectLat1:this.ruleModel.rectLat1,rectLng2:this.ruleModel.rectLng2,rectLat2:this.ruleModel.rectLat2,rectLng3:this.ruleModel.rectLng3,rectLat3:this.ruleModel.rectLat3,rectLng4:this.ruleModel.rectLng4,rectLat4:this.ruleModel.rectLat4,circleLng:this.ruleModel.circleLng,circleLat:this.ruleModel.circleLat,radius:this.ruleModel.radius,polygon:this.ruleModel.polygon,area:this.ruleModel.area,fullName:this.ruleModel.fullName},userId:this.itemId.userId}},paramsChange:function(e){this.ruleModel.rectLng1=e.rectLng1,this.ruleModel.rectLng2=e.rectLng2,this.ruleModel.rectLng3=e.rectLng3,this.ruleModel.rectLng4=e.rectLng4,this.ruleModel.rectLat1=e.rectLat1,this.ruleModel.rectLat2=e.rectLat2,this.ruleModel.rectLat3=e.rectLat3,this.ruleModel.rectLat4=e.rectLat4,this.ruleModel.circleLng=e.circleLng,this.ruleModel.circleLat=e.circleLat,this.ruleModel.radius=e.radius,this.ruleModel.polygon=e.polygon},typeChange:function(e){this.type=e},resetModel:function(){this.ruleModel=this.getDefaultModel()},getDefaultModel:function(){return console.log(this.isMotorcadeMode()),{triggerMethod:"0",type:"0",category:this.isMotorcadeMode()?"1":"0",carIds:[],terminalIds:[],areaId:"1568",isEnabled:"0",overspeed:"60",startTime:"",endTime:""}},deleteRule:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){$["a"].deleteRule({ids:e},(function(e){t.$message.success("删除成功"),t.query()}),(function(e){t.$message.warning(e.errorMessage)}))}))},switchStatus:function(e,t){console.log("switch to "+t,e)},operateHandler:function(e){this[e]()},addOperate:function(){this.resetModel(),this.dialogVisible=!0,this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.$nextTick((function(){this.$refs.fenceMap.initLocation(this.carState)}))},deleteOperate:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteRule(e)}else this.$message("请选择一个用户进行删除")},selectionChangeHandler:function(e){this.selections=e,this.ruleTableOperations[1].disabled=!0,e.length>0&&(this.ruleTableOperations[1].disabled=!1)},rowDeleteClickHandler:function(e,t){this.deleteRule([t.id])},rowEditClickHandler:function(e,t,a){this.dialogVisible=!0,this.$refs.ruleForm&&this.$refs.ruleForm.clearValidate(),this.queryRule(e.id)},areaChanged:function(e){this.ruleModel.areaId=e,this.isFirst&&(this.ruleModel.areaId="1568",this.isFirst=!1)},cancelRuleOperate:function(){this.dialogVisible=!1},saveRuleOperate:function(){var e=this;void 0!==this.ruleModel.circleLng||void 0!==this.ruleModel.rectLat1||void 0!==this.ruleModel.radius||"3"===this.ruleModel.type?this.$refs.ruleForm.validate((function(t,a){if(!t)return!1;e.loading=!0,e.ruleModel.id?$["a"].updateRule(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.query(),e.dialogVisible=!1,e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),e.loading=!1})):$["a"].addRule(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.query(),e.dialogVisible=!1,e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),e.loading=!1}))})):this.$message.warning("请在地图上维护围栏数据")}},computed:{},watch:{itemId:function(e,t){this.init()}},mounted:function(){this.init()}},O=_,k=(a("39ec"),Object(m["a"])(O,i,o,!1,null,null,null));t["a"]=k.exports},f8b2:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vehicle-mgmt-vehicle__vehicle-picker"},[a("biz-dialog-selector",{attrs:{slot:"float",title:e.title,visibility:e.showDialog,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,keyField:"id",selectionKeys:e.selectionKeys,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[a("el-table-column",{attrs:{prop:"plateNumber",label:"车牌号"}}),a("el-table-column",{attrs:{prop:"member.name",label:"车主"}}),a("el-table-column",{attrs:{prop:"member.phone",label:"电话"}})],1)],1)},o=[],n=a("af3f"),l=a("e4c3"),r={name:"VehicleMgmtMemberVehiclePicker",components:{BizDialogSelector:n["a"]},model:{prop:"value",event:"input"},props:{value:{type:Array},fleetId:{type:String},title:{type:String},all:{type:Boolean,default:function(){return!1}},memberIds:{type:Array,default:function(){return[]}}},data:function(){return{showDialog:!1,dialogLoading:!1,selectionKeys:[],dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入用户名/手机号",name:"searchValue",value:""}]}},computed:{textComputed:function(){return"已选择 "+this.value.length+" 辆车"}},methods:{getMotorcadeId:function(){return this.$route.params.groupId||this.fleetId},queryVehicles:function(e){var t=this;this.dialogLoading=!0,l["a"].queryVehicles("/admin/fleet/listAllFleetCar.jhtml",e,(function(e){t.dialogTableData=e.carList,t.$set(t.dialogPagination,"total",parseInt(e.total)),t.dialogLoading=!1}),(function(e){console.log(e),console.log("code错误"),t.dialogLoading=!1}))},clickHandler:function(e){this.showDialog=!0},confirmedHandler:function(e,t){this.selectionKeys=e,this.$emit("on-confirm",e)},getDialogQueryParams:function(){return{pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,fleetId:this.all?"":this.getMotorcadeId(),shopId:window.top.SHOP_ID||""}},openedHandler:function(){this.dialogPagination.currentPage=1,this.dialogPagination.pageSize=20,this.dialogFilters=[{type:"input",label:"",placeholder:"请输入车牌号",name:"searchValue",value:""}],this.queryVehicles(this.getDialogQueryParams())},dialogFilterDataChange:function(e){this.$set(this.dialogPagination,"currentPage",1),this.queryVehicles(this.getDialogQueryParams())},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),this.queryVehicles(this.getDialogQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),this.queryVehicles(this.getDialogQueryParams())}}},s=r,c=a("2877"),d=Object(c["a"])(s,i,o,!1,null,null,null);t["a"]=d.exports}}]);