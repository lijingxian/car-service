(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-388bcc25"],{2497:function(e,t,a){"use strict";var i=a("4360"),l=a("a18c");t["a"]=function(e,t){return function(a){var r=a.data;"100"===r.resultCode?e(r):"709"===r.resultCode?(i["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",i["a"].getters.currentUser),l["a"].push("/login")):t(r)}}},"2d7d":function(e,t,a){},4299:function(e,t,a){"use strict";var i=a("e683b"),l=a.n(i);l.a},"439f":function(e,t,a){"use strict";a("4160"),a("159b");t["a"]={clearMessageBoxes:function(){var e=document.querySelectorAll(".el-message");e.forEach((function(e){e.remove()}))}}},"4ec9":function(e,t,a){"use strict";var i=a("6d61"),l=a("6566");e.exports=i("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),l)},"50d3":function(e,t,a){"use strict";var i=a("2497"),l=a("bc3a"),r=a.n(l),n=a("c596");t["a"]={query:function(e,t,a){r.a.get(n["g"].terminalMgmt.terminalMgmtClass_query,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){r.a.post(n["g"].terminalMgmt.ClassAbilitySetting_delete,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},upload:function(e,t,a){r.a.get(n["g"].terminalMgmt.terminalMgmtClass_upload,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var i=a("1d80"),l=a("5899"),r="["+l+"]",n=RegExp("^"+r+r+"*"),o=RegExp(r+r+"*$"),s=function(e){return function(t){var a=String(i(t));return 1&e&&(a=a.replace(n,"")),2&e&&(a=a.replace(o,"")),a}};e.exports={start:s(1),end:s(2),trim:s(3)}},"5a5b":function(e,t,a){"use strict";var i=a("a66e"),l=a.n(i);l.a},"5afc":function(e,t,a){"use strict";var i=a("cffc"),l=a.n(i);l.a},"5b0d":function(e,t,a){},"64d1":function(e,t,a){"use strict";var i=a("748e"),l=a.n(i);l.a},"748e":function(e,t,a){},7685:function(e,t,a){"use strict";var i=a("5b0d"),l=a.n(i);l.a},"843c":function(e,t,a){"use strict";var i=a("c564"),l=a.n(i);l.a},"8ba1":function(e,t,a){"use strict";var i=a("c8ee"),l=a.n(i);l.a},a66e:function(e,t,a){},a99c:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tag-manager"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.rawTags.length>0,expression:"rawTags.length > 0"}],staticClass:"tag-manager__list"},e._l(e.rawTags,(function(t){return a("el-tag",{key:t[e.nameField],attrs:{closable:"1"!==t.isAttend||e.closable,"disable-transitions":!1,type:t.type,size:"small"},on:{close:function(a){return e.handleClose(t,a)}},nativeOn:{click:function(a){return e.handleClick(t,a)}}},[e._v(" "+e._s(t[e.nameField])+" ")])})),1),a("el-input",{attrs:{placeholder:"请输入内容",maxlength:e.maxlength},model:{value:e.tagName,callback:function(t){e.tagName=t},expression:"tagName"}},[a("el-button",{attrs:{slot:"append"},on:{click:e.appendTag},slot:"append"},[e._v("添加")])],1)],1)},l=[],r=(a("c975"),a("a434"),a("a9e3"),a("b85c")),n={name:"TagManager",data:function(){return{tagName:"",rawTags:[]}},props:{value:{type:Array},maxlength:{type:Number,default:function(){return 20}},nameField:{type:String,default:function(){return"content"}},removeHandler:{type:Function,default:function(){return null}},closable:{type:Boolean,default:function(){return!1}}},created:function(){this.rawTags=this.value||[]},methods:{hasOne:function(e){var t,a=Object(r["a"])(this.rawTags);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i[this.nameField]===e)return!0}}catch(l){a.e(l)}finally{a.f()}return!1},resetTagName:function(){this.tagName=""},appendTag:function(){if(this.tagName){if(this.hasOne(this.tagName))return void this.resetTagName();var e={};e[this.nameField]=this.tagName,this.rawTags.push(e),this.resetTagName(),this.$emit("input",this.rawTags)}},handleClose:function(e,t){t.stopPropagation(),console.log(e),this.removeHandler,this.rawTags.splice(this.rawTags.indexOf(e),1),console.log("this.rawTags"+this.rawTags),this.$emit("input",this.rawTags)},handleClick:function(e,t){this.$emit("item-click",e,t)}},watch:{value:function(e){this.rawTags=e||[]}}},o=n,s=(a("5a5b"),a("2877")),c=Object(s["a"])(o,i,l,!1,null,null,null),d=c.exports,u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tag-selector"},e._l(e.options,(function(t){return a("el-tag",{key:t[e.nameField],attrs:{closable:!1,"disable-transitions":!1,type:e.value.includes(t[e.nameField])?"":"info",size:"small"},nativeOn:{click:function(a){return e.handleClick(t,a)}}},[e._v(" "+e._s(t[e.nameField])+" ")])})),1)},p=[],m=(a("99af"),{name:"TagSelector",data:function(){return{}},props:{value:{type:Array},options:{type:Array,default:function(){return[]}},valueField:{type:String,default:function(){return"id"}},nameField:{type:String,default:function(){return"name"}}},created:function(){},methods:{handleClick:function(e,t){console.log(123);var a=[].concat(this.value),i=a.indexOf(e[this.nameField]);i<0?a.push(e[this.nameField]):a.splice(i,1),this.$emit("input",a)}},watch:{}}),f=m,h=(a("64d1"),Object(s["a"])(f,u,p,!1,null,null,null)),g=h.exports;a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return g}))},a9e3:function(e,t,a){"use strict";var i=a("83ab"),l=a("da84"),r=a("94ca"),n=a("6eeb"),o=a("5135"),s=a("c6b6"),c=a("7156"),d=a("c04e"),u=a("d039"),p=a("7c73"),m=a("241c").f,f=a("06cf").f,h=a("9bf2").f,g=a("58a8").trim,b="Number",v=l[b],M=v.prototype,y=s(p(M))==b,w=function(e){var t,a,i,l,r,n,o,s,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:i=2,l=49;break;case 79:case 111:i=8,l=55;break;default:return+c}for(r=c.slice(2),n=r.length,o=0;o<n;o++)if(s=r.charCodeAt(o),s<48||s>l)return NaN;return parseInt(r,i)}return+c};if(r(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var C,_=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof _&&(y?u((function(){M.valueOf.call(a)})):s(a)!=b)?c(new v(w(t)),a,_):w(t)},S=i?m(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;S.length>x;x++)o(v,C=S[x])&&!o(_,C)&&h(_,C,f(v,C));_.prototype=M,M.constructor=_,n(l,b,_)}},baa5:function(e,t,a){var i=a("23e7"),l=a("e58c");i({target:"Array",proto:!0,forced:l!==[].lastIndexOf},{lastIndexOf:l})},c564:function(e,t,a){},c701:function(e,t,a){"use strict";var i=a("fca0"),l=a.n(i);l.a},c8ee:function(e,t,a){},cffc:function(e,t,a){},dd0b:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"terminal-mgmt-class"},[a("biz-flex-table",{ref:"table",attrs:{operations:e.operations,tableData:e.tableData,loading:e.loading,pagination:e.pagination},on:{"selection-change":e.selectionChangeHandler,operate:e.operateHandler,"row-click":e.rowOperationClickHandler,"size-change":e.pageSizeChange,"current-change":e.currentPageChange}},[a("template",{slot:"operation"},[a("import-file",{ref:"importFile",staticStyle:{"margin-left":"10px"},attrs:{tableData:e.importResult,importLoading:e.importLoading,total:e.total,disabled:e.disabled,count:e.count,percentage:e.percentage,stepkey:e.stepkey,action:"/admin/terminal/importTerminal.jhtml",name:"uFile"},on:{clearTimeOut:e.clearTimeOut,restProcess:e.restProcess,"handle-import":e.handleImport}},[a("el-table-column",{attrs:{label:"编号",width:"50",prop:"line"}}),a("el-table-column",{attrs:{label:"状态",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"imoprt-error-text",class:{"imoprt-success-text":"ok"===t.row[t.row.length-1]}},[e._v(e._s("ok"===t.row[t.row.length-1]?"成功":"失败"))])]}}])}),a("el-table-column",{attrs:{label:"信息",prop:"result"}})],1)],1),a("el-table-column",{attrs:{prop:"name",label:"分类名称","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(t.row.name))])])]}}])}),a("el-table-column",{attrs:{prop:"originalName",label:"终端标识","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(t.row.originalName))])])]}}])}),a("el-table-column",{attrs:{prop:"styleType",label:"终端类型","min-width":"100",formatter:e.typeConverter},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(e.typeConverter(t.row)))])])]}}])}),a("el-table-column",{attrs:{prop:"ability",label:"终端能力","min-width":"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(e.abilityConverter(t.row)))])])]}}])}),a("el-table-column",{attrs:{prop:"tag",label:"操作","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.rowDeleteClickHandler(t.row,a)}}},[e._v(" 删除 ")])]}}])})],2),a("terminal-class-popup",{attrs:{slot:"float",open:e.open,itemId:e.itemId},on:{close:function(t){e.open=!1},operationSuccess:e.operationSuccess},slot:"float"})],1)},l=[],r=(a("4160"),a("a15b"),a("b0c0"),a("a9e3"),a("159b"),a("5530")),n=a("04d3"),o=a("ccf0"),s=a("1ab1"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("terminal-class-base-info",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1),e.itemId.id?a("el-tab-pane",{attrs:{label:"接入配置",name:"1"}},[a("access-setting",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId.id?a("el-tab-pane",{attrs:{label:"编码规则",name:"2"}},[a("coding-rule",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId.id?a("el-tab-pane",{attrs:{label:"终端能力",name:"3"}},[a("terminal-class-ability",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId.id?a("el-tab-pane",{attrs:{label:"终端升级",name:"4"}},[a("terminal-update",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1):e._e()],1)},d=[],u=a("7132"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"terminal-mgmt-class__access-setting"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"配置名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入配置名称"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"通讯协议",prop:"protocol"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.protocol,callback:function(t){e.$set(e.formModel,"protocol",t)},expression:"formModel.protocol"}},e._l(e.protocolList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"通讯标准",prop:"standard"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.standard,callback:function(t){e.$set(e.formModel,"standard",t)},expression:"formModel.standard"}},e._l(e.standardList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"厂商代码"}},[a("el-input",{attrs:{placeholder:"请输入厂商代码"},model:{value:e.formModel.manufacturerCode,callback:function(t){e.$set(e.formModel,"manufacturerCode",t)},expression:"formModel.manufacturerCode"}})],1),a("el-form-item",{attrs:{label:"厂商型号"}},[a("el-input",{attrs:{placeholder:"请输入厂商型号"},model:{value:e.formModel.modelCode,callback:function(t){e.$set(e.formModel,"modelCode",t)},expression:"formModel.modelCode"}})],1),a("el-form-item",{attrs:{label:"供应商",prop:"supplier"}},[a("el-input",{attrs:{placeholder:"请输入供应商"},model:{value:e.formModel.supplier,callback:function(t){e.$set(e.formModel,"supplier",t)},expression:"formModel.supplier"}})],1),a("el-form-item",{attrs:{label:"版本",prop:"version"}},[a("el-input",{attrs:{placeholder:"请输入版本"},model:{value:e.formModel.version,callback:function(t){e.$set(e.formModel,"version",t)},expression:"formModel.version"}})],1)],1)],1)},m=[],f=a("f36f"),h=a("8330"),g=a("2497"),b=a("bc3a"),v=a.n(b),M=a("c596"),y={query:function(e,t,a){v.a.get(M["g"].terminalMgmt.AccessSetting_query,{params:e}).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},update:function(e,t,a){v.a.post(M["g"].terminalMgmt.AccessSetting_update,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},add:function(e,t,a){v.a.post(M["g"].terminalMgmt.AccessSetting_add,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))}},w={name:"AccessSetting",components:{BizSaveButton:h["a"],BizGrid:f["a"]},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请输入配置名称",trigger:"blur"}],protocol:[{required:!0,message:"请选通讯协议",trigger:"blur"}],standard:[{required:!0,message:"请选择通讯标准",trigger:"blur"}],supplier:[{required:!0,message:"请输入供应商",trigger:"blur"}],version:[{required:!0,message:"请输入版本",trigger:"blur"}]},protocolList:[],standardList:[],formModel:this.getDefaultModel()}},props:{itemId:{type:Object,default:function(){return{id:""}}}},created:function(){this.queryProtocolList(),this.queryStandardList()},methods:{init:function(){this.itemId.id?this.query():this.resetModel(),this.$refs.form&&this.$refs.form.resetFields()},query:function(){var e=this;y.query({terminalTypeId:this.itemId.id},(function(t){e.formModel=Object.assign(e.getDefaultModel(),t.content)}),(function(e){console.log(e),console.log("code错误")}))},queryProtocolList:function(){this.protocolList=["TCP","UDP"]},queryStandardList:function(){this.standardList=["非808","808","北斗2012"]},getSaveParams:function(){return{id:this.formModel.id,terminalTypeId:this.formModel.id?void 0:this.itemId.id,name:this.formModel.name,protocol:this.formModel.protocol,standard:this.formModel.standard,manufacturerCode:this.formModel.manufacturerCode,modelCode:this.formModel.modelCode,supplier:this.formModel.supplier,version:this.formModel.version}},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return{protocol:"",standard:""}},operateHandler:function(e){this[e]()},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.formModel.id?y.update(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)})):y.add(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))}))}},computed:{},watch:{itemId:function(e,t){this.init()}},mounted:function(){this.init()}},C=w,_=(a("5afc"),a("2877")),S=Object(_["a"])(C,p,m,!1,null,null,null),x=S.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"terminal-mgmt-class__terminal-class-base-info"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.errorMessage,expression:"!errorMessage"}]},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入分类名称"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"终端类型",prop:"styleType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.typeChange},model:{value:e.formModel.styleType,callback:function(t){e.$set(e.formModel,"styleType",t)},expression:"formModel.styleType"}},e._l(e.terminalTypeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"终端标识",prop:"originalName"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.valueChange},model:{value:e.formModel.originalName,callback:function(t){e.$set(e.formModel,"originalName",t)},expression:"formModel.originalName"}},e._l(e.terminalSignList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"终端描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入终端描述"},model:{value:e.formModel.description,callback:function(t){e.$set(e.formModel,"description",t)},expression:"formModel.description"}})],1)],1)],1),a("p",{directives:[{name:"show",rawName:"v-show",value:e.errorMessage,expression:"errorMessage"}]},[e._v(e._s(e.errorMessage))])])},O=[],$=(a("a4d3"),a("e01a"),a("d3b7"),{querySignList:function(e,t,a){v.a.get(M["g"].terminalMgmt.ClassAbilitySetting_querySignList,{params:e}).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},queryAbilityList:function(e,t,a){v.a.get(M["g"].terminalMgmt.ClassAbilitySetting_queryAbilityList,{params:e}).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},query:function(e,t,a){v.a.get(M["g"].terminalMgmt.ClassAbilitySetting_query,{params:e}).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},update:function(e,t,a){v.a.post(M["g"].terminalMgmt.ClassAbilitySetting_update,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},add:function(e,t,a){v.a.post(M["g"].terminalMgmt.ClassAbilitySetting_add,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))}}),I={name:"TerminalClassBaseInfo",components:{BizSaveButton:h["a"],BizGrid:f["a"]},data:function(){return{loading:!1,errorMessage:"",operations:[{label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请输入终端名称",trigger:"blur"}],styleType:[{required:!0,message:"请选择终端类型",trigger:"blur"}],originalName:[{required:!0,message:"请选择终端标识",trigger:"blur"}]},terminalTypeList:[],terminalSignList:[],formModel:this.getDefaultModel()}},props:{itemId:{type:Object,default:function(){return{id:""}}}},created:function(){this.queryTypeList(),this.querySignList(),this.itemId.id&&this.init(this.itemId.id)},methods:{valueChange:function(){this.$refs.form.clearValidate("originalName")},typeChange:function(){this.$refs.form.clearValidate("styleType")},init:function(e){e?this.query(e):(this.resetModel(),this.$refs.form.resetFields())},query:function(e){var t=this;this.loading=!0,s["a"].get(M["y"].BaseInfo.query,{terminalTypeId:e}).then((function(e){var a=Object.assign(t.getDefaultModel(),e.data);a.styleType={intelligent_driving:"0",comfort_control:"1",entertainment_information:"2",intelligentaccess:"3"}[a.styleType],t.formModel=a,t.$refs.form.resetFields()})).catch((function(e){"800"===e.resultCode?t.errorMessage=e.errorMessage:t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))},queryTypeList:function(){this.terminalTypeList=[{id:"0",name:"智能驾驶"},{id:"1",name:"舒适控制"},{id:"2",name:"娱乐信息"},{id:"3",name:"智能到店"}]},querySignList:function(){var e=this;s["a"].get(M["y"].BaseInfo.signList).then((function(t){e.terminalSignList=t.data})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})),$.querySignList({},(function(t){e.terminalSignList=t.data}),(function(e){console.log(e),console.log("code错误")}))},getSaveParams:function(){return{id:this.formModel.id,name:this.formModel.name,styleType:this.formModel.styleType,originalName:this.formModel.originalName,description:this.formModel.description}},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return{typeId:"",signId:""}},operateHandler:function(e){this[e]()},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0,s["a"].post(e.itemId.id?M["y"].BaseInfo.update:M["y"].BaseInfo.add,e.getSaveParams()).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))}},computed:{},watch:{itemId:function(e,t){this.init(e.id)}}},T=I,L=(a("8ba1"),Object(_["a"])(T,k,O,!1,null,null,null)),R=L.exports,j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"terminal-mgmt-class__coding-rule"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.errorMessage,expression:"!errorMessage"}]},[a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.operations},on:{operate:e.operateHandler}}),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"name",label:"规则名称"}}),a("el-table-column",{attrs:{prop:"length",label:"长度",width:"80"}}),a("el-table-column",{attrs:{prop:"title",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.rowEditClickHandler(i)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.rowDeleteClickHandler(i)}}},[e._v("删除")])]}}])})],1),a("total-rule",{attrs:{"terminal-type-id":e.itemId.id,"rule-id-object":e.ruleIdObject,show:e.showRule},on:{"update:show":function(t){e.showRule=t},updated:e.query}})],1),a("p",{directives:[{name:"show",rawName:"v-show",value:e.errorMessage,expression:"errorMessage"}]},[e._v(e._s(e.errorMessage))])])},N=[],q={query:function(e,t,a){v.a.get(M["g"].terminalMgmt.CodingRule_query,{params:e}).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},queryRule:function(e,t,a){v.a.get(M["g"].terminalMgmt.CodingRule_queryRule,{params:e}).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},deleteRule:function(e,t,a){v.a.post(M["g"].terminalMgmt.CodingRule_deleteRules,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},updateRule:function(e,t,a){v.a.post(M["g"].terminalMgmt.CodingRule_updateRule,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},addRule:function(e,t,a){v.a.post(M["g"].terminalMgmt.CodingRule_addRule,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))}},B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"},{name:"loading",rawName:"v-loading",value:e.ruleLoading,expression:"ruleLoading"}],staticClass:"total-rule"},[a("el-form",{ref:"ruleForm",attrs:{size:"small","label-width":"110px",model:e.ruleModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"规则名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入规则名称"},model:{value:e.ruleModel.name,callback:function(t){e.$set(e.ruleModel,"name",t)},expression:"ruleModel.name"}})],1),a("el-form-item",{attrs:{label:"长度",prop:"length"}},[a("el-input",{attrs:{min:"1",type:"number",placeholder:"请输入长度"},model:{value:e.ruleModel.length,callback:function(t){e.$set(e.ruleModel,"length",t)},expression:"ruleModel.length"}})],1)],1),a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.ruleOperations},on:{operate:e.operateHandler}}),a("biz-header",{attrs:{operations:e.propTableOperations},on:{operate:e.operateHandler}}),a("el-table",{staticClass:"coding-rule__value-table",staticStyle:{width:"100%"},attrs:{data:e.ruleModel.valueDatas},on:{"selection-change":e.propSelectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"25"}}),a("el-table-column",{attrs:{label:"类型",formatter:e.typeConverter,width:"50"}}),a("el-table-column",{attrs:{prop:"name",label:"属性名称"}}),a("el-table-column",{attrs:{prop:"length",label:"长度",width:"35"}}),a("el-table-column",{attrs:{prop:"order",label:"排序",width:"35"}}),a("el-table-column",{attrs:{label:"属性值",formatter:e.valueConverter}}),a("el-table-column",{attrs:{prop:"title",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"margin-left":"0"},attrs:{type:"text",size:"mini"},on:{click:function(a){return e.propRowEditClickHandler(t)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.propRowDeleteClickHandler(t.row)}}},[e._v("删除")])]}}])})],1),a("divide-rule",{directives:[{name:"show",rawName:"v-show",value:e.showProp,expression:"showProp"}],attrs:{"prop-model":e.propModel},on:{"add-prop":e.addProp,"prod-cancel":e.prodCancel}})],1)},D=[],E=(a("c975"),a("a434"),a("b85c")),A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"divide-rule"},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"propForm",attrs:{size:"small","label-width":"110px",model:e.tempModel,rules:e.propRules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"属性类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempModel.type,callback:function(t){e.$set(e.tempModel,"type",t)},expression:"tempModel.type"}},e._l(e.propTypelList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"长度",prop:"length"}},[a("el-input",{attrs:{min:"1",type:"number",placeholder:"请输入长度"},model:{value:e.tempModel.length,callback:function(t){e.$set(e.tempModel,"length",t)},expression:"tempModel.length"}})],1),a("el-form-item",{attrs:{error:e.tempError,label:"属性值",prop:"tempValue"}},[a("el-input",{attrs:{placeholder:"请输入属性值"},on:{input:e.tempValueInput},model:{value:e.tempModel.tempValue,callback:function(t){e.$set(e.tempModel,"tempValue",t)},expression:"tempModel.tempValue"}})],1),a("el-form-item",{attrs:{label:"属性名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入属性名称"},model:{value:e.tempModel.name,callback:function(t){e.$set(e.tempModel,"name",t)},expression:"tempModel.name"}})],1),a("el-form-item",{attrs:{label:"排序",prop:"order"}},[a("el-input",{attrs:{min:"0",type:"number",placeholder:"请输入排序"},model:{value:e.tempModel.order,callback:function(t){e.$set(e.tempModel,"order",t)},expression:"tempModel.order"}})],1)],1),a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.propOperations},on:{operate:e.operateHandler}})],1)],1)},z=[],P=(a("ac1f"),a("1276"),{name:"DivideRule",components:{BizSaveButton:h["a"]},props:{propModel:{required:!0,type:Object}},data:function(){var e=this;return{tempError:"",tempModel:{length:"1",name:"",options:[],order:"0",type:"0",value1:"",value2:"",id:"",tempValue:""},propTypelList:[{name:"单值",id:"0"},{name:"多值",id:"1"},{name:"范围值",id:"2"}],propOperations:[{label:"取消",name:"cancelPropOperate"},{label:"保存",name:"savePropOperate",type:"primary"}],propRules:{type:[{required:!0,message:"请选择属性类型",trigger:"blur"}],length:[{required:!0,message:"请输入长度",trigger:"blur"},{trigger:"blur",validator:function(t,a,i){/^\+?[1-9]\d*$/.test(e.propModel.length)?e.checkLength()?i():i(new Error("长度和属性值不匹配")):i(new Error("请输入大于0的整数"))}}],tempValue:[{required:!0,trigger:"blur",validator:function(t,a,i){if("1"===e.tempModel.type){var l=e.tempModel.tempValue.split(",");Array.isArray(l)&&l.length>1?i():i(new Error("请输入属性值，格式为x,y,z"))}else if("2"===e.tempModel.type){var r=e.tempModel.tempValue.split("-");Array.isArray(r)&&2===r.length?i():i(new Error("请输入属性值，格式为x-y"))}else e.tempModel.tempValue?i():i(new Error("请输入属性值"))}}],name:[{required:!0,message:"请输入属性名称",trigger:"blur"}],order:[{required:!0,message:"请输入排序",trigger:"blur"},{trigger:"blur",validator:function(t,a,i){Number(e.propModel.order)<0?i(new Error("请输入大于或等于0的数字")):i()}}]}}},computed:{getValue:function(e){return"1"===e.type?e.options.join(","):"2"===e.type?(e.value1?e.value1:"")+"-"+(e.value2?e.value2:""):e.value1}},watch:{propModel:function(){this.tempModel.length=this.propModel.length||"1",this.tempModel.name=this.propModel.name||"",this.tempModel.options=this.propModel.options||[],this.tempModel.order=this.propModel.order||"1",this.tempModel.type=this.propModel.type||"0",this.tempModel.value1=this.propModel.value1||"",this.tempModel.value2=this.propModel.value2||"",this.tempModel.id=this.propModel.id||"",this.tempModel.tempValue=this.getTempValue(this.propModel)}},created:function(){},methods:{operateHandler:function(e){this[e]()},checkLength:function(){var e=Number(this.tempModel.length),t=[];if("1"===this.tempModel.type){if(t=this.tempModel.tempValue.split(","),t.length<=2)return!1}else if("2"===this.tempModel.type){if(t=this.tempModel.tempValue.split("-"),2!==t.length)return!1}else t.push(this.tempModel.tempValue);var a,i=Object(E["a"])(t);try{for(i.s();!(a=i.n()).done;){var l=a.value;if(e!==l.length)return!1}}catch(r){i.e(r)}finally{i.f()}return!0},queryPropTypeList:function(){this.propTypelList=[{name:"单值",id:"0"},{name:"多值",id:"1"},{name:"范围值",id:"2"}]},savePropOperate:function(){var e=this;this.$refs.propForm.validate((function(t,a){if(!t)return!1;e.$emit("add-prop",e.getProp()),e.$emit("prod-cancel")}))},propRowDeleteClickHandler:function(e,t){this.deleteProp([t.id])},deleteProp:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.ruleModel.valueDatas.forEach((function(a,i){e.indexOf(a.id)>=0&&t.ruleModel.valueDatas.splice(i,1)}))}))},getProp:function(){var e={length:this.tempModel.length,name:this.tempModel.name,options:[],order:this.tempModel.order,type:this.tempModel.type,value1:"",value2:"",id:this.tempModel.id};if("1"===e.type)e.options=this.tempModel.tempValue.split(",");else if("2"===e.type){var t=this.tempModel.tempValue.split("-");e.value1=t[0]?t[0]:"",e.value2=t[1]?t[1]:""}else e.value1=this.tempModel.tempValue;return e},getTempValue:function(e){return"1"===e.type?e.options.join(","):"2"===e.type?(console.log("2"),[e.value1,e.value2].join("-")):e.value1},cancelPropOperate:function(){this.$emit("prod-cancel")},tempValueInput:function(){this.$refs.propForm.validate()}}}),F=P,H=(a("843c"),Object(_["a"])(F,A,z,!1,null,null,null)),V=H.exports,U={name:"total-rule",components:{BizSaveButton:h["a"],DivideRule:V,BizHeader:n["d"]},props:{terminalTypeId:String,show:{required:!0,type:Boolean},ruleIdObject:{required:!0,type:Object}},data:function(){var e=this;return{rowIndex:-1,propSelections:[],propModel:{},ruleLoading:!1,baseInfo:{},ruleModel:{name:"",length:"",valueDatas:[]},ruleOperations:[{label:"取消",name:"cancelRuleOperate"},{label:"保存",name:"saveRuleOperate",type:"primary"}],propTableOperations:[{label:"新建",name:"propAdd",type:"primary"},{label:"删除",name:"propDelete",type:"",disabled:!0}],showProp:!1,propTypelList:[],rules:{name:[{required:!0,message:"请输入规则名称",trigger:"blur"}],length:[{required:!0,min:1,message:"请输入长度",trigger:"blur"},{trigger:"blur",validator:function(t,a,i){var l=function(e){var t=0;return e.valueDatas.forEach((function(e){t+=Number(e.length)})),t===Number(e.length)};Number(e.ruleModel.length)<=0?i(new Error("请输入大于0的数字")):l(e.ruleModel)?i():i(new Error("设置的规则长度与其属性长度总和不符"))}}]}}},computed:{},watch:{ruleIdObject:function(){this.$refs.ruleForm.clearValidate(),this.ruleIdObject.id?this.queryRule():this.resetRule()}},created:function(){},methods:{operateHandler:function(e){this[e]()},saveRuleOperate:function(){var e=this;this.$refs.ruleForm.validate((function(t,a){if(!t)return!1;e.ruleLoading=!0,e.ruleModel.id?q.updateRule(Object(r["a"])(Object(r["a"])({},e.ruleModel),{},{terminalTypeId:e.terminalTypeId}),(function(t){e.$message.success("操作成功"),e.$emit("update:show",!1),e.$emit("updated"),e.ruleLoading=!1}),(function(t){e.$message.warning(t.errorMessage),e.ruleLoading=!1})):q.addRule(Object(r["a"])(Object(r["a"])({},e.ruleModel),{},{terminalTypeId:e.terminalTypeId}),(function(t){e.$message.success("操作成功"),e.$emit("update:show",!1),e.$emit("updated"),e.ruleLoading=!1}),(function(t){e.$message.warning(t.errorMessage),e.ruleLoading=!1}))}))},propAdd:function(){this.propModel={id:"",length:"1",name:"",options:[],order:"0",type:"0",value1:"",value2:""},this.rowIndex=-1,this.showProp=!0},propDelete:function(){if(this.propSelections&&this.propSelections.length>0){var e,t=Object(E["a"])(this.propSelections);try{for(t.s();!(e=t.n()).done;){var a=e.value,i=-1;i=this.ruleModel.valueDatas.indexOf(a),-1!==i&&this.ruleModel.valueDatas.splice(i,1)}}catch(l){t.e(l)}finally{t.f()}}},cancelRuleOperate:function(){this.$emit("update:show",!1),this.showProp=!1},cancelPropOperate:function(){this.showProp=!1},getRuleSaveParams:function(){return{terminalTypeId:this.itemId.id,id:this.ruleModel.id,name:this.ruleModel.name,length:this.ruleModel.length,order:this.ruleModel.order,valueDatas:this.ruleModel.valueDatas}},queryRule:function(){var e=this;this.ruleLoading=!0,q.queryRule({id:this.ruleIdObject.id},(function(t){console.log(t),e.ruleModel=t.content,e.ruleLoading=!1}),(function(t){console.log(t),console.log("code错误"),e.ruleLoading=!1}))},propSelectionChangeHandler:function(e){this.propTableOperations[1].disabled=!0,e.length>0&&(this.propTableOperations[1].disabled=!1),this.propSelections=e},resetRule:function(){this.ruleModel={name:"",length:"",valueDatas:[]}},typeConverter:function(e){var t=["单值","多值","范围值"];return t[e.type]},valueConverter:function(e){return"1"===e.type?e.options.join(","):"2"===e.type?[e.value1,e.value2].join("-"):e.value1},addProp:function(e){var t=-1===this.rowIndex;if(t){var a,i=0,l=Object(E["a"])(this.ruleModel.valueDatas);try{for(l.s();!(a=l.n()).done;){var r=a.value;if(e.order===r.order)return void this.$message.warning("排序冲突");if(r.order>e.order)break;i++}}catch(s){l.e(s)}finally{l.f()}this.ruleModel.valueDatas.splice(i,0,e)}else{for(var n=0;n<this.ruleModel.valueDatas.length;n++){var o=this.ruleModel.valueDatas[n];if(n!==this.rowIndex&&(console.log("index：",n),e.order===o.order))return void this.$message.warning("排序冲突")}this.ruleModel.valueDatas.splice(this.rowIndex,1,e)}this.$refs.ruleForm.validate()},prodCancel:function(){this.showProp=!1},propRowEditClickHandler:function(e){var t=e.$index,a=e.row;this.propModel={id:a.id,length:a.length,name:a.name,options:a.options,order:a.order,type:a.type,value1:a.value1,value2:a.value2},this.rowIndex=t,this.showProp=!0},propRowDeleteClickHandler:function(e){var t=e.$index;this.ruleModel.valueDatas.splice(t,1)}}},G=U,Q=(a("c701"),Object(_["a"])(G,B,D,!1,null,null,null)),J=Q.exports,X={name:"CodingRule",components:{BizSaveButton:h["a"],BizGrid:f["a"],TotalRule:J},data:function(){return{errorMessage:"",operations:[{label:"新建",name:"addRuleOperate",type:"primary"},{label:"删除",name:"deleteRuleOperate",type:"",disabled:!0}],tableData:[],selections:[],ruleLoading:!1,showRule:!1,ruleIdObject:{}}},props:{itemId:{type:Object,default:function(){return{id:""}}}},created:function(){},methods:{init:function(){this.itemId.id?this.query():this.tableData=[]},operateHandler:function(e){this[e]()},rowDeleteClickHandler:function(e){this.deleteRule([e.id])},rowEditClickHandler:function(e){this.ruleIdObject={id:e.id},this.showRule=!0},selectionChangeHandler:function(e){console.log(e),this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1),this.selections=e},deleteRuleOperate:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteRule(e)}else this.$message("请选择一个规则进行删除")},addRuleOperate:function(){this.showRule=!0,this.ruleIdObject={id:""}},query:function(){var e=this;q.query({terminalTypeId:this.itemId.id},(function(t){e.tableData=t.content,e.selections=[],e.showRule=!1,e.showProp=!1}),(function(t){"800"===t.resultCode?e.errorMessage=t.errorMessage:e.$message.warning(t.errorMessage)}))},deleteRule:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){q.deleteRule({ids:e},(function(e){t.$message.success("删除成功"),t.query()}),(function(e){t.$message.warning(e.errorMessage)}))}))}},computed:{},watch:{itemId:function(){this.init()}},mounted:function(){this.init()}},Y=X,K=(a("7685"),Object(_["a"])(Y,j,N,!1,null,null,null)),W=K.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"terminal-mgmt-class__terminal-update"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.errorMessage,expression:"!errorMessage"}]},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"发布文件",prop:"files"}},[a("biz-file-uploader",{attrs:{fileList:e.formModel.fileList},on:{fileListChange:e.handleFileListChange},model:{value:e.formModel.files,callback:function(t){e.$set(e.formModel,"files",t)},expression:"formModel.files"}})],1),a("el-form-item",{attrs:{label:"文件版本",prop:"version"}},[a("el-input",{attrs:{placeholder:"请输入文件版本"},model:{value:e.formModel.version,callback:function(t){e.$set(e.formModel,"version",t)},expression:"formModel.version"}})],1),a("el-form-item",{attrs:{label:"文件资费",prop:"price"}},[a("el-input",{attrs:{placeholder:"请输入文件资费",type:"number",min:"0"},model:{value:e.formModel.price,callback:function(t){e.$set(e.formModel,"price",t)},expression:"formModel.price"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{attrs:{label:"文件图标",value:e.formModel.logo}},[a("biz-avatar-uploader-new",{model:{value:e.formModel.logo,callback:function(t){e.$set(e.formModel,"logo",t)},expression:"formModel.logo"}})],1),a("el-form-item",{attrs:{label:"发布说明"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入发布说明"},model:{value:e.formModel.description,callback:function(t){e.$set(e.formModel,"description",t)},expression:"formModel.description"}})],1),a("el-form-item",{attrs:{label:"兼容版本",value:e.formModel.options}},[a("tag-manager",{attrs:{removeHandler:e.removeHandler,placeholder:"请输入兼容版本"},model:{value:e.formModel.options,callback:function(t){e.$set(e.formModel,"options",t)},expression:"formModel.options"}})],1)],1)],1),a("p",{directives:[{name:"show",rawName:"v-show",value:e.errorMessage,expression:"errorMessage"}]},[e._v(e._s(e.errorMessage))])])},ee=[],te=(a("baa5"),a("c17f")),ae=a("a99c"),ie={query:function(e,t,a){v.a.get(M["g"].terminalMgmt.TerminalUpdate_query,{params:e}).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},update:function(e,t,a){v.a.post(M["g"].terminalMgmt.TerminalUpdate_update,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))},add:function(e,t,a){v.a.post(M["g"].terminalMgmt.TerminalUpdate_add,e).then(Object(g["a"])(t,a)).catch((function(e){console.error(e)}))}},le=void 0,re={name:"TerminalUpdate",components:{BizSaveButton:h["a"],BizGrid:f["a"],BizFileUploader:te["d"],BizAvatarUploaderNew:te["b"],TagManager:ae["a"]},props:{itemId:{type:Object,default:function(){return{id:""}}}},data:function(){var e=this;return{loading:"",errorMessage:"",fileData:{type:"0"},operations:[{label:"保存",name:"save",type:"primary"}],rules:{files:[{required:!0,message:"请选择发布文件",trigger:"blur"}],version:[{required:!0,message:"请输入文件版本",trigger:"blur"}],price:[{trigger:"blur",validator:function(t,a,i){e.formModel.price<0?i(new Error("资费不能为负数")):i()}}]},communicationProtocolList:[],communicationStandardList:[],formModel:this.getDefaultModel()}},created:function(){},methods:{removeHandler:function(e){return"1"!==e.isAttend||(le.$message.warning("该字段已经有人报名使用，无法删除"),!1)},init:function(){this.itemId.id?this.query():this.resetModel(),this.$refs.form&&this.$refs.form.resetFields()},query:function(){var e=this;ie.query({terminalTypeId:this.itemId.id},(function(t){var a=Object.assign(e.getDefaultModel(),t.content),i=[];if(a.fileNames=a.name?a.name.split(","):[],a.files=a.path?a.path.split(","):[],a.fileNames.forEach((function(e,t){i.push({name:e,url:a.files[t]})})),a.fileList=i,a.options=[],a.compatibleVersion){var l=a.compatibleVersion.split(",");l.forEach((function(e){a.options.push({content:e})}))}else a.options=[];e.formModel=a,e.errorMessage=""}),(function(t){console.log(t),console.log("code错误"),"827"===t.resultCode?e.errorMessage=t.errorMessage:(e.$message.warning(t.errorMessage),e.resetModel())}))},getSaveParams:function(){var e=[];return this.formModel.options&&this.formModel.options.forEach((function(t){e.push(t.content)})),{terminalTypeId:this.itemId.id,path:this.formModel.files.join(","),name:this.formModel.fileNames.join(","),version:this.formModel.version,price:this.formModel.price,logo:this.formModel.logo,description:this.formModel.description,compatibleVersion:e.join(",")}},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return{logo:"",files:[]}},operateHandler:function(e){this[e]()},handleFileListChange:function(e){var t=[];e.forEach((function(e){t.push(e.name)})),this.formModel.fileNames=t;var a=this.formModel.fileNames[this.formModel.fileNames.length-1];this.formModel.version=a.substr(0,a.lastIndexOf(".")),this.$refs.form&&this.$refs.form.validate()},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0,e.formModel.id?ie.update(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),e.loading=!1})):ie.add(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),e.loading=!1}))}))}},computed:{},watch:{itemId:function(e,t){this.init()}},mounted:function(){this.init()}},ne=re,oe=(a("4299"),Object(_["a"])(ne,Z,ee,!1,null,null,null)),se=oe.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"terminal-mgmt-class__terminal-class-ability"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.errorMessage,expression:"!errorMessage"}]},[a("biz-header",{attrs:{operations:e.ruleTableOperations},on:{operate:e.handleOperate}}),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"length",label:"车型数量",width:"80"}}),a("el-table-column",{attrs:{prop:"title",label:"操作",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.handleRowDeleteClick(a,t.row)}}},[e._v(" 删除 ")])]}}])})],1),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showRule,expression:"showRule"},{name:"loading",rawName:"v-loading",value:e.ruleLoading,expression:"ruleLoading"}],staticClass:"box-card"},[a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.ruleOperations},on:{operate:e.handleOperate}}),a("el-form",{ref:"ruleForm",attrs:{size:"small","label-width":"110px",model:e.ruleModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{staticClass:"name",attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.ruleModel.name,callback:function(t){e.$set(e.ruleModel,"name",t)},expression:"ruleModel.name"}})],1),a("el-form-item",{attrs:{label:"品牌"}},[a("div",{staticClass:"car-list"},e._l(e.ruleModel.selectedBrands,(function(t,i){return a("div",{key:i,staticClass:"car-item"},[a("div",{staticClass:"button-wrapper"},[a("el-button",{staticClass:"close",attrs:{type:"text"},on:{click:function(t){return e.handleBrandCloseClick(i,t)}}},[a("i",{staticClass:"el-icon-circle-close"})]),a("el-button",{staticClass:"add",attrs:{type:"text"},on:{click:e.handleBrandAddClick}},[a("i",{staticClass:"el-icon-circle-plus"})])],1),a("div",{staticClass:"select-wrapper"},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:""},on:{change:e.handleBrandChange},model:{value:e.ruleModel.selectedBrands[i],callback:function(t){e.$set(e.ruleModel.selectedBrands,i,t)},expression:"ruleModel.selectedBrands[index]"}},e._l(e.brandList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.brandName,value:e.brandId}})})),1)],1)])})),0)]),a("el-form-item",{attrs:{label:"车系"}},[a("div",{staticClass:"car-list"},e._l(e.ruleModel.selectedSerieses,(function(t,i){return a("div",{key:i,staticClass:"car-item"},[a("div",{staticClass:"button-wrapper"},[a("el-button",{staticClass:"close",attrs:{type:"text"},on:{click:function(t){return e.handleSeriesCloseClick(i,t)}}},[a("i",{staticClass:"el-icon-circle-close"})]),a("el-button",{staticClass:"add",attrs:{type:"text"},on:{click:e.handleSeriesAddClick}},[a("i",{staticClass:"el-icon-circle-plus"})])],1),a("div",{staticClass:"select-wrapper"},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:""},on:{change:e.handleSeriesChange},model:{value:e.ruleModel.selectedSerieses[i],callback:function(t){e.$set(e.ruleModel.selectedSerieses,i,t)},expression:"ruleModel.selectedSerieses[index]"}},e._l(e.seriesList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.seriesName,value:e.seriesId}})})),1)],1)])})),0)]),a("el-form-item",{attrs:{label:"车型"}},[a("div",{staticClass:"car-list"},e._l(e.ruleModel.selectedModes,(function(t,i){return a("div",{key:i,staticClass:"car-item"},[a("div",{staticClass:"button-wrapper"},[a("el-button",{staticClass:"close",attrs:{type:"text"},on:{click:function(t){return e.handleModeCloseClick(i,t)}}},[a("i",{staticClass:"el-icon-circle-close"})]),a("el-button",{staticClass:"add",attrs:{type:"text"},on:{click:e.handleModeAddClick}},[a("i",{staticClass:"el-icon-circle-plus"})])],1),a("div",{staticClass:"select-wrapper"},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:""},on:{change:e.handleModeChange},model:{value:e.ruleModel.selectedModes[i],callback:function(t){e.$set(e.ruleModel.selectedModes,i,t)},expression:"ruleModel.selectedModes[index]"}},e._l(e.modeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.typeName,value:e.typeId}})})),1)],1)])})),0)]),a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.abilityList,(function(t,i){return a("el-collapse-item",{key:i,attrs:{title:t.name,name:i}},[a("el-checkbox-group",{staticClass:"terminal-mgmt-class__class-ability-setting__checkbox-group",model:{value:e.ruleModel.abilities,callback:function(t){e.$set(e.ruleModel,"abilities",t)},expression:"ruleModel.abilities"}},e._l(t.capacityData,(function(t){return a("div",{key:t.id,staticClass:"checkbox-item"},[a("el-checkbox",{attrs:{label:t.id},on:{change:function(a){return e.handleCheckChange(t.id,t.capacityData,a)}}},[e._v(e._s(t.name)+" ")]),t.capacityData?a("div",{directives:[{name:"show",rawName:"v-show",value:e.ruleModel.abilities.indexOf(t.id)>=0,expression:"ruleModel.abilities.indexOf(item.id) >= 0"}],staticClass:"checkbox-sub"},e._l(t.capacityData,(function(t){return a("div",{key:t.id,staticClass:"checkbox-item"},[a("el-checkbox",{attrs:{label:t.id}},[e._v(e._s(t.name))]),t.capacityData?a("div",{directives:[{name:"show",rawName:"v-show",value:e.ruleModel.abilities.indexOf(t.id)>=0,expression:"ruleModel.abilities.indexOf(sub.id) >= 0"}],staticClass:"checkbox-sub"},e._l(t.capacityData,(function(t){return a("div",{key:t.id,staticClass:"checkbox-item"},[a("el-checkbox",{attrs:{label:t.id}},[e._v(e._s(t.name))]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.ruleModel.abilities.indexOf(t.id)>=0&&"1"===t.type,expression:"ruleModel.abilities.indexOf(sub1.id) >= 0 && sub1.type === '1'"}]},[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},["方向盘打死提醒"===t.name?a("label",{staticClass:"title-label"},[e._v("方向盘转向角度")]):e._e(),"转向辅助转向灯"===t.name?a("label",{staticClass:"title-label"},[e._v("转向灯转向角度")]):e._e(),"油量最低阈值提醒"===t.name?a("label",{staticClass:"title-label"},[e._v("油量预警值")]):e._e(),"电池电压异常提醒"===t.name?a("label",{staticClass:"title-label"},[e._v("电压预警值")]):e._e(),"车辆喇叭音量高低调节"===t.name?a("label",{staticClass:"title-label"},[e._v("喇叭音量大小")]):e._e(),"伴我回家"===t.name?a("label",{staticClass:"title-label"},[e._v("大灯延迟关闭时间")]):e._e(),"行车落锁"===t.name?a("label",{staticClass:"title-label"},[e._v("车速值")]):e._e(),"自动大灯"===t.name?a("label",{staticClass:"title-label"},[e._v("自动大灯灵敏度")]):e._e(),a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-text":"关闭",width:30},model:{value:t.closed,callback:function(a){e.$set(t,"closed",a)},expression:"sub1.closed"}})],1),"0"===t.closed?a("el-radio-group",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"sub1.value"}},["方向盘打死提醒"===t.name?a("el-radio",{attrs:{label:"400"}},[e._v("400°")]):e._e(),"方向盘打死提醒"===t.name?a("el-radio",{attrs:{label:"500"}},[e._v("500°")]):e._e(),"转向辅助转向灯"===t.name?a("el-radio",{attrs:{label:"110"}},[e._v("110°")]):e._e(),"转向辅助转向灯"===t.name?a("el-radio",{attrs:{label:"90"}},[e._v("90°")]):e._e(),"转向辅助转向灯"===t.name?a("el-radio",{attrs:{label:"70"}},[e._v("70°")]):e._e(),"油量最低阈值提醒"===t.name?a("el-radio",{attrs:{label:"2"}},[e._v("2L")]):e._e(),"油量最低阈值提醒"===t.name?a("el-radio",{attrs:{label:"5"}},[e._v("5L")]):e._e(),"油量最低阈值提醒"===t.name?a("el-radio",{attrs:{label:"12"}},[e._v("12L")]):e._e(),"电池电压异常提醒"===t.name?a("el-radio",{attrs:{label:"11"}},[e._v("11V")]):e._e(),"伴我回家"===t.name?a("el-radio",{attrs:{label:"60"}},[e._v("60S")]):e._e(),"伴我回家"===t.name?a("el-radio",{attrs:{label:"30"}},[e._v("30S")]):e._e(),"伴我回家"===t.name?a("el-radio",{attrs:{label:"15"}},[e._v("15S")]):e._e(),"行车落锁"===t.name?a("el-radio",{attrs:{label:"30"}},[e._v("30km/h")]):e._e(),"行车落锁"===t.name?a("el-radio",{attrs:{label:"20"}},[e._v("20km/h")]):e._e(),"行车落锁"===t.name?a("el-radio",{attrs:{label:"10"}},[e._v("10km/h")]):e._e(),"自动大灯"===t.name||"车辆喇叭音量高低调节"===t.name?a("el-radio",{attrs:{label:"1"}},[e._v("高")]):e._e(),"自动大灯"===t.name||"车辆喇叭音量高低调节"===t.name?a("el-radio",{attrs:{label:"2"}},[e._v("中")]):e._e(),"自动大灯"===t.name||"车辆喇叭音量高低调节"===t.name?a("el-radio",{attrs:{label:"3"}},[e._v("低")]):e._e()],1):e._e(),"0"===t.closed?a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-text":"自定义",width:30},model:{value:t.userDefined,callback:function(a){e.$set(t,"userDefined",a)},expression:"sub1.userDefined"}}):e._e()],1)],1)})),0):e._e()],1)})),0):e._e()],1)})),0)],1)})),1)],1)],1)],1),a("p",{directives:[{name:"show",rawName:"v-show",value:e.errorMessage,expression:"errorMessage"}]},[e._v(e._s(e.errorMessage))])])},de=[],ue=(a("caad"),a("d81d"),a("4ec9"),a("2532"),a("3ca3"),a("ddb0"),{data:{radio:"",checkbox:!1,loading:!1,errorMessage:"",ruleTableOperations:[{label:"新建",name:"addRuleOperate",type:"primary"},{label:"删除",name:"deleteRuleOperate",type:"",disabled:!0}],tableData:[]},events:{handleSelectionChange:function(e){this.ruleTableOperations[1].disabled=!0,e.length>0&&(this.ruleTableOperations[1].disabled=!1),this.selections=e},handleRowDeleteClick:function(e,t){e.stopPropagation(),this.deleteRule([t.id])},handleRowClick:function(e,t){var a=Object.assign(pe(),e);a.abilities=e.abilityList&&e.abilityList.map((function(e){return e.ability}))||[],console.log("obj.abilities"+a.abilities);var i=[];a.carBrands&&a.carBrands.length>0&&(this.doQuerySeriesList(a.carBrands),a.carBrands.forEach((function(e){i.push(e.brandId)})),a.selectedBrands=i);var l=[];a.carSerieses&&a.carSerieses.length>0&&(this.doQueryModelList(a.carSerieses),a.carSerieses.forEach((function(e){l.push(e.seriesId)})),a.selectedSerieses=l);var r=[];a.carTypes&&a.carTypes.length>0&&(a.carTypes.forEach((function(e){r.push(e.typeId)})),a.selectedModes=r),this.initRule(a)},deleteRuleOperate:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteRule(e)}else this.$message("请选择一个配置项删除")},addRuleOperate:function(){this.initRule()}},methods:{init:function(){this.itemId.id?this.query():this.tableData=[],this.showRule=!1},query:function(){var e=this;this.loading=!0,s["a"].get(M["y"].TerminalClassAbility.list,{terminalType:this.itemId.id}).then((function(t){e.tableData=t.dataList?t.dataList:[],e.selections=[],e.showRule=!1})).catch((function(t){console.log(t),console.log("code错误"),"800"===t.resultCode?e.errorMessage=t.errorMessage:e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},deleteRule:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,s["a"].post(M["y"].TerminalClassAbility.delete,{ids:e}).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))}))}}}),pe=function(){return{selectedBrands:[""],selectedSerieses:[""],selectedModes:[""],abilities:[]}},me={data:{ruleLoading:!1,showRule:!1,ruleModel:pe(),ruleOperations:[{label:"取消",name:"cancelRuleOperate"},{label:"保存",name:"saveRuleOperate",type:"primary"}],activeNames:[],abilityList:[],saveAbilityList:[]},events:{cancelRuleOperate:function(){this.showRule=!1},saveRuleOperate:function(){var e=this;this.$refs.ruleForm.validate((function(t,a){if(!t)return!1;var i=function(t){e.$message.success("保存成功"),e.query(),e.showRule=!1},l=function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)},r=function(t){e.ruleLoading=!1};e.ruleLoading=!0,s["a"].post(e.ruleModel.id?M["y"].TerminalClassAbility.update:M["y"].TerminalClassAbility.add,e.getRuleSaveParams()).then(i).catch(l).finally(r)}))},handleCheckChange:function(e,t,a){var i=this;console.log(t),t&&t.length>0&&(a||t.forEach((function(e){var t=i.ruleModel.abilities.indexOf(e.id);t>=0&&i.ruleModel.abilities.splice(t,1)})))}},methods:{queryAbilityList:function(){var e=this;s["a"].get(M["y"].TerminalClassAbility.abilityList,{}).then((function(t){e.abilityList=t.data,console.log(t.data)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.ruleLoading=!1}))},initRule:function(e){this.ruleModel=e?Object.assign(this.getDefaultRuleModel(),e):this.getDefaultRuleModel(),this.activeNames=[],this.showRule=!0,this.showRule=!0,this.$refs.ruleForm&&this.$refs.ruleForm.resetFields()},getDefaultRuleModel:function(){return pe()},resetRuleModel:function(){this.ruleModel=Object.assign({},this.getDefaultRuleModel())},setObj:function(e){for(var t in e)this.ruleModel.abilities.includes(e[t].id)&&this.saveAbilityList.push({ability:e[t].id,abilityCategory:"basic",checked:"1",name:e[t].name,type:e[t].type,value:e[t].value,userDefined:e[t].userDefined,closed:e[t].closed}),e[t].capacityData&&this.setObj(e[t].capacityData)},getRuleSaveParams:function(){var e=this,t=[];this.ruleModel.selectedBrands.forEach((function(a){a&&t.push(e.brandMap.get(a))}));var a=[];this.ruleModel.selectedSerieses.forEach((function(t){t&&a.push(e.seriesMap.get(t))}));var i=[];return this.ruleModel.selectedModes.forEach((function(t){t&&i.push(e.modelMap.get(t))})),this.saveAbilityList=[],console.log("this.abilityList"+this.abilityList),console.log("this.ruleModel.abilities"+this.ruleModel.abilities),this.setObj(this.abilityList),{terminalType:this.itemId.id,id:this.ruleModel.id,name:this.ruleModel.name,carBrands:t,carSerieses:a,carTypes:i,abilities:this.ruleModel.abilities.join(","),abilityList:this.saveAbilityList}}}},fe={data:{brandList:[],seriesList:[],modeList:[]},events:{handleBrandChange:function(e,t){this.resetSeries(this.ruleModel.selectedBrands),this.resetMode()},handleBrandAddClick:function(e){this.ruleModel.selectedBrands.push("")},handleBrandCloseClick:function(e,t){this.ruleModel.selectedBrands.splice(e,1),this.resetSeries(this.ruleModel.selectedBrands),this.resetMode()},handleSeriesChange:function(e){this.resetMode(this.ruleModel.selectedSerieses)},handleSeriesAddClick:function(e){this.ruleModel.selectedSerieses.push("")},handleSeriesCloseClick:function(e,t){this.ruleModel.selectedSerieses.splice(e,1),this.resetMode(this.ruleModel.selectedSerieses)},handleModeChange:function(e){},handleModeAddClick:function(e){this.ruleModel.selectedModes.push("")},handleModeCloseClick:function(e,t){this.ruleModel.selectedModes.splice(e,1)}},methods:{initBrandMap:function(e){var t=this;this.brandMap=new Map,e.forEach((function(e){t.brandMap.set(e.brandId,e)}))},initSeriesMap:function(e){var t=this;this.seriesMap=new Map,e.forEach((function(e){t.seriesMap.set(e.seriesId,e)}))},initModelMap:function(e){var t=this;this.modelMap=new Map,e.forEach((function(e){t.modelMap.set(e.typeId,e)}))},queryBrandList:function(){var e=this;s["a"].get(M["y"].TerminalClassAbility.brandList,{}).then((function(t){var a=t.dataList;a.unshift({brandId:"",brandName:"全部"}),e.brandList=a,e.initBrandMap(t.dataList)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},querySeriesList:function(e){var t=this,a=[];e&&e.forEach((function(e){e&&a.push(t.brandMap.get(e))})),a.length>0&&this.doQuerySeriesList(a)},doQuerySeriesList:function(e){var t=this;s["a"].post(M["y"].TerminalClassAbility.seriesList,{carBrands:e}).then((function(e){var a=e.dataList;a.unshift({seriesId:"",seriesName:"全部"}),t.seriesList=a,t.initSeriesMap(e.dataList)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)}))},queryModelList:function(e){var t=this,a=[];e&&e.forEach((function(e){e&&a.push(t.seriesMap.get(e))})),a.length>0&&this.doQueryModelList(a)},doQueryModelList:function(e){var t=this;s["a"].post(M["y"].TerminalClassAbility.modelList,{carSerieses:e}).then((function(e){var a=e.dataList;a.unshift({typeId:"",typeName:"全部"}),t.modeList=a,t.initModelMap(e.dataList)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)}))},resetSeries:function(e){this.querySeriesList(e),this.$set(this.ruleModel,"selectedSerieses",[""])},resetMode:function(e){this.queryModelList(e),this.$set(this.ruleModel,"selectedModes",[""])}}},he={name:"TerminalClassAbility",components:{BizSaveButton:h["a"],BizGrid:f["a"],BizHeader:n["d"]},props:{itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return Object(r["a"])(Object(r["a"])(Object(r["a"])({},ue.data),me.data),{},{rules:{name:[{required:!0,message:"请输入规则名称",trigger:"blur"}]}},fe.data)},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({handleOperate:function(e){this[e]()}},ue.events),ue.methods),me.events),me.methods),fe.events),fe.methods),computed:{computedValue:{get:function(){return this.getValue(this.propModel)},set:function(e){if("1"===this.propModel.type)this.propModel.options=e.split(",");else if("2"===this.propModel.type){var t=e.split("-");this.propModel.value1=t[0]?t[0]:"",this.propModel.value2=t[1]?t[1]:""}else this.propModel.value1=e}}},watch:{itemId:function(e,t){this.init()}},created:function(){this.queryBrandList(),this.queryAbilityList()},mounted:function(){this.init()}},ge=he,be=(a("fb1b"),Object(_["a"])(ge,ce,de,!1,null,null,null)),ve=be.exports,Me=a("439f"),ye={name:"TerminalClassPopup",components:{BizPopupTabs:u["a"],AccessSetting:x,TerminalClassBaseInfo:R,CodingRule:W,TerminalUpdate:se,TerminalClassAbility:ve},props:{open:{type:Boolean},itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{tabSelection:"0"}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)}},watch:{open:function(e){var t=this;e&&setTimeout((function(){t.tabSelection="0",Me["a"].clearMessageBoxes(),t.$message({showClose:!0,message:"可管理该类型终端的基本信息和能力"})}),500)},tabSelection:function(e){switch(this.$refs.dataStreamTab&&this.$refs.dataStreamTab.clearInterval(),Me["a"].clearMessageBoxes(),e){case"0":this.$message({showClose:!0,message:"可管理该类型终端的基本信息和能力"});break;case"1":this.$message({showClose:!0,message:"维护终端的接入配置，务必保证终端接入信息正确哦"});break;case"2":this.$message({showClose:!0,message:"维护终端类型的编码规则，记得规则不要过于简单啊"});break;case"3":this.$message({showClose:!0,message:"可管理该类型终端的基本信息和能力"});break;case"4":this.$message({showClose:!0,message:"终端有升级时，记得及时上传升级文件哦"});break}}}},we=ye,Ce=Object(_["a"])(we,c,d,!1,null,null,null),_e=Ce.exports,Se=a("50d3"),xe={data:{importResult:[],importLoading:!1,disabled:!1,total:0,count:0,t:"",percentage:0,stepkey:"",pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}},methods:{numberConverter:function(e){return e[0]},statusConverter:function(e){return"1"===e.status?"启用":"停用"},infoConverter:function(e){return"ok"===e[e.length-1]?"":e[e.length-1]},clearTimeOut:function(){window.clearTimeout(this.t)},restProcess:function(){this.total=0,this.count=0,this.stepkey="",this.percentage=0}},events:{handleImport:function(){var e=this,t="/admin/terminal/importProgress.jhtml";s["a"].get(t,{}).then((function(t){t.data.total||(e.total=0,e.count=0,e.stepkey="",e.percentage=0),t.data.total&&(e.total=Number(t.data.total||0),e.count=Number(t.data.count||0),e.stepkey=t.data.remark,e.percentage=Number(t.data.rate),e.$refs.importFile.title=t.data.title),t.data&&t.data.rate&&"100"===t.data.rate?(e.clearTimeOut(),e.$refs.importFile.showCurrentInfo=!1,e.$refs.importFile.title="导入完成",e.disabled=!1):t.data&&t.data.rate&&"100"!==t.data.rate&&(e.t&&e.clearTimeOut(),e.t=setTimeout(e.handleImport,2e3),e.$refs.importFile.uploadingVisible=!0,e.$refs.importFile.showCurrentInfo=!0,e.disabled=!0)})).catch((function(e){console.log(e),console.log("code错误")}))}}},ke={name:"TerminalMgmtClass",components:{BizFlexTable:n["c"],TerminalClassPopup:_e,ImportFile:o["b"]},props:{},data:function(){return Object(r["a"])({itemId:{},open:!1,loading:!1,tableData:[],selections:[],operations:[{label:"新增",name:"add",type:"primary"},{label:"删除",name:"delete",type:"",disabled:!0},{label:"模板下载",name:"download",type:""}]},xe.data)},methods:Object(r["a"])(Object(r["a"])({typeConverter:function(e){var t="";switch(e.styleType){case"intelligent_driving":t="智能驾驶";break;case"comfort_control":t="舒适控制";break;case"entertainment_information":t="娱乐信息";break;case"intelligentaccess":t="智能到店";break}return t},delete:function(){var e=this;if(this.selections&&this.selections.length>0){var t=[];this.selections.forEach((function(e){t.push(e.id)})),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Se["a"].delete({ids:t},(function(t){e.$message.success("删除成功"),e.query()}),(function(t){e.$message.warning(t.errorMessage)}))}))}else this.$message("请选择一个终端")},selectionChangeHandler:function(e){this.selections=e,this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1)},operationSuccess:function(){this.open=!1,this.query()},operateHandler:function(e){this[e]()},pageSizeChange:function(e){this.pagination.pageSize=e,this.pagination.currentPage=1,this.query()},currentPageChange:function(e){this.pagination.currentPage=e,this.query()},rowOperationClickHandler:function(e,t,a){this.itemId={id:e.id},this.open=!0},rowDeleteClickHandler:function(e,t,a){var i=this;t.stopPropagation(),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Se["a"].delete({ids:[e.id]},(function(e){i.$message.success("删除成功"),i.query()}),(function(e){i.$message.warning(e.errorMessage)}))}))},query:function(){var e=this;this.loading=!0,Se["a"].query({pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize},(function(t){e.tableData=t.data,e.pagination.total=Number(t.total),e.loading=!1}),(function(t){console.log(t),console.log("code错误"),e.loading=!1}))},add:function(){this.open=!0,this.itemId={id:""}},download:function(){window.open("/upload/mode/V服爱车_终端设备导入模板.xlsx")},abilityConverter:function(e){var t=[];return e.ability.forEach((function(e){t.push(e.name)})),t.join(", ")}},xe.methods),xe.events),created:function(){this.query()}},Oe=ke,$e=Object(_["a"])(Oe,i,l,!1,null,null,null);t["default"]=$e.exports},e58c:function(e,t,a){"use strict";var i=a("fc6a"),l=a("a691"),r=a("50c4"),n=a("a640"),o=a("ae40"),s=Math.min,c=[].lastIndexOf,d=!!c&&1/[1].lastIndexOf(1,-0)<0,u=n("lastIndexOf"),p=o("indexOf",{ACCESSORS:!0,1:0}),m=d||!u||!p;e.exports=m?function(e){if(d)return c.apply(this,arguments)||0;var t=i(this),a=r(t.length),n=a-1;for(arguments.length>1&&(n=s(n,l(arguments[1]))),n<0&&(n=a+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:c},e683b:function(e,t,a){},fb1b:function(e,t,a){"use strict";var i=a("2d7d"),l=a.n(i);l.a},fca0:function(e,t,a){}}]);