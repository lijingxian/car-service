(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-522eedb4"],{1522:function(e,t,a){},"68c3":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vehicle-mgmt-marketing-cars"},[a("biz-grid",[a("biz-header",{attrs:{operations:e.operations,filters:e.filters},on:{operate:e.operate,filterDataChange:e.filterDataChange}}),a("analysis-header",{attrs:{headerData:e.totalData}}),a("biz-table-body",{directives:[{name:"show",rawName:"v-show",value:"control"===e.filters[1].value,expression:"filters[1].value === 'control'"}],ref:"table",attrs:{tableData:e.currentTable,height:"565",pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"date",label:"日期"}}),a("el-table-column",{attrs:{prop:"fence",label:"入围栏/出围栏(次)"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.fenceinReminder)+"/"+e._s(t.row.fenceoutReminder)+" ")]}}])}),a("el-table-column",{attrs:{prop:"faultTimes",label:"故障(次)"}}),a("el-table-column",{attrs:{prop:"collision",label:"碰撞(次)"}}),a("el-table-column",{attrs:{prop:"underVoltage",label:"欠压(次)"}}),a("el-table-column",{attrs:{prop:"fire",label:"点火/熄火(次)"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.ignitionTimes)+"/"+e._s(t.row.flameoutTimes)+" ")]}}])}),a("el-table-column",{attrs:{prop:"plug",label:"插电/拔出(次)"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.pluginDevice)+"/"+e._s(t.row.plugoutDevice)+" ")]}}])}),a("el-table-column",{attrs:{prop:"highTemperature",label:"高温(次)"}}),a("el-table-column",{attrs:{prop:"towaway",label:"被拖吊(次)"}})],1),a("biz-table-body",{directives:[{name:"show",rawName:"v-show",value:"drivingAction"===e.filters[1].value,expression:"filters[1].value === 'drivingAction'"}],ref:"table",attrs:{tableData:e.currentTable,height:"565",pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"date",label:"日期"}}),a("el-table-column",{attrs:{prop:"drivingActionMap[3]",label:"急减速(次)"}}),a("el-table-column",{attrs:{prop:"drivingActionMap[2]",label:"急加速(次)"}}),a("el-table-column",{attrs:{prop:"drivingActionMap[7]",label:"急转弯(次)"}}),a("el-table-column",{attrs:{prop:"drivingActionMap[5]",label:"急刹车(次)"}}),a("el-table-column",{attrs:{prop:"drivingActionMap[9]",label:"高转速(次)"}}),a("el-table-column",{attrs:{prop:"drivingActionMap[4]",label:"长怠速(次)"}})],1),"miles"===e.filters[1].value?a("biz-chart",{ref:"rangeChart",attrs:{chartData:e.rangeChartData,loading:e.loading,chartHeight:e.chartHeight,showSearch:!1}}):e._e(),"oil"===e.filters[1].value?a("biz-chart",{ref:"oilChart",attrs:{chartData:e.oilChartData,loading:e.loading,chartHeight:e.chartHeight,showSearch:!1}}):e._e()],1)],1)},r=[],l=(a("99af"),a("d81d"),a("fb6a"),a("b0c0"),a("84fd")),n=a("815c"),o=a("4c91"),s=a("562e"),u=a("f36f"),h=a("cc3c"),c={name:"MarketingCars",data:function(){return{loading:!1,today:"",operations:[{label:"搜索",name:"refresh",type:""},{label:"导出",name:"export",type:""}],filters:[{type:"select",label:"车队",name:"driver",value:"",options:[]},{type:"select",label:"类型",name:"type",value:"oil",options:[{value:"control",label:"管控分析"},{value:"drivingAction",label:"驾驶行为分析"},{value:"miles",label:"时长里程分析"},{value:"oil",label:"油耗分析"}]},{type:"daterange",label:"日期区间：",value:["2011-11-11","2012-12-12"]}],tableData:[],rangeChartData:{type:"histogram",data:{columns:["日期","行驶里程","行驶时长"],rows:[]},settings:{metrics:["行驶里程","行驶时长"],showLine:["行驶里程","行驶时长"],yAxisType:["normal","normal"],yAxisName:["       行驶里程(km)","行驶时长(h)"],axisSite:{right:["行驶时长(h)"]}}},oilChartData:{type:"histogram",data:{columns:["日期","总油耗(L)"],rows:[]},settings:{metrics:["总油耗"],showLine:["总油耗"],yAxisType:["normal"],yAxisName:[" 总油耗(L)"]}},pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},chartHeight:"560px",totalData:{}}},methods:{operate:function(e){this[e]()},export:function(){var e={fleetName:this.$route.query.terminalId?"":this.filters[0].value||"",type:this.filters[1].value||"",summaryMode:"date",dateRange:"".concat(this.filters[2].value[0]||"","-").concat(this.filters[2].value[1]||"")};h["a"].marketingCarsExport(e,(function(e){}),(function(e){}))},filterDataChange:function(e){this.filters=e,this.$route.query.id&&this.refresh(this.$route.query.id)},handleSizeChange:function(e){this.pagination.pageSize=e},handleCurrentChange:function(e){this.pagination.currentPage=e},refresh:function(e){var t=this;if(e||(e=this.$route.query.id),this.filters[2].value[0]>this.today||this.filters[2].value[1]>this.today)return this.$message.warning({message:"不能选择将来的时间",showClose:!0}),void this.getFormatDate();var a={fleetId:this.$route.query.terminalId||e?"":this.filters[0].value,carId:this.$route.query.terminalId?"":e||"",terminalId:this.$route.query.terminalId,type:this.filters[1].value||"",beginTimeStr:this.filters[2].value[0]||"",endTimeStr:this.filters[2].value[1]||""};this.loading=!0,h["a"].queryMarketingCarsData(a,(function(e){t.totalData=e.totalData,t.loading=!1}),(function(e){t.loading=!1}));var i={treeNodeId:this.$route.query.terminalId||e?"":"fleet_".concat(this.filters[0].value),terminalId:this.$route.query.terminalId,fleetCarId:this.$route.query.terminalId?"":e||"",type:this.filters[1].value||"",summaryMode:"date",beginTimeStr:this.filters[2].value[0]||"",endTimeStr:this.filters[2].value[1]||""};this.loading=!0,h["a"].queryMarketingCarsChart(i,(function(e){t.loading=!1,t.tableData=e.statisticsData,t.pagination.total=e.statisticsData.length,t.rangeChartData.data.rows=[],t.oilChartData.data.rows=[],e.statisticsData.map((function(e){t.rangeChartData.data.rows.push({"日期":e.date,"行驶里程":e.totalMilesOriginal,"行驶时长":e.driveTimesOriginal}),t.oilChartData.data.rows.push({"日期":e.date,"总油耗":e.totalOil})}))}),(function(e){t.loading=!1}))},queryCarFleet:function(){var e=this,t={fleetType:"group",pageNumber:"1",pageSize:"200"};h["a"].queryFleetList(t,(function(t){var a=[];t.content.map((function(e){a.push({value:e.id,label:e.name})})),e.$set(e.filters[0],"options",a),e.filters[0].value=e.filters[0].options[0].value}),(function(e){console.log("ERR_GET_FLEET: ",e)}))},getFormatDate:function(){var e=new Date;this.filters[2].value[1]="".concat(e.getFullYear(),"-").concat(e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,"-").concat(e.getDate()<10?"0"+e.getDate():e.getDate()),this.today=this.filters[2].value[1];var t=function(){var e=new Date;return e.setDate(1),"".concat(e.getFullYear(),"-").concat(e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,"-").concat(e.getDate()<10?"0"+e.getDate():e.getDate())};this.filters[2].value[0]=t()}},mounted:function(){if(this.$route.query.id){var e=this.$route.query.id,t=this.$route.query.plateNumber;this.filters[0].label="车牌号",this.filters[0].value=e,this.filters[0].options=[{value:e,label:t}]}if(this.$route.query.terminalId){var a=this.$route.query.terminalId,i=this.$route.query.number;this.filters[0].label="设备序列号",this.filters[0].value=a,this.filters[0].options=[{value:a,label:i}]}else this.queryCarFleet()},created:function(){this.getFormatDate()},computed:{currentTable:function(){return this.tableData.slice((this.pagination.currentPage-1)*this.pagination.pageSize,this.pagination.currentPage*this.pagination.pageSize)}},components:{BizHeader:l["a"],BizTableBody:n["a"],BizChart:s["a"],AnalysisHeader:o["a"],BizGrid:u["a"]}},g=c,d=(a("e626"),a("2877")),p=Object(d["a"])(g,i,r,!1,null,null,null);t["default"]=p.exports},e626:function(e,t,a){"use strict";var i=a("1522"),r=a.n(i);r.a}}]);