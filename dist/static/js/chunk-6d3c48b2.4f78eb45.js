(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d3c48b2"],{"495d":function(t,e,a){},5560:function(t,e,a){"use strict";var i=a("495d"),s=a.n(i);s.a},e02c:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"member-report"},[a("div",{staticClass:"top"},[a("div",{staticClass:"block"},[a("div",{staticClass:"demonstration"},[t._v("月份")]),a("el-date-picker",{attrs:{"value-format":"yyyy-MM",type:"month",placeholder:"选择月",size:"mini","picker-options":t.pickerOptions},on:{change:t.dateChange},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}),a("div",{staticClass:"demonstration"},[t._v("店铺")]),a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:t.shopChange},model:{value:t.checkedShops,callback:function(e){t.checkedShops=e},expression:"checkedShops"}},t._l(t.shopsList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("div",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.printView}},[t._v("打印")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("导出")])],1)]),a("div",{ref:"imageWrapper"},[a("div",{staticClass:"title-header"},[a("span",[t._v(t._s(t.shopName))]),a("span",[t._v("会员卡月报")]),a("span",[t._v("|")]),a("span",[t._v(t._s(t.endDate.split("-")[0]+"年"+t.endDate.split("-")[1]+"月")+"1-"+t._s(t.lastDate)+"日")])]),a("div",{staticClass:"content"},[t._m(0),a("div",{staticClass:"des"},[a("p",[t._v(" 截至"+t._s(t.endDate.split("-")[0]+"年"+t.endDate.split("-")[1]+"月")+"，新增会员卡"+t._s(t.indicators.memberCardInc)+"张。 累计会员卡"+t._s(t.indicators.totalMemberCard)+"张，同比增加"+t._s(t.indicators.memberCardIncYoy)+"%，环比增加"+t._s(t.indicators.memberCardIncMon)+"%。卡内余额"+t._s(t.indicators.totalBalance)+"元； 当月累计会员卡储值金额"+t._s(t.indicators.memberCardDepositInc)+"元，同比增加"+t._s(t.indicators.memberCardDepositIncYoy)+"%，环比增加"+t._s(t.indicators.memberCardDepositIncMon)+"%。 会员卡消费金额"+t._s(t.indicators.memberCardConsumeInc)+"元，同比增加"+t._s(t.indicators.memberCardConsumeIncYoy)+"%，环比增加"+t._s(t.indicators.memberCardConsumeIncMon)+"%。 ")])]),a("div",{staticClass:"chart-area"},[a("div",{staticClass:"graph"},[a("div",{staticClass:"des",attrs:{align:"center"}},[t._v("新增会员卡变化-按月")]),a("biz-chart",{attrs:{chartData:t.chartDataOfInc,loading:t.loading,showSearch:!1}})],1),a("div",{staticClass:"graph"},[a("div",{staticClass:"des",attrs:{align:"center"}},[t._v("会员卡储值金额变化-按月")]),a("biz-chart",{attrs:{chartData:t.chartDataOfIncome,loading:t.loading,showSearch:!1}})],1),a("div",{staticClass:"graph"},[a("div",{staticClass:"des",attrs:{align:"center"}},[t._v("会员卡消费金额变化-按月")]),a("biz-chart",{attrs:{chartData:t.chartDataOfConsume,loading:t.loading,showSearch:!1}})],1)])]),a("div",{staticClass:"content"},[t._m(1),a("div",{staticClass:"des"},[t._l(t.indicators.advise,(function(e,i){return a("p",{directives:[{name:"show",rawName:"v-show",value:t.indicators.advise&&t.indicators.advise.length>0,expression:"indicators.advise && indicators.advise.length > 0"}],key:i},[t._v(" "+t._s(e.join(","))+" ")])})),a("p",{directives:[{name:"show",rawName:"v-show",value:!t.indicators.advise||0===t.indicators.advise.length,expression:"!indicators.advise || indicators.advise.length === 0"}]},[t._v(" 您的店铺当月经营良好，暂无明显需要改善的地方。 ")])],2)])]),a("el-dialog",{attrs:{visible:t.dialogTableVisible,center:"",width:"1200px","append-to-body":""},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("div",{attrs:{align:"right"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.print}},[t._v("打印")])],1),a("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[a("img",{attrs:{src:t.url,width:"100%"}})])],1)],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-header"},[a("span",[t._v("一、会员卡概述")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-header"},[a("span",[t._v("二、结论建议")])])}],n=(a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("1276"),a("5530")),o=a("562e"),r=a("2f62"),c=a("fedf"),d=a("1ab1"),h=a("c466"),l=a("ce0c"),p=a("225d"),m=a("c0e9"),u=a.n(m),g=a("e511"),v=a.n(g),f={name:"CustomerServiceNav",data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},companyCount:0,storeCount:0,unionCount:0,countTotal:0,carData:[],ageData:[],genderData:[],genData:[],marryData:[],incomeData:[],beginDate:l["a"].getMonthStartDate(),endDate:h["a"].nowDate(),addOperator:"",addStore:"",storeList:"",url:"",isIndeterminateShops:!0,dialogTableVisible:!1,loading:!1,checkAllShops:!0,checkedShops:this.getUser().shop.id,shopsList:[],chartData:{},chartDataOfInc:{},chartDataOfConsume:{},chartDataOfIncome:{},topCarX:[],topCarY:[],topCarAmountX:[],topCarAmountY:[],topConsultantX:[],topConsultantY:[],topConsultantAmountX:[],topConsultantAmountY:[],indicators:{advise:[]},imgUrl:"",kpiName:["本期","同比","环比"]}},computed:{shopName:function(){var t=this,e=this.getUser().shop.name;return this.shopsList.map((function(a){t.checkedShops===a.id&&(e=a.name)})),e},lastDate:function(){return h["a"].getMonthDays(this.endDate)}},components:{BizChart:o["a"],vueEasyPrint:p["a"]},created:function(){this.getShopList()},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(r["c"])(["getUser"])),Object(r["d"])("Menu",["updateRoutes"])),Object(r["c"])("Authority",["currentAuth"])),{},{print:function(){this.$refs.easyPrint.print()},dateChange:function(){this.beginDate=this.endDate.split("-")[0]+"-"+this.endDate.split("-")[1]+"-01",this.query()},init:function(){var t=this,e={viewType:"month",beginDate:this.beginDate,endDate:this.endDate.split("-")[0]+"-"+this.endDate.split("-")[1]+"-"+h["a"].getMonthDays(this.endDate),shopIds:[this.checkedShops||this.getUser().shop.id]};d["a"].post("/admin/ecommerce/kpi/summary/memberCard/report.jhtml",e).then((function(e){t.indicators=e.indicators})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},printView:function(){var t=this,e=this;window.pageYOffset=0,document.documentElement.scrollTop=0,document.body.scrollTop=0,setTimeout((function(){u()(t.$refs.imageWrapper).then((function(t){e.url=t.toDataURL(),e.dialogTableVisible=!0}))}),500)},save:function(){var t=this,e=this;window.pageYOffset=0,document.documentElement.scrollTop=0,document.body.scrollTop=0,setTimeout((function(){u()(t.$refs.imageWrapper).then((function(t){var a=t.width,i=t.height,s=a/592.28*841.89,n=i,o=0,r=595.28,c=592.28/a*i,d=t.toDataURL("image/jpeg",1),h=new v.a("","pt","a4");if(n<s)h.addImage(d,"JPEG",0,0,r,c);else while(n>0)h.addImage(d,"JPEG",0,o,r,c),n-=s,o-=841.89,n>0&&h.addPage();h.save("会员卡月报.pdf"),e.loading=!1}))}),500)},link:function(t){this.updateRoutes({routes:c["a"]["".concat(t.split("/")[1])]}),this.$router.push(t)},query:function(){this.getGraphIncData(),this.getGraphConsumeData(),this.getGraphIncomeData(),this.init()},shopChange:function(t){this.query()},getShopList:function(){var t=this,e={sourceType:"5"};d["a"].get("/admin/member/json/findEShops.jhtml",e).then((function(e){t.shopsList=e.shops,t.query()})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},getGraphIncData:function(){var t=this;this.loading=!0;var e={viewType:"month",indicator:"2",type:"0",beginDate:h["a"].halfYearAgo(this.endDate),shopIds:[this.checkedShops||this.getUser().shop.id],endDate:this.endDate.split("-")[0]+"-"+this.endDate.split("-")[1]+"-"+h["a"].getMonthDays(this.endDate)};d["a"].post("/admin/ecommerce/kpi/memberCard/graph.jhtml",e).then((function(e){t.chartDataOfInc=t.dataFormat(e)})).catch((function(e){t.loading=!1,e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))},getGraphConsumeData:function(){var t=this;this.loading=!0;var e={viewType:"month",indicator:"0",type:"3",beginDate:h["a"].halfYearAgo(this.endDate),shopIds:[this.checkedShops||this.getUser().shop.id],endDate:this.endDate.split("-")[0]+"-"+this.endDate.split("-")[1]+"-"+h["a"].getMonthDays(this.endDate)};d["a"].post("/admin/ecommerce/kpi/memberCard/graph.jhtml",e).then((function(e){t.chartDataOfConsume=t.dataFormat(e)})).catch((function(e){t.loading=!1,e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))},getGraphIncomeData:function(){var t=this;this.loading=!0;var e={viewType:"month",indicator:"1",type:"3",beginDate:h["a"].halfYearAgo(this.endDate),shopIds:[this.checkedShops||this.getUser().shop.id],endDate:this.endDate.split("-")[0]+"-"+this.endDate.split("-")[1]+"-"+h["a"].getMonthDays(this.endDate)};d["a"].post("/admin/ecommerce/kpi/memberCard/graph.jhtml",e).then((function(e){t.chartDataOfIncome=t.dataFormat(e)})).catch((function(e){t.loading=!1,e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))},dataFormat:function(t){for(var e=[],a=0;a<t.indicators.length;a++)e.push({"日期":t.indicators[a].xValue,"本期":t.indicators[a].yValue,"同比":t.indicators[a].yoyRate,"环比":t.indicators[a].momRate});var i={type:"histogram",data:{columns:["日期",this.kpiName[0],this.kpiName[1],this.kpiName[2]],rows:e},settings:{axisSite:{right:["同比","环比"]},yAxisType:["KMB","KMB"],yAxisName:["","%"],showLine:[this.kpiName[1],this.kpiName[2]]}};return i}}),mounted:function(){}},D=f,b=(a("5560"),a("2877")),C=Object(b["a"])(D,i,s,!1,null,null,null);e["default"]=C.exports}}]);