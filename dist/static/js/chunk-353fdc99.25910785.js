(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-353fdc99","chunk-6e4c4195"],{"007c":function(e,t,i){"use strict";var r=i("f1b1"),a=i.n(r);a.a},"0130":function(e,t,i){"use strict";var r=i("6ecb"),a=i.n(r);a.a},"0630":function(e,t,i){"use strict";var r=i("6bd2"),a=i.n(r);a.a},"06c20":function(e,t,i){"use strict";var r=i("6c02"),a=i.n(r);a.a},"0943":function(e,t,i){"use strict";var r=i("1fac"),a=i.n(r);a.a},"0a05":function(e,t,i){},"0e5e":function(e,t,i){"use strict";var r=i("2497"),a=i("bc3a"),s=i.n(a),o=i("c596");t["a"]={query:function(e,t,i){s.a.get(o["g"].vehicleMgmt.VehicleBaseInfo_query,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryShopList:function(e,t,i){s.a.get(o["g"].vehicleMgmt.Component_queryShops,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryBrandList:function(e,t,i){s.a.get(o["g"].vehicleMgmt.Component_queryBrands,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},querySeriesList:function(e,t,i){s.a.get(o["g"].vehicleMgmt.Component_querySeries,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryTypeList:function(e,t,i){s.a.get(o["g"].vehicleMgmt.Component_queryTypes,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryDimList:function(e,t,i){s.a.get(o["g"].vehicleMgmt.VehicleBaseInfo_queryDimList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryInsuranceList:function(e,t,i){s.a.get(o["g"].vehicleMgmt.VehicleBaseInfo_queryInsuranceList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryTerminalList:function(e,t,i){s.a.get(o["g"].vehicleMgmt.VehicleBaseInfo_queryTerminalList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryTerminalInfo:function(e,t,i){s.a.get(o["g"].vehicleMgmt.VehicleBaseInfo_queryTerminalInfo,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},update:function(e,t,i){s.a.post(o["g"].vehicleMgmt.VehicleBaseInfo_update,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},add:function(e,t,i){s.a.post(o["g"].vehicleMgmt.VehicleBaseInfo_add,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))}}},"0f32":function(e,t,i){"use strict";var r=i("75e2"),a=i.n(r);a.a},1029:function(e,t,i){"use strict";var r=i("f9a5"),a=i.n(r);a.a},1148:function(e,t,i){"use strict";var r=i("a691"),a=i("1d80");e.exports="".repeat||function(e){var t=String(a(this)),i="",s=r(e);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(i+=t);return i}},1756:function(e,t,i){"use strict";var r=i("9ba3"),a=i.n(r);a.a},"18eb":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-tag-select"},[i("div",{staticClass:"tag-content"},[i("div",{staticClass:"tag-show-eara"},e._l(e.curSelectedTags,(function(t,r){return i("el-tag",{key:r,staticClass:"sel-tag",attrs:{closable:""},on:{close:function(i){return e.onClose(t,r)}}},[e._v(" "+e._s(t.name?t.name:t)+" ")])})),1),i("div",{staticClass:"select-area"},[i("div",{staticClass:"search-container"},[e.bAddTag?i("el-input",{attrs:{placeholder:"请输入关键词，按回车添加新标签"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.tagName,callback:function(t){e.tagName=t},expression:"tagName"}}):e._e()],1),e.tagList.length?i("div",{staticClass:"tag-container"},[i("el-checkbox-group",{attrs:{size:"small"},on:{change:e.onChange},model:{value:e.curSelectedTags,callback:function(t){e.curSelectedTags=t},expression:"curSelectedTags"}},e._l(e.curShowTags,(function(t,r){return i("el-checkbox-button",{key:r,staticClass:"tag-column",attrs:{label:t.name}},[e._v(e._s(t.name)+" ")])})),1),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showMore,expression:"showMore"}],staticClass:"more-btn",attrs:{small:"",type:"primary"},on:{click:e.onMore}},[e._v("更多...")])],1):i("div",{staticClass:"empty"},[e._v("暂无标签数据")])])])])},a=[],s=(i("4160"),i("d81d"),i("a434"),i("b0c0"),i("ac1f"),i("5319"),i("159b"),i("1ab1")),o=i("c596"),n={name:"biz-tag-select",data:function(){return{curSelectedTags:[],tagName:"",tagCatrgoryId:"",showMore:!1,curShowTags:[]}},props:{tagList:{type:Array},selectedTags:{type:Array},bAddTag:{type:Boolean,default:!0},selectType:{type:String},categoryType:{type:String,default:function(){return""}}},components:{},computed:{},watch:{selectedTags:function(e){this.curSelectedTags=e.map((function(e){return e.name?e.name:e}))},tagList:function(e){var t=this;e&&e.length&&(this.curShowTags.splice(0,this.curShowTags.length),this.tagCatrgoryId=e[0].tagCategory.id,this.showMore=e.length>6,e.forEach((function(e,i){i<6&&t.curShowTags.push(e)})))}},methods:{getCurSelectedTags:function(e){var t,i,r=this;return t=[],this.curSelectedTags.forEach((function(e){r.tagList.forEach((function(r){r.name===e&&(i={},i.id=r.id,i.name=r.name,t.push(i))}))})),t},onChange:function(e){"order"===this.selectType&&this.curSelectedTags.length>1&&(this.curSelectedTags.pop(),this.$message.warning("您已选择标签，如需要变更请先删除之前的选择")),this.$emit("change",e)},onClose:function(e,t){console.log(e),this.curSelectedTags.splice(t,1)},handleInputConfirm:function(){this.tagName=this.tagName.replace(/\s+/g,""),this.tagName&&(this.tagCatrgoryId?this.addTag():"店铺特色"===this.categoryType&&this.getTagCatrgoryId())},getTagCatrgoryId:function(){var e=this,t={categoryType:"店铺特色",isIncludeParent:"1"};s["a"].get(o["g"].systemSetting.storeTagcategories,t).then((function(t){t.content.length&&(e.tagCatrgoryId=t.content[0].id,e.addTag())})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},addTag:function(){var e=this,t={name:this.tagName,hierarchy:"1",tagCategory:{id:this.tagCatrgoryId}};s["a"].post(o["g"].systemSetting.deleteTag,t).then((function(t){e.$emit("addSuccess"),console.log(e.curSelectedTags),e.tagName=""})).catch((function(t){e.$message.warning(t.errorMessage),console.log(t.errorMessage)}))},onMore:function(){"shopProfile"===this.selectType?this.$emit("showMore"):(this.showMore=!1,this.curShowTags=this.tagList)}}},l=n,c=(i("663e"),i("2877")),d=Object(c["a"])(l,r,a,!1,null,null,null),p=d.exports;t["a"]=p},1910:function(e,t,i){},"1bdb":function(e,t,i){},"1fac":function(e,t,i){},2086:function(e,t,i){"use strict";var r=i("2497"),a=i("bc3a"),s=i.n(a),o=i("c596");t["a"]={getList:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.getMemberCardList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getRightsList:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.getList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},listDistributeRights:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.listDistributeRights,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},listCardTemplate:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.listCardTemplate,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getlistVbean:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.getlistVbean,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getIntegralList:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.getIntegralList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},listProduct:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.listProduct,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryUserRights:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.queryUserRights,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryUserCoupons:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.queryUserCoupons,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},listByRights:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.listByRights,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getVipCardInfo:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.getVipCardInfo,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getVipCardTemplate:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.getVipCardTemplate,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},memberRankList:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.memberRankList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},setting:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.setting,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},settingUpdate:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.setting,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryPeople:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.queryPeople,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},delete:function(e,t,i){s.a.delete(o["g"].memberCardMgmt.memberCard.deleteManage,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},verification:function(e,t,i){s.a.post(o["g"].memberCardMgmt.vipRights.verification,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},updateTemplate:function(e,t,i){s.a.put(o["g"].memberCardMgmt.memberCard.updateTemplate,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},createTemplate:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.updateTemplate,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},delTemplate:function(e,t,i){s.a.delete(o["g"].memberCardMgmt.memberCard.updateTemplate,{data:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},distributeRights:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.distributeRights,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},distributeAssignedRights:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.distributeAssignedRights,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},updateVipCardState:function(e,t,i){s.a.put(o["g"].memberCardMgmt.memberCard.updateVipCardState,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},createVipCard:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.createVipCard,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},createBean:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.createBean,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},createPoint:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.createPoint,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},addScore:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.addScore,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},reduceDeposit:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.reduceDeposit,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getlistUpgrade:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.getlistUpgrade,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getlistStore:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.getlistStore,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},updateGrade:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.updateGrade,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getVipCardGradeInfo:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.getVipCardGradeInfo,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},editVipCardGrade:function(e,t,i){s.a.put(o["g"].memberCardMgmt.memberCard.VipCardGrade,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},addVipCardGrade:function(e,t,i){s.a.post(o["g"].memberCardMgmt.memberCard.VipCardGrade,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},delVipCardGrade:function(e,t,i){s.a.delete(o["g"].memberCardMgmt.memberCard.VipCardGrade,{data:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},listAuthority:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.listAuthority,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},vipRightsList:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.getList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryrightsClass:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.get,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getFirstClassifies:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.getFirstClassifies,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},rightsCouponList:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.rightsCouponList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryRightsCoupon:function(e,t,i){s.a.get(o["g"].memberCardMgmt.vipRights.queryRightsCoupon,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},memberCardBox:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.memberCardBox,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},editRightsClass:function(e,t,i){s.a.put(o["g"].memberCardMgmt.vipRights.edit,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},createRightsClass:function(e,t,i){s.a.post(o["g"].memberCardMgmt.vipRights.add,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},rightsCouponUpdate:function(e,t,i){s.a.put(o["g"].memberCardMgmt.vipRights.rightsCouponUpdate,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},rightsCouponCreate:function(e,t,i){s.a.post(o["g"].memberCardMgmt.vipRights.rightsCouponCreate,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},deleteRightscoupon:function(e,t,i){s.a.delete(o["g"].memberCardMgmt.vipRights.deleteRightscoupon,{data:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},deleteRights:function(e,t,i){s.a.delete(o["g"].memberCardMgmt.vipRights.delete,{data:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},certificate:function(e,t,i){s.a.get(o["g"].memberCardMgmt.memberCard.certificate,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))}}},"225d":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.tableShow,expression:"tableShow"}],ref:"template"},[e._t("default",[i("span",[e._v("编写你自己的打印区域组件，然后slot插入到vue-easy-print")])],{getChineseNumber:e.getChineseNumber})],2),e.buttonShow?i("button",{class:e.buttonClass,attrs:{type:"button"},on:{click:e.print}},[i("span",[e._v("开始打印")])]):e._e()])},a=[],s=(i("a9e3"),i("d3b7"),i("ac1f"),i("25f0"),i("466d"),i("5319"),i("1276"),{name:"vue-easy-print",components:{},props:{spaceRow:{type:Boolean,default:!1},tableData:{type:Object,default:function(){}},tableShow:{type:Boolean,default:!1},buttonShow:{type:Boolean,default:!1},buttonClass:{type:String,default:"el-button el-button--default"},onePageRow:{type:Number,default:5},beforeCopy:Function,beforePrint:Function},data:function(){return{}},mounted:function(){this.init()},methods:{init:function(){var e=this,t=document.getElementById("easyPrintIframe");t?this.getStyle():(t=document.createElement("iframe"),t.id="easyPrintIframe",t.style.position="fixed",t.style.width="0",t.style.height="0",t.style.top="-100px",window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)&&(t.src='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";<\/script></head><body></body>")'),t.onload=function(){e.getStyle()},document.body.appendChild(t))},print:function(){"function"===typeof this.beforeCopy&&this.beforeCopy();var e=document.getElementById("easyPrintIframe");e.contentDocument.body.innerHTML=this.$refs.template.innerHTML,"function"===typeof this.beforePrint&&this.beforePrint(),setTimeout((function(){e.contentWindow.print()}),100)},getStyle:function(){for(var e=document.getElementById("easyPrintIframe"),t="",i=document.querySelectorAll("style"),r=0;r<i.length;r++)t+=i[r].outerHTML;e.contentDocument.head.innerHTML=t;for(var a=document.querySelectorAll("link"),s=0;s<a.length;s++){var o=document.createElement("link");o.setAttribute("rel","stylesheet"),a[s].type?o.setAttribute("type",a[s].type):o.setAttribute("type","text/css"),o.setAttribute("href",a[s].href),o.setAttribute("media","all"),e.contentDocument.head.appendChild(o)}},getChineseNumber:function(e){var t,i,r,a,s,o,n,l,c,d,p,u,m,f,h=99999999999.99,g="零",v="壹",b="贰",y="叁",I="肆",_="伍",w="陆",C="柒",M="捌",S="玖",k="拾",T="佰",x="仟",O="万",D="亿",$="",L="元",R="角",P="分",N="整";if(void 0===e)return"";if(e=e.toString(),""==e)return"";if(null!=e.match(/[^,.\d]/))return"";if(null==e.match(/^((\d{1,3}(,\d{3})*(.((\d{3},)*\d{1,3}))?)|(\d+(.\d+)?))$/))return"";if(e=e.replace(/,/g,""),e=e.replace(/^0+/,""),Number(e)>h)return alert("您输入的金额太大，请重新输入!"),"";if(a=e.split("."),a.length>1?(t=a[0],i=a[1],i=i.substr(0,2)):(t=a[0],i=""),s=new Array(g,v,b,y,I,_,w,C,M,S),o=new Array("",k,T,x),n=new Array("",O,D),l=new Array(R,P),r="",Number(t)>0){for(c=0,d=0;d<t.length;d++)p=t.length-d-1,u=t.substr(d,1),m=p/4,f=p%4,"0"==u?c++:(c>0&&(r+=s[0]),c=0,r+=s[Number(u)]+o[f]),0==f&&c<4&&(r+=n[m]);r+=L}if(""!=i)for(d=0;d<i.length;d++)u=i.substr(d,1),"0"!=u&&(r+=s[Number(u)]+l[d]);return""==r&&(r=g+L),""==i&&(r+=N),r=$+r,r}}}),o=s,n=i("2877"),l=Object(n["a"])(o,r,a,!1,null,null,null),c=l.exports;t["a"]=c},2497:function(e,t,i){"use strict";var r=i("4360"),a=i("a18c");t["a"]=function(e,t){return function(i){var s=i.data;"100"===s.resultCode?e(s):"709"===s.resultCode?(r["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",r["a"].getters.currentUser),a["a"].push("/login")):t(s)}}},2518:function(e,t,i){},"276c":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-info"},[i("div",{staticClass:"order-info-div"},[i("div",{staticClass:"order-info-content"},[i("div",{staticClass:"order-top-content"},[i("div",{staticClass:"order-follow-up",on:{click:function(t){return e.onOrderTrack(e.orderInfo.id)}}},[i("span",[e._v("订单跟踪")]),i("div",{staticClass:"order-state"},[i("span",[e._v(e._s(e.getOrderPaymentState))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]),e.orderInfo.consignee?i("div",{staticClass:"receiver-info"},[i("span",[e._v(e._s(e.orderInfo.consignee))]),i("span",[e._v(e._s(e.orderInfo.phone))]),i("p",[i("i",{staticClass:"el-icon-location-outline",staticStyle:{"margin-right":"5px"}}),e._v(" "+e._s(e.orderInfo.areaName?e.orderInfo.areaName+e.orderInfo.address:e.orderInfo.address)+" ")])]):e._e(),e.orderInfo.appointmentEndDate?i("div",{staticClass:"order-num"},[i("span",[e._v("到店时间：")]),i("span",[e._v(e._s(e.orderInfo.appointmentDate)+"-"+e._s(e.orderInfo.appointmentEndDate.slice(11,20)))])]):e._e(),"6"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("心仪车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("已有车型")]),i("span",[e._v(e._s(e.orderInfo?e.orderInfo.orderItems[0].appointment.car.type:""))])])]):e._e(),"7"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("心仪车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("裸车价格")]),i("span",[e._v("￥"+e._s(e.orderInfo.orderItems[0].appointment.product.price))])]),i("div",{staticClass:"buy-car-detail"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("首付"+e._s(e.getDownPayment))]),i("span",[e._v("￥"+e._s(e.getInitPay))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("月供")]),i("span",[e._v("￥"+e._s(e.getMonthPaidNum))])])]):e._e(),"8"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("试驾车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("预约时间")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.appontmentDate.slice(0,10):""))])])]):e._e(),e.orderInfo.invoiceTitle?i("div",{staticClass:"order-follow-up",on:{click:e.selectInvoice}},[i("span",[e._v("发票抬头")]),i("div",{staticClass:"order-state",staticStyle:{color:"#808080"}},[i("span",[e._v(e._s(e.orderInfo.invoiceTitle?e.orderInfo.invoiceTitle:"无"))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]):e._e()]),i("div",{staticClass:"order-info-new"},[i("div",{staticClass:"shop-name",on:{click:e.goShop}},[i("img",{attrs:{src:e.iconShop}}),i("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(e.orderInfo.shop?e.orderInfo.shop.name:""))])]),e._l(e.orderInfo.orderItems,(function(t,r){return i("div",{key:r},[i("div",{staticClass:"good-info",on:{click:function(i){return e.onClickProduct(t)}}},[i("div",{staticClass:"goods-img"},[i("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:t.thumbnail&&t.thumbnail.indexOf("/")>=0?t.thumbnail:e.defaultImg},on:{error:function(t){return e.imgError(r)}}})]),i("div",{staticClass:"good-right"},[i("div",{staticClass:"good-name"},[i("span",{staticStyle:{flex:"1"}},[e._v(e._s(t.fullName))]),e.showRefund[r]&&!e.isRalateBill?i("div",{staticClass:"btn-group-div"},[i("div",{staticClass:"btn-group"},[e.showRefund[r]&&e.hasAuthEdit?i("span",{staticClass:"btn-good-pay",on:{click:function(i){return i.stopPropagation(),e.onRefund(t)}}},[e._v(e._s(e.refundsLabel[r]))]):e._e()])]):e._e()]),i("div",{staticStyle:{"margin-bottom":"10px"}},[t.product.barCode?i("span",{staticStyle:{"font-size":"14px","margin-right":"10px"}},[e._v(e._s(t.product.barCode))]):e._e()]),i("div",{staticClass:"good-price"},[i("span",[e._v("￥"+e._s(t.price))]),i("span",[e._v("X"+e._s(t.quantity))])])])])])})),"1"!==e.orderInfo.isSubscription||e.activity.activityId?e._e():i("div",{staticClass:"subscription"},[i("p",[e._v(" 阶段1：订金￥"+e._s(e.orderInfo.amountPrepay)+" "),i("span",{class:{tips:parseFloat(e.orderInfo.amountPaid)<=0}},[e._v(e._s(parseFloat(e.orderInfo.amountPaid)>0?"已支付":"未支付"))])]),i("p",[e._v(" 阶段2：尾款￥"+e._s(e.orderInfo.amountFinalpay)+" "),i("span",{class:{tips:0!==parseFloat(e.orderInfo.amountPayable)}},[e._v(e._s(0===parseFloat(e.orderInfo.amountPayable)?"已支付":"未支付"))])])])],2),i("div",{staticClass:"price-info-content"},[i("div",{staticClass:"total-price"},[i("span",[e._v("产品总额")]),i("span",[e._v("￥"+e._s(e.getAmount))])]),i("div",{staticClass:"total-price"},[i("span",[e._v("邮费")]),i("span",[e._v("+ ￥"+e._s(e.orderInfo.freight))])]),parseFloat(e.orderInfo.couponDiscount)>0?i("div",{staticClass:"total-price"},[i("span",[e._v("优惠")]),i("span",[e._v("- ￥"+e._s(e.orderInfo.couponDiscount))])]):e._e(),parseFloat(e.getOffsetAmount)>0?i("div",{staticClass:"total-price"},[i("span",[e._v("商家调整")]),i("span",[e._v(e._s(e.getOffsetAmount))])]):e._e(),"1"===e.orderInfo.type?i("div",{staticClass:"total-price"},[i("span",[e._v("需付款")]),i("span",{staticClass:"color"},[e._v("￥"+e._s(e.orderInfo.amountPayable))])]):i("div",{staticClass:"total-price"},[i("span",[e._v("已付款")]),i("span",{staticClass:"color"},[e._v("￥"+e._s(e.orderInfo.amountPaid))])])]),i("div",{staticClass:"pay-type"},[i("span",[e._v("订单编号："+e._s(e.orderInfo.sn))]),e.orderInfo.paymentMethodName?i("span",[e._v("支付方式："+e._s(e.orderInfo.paymentMethodName))]):e._e(),e.orderInfo.shippingMethodName?i("span",[e._v("配送方式："+e._s(e.orderInfo.shippingMethodName))]):e._e(),e.orderInfo.memo?i("div",{staticClass:"message"},[i("span",{staticClass:"label"},[e._v("买家留言：")]),i("span",{staticClass:"buy-message",staticStyle:{"margin-left":"-3px"}},[e._v(e._s(e.orderInfo.memo))])]):e._e(),i("span",[e._v("下单时间："+e._s(e.orderInfo.orderTime))]),e.orderInfo.payments&&e.orderInfo.payments.length?i("span",[e._v("付款时间："+e._s(e.orderInfo.payments[0].paymentDate))]):e._e(),e.orderInfo.deliverDate?i("span",[e._v("预计到货时间："+e._s(e.orderInfo.deliverDate))]):e._e()])]),i("div",{staticClass:"order-bottom"})]),e.hasAuthEdit?i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},[e.showLogistics?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onLookLogistics(e.orderInfo.shippings?e.orderInfo.shippings[0].sn:"")}}},[e._v("物流跟踪")]):e._e(),("4"===e.orderInfo.state&&"0"===e.orderInfo.shippingWay||"3"===e.orderInfo.state&&"1"===e.orderInfo.shippingWay)&&"0"===e.orderInfo.hasSyncOrder?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.confirmOrder(e.orderInfo)}}},[e._v("确认收货")]):e._e(),"0"===this.hasSyncOrder&&"5"===e.orderInfo.state?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onReview(e.orderInfo.id,e.orderInfo.state)}}},[e._v("立即评价")]):e._e(),e.showLookEvaluate?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onLookEvaluate(e.orderInfo.id,e.orderInfo.state)}}},[e._v("查看评价")]):e._e()],1):e._e(),e.isPend?i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},["1"===e.orderInfo.state&&("1"===e.orderInfo.auditState&&"1"===e.orderInfo.audit||"2"===e.orderInfo.auditState&&"1"===e.orderInfo.audit)?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.toPass(e.orderInfo)}}},[e._v("审核")]):e._e()],1):e._e(),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(t){e.showPassOrder=t}}},[i("div",[i("div",{staticClass:"reson-container"},[i("span",[e._v("审核结果：")]),i("el-radio",{attrs:{label:"1",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("通过")]),i("el-radio",{attrs:{label:"2",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("驳回")]),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[i("span",[e._v("驳回理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:e.curSelectAjectReason,callback:function(t){e.curSelectAjectReason=t},expression:"curSelectAjectReason"}},e._l(e.reasonAjectList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showPassOrder=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange(e.row,e.auditState)}}},[e._v("确定")])],1)]),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("my-invoice",{ref:"invoice"})],1),i("el-dialog",{attrs:{visible:e.dialogVisiableLog,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableLog=t}}},[i("order-track",{ref:"track"})],1),i("el-dialog",{attrs:{visible:e.dialogApplaySale,title:"售后",center:"","append-to-body":""},on:{"update:visible":function(t){e.dialogApplaySale=t}}},[i("apply-sale",{ref:"applySale",attrs:{itemId:e.orderItemId,isEditable:e.isEditable},on:{operationSuccess:e.operationSuccess}})],1),i("el-dialog",{attrs:{visible:e.dialogApplayRefundInfo,"append-to-body":""},on:{"update:visible":function(t){e.dialogApplayRefundInfo=t}}},[i("refund-info",{ref:"refundInfo",attrs:{itemId:e.itemId,dialogApplayRefundInfo:e.dialogApplayRefundInfo},on:{operationSuccess:e.operationSuccess,applySaleHanlder:e.applySaleHanlder}})],1)],1)},a=[],s=(i("caad"),i("a9e3"),i("b680"),i("d3b7"),i("ac1f"),i("2532"),i("5319"),i("5530")),o=i("f36f"),n=i("2f62"),l=i("1ab1"),c=i("c596"),d=i("e83a"),p=i.n(d),u=i("517a"),m=i.n(u),f=i("f606"),h=i.n(f),g=i("a57d"),v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-track"},[i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v("待商家确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v("商家已确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"AuditPassed"===t.type?i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v("审核者："+e._s(t.operator))]),i("p",[e._v(e._s(t.createTime))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.payments.length>0?i("div",[i("p",[e._v("支付方式："+e._s(e.paymentMethod))]),i("p",[e._v("付款方式："+e._s(e.paymentType))]),e._l(e.payments,(function(t){return i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v(e._s("0"===t.paymentStatus?"未支付":"1"===t.paymentStatus?"部分支付":"已支付"))]),i("p",[e._v(e._s(t.paymentDate))]),i("p",[e._v("付款金额：￥"+e._s(t.amount))]),i("p",[e._v("交易号："+e._s(t.sn))])])}))],2):e._e()])]),i("el-step",{attrs:{title:"执行",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,r){return i("div",{key:r},["6"===t.state?i("div",[i("p",[e._v("自动派单")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason))])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("自动派单")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v(" 用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile)+" ")]):e._e(),t.dispatchRecord?i("div",[e._v(e._s(t.dispatchRecord.createDate))]):e._e(),t.refuseRecord?i("div",[e._v(e._s(t.refuseRecord.reason))]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v(" 拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks))]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已出发")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已到达")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"3"===t.state?i("div",[i("p",[e._v("完成救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"4"===t.state?i("div",[i("p",[e._v("取消救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已执行")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.shippings,(function(t){return e.shippings&&e.shippings.length>0?i("div",{key:t.id},["1"===t.shippingStatus?i("p",[e._v("订单已部分发货")]):e._e(),"1"!==t.shippingStatus?i("p",[e._v("订单已执行")]):e._e(),i("p",[e._v(e._s(t.shippingDate))]),i("p",[e._v("物流公司："+e._s(t.logistics))]),i("p",[e._v("物流单号："+e._s(t.expressSn))]),i("p",[e._v(" 收货人："+e._s(t.consignee)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(i){return e.certificate(t.id)}}},[e._v("凭证")])],1),e._l(t.shippingItems,(function(t,r){return i("p",{key:r},[e._v(e._s(t.name)+"*"+e._s(t.quantity))])})),e.devProcessShippings&&e.devProcessShippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.devProcessShippings.shippingTraces,(function(t,r){return i("div",{key:r,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.devProcessShippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()],2):e._e()}))],2)]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v("交易完成")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已评价")]),e._l(e.reviews,(function(t,r){return i("div",{key:r},["0"===t.reviewType?i("div",[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("商品："+e._s(t.product.name))]),i("p",[e._v("评分："+e._s(t.score)+"分")]),i("p",[e._v("评语："+e._s(t.content))]),e._l(t.images,(function(t,r){return i("div",{key:r,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v("店铺评分")]),i("p",[e._v("服务态度："+e._s(t.serviceAttitude)+"分")]),i("p",[e._v("服务速度："+e._s(t.serviceSpeed)+"分")]),i("p",[e._v("专业技能："+e._s(t.professional)+"分")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已关闭")]),i("p",[e._v("关闭理由："+e._s(t.content))]),i("p",[e._v("备注："+e._s(t.memo))]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]):e._e()],1),i("el-dialog",{attrs:{title:"",visible:e.outerVisible,"append-to-body":""},on:{"update:visible":function(t){e.outerVisible=t}}},[i("img",{attrs:{src:e.larImg,width:"100%"}})]),i("el-dialog",{attrs:{visible:e.dialogShipping,center:"",width:"1200px","append-to-body":"","custom-class":"printDialog"},on:{"update:visible":function(t){e.dialogShipping=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单状态："+e._s("1"===e.shippingsPrint.shippingStatus?"订单已部分发货":"订单已执行"))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v(" 发货时间："+e._s(e.shippingsPrint.shippingDate?e.shippingsPrint.shippingDate.split(" ")[0]:""))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.shippingsPrint.logistics))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shippingsPrint.expressSn))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流费用："+e._s(e.shippingsPrint.freight))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingsPrint.consignee))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingsPrint.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货地址："+e._s(e.shippingsPrint.address))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1)],1)},b=[],y=(i("4160"),i("b0c0"),i("3ca3"),i("466d"),i("1276"),i("159b"),i("ddb0"),i("2b3d"),i("96cf"),i("1da1")),I=i("225d"),_=i("e42c"),w=i("f260"),C=i.n(w),M=i("bc3a"),S=i.n(M),k={name:"order-track",data:function(){return{orderItems:[],loading:!1,open:!1,outerVisible:!1,active:"",larImg:"",orderLogs:[],reviews:[],shippings:[],payments:[],dialogShipping:!1,form:{},title:"",gridData:[],shippingsPrint:"",devProcessShippings:"",memberRescueStates:[],paymentMethodNameReal:"",type:"",amount:"",amountpaid:"",paymentType:"",paymentMethod:"",shippingId:"",latestMemberRescueState:"",workers:[],sn:"",consignee:"",fee:"",operator:"",trackingNo:"",deliveryCorp:"",orderId:"",workerId:"",dispathButton:!1,redispathButton:!1,cbp_tmlabel:!1,imgStyle:"",imageValue:"",currentState:"",preState:"",create:!1,cancel:!1,confirm:!1,service:!1,shipping:!1,payment:!1,complete:!1,review:!1,isCreate:!1,isConfirm:!1,isService:!1,isPayment:!1,isComplete:!1,isReview:!1,isCancel:!1}},props:{},components:{vueEasyPrint:I["a"],BizGrid:o["a"]},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo"])),{},{styleObject:function(){return{height:"200px",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+C.a+") 50% 50% / 200px no-repeat"}}}),watch:{},methods:Object(s["a"])(Object(s["a"])({},Object(n["d"])("Order",["updateLucidLogs"])),{},{print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var i,r,a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={shippingId:e.shippingId},t.prev=1,t.next=4,S.a.post("/admin/purchaseOrder/voucher/export/shipping.jhtml",i,{responseType:"blob"});case 4:return r=t.sent,console.log("response => ",r),a=new Blob([r.data],{type:"application/vnd.ms-excel"}),s=decodeURI(r.headers["content-disposition"].split("filename=")[1]),o=document.createElement("a"),o.download=s.match(/"(\S*)"/)[1],o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1,a=t.getDate(),s=i+"-"+(r<10?"0"+r:r)+"-"+(a<10?"0"+a:a);return s},certificate:function(e){var t=this,i={shippingId:e};l["a"].get("/admin/purchaseOrder/voucher/shipping.jhtml",i).then((function(i){t.dialogShipping=!0,t.title=t.getUser.shop?t.getUser.shop.name+"发货单":"发货单",t.form=i.order,t.shippingId=e,t.shippingsPrint=i.shipping,t.gridData=i.shipping.shippingItems})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},devProcess:function(){"新悦物流"===this.deliveryCorp&&this.$emit("logistics",this.orderItems.length>0&&this.orderItems[0].product&&this.orderItems[0].product.vins.length>0?this.orderItems[0].product.vins[0].number:""),"block"===this.$refs.devProcess[0].style.display?this.$refs.devProcess[0].style.display="none":this.$refs.devProcess[0].style.display="block"},enlarge:function(e){this.larImg=e,this.outerVisible=!0},getLogs:function(e){var t=this,i={clientType:"2",methodName:"QueryOrderLog",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:e};l["a"].get("/admin/purchaseOrder/orderLogs.jhtml",i).then((function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.payments=e.payments,e.payments&&e.payments.length>1?t.amountpaid=Number(e.payments[0].amount)+Number(e.payments[1].amount):t.amountpaid="",t.orderItems=e.shippings&&e.shippings.length>0&&e.shippings[0].shippingItems,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,t.shippings=e.shippings,t.devProcessShippings=e.shippings&&e.shippings.length>0&&e.shippings[0],e.payments&&(t.paymentType=e.payments.length>0?e.payments[0].paymentType:"",t.paymentMethod=e.payments.length>0?e.payments[0].paymentMethod:"",t.amount=e.payments.length>0?e.payments[0].amount:"",t.fee=e.payments.length>0?e.payments[0].fee:"",t.sn=e.payments.length>0?e.payments[0].sn:""),e.shippings&&(t.deliveryCorp=e.shippings.length>0?e.shippings[0].logistics:"",t.trackingNo=e.shippings.length>0?e.shippings[0].expressSn:"",t.operator=e.shippings.length>0?e.shippings[0].consignee:""),t.consignee=e.order.consignee||"",t.currentState=e.orderLogs[e.orderLogs.length-1].type,e.orderLogs.length>1&&(t.preState=e.orderLogs[e.orderLogs.length-2].type),"create"===t.currentState||"confirm"===t.currentState?t.active="1":"service"===t.currentState||"shipping"===t.currentState?t.active="3":"payment"===t.currentState?t.active="2":"complete"===t.currentState?t.active="4":"review"===t.currentState?t.active="5":"cancel"===t.currentState&&(t.active="6"),!t.latestMemberRescueState||"0"!==t.latestMemberRescueState.state&&"1"!==t.dispathType?(t.dispathButton=!0,t.cbp_tmlabel=!1):(t.dispathButton=!1,t.cbp_tmlabel=!0),t.latestMemberRescueState&&"3"!==t.latestMemberRescueState.state&&"8"!==t.latestMemberRescueState.state&&"9"!==t.latestMemberRescueState.state&&"4"!==t.latestMemberRescueState.state&&"0"!==t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0,t.isCreate=!1,t.isPayment=!1,t.isComplete=!1,t.isReview=!1,t.isCancel=!1,t.isService=!1,e.orderLogs.forEach((function(e){"create"===e.type&&(t.isCreate=!0),"payment"===e.type&&(t.isPayment=!0),"complete"===e.type&&(t.isComplete=!0),"review"===e.type&&(t.isReview=!0),"cancel"===e.type&&(t.isCancel=!0),"service"===e.type&&(t.isService=!0),"shipping"===e.type&&(t.isService=!0),"confirm"===e.type&&(t.isService=!0)})),t.serviceLogs=e.serviceLogs||[],t.updateLucidLogs(t.serviceLogs)})).catch((function(e){console.log("ERR: ",e)})).finally((function(){}))},dispath:function(e){var t=this;this.id=this.itemId||"",_["a"].rescuerDispath({orderId:this.id,workerId:this.workerId},(function(e){_["a"].rescueOrderLogs({orderId:t.id,dispathType:"0"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,"0"===t.latestMemberRescueState.state||"7"===t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))}),(function(e){console.log(e)}))},rdispath:function(e){var t=this;this.id=this.itemId||"",_["a"].rescueOrderLogs({orderId:this.id,dispathType:"1"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,t.cbp_tmlabel=!0}),(function(e){console.log(e)}))}}),created:function(){this.getLogs()}},T=k,x=(i("d438"),i("2877")),O=Object(x["a"])(T,v,b,!1,null,null,null),D=O.exports,$=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"apply-sale-content"},[i("div",{staticClass:"input-area"},[i("el-form",{attrs:{size:"small","label-width":"120px","inline-message":!0}},[i("el-form-item",{attrs:{label:"售后类型："}},[i("el-select",{on:{change:e.inputHandle},model:{value:e.typeStr,callback:function(t){e.typeStr=t},expression:"typeStr"}},e._l(e.options,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"我要退货退款"===e.typeStr||"我要退货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"退货数量："}},[i("el-input-number",{attrs:{size:"mini",min:1},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}})],1):e._e(),"我要换货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"换货数量："}},[i("el-input-number",{attrs:{size:"mini",min:1},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}})],1):e._e(),i("el-form-item",{attrs:{label:"售后原因："}},[i("el-select",{model:{value:e.reasonType,callback:function(t){e.reasonType=t},expression:"reasonType"}},e._l(e.reasonOptions,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"我要换货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"收货地址："}},[i("el-card",{nativeOn:{click:function(t){return e.clickAdress(t)}}},[i("div",{staticClass:"left"},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",{staticStyle:{float:"right"}},[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),"我要退货退款"===e.typeStr||"我要退款（无需退货）"===e.typeStr?i("el-form-item",{attrs:{label:"退款金额："}},[i("el-input",{attrs:{disabled:e.disableInput,type:"text"},model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}})],1):e._e(),i("el-form-item",{attrs:{label:"售后说明："}},[i("el-input",{attrs:{placeholder:"请输入退款说明",type:"textarea"},model:{value:e.explain,callback:function(t){e.explain=t},expression:"explain"}})],1),i("el-form-item",{attrs:{label:"上传图片："}},[i("img-uploader",{model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),i("span",[e._v("当前仅支持.jpeg .jpg .png格式，大小10M以内")])],1),i("el-form-item",[e.hasAuthEdit?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onConfirm}},[e._v("确定")]):e._e()],1)],1)],1),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],1)},L=[],R=(i("c975"),i("25f0"),i("b85c")),P=i("2119"),N=i("efa0"),A={name:"ApplySale",data:function(){return{editable:!1,files:[],typeStr:"我要退款（无需退货）",options:["我要退款（无需退货）","我要退货退款","我要换货（无需退款）","我要退货（无需退款）"],reasonType:"多拍/错拍/不想要",reasonOptions:["多拍/错拍/不想要","快递无跟踪记录","空包裹/少货"],amount:"",explain:"",quantity:"",id:"",disabled:!1,uploadimgs:0,disableInput:!1,dialogVisiable:!1,getAddress:{},depotReceiver:""}},props:{isEditable:{type:Boolean,default:!0},itemId:{type:String,default:""}},components:{ImgUploader:P["a"],BillInfo:N["a"]},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curApplySaleItem"])),Object(n["c"])("Authority",["currentAuth"])),{},{hasAuthEdit:function(){return this.currentAuth.includes("admin:purchaseApplication.edit")},images:function(){var e,t=[],i=Object(R["a"])(this.files);try{for(i.s();!(e=i.n()).done;){var r=e.value;t.push(r)}}catch(a){i.e(a)}finally{i.f()}return t},type:function(){return this.options.indexOf(this.typeStr).toString()}}),watch:{itemId:function(e,t){this.changeValue(),this.getAddressList()},isEditable:function(e,t){}},mounted:function(){this.amount=this.curApplySaleItem.maxAmountRefundable,this.quantity=this.curApplySaleItem.quantity,this.disableInput=Number(this.curApplySaleItem.minAmountRefundable)===Number(this.curApplySaleItem.maxAmountRefundable),this.getAddressList()},methods:{changeValue:function(){this.amount=this.curApplySaleItem.maxAmountRefundable,this.quantity=this.curApplySaleItem.quantity,this.disableInput=Number(this.curApplySaleItem.minAmountRefundable)===Number(this.curApplySaleItem.maxAmountRefundable)},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};l["a"].get(c["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.depotReceiver=t.receivers[0].id,e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},inputHandle:function(){this.typeStr===this.options[0]?(this.reasonType="多拍/错拍/不想要",this.reasonOptions=["多拍/错拍/不想要","快递无跟踪记录","空包裹/少货"]):this.typeStr===this.options[1]?(this.reasonType="质量问题",this.reasonOptions=["质量问题","颜色/款式/图案与描述不符","商家发错货"]):this.typeStr===this.options[2]?(this.reasonType="质量问题",this.reasonOptions=["质量问题","商家发错货"]):this.typeStr===this.options[3]&&(this.reasonType="质量问题",this.reasonOptions=["质量问题","多拍/错拍/不想要"])},fileSuccess:function(e){console.log(e.response.urls[0])},onConfirm:function(){if(this.typeStr)if(this.reasonType)if(this.amount){var e=/^\d+(?=\.{0,1}\d+$|$)/;e.test(this.amount)?this.isEditable?this.refundsHandle():this.updateRefunds():this.$message.warning("请输入合法数字")}else this.$message.warning("请输入退款金额");else this.$message.warning("请输入售后原因");else this.$message.warning("请输入售后类型")},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},refundsHandle:function(){var e=this,t={orderId:this.curApplySaleItem.orderId,orderItem:{id:this.curApplySaleItem.id,quantity:this.curApplySaleItem.quantity,product:{id:this.curApplySaleItem.productId}},type:this.options.indexOf(this.typeStr).toString(),reason:this.reasonType,amount:this.amount,quantity:this.quantity,depotReceiver:this.depotReceiver,explain:this.explain,images:this.images,methodName:"AddRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,receiverId:this.getAddress.id};l["a"].post(c["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("申请成功",t),e.$message.success("申请成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)}))},updateRefunds:function(){var e=this,t={amount:this.amount,quantity:this.quantity,depotReceiver:this.depotReceiver,refundsId:this.id,type:this.type,reason:this.reasonType,explain:this.explain,methodName:"UpdateRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,images:this.images,receiverId:this.getAddress.id};l["a"].put(c["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("修改申请成功",t),e.$message.success("修改申请成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){}))},queryRefunds:function(e){var t=this,i={clientType:"2",methodName:"QueryRefunds",shopId:this.getUser.shop.id,userId:this.getUser.id,id:e};l["a"].get(c["g"].hypermarketMgmt.refunds,i).then((function(e){console.log("修改申请",e),t.typeStr=t.options[e.refunds.type],t.inputHandle(),t.reasonType=e.refunds.reason,t.amount=e.refunds.amount,t.explain=e.refunds.explain,t.id=e.refunds.id;for(var i,r=e.refunds.images,a=r.length,s=0;s<a;s++)t.files.push(i);t.uploadimgs=a})).catch((function(){})).finally((function(){}))},getParams:function(e){this.isEditable||this.queryRefunds(e),"1"!==this.orderInfo.paymentStatus&&"2"!==this.orderInfo.paymentStatus||"0"!==this.orderInfo.shippingStatus?"0"===this.orderInfo.shippingStatus&&"0"===this.orderInfo.paymentStatus?this.options=["我要退货（无需退款）"]:"0"!==this.orderInfo.shippingStatus&&"0"===this.orderInfo.paymentStatus?this.options=["我要退货（无需退款）","我要换货（无需退款）"]:this.options=["我要退款（无需退货）","我要退货退款","我要换货（无需退款）"]:this.options=["我要退款（无需退货）"]},onFinishUpload:function(){this.disabled=!1},onFileUploading:function(){this.disabled=!0},clickAdress:function(){this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e,this.depotReceiver=e.id}},created:function(){}},z=A,E=(i("0630"),Object(x["a"])(z,$,L,!1,null,null,null)),j=E.exports,B=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"refund-info"},[i("div",{staticClass:"o-refund-info"},[i("div",{staticClass:"info-list"},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退货类型：")]),i("div",{staticClass:"des"},[e._v(e._s(e.typeStr))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款金额：")]),i("div",{staticClass:"des"},[e._v(e._s(e.amount))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款原因：")]),i("div",{staticClass:"des"},[e._v(e._s(e.reason))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款说明：")]),i("div",{staticClass:"des"},[e._v(e._s(e.explain))])]),e.curRefundsInfo&&e.curRefundsInfo.returns&&"3"===e.curRefundsInfo.returns[0].type?i("div",{staticClass:"info-item"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("退货地址：")]),i("div",{staticClass:"des"},[e._v(e._s("1"===e.type?e.curRefundsInfo.returns[0].address:""))])]):e._e(),e.curRefundsInfo&&e.curRefundsInfo.images&&e.curRefundsInfo.images.length?i("div",{staticClass:"refunds-img"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("上传图片：")]),e._l(e.curRefundsInfo.images,(function(e){return i("img",{key:e,staticStyle:{margin:"0px 5px"},attrs:{src:e,width:"80px",height:"80px"}})}))],2):e._e(),i("div",{staticClass:"order-track-content"},[i("ul",{staticClass:"trace-info"},[e._l(e.logs,(function(t,r){return[i("li",{key:r,class:t.status},[i("p",{domProps:{innerHTML:e._s(t.title)}}),i("span",[e._v(e._s(t.time))])])]}))],2)])]),i("div",{staticClass:"bottom-action"},[e.btnLabel?i("span",{staticClass:"half-action",on:{click:e.selectLogistics}},[e._v(e._s(e.getBtnLabel))]):e._e(),e.showModefyBtn?i("span",{staticClass:"half-action",on:{click:e.modefyApply}},[e._v("修改申请")]):e._e(),e.showCancelBtn?i("span",{staticClass:"half-action",on:{click:e.cancelApply}},[e._v("取消申请")]):e._e(),e.showReApply?i("span",{staticClass:"half-action",on:{click:e.reApplyHandle}},[e._v("重新申请")]):e._e(),e.showShipping?i("span",{staticClass:"half-action",on:{click:e.confirmShipping}},[e._v("确认收货")]):e._e()])]),i("el-dialog",{attrs:{visible:e.dialogInfo,"append-to-body":""},on:{"update:visible":function(t){e.dialogInfo=t}}},[i("logistic-info",{attrs:{refundsId:e.id},on:{operationSuccess:e.operationSuccess}})],1),i("el-dialog",{attrs:{visible:e.dialogFollowing,"append-to-body":""},on:{"update:visible":function(t){e.dialogFollowing=t}}},[i("logistics-following",{ref:"following",attrs:{sn:e.shippingSn}})],1)],1)},q=[],F=(i("d81d"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"logistic-info-content"},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"物流公司",prop:"deliveryId"}},[i("el-select",{model:{value:e.form.deliveryId,callback:function(t){e.$set(e.form,"deliveryId",t)},expression:"form.deliveryId"}},e._l(e.deliveryOptions,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"物流单号",prop:"trackingNo"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.trackingNo,callback:function(t){e.$set(e.form,"trackingNo",t)},expression:"form.trackingNo"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"退款说明",prop:"explain"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.form.explain,callback:function(t){e.$set(e.form,"explain",t)},expression:"form.explain"}})],1),i("el-form-item",{attrs:{label:""}},[i("img-uploader",{model:{value:e.form.files,callback:function(t){e.$set(e.form,"files",t)},expression:"form.files"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)}),U=[],V=i("8330"),H={name:"LogisticInfo",data:function(){return{deliveryOptions:[],formOperations:[{label:"提交退货物流信息",name:"onConfirm",type:"primary",auth:["admin:purchaseOrder.edit"]}],rules:{deliveryId:[{required:!0,message:"请选择物流公司",trigger:"blur"}],trackingNo:[{required:!0,message:"请输入物流单号",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^[1][1,2,3,4,5,6,7,8,9][0-9]{9}$/,message:"电话号格式错误",trigger:"blur"}],explain:[{required:!0,message:"请输入退款说明",trigger:"blur"}]},form:this.getDetaultModel()}},props:{refundsId:{type:String,default:""}},components:{ImgUploader:P["a"],BizSaveButton:V["a"]},computed:Object(s["a"])(Object(s["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curApplySaleItem"])),watch:{},created:function(){this.getDeliveries()},methods:Object(s["a"])(Object(s["a"])({},Object(n["d"])("Order",["updateRefundsInfo"])),{},{fileSuccess:function(e){console.log(e.response.urls[0])},getDetaultModel:function(){return{deliveryId:"",files:[],trackingNo:"",mobile:"",explain:""}},operate:function(e){this[e]()},onConfirm:function(){var e=this;this.$refs.form.validate((function(t,i){t&&e.submitLogisticInfo()}))},getDeliveries:function(){var e=this,t={methodName:"ListDeliveryCorp",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,type:"0"};l["a"].get(c["g"].hypermarketMgmt.deliveryCorpsByType,t).then((function(t){e.deliveryOptions=t.deliveryCorps}))},getLogisticsInfo:function(){var e=this,t={methodName:"QueryRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.curApplySaleItem.id};l["a"].get(c["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("退款详情",t),e.updateRefundsInfo(t)})).catch((function(t){e.$message.warning(t.errorMessage)}))},submitLogisticInfo:function(){var e=this,t={orderId:this.curApplySaleItem.orderId,refundsId:this.refundsId,orderItem:{id:this.curApplySaleItem.id,quantity:this.curApplySaleItem.quantity,product:{id:this.curApplySaleItem.productId}},deliveryId:this.form.deliveryId,delivery:this.form.delivery,trackingNo:this.form.trackingNo,mobile:this.form.mobile,explain:this.form.explain,images:this.form.files,methodName:"AddReturns",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id};l["a"].post(c["g"].hypermarketMgmt.returns,t).then((function(t){console.log("填写物流成功",t),e.$message.success("操作成功"),e.$emit("operationSuccess")})).catch((function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage)}))}})},G=H,Q=(i("8506"),Object(x["a"])(G,F,U,!1,null,null,null)),Y=Q.exports,W=i("2c2c"),K={name:"refund-info",props:{itemId:{type:String,default:""}},data:function(){return{orderItemId:"",type:"",amount:"",reason:"",explain:"",shippingSn:"",btnLabel:!1,dialogInfo:!1,dialogFollowing:!1,id:"",showDialog:!1,showModefyBtn:null,showCancelBtn:null,showReApply:null,showShipping:!1,deliveryCorp:"",trackingNo:"",orderId:""}},components:{LogisticInfo:Y,LogisticsFollowing:W["a"]},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curRefundsInfo"])),{},{typeStr:function(){switch(this.type){case"0":return"我要退款(无需退货)";case"1":return"我要退货退款";case"2":return"我要换货(无需退款)";case"3":return"我要退货(无需退款)";default:return""}},getBtnLabel:function(){return"2"===this.curRefundsInfo.returns[0].type?"填写物流":"3"!==this.curRefundsInfo.returns[0].type&&"4"!==this.curRefundsInfo.returns[0].type&&"5"!==this.curRefundsInfo.returns[0].type||"1"!==this.type&&"2"!==this.type?"":"查看物流"},logs:function(){var e=this,t=[];return this.curRefundsInfo&&this.curRefundsInfo.returns&&this.curRefundsInfo.returns.forEach((function(i,r){var a={};switch(a.time=i.happenDate,i.type){case"0":"0"===e.type?a.title="提交退款(无需退货)申请":"2"===e.type?a.title="提交换货申请":"3"===e.type?a.title="提交退货(无需退款)":a.title="提交退货退款申请";break;case"2":a.title="卖家同意售后申请，等待买家发货给卖家<br/>退货地址："+e.curRefundsInfo.returns[0].address||!1;break;case"3":a.title="买家已退货，等待卖家收货<br/>物流公司："+i.deliveryCorp+"<br/>物流单号："+i.trackingNo;break;case"7":a.title="卖家已收到买家的换货商品，待发出换货商品";break;case"8":a.title="卖家已发货，等待买家收货<br/>物流公司："+i.deliveryCorp+"<br/>物流单号："+i.trackingNo,a.type="8";break;case"1":case"4":a.title="退款失败<br/>拒绝原因："+e.curRefundsInfo.returns[0].details+"<br/>备注："+e.curRefundsInfo.returns[0].remarks;break;case"5":a.title="退款成功";break;case"9":a.title="换货完成";break;default:break}a.status=0===r?"cur":"no-started",t.unshift(a)})),t}}),watch:{itemId:function(e,t){this.getLogisticsInfo()}},created:function(){this.getLogisticsInfo()},methods:Object(s["a"])(Object(s["a"])({},Object(n["d"])("Order",["updateRefundsInfo","updateApplySaleItem"])),{},{confirmShipping:function(){var e=this,t={refundsId:this.curRefundsInfo.id,state:"2"};l["a"].put("/admin/invoicing/purchase/refunds/takeOver.jhtml",t).then((function(t){e.$message.success("操作成功")})).catch((function(){})).finally((function(){}))},getOrderInfo:function(){var e=this,t={clientType:"2",methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderId};l["a"].get(c["g"].hypermarketMgmt.queryOrder,t).then((function(t){t.order.orderItems.map((function(t){t.id===e.itemId&&e.updateApplySaleItem(t)}))})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){}))},modefyApply:function(){this.$emit("applySaleHanlder",!1,this.id)},reApplyHandle:function(){this.$emit("applySaleHanlder",!0)},operationSuccess:function(){this.dialogInfo=!1,this.getLogisticsInfo()},cancelApply:function(){var e=this;this.$confirm("请确认是否取消退款申请?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.confirmReceive()}))},confirmReceive:function(){var e=this,t={clientType:"2",methodName:"DeleteRefunds",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.itemId};l["a"].delete(c["g"].hypermarketMgmt.refunds,t).then((function(t){e.$message.success("取消申请成功"),e.$emit("operationSuccess")})).catch((function(){})).finally((function(){}))},getLogisticsInfo:function(){var e=this,t={methodName:"QueryRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.itemId};l["a"].get(c["g"].hypermarketMgmt.refundsByOrderItemId,t).then((function(t){console.log("退款详情",t),e.type=t.refunds.type,e.amount=t.refunds.amount,e.reason=t.refunds.reason,e.explain=t.refunds.explain,e.id=t.refunds.id,e.orderId=t.refunds.orderItem.orderId,e.orderInfo&&e.orderInfo.orderItems?e.orderInfo.orderItems.map((function(t){t.id===e.itemId&&e.updateApplySaleItem(t)})):e.getOrderInfo(),t.refunds.returns.forEach((function(t){if("3"===t.type)return e.deliveryCorp=t.deliveryCorp,e.trackingNo=t.trackingNo,e.shippingSn=t.shippingSn,!1})),"2"!==t.refunds.returns[0].type&&"3"!==t.refunds.returns[0].type&&"4"!==t.refunds.returns[0].type&&"5"!==t.refunds.returns[0].type||"0"===e.type?e.btnLabel=!1:e.btnLabel=!0,e.updateRefundsInfo(t.refunds),"3"===t.refunds.returns[0].type||"5"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1):"4"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1,e.showReApply=!0):"2"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showShipping=!1,e.showCancelBtn=!0):"1"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1,e.showReApply=!0):"8"===t.refunds.returns[0].type?e.showShipping=!0:(e.showModefyBtn=!0,e.showCancelBtn=!0)})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)}))},touchCS:function(){this.$router.push({path:"/custom-service"})},selectLogistics:function(){var e=this;"2"===this.curRefundsInfo.returns[0].type?this.dialogInfo=!0:"3"!==this.curRefundsInfo.returns[0].type&&"4"!==this.curRefundsInfo.returns[0].type&&"5"!==this.curRefundsInfo.returns[0].type||(this.dialogFollowing=!0,this.$nextTick((function(){e.$refs.following.getLogisticsInfo()})))}})},Z=K,X=(i("c2cb"),Object(x["a"])(Z,B,q,!1,null,null,null)),J=X.exports,ee={name:"order-info",data:function(){return{auditState:"1",remarks:"",row:{},curSelectAjectReason:"申报的商品与实际需要采购的商品不符",reasonAjectList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}],iconShop:h.a,defaultImg:p.a,defaultFailImg:m.a,maxlength:6,passValue:"",loading:!1,dialogVisiable:!1,openCancel:!1,open:!1,showPayment:!1,showPayDeposit:!1,showFinalPayment:!1,showCancelOrder:!1,showBalancePay:!0,thirdPay:!0,showRefund:[],showLogistics:!1,showReceive:!1,showLookEvaluate:!1,showEvaluate:!1,showDialog:!1,refundsLabel:[],showCreatInvoice:!1,dialogVisiableLog:!1,dialogApplaySale:!1,dialogApplayRefundInfo:!1,showPassOrder:!1,isEditable:!0,itemId:"",orderItemId:""}},props:{orderId:{type:String,default:""},isPend:{type:Boolean,default:!1},hasSyncOrder:{type:String,default:""},isRalateBill:{type:Boolean,default:!1}},watch:{},components:{BizGrid:o["a"],MyInvoice:g["a"],OrderTrack:D,ApplySale:j,RefundInfo:J},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("RecentActivity",["activity","shop","product"])),Object(n["c"])("Order",["orderConfim","orderInfo","routerFrom","curApplySaleItem"])),Object(n["c"])("Order",["orderInfo","curInvoice"])),Object(n["c"])("Authority",["currentAuth"])),{},{hasAuthEdit:function(){return this.currentAuth.includes("admin:purchaseOrder.edit")},hasAuthExamine:function(){return this.currentAuth.includes("admin:purchaseOrder.examine")},getOffsetAmount:function(){var e=this.orderInfo.offsetAmount;return e?Number(e)>=0?"+ ￥"+e:"- ￥"+e.substr(1,e.length-1):""},getAmount:function(){var e,t=this.orderInfo.orderItems,i=0;t&&(e=t.length);for(var r=0;r<e;r++)i+=t[r].price*t[r].quantity;return i.toFixed(2)},getOrderPaymentState:function(){if("1"===this.orderInfo.afterSaleStatus)return"退货退款中";switch(this.orderInfo.type){case"1":return"待付款";case"2":return"待收货";case"3":return"已完成";case"5":return"4"===this.orderInfo.orderType||"5"===this.orderInfo.orderType||"6"===this.orderInfo.orderType||"7"===this.orderInfo.orderType||"8"===this.orderInfo.orderType?"商家已确认":"待发货";case"6":return"已完成";case"7":return"已关闭";case"8":return"订单过期";case"9":return"退款退货中";case"10":return"退款退货完成";case"11":return"待商家确认";default:return""}},getDownPayment:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.downPayment)+"%";return t},getInitPay:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.product.price),i=parseFloat(e.downPayment)*t*.01;return i.toFixed(2)},getMonthPaidNum:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.product.price),i=parseFloat(e.downPayment)*t*.01,r=12*parseInt(e.year),a=t-i,s=parseFloat(parseFloat(e.rate)/12),o=Math.pow(1+s,r)-1;if(0===o)return(0).toFixed(2);var n=a*s*Math.pow(1+s,r)/(Math.pow(1+s,r)-1);return n.toFixed(2)}}),methods:Object(s["a"])(Object(s["a"])({},Object(n["d"])("Order",["updateOrderInfo","updateOrderId","updateApplySaleItem","updateClickItemSelect"])),{},{imgError:function(e){this.$refs.img&&this.$refs.img[e]&&(this.$refs.img[e].src=this.defaultFailImg)},toPass:function(e,t){this.remarks="",this.row=e,this.showPassOrder=!0},statusChange:function(e,t){var i=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.loading=!0;var r={shopId:window.top.SHOP_ID||"",id:e.id,actionType:t,details:"2"===t?i.curSelectAjectReason:"",remarks:i.remarks};l["a"].post("/admin/purchaseOrderManage/audit.jhtml",r).then((function(e){i.$message.success("操作成功！"),i.showPassOrder=!1,i.loading=!1,i.$emit("closeTabByAudit")})).catch((function(e){i.loading=!1,e.errorMessage&&i.$message.warning(e.errorMessage)})).finally((function(){}))}))},confirmOrder:function(e){var t=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={clientType:"2",methodName:"UpdateOrder",shopId:t.getUser().shop.id,userId:t.getUser().id,orderId:e.id,type:"1"};l["a"].put(c["g"].hypermarketMgmt.purchaseOrder,i).then((function(e){t.$message.success("操作成功"),t.getList()})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){}))}))},applySaleHanlder:function(e,t){var i=this;this.isEditable=e,this.dialogApplaySale=!0,this.$nextTick((function(){i.$refs.applySale.getParams(t)}))},operationSuccess:function(){this.dialogApplaySale=!1,this.dialogApplayRefundInfo=!1,this.getOrderInfo()},goShop:function(){},handleCartClick:function(e){this.$router.push({path:"/cart"})},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},selectInvoice:function(){var e=this;this.orderInfo.invoiceTitle||"1"!==this.orderInfo.type?(this.dialogVisiable=!0,this.$nextTick((function(){e.$refs.invoice.getInvoiceInfo()}))):this.$message.warning("本订单暂无发票信息，付款后支持补开发票")},hideCancel:function(){this.openCancel=!1},onCancel:function(){this.open=!1},successHandle:function(e){this.getOrderInfo()},onOrderTrack:function(e){var t=this;this.dialogVisiableLog=!0,this.$nextTick((function(){t.$refs.track.getLogs(e)}))},onConsultation:function(){this.$router.push({path:"/custom-service"})},onPay:function(){this.open=!0},onCancelPay:function(){this.openCancel=!0},onConfirm:function(e){var t=this,i={clientType:"2",methodName:"UpdateOrder",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,type:0,content:e};l["a"].put(c["g"].order.cancelOrder,i).then((function(e){t.routerFrom?t.$router.replace({path:t.routerFrom}):(t.openCancel=!1,t.$router.go(-1),t.getOrderInfo())})).catch((function(){})).finally((function(){}))},getOrderInfo:function(){var e=this;this.updateOrderId(this.orderId),this.open=!1;var t={clientType:"2",methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id};l["a"].get(c["g"].hypermarketMgmt.queryOrder,t).then((function(t){console.log("订单信息1",t),e.updateOrderInfo(t.order),"1"===e.orderInfo.orderType||"13"===e.orderInfo.orderType?e.showBalancePay=!1:e.showBalancePay=!0,parseFloat(e.orderInfo.amountPayable)?e.thirdPay=!0:e.thirdPay=!1,("2"===e.orderInfo.paymentStatus||"3"===e.orderInfo.paymentStatus)&&parseFloat(e.orderInfo.amount)>0&&!e.orderInfo.invoiceTitle?e.showCreatInvoice=!0:e.showCreatInvoice=!1,e.showRefund=[];var i,r=t.order,a=r.orderItems,s=a.length;for(i=0;i<s;i++)e.showRefund.push(!1),e.refundsLabel.push("");for(r.shippings.length>0&&"5"!==r.state&&"6"!==r.state&&"7"!==r.state?e.showLogistics=!0:e.showLogistics=!1,i=0;i<s;i++)("0"!==r.method&&"2"!==r.method||"1"!==r.type||"0"!==r.orderType&&"2"!==r.orderType&&"9"!==r.orderType&&"10"!==r.orderType&&"3"!==r.orderType&&"6"!==r.orderType&&"7"!==r.orderType&&"8"!==r.orderType)&&("0"!==r.method&&""!==r.method||"1"!==r.orderType&&"13"!==r.orderType&&"17"!==r.orderType||"1"!==r.type)&&("11"!==r.type&&"5"!==r.type||"4"!==r.orderType&&"5"!==r.orderType)?e.showCancelOrder=!1:e.showCancelOrder=!0,"0"!==r.method&&""!==r.method||"1"!==r.orderType&&"13"!==r.orderType&&"17"!==r.orderType||"1"!==r.type?e.showPayment=!1:e.showPayment=!0,"0"!==r.method||"0"!==r.orderType&&"2"!==r.orderType&&"4"!==r.orderType&&"5"!==r.orderType&&"9"!==r.orderType&&"10"!==r.orderType||("1"===r.type?(e.showPayment=!1,e.showPayDeposit=!1,e.showFinalPayment=!1,"1"!==r.isSubscription||e.activity.activityId?e.showPayment=!0:0===Number(r.amountPaid)?e.showPayDeposit=!0:(Number(r.amountPayable)>0&&(e.showFinalPayment=!0,e.showCancelOrder=!1),parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"))):"2"===r.type?(e.showReceive=!0,parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后")):"3"===r.type?(e.showEvaluate=!0,e.showCancelOrder=!1,e.showReceive=!1,parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后")):"5"===r.type?(parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"),e.showFinalPayment=!1):"6"===r.type&&parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后")),"3"!==r.type||"0"!==r.orderType&&"1"!==r.orderType&&"2"!==r.orderType&&"9"!==r.orderType&&"10"!==r.orderType&&"3"!==r.orderType&&"4"!==r.orderType&&"5"!==r.orderType&&"6"!==r.orderType&&"7"!==r.orderType&&"8"!==r.orderType&&"13"!==r.orderType&&"17"!==r.orderType||(e.showEvaluate=!0,e.showCancelOrder=!1),"1"===r.isReviewed?e.showLookEvaluate=!0:e.showLookEvaluate=!1,"1"!==e.orderInfo.orderType&&"13"!==e.orderInfo.orderType&&"17"!==e.orderInfo.orderType&&("6"===e.orderInfo.type?(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"):"0"===a[i].refundsState||"2"===a[i].refundsState||"3"===a[i].refundsState?(e.showRefund[i]=!0,e.refundsLabel[i]="退款中"):"5"===a[i].refundsState?(e.showRefund[i]=!0,e.refundsLabel[i]="退款成功"):"6"===a[i].refundsState?(parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0),e.refundsLabel[i]="申请售后"):"1"!==a[i].refundsState&&"4"!==a[i].refundsState||(e.showRefund[i]=!0,e.refundsLabel[i]="退款失败"))})).catch((function(){})).finally((function(){}))},queryRefunds:function(){this.$router.push({path:this.$route.path+"/myOrder"})},onRefund:function(e){var t=this;this.updateApplySaleItem(e),console.log("申请退款的信息",e),e.refundsState&&"6"!==e.refundsState?(this.itemId=this.curApplySaleItem.id,this.dialogApplayRefundInfo=!0,this.$nextTick((function(){t.$refs.refundInfo.getLogisticsInfo()}))):(this.orderItemId=e.id,this.dialogApplaySale=!0,this.isEditable=!0,this.$nextTick((function(){t.$refs.applySale.getParams()})))},onLookLogistics:function(e){this.$emit("closeTabByLogistics",e)},onConfirmReceive:function(){this.showDialog=!0},onEvaluate:function(){this.$router.push({path:"/my-evaluate/"+this.orderInfo.id+"/true"})},onLookEvaluate:function(e,t){console.log(1213),this.$emit("closeTabByEvaluate",e,t)},onReview:function(e,t){this.$emit("closeTabByEvaluate",e,t)},onClickProduct:function(e){},confirmReceive:function(){var e=this,t={clientType:"2",methodName:"UpdateOrder",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,type:"1"};l["a"].put(c["g"].order.cancelOrder,t).then((function(t){console.log("确认收货",t),e.getOrderInfo()})).catch((function(){})).finally((function(){}))},onCreateInvoice:function(){this.updateClickItemSelect(!0),this.$router.push({path:this.$route.fullPath+"/invoiceInfo"})}}),created:function(){}},te=ee,ie=(i("2fd9"),Object(x["a"])(te,r,a,!1,null,null,null));t["a"]=ie.exports},"28d7":function(e,t,i){},2992:function(e,t,i){"use strict";var r=i("d437"),a=i.n(r);a.a},"2c2c":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"logistic-following"},[i("div",{staticClass:"product-info"},[i("div",{staticClass:"img"},[i("img",{attrs:{src:e.image||e.defaultProductImg}})]),i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v("物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s(e.logisticState))])]),i("div",{staticClass:"i-item"},[e._v("物流公司："+e._s(e.logistics))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]),e.shippingTraces&&e.shippingTraces.length>0?i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0)])]):e._e()])},a=[],s=i("5530"),o=i("2f62"),n=i("1ab1"),l=i("c596"),c=i("e83a"),d=i.n(c),p={name:"LogisticsFollowing",components:{},data:function(){return{shippingSn:"",defaultProductImg:d.a,shippingTraces:[],state:"",logistics:"",expressSn:"",image:""}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(o["c"])(["getUser"])),Object(o["c"])("Order",["curApplySaleItem","orderInfo"])),{},{logisticState:function(){switch(this.state){case"0":return"无轨迹";case"1":return"已揽收";case"2":return"在途中";case"201":return"到达派件城市";case"3":return"签收";case"4":return"问题件";default:return""}}}),props:{sn:{type:String,default:""}},watch:{},created:function(){},methods:{getLogisticsInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.sn};n["a"].get(l["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.state=t.shipping.state,e.image=t.shipping.shippingItems.length>0?t.shipping.shippingItems[0].image:"",e.logistics=t.shipping.logistics,e.expressSn=t.shipping.expressSn,e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}},u=p,m=(i("b4cc"),i("2877")),f=Object(m["a"])(u,r,a,!1,null,null,null);t["a"]=f.exports},"2fd9":function(e,t,i){"use strict";var r=i("e700"),a=i.n(r);a.a},3077:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-info-t"},[e.isEdit&&e.judgeState?i("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}},[i("template",{slot:"operation"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.handleSuccess,"on-error":e.handleError,data:{type:"0"},"file-list":e.fileList,name:"file",action:"/admin/file/uploads.jhtml"}},[e.invoiceMode?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"}},[e._v("上传电子发票")]):e._e()],1)],1)],2):e._e(),i("div",{staticClass:"invoiceInfo"},[e._v("发票详情")]),i("el-form",{ref:"formModel",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"发票类型",prop:"invoiceType"}},[i("el-select",{attrs:{placeholder:"请选择发票类型",disabled:!0},on:{change:e.invoiceTypeChange},model:{value:e.formModel.invoiceType,callback:function(t){e.$set(e.formModel,"invoiceType",t)},expression:"formModel.invoiceType"}},[i("el-option",{attrs:{label:"个人",value:"0"}}),i("el-option",{attrs:{label:"增值税普通发票",value:"1"}}),i("el-option",{attrs:{label:"增值税专用发票",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"发票抬头",prop:"invoiceTitle"}},[i("el-input",{attrs:{placeholder:"请输入发票抬头",disabled:!0},model:{value:e.formModel.invoiceTitle,callback:function(t){e.$set(e.formModel,"invoiceTitle",t)},expression:"formModel.invoiceTitle"}}),""===e.formModel.invoiceState?i("el-button",{attrs:{size:"mini",type:""},on:{click:e.selectInvoice}},[e._v("选择")]):e._e()],1),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"纳税人识别号",prop:"code"}},[i("el-input",{attrs:{placeholder:"请输入纳税人识别号",disabled:!0},model:{value:e.formModel.code,callback:function(t){e.$set(e.formModel,"code",t)},expression:"formModel.code"}})],1):e._e(),i("el-form-item",{attrs:{label:"发票金额",prop:"invoiceAmount"}},[i("el-input",{attrs:{placeholder:"请输入发票金额",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.invoiceAmount,callback:function(t){e.$set(e.formModel,"invoiceAmount",t)},expression:"formModel.invoiceAmount"}})],1),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"注册地址",prop:"registerAddress"}},[i("el-input",{attrs:{placeholder:"请输入注册地址",disabled:!0},model:{value:e.formModel.registerAddress,callback:function(t){e.$set(e.formModel,"registerAddress",t)},expression:"formModel.registerAddress"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"注册电话",prop:"registerMobile"}},[i("el-input",{attrs:{placeholder:"请输入注册电话",disabled:!0},model:{value:e.formModel.registerMobile,callback:function(t){e.$set(e.formModel,"registerMobile",t)},expression:"formModel.registerMobile"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[i("el-input",{attrs:{placeholder:"请输入开户银行",disabled:!0},model:{value:e.formModel.bank,callback:function(t){e.$set(e.formModel,"bank",t)},expression:"formModel.bank"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"银行账户",prop:"account"}},[i("el-input",{attrs:{placeholder:"请输入银行账户",disabled:!0},model:{value:e.formModel.account,callback:function(t){e.$set(e.formModel,"account",t)},expression:"formModel.account"}})],1):e._e(),i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("获取方式")]),i("el-form-item",{attrs:{label:"发票类型",prop:"invoiceMode"}},[i("el-radio-group",{attrs:{disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.invoiceMode,callback:function(t){e.$set(e.formModel,"invoiceMode",t)},expression:"formModel.invoiceMode"}},[i("el-radio",{attrs:{label:"0"}},[e._v("纸质发票")]),i("el-radio",{attrs:{label:"1"}},[e._v("电子发票")])],1)],1),"1"===e.formModel.invoiceMode?i("div",[i("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[i("el-input",{attrs:{placeholder:"请输入电子邮箱",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.email,callback:function(t){e.$set(e.formModel,"email",t)},expression:"formModel.email"}})],1)],1):e._e(),"0"===e.formModel.invoiceMode?i("div",[i("el-form-item",{attrs:{label:"是否邮寄",prop:"needMail"}},[i("el-radio-group",{attrs:{disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.needMail,callback:function(t){e.$set(e.formModel,"needMail",t)},expression:"formModel.needMail"}},[i("el-radio",{attrs:{label:"1"}},[e._v("是")]),i("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),"1"===e.formModel.needMail?i("div",[i("el-form-item",{attrs:{label:"收票人",prop:"contacts"}},[i("el-input",{attrs:{placeholder:"请输入收票人",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.contacts,callback:function(t){e.$set(e.formModel,"contacts",t)},expression:"formModel.contacts"}})],1),i("el-form-item",{attrs:{label:"收件人电话",prop:"mobile"}},[i("el-input",{attrs:{maxlength:"13",placeholder:"请输入电话",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),i("el-form-item",{attrs:{label:"所在地",prop:"area"}},[i("biz-area-select",{attrs:{areaId:e.formModel.area.id,disabled:""!==e.formModel.invoiceState},on:{areaChanged:e.areaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{placeholder:"请输入地址",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1)],1):e._e()],1):e._e(),e.logs&&e.logs.length>0?i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("发票进度")]):e._e(),e.logs&&e.logs.length>0?i("div",{staticClass:"order-track-new",staticStyle:{"padding-left":"30px","padding-top":"15px"}},[i("el-steps",{attrs:{direction:"vertical","finish-status":"success",space:"30px"}},[i("el-step",{attrs:{title:"已申请",status:"1"===e.active?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,r){return"0"===t.type?i("div",{key:r,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)]),i("el-step",{attrs:{title:"已开票",status:"2"===e.active1?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,r){return"1"===t.type?i("div",{key:r,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)]),i("el-step",{attrs:{title:"已邮寄",status:"3"===e.active2?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,r){return"2"===t.type?i("div",{key:r,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)])],1)],1):e._e(),"1"===e.formModel.invoiceMerged?i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("合并明细")]):e._e(),"1"===e.formModel.invoiceMerged?i("div",{staticStyle:{"margin-top":"10px"}},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{size:"small",data:e.formModel.purchaseOrders,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[i("el-table-column",{attrs:{prop:"sn",label:"订单编号"}}),i("el-table-column",{attrs:{prop:"amount",label:"订单金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.amount))]}}],null,!1,2031540991)})],1)],1):e._e()],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showInvoiceExpress,center:"","append-to-body":"","custom-class":"close-invoice-dialog",title:"发票邮寄",width:"500px"},on:{"update:visible":function(t){e.showInvoiceExpress=t}}},[i("div",{staticClass:"reson-container"},[i("span",{staticStyle:{"margin-left":"40px"}},[e._v("请填写发票邮寄的物流公司和快递单号信息")]),i("el-form",{ref:"formModel",staticStyle:{"margin-top":"40px"},attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"快递公司",prop:"express"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择快递公司"},on:{change:e.expressChange},model:{value:e.formModel.express,callback:function(t){e.$set(e.formModel,"express",t)},expression:"formModel.express"}},e._l(e.deliverys,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"快递单号",prop:"expressCode"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入快递单号"},model:{value:e.formModel.expressCode,callback:function(t){e.$set(e.formModel,"expressCode",t)},expression:"formModel.expressCode"}})],1)],1)],1),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showInvoiceExpress=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange()}}},[e._v("确定")])],1)]),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showLogisticsFollowing,center:"","append-to-body":"","custom-class":"close-follow-dialog",title:"物流跟踪"},on:{"update:visible":function(t){e.showLogisticsFollowing=t}}},[i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[e.getTraces?i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0):e._e(),this.shippingTraces&&0===this.shippingTraces.length?i("ul",[i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v(" 物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s("暂无轨迹"))])]),i("div",{staticClass:"i-item"},[e._v("快递公司："+e._s(e.expressName))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]):e._e()])])]),i("el-dialog",{attrs:{visible:e.dialogVisiableInvoice,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableInvoice=t}}},[i("invoice-info-dialog",{on:{selectedInvoice:e.selectedInvoice}})],1),i("el-dialog",{staticClass:"show-file",attrs:{"append-to-body":"",visible:e.previewInvoice,width:"950px"},on:{close:function(t){e.previewInvoice=!1}}},[i("div",[i("img",{style:e.imgStyle,attrs:{src:e.formModel.path,alt:""}})]),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.returnUpload,"on-error":e.handleError,data:{type:"0"},"file-list":e.fileList,limit:1,name:"file",action:"/admin/file/uploads.jhtml"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重新上传")])],1)],1)]),i("el-dialog",{staticClass:"before-upload",attrs:{"append-to-body":"",visible:e.uploadReview,width:"950px"},on:{close:e.cancelUplod}},[i("div",[i("img",{style:e.imgStyle,attrs:{src:e.formModel.path,alt:""}})]),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.uploadReview=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.conformUpload}},[e._v("确定上传")])],1)])],1)},a=[],s=(i("4160"),i("d81d"),i("b0c0"),i("d3b7"),i("159b"),i("5530")),o=i("04d3"),n=i("f36f"),l=i("e42c"),c=i("ce2e"),d=i("5719"),p=i("2f62"),u=i("1ab1"),m={name:"invoiceInfo",props:{itemId:{type:String},orderIds:{type:Array},userId:{type:String},price:{type:String},invoiceInfoId:{type:String},invoiceId:{type:String},open:{type:Boolean,default:function(){return!0}},isEdit:{type:Boolean,default:function(){return!0}},fileList:{type:Array,default:function(){return[]}}},components:{BizHeader:o["d"],BizGrid:n["a"],InvoiceInfoDialog:d["a"],BizAreaSelect:c["a"]},data:function(){var e=this;return{loading:!1,formLoading:!1,isFirst:!0,expressName:"",expressSn:"",active:"",active1:"",active2:"",active3:"",showInvoiceExpress:!1,showLogisticsFollowing:!1,dialogVisiableInvoice:!1,shippingSn:"",shippingTraces:[],previewInvoice:!1,uploadReview:!1,logs:[],formModel:{id:"",invoiceType:"",invoiceTitle:"",invoiceState:"",price:"",code:"",registerAddress:"",registerMobile:"",bank:"",account:"",invoiceMode:"0",invoiceAmount:"",createDate:"",needMail:"0",contacts:"",mobile:"",area:{id:"1568"},address:"",express:"",expressCode:"",freight:"",zipCode:"",email:"",path:""},operations:[{label:"确认提交",name:"save",type:"primary",disabled:!1,class:"show"},{label:"撤销",name:"cancel",type:"primary",disabled:!1,class:"hidden"}],deliverys:[],rules:{mobile:[{required:!0,message:"电话不能少于5位",trigger:"blur",min:5},{pattern:/^[-0-9]*$/,message:"请输入数字",trigger:"blur"}],invoiceType:[{required:!0,message:"请选择发票类型",trigger:"blur"}],invoiceTitle:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],invoiceAmount:[{required:!0,message:"请输入发票金额",trigger:"blur"}],code:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入注册地址",trigger:"blur"}],registerMobile:[{required:!0,message:"请输入注册电话",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],account:[{required:!0,message:"请输入银行账户",trigger:"blur"}],needMail:[{required:!0,message:"请选择是否邮寄",trigger:"blur"}],contacts:[{required:!0,message:"请输入收票人",trigger:"blur"}],number:[{required:!0,message:"请输入电话",trigger:"blur"}],area:[{required:!0,message:"请选择所在地",trigger:"blur"},{trigger:"blur",validator:function(t,i,r){e.formModel.area.id?r():r(new Error("请选择所在地"))}}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],express:[{required:!0,message:"请选择快递公司",trigger:"blur"}],expressCode:[{required:!0,message:"请输入快递单号",trigger:"blur"}],freight:[{required:!0,message:"请输入物流费用",trigger:"blur"}]}}},watch:{open:function(e,t){this.formModel=this.clear(),console.log("11111111111111===="),e&&(this.$refs.formModel.clearValidate(),console.log(this.invoiceInfoId),console.log(this.invoiceId),this.invoiceInfoId&&!this.invoiceId?this.getInvoiceInit():this.getList())}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(p["c"])(["getUser"])),Object(p["c"])("Order",["orderConfim","orderInfo","curInvoice","payment","defaultReceive","clickItemSelect"])),{},{judgeState:function(){if(console.log("invoiceState="+this.formModel.invoiceState),null!==this.formModel.invoiceState&&""!==this.formModel.invoiceState){if("2"===this.formModel.invoiceState||"3"===this.formModel.invoiceState)return!1;if("0"===this.formModel.needMail&&"1"===this.formModel.invoiceState)return!1}return!0},invoiceMode:function(){return"1"===this.formModel.invoiceMode&&"0"===this.formModel.invoiceState},showShippinig:function(){return"1"===this.formModel.invoiceState||"2"===this.formModel.invoiceState||"3"===this.formModel.invoiceState},getTraces:function(){return!!(this.shippingTraces&&this.shippingTraces.length>0)},imgStyle:function(){return{width:"100%",height:"100%"}}}),mounted:function(){console.log("22222222222222===="),this.invoiceInfoId&&!this.invoiceId?this.getInvoiceInit():this.getList()},methods:Object(s["a"])(Object(s["a"])({},Object(p["d"])("Order",["updateClickItemSelect"])),{},{clear:function(){return{id:"",invoiceType:"",invoiceTitle:"",invoiceState:"",price:"",code:"",registerAddress:"",registerMobile:"",bank:"",account:"",invoiceAmount:"",createDate:"",invoiceMode:"0",needMail:"0",contacts:"",mobile:"",area:{id:"1568"},address:"",express:"",expressCode:"",freight:"",zipCode:"",email:"",path:""}},cancelUplod:function(){this.uploadReview=!1},handleSuccess:function(e,t,i){console.log(e+"1111111"),e.fis&&e.fis[0]&&(this.fileList.push({uid:t.uid,url:e.fis[0].url}),this.formModel.path=e.fis[0].url),this.uploadReview=!0},conformUpload:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="1",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("上传成功"),e.getList(),e.$emit("operationSuccess"),e.uploadReview=!1}),(function(t){e.$message.warning(t.errorMessage)}))},handleError:function(e,t,i){e?this.$message.warning(e):this.$message.warning("发生错误")},selectedInvoice:function(e){this.dialogVisiableInvoice=!1,this.formModel.invoiceType=e.invoiceType,this.formModel.invoiceTitle=e.invoiceTitle,this.formModel.code=e.code,this.formModel.registerAddress=e.registerAddress,this.formModel.registerMobile=e.registerMobile,this.formModel.bank=e.bank,this.formModel.account=e.account,this.formModel.mobile=e.mobile,this.formModel.contacts=e.contacts,this.formModel.area.id=e.area.id,this.formModel.address=e.address},selectInvoice:function(){this.updateClickItemSelect(!0),this.dialogVisiableInvoice=!0},cancel:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="4",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("撤销成功"),e.formModel.invoiceState="",e.getList(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},expressInfo:function(){var e=this,t={userId:this.userId,shippingSn:this.shippingSn,shopId:this.getUser.shop.id};u["a"].get("/admin/purchaseOrder/logistics.jhtml",t).then((function(t){console.log("物流追踪",t),e.shippingTraces=t.shipping.shippingTraces,e.expressSn=t.shipping.expressSn,e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage),e.loading=!1}))},statusChange:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="2",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("保存成功"),e.showInvoiceExpress=!1,e.getList(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},returnUpload:function(e,t,i){var r=this;e.fis&&e.fis[0]&&(this.fileList.push({uid:t.uid,url:e.fis[0].url}),this.formModel.path=e.fis[0].url,this.formModel.orderId=this.itemId,this.formModel.invoiceState="1",l["a"].invoiceDetailUpdate(this.formModel,(function(e){r.$message.success("上传成功"),r.previewInvoice=!1,r.getList(),r.$emit("operationSuccess")}),(function(e){r.$message.warning(e.errorMessage)})))},invoiceTypeChange:function(){this.$refs.formModel.clearValidate("invoiceType")},expressChange:function(){this.$refs.formModel.clearValidate("express")},getLogs:function(){var e=this,t={userId:this.userId,orderId:this.itemId};u["a"].get("/rest/invoice/invoice.jhtml",t).then((function(t){e.logs=t.invoice.logs,e.active="",e.active1="",e.active2="",t.invoice.logs&&t.invoice.logs.length>0&&t.invoice.logs.forEach((function(t,i){"0"===t.type&&(e.active="1"),"1"===t.type&&(e.active1="2"),"2"===t.type&&(e.active2="3")})),e.shippingSn=t.invoice.shippingSn})).catch((function(e){console.log("ERR: ",e)})).finally((function(){}))},areaChanged:function(e){this.formModel.area.id=e,this.isFirst&&(this.formModel.area.id="1568",this.isFirst=!1)},getInvoiceInit:function(){var e=this;l["a"].invoiceInfoDefault({userId:this.userId||""},(function(t){e.formModel=Object.assign(e.clear(),t.invoiceInfo),console.log("this.price"),e.$set(e.formModel,"invoiceAmount",e.price),e.$set(e.formModel,"invoiceMode","0"),e.operations[1].class="hidden",e.operations[0].label="确认提交",e.logs=[],e.formModel.area.id||(e.formModel.area.id="1568")}),(function(t){console.log(t),e.loading=!1,console.log("code错误")}))},getList:function(){var e=this;this.loading=!0,this.showForm=!1,l["a"].invoiceByOrder({orderId:this.itemId||""},(function(t){e.formModel=Object.assign(e.clear(),t.invoice),"0"===e.formModel.invoiceMode?e.formModel.invoiceState?"0"===e.formModel.invoiceState?(e.operations[0].label="确认已开票",e.operations[0].class="show",e.operations[1].label="撤销",e.operations[1].class="show"):"1"===e.formModel.invoiceState?(e.operations[0].label="邮寄",e.operations[0].class="show",e.operations[1].class="hidden"):"2"===e.formModel.invoiceState?(e.operations[0].label="物流跟踪",e.operations[0].class="show",e.operations[1].class="hidden"):"4"===e.formModel.invoiceState?(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].label="已撤销",e.operations[1].class="show",e.formModel.invoiceState=""):e.operations[1].class="hidden":(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].class="hidden"):e.formModel.invoiceState?"0"===e.formModel.invoiceState?(e.operations[0].label="",e.operations[1].class="show",e.operations[1].label="撤销",e.operations[0].class="hidden"):"5"===e.formModel.invoiceState?(e.operations[0].label="查看电子发票",e.operations[0].class="show",e.operations[1].class="hidden"):"4"===e.formModel.invoiceState?(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].label="已撤销",e.operations[1].class="show",e.formModel.invoiceState=""):e.operations[1].class="hidden":(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].class="hidden"),e.formModel.area.id||(e.formModel.area.id="1568"),e.deliverys=t.deliverys,e.deliverys.map((function(i){i.id===t.invoice.express&&(e.expressName=i.name)})),e.getLogs(),e.loading=!1}),(function(t){e.loading=!1,e.formModel=e.clear()}))},handleOperate:function(e){this[e]()},save:function(){var e=this;this.$refs.formModel.validate((function(t){t&&(e.loading=!0,console.log("id="),console.log(e.formModel.id),e.$set(e.formModel,"orderIds",e.orderIds),e.formModel.id?("0"===e.formModel.invoiceMode?"0"===e.formModel.invoiceState?e.formModel.invoiceState="1":"1"===e.formModel.invoiceState?e.formModel.invoiceState="2":"2"===e.formModel.invoiceState?e.formModel.invoiceState="3":e.formModel.invoiceState="0":"0"===e.formModel.invoiceState?e.formModel.invoiceState="1":"4"!==e.formModel.invoiceState&&""!==e.formModel.invoiceState||(e.formModel.invoiceState="0"),"0"===e.formModel.invoiceMode?"2"===e.formModel.invoiceState?(e.formModel.express="",e.formModel.expressCode="",e.loading=!1,e.showInvoiceExpress=!0):"3"===e.formModel.invoiceState?(e.formModel.invoiceState="2",e.expressInfo(),e.showLogisticsFollowing=!0):(e.formModel.orderId=e.itemId,l["a"].invoiceDetailUpdate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage),"3"===e.formModel.invoiceState?e.formModel.invoiceState="2":"2"===e.formModel.invoiceState?e.formModel.invoiceState="1":(e.formModel.invoiceState,e.formModel.invoiceState="0")}))):"5"===e.formModel.invoiceState?(e.getList(),e.previewInvoice=!0,e.loading=!1):(e.formModel.orderId=e.itemId,l["a"].invoiceDetailUpdate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})))):(e.formModel.invoiceState="0",e.formModel.orderId=e.itemId,l["a"].invoiceDetailCreate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))))}))}})},f=m,h=(i("f58e"),i("2877")),g=Object(h["a"])(f,r,a,!1,null,null,null);t["a"]=g.exports},3193:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vehicle-base-info__content"},[i("el-form",{ref:"form",attrs:{size:"small","label-width":"130px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("el-collapse-item",{attrs:{title:"基本信息",name:"1"}},[i("el-form-item",{attrs:{label:"车牌号码",prop:"plateNumber"}},[i("el-input",{attrs:{placeholder:"请输入车牌号码"},model:{value:e.formModel.plateNumber,callback:function(t){e.$set(e.formModel,"plateNumber",t)},expression:"formModel.plateNumber"}})],1),i("el-form-item",{attrs:{label:"品牌"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌",filterable:""},on:{change:e.handleBrandChange},model:{value:e.formModel.brand,callback:function(t){e.$set(e.formModel,"brand",t)},expression:"formModel.brand"}},e._l(e.brandList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"系列"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列",filterable:""},on:{change:e.handleSeriesChange},model:{value:e.formModel.series,callback:function(t){e.$set(e.formModel,"series",t)},expression:"formModel.series"}},e._l(e.seriesList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"车型"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型"},model:{value:e.formModel.type,callback:function(t){e.$set(e.formModel,"type",t)},expression:"formModel.type"}},e._l(e.modeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),e.memberId?e._e():i("el-form-item",{attrs:{label:"所有者"}},[i("people-picker",{attrs:{contentField:"userName"},model:{value:e.formModel.member,callback:function(t){e.$set(e.formModel,"member",t)},expression:"formModel.member"}})],1),e.memberId?e._e():i("el-form-item",{attrs:{label:"电话"}},[i("el-input",{attrs:{type:"phone",maxlength:"12",readonly:"",placeholder:"请输入电话"},model:{value:e.formModel.member.mobile,callback:function(t){e.$set(e.formModel.member,"mobile",t)},expression:"formModel.member.mobile"}})],1),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.state,callback:function(t){e.$set(e.formModel,"state",t)},expression:"formModel.state"}},e._l(e.stateList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",[i("div",{attrs:{slot:"label"},slot:"label"},[e._v(" 注册日期 "),i("el-button",{directives:[{name:"popover",rawName:"v-popover:onTimePop",arg:"onTimePop"}],attrs:{type:"text",size:"small"}},[i("i",{staticClass:"iconfont el-icon-question"})]),i("el-popover",{ref:"onTimePop",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"您可在车辆行驶证上查询到此信息"}})],1),i("el-date-picker",{attrs:{type:"date",placeholder:"选择注册日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.onTime,callback:function(t){e.$set(e.formModel,"onTime",t)},expression:"formModel.onTime"}})],1),i("el-form-item",{attrs:{label:"行驶证"}},[i("div",{staticClass:"image-content"},[i("BizAvatarUploaderNew",{model:{value:e.formModel.carLicense.positiveImage,callback:function(t){e.$set(e.formModel.carLicense,"positiveImage",t)},expression:"formModel.carLicense.positiveImage"}}),i("BizAvatarUploaderNew",{model:{value:e.formModel.carLicense.backgroundImage,callback:function(t){e.$set(e.formModel.carLicense,"backgroundImage",t)},expression:"formModel.carLicense.backgroundImage"}}),i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!!e.formModel.id,expression:"!!formModel.id"}],attrs:{type:"primary",disabled:!e.formModel.carLicense.positiveImage&&!e.formModel.carLicense.backgroundImage,size:"mini"},on:{click:e.reject}},[e._v("驳回")])],1)],1)]),i("el-form-item",{attrs:{label:"营运"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","inactive-color":"#d9d9d9","active-color":"#87d068"},model:{value:e.formModel.isCV,callback:function(t){e.$set(e.formModel,"isCV",t)},expression:"formModel.isCV"}})],1),i("el-form-item",{attrs:{label:"登记的交管所"}},[i("el-input",{attrs:{maxlength:"16",placeholder:"请输入车辆所登记的交管所"},model:{value:e.formModel.trafficControl,callback:function(t){e.$set(e.formModel,"trafficControl",t)},expression:"formModel.trafficControl"}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.formModel.remarks,callback:function(t){e.$set(e.formModel,"remarks",t)},expression:"formModel.remarks"}})],1)],1),i("el-collapse-item",{attrs:{title:"所属店铺",name:"8"}},[i("el-table",{attrs:{size:"small",data:e.formModel.shops}},[i("el-table-column",{attrs:{label:"店铺名称",prop:"name"}}),i("el-table-column",{attrs:{label:"详细地址",prop:"address"}}),i("el-table-column",{attrs:{label:"销售电话",prop:"mobile"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleDeleteClick(t.row)}}},[e._v(" 删除 ")])]}}])})],1)],1),i("el-collapse-item",{attrs:{title:"技术信息",name:"2"}},[i("el-form-item",{attrs:{label:"车辆识别代号",prop:"vin"}},[i("div",{attrs:{slot:"label"},slot:"label"},[e._v(" 车辆识别代号 "),i("el-button",{directives:[{name:"popover",rawName:"v-popover:vinPop",arg:"vinPop"}],attrs:{type:"text",size:"small"}},[i("i",{staticClass:"iconfont el-icon-question"})]),i("el-popover",{ref:"vinPop",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"车辆识别代号，即车架号，具有对车辆的唯一识别性，因此可称为“汽车身份证”。您可在车辆行驶证上查询到此信息，也可打开发动机盖，在挡板上可看到此码。"}})],1),i("el-input",{attrs:{maxlength:"17",placeholder:"请输入车辆识别代号信息"},model:{value:e.formModel.vin,callback:function(t){e.$set(e.formModel,"vin",t)},expression:"formModel.vin"}})],1),i("el-form-item",{attrs:{label:"发动机号",prop:"engineNumber"}},[i("div",{attrs:{slot:"label"},slot:"label"},[e._v(" 发动机号 "),i("el-button",{directives:[{name:"popover",rawName:"v-popover:engineNumberPop",arg:"engineNumberPop"}],attrs:{type:"text",size:"small"}},[i("i",{staticClass:"iconfont el-icon-question"})]),i("el-popover",{ref:"engineNumberPop",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"您可在车辆行驶证上查询到此信息"}})],1),i("el-input",{attrs:{placeholder:"请输入发动机号信息"},model:{value:e.formModel.engineNumber,callback:function(t){e.$set(e.formModel,"engineNumber",t)},expression:"formModel.engineNumber"}})],1),i("el-form-item",{attrs:{label:"车身颜色"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.bodyColor,callback:function(t){e.$set(e.formModel,"bodyColor",t)},expression:"formModel.bodyColor"}},e._l(e.colorList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"车牌颜色"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.plateColor,callback:function(t){e.$set(e.formModel,"plateColor",t)},expression:"formModel.plateColor"}},e._l(e.colorList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"燃油编号"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.fuelGrade,callback:function(t){e.$set(e.formModel,"fuelGrade",t)},expression:"formModel.fuelGrade"}},e._l(e.fuelGradeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"变速箱类型"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.transmissionType,callback:function(t){e.$set(e.formModel,"transmissionType",t)},expression:"formModel.transmissionType"}},e._l(e.transmissionTypeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"排放标准"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.dischargeStandard,callback:function(t){e.$set(e.formModel,"dischargeStandard",t)},expression:"formModel.dischargeStandard"}},e._l(e.effluentStandardList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"生产日期"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择生产日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.productionTime,callback:function(t){e.$set(e.formModel,"productionTime",t)},expression:"formModel.productionTime"}})],1)],1),i("el-collapse-item",{attrs:{title:"终端信息",name:"3"}},[i("div",[i("biz-header",{attrs:{operations:e.ruleTableOperations},on:{operate:e.operateHandler}}),i("el-table",{staticClass:"cp-table",staticStyle:{width:"100%"},attrs:{data:e.formModel.terminals,size:"small"}},[i("el-table-column",{attrs:{prop:"terminalTypeName",label:"设备类型"}}),i("el-table-column",{attrs:{prop:"number",label:"设备编号"}}),i("el-table-column",{attrs:{prop:"title",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.rowEditClickHandler(t.row,i)}}},[e._v(" 编辑 ")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.rowDeleteClickHandler(i,t.row)}}},[e._v(" 删除 ")])]}}])})],1),i("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showRule,expression:"showRule"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[i("el-form",{ref:"ruleForm",attrs:{size:"small","label-width":"110px",model:e.ruleModel,rules:e.ruleRules}},[i("el-form-item",{attrs:{label:"设备编号",prop:"number"}},[i("el-autocomplete",{staticStyle:{width:"100%"},attrs:{value:e.ruleModel.number,"fetch-suggestions":e.handleRemote,placeholder:"请输入设备编号","trigger-on-focus":!1,"value-key":"number"},on:{select:e.handleNumberChange,input:e.handleNumberInput}})],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.systemList&&e.systemList.length>0,expression:"systemList && systemList.length > 0"}],attrs:{label:"电控系统"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleModel.diagnoseType,callback:function(t){e.$set(e.ruleModel,"diagnoseType",t)},expression:"ruleModel.diagnoseType"}},e._l(e.systemList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"通讯方式"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleModel.communicationType,callback:function(t){e.$set(e.ruleModel,"communicationType",t)},expression:"ruleModel.communicationType"}},e._l(e.commTypeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),i("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.ruleOperations},on:{operate:e.operateHandler}})],1)],1)]),i("el-collapse-item",{attrs:{title:"销售信息",name:"4"}},[i("el-form-item",{attrs:{label:"车辆销售公司"}},[i("el-input",{attrs:{placeholder:"请输入车辆销售公司"},model:{value:e.formModel.carSalesData.salesCompany,callback:function(t){e.$set(e.formModel.carSalesData,"salesCompany",t)},expression:"formModel.carSalesData.salesCompany"}})],1),i("el-form-item",{attrs:{label:"车辆销售单号",prop:"salesContractNumber"}},[i("el-input",{attrs:{maxlength:"16",placeholder:"请输入车辆销售单号"},model:{value:e.formModel.carSalesData.salesContractNumber,callback:function(t){e.$set(e.formModel.carSalesData,"salesContractNumber",t)},expression:"formModel.carSalesData.salesContractNumber"}})],1),i("el-form-item",{attrs:{label:"购买日期",prop:"purchaseTime"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择购买日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.carSalesData.purchaseTime,callback:function(t){e.$set(e.formModel.carSalesData,"purchaseTime",t)},expression:"formModel.carSalesData.purchaseTime"}})],1),i("el-form-item",{attrs:{label:"是否贷款"}},[i("el-radio-group",{model:{value:e.formModel.carSalesData.loanType,callback:function(t){e.$set(e.formModel.carSalesData,"loanType",t)},expression:"formModel.carSalesData.loanType"}},[i("el-radio",{attrs:{label:"0"}},[e._v("是")]),i("el-radio",{attrs:{label:"1"}},[e._v("否")]),i("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),i("el-form-item",{attrs:{label:"销售公司电话",prop:"salesCompanyPhone"}},[i("el-input",{attrs:{type:"phone",maxlength:"12",placeholder:"请输入销售公司电话"},model:{value:e.formModel.carSalesData.salesCompanyPhone,callback:function(t){e.$set(e.formModel.carSalesData,"salesCompanyPhone",t)},expression:"formModel.carSalesData.salesCompanyPhone"}})],1),i("el-form-item",{attrs:{label:"销售员"}},[i("el-input",{attrs:{placeholder:"请输入销售员"},model:{value:e.formModel.carSalesData.salesStaff,callback:function(t){e.$set(e.formModel.carSalesData,"salesStaff",t)},expression:"formModel.carSalesData.salesStaff"}})],1),i("el-form-item",{attrs:{label:"销售员电话",prop:"salesStaffPhone"}},[i("el-input",{attrs:{type:"phone",maxlength:"13",placeholder:"请输入销售员电话"},model:{value:e.formModel.carSalesData.salesStaffPhone,callback:function(t){e.$set(e.formModel.carSalesData,"salesStaffPhone",t)},expression:"formModel.carSalesData.salesStaffPhone"}})],1)],1),i("el-collapse-item",{attrs:{title:"质保信息",name:"5"}},[i("el-form-item",{attrs:{label:"质保起始日期",prop:"purchaseTime"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择保起始日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",clearable:!1},model:{value:e.qualityAssuranceDate,callback:function(t){e.qualityAssuranceDate=t},expression:"qualityAssuranceDate"}})],1),i("div",{staticClass:"zbxx"},[i("el-form-item",{staticClass:"isRequired",attrs:{label:"质保期",prop:"qualityAssuranceTime"}},[i("el-input",{model:{value:e.formModel.carQualityAssurance.time,callback:function(t){e.$set(e.formModel.carQualityAssurance,"time",t)},expression:"formModel.carQualityAssurance.time"}},[i("template",{slot:"append"},[e._v("年")])],2)],1),i("el-form-item",{attrs:{label:"或","label-width":"40px",prop:"qualityAssuranceDrivingRange"}},[i("el-input",{model:{value:e.formModel.carQualityAssurance.drivingRange,callback:function(t){e.$set(e.formModel.carQualityAssurance,"drivingRange",t)},expression:"formModel.carQualityAssurance.drivingRange"}},[i("template",{slot:"append"},[e._v("公里")])],2)],1)],1),i("el-form-item",{attrs:{label:"质保截止日期",prop:"purchaseTime"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择质保截止日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:""},model:{value:e.qualityAssuranceEndDate,callback:function(t){e.qualityAssuranceEndDate=t},expression:"qualityAssuranceEndDate"}})],1)],1),i("el-collapse-item",{attrs:{title:"保险信息",name:"6"}},[i("el-form-item",{attrs:{label:"投保公司"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择投保公司"},on:{change:e.handleInsuranceChange},model:{value:e.formModel.carInsurance.insuranceCompany,callback:function(t){e.$set(e.formModel.carInsurance,"insuranceCompany",t)},expression:"formModel.carInsurance.insuranceCompany"}},e._l(e.insuranceList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),i("el-form-item",{attrs:{label:"保单号码",prop:"insurancePolicyNumber"}},[i("el-input",{attrs:{maxlength:"20",placeholder:"请输入保单号码"},model:{value:e.formModel.carInsurance.insurancePolicyNumber,callback:function(t){e.$set(e.formModel.carInsurance,"insurancePolicyNumber",t)},expression:"formModel.carInsurance.insurancePolicyNumber"}})],1),i("el-form-item",{attrs:{label:"保单生效日期"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择保单生效日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.formModel.carInsurance.policyEffectiveDate,callback:function(t){e.$set(e.formModel.carInsurance,"policyEffectiveDate",t)},expression:"formModel.carInsurance.policyEffectiveDate"}})],1),i("el-form-item",{attrs:{label:"保单失效日期",prop:"policyExpiryDate"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择保单失效日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.formModel.carInsurance.policyExpiryDate,callback:function(t){e.$set(e.formModel.carInsurance,"policyExpiryDate",t)},expression:"formModel.carInsurance.policyExpiryDate"}})],1),i("el-form-item",{attrs:{label:"客服电话",prop:"customerServicePhone"}},[i("el-input",{attrs:{type:"phone",maxlength:"12"},model:{value:e.formModel.carInsurance.customerServicePhone,callback:function(t){e.$set(e.formModel.carInsurance,"customerServicePhone",t)},expression:"formModel.carInsurance.customerServicePhone"}})],1),i("el-form-item",{attrs:{label:"理赔员姓名"}},[i("el-input",{attrs:{placeholder:"请输入理赔员姓名"},model:{value:e.formModel.carInsurance.claimMemberName,callback:function(t){e.$set(e.formModel.carInsurance,"claimMemberName",t)},expression:"formModel.carInsurance.claimMemberName"}})],1),i("el-form-item",{attrs:{label:"理赔员电话",prop:"claimMemberPhone"}},[i("el-input",{attrs:{type:"phone",maxlength:"13",placeholder:"请输入理赔员电话"},model:{value:e.formModel.carInsurance.claimMemberPhone,callback:function(t){e.$set(e.formModel.carInsurance,"claimMemberPhone",t)},expression:"formModel.carInsurance.claimMemberPhone"}})],1),i("el-form-item",{attrs:{label:"保单详细信息"}},[i("el-input",{attrs:{placeholder:"请输入保单详细信息"},model:{value:e.formModel.carInsurance.insuranceDetails,callback:function(t){e.$set(e.formModel.carInsurance,"insuranceDetails",t)},expression:"formModel.carInsurance.insuranceDetails"}})],1),i("el-form-item",{attrs:{label:"保单说明"}},[i("el-input",{attrs:{placeholder:"请输入保单说明"},model:{value:e.formModel.carInsurance.policyDescription,callback:function(t){e.$set(e.formModel.carInsurance,"policyDescription",t)},expression:"formModel.carInsurance.policyDescription"}})],1)],1),i("el-collapse-item",{attrs:{title:"保养信息",name:"7"}},[i("el-form-item",{attrs:{label:"车辆里程(km)",prop:"nowDrivingRange"}},[i("el-input",{attrs:{"controls-position":"right",placeholder:"请输入车辆里程"},model:{value:e.formModel.drivingRange,callback:function(t){e.$set(e.formModel,"drivingRange",t)},expression:"formModel.drivingRange"}})],1),i("el-form-item",{attrs:{label:"保养日期"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择保养日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.carMaintain.happenDate,callback:function(t){e.$set(e.formModel.carMaintain,"happenDate",t)},expression:"formModel.carMaintain.happenDate"}})],1),i("el-form-item",{attrs:{label:"上次保养里程(km)",prop:"drivingRange"}},[i("el-input",{attrs:{"controls-position":"right",placeholder:"请输入上次保养里程"},model:{value:e.formModel.carMaintain.drivingRange,callback:function(t){e.$set(e.formModel.carMaintain,"drivingRange",t)},expression:"formModel.carMaintain.drivingRange"}})],1),i("el-form-item",{attrs:{label:"保养间隔里程(km)",prop:"drivingRangeGap"}},[i("el-input",{attrs:{"controls-position":"right"},model:{value:e.formModel.carMaintain.drivingRangeGap,callback:function(t){e.$set(e.formModel.carMaintain,"drivingRangeGap",t)},expression:"formModel.carMaintain.drivingRangeGap"}})],1)],1)],1)],1)],1)},a=[],s=(i("99af"),i("4160"),i("c975"),i("a434"),i("b0c0"),i("d3b7"),i("4d63"),i("ac1f"),i("25f0"),i("159b"),i("8330")),o=i("c365"),n=i("04d3"),l=i("c466"),c=i("0e5e"),d=i("c17f"),p=i("1ab1"),u={name:"VehicleBaseInfoContent",components:{BizSaveButton:s["a"],PeoplePicker:o["a"],BizHeader:n["d"],BizAvatarUploaderNew:d["b"]},data:function(){var e=this;return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},rules:{plateNumber:[{required:!0,message:"请输入车牌号码",trigger:"blur"},{trigger:"blur",validator:function(t,i,r){var a=/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1,2}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/;a.test(e.formModel.plateNumber)?r():r(new Error("车牌号格式错误"))}}],vin:[{trigger:"blur",validator:function(t,i,r){e.formModel.vin&&e.$set(e.formModel,"vin",e.formModel.vin.toUpperCase());var a=/^[A-Z0-9]{17}$/;!e.formModel.vin||a.test(e.formModel.vin)?r():r(new Error("车辆识别代号格式错误"))}}],engineNumber:[{trigger:"blur",validator:function(t,i,r){e.formModel.engineNumber&&e.$set(e.formModel,"engineNumber",e.formModel.engineNumber.toUpperCase());var a=/^[a-zA-Z0-9]{6,14}$/;!e.formModel.engineNumber||a.test(e.formModel.engineNumber)?r():r(new Error("发动机号格式错误"))}}],salesContractNumber:[{trigger:"blur",validator:function(t,i,r){e.formModel.carSalesData&&e.formModel.carSalesData.salesContractNumber&&e.$set(e.formModel.carSalesData,"salesContractNumber",e.formModel.carSalesData.salesContractNumber.toUpperCase());var a=/^[A-Z0-9]*$/;e.formModel.carSalesData&&e.formModel.carSalesData.salesContractNumber&&!a.test(e.formModel.carSalesData.salesContractNumber)?r(new Error("车辆销售单号格式错误")):r()}}],salesStaffPhone:[{trigger:"blur",validator:function(t,i,r){var a=/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/;!e.formModel.carSalesData.salesStaffPhone||a.test(e.formModel.carSalesData.salesStaffPhone)?r():r(new Error("销售员电话格式错误"))}}],customerServicePhone:[{trigger:"blur",validator:function(t,i,r){var a=/^[0-9]\d*$/;!e.formModel.carInsurance.customerServicePhone||a.test(e.formModel.carInsurance.customerServicePhone)?r():r(new Error("客服电话格式错误"))}}],claimMemberPhone:[{trigger:"blur",validator:function(t,i,r){var a=/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/;!e.formModel.carInsurance.claimMemberPhone||a.test(e.formModel.carInsurance.claimMemberPhone)?r():r(new Error("理赔员电话格式错误"))}}],insurancePolicyNumber:[{trigger:"blur",validator:function(t,i,r){var a=/^[A-Z0-9]*$/;!e.formModel.carInsurance.insurancePolicyNumber||a.test(e.formModel.carInsurance.insurancePolicyNumber)?r():r(new Error("保单号码格式错误"))}}],policyExpiryDate:[{trigger:"blur",validator:function(t,i,r){e.formModel.carInsurance.policyExpiryDate&&e.formModel.carInsurance.policyEffectiveDate&&e.formModel.carInsurance.policyExpiryDate<=e.formModel.carInsurance.policyEffectiveDate?r(new Error("保单失效日期要晚于保单生效日期")):r()}}],purchaseTime:[{trigger:"blur",validator:function(t,i,r){e.formModel.carSalesData.purchaseTime&&e.formModel.productionTime&&e.formModel.carSalesData.purchaseTime<e.formModel.productionTime?r(new Error("购买日期要晚于生产日期")):r()}}],nowDrivingRange:[{trigger:"blur",validator:function(t,i,r){var a=new RegExp(/^\+?[0-9][0-9]*$/);e.formModel.drivingRange&&!a.test(e.formModel.drivingRange)?r(new Error("请输入整数")):r()}}],drivingRange:[{trigger:"blur",validator:function(t,i,r){var a=new RegExp(/^\+?[0-9][0-9]*$/);e.formModel.carMaintain.drivingRange&&!a.test(e.formModel.carMaintain.drivingRange)?r(new Error("请输入整数")):r()}}],drivingRangeGap:[{trigger:"blur",validator:function(t,i,r){var a=new RegExp(/^\+?[0-9][0-9]*$/);e.formModel.carMaintain.drivingRangeGap&&!a.test(e.formModel.carMaintain.drivingRangeGap)?r(new Error("请输入整数")):r()}}],qualityAssuranceTime:[{required:!1,message:"请输入质保期",trigger:"blur"},{trigger:"blur",validator:function(t,i,r){var a=new RegExp(/^\+?[1-9][0-9]*$/);e.formModel.carQualityAssurance.time&&!a.test(e.formModel.carQualityAssurance.time)?r(new Error("请输入一个大于0的整数")):e.formModel.carQualityAssurance.time?r():r(new Error("请输入质保期"))}}],qualityAssuranceDrivingRange:[{required:!1,message:"请输入里程",trigger:"blur"},{trigger:"blur",validator:function(t,i,r){var a=new RegExp(/^\+?[1-9][0-9]*$/);e.formModel.carQualityAssurance.drivingRange&&!a.test(e.formModel.carQualityAssurance.drivingRange)?r(new Error("请输入一个大于0的整数")):e.formModel.carQualityAssurance.drivingRange?r():r(new Error("请输入里程"))}}]},shopList:[],brandList:[],seriesList:[],modeList:[],stateList:[],transmissionTypeList:[],plateNumberTypeList:[],colorList:[],fuelGradeList:[],effluentStandardList:[],systemList:[],commTypeList:[],insuranceList:[],formModel:this.getDefaultModel(),activeNames:["1"],ruleTableOperations:[{label:"新建",name:"addOperate",type:"primary"}],showRule:!1,ruleModel:this.getDefaultRuleModel(),ruleOperations:[{label:"取消",name:"cancelRuleOperate"},{label:"保存",name:"saveRuleOperate",type:"primary",auth:["admin:car.edit"]}],ruleRules:{number:[{required:!0,trigger:"blur",validator:function(t,i,r){e.ruleModel.number?r():r(new Error("请选择终端"))}},{trigger:["blur"],validator:function(t,i,r){e.checkNumber(e.ruleModel.number,r)}}]},selectLoading:!1,terminalList:[]}},props:{itemId:{type:Object,default:function(){return{id:""}}},memberId:{type:Object}},created:function(){this.queryShopList(),this.queryBrandList(),this.queryInsuranceList(),this.queryDimList(),this.effluentStandardList=["国Ⅰ","国Ⅱ","国Ⅲ","国Ⅳ","国Ⅴ","国Ⅵ","欧Ⅰ","欧Ⅱ","欧Ⅲ","欧Ⅳ","欧Ⅴ"],this.commTypeList=[{id:"0",name:"自动切换"},{id:"1",name:"网络"},{id:"2",name:"蓝牙"},{id:"3",name:"WIFI"},{id:"4",name:"GPRS"},{id:"5",name:"3G"},{id:"6",name:"4G"}],this.deletedRules=[]},methods:{reject:function(){var e=this;p["a"].put("/admin/car/carLicense/state.jhtml",{id:this.formModel.id}).then((function(t){e.$message.success("驳回成功"),e.$emit("operationSuccess"),e.formModel.carLicense.positiveImage="",e.formModel.carLicense.backgroundImage=""})).catch((function(t){console.log(t),e.$message.warning(t.errorMessage)}))},handleDeleteClick:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,p["a"].delete("/admin/car/relateShop.jhtml",{shopId:e.id,id:t.itemId.id}).then((function(i){t.formModel.shops.splice(t.formModel.shops.indexOf(e),1),t.$message.success("删除成功"),t.$emit("operationSuccess")})).catch((function(e){console.log(e),console.log("code错误"),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},queryShopList:function(){var e=this;c["a"].queryShopList({},(function(t){e.shopList=t.storeList}),(function(e){console.log(e),console.log("code错误")}))},queryBrandList:function(){var e=this;c["a"].queryBrandList({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;c["a"].querySeriesList({brand:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;c["a"].queryTypeList({series:e,brand:this.formModel.brand},(function(e){t.modeList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryInsuranceList:function(){var e=this;c["a"].queryInsuranceList({},(function(t){e.insuranceList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryDimList:function(){var e=this;c["a"].queryDimList({},(function(t){e.stateList=t.carStateList,e.transmissionTypeList=t.transmissionTypeList,e.plateNumberTypeList=t.plateNumberTypeList,e.colorList=t.colorList,e.fuelGradeList=t.fuelGradeList}),(function(e){console.log(e),console.log("code错误")}))},getSaveParams:function(){var e=[];e=e.concat(this.formModel.terminals);var t=this.deletedRules,i=[];return e.forEach((function(e){i.push(e.number)})),t.forEach((function(t){i.indexOf(t.number)<0&&e.push({terminalType:t.terminalType,type:t.type})})),this.formModel.carQualityAssurance.qualityAssuranceDate=this.qualityAssuranceDate,this.formModel.carQualityAssurance.qualityAssuranceEndDate=this.qualityAssuranceEndDate,{id:this.formModel.id,plateNumber:this.formModel.plateNumber,brand:this.formModel.brand,series:this.formModel.series,type:this.formModel.type,member:this.memberId?this.memberId:this.formModel.member,shop:this.formModel.shop,state:this.formModel.state,onTime:this.formModel.onTime,isCV:this.formModel.isCV,trafficControl:this.formModel.trafficControl,remarks:this.formModel.remarks,drivingRange:this.formModel.drivingRange,carshipId:this.formModel.carshipId,vin:this.formModel.vin,engineNumber:this.formModel.engineNumber,bodyColor:this.formModel.bodyColor,plateColor:this.formModel.plateColor,fuelGrade:this.formModel.fuelGrade,carLicense:this.formModel.carLicense,transmissionType:this.formModel.transmissionType,dischargeStandard:this.formModel.dischargeStandard,productionTime:this.formModel.productionTime,terminals:e,carSalesData:this.formModel.carSalesData,carInsurance:this.formModel.carInsurance,carMaintain:this.formModel.carMaintain,carQualityAssurance:this.formModel.carQualityAssurance}},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return{member:{id:"",name:""},bodyColor:"2",plateColor:"0",fuelGrade:"1",carLicense:{positiveImage:"",backgroundImage:""},transmissionType:"2",dischargeStandard:"国5",shop:{id:"",name:""},engineNumber:"",carSalesData:{salesCompanyPhone:"",salesStaffPhone:""},carInsurance:{insuranceCompany:"",customerServicePhone:"",claimMemberPhone:""},carMaintain:{drivingRangeGap:""},carQualityAssurance:{drivingRange:"60000",qualityAssuranceDate:"",qualityAssuranceEndDate:"",time:"3",carId:"",id:""},terminals:[]}},operateHandler:function(e){this[e]()},handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.formModel,"series",""),this.$set(this.formModel,"type","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.formModel,"type","")},save:function(){var e=this;this.$refs.form.validate((function(t,i){return t?e.formModel.backgroundImage&&!e.formModel.positiveImage||!e.formModel.backgroundImage&&e.formModel.positiveImage?(e.$message.warning("驾驶证正反面图片都需要上传"),!1):(e.$emit("on-loading",!0),void(e.formModel.id?c["a"].update(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.$emit("on-loading",!1)}),(function(t){e.$message.warning(t.errorMessage),e.$emit("on-loading",!1)})):c["a"].add(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.$emit("on-loading",!1)}),(function(t){e.$message.warning(t.errorMessage),e.$emit("on-loading",!1)})))):(e.$message.warning("车辆信息输入有误，请修改"),e.activeNames=["1","2","4","5","6"],!1)}))},handleInsuranceChange:function(e){var t=this;this.insuranceList.forEach((function(i){i.name===e&&t.$set(t.formModel.carInsurance,"customerServicePhone",i.phoneNumber)}))},getDefaultRuleModel:function(){return{number:"",diagnoseType:"",communicationType:"0"}},rowEditClickHandler:function(e,t,i){t.stopPropagation(),this.systemList=e.diagnoseTypes?e.diagnoseTypes:[],this.terminalList=[],this.ruleModel=Object.assign({},e),this.showRule=!0,this.$refs.ruleForm.resetFields()},rowDeleteClickHandler:function(e,t){var i=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.formModel.terminals.forEach((function(e,r){e.number===t.number&&i.formModel.terminals.splice(r,1)})),i.deletedRules.push(t)}))},addOperate:function(){this.resetRuleModel(),this.showRule=!0,this.$refs.ruleForm.resetFields()},resetRuleModel:function(){this.systemList=[],this.terminalList=[],this.ruleModel=this.getDefaultRuleModel()},cancelRuleOperate:function(){this.showRule=!1},saveRuleOperate:function(){var e=this;this.$refs.ruleForm.validate((function(t,i){if(!t)return!1;var r=!1;e.formModel.terminals.forEach((function(t,i){t.number===e.ruleModel.number&&(e.formModel.terminals.splice(i,1,e.getRuleParams()),r=!0)})),r||e.formModel.terminals.push(e.getRuleParams()),e.showRule=!1}))},getRuleParams:function(){return Object.assign({},this.ruleModel)},checkNumber:function(e,t){var i=this;c["a"].queryTerminalInfo({sn:e,carId:this.itemId.id,shopId:window.top.SHOP_ID},(function(e){i.systemList=e.diagnoseTypes?e.diagnoseTypes:[],e.diagnoseType=i.systemList.length>0?i.systemList[0]:"";for(var r=0;r<i.systemList.length;r++)if(i.systemList[r]===i.ruleModel.diagnoseType){e.diagnoseType=i.systemList[r];break}Object.assign(i.ruleModel,e),t()}),(function(e){console.log("ERROR_QUERY",e),i.systemList=[],i.$set(i.ruleModel,"diagnoseType",""),t(new Error(e.errorMessage))}))},handleNumberChange:function(e){this.$set(this.ruleModel,"number",e.number),this.$refs.ruleForm.clearValidate()},handleNumberInput:function(e){this.$set(this.ruleModel,"number",e)},handleRemote:function(e,t){e?this.queryTerminalList(e,t):this.terminalList=[]},queryTerminalList:function(e,t){var i=this;this.$emit("on-loading",!0),c["a"].queryTerminalList({number:e},(function(e){t(e.dataList),i.$emit("on-loading",!1)}),(function(e){console.log(e),console.log("code错误"),i.$emit("on-loading",!1)}))}},computed:{point:{get:function(){return{lng:this.formModel.lngBaidu,lat:this.formModel.latBaidu}},set:function(e){e&&(this.formModel.lngBaidu=e.lng,this.formModel.latBaidu=e.lat)}},qualityAssuranceDate:{get:function(){return!this.formModel.carQualityAssurance.qualityAssuranceDate&&this.formModel.onTime?this.formModel.onTime:this.formModel.carQualityAssurance.qualityAssuranceDate},set:function(e){e&&(this.formModel.carQualityAssurance.qualityAssuranceDate=e)}},qualityAssuranceEndDate:{get:function(){return!this.formModel.carQualityAssurance.qualityAssuranceEndDate&&this.qualityAssuranceDate&&this.formModel.carQualityAssurance.time?l["a"].lastNYearDate(this.qualityAssuranceDate,this.formModel.carQualityAssurance.time):this.formModel.carQualityAssurance.qualityAssuranceEndDate},set:function(e){e&&(this.formModel.carQualityAssurance.qualityAssuranceEndDate=e)}}},watch:{itemId:function(e,t){var i=this;this.$refs.form.$el.scrollTop=0,console.log(e),e.id?(this.$emit("on-loading",!0),c["a"].query({carId:e.id,carShipId:e.carShipId},(function(e){var t=Object.assign(i.getDefaultModel(),e.car);i.formModel=t,i.querySeriesList(i.formModel.brand),i.queryTypeList(i.formModel.series),i.$refs.form.resetFields(),i.activeNames=["1"],i.deletedRules=[],i.$emit("on-loading",!1),i.showRule=!1}),(function(e){console.log(e),console.log("code错误"),i.$emit("on-loading",!1)}))):(this.resetModel(),this.$refs.form.$el.scrollTop=0,this.$refs.form.resetFields(),this.activeNames=["1"])}}},m=u,f=(i("d158"),i("2877")),h=Object(f["a"])(m,r,a,!1,null,null,null);t["a"]=h.exports},3772:function(e,t,i){},"3f67":function(e,t,i){},"408a":function(e,t,i){var r=i("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=r(e))throw TypeError("Incorrect invocation");return+e}},"443b":function(e,t,i){"use strict";i("4de4");var r=i("c596"),a=i("1ab1"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{"append-to-body":"",visible:e.visible,title:"自定义列","custom-class":"biz-columns",width:"500px"},on:{close:e.onClose}},[i("div",{staticClass:"columns-wrap"},[i("biz-flex-table",{ref:"table",attrs:{checkable:!1,tableData:e.tableData},on:{"selection-change":e.selectionChangeHandler}},[i("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.getSelectable}}),i("el-table-column",{attrs:{label:"信息",prop:"name"}}),i("el-table-column",{attrs:{prop:"tag",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index;return[i("el-button",{attrs:{icon:"el-icon-sort-up",type:"text",disabled:0===r},on:{click:function(t){return e.onUp(r)}}}),i("el-button",{attrs:{icon:"el-icon-sort-down",type:"text",disabled:r===e.tableData.length-1},on:{click:function(t){return e.onBottom(r)}}})]}}])})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.onClose}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)])},o=[],n=(i("7db0"),i("a434"),i("b85c")),l=i("04d3"),c={name:"biz-columns",components:{BizFlexTable:l["c"]},props:{visible:Boolean,tableId:String},data:function(){return{id:"",tableName:"",selections:[],tableData:[]}},computed:{},watch:{visible:function(e){e?this.makeRowDisplayable():this.saveSelection()},tableId:function(){this.getTableColumns()}},mounted:function(){this.getTableColumns()},methods:{getTableColumns:function(){var e=this;a["a"].get(r["g"].user.columns,{tableId:this.tableId}).then((function(t){e.tableData=t.data.columnDatas,e.id=t.data.id,e.tableName=t.data.tableName}))},getSelectable:function(e){return e.isEditable},selectionChangeHandler:function(e){this.selections=e},saveSelection:function(){var e,t=this,i=Object(n["a"])(this.tableData);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.displayable=!1}}catch(l){i.e(l)}finally{i.f()}var a,s=Object(n["a"])(this.selections);try{var o=function(){var e=a.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(s.s();!(a=s.n()).done;)o()}catch(l){s.e(l)}finally{s.f()}},onUp:function(e){this.tableData[e]=this.tableData.splice(e-1,1,this.tableData[e])[0]},onBottom:function(e){this.tableData[e]=this.tableData.splice(e+1,1,this.tableData[e])[0]},onClose:function(){this.$emit("update:visible",!1)},update:function(){var e,t=this,i=Object(n["a"])(this.tableData);try{for(i.s();!(e=i.n()).done;){var s=e.value;s.displayable=!1}}catch(p){i.e(p)}finally{i.f()}var o,l=Object(n["a"])(this.selections);try{var c=function(){var e=o.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(l.s();!(o=l.n()).done;)c()}catch(p){l.e(p)}finally{l.f()}var d={columnDatas:this.tableData,id:this.id,tableId:this.tableId,tableName:this.tableName};console.log(d),a["a"].put(r["g"].user.columns,d).then((function(e){t.$emit("update"),t.$emit("update:visible",!1)}))},makeRowDisplayable:function(){var e=this;setTimeout((function(){var t,i=Object(n["a"])(e.tableData);try{for(i.s();!(t=i.n()).done;){var r=t.value;e.$refs.table.$refs.table.toggleRowSelection(r,r.displayable)}}catch(a){i.e(a)}finally{i.f()}}),20)}}},d=c,p=(i("ec6b"),i("2877")),u=Object(p["a"])(d,s,o,!1,null,null,null),m=u.exports,f=m;t["a"]={components:{BizColumnOperation:l["a"],BizColumns:f},data:function(){return{columnsSettingVisible:!1,columns:[]}},created:function(){this.getTableId(),this.getColumns()},methods:{onCustomColumns:function(){this.columnsSettingVisible=!0},getColumns:function(){var e=this;console.log(12),a["a"].get(r["A"].columns,{tableId:this.tableId}).then((function(t){e.columns=[],setTimeout((function(){e.columns=t.data.columnDatas.filter((function(e){return e.displayable})),e.$refs.table&&setTimeout((function(){e.$refs.table.doLayout()}),50)}),20)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getTableId:function(){}}}},"44e3":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"bill-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return i("el-card",{key:t.id},[i("div",{on:{click:function(i){return e.selectItem(t)}}},[i("div",{staticClass:"top"},[i("span",[e._v(e._s(t.consignee))]),i("span",[e._v(e._s(t.phone))])]),i("div",{staticClass:"content"},[i("span",[e._v(e._s(t.areaName+t.address))])])]),i("div",{staticClass:"bottom"},["1"===t.isDefault?i("div",[e._v("默认")]):e._e(),"0"===t.isDefault?i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(i){e.$set(t,"isDefault",i)},expression:"receiver.isDefault"}},[e._v("设为默认")]):e._e(),i("div",{staticClass:"handler"},[i("i",{staticClass:"el-icon-edit-outline",on:{click:function(i){return e.editForm(t)}}},[e._v("编辑")]),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"省市"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},a=[],s=(i("d3b7"),i("5530")),o=i("f36f"),n=i("8330"),l=i("1ab1"),c=i("c596"),d=i("2f62"),p=i("ce2e"),u=i("f260"),m=i.n(u),f={components:{BizSaveButton:n["a"],BizAreaSelect:p["a"],BizGrid:o["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(s["a"])(Object(s["a"])({},Object(d["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+m.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(s["a"])(Object(s["a"])({},Object(d["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"].delete(c["g"].hypermarketMgmt.receiver,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].post(c["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].put(c["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};l["a"].get(c["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},h=f,g=(i("6116"),i("2877")),v=Object(g["a"])(h,r,a,!1,null,null,null);t["a"]=v.exports},"46fc":function(e,t,i){"use strict";i("ac1f"),i("1276");t["a"]=function(e,t){if(!e||!t)return 0;var i=t.split(":"),r=e.split(":"),a=60*(r[0]-i[0])+(r[1]-i[1]);return a<0?0:a}},4837:function(e,t,i){"use strict";var r=i("5f95"),a=i.n(r);a.a},"4d9f":function(e,t,i){},"50c2":function(e,t,i){"use strict";var r=i("4d9f"),a=i.n(r);a.a},"517a":function(e,t,i){e.exports=i.p+"static/img/pic_default_fail_100.b6b0849d.png"},"556a":function(e,t,i){"use strict";var r=i("2518"),a=i.n(r);a.a},5719:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"invoice-info-sale"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.invoiceList,(function(t){return i("el-card",{key:t.id},[i("div",[i("div",{staticClass:"radio-i",on:{click:function(i){return e.applyFor(t)}}},[i("el-radio",{attrs:{label:"1",size:"mini"},on:{change:function(i){return e.selectChange(t)}},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"invoice.checked"}},[i("span",{staticStyle:{color:"#ffffff"}},[e._v(".")])]),i("div",[i("div",{staticClass:"default"},[i("span",[e._v("发票抬头：")]),i("span",[e._v(e._s(t.invoiceTitle))]),"1"===t.isDefault?i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"mini"}},[e._v("默认")]):e._e()],1),i("div",{staticStyle:{"padding-top":"10px"}},[i("span",[e._v("发票类型：")]),i("span",[e._v(e._s("0"===t.invoiceType?"个人":"1"===t.invoiceType?"增值税普通发票":"2"===t.invoiceType?"增值税专用发票":""))])]),i("div",{staticStyle:{padding:"10px 0px"}},[i("span",[e._v("联系人：")]),i("span",[e._v(e._s(t.contacts))])]),i("div",[i("span",[e._v("联系电话：")]),i("span",[e._v(e._s(t.mobile))])]),i("div",{staticClass:"content-d"},[i("span",[e._v("详细地址：")]),i("span",[e._v(e._s(t.areaName+t.address))])])])],1),i("div",{staticClass:"bottom-d"},["0"===t.isDefault?i("span",{on:{click:function(i){return i.stopPropagation(),e.setDefault(t)}}},[e._v("设为默认")]):e._e(),i("span",{on:{click:function(i){return i.stopPropagation(),e.editForm(t)}}},[e._v("编辑")]),i("span",{on:{click:function(i){return i.stopPropagation(),e.deleteForm(t.id)}}},[e._v("删除")])])])])})),0===e.invoiceList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"发票信息"}}),i("el-form-item",{attrs:{label:"发票类型",prop:"consignee"}},[i("el-select",{staticStyle:{width:"220px"},model:{value:e.form.invoiceType,callback:function(t){e.$set(e.form,"invoiceType",t)},expression:"form.invoiceType"}},[i("el-option",{attrs:{label:"个人",value:"0"}}),i("el-option",{attrs:{label:"增值税普通发票",value:"1"}}),i("el-option",{attrs:{label:"增值税专用发票",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"发票抬头",prop:"invoiceTitle"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.invoiceTitle,callback:function(t){e.$set(e.form,"invoiceTitle",t)},expression:"form.invoiceTitle"}})],1),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"纳税人识别号",prop:"code"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"注册地址",prop:"registerAddress"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.registerAddress,callback:function(t){e.$set(e.form,"registerAddress",t)},expression:"form.registerAddress"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"注册电话",prop:"registerMobile"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.registerMobile,callback:function(t){e.$set(e.form,"registerMobile",t)},expression:"form.registerMobile"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.bank,callback:function(t){e.$set(e.form,"bank",t)},expression:"form.bank"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"银行账户",prop:"account"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1):e._e(),i("el-form-item",{attrs:{label:"邮寄地址"}}),i("el-form-item",{attrs:{label:"联系人",prop:"contacts"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.contacts,callback:function(t){e.$set(e.form,"contacts",t)},expression:"form.contacts"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"所在地区"}},[i("biz-area-select",{staticStyle:{width:"220px"},attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},a=[],s=(i("d81d"),i("a9e3"),i("d3b7"),i("5530")),o=i("8330"),n=i("1ab1"),l=i("c596"),c=i("2f62"),d=i("ce2e"),p=i("f260"),u=i.n(p),m={components:{BizSaveButton:o["a"],BizAreaSelect:d["a"]},data:function(){return{invoiceList:[],invoiceInfoId:"",checked:"1",showForm:!1,dialogVisiable:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{invoiceType:[{required:!0,message:"请输入发票类型",trigger:"blur"}],invoiceTitle:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],code:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入注册地址",trigger:"blur"}],registerMobile:[{required:!0,message:"请输入注册电话",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],account:[{required:!0,message:"请输入银行账户",trigger:"blur"}],contacts:[{required:!0,message:"请输入联系人",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},props:{orderIds:{type:Array},invoiceAmount:{type:Number}},computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+u.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(s["a"])(Object(s["a"])({},Object(c["d"])("Order",["updateCurInvoice"])),{},{operate:function(e){this[e]()},applyFor:function(e){this.invoiceInfoId=e.id,this.$emit("selectedInvoice",e),this.updateCurInvoice(e)},cancle:function(){this.dialogVisiable=!1},close:function(){this.dialogVisiable=!1,this.$emit("close")},selectChange:function(e){this.invoiceList.map((function(t){t.id!==e.id&&(t.checked="0")}))},getDetaultModel:function(){return{account:"",address:"",areaId:"",area:{id:"1568"},areaName:"",bank:"",code:"",contacts:"",invoiceTitle:"",invoiceType:"0",isDefault:"",mobile:"",registerAddress:"",registerMobile:""}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除发票?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["a"].delete(l["g"].hypermarketMgmt.invoiceInfo,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,invoice:this.form};n["a"].post(l["g"].hypermarketMgmt.invoiceInfo,t).then((function(t){e.$message.success("添加成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateCurInvoice(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,invoice:this.form};n["a"].put(l["g"].hypermarketMgmt.invoiceInfo,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateCurInvoice(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};n["a"].get(l["g"].hypermarketMgmt.invoiceInfos,t).then((function(t){e.invoiceList=t.invoices||[],e.invoiceList.map((function(t){e.$set(t,"checked",t.isDefault)}))})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},f=m,h=(i("90b3"),i("2877")),g=Object(h["a"])(f,r,a,!1,null,null,null);t["a"]=g.exports},5796:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"order-mgmt-list-p"},[i("div",{staticClass:"toggle-btn",on:{click:e.isShow}},[e._v(" "+e._s(e.toggleRecommendTxt)+" "),i("div",{staticClass:"iconfont biz-icon-i-web-zd1",class:{"rotate-180":e.showRecommend}})]),i("biz-flex-table",{ref:"table",staticClass:"order-mgmt-tabel",attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,loading:e.loading,pagination:e.pagination,isMergeInvoice:!0,showSummary:!0},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"selection-change":e.handleSelectionChange,select:e.select,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[i("div",{staticClass:"operate-container",attrs:{slot:"operation"},slot:"operation"},[i("el-radio-group",{attrs:{size:"mini"},on:{change:e.onChangeDateType},model:{value:e.curSelectDateType,callback:function(t){e.curSelectDateType=t},expression:"curSelectDateType"}},e._l(e.dateTypeList,(function(t){return i("el-radio-button",{key:t,attrs:{label:t}},[e._v(e._s(t))])})),1)],1),i("el-table-column",{attrs:{label:"订单信息","min-width":"215px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"order-content"},[i("div",{staticStyle:{display:"flex"}},[i("div",{staticClass:"customer-info"},[e._v(e._s(t.row.sn))]),"purchaseOrder"===t.row.dType?i("i",{staticClass:"iconfont biz-icon-i-web-md",staticStyle:{"font-size":"32px",color:"#ff7300"}}):e._e(),"1"===t.row.isMerged?i("i",{staticClass:"iconfont biz-icon-i-web-bing",staticStyle:{"font-size":"30px",color:"#ff7300"}}):e._e(),"1"===t.row.isTransfered?i("i",{staticClass:"iconfont biz-icon-i-web-zhuan",staticStyle:{"font-size":"30px",color:"rgb(135, 208, 104)"}}):e._e()]),i("div",[e._v("创建日期："+e._s(t.row.orderTime))]),i("div",[e._v("状态："+e._s(e.getOrderStatus(t.row)))]),i("div",{staticClass:"shop-over"},[e._v("所属店铺："+e._s(t.row.shop.name))])])]}}])}),i("el-table-column",{attrs:{label:"代理商","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"100%"}},[i("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.agent.name)+" ")]),i("div",{staticClass:"overflow"},[e._v(" 创建人："+e._s(t.row.operatorName)+" ")]),i("div",{staticClass:"overflow"},[e._v(" 电话："+e._s(t.row.member.mobile)+" ")])])]}}])}),i("el-table-column",{attrs:{label:"关联单据","min-width":"135"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"100%"}},e._l(t.row.relateBills,(function(t,r){return i("div",{key:r},[i("div",{staticClass:"shop-over",staticStyle:{color:"#ff7300",cursor:"pointer"},attrs:{title:t.relateBillSn?t.relateBillSn:""},on:{click:function(i){return e.clickRelateBill(i,t)}}},[e._v(" "+e._s(t.relateBillSn?t.relateBillSn:"")+" ")])])})),0)]}}])}),i("el-table-column",{attrs:{label:"金额","min-width":"100px",prop:"amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"100%"}},[i("div",{staticClass:"overflow"},[e._v(" 不含税： ")]),i("div",{staticClass:"overflow"},[e._v(" 税额： ")]),i("div",{staticClass:"overflow"},[e._v(" 含税："+e._s(t.row.amount)+" ")])])]}}])}),i("el-table-column",{attrs:{label:"商品信息","min-width":"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[i("div",{staticStyle:{width:"100%"}},e._l(t.row.orderItems.length>0?[t.row.orderItems[0]]:[],(function(r){return i("div",{key:r.sn,staticClass:"product-info-content"},[r.thumbnail&&" "!==r.thumbnail?i("img",{attrs:{src:r.thumbnail,onerror:e.errorImg}}):i("img",{attrs:{src:"/resources/admin/images/default/product-default-100.png"}}),i("div",{staticClass:"wrapper"},[i("div",{staticClass:"titleClass",attrs:{title:r.name}},[e._v(e._s(r.name))]),i("div",[e._v(e._s(r.product?r.product.barCode:""))]),i("div",[e._v("单价(不含税)：")]),i("div",[e._v("单价(含税)："+e._s(r.price))])]),i("div",{staticClass:"amount"},[e._v(e._s(r.quantity)+e._s(t.row.orderItems.length>1?"...":""))])])})),0)])]}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"!==t.row.unionConfig.editable&&"shop"===e.getUser().roleLevel||"1"!==t.row.isValid?e._e():i("biz-column-operation",{attrs:{row:t.row}},["9"===t.row.type&&"0"===t.row.hasSyncOrder?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.refundsHandler(t.row)}}},[e._v("退款")]):e._e(),"2"!==t.row.type||"ride"!==e.orderType&&"replace"!==e.orderType&&"loan"!==e.orderType||"0"!==t.row.hasSyncOrder?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.service(t.row)}}},[e._v("服务")]),"service"!==e.orderType&&"rescue"!==e.orderType||!("2"===t.row.type&&"1"===t.row.shippingWay||"2"===t.row.type&&"2"===t.row.shippingWay)||"0"!==t.row.hasSyncOrder?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.serviceHandler(t.row)}}},[e._v("服务")]),"2"!==t.row.type||"2"!==t.row.shippingWay||"car"!==e.orderType&&"product"!==e.orderType&&"general"!==e.orderType&&"purchaseOrder"!==t.row.dType||"0"!==t.row.hasSyncOrder?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.excuteHandler(t.row)}}},[e._v("服务")]),"service"!==e.orderType&&"rescue"!==e.orderType||"3"!==t.row.type||"0"!==t.row.shippingWay||"0"!==t.row.hasSyncOrder?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.excuteHandler(t.row)}}},[e._v("服务")]),!("13"===t.row.type||"3"===t.row.type&&"0"===t.row.shippingWay||"2"===t.row.type&&"1"===t.row.shippingWay)||"car"!==e.orderType&&"product"!==e.orderType&&"general"!==e.orderType&&"purchaseOrder"!==t.row.dType||"0"!==t.row.hasSyncOrder||"service"===e.orderType?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.shippingHandler(t.row)}}},[e._v("发货")]),("11"===t.row.type&&"1"===t.row.shippingWay||"12"===t.row.type&&"1"===t.row.shippingWay)&&"0"===t.row.hasSyncOrder?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.paymentHandler(t.row)}}},[e._v("付款")]):e._e(),"2"===t.row.type||"1"===t.row.type?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.closeOrder(t.row)}}},[e._v("关闭")]):e._e(),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.certificate(t.row)}}},[e._v("凭证")]),"6"===t.row.type||t.row.invoiceId?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.invoiceHandler(t.row)}}},[e._v("补开发票")]),"1"===t.row.type&&("1"===t.row.auditState&&"1"===t.row.audit||"2"===t.row.auditState&&"1"===t.row.audit)?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.toPass(t.row)}}},[e._v("审核")]):e._e(),"0"===t.row.isMerged&&"2"===t.row.type?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.mergeOrder(t.row)}}},[e._v("合并订单")]):e._e(),"0"!==t.row.isTransfered||"2"!==t.row.type&&"3"!==t.row.type&&"4"!==t.row.type&&"12"!==t.row.type&&"13"!==t.row.type?e._e():i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.returnOrder(t.row)}}},[e._v("转采购")])],1)]}}])})],1),i("el-popover",{ref:"confirmOrder",attrs:{placement:"top-start","min-width":"300"},model:{value:e.visiable,callback:function(t){e.visiable=t},expression:"visiable"}},[i("p",[i("i",{staticClass:"el-icon-warning",staticStyle:{color:"#ff7300","margin-right":"10px"}}),e._v("您要确认此订单么? ")]),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini",type:"text"}},[e._v("确定")])],1)]),i("biz-popup-tabs",{attrs:{open:e.openReview},on:{close:function(t){e.openReview=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"评价",name:"reviewinfo"}},[i("my-evaluate",{ref:"reviewinfo",attrs:{orderId:e.orderId,editable:e.editable},on:{operationSuccess:e.operationSuccess}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openLogistics},on:{close:function(t){e.openLogistics=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"物流追踪",name:"loginfoTab"}},[i("logistics-following",{ref:"logistics",attrs:{orderId:e.itemId,sn:e.sn}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.open},on:{close:function(t){e.open=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[i("base-info",{ref:"baseInfo",attrs:{itemId:e.itemId,isEdit:e.isEdit,handler:e.handler,open:e.open,activeNames:e.activeNames},on:{xrorder:e.xrorder,operationSuccess:e.operationSuccess}})],1),i("el-tab-pane",{attrs:{label:"商品信息",name:"productinfo"}},[i("product-info",{ref:"productinfo",attrs:{itemId:e.itemId,isEdit:e.isEdit,agentId:e.agentId},on:{setOrderItems:e.setOrderItems,operationSuccess:e.operationSuccess}})],1),e.itemId?i("el-tab-pane",{attrs:{label:"订单进度",name:"loginfo"}},[i("order-logs",{ref:"loginfo",attrs:{itemId:e.itemId,isEdit:e.isEdit,paymentMethodName:e.paymentMethodName},on:{logistics:e.logistics}})],1):e._e(),e.itemId?i("el-tab-pane",{attrs:{label:"物流信息",name:"logisticsinfo"}},[i("logistics-info",{ref:"logisticsinfo",attrs:{itemId:e.itemId,open:e.open,handler:e.handler,shippings:e.shippings,itemList:e.itemList},on:{operationSuccess:e.getList,goToOrderLogs:e.goToOrderLogs}})],1):e._e(),e.itemId?i("el-tab-pane",{attrs:{label:"售后进度",name:"afterprocess"}},[i("after-process",{ref:"afterprocess",attrs:{itemId:e.itemId,isEdit:e.isEdit},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId?i("el-tab-pane",{attrs:{label:"服务记录",name:"orderhistory"}},[i("order-history",{ref:"orderhistory",attrs:{itemId:e.itemId,isEdit:e.isEdit},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId&&"6"!==e.orderState?i("el-tab-pane",{attrs:{label:"发票",name:"invoice"}},[i("invoice-info",{ref:"invoice",attrs:{itemId:e.itemId,invoiceInfoId:e.invoiceInfoId,invoiceId:e.invoiceId,price:e.price,open:e.open,userId:e.userId,isEdit:e.isEdit},on:{operationSuccess:e.getList}})],1):e._e(),"1"===e.mergeState?i("el-tab-pane",{attrs:{label:"子订单信息",name:"orderChild"}},[i("order-child-info",{ref:"orderChild",attrs:{itemId:e.itemId,invoiceInfoId:e.invoiceInfoId,invoiceId:e.invoiceId,price:e.price,open:e.open,userId:e.userId,isEdit:e.isEdit},on:{operationSuccess:e.operationSuccess}})],1):e._e()],1),i("biz-popup-tabs",{attrs:{open:e.openInvocie},on:{close:function(t){e.openInvocie=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"发票",name:"invoice"}},[i("invoice-info",{ref:"invoice",attrs:{itemId:e.itemId,invoiceInfoId:e.invoiceInfoId,invoiceId:e.invoiceId,price:e.price,open:e.openInvocie,userId:e.userId,isEdit:e.isEdit,orderIds:e.orderIds},on:{operationSuccess:e.getList}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openSetting},on:{close:function(t){e.openSetting=!1}},model:{value:e.settingName,callback:function(t){e.settingName=t},expression:"settingName"}},[i("el-tab-pane",{attrs:{label:"设置",name:"setting"}},[i("rescue-setting",{ref:"settingInfo",on:{operationSuccess:e.operationSuccess}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.memberInfo},on:{close:function(t){e.memberInfo=!1}},model:{value:e.memberName,callback:function(t){e.memberName=t},expression:"memberName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"memberInfo"}},[i("membership-mgmt-base-info",{ref:"memberInfo",attrs:{itemId:e.memberId},on:{operationSuccess:e.operationSuccess}})],1),i("el-tab-pane",{attrs:{label:"车辆信息",name:"carInfo"}},[i("membership-mgmt-vehicle-info",{ref:"carInfo",attrs:{itemId:e.memberId}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openPurchase},on:{close:function(t){e.openPurchase=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[i("purchase-apply-info",{attrs:{itemId:e.purchaseId,isEdit:e.isEdit},on:{operationSuccess:e.operationSuccess,closeTabByLogistics:e.closeTabByLogistics,closeTabByEvaluate:e.closeTabByEvaluate}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openPurchaseOrder},on:{close:function(t){e.openPurchaseOrder=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[i("purchase-order-info",{ref:"orderinfo",attrs:{orderId:e.purchaseOrderId,isEdit:e.isEdit,isRalateBill:e.isRalateBill},on:{closeTabByLogistics:e.closeTabByLogistics,closeTabByEvaluate:e.closeTabByEvaluate}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openOrderSale},on:{close:function(t){e.openOrderSale=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"orderinfo"}},[i("order-sale-info",{ref:"orderSaleInfo",attrs:{itemId:e.orderSaleId,isEdit:e.isEdit},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"商品信息",name:"OrderSaleProductInfo"}},[i("order-sale-product-info",{ref:"OrderSaleProductInfo",attrs:{itemId:e.orderSaleId,isEdit:e.isEdit},on:{operationSuccess:e.refresh}})],1)],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(t){e.showPassOrder=t}}},[i("div",[i("div",{staticClass:"reson-container"},[i("span",[e._v("审核结果：")]),i("el-radio",{attrs:{label:"1",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("通过")]),i("el-radio",{attrs:{label:"2",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("驳回")]),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[i("span",[e._v("驳回理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:e.curSelectAjectReason,callback:function(t){e.curSelectAjectReason=t},expression:"curSelectAjectReason"}},e._l(e.reasonAjectList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showPassOrder=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange(e.row,e.auditState)}}},[e._v("确定")])],1)]),i("el-dialog",{attrs:{visible:e.dialogTableVisible,center:"",width:"1200px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("结算时间："+e._s(e.form.orderTime))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("代理商："+e._s(e.form.agentName))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("会员姓名："+e._s(e.form.member?e.form.member.name:""))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("会员电话："+e._s(e.form.member?e.form.member.mobile:""))])])],1),e.userCard.sn?i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("会员卡号："+e._s(e.userCard.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("会员卡余额："+e._s(e.userCard.balance))])])],1):e._e(),e.userCard.sn?i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("赠送V豆："+e._s(e.form.giftBean))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("赠送积分："+e._s(e.form.point))])])],1):e._e(),e.userCard.bean?i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("V豆总和："+e._s(e.userCard.bean))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("积分总和："+e._s(e.userCard.point))])])],1):e._e(),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[e.userCard.sn?i("div",{staticClass:"grid-content bg-purple"},[e._v("抵扣V豆："+e._s(e.form.bean))]):e._e()]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("备注："+e._s(e.form.remarks))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"fullName",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.fullName))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:3}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("运费：￥"+e._s(e.form.freight))])]),i("el-col",{attrs:{span:5}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("优惠金额：￥"+e._s(e.form.couponDiscount))])]),i("el-col",{attrs:{span:5}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("调整金额：￥"+e._s(e.form.offsetAmount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("实收金额：￥"+e._s(e.form.amountPaid))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1),i("el-dialog",{attrs:{visible:e.showCloseOrder,center:"","append-to-body":"","custom-class":"close-order-dialog"},on:{"update:visible":function(t){e.showCloseOrder=t}}},[i("div",[i("div",[e._v("请您在与客户沟通一致的前提下使用此功能，订单关闭后，不能恢复")]),i("div",{staticClass:"reson-container"},[i("span",{staticClass:"start"},[e._v("*")]),i("span",[e._v("请选择关闭订单的理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择关闭理由"},model:{value:e.curSelectCloseReason,callback:function(t){e.curSelectCloseReason=t},expression:"curSelectCloseReason"}},e._l(e.reasonList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("div",{staticClass:"deccription"},[i("span",{staticClass:"dec-label"},[e._v("备注：")]),i("el-input",{attrs:{placeholder:"请输入备注",type:"textarea",rows:4},model:{value:e.closeDeccription,callback:function(t){e.closeDeccription=t},expression:"closeDeccription"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.cancelClose}},[e._v("取消")]),i("el-button",{on:{click:e.confirmClose}},[e._v("确定关闭")])],1)]),i("el-dialog",{attrs:{visible:e.showIframe,center:"",width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.showIframe=t}}},[i("iframe",{staticStyle:{height:"600px",width:"100%"},attrs:{src:e.iframeSrc,frameborder:"0"}})]),i("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"合并订单",visibility:e.showMergeOrder,tableData:e.orderList,pagination:e.dialogPagination,selectionKeys:e.selectedOrderIds},on:{"update:visibility":function(t){e.showMergeOrder=t},pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,confirmed:e.confirmedMergeOrder,selectionChange:e.selectionChange}},[i("el-table-column",{attrs:{label:"订单信息",prop:"sn","min-width":"185px"}}),i("el-table-column",{attrs:{label:"商品信息","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[i("div",{staticStyle:{width:"100%","margin-right":"30px"}},e._l(t.row.orderItems,(function(t){return i("div",{key:t.id,staticClass:"product-info"},[t.thumbnail&&" "!==t.thumbnail?i("img",{attrs:{src:t.thumbnail,onerror:e.errorImg}}):i("img",{attrs:{src:"/resources/admin/images/default/product-default-100.png"}}),i("div",{staticClass:"wrapper"},[i("div",{staticClass:"titleClass",attrs:{title:t.name}},[e._v(e._s(t.name))])]),i("div",{staticClass:"info-bottom"},[i("div",{staticStyle:{"margin-left":"7px",opacity:"0.65"}},[e._v(" "+e._s(t.fullName&&-1!==t.fullName.indexOf("[")?t.fullName.split("[")[1].split("]")[0]:"")+" ")]),i("div")])])})),0)])]}}])}),i("el-table-column",{attrs:{label:"商品价格&数量","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",e._l(t.row.orderItems,(function(t){return i("div",{key:t.id},[e._v(" ￥"+e._s(t.price)+" x"+e._s(t.quantity))])})),0)]}}])}),i("el-table-column",{attrs:{label:"价格信息","min-width":"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.amount))]}}])}),i("el-table-column",{attrs:{label:"创建人","min-width":"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.operatorName))]}}])})],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showOrderContactor,center:"","append-to-body":"","custom-class":"order-contactor-dialog",title:"合并订单"},on:{"update:visible":function(t){e.showOrderContactor=t}}},[i("div",[e.contactorList.length>0?i("div",[i("div",[e._v("确认联系人信息，如有多个请选择。")]),e._l(e.contactorList,(function(t){return i("el-card",{key:t.id},[i("div",[i("div",{staticClass:"radio-i"},[i("el-radio",{attrs:{label:"1",size:"mini"},on:{change:function(i){return e.selectChange(t)}},model:{value:t.isChecked,callback:function(i){e.$set(t,"isChecked",i)},expression:"contactor.isChecked"}},[i("span",{staticStyle:{color:"#ffffff"}},[e._v(".")])]),i("div",{staticClass:"receiver-info"},[i("span",[e._v(e._s(t.consignee?t.consignee:""))]),i("span",{staticStyle:{"margin-left":"15px"}},[e._v(e._s(t.phone?t.phone:""))]),i("p",[e._v(e._s(t.areaName+t.address))])])],1)])])}))],2):e._e(),i("div",[e.invoiceList.length>0?i("div",[e._v(" 确认发票信息，如有多个请选择。 "),e._l(e.invoiceList,(function(t){return i("el-card",{key:t.id},[i("div",[i("div",{staticClass:"radio-i"},[i("el-radio",{attrs:{label:"1",size:"mini"},on:{change:function(i){return e.selectChangeByInvoice(t)}},model:{value:t.isChecked,callback:function(i){e.$set(t,"isChecked",i)},expression:"invoice.isChecked"}},[i("span",{staticStyle:{color:"#ffffff"}},[e._v(".")])]),i("div",[i("div",{staticClass:"default"},[i("span",[e._v("发票抬头：")]),i("span",[e._v(e._s(t.invoiceTitle))])]),i("div",{staticStyle:{"padding-top":"10px"}},[i("span",[e._v("发票类型：")]),i("span",[e._v(e._s("0"===t.invoiceType?"个人":"1"===t.invoiceType?"增值税普通发票":"2"===t.invoiceType?"增值税专用发票":""))])]),i("div",{staticStyle:{padding:"10px 0px"}},[i("span",[e._v("联系人：")]),i("span",[e._v(e._s(t.contacts))])]),i("div",[i("span",[e._v("联系电话：")]),i("span",[e._v(e._s(t.mobile))])]),i("div",{staticClass:"content-d",staticStyle:{padding:"10px 0px"}},[i("span",[e._v("详细地址：")]),i("span",[e._v(e._s(t.area?t.area.fullName+t.address:t.address))])])])],1)])])}))],2):e._e()])]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showOrderContactor=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.confirmMerge}},[e._v("确定")])],1)]),i("el-dialog",{attrs:{visible:e.showReturnPurchase,center:"","append-to-body":"","custom-class":"return-purchase-dialog",title:"提交采购订单"},on:{"update:visible":function(t){e.showReturnPurchase=t}}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingReturnPurchase,expression:"loadingReturnPurchase"}],staticClass:"order-confirm"},[i("div",{staticClass:"order-confirm-content"},[e.returnOrderList.length>0?i("div",[i("div",{staticStyle:{display:"flex","align-items":"center",position:"absolute","z-index":"1000",left:"55px",top:"77px",background:"#fff",width:"80%"}},[i("img",{staticStyle:{width:"18px",height:"18px"},attrs:{src:e.iconShop}}),e._v(" "+e._s(e.agentAddress?e.agentAddress.shop.name:"")+" ")]),i("div",{staticStyle:{display:"flex","align-items":"center",position:"absolute","z-index":"1000",left:"55px",top:"174px",background:"#fff",width:"80%"}},[i("img",{staticStyle:{width:"18px",height:"18px"},attrs:{src:e.iconShop}}),e._v(" "+e._s(e.agentAddress?e.agentAddress.agent.name:"")+" ")]),i("el-radio-group",{staticStyle:{width:"100%"},on:{change:e.radioChange},model:{value:e.selectRadio,callback:function(t){e.selectRadio=t},expression:"selectRadio"}},[i("el-radio",{staticStyle:{display:"flex","align-items":"center"},attrs:{label:"shopReceiver"}}),e.showAddress?i("div",{staticClass:"order-address",on:{click:e.clickAdress}},[i("div",{staticClass:"left"},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])]):e._e(),i("el-radio",{staticStyle:{display:"flex","align-items":"center"},attrs:{label:"agencyReceiver"}}),i("div",{staticClass:"order-address"},[i("div",{staticClass:"left"},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.agentAddress?e.agentAddress.consignee:""))]),i("span",[e._v(e._s(e.agentAddress?e.agentAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.agentAddress?e.agentAddress.address:"")+" ")])])])])])],1),e._l(e.returnOrderList,(function(t,r){return i("div",{key:r,staticStyle:{"box-shadow":"0 2px 3px rgba(0, 0, 0, 0.1)",padding:"20px","margin-bottom":"10px"}},[i("div",{staticClass:"order-goods"},[i("div",{staticClass:"shop-name"},[i("img",{attrs:{src:e.iconShop}}),i("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(e.getUser().shop.name))])]),e._l(t.cartItems,(function(r,a){return i("div",{key:a},[i("el-checkbox",{attrs:{min:1,"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.selectReturnOrder(t)}},model:{value:r.isSelected,callback:function(t){e.$set(r,"isSelected",t)},expression:"item.isSelected"}},[i("span",{staticStyle:{color:"#ffffff"}},[e._v(".")])]),i("div",{staticClass:"order-goods-div"},[i("div",{staticClass:"img-div"},[r.product.image&&" "!==r.product.image?i("img",{attrs:{src:r.product.image,onerror:e.errorImg}}):e._e()]),i("div",{staticClass:"goods-info"},[i("span",{staticClass:"name"},[e._v(e._s(r.product.fullName))]),i("div",{staticStyle:{"margin-bottom":"10px"}},[e._v(e._s(r.product.barCode))]),i("div",{staticClass:"money-info"},[i("span",{staticClass:"count-money"},[e._v("￥"+e._s(r.product.price))]),i("el-input-number",{staticClass:"count-num",attrs:{size:"mini"},model:{value:r.quantity,callback:function(t){e.$set(r,"quantity",e._n(t))},expression:"item.quantity"}},[e._v("X"+e._s(r.quantity)+" ")])],1)])])],1)}))],2),i("div",{staticClass:"order-info"},[i("div",{staticClass:"select-tyle"},[i("span",[e._v("支付方式")]),i("el-select",{attrs:{size:"mini"},on:{change:function(i){return e.paymentChange(t.paymentMethodId,r)}},model:{value:t.paymentMethodId,callback:function(i){e.$set(t,"paymentMethodId",i)},expression:"returnList.paymentMethodId"}},e._l(e.payOptions,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),i("div",{staticClass:"select-tyle"},[i("span",[e._v("配送方式")]),i("el-select",{attrs:{size:"mini"},on:{change:function(i){return e.inputChange(t.shippingMethodId,r)}},model:{value:t.shippingMethodId,callback:function(i){e.$set(t,"shippingMethodId",i)},expression:"returnList.shippingMethodId"}},e._l(e.options,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),i("div",{staticClass:"buy-leave-mes"},[i("span",[e._v("买家留言")]),i("el-input",{attrs:{type:"textarea",size:"mini",placeholder:"选填：填写内容已和卖家协商确认"},model:{value:t.memo,callback:function(i){e.$set(t,"memo",i)},expression:"returnList.memo"}})],1)])])})),i("div",{staticClass:"order-info"},[i("div",{staticClass:"order-dispatch"},[i("span",{staticStyle:{display:"flex","align-items":"center"}},[i("el-checkbox",{on:{change:e.invoiceChange},model:{value:e.invoiceChecked,callback:function(t){e.invoiceChecked=t},expression:"invoiceChecked"}}),i("span",{staticClass:"label"},[e._v("发票信息")])],1),i("div",{staticClass:"invoice-info",on:{click:e.clickInvoiceInfo}},[e.invoiceChecked?i("span",{staticClass:"invoice-title",staticStyle:{"font-size":"14px"}},[e._v(e._s(e.getInvoice?e.getInvoice.invoiceTitle:"暂无发票"))]):e._e(),e.invoiceChecked?e._e():i("span",{staticClass:"invoice-title",staticStyle:{"font-size":"14px"}},[e._v(e._s("不开具发票"))]),i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])]),i("div",{staticClass:"order-count-div"},[i("div",{staticClass:"order-count"},[i("span",{staticClass:"pro-count"},[e._v("产品总额")]),i("span",[e._v("￥"+e._s(e.getCountMouny))])]),i("div",{staticClass:"order-count"},[i("span",{staticClass:"pro-count"},[e._v("运费")]),i("span",[e._v("+￥"+e._s(e.getFreight))])]),i("div",{staticClass:"order-count"},[i("span",{staticClass:"pro-count",staticStyle:{color:"#333"}},[e._v("合计")]),i("span",{staticClass:"count-money"},[e._v("￥"+e._s(e.getAmount?e.getAmount:e.getAmount.toFixed(2)))])])])],2):e._e(),e.productGroupWithNoSupplier.length>0?i("div",[i("div",[e._v("以下商品无供应商，暂不支持提交采购订单")]),e._l(e.productGroupWithNoSupplier,(function(t,r){return i("div",{key:r},e._l(t.cartItems,(function(t,r){return i("div",{key:r},[i("div",{staticClass:"order-goods-div"},[i("div",{staticClass:"img-div"},[t.product.image&&" "!==t.product.image?i("img",{attrs:{src:t.product.image,onerror:e.errorImg}}):e._e()]),i("div",{staticClass:"goods-info"},[i("span",{staticClass:"name"},[e._v(e._s(t.product.fullName))]),i("div",{staticStyle:{"margin-bottom":"10px"}},[e._v(e._s(t.product.barCode))]),i("div",{staticClass:"money-info"},[i("span",{staticClass:"count-money"},[e._v("￥"+e._s(t.product.price))]),i("span",{staticClass:"count-num"},[e._v("X"+e._s(t.quantity))])])])])])})),0)}))],2):e._e(),e.productGroupNoSupplierPrice.length>0?i("div",[i("div",[e._v("以下商品无采购价，暂不支持提交采购订单")]),e._l(e.productGroupNoSupplierPrice,(function(t,r){return i("div",{key:r},e._l(t.cartItems,(function(t,r){return i("div",{key:r},[i("div",{staticClass:"order-goods-div"},[i("div",{staticClass:"img-div"},[t.product.image&&" "!==t.product.image?i("img",{attrs:{src:t.product.image,onerror:e.errorImg}}):e._e()]),i("div",{staticClass:"goods-info"},[i("span",{staticClass:"name"},[e._v(e._s(t.product.fullName))]),i("div",{staticStyle:{"margin-bottom":"10px"}},[e._v(e._s(t.product.barCode))]),i("div",{staticClass:"money-info"},[i("span",{staticClass:"count-money"},[e._v("￥"+e._s(t.product.price))]),i("span",{staticClass:"count-num"},[e._v("X"+e._s(t.quantity))])])])])])})),0)}))],2):e._e(),i("div",{staticClass:"foot",attrs:{slot:"bottom"},slot:"bottom"},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.returnOrderList.length>0,expression:"returnOrderList.length>0"}],staticClass:"submit",attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交订单")])],1)])])]),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1),i("el-dialog",{attrs:{visible:e.dialogVisiableInvoice,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableInvoice=t}}},[i("return-invoice-info",{on:{selectedInvoice:e.selectedInvoice}})],1)],1)},a=[],s=(i("99af"),i("4160"),i("caad"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("8ba4"),i("b680"),i("d3b7"),i("ac1f"),i("2532"),i("3ca3"),i("466d"),i("1276"),i("159b"),i("ddb0"),i("2b3d"),i("96cf"),i("1da1")),o=i("b85c"),n=i("5530"),l=i("7132"),c=i("04d3"),d=i("af3f"),p=i("e42c"),u=i("b06a"),m=i("5801"),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-log-info"},["在线支付"!==e.paymentMethodName?i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v("待商家确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v("商家已确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"AuditPassed"===t.type?i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v("审核者："+e._s(t.operator))]),i("p",[e._v(e._s(t.createTime))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"执行",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,r){return i("div",{key:r},["6"===t.state?i("div",[i("p",[e._v("自动派单")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason))])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("自动派单")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v("用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile))]):e._e(),t.dispatchRecord?i("div",[e._v(e._s(t.dispatchRecord.createDate))]):e._e(),t.refuseRecord?i("div",[e._v(e._s(t.refuseRecord.reason))]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks))]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已出发")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已到达")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"3"===t.state?i("div",[i("p",[e._v("完成救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"4"===t.state?i("div",[i("p",[e._v("取消救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已执行")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.shippings,(function(t){return e.shippings&&e.shippings.length>0?i("div",{key:t.id},["1"===t.shippingStatus?i("p",[e._v("订单已部分发货")]):e._e(),"1"!==t.shippingStatus?i("p",[e._v("订单已执行")]):e._e(),i("p",[e._v(e._s(t.shippingDate))]),i("p",[e._v("物流公司："+e._s(t.logistics))]),i("p",[e._v("物流单号："+e._s(t.expressSn))]),i("p",[e._v(" 收货人："+e._s(t.consignee)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(i){return e.certificate(t.id)}}},[e._v("凭证")])],1),e._l(t.shippingItems,(function(t,r){return i("p",{key:r},[e._v(e._s(t.name)+"*"+e._s(t.quantity))])})),e.devProcessShippings&&e.devProcessShippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.devProcessShippings.shippingTraces,(function(t,r){return i("div",{key:r,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.devProcessShippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()],2):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.payments.length>0?i("div",[i("p",[e._v("支付方式："+e._s(e.paymentMethodName))]),i("p",[e._v("付款方式："+e._s(e.paymentType))]),e._l(e.payments,(function(t){return i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v(e._s("0"===t.paymentStatus?"未支付":"1"===t.paymentStatus?"部分支付":"已支付"))]),i("p",[e._v(e._s(t.paymentDate))]),i("p",[e._v("付款金额：￥"+e._s(t.amount))]),i("p",[e._v("手续费："+e._s(t.fee))]),i("p",[e._v("交易号："+e._s(t.sn))])])}))],2):e._e()])]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v("交易完成")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已评价")]),e._l(e.reviews,(function(t,r){return i("div",{key:r},["0"===t.reviewType?i("div",[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("商品："+e._s(t.product.name))]),i("p",[e._v("评分："+e._s(t.score)+"分")]),i("p",[e._v("评语："+e._s(t.content))]),e._l(t.images,(function(t,r){return i("div",{key:r,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v("店铺评分")]),i("p",[e._v("服务态度："+e._s(t.serviceAttitude)+"分")]),i("p",[e._v("服务速度："+e._s(t.serviceSpeed)+"分")]),i("p",[e._v("专业技能："+e._s(t.professional)+"分")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已关闭")]),i("p",[e._v("关闭理由："+e._s(t.content))]),i("p",[e._v("备注："+e._s(t.memo))]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]):e._e()],1):e._e(),"在线支付"===e.paymentMethodName?i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v("待商家确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v("商家已确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"AuditPassed"===t.type?i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v("审核者："+e._s(t.operator))]),i("p",[e._v(e._s(t.createTime))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.payments.length>0?i("div",[i("p",[e._v("支付方式："+e._s(e.paymentMethodName))]),i("p",[e._v("付款方式："+e._s(e.paymentType))]),e._l(e.payments,(function(t){return i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v(e._s("0"===t.paymentStatus?"未支付":"1"===t.paymentStatus?"部分支付":"已支付"))]),i("p",[e._v(e._s(t.paymentDate))]),i("p",[e._v("付款金额：￥"+e._s(t.amount))]),i("p",[e._v("手续费："+e._s(t.fee))]),i("p",[e._v("交易号："+e._s(t.sn))])])}))],2):e._e()])]),i("el-step",{attrs:{title:"执行",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,r){return i("div",{key:r},["6"===t.state?i("div",[i("p",[e._v("自动派单")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason))])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("自动派单")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v("用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile))]):e._e(),t.dispatchRecord?i("div",[e._v(e._s(t.dispatchRecord.createDate))]):e._e(),t.refuseRecord?i("div",[e._v(e._s(t.refuseRecord.reason))]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks))]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已出发")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已到达")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"3"===t.state?i("div",[i("p",[e._v("完成救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"4"===t.state?i("div",[i("p",[e._v("取消救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已执行")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.shippings,(function(t){return e.shippings&&e.shippings.length>0?i("div",{key:t.id},["1"===t.shippingStatus?i("p",[e._v("订单已部分发货")]):e._e(),"1"!==t.shippingStatus?i("p",[e._v("订单已执行")]):e._e(),i("p",[e._v(e._s(t.shippingDate))]),i("p",[e._v("物流公司："+e._s(t.logistics))]),i("p",[e._v("物流单号："+e._s(t.expressSn))]),i("p",[e._v(" 收货人："+e._s(t.consignee)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(i){return e.certificate(t.id)}}},[e._v("凭证")])],1),e._l(t.shippingItems,(function(t,r){return i("p",{key:r},[e._v(e._s(t.name)+"*"+e._s(t.quantity))])})),e.devProcessShippings&&e.devProcessShippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.devProcessShippings.shippingTraces,(function(t,r){return i("div",{key:r,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.devProcessShippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()],2):e._e()}))],2)]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v("交易完成")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已评价")]),e._l(e.reviews,(function(t,r){return i("div",{key:r},["0"===t.reviewType?i("div",[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("商品："+e._s(t.product.name))]),i("p",[e._v("评分："+e._s(t.score)+"分")]),i("p",[e._v("评语："+e._s(t.content))]),e._l(t.images,(function(t,r){return i("div",{key:r,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v("店铺评分")]),i("p",[e._v("服务态度："+e._s(t.serviceAttitude)+"分")]),i("p",[e._v("服务速度："+e._s(t.serviceSpeed)+"分")]),i("p",[e._v("专业技能："+e._s(t.professional)+"分")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已关闭")]),i("p",[e._v("关闭理由："+e._s(t.content))]),i("p",[e._v("备注："+e._s(t.memo))]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]):e._e()],1):e._e(),i("el-dialog",{attrs:{title:"",visible:e.outerVisible,"append-to-body":""},on:{"update:visible":function(t){e.outerVisible=t}}},[i("img",{attrs:{src:e.larImg,width:"100%"}})]),i("el-dialog",{attrs:{visible:e.dialogShipping,center:"",width:"1200px","append-to-body":"","custom-class":"printDialog"},on:{"update:visible":function(t){e.dialogShipping=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单状态："+e._s("1"===e.shippingsPrint.shippingStatus?"订单已部分发货":"订单已执行"))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("发货时间："+e._s(e.shippingsPrint.shippingDate?e.shippingsPrint.shippingDate.split(" ")[0]:""))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.shippingsPrint.logistics))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shippingsPrint.expressSn))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流费用："+e._s(e.shippingsPrint.freight))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingsPrint.consignee))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingsPrint.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货地址："+e._s(e.shippingsPrint.address))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1)],1)},h=[],g=i("f36f"),v=i("f260"),b=i.n(v),y=i("1ab1"),I=i("225d"),_=i("2f62"),w=i("bc3a"),C=i.n(w),M={name:"NewsMgmt",props:{itemId:{type:String},paymentMethodName:{type:String,default:"在线支付"}},data:function(){return{orderItems:[],loading:!1,open:!1,outerVisible:!1,active:"",larImg:"",orderLogs:[],reviews:[],shippings:[],payments:[],dialogShipping:!1,form:{},title:"",gridData:[],shippingsPrint:"",devProcessShippings:"",memberRescueStates:[],paymentMethodNameReal:"",type:"",amount:"",amountpaid:"",paymentType:"",latestMemberRescueState:"",workers:[],sn:"",consignee:"",fee:"",operator:"",trackingNo:"",deliveryCorp:"",orderId:"",workerId:"",shippingId:"",dispathButton:!1,redispathButton:!1,cbp_tmlabel:!1,imgStyle:"",imageValue:"",currentState:"",preState:"",create:!1,cancel:!1,confirm:!1,service:!1,shipping:!1,payment:!1,complete:!1,review:!1,isCreate:!1,isConfirm:!1,isService:!1,isPayment:!1,isComplete:!1,isReview:!1,isCancel:!1}},components:{BizGrid:g["a"],vueEasyPrint:I["a"]},watch:{itemId:function(e){this.getList()}},created:function(){this.getList()},computed:{styleObject:function(){return{height:"200px",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+b.a+") 50% 50% / 200px no-repeat"}}},methods:Object(n["a"])(Object(n["a"])({},Object(_["c"])(["getUser"])),{},{operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.getList()},print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var i,r,a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={shippingId:e.shippingId},t.prev=1,t.next=4,C.a.post("/admin/purchaseOrder/voucher/export/shipping.jhtml",i,{responseType:"blob"});case 4:return r=t.sent,console.log("response => ",r),a=new Blob([r.data],{type:"application/vnd.ms-excel"}),s=decodeURI(r.headers["content-disposition"].split("filename=")[1]),o=document.createElement("a"),o.download=s.match(/"(\S*)"/)[1],o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1,a=t.getDate(),s=i+"-"+(r<10?"0"+r:r)+"-"+(a<10?"0"+a:a);return s},devProcess:function(){"新悦物流"===this.deliveryCorp&&this.$emit("logistics",this.orderItems[0].product.vins[0].number),"block"===this.$refs.devProcess[0].style.display?this.$refs.devProcess[0].style.display="none":this.$refs.devProcess[0].style.display="block"},certificate:function(e){var t=this,i={shippingId:e};y["a"].get("/admin/purchaseOrder/voucher/shipping.jhtml",i).then((function(i){t.dialogShipping=!0,t.title=t.getUser().shop?t.getUser().shop.name+"发货单":"发货单",t.form=i.order,t.shippingId=e,t.shippingsPrint=i.shipping,t.gridData=i.shipping.shippingItems})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},enlarge:function(e){this.larImg=e,this.outerVisible=!0},getList:function(e){var t=this;this.loading=!0;var i={orderId:e||this.itemId};p["a"].viewOrderlogs(i,(function(e){t.orderItems=e.order.orderItems,t.loading=!1,t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.payments=e.payments,e.payments&&e.payments.length>1?t.amountpaid=Number(e.payments[0].amount)+Number(e.payments[1].amount):t.amountpaid="",t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,t.shippings=e.shippings,t.devProcessShippings=e.shippings&&e.shippings[0],e.payments&&(t.paymentType=e.payments.length>0?e.payments[0].paymentType:"",t.amount=e.payments.length>0?e.payments[0].amount:"",t.fee=e.payments.length>0?e.payments[0].fee:"",t.sn=e.payments.length>0?e.payments[0].sn:""),e.shippings&&e.shippings.length>0&&(t.deliveryCorp=e.shippings.length>0?e.shippings[0].logistics:"",t.trackingNo=e.shippings.length>0?e.shippings[0].expressSn:"",t.operator=e.shippings.length>0?e.shippings[0].consignee:""),t.consignee=e.order.consignee||"",t.currentState=e.orderLogs[e.orderLogs.length-1].type,e.orderLogs.length>1&&(t.preState=e.orderLogs[e.orderLogs.length-2].type),"create"===t.currentState||"confirm"===t.currentState?t.active="1":"service"===t.currentState||"shipping"===t.currentState?t.active="2":"payment"===t.currentState?t.active="3":"complete"===t.currentState?t.active="4":"review"===t.currentState?t.active="5":"cancel"===t.currentState&&(t.active="6"),!t.latestMemberRescueState||"0"!==t.latestMemberRescueState.state&&"1"!==t.dispathType?(t.dispathButton=!0,t.cbp_tmlabel=!1):(t.dispathButton=!1,t.cbp_tmlabel=!0),t.latestMemberRescueState&&"3"!==t.latestMemberRescueState.state&&"8"!==t.latestMemberRescueState.state&&"9"!==t.latestMemberRescueState.state&&"4"!==t.latestMemberRescueState.state&&"0"!==t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0,t.isCreate=!1,t.isPayment=!1,t.isComplete=!1,t.isReview=!1,t.isCancel=!1,t.isService=!1,e.orderLogs.forEach((function(e){"create"===e.type&&(t.isCreate=!0),"payment"===e.type&&(t.isPayment=!0),"complete"===e.type&&(t.isComplete=!0),"review"===e.type&&(t.isReview=!0),"cancel"===e.type&&(t.isCancel=!0),"service"===e.type&&(t.isService=!0),"shipping"===e.type&&(t.isService=!0),"confirm"===e.type&&(t.isService=!0)}))}),(function(e){console.log(e)}))},getRescueList:function(e){var t=this;this.loading=!0;var i={orderId:e||this.itemId};p["a"].rescueOrderLogs(i,(function(e){t.loading=!1,t.orderLogs=e.orderLog,t.reviews=e.reviews,t.payments=e.payments,e.payments&&e.payments.length>1?t.amountpaid=Number(e.payments[0].amount)+Number(e.payments[1].amount):t.amountpaid="",t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,t.shippings=e.order.shippings&&e.order.shippings[0],e.order.payments&&(t.paymentType=e.order.payments.length>0?e.order.payments[0].paymentType:"",t.amount=e.order.payments.length>0?e.order.payments[0].amount:"",t.fee=e.order.payments.length>0?e.order.payments[0].fee:"",t.sn=e.order.payments.length>0?e.order.payments[0].sn:""),e.order.shippings&&(t.deliveryCorp=e.order.shippings.length>0?e.order.shippings[0].logistics:"",t.trackingNo=e.order.shippings.length>0?e.order.shippings[0].expressSn:"",t.operator=e.order.shippings.length>0?e.order.shippings[0].consignee:""),t.consignee=e.order.consignee||"",t.currentState=e.orderLogs[e.orderLogs.length-1].type,e.orderLogs.length>1&&(t.preState=e.orderLogs[e.orderLogs.length-2].type),"create"===t.currentState||"confirm"===t.currentState?t.active="1":"service"===t.currentState||"shipping"===t.currentState?t.active="2":"payment"===t.currentState?t.active="3":"complete"===t.currentState?t.active="4":"review"===t.currentState?t.active="5":"cancel"===t.currentState&&(t.active="6"),"0"===t.latestMemberRescueState.state||"1"===t.dispathType?(t.dispathButton=!1,t.cbp_tmlabel=!0):(t.dispathButton=!0,t.cbp_tmlabel=!1),"3"!==t.latestMemberRescueState.state&&"8"!==t.latestMemberRescueState.state&&"9"!==t.latestMemberRescueState.state&&"4"!==t.latestMemberRescueState.state&&"0"!==t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0,t.isCreate=!1,t.isPayment=!1,t.isComplete=!1,t.isReview=!1,t.isCancel=!1,t.isService=!1,e.orderLogs.forEach((function(e){"create"===e.type&&(t.isCreate=!0),"payment"===e.type&&(t.isPayment=!0),"complete"===e.type&&(t.isComplete=!0),"review"===e.type&&(t.isReview=!0),"cancel"===e.type&&(t.isCancel=!0),"service"===e.type&&(t.isService=!0),"shipping"===e.type&&(t.isService=!0),"confirm"===e.type&&(t.isService=!0)}))}),(function(e){console.log(e)}))},dispath:function(e){var t=this;this.id=this.itemId||"",p["a"].rescuerDispath({orderId:this.id,workerId:this.workerId},(function(e){p["a"].rescueOrderLogs({orderId:t.id,dispathType:"0"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,"0"===t.latestMemberRescueState.state||"7"===t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))}),(function(e){console.log(e)}))},rdispath:function(e){var t=this;this.id=this.itemId||"",p["a"].rescueOrderLogs({orderId:this.id,dispathType:"1"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,t.cbp_tmlabel=!0}),(function(e){console.log(e)}))}})},S=M,k=(i("1756"),i("2877")),T=Object(k["a"])(S,f,h,!1,null,null,null),x=T.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"logistics-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}):e._e(),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.shippings,size:"small"}},[i("el-table-column",{attrs:{label:"配送方式",prop:"shippingMethod","min-width":"80"}}),i("el-table-column",{attrs:{label:"物流公司",prop:"logistics","min-width":"80"}}),i("el-table-column",{attrs:{label:"物流单号",prop:"expressSn","min-width":"80"}}),i("el-table-column",{attrs:{label:"物流费用",prop:"freight","min-width":"80"}}),i("el-table-column",{attrs:{label:"收货地址",prop:"address","min-width":"80"}}),i("el-table-column",{attrs:{label:"商品",prop:"","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[i("div",{staticStyle:{width:"100%","margin-right":"30px"}},e._l(t.row.shippingItems,(function(t){return i("div",{key:t.id},[e._v(e._s(t.name)+"x"+e._s(t.quantity))])})),0)])]}}])}),i("el-table-column",{attrs:{prop:"title",label:"操作","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.detailClickHandler(t.row)}}},[e._v("详情")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.certificate(t.row.id)}}},[e._v("凭证")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.followClickHandler(t.row)}}},[e._v("物流跟踪")])],1)]}}])})],1),i("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showLogistics,expression:"showLogistics"}],ref:"logisticsForm",attrs:{size:"small","label-width":"110px",model:e.form,rules:e.rules,"inline-message":!0}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.orderItems,size:"small"}},[i("el-table-column",{attrs:{label:"商品",prop:"name","min-width":"80"}}),i("el-table-column",{attrs:{label:"条码",prop:"barCode","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))])}}])}),i("el-table-column",{attrs:{label:"已发货数量","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e._v(e._s(t.row.shippedQuantity))])}}])}),e.isShipped?e._e():i("el-table-column",{attrs:{label:"本次发货数量"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input-number",{attrs:{size:"mini",min:0,disabled:e.isShipped},model:{value:t.row.unShippedQuantity,callback:function(i){e.$set(t.row,"unShippedQuantity",i)},expression:"scope.row.unShippedQuantity"}})],1)])}}],null,!1,98595)})],1),i("el-form-item",{attrs:{label:"配送方式",prop:"shippingMethodId"}},[e.isShipped?e._e():i("el-select",{attrs:{placeholder:"请选择配送方式",disabled:e.isShipped},model:{value:e.form.shippingMethodId,callback:function(t){e.$set(e.form,"shippingMethodId",t)},expression:"form.shippingMethodId"}},[i("el-option",{attrs:{label:"空",value:""}}),e._l(e.shippingMethod,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],2),e.isShipped?i("el-input",{attrs:{disabled:e.isShipped},model:{value:e.form.shippingMethodName,callback:function(t){e.$set(e.form,"shippingMethodName",t)},expression:"form.shippingMethodName"}}):e._e()],1),i("el-form-item",{attrs:{label:"零担物流",prop:"isLCL"}},[i("el-switch",{attrs:{disabled:e.isShipped,"active-value":"1","inactive-value":"0","active-color":"#ff7300","inactive-color":"#d9d9d9"},model:{value:e.form.isLCL,callback:function(t){e.$set(e.form,"isLCL",t)},expression:"form.isLCL"}})],1),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"物流公司",prop:"deliveryCorpId"}},[i("el-select",{attrs:{filterable:"",disabled:e.isShipped,placeholder:"请选择物流公司"},model:{value:e.form.deliveryCorpId,callback:function(t){e.$set(e.form,"deliveryCorpId",t)},expression:"form.deliveryCorpId"}},e._l(e.deliveryCorps,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"物流单号",prop:"expressSn"}},[i("el-input",{attrs:{disabled:e.isShipped||"1"===e.form.isLCL,placeholder:"请输入物流单号"},model:{value:e.form.expressSn,callback:function(t){e.$set(e.form,"expressSn",t)},expression:"form.expressSn"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"物流费用",prop:"freight"}},[i("el-input-number",{attrs:{min:0,disabled:e.isShipped,placeholder:"请输入物流费用"},model:{value:e.form.freight,callback:function(t){e.$set(e.form,"freight",t)},expression:"form.freight"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"收货店铺",prop:"receiveStore"}},[i("el-input",{attrs:{disabled:e.isShipped,placeholder:"请输入收货店铺"},model:{value:e.form.receiveStore,callback:function(t){e.$set(e.form,"receiveStore",t)},expression:"form.receiveStore"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"收货地址",prop:"address"}},[i("el-input",{attrs:{disabled:e.isShipped,placeholder:"请输入收货地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"收货人",prop:"consignee"}},[i("el-input",{attrs:{disabled:e.isShipped,placeholder:"请输入收货人"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1):e._e(),e.form.shippingMethodId&&e.showDelivery?i("el-form-item",{staticClass:"isRequired",attrs:{label:"电话",prop:"phone"}},[i("el-input",{attrs:{disabled:e.isShipped,placeholder:"请输入电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1):e._e(),i("div",{staticClass:"close-button"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showLogistics=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1),i("el-dialog",{attrs:{visible:e.dialogShipping,center:"",width:"1200px","append-to-body":"","custom-class":"printDialog"},on:{"update:visible":function(t){e.dialogShipping=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.formShipping.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单状态："+e._s("1"===e.shippingsPrint.shippingStatus?"订单已部分发货":"订单已执行"))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("发货时间："+e._s(e.shippingsPrint.shippingDate?e.shippingsPrint.shippingDate.split(" ")[0]:""))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.shippingsPrint.logistics))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shippingsPrint.expressSn))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流费用："+e._s(e.shippingsPrint.freight))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingsPrint.consignee))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingsPrint.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货地址："+e._s(e.shippingsPrint.address))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1)],1)},D=[],$=i("8330"),L={name:"LogisticsInfo",components:{BizSaveButton:$["a"],BizGrid:g["a"],vueEasyPrint:I["a"]},data:function(){return{operations:[{label:"添加",name:"addLogistics",type:"primary",class:"show"}],rules:{deliveryCorpId:[{required:!0,message:"请选择物流公司",trigger:"blur"}],freight:[{required:!0,message:"请输入物流费用",trigger:"blur"}],address:[{required:!0,message:"请输入收货地址",trigger:"blur"}],consignee:[{required:!0,message:"请输入收货人",trigger:"blur"}],receiveStore:[{required:!0,message:"请输入收货店铺",trigger:"blur"}],phone:[{required:!0,message:"请输入电话",trigger:"blur"}]},logisticsList:[],isShipped:!1,detailList:[],showLogistics:!1,loading:!1,orderItems:[],form:{shippings:[],orderItems:[],shippingMethodId:"",isLCL:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",receiveStore:"",phone:"",shippingMethodName:""},dialogShipping:!1,formShipping:{},title:"",gridData:[],shippingId:"",shippingsPrint:"",shippingMethod:[],deliveryCorps:[],paymentTypes:[],paymentMethods:[],showDelivery:!1,showReceiver:!1,flag:!0}},computed:{},props:{itemId:{type:String},open:{type:Boolean,default:function(){return!1}},isEdit:{type:Boolean,default:function(){return!0}},handler:{type:String}},created:function(){},mounted:function(){this.init()},methods:Object(n["a"])(Object(n["a"])({},Object(_["c"])(["getUser"])),{},{getDefaultForm:function(){return{shippings:[],orderItems:[],shippingMethodId:"",isLCL:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",receiveStore:"",phone:"",shippingMethodName:""}},print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var i,r,a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={shippingId:e.shippingId},t.prev=1,t.next=4,C.a.post("/admin/purchaseOrder/voucher/export/shipping.jhtml",i,{responseType:"blob"});case 4:return r=t.sent,console.log("response => ",r),a=new Blob([r.data],{type:"application/vnd.ms-excel"}),s=decodeURI(r.headers["content-disposition"].split("filename=")[1]),o=document.createElement("a"),o.download=s.match(/"(\S*)"/)[1],o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1,a=t.getDate(),s=i+"-"+(r<10?"0"+r:r)+"-"+(a<10?"0"+a:a);return s},certificate:function(e){var t=this,i={shippingId:e};y["a"].get("/admin/purchaseOrder/voucher/shipping.jhtml",i).then((function(i){t.dialogShipping=!0,t.title=t.getUser().shop?t.getUser().shop.name+"发货单":"发货单",t.formShipping=i.order,t.shippingId=e,t.shippingsPrint=i.shipping,t.gridData=i.shipping.shippingItems})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},addLogistics:function(){this.isShipped=!1,this.form.shippingMethodId="",this.form.isLCL="",this.form.deliveryCorpId="",this.form.expressSn="",this.form.freight="",this.form.address="",this.form.consignee="",this.form.receiveStore="",this.form.phone="",this.showLogistics=!0,this.init()},init:function(){var e=this;console.log("init"),p["a"].viewOrder({orderId:this.itemId},(function(t){e.form.address=t.order.address,e.form.consignee=t.order.consignee,e.form.receiveStore=t.order.receiveStore,e.form.phone=t.order.phone,e.form.shippings=t.order.shippings,e.form.orderItems=t.order.orderItems,"2"===t.order.shippingStatus||"3"===t.order.shippingStatus?e.operations[0].class="hidden":e.operations[0].class="show",e.orderItems=t.order.orderItems,console.log(e.form),e.shippingMethod=t.shippingMethods,e.deliveryCorps=t.deliveryCorps}),(function(t){e.$message.warning(t.errorMessage)}))},save:function(){var e=this;this.$refs.logisticsForm.validate((function(t,i){if(!t)return!1;e.loading=!0;var r="";e.shippingMethod.map((function(t){t.id===e.form.shippingMethodId&&(r=t.name)}));var a="";e.deliveryCorps.map((function(t){t.id===e.form.deliveryCorpId&&(a=t.name)}));var s=[];if(e.form.orderItems.forEach((function(e,t){0===e.unShippedQuantity&&s.push(e)})),s.length===e.form.orderItems.length)return e.$message.warning("本次发货数量不能为0"),e.loading=!1,!1;var o={id:e.itemId,shippingMethodId:e.form.shippingMethodId,isLCL:e.form.isLCL,deliveryCorpId:e.form.deliveryCorpId,expressSn:e.form.expressSn,freight:e.form.freight,address:e.form.address,consignee:e.form.consignee,receiveStore:e.form.receiveStore,phone:e.form.phone,shippingMethod:r,logistics:a,shippingItems:e.form.orderItems.map((function(e){return{orderItemId:e.id,quantity:e.unShippedQuantity,name:e.fullName}}))},n=function(t){e.$message.success("保存成功"),e.init(),e.$emit("operationSuccess",e.form.id),e.showLogistics=!1,e.loading=!1},l=function(t){t.errorMessage&&e.$message.warning(t.errorMessage),e.loading=!1},c=function(t){e.loading=!1};y["a"].put("/admin/purchaseOrderManage/partialShipping.jhtml",o).then(n).catch(l).finally(c)}))},detailClickHandler:function(e){var t=this;console.log(e),this.isShipped=!0,e.shippingItems.map((function(e){t.orderItems.map((function(t){e.name===t.name&&(e.product=t.product)})),e.shippedQuantity=e.quantity})),this.form.orderItems=e.shippingItems,this.form.isLCL=e.isLCL,this.form.deliveryCorpId=e.deliveryCorpId,this.form.expressSn=e.expressSn,this.form.freight=e.freight,this.form.address=e.address,this.form.consignee=e.consignee,this.form.receiveStore=e.receiveStore,this.form.phone=e.phone,this.form.shippingMethodName=e.shippingMethod,this.shippingMethod.map((function(e){e.name===t.form.shippingMethodName&&(t.form.shippingMethodId=e.id,"1"===e.isNeedDelivery&&(t.showDelivery=!0))})),this.showLogistics=!0},followClickHandler:function(){this.$emit("goToOrderLogs")},operateHandler:function(e){this[e]()}}),watch:{itemId:function(e){this.showLogistics=!1,this.init(),"shipping"===this.handler?this.showLogistics=!0:this.showLogistics=!1},form:{deep:!0,immediate:!0,handler:function(e){var t=this;this.showDelivery=!1,this.showReceiver=!1,this.shippingMethod.map((function(i){i.id===e.shippingMethodId&&"1"===i.isNeedDelivery&&(t.showDelivery=!0),i.id===e.shippingMethodId&&"1"===i.isNeedReceiver&&(t.showReceiver=!0)}))}}}},R=L,P=(i("b2d0"),Object(k["a"])(R,O,D,!1,null,null,null)),N=P.exports,A=i("9462"),z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-history"},[i("biz-list",{ref:"table",attrs:{tableData:e.tableData,loading:e.loading,height:e.height}},[i("el-table-column",{attrs:{prop:"orderTime",label:"时间"}}),i("el-table-column",{attrs:{prop:"plateNumber",label:"会员车辆"}}),i("el-table-column",{attrs:{prop:"price",label:"服务分类"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[e._v(" "+e._s((t.row.orderType,"普通服务"))+" ")])])}}])}),i("el-table-column",{attrs:{prop:"quantity",label:"服务项目"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},e._l(t.row.orderItems,(function(t){return i("div",{key:t.id,staticClass:"biz-customcol"},[e._v(" "+e._s(t.fullName)+" ")])})),0)}}])})],1),i("biz-pagination",{attrs:{pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)},E=[],j=i("7558"),B=i("5c40"),q={name:"OrderHistory",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{loading:!1,height:"90%",tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:j["a"],BizPagination:B["a"],BizGrid:g["a"]},created:function(){this.getList()},watch:{itemId:function(e){this.itemId&&this.getList()}},methods:{getList:function(){var e=this;this.loading=!0;var t={orderId:this.itemId,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};p["a"].repairMaintainHistory(t,(function(t){e.loading=!1,e.tableData=t.content,e.pagination.total=Number(t.total)}),(function(t){e.loading=!1,console.log(t)}))},handleSizeChange:function(e){this.pagination.pageSize=e,this.getList()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.getList()}}},F=q,U=Object(k["a"])(F,z,E,!1,null,null,null),V=U.exports,H=i("3077"),G=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"rescue-setting"},[i("div",{staticClass:"top_header",attrs:{slot:"top"},slot:"top"},[e._v(" 分配方式： "),i("el-radio-group",{attrs:{size:"small"},model:{value:e.distributWay,callback:function(t){e.distributWay=t},expression:"distributWay"}},[i("el-radio",{attrs:{label:"1"}},[e._v("手动")]),i("el-radio",{attrs:{label:"0"}},[e._v("自动")])],1)],1),i("biz-flex-table",{ref:"biztable",attrs:{operations:e.operations,tableData:e.tableData,loading:e.loading,checkable:"1"!==e.distributWay},on:{operate:e.operate,"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{width:"200",prop:"name",label:"救援人员"}}),i("el-table-column",{attrs:{prop:"mobile",label:"手机号"}}),i("el-table-column",{attrs:{prop:"workerState",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{style:{color:e.stateColor(t.row)}},[e._v(e._s("1"===t.row.workerState?"任务中":"空闲"))])]}}])})],1)],1)},Q=[],Y={name:"RescueSetting",data:function(){return{distributWay:"1",loading:!1,selections:[],operations:[{label:"保存",name:"save",type:"primary"}],tableData:[]}},components:{BizFlexTable:c["c"],BizGrid:g["a"]},created:function(){},mounted:function(){},methods:{operate:function(e){this[e]()},refresh:function(){this.getList()},stateColor:function(e){return"0"===e.workerState?"#67c23a":"#f56c6c"},getList:function(){var e=this;p["a"].rescuers({shopId:window.top.SHOP_ID},(function(t){e.distributWay=t.shop.distributWay,e.tableData=t.workers,e.$nextTick((function(){var e=this;this.tableData.forEach((function(t){"1"===t.isOnGuard&&e.$refs.biztable.toggleRowSelection(t,!0)}))})),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},save:function(){var e=this;if(0===this.selections.length)return this.$message.warning("请选择一条记录"),!1;p["a"].rescuerSetting({distributWay:this.distributWay,shopId:window.top.SHOP_ID,ids:this.selections.map((function(e){return e.id}))},(function(t){e.$message.success("保存成功"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},operationSuccess:function(){this.getList()},handleSelectionChange:function(e){this.selections=e}}},W=Y,K=(i("ba46"),Object(k["a"])(W,G,Q,!1,null,null,null)),Z=K.exports,X=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"child-order-info"},[i("div",{staticClass:"order-info-div"},e._l(e.orderDatas,(function(t,r){return i("div",{key:r,staticClass:"order-info-content"},[i("div",{staticClass:"order-info-new"},[i("div",{staticClass:"order-sn"},[e._v(" 订单号： "),i("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(t.sn?t.sn:""))])]),e._l(t.orderItems,(function(t,r){return i("div",{key:r},[i("div",{staticClass:"good-info"},[i("div",{staticClass:"goods-img"},[i("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:t.thumbnail&&t.thumbnail.indexOf("/")>=0?t.thumbnail:e.defaultImg},on:{error:function(t){return e.imgError(r)}}})]),i("div",{staticClass:"good-right"},[i("div",{staticClass:"good-name"},[i("span",{staticStyle:{flex:"1"}},[e._v(e._s(t.fullName))])]),i("div",{staticClass:"good-price"},[i("span",[e._v("￥"+e._s(t.price))]),i("span",[e._v("X"+e._s(t.quantity))])])])])])})),i("div",{staticClass:"price-info-content"},[i("div",{staticClass:"total-price"},[i("span",{staticStyle:{"margin-right":"10px"}},[e._v("共"+e._s(t.count)+"件")]),i("span",[e._v("合计:￥"+e._s(t.amount))]),i("span",[e._v("(含运费"+e._s(t.freight)+"元)")])])])],2)])})),0)])},J=[],ee=i("e83a"),te=i.n(ee),ie=i("517a"),re=i.n(ie),ae={name:"child-order-info",data:function(){return{defaultImg:te.a,defaultFailImg:re.a,loading:!1,orderDatas:[]}},props:{itemId:{type:String}},watch:{itemId:function(e){this.itemId&&this.getOrderChildInfo()}},components:{BizGrid:g["a"]},computed:{},methods:{getOrderChildInfo:function(){var e=this,t={orderId:this.itemId};y["a"].get("/admin/purchaseOrderManage/storeSalesOrders/children.jhtml",t).then((function(t){e.orderDatas=t.dataList})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))}},created:function(){this.itemId&&this.getOrderChildInfo()}},se=ae,oe=(i("556a"),Object(k["a"])(se,X,J,!1,null,null,null)),ne=oe.exports,le=i("44e3"),ce=i("5719"),de=i("f606"),pe=i.n(de),ue=i("e0d7"),me=i("bea5"),fe=i("c596"),he=i("ce0c"),ge=i("a9f4"),ve=i("276c"),be=i("fc46"),ye=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"logistic-following"},[i("div",{staticClass:"product-info"},[i("div",{staticClass:"img"},[i("img",{attrs:{src:e.image||e.defaultProductImg}})]),i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v("物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s(e.logisticState))])]),i("div",{staticClass:"i-item"},[e._v("物流公司："+e._s(e.logistics))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]),e.shippingTraces&&e.shippingTraces.length>0?i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0)])]):e._e()])},Ie=[],_e={name:"LogisticsFollowing",components:{},data:function(){return{shippingSn:"",defaultProductImg:te.a,shippingTraces:[],state:"",logistics:"",expressSn:"",image:""}},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(_["c"])(["getUser"])),Object(_["c"])("Order",["curApplySaleItem","orderInfo"])),{},{logisticState:function(){switch(this.state){case"0":return"无轨迹";case"1":return"已揽收";case"2":return"在途中";case"201":return"到达派件城市";case"3":return"签收";case"4":return"问题件";default:return""}}}),props:{sn:{type:String,default:""}},watch:{},created:function(){},methods:{getLogisticsInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.sn};y["a"].get(fe["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.state=t.shipping.state,e.image=t.shipping.shippingItems.length>0?t.shipping.shippingItems[0].image:"",e.logistics=t.shipping.logistics,e.expressSn=t.shipping.expressSn,e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}},we=_e,Ce=(i("06c20"),Object(k["a"])(we,ye,Ie,!1,null,null,null)),Me=Ce.exports,Se=i("443b"),ke={name:"OrderMgmtList",data:function(){return{iconShop:pe.a,iframeSrc:"",showIframe:!1,openInvocie:!1,openReview:!1,editable:!1,auditState:"1",agentId:"",remarks:"",shippings:"",row:{},itemList:[],selectRadio:"shopReceiver",curSelectAjectReason:"申报的商品与实际需要采购的商品不符",reasonAjectList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}],closeDeccription:"",curSelectCloseReason:"",reasonList:[{label:"长时间联系不到客户，交易不成功",value:"长时间联系不到客户，交易不成功"},{label:"客户购买意向不明确，取消交易",value:"客户购买意向不明确，取消交易"},{label:"客户已通过其他渠道支付款项",value:"客户已通过其他渠道支付款项"},{label:"客户不想买了",value:"客户不想买了"},{label:"重复订单",value:"重复订单"},{label:"缺货，订单无法完成",value:"缺货，订单无法完成"},{label:"其他理由",value:"其他理由"}],errorImg:'this.src="'+i("b89e")+'"',showCloseOrder:!1,showPassOrder:!1,curSelectDateType:"全部",dateTypeList:["全部","今日订单","近一周订单","近一月订单","近三月订单"],tabName:"info",settingName:"setting",memberName:"memberInfo",memberInfo:!1,showRecommend:!1,itemId:"",userId:"",sn:"",invoiceInfoId:"",isRalateBill:!1,invoiceId:"",title:"",handler:"",memberId:{id:""},editShopIds:[],orderIds:[],openPurchase:!1,purchaseId:"",purchaseOrderId:"",openPurchaseOrder:!1,openOrderSale:!1,orderSaleId:"",isEdit:!0,form:{},userCard:{},paymentMethodName:"",paymentMethodId:"",orderType:"",orderState:"",mergeState:"",invoiceState:"",price:"",realName:"",orderId:"",defaultTab:"0",activeNames:["1"],loading:!1,loadingReturnPurchase:!1,visiable:!1,open:!1,openSetting:!1,dialogTableVisible:!1,selections:[],orderList:[],showMergeOrder:!1,selectedOrderIds:[],selectionList:[],mergeOrderId:"",showOrderContactor:!1,contactorList:[],invoiceList:[],isChecked:"1",returnOrderId:"",returnOrderList:[],showReturnPurchase:!1,dialogVisiable:!1,showAddress:!0,payType:"",payOptions:[],type:"",receiver:{},shippingMethodId:"",options:[],invoiceChecked:!1,openLogistics:!1,dialogVisiableInvoice:!1,receiverId:"",receivers:[],freight:0,getAddress:{},leaveMessage:"",productGroupWithNoSupplier:[],productGroupNoSupplierPrice:[],selectionProduct:[],isSelected:"1",supplierId:"",getInvoice:{},agentAddress:{},operations:[{label:"添加",name:"add",type:"primary",class:"hidden"},{label:"刷新",name:"refresh",type:""},{label:"导出",name:"export",type:"",auth:["admin:saleOrder.export"]},{label:"合并开票",name:"mergeInvioce",type:"",disabled:!0}],filters:[{type:"select",label:"代理商",name:"shop",value:[],class:"hidden",filterable:!0,multiple:!0,collapseTags:!0,options:[{value:"",label:"全部"}]},{type:"select",label:"店铺",name:"shop",value:"",class:"hidden",options:[]},{type:"select",label:"顾问",name:"consultantId",value:"",class:"hidden",options:[]},{type:"select",label:"状态",name:"state",value:"",class:"hidden",options:[{value:"",label:"全部"},{value:"1",label:"待商家确认"},{value:"2",label:"商家已确认"},{value:"3",label:"买家已付款"},{value:"4",label:"订单已执行"},{value:"5",label:"交易完成"},{value:"6",label:"订单关闭"},{value:"7",label:"已评价"},{value:"9",label:"退款退货中"},{value:"11",label:"已确认收货"},{value:"12",label:"部分支付"},{value:"13",label:"部分发货"}]},{type:"select",label:"发票",name:"invoiceState",value:"",class:"hidden",options:[{value:"",label:"全部"},{value:"0",label:"待开票"},{value:"1",label:"待邮寄"}]},{type:"select",label:"时间类型",name:"dateType",value:"0",class:"hidden",options:[{value:"0",label:"创建时间"},{value:"1",label:"完成时间"}]},{type:"daterange",label:"日期",class:"hidden",name:"publishDate",value:[]},{type:"input",label:"",placeholder:"请输入订单编号/姓名/电话/条码",name:"searchValue",value:""}],tableData:[],gridData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9},dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizPopupTabs:l["a"],BizFlexTable:c["c"],BaseInfo:u["a"],ProductInfo:m["a"],OrderLogs:x,AfterProcess:A["a"],InvoiceInfo:H["a"],RescueSetting:Z,OrderHistory:V,MembershipMgmtBaseInfo:ue["a"],MembershipMgmtVehicleInfo:me["a"],vueEasyPrint:I["a"],BizDialogSelector:d["a"],OrderChildInfo:ne,BillInfo:le["a"],ReturnInvoiceInfo:ce["a"],LogisticsInfo:N,PurchaseOrderInfo:ve["a"],PurchaseApplyInfo:ge["a"],OrderSaleInfo:u["a"],OrderSaleProductInfo:m["a"],MyEvaluate:be["a"],LogisticsFollowing:Me},created:function(){this.orderType=this.$route.params.orderType||"",this.getList(),this.queryOrderKpi(),this.getEditableStoresByAgent(),this.listAdminByRole(),this.getEditableStores(),this.queryShopList()},watch:{$route:function(e,t){Object.assign(this.$data,this.$options.data()),this.orderType=this.$route.params.orderType||"",this.getList(),this.queryOrderKpi(),this.listAdminByRole(),this.getEditableStores(),this.queryShopList()}},computed:Object(n["a"])(Object(n["a"])({},Object(_["c"])("Authority",["currentAuth"])),{},{hasAuthEdit:function(){return this.currentAuth.includes("admin:saleOrder.edit")},toggleRecommendTxt:function(){var e=this.showRecommend;return e?"收起":"筛选"},getAmount:function(){var e=0;return e=Number(Number(this.getCountMouny)+Number(this.getFreight)).toFixed(2),e>=0?e:0},getFreight:function(){var e,t,i=Object(o["a"])(this.returnOrderList);try{for(i.s();!(t=i.n()).done;){var r=t.value;e="顺丰速递"===r.type?20:0}}catch(a){i.e(a)}finally{i.f()}return e},getCountMouny:function(){var e,t=0,i=Object(o["a"])(this.returnOrderList);try{for(i.s();!(e=i.n()).done;)for(var r=e.value,a=r.cartItems,s=a.length,n=0;n<s;n++)"1"===a[n].isSelected&&(t+=a[n].product.price*a[n].quantity)}catch(l){i.e(l)}finally{i.f()}return parseFloat(t).toFixed(2)}}),mounted:function(){},mixins:[Se["a"]],methods:Object(n["a"])(Object(n["a"])({},Object(_["c"])(["getUser"])),{},{operate:function(e){this[e]()},closeTabByLogistics:function(e){var t=this;this.tabName="loginfoTab",this.sn=e,this.openPurchaseOrder=!1,this.openLogistics=!0,this.$nextTick((function(){t.$refs.logistics.getLogisticsInfo()}))},closeTabByEvaluate:function(e,t){var i=this;this.openPurchaseOrder=!1,this.tabName="reviewinfo",this.itemId="","5"!==t&&(this.editable=!1),this.openReview=!0,this.$nextTick((function(){i.$refs.reviewinfo.getOrderInfo(e)}))},clickRelateBill:function(e,t){var i=this;e.stopPropagation(),"0"===t.relateBillType?(this.tabName="info",this.purchaseId=t.relateBill,this.openPurchase=!0,this.isEdit=!1):"2"===t.relateBillType?(this.tabName="info",this.purchaseOrderId=t.relateBill,this.openPurchaseOrder=!0,this.$nextTick((function(){i.$refs.orderinfo.getOrderInfo()})),this.isRalateBill=!0,this.isEdit=!1):(this.tabName="orderSaleInfo",this.orderSaleId=t.relateBill,this.openOrderSale=!0,this.$nextTick((function(){i.$refs.orderSaleInfo.init()})),this.isEdit=!1)},toPass:function(e,t){this.remarks="",this.row=e,this.showPassOrder=!0},goToOrderLogs:function(){this.tabName="loginfo",this.open=!0},statusChange:function(e,t){var i=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.loading=!0;var r={shopId:window.top.SHOP_ID||"",id:e.id,actionType:t,details:"2"===t?i.curSelectAjectReason:"",remarks:i.remarks};y["a"].post("/admin/purchaseOrderManage/audit.jhtml",r).then((function(e){i.$message.success("操作成功！"),i.showPassOrder=!1,i.loading=!1,i.refresh()})).catch((function(e){i.loading=!1,e.errorMessage&&i.$message.warning(e.errorMessage)})).finally((function(){}))}))},isShow:function(){this.showRecommend?(this.filters[0].class="hidden",this.filters[1].class="hidden",this.filters[2].class="hidden",this.filters[3].class="hidden",this.filters[4].class="hidden",this.filters[5].class="hidden",this.filters[6].class="hidden"):(this.filters[0].class="show",this.filters[1].class="show",this.filters[2].class="show",this.filters[3].class="show",this.filters[4].class="show",this.filters[5].class="show",this.filters[6].class="show"),this.showRecommend=!this.showRecommend},xrorder:function(){this.iframeSrc="http://122.143.21.152/xymx/userinajLoginAction.action?name=jianwl&&pwd=123456",this.showIframe=!0},logistics:function(e){this.iframeSrc="http://122.143.21.152/xymx/getzaitupageDeliveryAction.action?num="+e,this.showIframe=!0},refresh:function(){this.itemId="",this.flag=!0,this.getList()},operationSuccess:function(){this.open=!1,this.getList()},queryShopList:function(){var e=this;y["a"].get(fe["o"].mainPage.shopList,{shopId:window.top.SHOP_ID||"",sourceType:"4"}).then((function(t){var i=t.shops;i.map((function(e){e.value=e.id,e.label=e.name})),i.unshift({value:"",label:"全部"}),e.$set(e.filters[1],"options",i)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},cancelClose:function(){this.showCloseOrder=!1},confirmClose:function(){var e=this;this.curSelectCloseReason?(this.showCloseOrder=!1,this.loading=!0,p["a"].closeOrder({orderId:this.itemId,shopId:window.top.SHOP_ID||"",reason:this.curSelectCloseReason,memo:this.closeDeccription},(function(t){e.loading=!1,e.$message.success("操作成功"),e.getList()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))):this.$message.warning("请选择关闭理由")},onChangeDateType:function(e){switch(e){case"今日订单":this.filters[6].value=[he["a"].today(),he["a"].today()];break;case"近一周订单":this.filters[6].value=[he["a"].getBeforeWeek(),he["a"].today()];break;case"近一月订单":this.filters[6].value=[he["a"].getPreOneMonthDay(),he["a"].today()];break;case"近三月订单":this.filters[6].value=[he["a"].getPreThreeMonthDay(),he["a"].today()];break;default:this.filters[6].value=[];break}this.getList()},getType:function(e){switch(e){case"0":return"车品订单";case"1":return"充值订单";case"2":return"服务订单";case"3":return"一键救援订单";case"4":return"服务订单";case"5":return"服务订单";case"6":return"预约置换订单";case"7":return"贷款购车订单";case"8":return"试乘试驾订单";case"9":return"整车订单";case"10":return"普通订单";case"17":return"优惠券订单";default:return""}},getEditableStoresByAgent:function(){var e=this;y["a"].get("/admin/cooperationInfo/cooperationInfos.jhtml",{cooperationType:"1",pageSize:1e3,pageNumber:1}).then((function(t){e.filters[0].options=[{value:"",label:"全部"}].concat(t.dataList.map((function(e){return{label:e.name,value:e.id}})))})).catch((function(e){console.log(e),console.log("code错误")}))},getEditableStores:function(){var e=this;y["a"].get(fe["j"].editableStores,{resourceType:"4"}).then((function(t){e.editShopIds=[],t.dataList.map((function(t){e.editShopIds.push(t.id)}))})).catch((function(e){console.log(e),console.log("code错误")}))},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1,a=t.getDate(),s=i+"-"+(r<10?"0"+r:r)+"-"+(a<10?"0"+a:a);return s},listAdminByRole:function(){var e=this,t="";t="car"===this.$route.params.orderType?["salesman"]:["afterSale","reception","testDriver"],p["a"].listAdminByRole({roleTypes:t},(function(t){e.loading=!1,e.filters[2].options=[{label:"全部",value:""}].concat(t.dataList.map((function(e){return{label:e.name,value:e.id}})))}),(function(e){console.log(e)}))},cancle:function(e){var t=document.querySelectorAll(".el-popover").length-1;document.querySelectorAll(".el-popover")[t].style.display="none"},setOrderItems:function(e){this.tabName="info",this.$refs.baseInfo.setOrderItems(e)},print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var i,r,a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={orderId:e.orderId},t.prev=1,t.next=4,C.a.post("/admin/purchaseOrder/voucher/export/settlement.jhtml",i,{responseType:"blob"});case 4:return r=t.sent,console.log("response => ",r),a=new Blob([r.data],{type:"application/vnd.ms-excel"}),s=decodeURI(r.headers["content-disposition"].split("filename=")[1]),o=document.createElement("a"),o.download=s.match(/"(\S*)"/)[1],o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},certificate:function(e){var t=this;window.dType=e.dType,p["a"].certificate({orderId:e.id,shopId:window.top.SHOP_ID||""},(function(i){t.dialogTableVisible=!0,t.title=t.getUser().shop?t.getUser().shop.name+"结算单":"结算单",t.form=i.order,t.orderId=e.id,t.form.agentName=e.agent.name,t.realName=i.adminCurrent?i.adminCurrent.realName:"",t.userCard=i.userCard,t.gridData=i.order.orderItems}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},setting:function(){this.$refs.settingInfo.getList(),this.openSetting=!0},queryOrderKpi:function(){var e=this;y["a"].get("/admin/purchaseOrderManage/kpi.jhtml",{shopId:window.top.SHOP_ID||"",type:"2"}).then((function(t){e.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:"今日新增".concat(t.data.dayNewAdd,"条，待审核").concat(t.data.dayUnconfirmed,"条，待发货").concat(t.data.dayConfirmed,"条"),duration:3e3})})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},memberClick:function(e){this.$refs.memberInfo.operations=[],this.$refs.carInfo.operations=[],this.$refs.carInfo.ishandler=!1,this.memberId={id:e.member.id},this.memberInfo=!0},export:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var i,r,a,s,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=[],e.selections&&e.selections.length>0&&e.selections.forEach((function(e){i.push(e.id)})),r={ids:i,orderId:e.$route.query.orderId||"",orderType:e.orderType||"",agentIds:e.filters[0].value,shopId:e.filters[1].value||window.top.SHOP_ID||"",consultantId:e.filters[2].value||"",state:e.filters[3].value||"",invoiceState:e.filters[4].value||"",dateType:e.filters[5].value||"",beginTime:e.filters[6].value[0]?e.filters[6].value[0]+" 00:00:00":"",endTime:e.filters[6].value[1]?e.filters[6].value[1]+" 23:59:59":"",pageable:{pageSize:e.pagination.pageSize,pageNumber:e.pagination.currentPage,searchValue:e.filters[7].value}},t.prev=3,t.next=6,C.a.post("/admin/purchaseOrderManage/storeSalesOrders/export.jhtml",r,{responseType:"blob"});case 6:return a=t.sent,console.log("response => ",a),s=new Blob([a.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(a.headers["content-disposition"])),o=decodeURI(a.headers["content-disposition"].split("filename=")[1]),n=document.createElement("a"),n.download=o.match(/"(\S*)"/)[1],n.style.display="none",n.href=URL.createObjectURL(s),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n),t.abrupt("return");case 22:throw t.prev=22,t.t0=t["catch"](3),new Error(t.t0);case 25:case"end":return t.stop()}}),t,null,[[3,22]])})))()},add:function(){window.dType="order",this.isEdit=!0,this.tabName="productinfo",this.$refs.productinfo.tableData=[],this.$refs.baseInfo.orderItems=[],this.$refs.productinfo.form.products="",this.$refs.productinfo.subTotal="",this.$refs.baseInfo.resetFormData(),this.itemId="",this.activeNames=["1","2","4","5"],this.$refs.baseInfo.selectedTags=[],this.$refs.baseInfo.imageList=[],this.$refs.baseInfo.orderOptions(),this.open=!0,this.handler="","service"===this.$route.params.orderType&&this.$refs.baseInfo.getStoreTags()},rowClick:function(e,t,i){this.itemList=[],window.dType=e.dType,this.tabName="info",this.shippings=e.shippings,this.orderState=e.type,this.mergeState=e.isMerged,this.itemId=e.id,this.agentId=e.agent.id,this.userId=e.member.id,this.invoiceInfoId=e.invoiceInfoId,this.invoiceId=e.invoiceId,this.activeNames=["1"],this.open=!0,this.handler="",this.invoiceState=e.invoiceState,this.price=e.amount,this.paymentMethodName=e.paymentMethodName;var r,a=Object(o["a"])(e.shippings);try{for(a.s();!(r=a.n()).done;){var s=r.value;this.itemList.push(s.shippingItems)}}catch(n){a.e(n)}finally{a.f()}this.isRalateBill=!1,"0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel||"0"===e.isValid?this.isEdit=!1:this.hasAuthEdit?this.isEdit=!0:this.isEdit=!1},getList:function(){var e=this;this.loading=!0;var t={orderId:this.$route.query.id||"",agentIds:this.filters[0].value,shopId:this.filters[1].value||window.top.SHOP_ID||"",dateType:this.filters[5].value,orderType:this.orderType,consultantId:this.filters[2].value||"",state:this.filters[3].value,invoiceState:this.filters[4].value||"",beginTime:this.filters[6].value[0]?this.filters[6].value[0]+" 00:00:00":"",endTime:this.filters[6].value[1]?this.filters[6].value[1]+" 23:59:59":"",pageable:{pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,searchValue:this.filters[7].value}};y["a"].post("/admin/purchaseOrderManage/storeSalesOrders.jhtml",t).then((function(t){e.loading=!1,e.tableData=t.dataList,e.pagination.total=Number(t.total)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},service:function(e){this.orderState=e.type,window.dType=e.dType,this.tabName="info",this.shippings=e.shippings,this.itemId=e.id,this.activeNames=["2"],this.handler="service","0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel||"0"===e.isValid?this.isEdit=!1:this.hasAuthEdit?this.isEdit=!0:this.isEdit=!1,this.open=!0},serviceHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.tabName="productinfo",this.shippings=e.shippings,this.itemId=e.id,this.activeNames=["2"],this.handler="service","0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel||"0"===e.isValid?this.isEdit=!1:this.hasAuthEdit?this.isEdit=!0:this.isEdit=!1,this.open=!0},shippingHandler:function(e){var t=this;this.itemList=[],window.dType=e.dType,this.orderState=e.type,this.tabName="logisticsinfo",this.itemId=e.id,this.handler="shipping",this.shippings=e.shippings;var i,r=Object(o["a"])(e.shippings);try{for(r.s();!(i=r.n()).done;){var a=i.value;this.itemList.push(a.shippingItems)}}catch(s){r.e(s)}finally{r.f()}"0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel||"0"===e.isValid?this.isEdit=!1:this.hasAuthEdit?this.isEdit=!0:this.isEdit=!1,this.open=!0,this.$nextTick((function(){t.$refs.logisticsinfo.init()}))},paymentHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.tabName="info",this.shippings=e.shippings,this.itemId=e.id,this.activeNames=["4"],this.handler="payment","0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel||"0"===e.isValid?this.isEdit=!1:this.hasAuthEdit?this.isEdit=!0:this.isEdit=!1,this.open=!0},refundsHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.shippings=e.shippings,this.itemId=e.id,this.tabName="afterprocess","0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel||"0"===e.isValid?this.isEdit=!1:this.hasAuthEdit?this.isEdit=!0:this.isEdit=!1,this.open=!0,this.$refs.afterprocess.initData()},invoiceHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.open=!0,this.tabName="invoice",this.shippings=e.shippings,this.itemId=e.id,this.userId=e.member.id,this.invoiceInfoId=e.invoiceInfoId,this.invoiceId=e.invoiceId,this.price=e.amount,"0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel||"0"===e.isValid?this.isEdit=!1:this.hasAuthEdit?this.isEdit=!0:this.isEdit=!1},mergeInvioce:function(){var e=this;window.dType="purchaseOrder",this.itemId=this.selections[0].id,this.invoiceInfoId=this.selections[0].invoiceInfoId,this.invoiceId=this.selections[0].invoiceId,this.userId=this.selections[0].member.id,this.orderState="1",this.openInvocie=!0,this.shippings=this.selections[0].shippings,this.tabName="invoice",this.orderIds=[],this.price=0,this.selections.forEach((function(t){e.orderIds.push(t.id),e.price=Number(t.amount)+Number(e.price)})),this.price=this.price.toFixed(2)},mergeOrder:function(e){this.mergeOrderId=e.id,this.orderList=[],this.dialogPagination={pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},this.selectedOrderIds.splice(0,this.selectedOrderIds.length),this.getOrderList(),this.showMergeOrder=!0},getOrderList:function(){var e=this,t={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,shopId:window.top.SHOP_ID||"",orderId:this.mergeOrderId};y["a"].get("/admin/purchaseOrderManage/storeSalesOrders/mergeList.jhtml",t).then((function(t){e.orderList=t.dataList,e.dialogPagination.total=Number(t.total)})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)}))},getMergeinfo:function(){var e=this,t={shopId:window.top.SHOP_ID||"",orderId:this.mergeOrderId,ids:this.selectedOrderIds};y["a"].post("/admin/purchaseOrderManage/storeSalesOrders/mergeinfo.jhtml",t).then((function(t){e.contactorList=t.receivers,e.invoiceList=t.invoices,e.invoiceList.map((function(t){e.$set(t,"isChecked","0")})),e.contactorList.map((function(t){e.$set(t,"isChecked","0")})),e.contactorList.length>0&&(e.contactorList[0].isChecked="1"),e.invoiceList.length>0&&(e.invoiceList[0].isChecked="1")})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)}))},selectionChange:function(e){var t=this;e.forEach((function(e){-1===t.selectionList.indexOf(e)&&t.selectionList.push(e)}))},confirmedMergeOrder:function(e){this.selectedOrderIds=e.concat(),this.getMergeinfo(),this.showOrderContactor=!0},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.getOrderList()},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.getOrderList()},selectChange:function(e){this.contactorList.map((function(t){t.consignee!==e.consignee&&(t.isChecked="0")}))},selectChangeByInvoice:function(e){this.invoiceList.map((function(t){t.invoiceTitle!==e.invoiceTitle&&(t.isChecked="0")}))},radioChange:function(e){this.receiver="agencyReceiver"===e?{consignee:this.agentAddress.consignee,areaName:this.agentAddress.areaName,address:this.agentAddress.address,zipCode:this.agentAddress.zipCode,phone:this.agentAddress.phone,shop:{name:this.agentAddress.operatorName}}:{}},selectReturnOrder:function(e){},confirmMerge:function(){var e,t=this,i={},r={},a=Object(o["a"])(this.contactorList);try{for(a.s();!(e=a.n()).done;){var s=e.value;"1"===s.isChecked&&(i.address=s.address,i.areaName=s.areaName,i.consignee=s.consignee,i.phone=s.phone)}}catch(p){a.e(p)}finally{a.f()}var n,l=Object(o["a"])(this.invoiceList);try{for(l.s();!(n=l.n()).done;){var c=n.value;"1"===c.isChecked&&(r.invoiceTitle=c.invoiceTitle,r.code=c.code,r.registerAddress=c.registerAddress,r.registerMobile=c.registerMobile,r.bank=c.bank,r.account=c.account,r.contacts=c.contacts,r.mobile=c.mobile,this.$set(r,"area",{id:c.area?c.area.id:""}),r.address=c.address,r.invoiceType=c.invoiceType)}}catch(p){l.e(p)}finally{l.f()}this.selectedOrderIds.unshift(this.mergeOrderId);var d={ids:this.selectedOrderIds,receiver:i,invoice:r};y["a"].post("/admin/purchaseOrderManage/storeSalesOrders/merge.jhtml",d).then((function(e){t.$message.success("订单合并成功"),t.showOrderContactor=!1,t.refresh()})).catch((function(e){e.errorMessage&&(t.selectedOrderIds=[],t.$message.warning(e.errorMessage))}))},excuteHandler:function(e){window.dType=e.dType,this.orderState=e.type,this.tabName="info",this.itemId=e.id,this.activeNames=["2"],this.handler="service",this.open=!0},confirmOrder:function(e){var t=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){window.dType=e.dType,p["a"].confirmOrder({orderId:e.id,shopId:window.top.SHOP_ID||""},(function(e){t.loading=!1,t.$message.success("操作成功"),t.getList()}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))}))},closeOrder:function(e){this.itemId=e.id,window.dType=e.dType,this.showCloseOrder=!0,this.curSelectCloseReason="",this.closeDeccription=""},select:function(e,t){console.log(t)},handleSelectionChange:function(e){this.selections=e,this.operations[3].disabled=!0,this.selections=e,e.length>0&&(this.operations[3].disabled=!1);var t=[];for(var i in this.selections)-1===t.indexOf(this.selections[i].agent.id)&&t.push(this.selections[i].agent.id);t.length>1&&(this.operations[3].disabled=!0)},filterDataChange:function(e){this.pagination.currentPage=1,this.refresh()},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},returnOrder:function(e){this.returnOrderId=e.id,this.selectRadio="shopReceiver",window.dType="purchaseOrder",this.receiver={},this.returnOrderList=[],this.invoiceChecked=!1,this.getAgentAddress(),this.getReturnPurchase(),this.showReturnPurchase=!0},getReturnPurchase:function(){var e=this,t={shopId:window.top.SHOP_ID||"",orderId:this.returnOrderId};y["a"].get("/admin/purchaseOrder/toPurchase/productGroup.jhtml",t).then((function(t){e.returnOrderList=t.productGroup,e.productGroupWithNoSupplier=t.productGroupNoSupplier,e.productGroupNoSupplierPrice=t.productGroupNoSupplierPrice,e.selectionProduct=[],e.returnOrderList=t.productGroup.map((function(t,i){var r,a=Object(o["a"])(t.cartItems);try{for(a.s();!(r=a.n()).done;){var s=r.value;e.$set(s,"isSelected","1")}}catch(n){a.e(n)}finally{a.f()}return{cartItems:t.cartItems,supplier:t.supplier,memo:t.memo,paymentMethodId:t.paymentMethodId,shippingMethodId:t.shippingMethodId}})),e.returnOrderConfirm()})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getAgentAddress:function(){var e=this;p["a"].viewOrder({orderId:this.returnOrderId},(function(t){e.agentAddress=t.order}),(function(t){e.$message.warning(t.errorMessage)}))},clickAdress:function(){this.dialogVisiable=!0},paymentChange:function(e,t){},inputChange:function(e,t){for(var i=this.options,r=this.options.length,a=0;a<r;a++)if(e===i[a].id)return"0"===i[a].isNeedReceiver?(this.receiverId="",this.showAddress=!1):(this.receiverId=this.receivers[0].id,this.getAddress=this.receivers[0],this.showAddress=!0),void this.refreshFreight(i[a].name)},refreshFreight:function(e){this.freight="顺丰速递"===e?20:0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e,this.receiverId=e.id},selectedInvoice:function(e){this.dialogVisiableInvoice=!1,this.getInvoice=e,this.invoiceChecked=!0,this.invoiceId=e.id},returnOrderConfirm:function(){var e=this,t="";t=fe["g"].hypermarketMgmt.fillIn;var i,r=Object(o["a"])(this.returnOrderList);try{var a=function(){var r=i.value,a={cartItems:r.cartItems,methodName:"",clientType:"2",shopId:e.getUser().shop.id,userId:e.getUser().id,orderType:"0"};a.methodName="FillInOrder",y["a"].post(t,a).then((function(t){e.receiverId=t.receivers[0].id,e.getAddress.consignee=t.receivers[0].consignee,e.getAddress.phone=t.receivers[0].phone,e.getAddress.areaName=t.receivers[0].areaName,e.getAddress.address=t.receivers[0].address,e.receivers=t.receivers,e.payOptions=t.paymentMethods,e.options=t.shippingMethods,e.payType=t.paymentMethods[0].name,e.type=t.shippingMethods[0].name,r.paymentMethodId=t.paymentMethods[0].id,r.shippingMethodId=t.shippingMethods[0].id,t.shippingMethods&&t.shippingMethods.length&&("0"===t.shippingMethods[0].isNeedReceiver?e.showAddress=!1:e.showAddress=!0)})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){}))};for(r.s();!(i=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}},invoiceChange:function(e){var t=this;if(console.log(e),e){var i={clientType:"2",userId:this.getUser().id,shopId:this.getUser().shop.id};y["a"].get(fe["g"].hypermarketMgmt.invoiceInfos,i).then((function(e){t.getInvoice=e.invoices[0],t.invoiceId=e.invoices[0].id})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}},clickInvoiceInfo:function(){this.dialogVisiableInvoice=!0},submit:function(){if(this.getAddress&&this.getAddress.address||!("在线支付"===this.payType&&this.showAddress||"货到付款"===this.payType)){console.log(this.returnOrderList);var e,t=!1,i=Object(o["a"])(this.returnOrderList);try{for(i.s();!(e=i.n()).done;)for(var r=e.value,a=r.cartItems.length-1;a>=0;a--){if(!Number.isInteger(r.cartItems[a].quantity))return void this.$message.warning("数量不正确");"1"===r.cartItems[a].isSelected&&(t=!0)}}catch(s){i.e(s)}finally{i.f()}if(!t)return this.$message.warning("请选择商品"),!1;this.confirmReturnOrder()}else this.$message.warning("请设置收货地址")},confirmReturnOrder:function(){var e=this;if("shopReceiver"===this.selectRadio){var t,i=Object(o["a"])(this.returnOrderList);try{for(i.s();!(t=i.n()).done;){var r=t.value;r.receiverId=this.receiverId,r.invoiceId=this.invoiceId;for(var a=r.cartItems.length-1;a>=0;a--)"1"!==r.cartItems[a].isSelected&&r.cartItems.splice(a,1);this.selectionProduct.push(r)}}catch(p){i.e(p)}finally{i.f()}}else{var s,n=Object(o["a"])(this.returnOrderList);try{for(n.s();!(s=n.n()).done;){var l=s.value;l.receiver=this.receiver,l.invoiceId=this.invoiceId;for(var c=l.cartItems.length-1;c>=0;c--)"1"!==l.cartItems[c].isSelected&&l.cartItems.splice(c,1);this.selectionProduct.push(l)}}catch(p){n.e(p)}finally{n.f()}}this.loadingReturnPurchase=!0;var d={isAgentAddress:"shopReceiver"===this.selectRadio?"0":"1",productGroup:this.selectionProduct,orderId:this.returnOrderId,userId:this.getUser().id,shopId:this.getUser().shop.id};y["a"].post("/admin/purchaseOrder/toPurchase/create.jhtml",d).then((function(t){e.$message.success("操作成功"),e.showReturnPurchase=!1,e.loadingReturnPurchase=!1,e.refresh()})).catch((function(t){e.$message.warning(t.errorMessage),e.loadingReturnPurchase=!1}))},getOrderStatus:function(e){switch(e.type){case"13":return"部分发货";case"12":return"部分支付";case"11":return"已确认发货";case"10":return"退款退货完成";case"9":return"退款退货中";case"8":return"已过期";case"7":return"已评价";case"6":return"订单关闭";case"5":return"交易完成";case"4":return"订单已执行";case"3":return"买家已付款";case"2":return"商家已确认";case"1":return"待商家确认";default:return"无"}},getInvoiceStatus:function(e){switch(e.invoiceState){case"5":return"已开票";case"4":return"已撤销";case"3":return"已签收";case"2":return"已邮寄";case"1":return"待邮寄";case"0":return"待开票";default:return"未申请"}},orderConfirm:function(e){var t=this;p["a"].orderConfirm({orderId:e.order.id,shopId:window.top.SHOP_ID||""},(function(e){t.$message.success("操作成功"),t.loading=!1}),(function(e){console.log(e),t.$message.warning(e.errorMessage),t.loading=!1}))},messagePendingDeal:function(e){var t=this,i=[];i.push(e.messageId),this.loading=!0,this.$confirm("是否确认处理?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){p["a"].messagePendingDeal({ids:i},(function(e){t.$message.success("操作成功"),t.loading=!1,t.getList()}),(function(e){console.log(e),t.loading=!1}))}),(function(){t.loading=!1}))}})},Te=ke,xe=(i("9fda"),Object(k["a"])(Te,r,a,!1,null,null,null));t["default"]=xe.exports},"57a5":function(e,t,i){"use strict";var r=i("b84c"),a=i.n(r);a.a},5801:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-product-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),i("el-form",{attrs:{inline:!0,disabled:!e.isEdit,"inline-message":!0}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addProduct}},[e._v("新增")]),i("el-form-item",{staticClass:"subTotal",attrs:{label:"合计:",prop:"subTotal"}},[e._v(e._s(e.subTotal))])],1),i("biz-list",{key:Math.random(),ref:"table",staticStyle:{width:"100%",height:"100%"},attrs:{tableData:e.tableData,loading:e.loading}},[i("el-table-column",{attrs:{prop:"sn",label:"编号"}}),i("el-table-column",{attrs:{prop:"fullName",label:"商品名称"}}),i("el-table-column",{attrs:{prop:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{prop:"price",label:"商品价格"}}),i("el-table-column",{attrs:{prop:"minimumPackQuantity",label:"最小包装数","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.minimumPackQuantity?t.row.product.minimumPackQuantity:""))]}}])}),i("el-table-column",{attrs:{prop:"quantity",label:"数量","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input-number",{attrs:{size:"mini",min:1},on:{change:function(i){return e.quantityChange(t.row.quantity)}},model:{value:t.row.quantity,callback:function(i){e.$set(t.row,"quantity",i)},expression:"scope.row.quantity"}})],1)])}}])}),i("el-table-column",{attrs:{prop:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[e._v(e._s(t.row.quantity?(Number(t.row.quantity)*Number(t.row.price)).toFixed(2):"")+" ")])])}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作",type:"index"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e.isEdit?i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteHandeler(t)}}},[e._v("删除")])],1):e._e()])}}])})],1),i("biz-pagination",{attrs:{pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),i("el-dialog",{attrs:{visible:e.dialogTableVisible,center:"",width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.shippingData.sn))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("配送方式："+e._s(e.shippingData.shippingMethod))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingData.consignee))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingData.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:12}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("地址："+e._s(e.shippingData.address))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("买家留言："+e._s(e.shippingData.memo))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"})])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",width:"50",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"address",label:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:""))]}}],null,!0)}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("运费：￥"+e._s(e.formData.freight))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("优惠金额：￥"+e._s(e.formData.couponDiscount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("调整金额：￥"+e._s(e.formData.offsetAmount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单金额：￥"+e._s(e.formData.originalAmount))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("仓库签字：")])])],1)],1)])],1),i("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"选择商品",visibility:e.showDialog,tableData:e.giftList,pagination:e.dialogPagination,filters:e.dialogFilters,selectionKeys:e.selectedGiftIds},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.dialogFilterDataChange,selectionChange:e.selectionChange}},[i("el-table-column",{attrs:{property:"fullName",label:"商品名称",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"dialog-column"},[i("img",{staticClass:"productImg",attrs:{src:t.row.image||e.DefaultImg,onerror:e.errorImg}}),i("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.fullName))])])]}}])}),i("el-table-column",{attrs:{property:"barCode",label:"条码"}}),i("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),i("el-table-column",{attrs:{property:"brandName",label:"品牌"}}),i("el-table-column",{attrs:{property:"price",label:"价格"}}),i("el-table-column",{attrs:{label:"剩余库存/库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.availableStock)+"/"+e._s(t.row.stock))])]}}])})],1)],1)},a=[],s=(i("99af"),i("4de4"),i("4160"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("25f0"),i("159b"),i("5530")),o=i("7558"),n=i("5c40"),l=i("8330"),c=i("f36f"),d=i("e42c"),p=i("2086"),u=i("225d"),m=i("2f62"),f=i("c596"),h=i("1ab1"),g=i("af3f"),v=i("f3ac"),b=i.n(v),y={name:"NewsMgmt",props:{itemId:{type:String},agentId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},errorImg:'this.src="/resources/admin/images/default/product-default.png"',DefaultImg:b.a,selectedGiftList:[],selectedGiftIds:[],showDialog:!1,dialogFilters:[{type:"input",placeholder:"请输入编号/商品名/条码",name:"searchbar",value:""}],giftList:[],loading:!1,open:!1,subTotal:"",height:"585",subTotalAll:"",tableData:[],restaurants:[],selections:[],orderItems:[],selectionList:[],dialogTableVisible:!1,gridData:[],formData:{},shippingData:{},title:"",form:{products:""},operations:[{label:"保存",name:"save",type:"primary"},{label:"打印",name:"certificate",type:"primary"}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:o["a"],BizPagination:n["a"],BizGrid:c["a"],BizSaveButton:l["a"],vueEasyPrint:u["a"],BizDialogSelector:g["a"]},watch:{itemId:function(e){this.tableData=[],this.subTotal="",this.itemId&&this.getList()}},mounted:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},methods:Object(s["a"])(Object(s["a"])({},Object(m["c"])(["getUser"])),{},{addProduct:function(){this.dialogFilters[0].value="",this.getGiftList(),this.selectedGiftIds.splice(0,this.selectedGiftIds.length),this.selectedGiftList.splice(0,this.selectedGiftList.length),this.showDialog=!0},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.getGiftList()},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.getGiftList()},dialogFilterDataChange:function(e){this.dialogFilters=e,this.dialogPagination.currentPage=1,this.getGiftList()},getGiftList:function(){var e=this,t={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||"",isOutOfStock:"0",agentId:this.agentId,type:"couponOrder"===this.$route.params.orderType?"7":""};h["a"].get("purchaseOrder"===window.top.dType?"/admin/purchaseOrderManage/product/list.jhtml":f["g"].memberCardMgmt.memberCard.listProduct,t).then((function(t){e.giftList=t.content,e.dialogPagination.total=Number(t.total)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},selectionChange:function(e){var t=this;e.forEach((function(e){-1===t.selectionList.indexOf(e)&&t.selectionList.push(e)}))},confirmedProduct:function(e){var t=this;this.selectedGiftIds=e.concat(),this.selectedGiftList=[],this.selectionList.map((function(e){-1!==t.selectedGiftIds.indexOf(e.id)&&(e.quantity="1",t.selectedGiftList.push(e))}));this.selectedGiftList.map((function(e){Number(e.quantity)*Number(e.price)})),this.selectedGiftList.forEach((function(e){t.handleSelect(e),t.listProduct(e)}))},print:function(){this.$refs.easyPrint.print()},certificate:function(){var e=this;if(!this.itemId)return this.$message.warning("请先生成一个订单"),!1;var t={orderId:this.itemId,shopId:window.top.SHOP_ID||""};h["a"].get("purchaseOrder"===window.dType?f["l"].delivery.queryShippingVoucherPurchase:f["l"].delivery.queryShippingVoucher,t).then((function(t){e.dialogTableVisible=!0,e.title=e.getUser().shop?e.getUser().shop.name+"发货单":"发货单",e.formData=t.order,e.shippingData=t.shipping||{},e.userCard=t.userCard,e.gridData=t.order.orderItems})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),e.$message.warning(t.errorMessage)}))},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1,a=t.getDate(),s=i+"-"+(r<10?"0"+r:r)+"-"+(a<10?"0"+a:a);return s},resize:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.getList()},operationSuccess:function(){this.getList()},getList:function(){var e=this;console.log("window.top.dType"+window.top.dType),this.loading=!0;var t={orderId:this.itemId,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};d["a"].viewProducts(t,(function(t){e.loading=!1,e.tableData=t.orderItems,e.subTotal=t.order.price,e.pagination.total=Number(t.total),console.log("this.tableData",e.tableData)}),(function(e){console.log(e)}))},handleSelect:function(e){var t=!1;if(e.productId=e.id,e.id="",this.subTotal=(Number(this.subTotal)+Number(e.quantity)*Number(e.price)).toFixed(2),0!==this.tableData.length){for(var i=0;i<this.tableData.length;i++)if(this.tableData[i].productId===e.productId){this.tableData[i].quantity=(Number(this.tableData[i].quantity)+1).toString(),t=!0;break}t||this.tableData.push(Object.assign(e,{product:{minimumPackQuantity:e.minimumPackQuantity,barCode:e.barCode}}))}else this.tableData.push(e)},deleteHandeler:function(e){this.tableData.splice(e.$index,1),this.subTotal=(Number(this.subTotal)-Number(e.row.price)*Number(e.row.quantity)).toFixed(2)},quantityChange:function(e){var t=0;this.tableData.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.subTotal=t?t.toFixed(2):""},save:function(){var e=this;this.orderItems=this.tableData.map((function(e){return{id:e.id||"",productId:e.productId?e.productId:e.id,quantity:e.quantity||"",price:e.price||""}}));var t=!1;if(this.tableData.forEach((function(i){console.log(i.quantity),-1!==String(i.quantity).indexOf(".")&&(e.$message.warning("数量不能为小数"),t=!0),i.quantity%i.product.minimumPackQuantity!==0&&(e.$message.warning("数量为最小包装数的整数倍"),t=!0)})),t)return!1;!this.itemId&&this.$emit("setOrderItems",this.orderItems),this.itemId&&d["a"].addOrderItems({orderId:this.itemId,orderData:{orderItems:this.orderItems},shopId:window.top.SHOP_ID},(function(t){e.$emit("setOrderItems",e.orderItems),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.getList(),e.$message.warning(t.errorMessage)}))},listProduct:function(e){var t=this;p["a"].listProduct({searchValue:e.name},(function(e){t.restaurants=e.content.map((function(e){return{fullName:e.fullName,sn:e.sn,price:e.price,quantity:"1",subTotal:e.price,productId:e.id,value:e.fullName}})),t.loading=!1}),(function(e){console.log(e),console.log("code错误")}))},querySearchAsync:function(e,t){var i=this.restaurants,r=e?i.filter(this.createStateFilter(e)):i;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t(r)}),300*Math.random())},createStateFilter:function(e){return function(e){return!0}},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()}})},I=y,_=(i("8f05"),i("2877")),w=Object(_["a"])(I,r,a,!1,null,null,null);t["a"]=w.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,i){var r=i("1d80"),a=i("5899"),s="["+a+"]",o=RegExp("^"+s+s+"*"),n=RegExp(s+s+"*$"),l=function(e){return function(t){var i=String(r(t));return 1&e&&(i=i.replace(o,"")),2&e&&(i=i.replace(n,"")),i}};e.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(e,t,i){"use strict";var r=i("9678"),a=i.n(r);a.a},"5e89":function(e,t,i){var r=i("861d"),a=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&a(e)===e}},"5f95":function(e,t,i){},6116:function(e,t,i){"use strict";var r=i("3772"),a=i.n(r);a.a},"663e":function(e,t,i){"use strict";var r=i("3f67"),a=i.n(r);a.a},"697f":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),i("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?i("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),i("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},a=[],s=(i("99af"),i("4160"),i("c975"),i("a434"),i("a9e3"),i("159b"),i("04d3")),o={name:"BizDialogSelector",components:{BizFlexTable:s["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var i=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(i,1),this.innerSelection.splice(i,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i>=0&&t.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},n=o,l=(i("0943"),i("2877")),c=Object(l["a"])(n,r,a,!1,null,null,null);t["a"]=c.exports},"6bd2":function(e,t,i){},"6c02":function(e,t,i){},"6ecb":function(e,t,i){},7132:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"biz-fade-t"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[i("transition",{attrs:{name:"biz-fade-t-right"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},a=[],s={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},o=s,n=(i("5b8e"),i("2877")),l=Object(n["a"])(o,r,a,!1,null,null,null),c=l.exports,d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-popup-tabs"},[i("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[i("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},p=[],u=(i("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),m=u,f=(i("d4c2"),Object(n["a"])(m,d,p,!1,null,null,null)),h=f.exports;i.d(t,"a",(function(){return h}))},7339:function(e,t,i){"use strict";var r=i("f604"),a=i.n(r);a.a},"75e2":function(e,t,i){},"7d91":function(e,t,i){},"7f45":function(e,t,i){},8506:function(e,t,i){"use strict";var r=i("1910"),a=i.n(r);a.a},"8ba4":function(e,t,i){var r=i("23e7"),a=i("5e89");r({target:"Number",stat:!0},{isInteger:a})},"8c54":function(e,t,i){},"8f05":function(e,t,i){"use strict";var r=i("28d7"),a=i.n(r);a.a},"90b3":function(e,t,i){"use strict";var r=i("7d91"),a=i.n(r);a.a},9462:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"afterSale-process"},[e._l(e.refunds,(function(t,r){return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:t.id},[i("div",{staticClass:"refundsHead"},[i("div",{staticClass:"refundsContent"},[i("img",{staticClass:"image",attrs:{src:t.orderItem.thumbnail,width:"20px"}}),i("label",[e._v(e._s(t.orderItem.fullName))]),"2"!==t.type?i("label",{staticClass:"price"},[e._v("￥"+e._s(t.amount))]):e._e(),i("label",{staticClass:"refundsState"},[e._v(e._s(e.refundsStates[t.state]))])])]),i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新申请",status:"0"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(t.refundsRecords,(function(a){return"0"==a.type?i("div",{key:a.id},["1"===t.type?i("p",[e._v("买家申请退货")]):e._e(),"0"===t.type?i("p",[e._v("买家申请退款")]):e._e(),"2"===t.type?i("p",[e._v("买家申请换货")]):e._e(),"2"!==t.type?i("p",[e._v("退款原因："+e._s(t.reason))]):e._e(),"2"!==t.type?i("p",[e._v("退款金额："+e._s(t.amount))]):e._e(),"2"!==t.type?i("p",[e._v("退款说明："+e._s(t.explain))]):e._e(),"2"===t.type?i("p",[e._v("换货原因："+e._s(t.reason))]):e._e(),"2"===t.type?i("p",[e._v("换货数量："+e._s(t.orderItem.quantity))]):e._e(),"2"===t.type?i("p",[e._v("换货地址："+e._s(t.receiverAddress))]):e._e(),"2"===t.type?i("p",[e._v("换货说明："+e._s(t.explain))]):e._e(),i("div",{staticStyle:{display:"flex"}},[e._v(" 凭证： "),e._l(t.refundsImages,(function(t){return i("div",{key:t,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:t,height:"100"},on:{click:function(i){return e.enlarge(t)}}})])})),i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})])],2),i("p",[e._v(e._s(t.createDate))]),"0"===t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree(r)}}},[e._v("同意")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse(r)}}},[e._v("拒绝")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"agreeForm_"+r}},[i("table",{staticClass:"agreeContent",attrs:{id:"agreeContent_"+r}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"2"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("input",{attrs:{type:"hidden",name:"refundType"},domProps:{value:t.type}}),i("tr",[i("th",[e._v("售后详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),"2"===t.type||"1"===t.type?i("tr",[i("th",[e._v("收货地址：")]),i("el-card",[i("div",{staticClass:"left",on:{click:e.clickAdress}},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",{staticStyle:{float:"right"}},[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit(r)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"refuseForm_"+r}},[i("table",{staticClass:"refuseContent",attrs:{id:"refuseContent_"+r}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"1"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit(r)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),0)]),i("el-step",{attrs:{title:"售后中",status:"2"===t.refundsRecords[0].type||"3"===t.refundsRecords[0].type||"7"===t.refundsRecords[0].type||"8"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(r){return"2"===r.type&&"2"!==t.type?i("div",{key:r.id},[i("p",[e._v("卖家同意退货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(r.details))]),i("p",[e._v(e._s(r.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(r){return"2"===r.type&&"2"===t.type?i("div",{key:r.id},[i("p",[e._v("卖家同意换货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(r.details))]),i("p",[e._v(e._s(r.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(a){return"3"===a.type?i("div",{key:a.id},[i("p",[e._v("买家已退货，等待卖家收货")]),i("p",[e._v("物流公司："+e._s(a.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(a.trackingNo))]),"2"!==t.type?i("p",[e._v("退款说明："+e._s(a.details))]):e._e(),i("p",[e._v(e._s(a.happenDate))]),e._l(t.returnsImages,(function(r){return"2"!==t.type?i("div",{key:r,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:r,height:"100"},on:{click:function(t){return e.enlarge(r)}}})]):e._e()})),"2"!==t.type?i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})]):e._e(),"3"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree1(r)}}},[e._v("确认收货")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse1(r)}}},[e._v("拒绝收货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"refuseForm1_"+r}},[i("table",{staticClass:"refuseContent1",attrs:{id:"refuseContent1_"+r}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"4"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit1(r)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"agreeForm1_"+r}},[i("table",{staticClass:"agreeContent1",attrs:{id:"agreeContent1_"+r}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),"2"!==t.type?i("input",{attrs:{type:"hidden",name:"state",value:"5"}}):e._e(),"2"===t.type?i("input",{attrs:{type:"hidden",name:"state",value:"7"}}):e._e(),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("收货详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit1(r)}}},[e._v("确定")]):e._e()],1)])],2):e._e()})),e._l(t.refundsRecords,(function(a){return"7"===a.type?i("div",{key:a.id},[i("p",[e._v("卖家已收到买家的换货商品，待发出换货商品")]),i("p",[e._v(e._s(a.happenDate))]),"7"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shipping(r)}}},[e._v("发货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"shippingForm_"+r}},[i("table",{staticClass:"shippingContent1",attrs:{id:"shippingContent1_"+r}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"8"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("物流公司:")]),i("td",[i("select",{directives:[{name:"model",rawName:"v-model",value:e.deliveryId,expression:"deliveryId"}],staticStyle:{width:"225px"},attrs:{name:"deliveryId"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.deliveryId=t.target.multiple?i:i[0]}}},e._l(e.deliveryCorps,(function(e,t){return i("option",{key:t,attrs:{label:e.name},domProps:{value:e.id}})})),0)])]),i("tr",[i("th",[e._v("物流单号:")]),i("td",[i("input",{attrs:{type:"text",name:"trackingNo",onKeyUp:"value=value.replace(/[\\W]/g,'')"}})])]),i("tr",[i("th",[e._v("物流费用:")]),i("td",[i("input",{attrs:{type:"text",name:"tackingAmount",onkeyup:"this.value=this.value.replace(/[^\\d.]/g,'')"}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shippingSubmit1(r)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),e._l(t.refundsRecords,(function(t){return"8"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家已发出换新货，等待买家收货")]),i("p",[e._v("物流公司："+e._s(t.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(t.trackingNo))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"售后完成",status:"1"===t.refundsRecords[0].type||"4"===t.refundsRecords[0].type||"5"===t.refundsRecords[0].type||"6"===t.refundsRecords[0].type||"9"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(t){return"5"==t.type?i("div",{key:t.id},[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("退款金额："+e._s(t.amount))]),i("p",[e._v("售后详情："+e._s(t.details))])]):e._e()})),e._l(t.refundsRecords,(function(r){return"6"==r.type&&"2"!==t.type?i("div",{key:r.id},[i("p",[e._v("买家取消退货")])]):e._e()})),e._l(t.refundsRecords,(function(r){return"6"==r.type&&"2"===t.type?i("div",{key:r.id},[i("p",[e._v("买家取消换货")])]):e._e()})),e._l(t.refundsRecords,(function(t){return"1"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝售后申请")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"4"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝收货")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"9"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已确认收货，换货完成")])]):e._e()}))],2)])],1)],1)})),0===e.refunds.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],2)},a=[],s=(i("d3b7"),i("5530")),o=i("e42c"),n=i("624d"),l=i.n(n),c=i("f36f"),d=i("f260"),p=i.n(d),u=i("2f62"),m=i("1ab1"),f=i("c596"),h=i("44e3"),g={components:{BizGrid:c["a"],BillInfo:h["a"]},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{activeStep:0,loading:!1,dialogVisiable:!1,refunds:[],refundsRecords:[],refundsImages:[],formData:[],getAddress:{},refundType:"",refundId:"",orderId:"",message:"",imageValue:"",imgStyle:"",deliveryId:"",trackingNo:"",tackingAmount:"",currentState:"",active:"",defaultImage:l.a,showShippingEditor:!1,deliveryCorps:[],refundsStates:{0:"未确认",1:"拒绝退款退货/换货申请",2:"同意退/换货申请",3:"买家发货",4:"卖家拒收",5:"卖家退款",6:"取消退款",7:"卖家发货",8:"买家收货"}}},computed:Object(s["a"])(Object(s["a"])({},Object(u["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+p.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.initData(),this.getAddressList()},watch:{itemId:function(e){this.initData()}},methods:{clickAdress:function(){console.log(1111),this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};m["a"].get(f["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},initData:function(){var e=this,t={orderId:this.itemId};o["a"].viewOrderRefunds(t,(function(t){e.refunds=t.refunds}),(function(e){console.log(e)}))},close:function(){document.querySelector(".overlay").style.display="none"},enlarge:function(e){document.querySelector(".overlay").style.display="block",this.imageValue=e||l.a,this.imgStyle="position: absolute; top: 100px; right: 150px;padding:20px;height: 500px;background:#fff"},agree:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="block";for(var r=document.getElementById(t).getElementsByTagName("input"),a=0;a<r.length-1;a++)this.refundType=r[1].value;document.getElementById(i).style.display="none"},refuse:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agree1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="block",document.getElementById(i).style.display="none"},refuse1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agreeSubmit:function(e){var t=this,i="agreeForm_"+e,r={depotReceiverId:this.getAddress.id,orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[4].value,remarks:document.getElementById(i)[5].value};this.loading=!0,o["a"].refundsAudit(r,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},refuseSubmit:function(e){var t=this,i="refuseForm_"+e,r={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(r),this.loading=!0,o["a"].refundsAudit(r,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),t.loading=!1,document.getElementById(i).style.display="none"}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},agreeSubmit1:function(e){var t=this;this.loading=!0;var i="agreeForm1_"+e,r={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(r),o["a"].refundsAudit(r,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage),t.loading=!1}))},refuseSubmit1:function(e){var t=this;this.loading=!0;var i="refuseForm1_"+e,r={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};o["a"].refundsAudit(r,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},shipping:function(e){var t="shippingContent1_"+e;document.getElementById(t).style.display="block",this.init()},init:function(){var e=this;o["a"].viewOrder({orderId:this.itemId},(function(t){e.deliveryCorps=t.deliveryCorps}),(function(t){e.$message.warning(t.errorMessage)}))},shippingSubmit1:function(e){var t=this;this.loading=!0;var i="shippingForm_"+e,r={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:"",remarks:"",deliveryId:document.getElementById(i)[3].value,trackingNo:document.getElementById(i)[4].value,tackingAmount:document.getElementById(i)[5].value};o["a"].refundsAudit(r,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},messageClick:function(){this.initData(),this.message=""}}},v=g,b=(i("007c"),i("2877")),y=Object(b["a"])(v,r,a,!1,null,null,null);t["a"]=y.exports},9678:function(e,t,i){},"9b2e":function(e,t,i){"use strict";var r=i("0a05"),a=i.n(r);a.a},"9ba3":function(e,t,i){},"9de1":function(e,t,i){"use strict";var r=i("7f45"),a=i.n(r);a.a},"9fda":function(e,t,i){"use strict";var r=i("8c54"),a=i.n(r);a.a},a57d:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"my-invoice-my-purchase"},[i("div",{staticClass:"invoice-info-my-purchase"},[i("span",{staticClass:"invoice-title"},[e._v("发票信息")]),i("el-form",{attrs:{"label-width":"100","inline-message":!0}},[i("el-form-item",{attrs:{label:"发票抬头："}},[e._v(e._s(e.curInvoice.invoiceTitle))]),i("el-form-item",{attrs:{label:"发票类型："}},[e._v(e._s("0"===e.curInvoice.invoiceType?"个人":"1"===e.curInvoice.invoiceType?"增值税普通发票":"2"===e.curInvoice.invoiceType?"增值税专用发票":""))]),i("el-form-item",{attrs:{label:"发票状态："}},[e._v(e._s(e.curInvoice.invoiceState?e.curInvoice.invoiceState:"未申请"))]),i("el-form-item",{attrs:{label:"联系人："}},[e._v(e._s(e.curInvoice.contacts))]),i("el-form-item",{attrs:{label:"联系电话："}},[e._v(e._s(e.curInvoice.mobile))]),i("el-form-item",{attrs:{label:"所在地区："}},[e._v(e._s(e.curInvoice.areaName))]),i("el-form-item",{attrs:{label:"详细地址："}},[e._v(e._s(e.curInvoice.address))]),e.expressName?i("el-form-item",{attrs:{label:"快递公司："}},[e._v(e._s(e.expressName))]):e._e(),e.curInvoice.expressCode?i("el-form-item",{attrs:{label:"快递单号："}},[e._v(e._s(e.curInvoice.expressCode))]):e._e()],1),this.shippingSn?i("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("el-collapse-item",{attrs:{title:"发票追踪",name:"1"}},[i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[e.getTraces?i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0):e._e(),this.shippingTraces&&0===this.shippingTraces.length?i("ul",[i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v(" 物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s("暂无轨迹"))])]),i("div",{staticClass:"i-item"},[e._v("快递公司："+e._s(e.expressName))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.curInvoice.expressCode))])])]):e._e()])])])],1):e._e()],1),e.invoiceInfoId&&e.hasAuthEdit?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("提交")]):e._e(),e.invoiceInfoId&&e.hasAuthEdit?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.cancle}},[e._v("取消")]):e._e()],1)},a=[],s=(i("caad"),i("d81d"),i("b0c0"),i("d3b7"),i("2532"),i("5530")),o=i("2f62"),n=i("1ab1"),l=i("c596"),c=i("f36f"),d={name:"my-invoice",data:function(){return{deliverys:[],activeNames:["1"],expressName:"",shippingTraces:[],shippingSn:""}},props:{orderId:{type:String,default:""},orderIds:{type:Array},invoiceInfoId:{type:String,default:""}},components:{BizGrid:c["a"]},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(o["c"])(["getUser"])),Object(o["c"])("Order",["orderInfo","curInvoice"])),Object(o["c"])("Authority",["currentAuth"])),{},{hasAuthEdit:function(){return this.currentAuth.includes("admin:purchaseOrder.edit")},getTraces:function(){return!!(this.shippingTraces&&this.shippingTraces.length>0)}}),watch:{invoiceInfoId:function(e){}},methods:Object(s["a"])(Object(s["a"])({},Object(o["d"])("Order",["updateCurInvoice"])),{},{onContact:function(){this.$router.push({path:"/custom-service"})},getInvoiceInfo:function(){var e=this,t={clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,methodName:"QueryInvoiceBasicInfo"};n["a"].get(l["g"].hypermarketMgmt.invoiceByOrder,t).then((function(t){"0"===t.invoice.invoiceState?(t.invoice.invoiceState="待开票",t.invoice.expressState="待开票"):"1"===t.invoice.invoiceState?(t.invoice.invoiceState="未邮寄",t.invoice.expressState="未邮寄"):"2"===t.invoice.invoiceState&&(t.invoice.invoiceState="已邮寄",t.invoice.expressState="已邮寄"),e.deliverys=t.deliverys,e.deliverys.map((function(i){i.id===t.invoice.express&&(e.expressName=i.name)})),e.shippingSn=t.shipping.sn,e.shippingSn&&e.expressInfo(),t.invoice.area&&(t.invoice.areaName=t.invoice.area.fullName),e.updateCurInvoice(t.invoice)})).catch((function(t){"906"===t.resultCode&&e.updateCurInvoice({})})).finally((function(){}))},handleChange:function(){},cancle:function(){this.$emit("cancle")},submit:function(){var e=this,t={clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,invoiceInfoId:this.curInvoice.id,orderIds:this.orderIds,methodName:"CreateInvoiceBasicInfo"};n["a"].post(l["g"].hypermarketMgmt.applyInvoice,t).then((function(t){e.$message.success("申请成功"),e.$emit("close")})).catch((function(t){e.$message.warning(t.errorMessage),"906"===t.resultCode&&e.updateCurInvoice({})})).finally((function(){}))},expressInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.shippingSn};n["a"].get(l["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}),created:function(){}},p=d,u=(i("4837"),i("2877")),m=Object(u["a"])(p,r,a,!1,null,null,null);t["a"]=m.exports},a9e3:function(e,t,i){"use strict";var r=i("83ab"),a=i("da84"),s=i("94ca"),o=i("6eeb"),n=i("5135"),l=i("c6b6"),c=i("7156"),d=i("c04e"),p=i("d039"),u=i("7c73"),m=i("241c").f,f=i("06cf").f,h=i("9bf2").f,g=i("58a8").trim,v="Number",b=a[v],y=b.prototype,I=l(u(y))==v,_=function(e){var t,i,r,a,s,o,n,l,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(i=c.charCodeAt(2),88===i||120===i)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+c}for(s=c.slice(2),o=s.length,n=0;n<o;n++)if(l=s.charCodeAt(n),l<48||l>a)return NaN;return parseInt(s,r)}return+c};if(s(v,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var w,C=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof C&&(I?p((function(){y.valueOf.call(i)})):l(i)!=v)?c(new b(_(t)),i,C):_(t)},M=r?m(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;M.length>S;S++)n(b,w=M[S])&&!n(C,w)&&h(C,w,f(b,w));C.prototype=y,y.constructor=C,o(a,v,C)}},a9f4:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"apply-info"},[i("div",{staticClass:"apply-info-div"},[i("div",{staticClass:"apply-info-content"},[i("div",{staticClass:"apply-top-content"},[i("div",{staticClass:"apply-follow-up",on:{click:function(t){return e.onOrderSchedules(e.orderData.id)}}},[i("span",[e._v("申请单跟踪")]),i("div",{staticClass:"apply-state"},[i("span",[e._v(e._s(e.getOrderState))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]),i("div",{staticClass:"receiver-info"},[i("span",[e._v(e._s(e.orderData.depot?e.orderData.depot.contactor:""))]),i("span",[e._v(e._s(e.orderData.depot?e.orderData.depot.phone:""))]),i("p",[i("i",{staticClass:"el-icon-location-outline",staticStyle:{"margin-right":"5px"}}),e._v(" "+e._s(e.orderData.depot?e.orderData.depot.address:"")+" ")])])]),i("div",{staticClass:"apply-info-new"},[i("div",{staticClass:"shop-name",on:{click:e.goSupplier}},[i("img",{attrs:{src:e.iconShop}}),i("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(e.orderData.relatePartnerName))])]),e._l(e.orderData.itemDatas,(function(t,r){return i("div",{key:r},[i("div",{staticClass:"good-info"},[i("div",{staticClass:"goods-img"},[i("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:t.thumbnail&&t.thumbnail.indexOf("/")>=0?t.thumbnail:e.defaultImg},on:{error:function(t){return e.imgError(r)}}})]),i("div",{staticClass:"good-right"},[i("div",{staticClass:"good-name"},[i("span",{staticStyle:{flex:"1"}},[e._v(" "+e._s(t.specValue)+" ")])]),i("div",{staticStyle:{"margin-bottom":"10px"}},[t.product.barCode?i("span",{staticStyle:{"font-size":"14px","margin-right":"10px"}},[e._v(e._s(t.product.barCode))]):e._e()]),i("div",{staticClass:"good-price"},[i("span",[e._v("￥"+e._s(t.price))]),i("span",[e._v("X"+e._s(t.amount))])])])])])}))],2),i("div",{staticClass:"price-info-content"},[i("div",{staticClass:"total-price"},[i("span",[e._v("合计")]),i("span",{staticStyle:{color:"red"}},[e._v("￥"+e._s(e.orderData.totalFee))])])]),i("div",{staticClass:"pay-type"},[i("span",[e._v("单据编号: "+e._s(e.orderData.sn))]),i("span",[e._v("创建时间: "+e._s(e.orderData.createDate))]),i("span",[e._v("申请人: "+e._s(e.orderData.applierName))])])])]),e.isPend?i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},[e.hasAuthExamine&&("1"===e.orderData.state&&"1"===e.orderData.audit||"2"===e.orderData.state&&"1"===e.orderData.audit)?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.toPass(e.orderData,"1")}}},[e._v("审核")]):e._e(),"0"===e.orderData.state?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.statusChange(e.orderData,"0")}}},[e._v("提交")]):e._e(),"1"===e.orderData.state&&"1"===e.orderData.isApplier?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.statusChange(e.orderData,"3")}}},[e._v("撤回")]):e._e()],1):e._e(),i("el-dialog",{attrs:{visible:e.dialogVisiable,center:"",width:"800px","min-height":"400px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("apply-follow",{ref:"invoice"})],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(t){e.showPassOrder=t}}},[i("div",[i("div",{staticClass:"reson-container"},[i("span",[e._v("审核结果：")]),i("el-radio",{attrs:{label:"1",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("通过")]),i("el-radio",{attrs:{label:"2",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("驳回")]),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[i("span",[e._v("驳回理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:e.curSelectCloseReason,callback:function(t){e.curSelectCloseReason=t},expression:"curSelectCloseReason"}},e._l(e.reasonList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showPassOrder=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange(e.row,e.auditState)}}},[e._v("确定")])],1)])],1)},a=[],s=(i("caad"),i("d3b7"),i("2532"),i("5530")),o=i("f36f"),n=i("2f62"),l=i("1ab1"),c=i("c596"),d=i("e83a"),p=i.n(d),u=i("f606"),m=i.n(u),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"order-log-info"},[i("div",{staticStyle:{"text-align":"center","font-size":"15px","margin-bottom":"20px"}},[e._v("单据进度跟踪")]),i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新申请",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderData.schedules,(function(t,r){return"0"===t.state||"1"===t.state?i("div",{key:r,staticClass:"logInfo"},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("0"===t.state?"已创建":"已提交"))]),i("p",[e._v(e._s(t.time))])]):e._e()})),0)]),i("el-step",{attrs:{title:"审核",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderData.schedules,(function(t,r){return"2"===t.state||"3"===t.state?i("div",{key:r},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(t.adminName+"已通过"))]),i("p",[e._v("备注："+e._s(t.remarks))]),i("p",[e._v(e._s(t.time))])]):e._e()})),e._l(e.orderData.schedules,(function(t,r){return"4"===t.state?i("div",{key:r},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(t.adminName+"审核不通过"))]),i("p",[e._v("理由："+e._s(t.details))]),i("p",[e._v("备注："+e._s(t.remarks))]),i("p",[e._v(e._s(t.time))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"审核通过/驳回",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},["3"===e.orderData.state?i("div",[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("审核通过"))])]):e._e(),"4"===e.orderData.state?i("div",[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("审核驳回"))])]):e._e()])])],1)],1)},h=[],g={name:"NewsMgmt",props:{},data:function(){return{loading:!1,orderData:[],active:"",state:""}},components:{},watch:{},created:function(){},computed:{getOrderLogState:function(e){switch(this.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"审核通过";default:return""}}},methods:{operate:function(e){this[e]()},getList:function(e){var t=this,i={id:e};l["a"].get(c["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,i).then((function(e){t.orderData=e.data})).catch((function(){})).finally((function(){}))}}},v=g,b=(i("2992"),i("2877")),y=Object(b["a"])(v,f,h,!1,null,null,null),I=y.exports,_={name:"apply-info",data:function(){return{orderData:{},iconShop:m.a,defaultImg:p.a,dialogVisiable:!1,showPassOrder:!1,loading:!1,remarks:"",auditState:"1",row:{},curSelectCloseReason:"申报的商品与实际需要采购的商品不符",reasonList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}]}},props:{itemId:{type:String,default:""},isPend:{type:Boolean,default:!1}},watch:{itemId:function(e){this.getOrderInfo()}},components:{BizGrid:o["a"],ApplyFollow:I},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Authority",["currentAuth"])),{},{hasAuthExamine:function(){return this.currentAuth.includes("admin:purchaseApplication.examine")},getOrderState:function(){switch(this.orderData.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"已驳回";default:return""}}}),methods:{goSupplier:function(){},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},toPass:function(e,t){this.remarks="",this.row=e,this.showPassOrder=!0},onOrderSchedules:function(e){var t=this;this.dialogVisiable=!0,this.$nextTick((function(){t.$refs.invoice.getList(e)}))},getOrderInfo:function(){var e=this,t={id:this.itemId};l["a"].get(c["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,t).then((function(t){e.orderData=t.data})).catch((function(){})).finally((function(){}))},statusChange:function(e,t){var i=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.loading=!0;var r={shopId:window.top.SHOP_ID||"",id:e.id,actionType:t,details:"2"===t?i.curSelectCloseReason:"",remarks:i.remarks};l["a"].post("/admin/invoicing/purchase/shopPurchaseApplyState.jhtml",r).then((function(e){i.$message.success("操作成功！"),i.loading=!1,i.showPassOrder=!1,i.$emit("operationSuccess")})).catch((function(e){i.loading=!1,e.errorMessage&&i.$message.warning(e.errorMessage)})).finally((function(){}))}))}},created:function(){}},w=_,C=(i("7339"),Object(b["a"])(w,r,a,!1,null,null,null));t["a"]=C.exports},af3f:function(e,t,i){"use strict";var r=i("697f");t["a"]=r["a"]},b06a:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("biz-grid",{staticClass:"order-base-info"},[e.isEdit?r("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"label-width":"120px",size:"small",disabled:!e.isEdit,"inline-message":!0}},[e.itemId?r("el-form-item",{attrs:{label:"订单编号",prop:"sn"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.sn,callback:function(t){e.$set(e.form,"sn",t)},expression:"form.sn"}})],1):e._e(),r("el-form-item",{attrs:{label:"订单状态"}},[e.itemId?r("el-input",{attrs:{disabled:!0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}}):r("el-select",{attrs:{disabled:"couponOrder"===this.$route.params.orderType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.orderStateTypeList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.showInfo?r("el-form-item",{attrs:{label:"订单原价",prop:"originalAmount"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.originalAmount,callback:function(t){e.$set(e.form,"originalAmount",t)},expression:"form.originalAmount"}})],1):e._e(),e.form.amountPrepay?r("el-form-item",{attrs:{label:"订金",prop:"amountPrepay"}},[r("el-input",{attrs:{disabled:""!==e.itemId&&("交易完成"===e.form.type||"订单关闭"===e.form.type||"已评价"===e.form.type)},model:{value:e.form.amountPrepay,callback:function(t){e.$set(e.form,"amountPrepay",t)},expression:"form.amountPrepay"}})],1):e._e(),e.form.amountFinalpay?r("el-form-item",{attrs:{label:"尾款",prop:"amountFinalpay"}},[r("el-input",{attrs:{disabled:""!==e.itemId&&("交易完成"===e.form.type||"订单关闭"===e.form.type||"已评价"===e.form.type)},model:{value:e.form.amountFinalpay,callback:function(t){e.$set(e.form,"amountFinalpay",t)},expression:"form.amountFinalpay"}})],1):e._e(),e.showInfo?r("el-form-item",{attrs:{label:"调整金额",prop:"offsetAmount"}},[r("el-input-number",{attrs:{"controls-position":"right",disabled:""!==e.itemId&&"2"===e.form.paymentStatus||"订单关闭"===e.form.type},on:{change:e.offsetAmountChange},model:{value:e.form.offsetAmount,callback:function(t){e.$set(e.form,"offsetAmount",t)},expression:"form.offsetAmount"}})],1):e._e(),e.showInfo?r("el-form-item",{attrs:{label:"订单现价",prop:"amount"}},[r("el-input",{attrs:{disabled:""!==e.itemId&&"2"===e.form.paymentStatus||"订单关闭"===e.form.type},on:{change:e.curAmountChange},model:{value:e.form.curAmount,callback:function(t){e.$set(e.form,"curAmount",t)},expression:"form.curAmount"}})],1):e._e(),r("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[r("el-collapse-item",{attrs:{name:"1"}},[-1!==e.activeNames.indexOf("1")&&e.handler?r("template",{slot:"title"},[r("div",{staticClass:"title-class"},[r("div",{staticClass:"title-class-one"},[r("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("客户信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("1")&&e.handler?e._e():r("template",{slot:"title"},[e._v("客户信息")]),r("el-form-item",{staticClass:"isRequired",attrs:{label:"会员昵称",prop:"member.nickname"}},[r("el-input",{attrs:{disabled:!!e.itemId,placeholder:"请选择或添加会员"},on:{focus:e.showDialogFc},model:{value:e.form.member.nickname,callback:function(t){e.$set(e.form.member,"nickname",t)},expression:"form.member.nickname"}},[e.itemId?e._e():r("el-button",{attrs:{slot:"append",icon:"el-icon-plus"},on:{click:e.addMember},slot:"append"})],1)],1),r("el-form-item",{attrs:{label:"性别",prop:"member.gender"}},[r("el-select",{attrs:{disabled:!1===!e.itemId},model:{value:e.form.member.gender,callback:function(t){e.$set(e.form.member,"gender",t)},expression:"form.member.gender"}},[r("el-option",{attrs:{label:"男",value:"0"}}),r("el-option",{attrs:{label:"女",value:"1"}}),r("el-option",{attrs:{label:"保密",value:"2"}})],1)],1),r("el-form-item",{attrs:{label:"电话",prop:"member.mobile"}},[r("el-input",{attrs:{disabled:!1===!e.itemId,placeholder:"请输入电话"},model:{value:e.form.member.mobile,callback:function(t){e.$set(e.form.member,"mobile",t)},expression:"form.member.mobile"}})],1),r("el-form-item",{attrs:{label:"车辆",prop:"car.id"}},[r("el-select",{attrs:{placeholder:"请选择车辆",disabled:""!==e.itemId},on:{change:e.carChange},model:{value:e.form.car.id,callback:function(t){e.$set(e.form.car,"id",t)},expression:"form.car.id"}},e._l(e.cars,(function(e,t){return r("el-option",{key:t,attrs:{label:e.plateNumber,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"车型",prop:"car.type"}},[r("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.car.type,callback:function(t){e.$set(e.form.car,"type",t)},expression:"form.car.type"}})],1),e.form.plateNumber?e._e():r("el-form-item",{attrs:{label:"行驶里程",prop:"car.drivingRange"}},[r("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.car.drivingRange,callback:function(t){e.$set(e.form.car,"drivingRange",t)},expression:"form.car.drivingRange"}})],1),e.form.plateNumber?r("el-form-item",{attrs:{label:"行驶里程",prop:"drivingRange"}},[r("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.drivingRange,callback:function(t){e.$set(e.form,"drivingRange",t)},expression:"form.drivingRange"}})],1):e._e()],2),r("el-collapse-item",{attrs:{name:"2"}},[-1!==e.activeNames.indexOf("2")&&e.handler?r("template",{slot:"title"},[r("div",{staticClass:"title-class"},[r("div",{staticClass:"title-class-one"},[r("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("服务信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("2")&&e.handler?e._e():r("template",{slot:"title"},[e._v("服务信息")]),"rescue"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"呼叫方式",prop:"orderItems[0].appointment.way"}},[r("el-select",{attrs:{placeholder:"请选择呼叫方式"},model:{value:e.form.orderItems[0].appointment.way,callback:function(t){e.$set(e.form.orderItems[0].appointment,"way",t)},expression:"form.orderItems[0].appointment.way"}},[r("el-option",{attrs:{label:"电话",value:"0"}}),r("el-option",{attrs:{label:"在线",value:"1"}})],1)],1):e._e(),"rescue"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"救援机构",prop:"orderItems[0].appointment.rescueUnit"}},[r("el-select",{attrs:{placeholder:"请选择救援机构"},model:{value:e.form.orderItems[0].appointment.rescueUnit,callback:function(t){e.$set(e.form.orderItems[0].appointment,"rescueUnit",t)},expression:"form.orderItems[0].appointment.rescueUnit"}},e._l(e.rescueOrganizations,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"rescue"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"救援人员",prop:"orderItems[0].appointment.rescuerId"}},[r("el-select",{attrs:{placeholder:"请选择救援人员"},model:{value:e.form.orderItems[0].appointment.rescuerId,callback:function(t){e.$set(e.form.orderItems[0].appointment,"rescuerId",t)},expression:"form.orderItems[0].appointment.rescuerId"}},e._l(e.workers,(function(e,t){return r("el-option",{key:t,attrs:{label:e.nickname,value:e.id}})})),1)],1):e._e(),"rescue"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"救援地点",prop:"orderItems[0].appointment.workerLocation"}},[r("el-input",{attrs:{placeholder:"请输入救援地点"},model:{value:e.form.orderItems[0].appointment.workerLocation,callback:function(t){e.$set(e.form.orderItems[0].appointment,"workerLocation",t)},expression:"form.orderItems[0].appointment.workerLocation"}})],1):e._e(),"rescue"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"服务项目",prop:"orderItems[0].appointment.reasons"}},[r("el-checkbox-group",{model:{value:e.form.orderItems[0].appointment.reasons,callback:function(t){e.$set(e.form.orderItems[0].appointment,"reasons",t)},expression:"form.orderItems[0].appointment.reasons"}},e._l(e.reasons,(function(t,i){return r("el-checkbox",{key:i,attrs:{label:t.id}},[e._v(e._s(t.content))])})),1)],1):e._e(),"rescue"===this.$route.params.orderType?r("el-form-item",{staticClass:"imgUpload",attrs:{label:"图片信息"}},[r("el-upload",{attrs:{action:"/admin/file/uploads.jhtml","before-upload":e.beforeAvatarUpload,"file-list":e.imageList,"list-type":"picture-card",name:"file",accept:"image/*",data:{type:"0"},"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.handleSuccess}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.picDialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.picDialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1):e._e(),"rescue"===this.$route.params.orderType&&e.itemId?r("el-form-item",{attrs:{label:"语音信息"}},e._l(e.form.orderItems[0].appointment.voices,(function(e,t){return r("div",{key:t},[r("audio",{attrs:{src:e.path,controls:""}})])})),0):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"服务日期",prop:"orderItems[0].appointment.appontmentDate"}},[r("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"请选择服务日期"},model:{value:e.form.orderItems[0].appointment.appontmentDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"appontmentDate",t)},expression:"form.orderItems[0].appointment.appontmentDate"}})],1):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"开始时间",prop:"orderItems[0].appointment.driveStartDate"}},[r("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.driveStartDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"driveStartDate",t)},expression:"form.orderItems[0].appointment.driveStartDate"}})],1):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"结束时间",prop:"orderItems[0].appointment.driveEndDate"}},[r("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.driveEndDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"driveEndDate",t)},expression:"form.orderItems[0].appointment.driveEndDate"}})],1):e._e(),"service"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"服务日期",prop:"appointmentDate"}},[r("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"请选择服务日期",clearable:!1,editable:!1},model:{value:e.appointmentDate,callback:function(t){e.appointmentDate=t},expression:"appointmentDate"}})],1):e._e(),"service"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"开始时间",prop:"appointmentStartDate"}},[r("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",editable:!1,clearable:!1},model:{value:e.form.appointmentDate,callback:function(t){e.$set(e.form,"appointmentDate",t)},expression:"form.appointmentDate"}})],1):e._e(),"service"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"结束时间",prop:"appointmentEndDate"}},[r("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",editable:!1,clearable:!1},model:{value:e.form.appointmentEndDate,callback:function(t){e.$set(e.form,"appointmentEndDate",t)},expression:"form.appointmentEndDate"}})],1):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"使用时间(分)",prop:"useTime"}},[r("el-input",{attrs:{value:e.dateInterval(e.form.orderItems[0].appointment.driveEndDate,e.form.orderItems[0].appointment.driveStartDate),disabled:!0}})],1):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"开始里程",prop:"orderItems[0].appointment.startMileage"}},[r("el-input-number",{attrs:{"controls-position":"right",precision:0,min:0,disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.startMileage,callback:function(t){e.$set(e.form.orderItems[0].appointment,"startMileage",t)},expression:"form.orderItems[0].appointment.startMileage"}})],1):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"结束里程",prop:"orderItems[0].appointment.endMileage"}},[r("el-input-number",{attrs:{"controls-position":"right",precision:0,min:0,disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.endMileage,callback:function(t){e.$set(e.form.orderItems[0].appointment,"endMileage",t)},expression:"form.orderItems[0].appointment.endMileage"}})],1):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"使用里程(公里)"}},[r("el-input",{attrs:{value:e.form.orderItems[0].appointment.endMileage-e.form.orderItems[0].appointment.startMileage,disabled:!0}})],1):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{staticClass:"isRequired",attrs:{label:"试驾车号",prop:"orderItems[0].appointment.plateNumber"}},[r("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入试驾车号"},on:{select:e.handleSelect},model:{value:e.form.orderItems[0].appointment.plateNumber,callback:function(t){e.$set(e.form.orderItems[0].appointment,"plateNumber",t)},expression:"form.orderItems[0].appointment.plateNumber"}})],1):e._e(),"ride"===this.$route.params.orderType?r("el-form-item",{staticClass:"isRequired",attrs:{label:"试驾车型",prop:"orderItems[0].appointment.product.fullName"}},[r("el-input",{attrs:{placeholder:"请选择试驾车型"},on:{focus:e.queryProduct},model:{value:e.form.orderItems[0].appointment.product.fullName,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"fullName",t)},expression:"form.orderItems[0].appointment.product.fullName"}})],1):e._e(),"replace"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"已有车型",prop:"orderItems[0].appointment.car.type"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.orderItems[0].appointment.car.type,callback:function(t){e.$set(e.form.orderItems[0].appointment.car,"type",t)},expression:"form.orderItems[0].appointment.car.type"}})],1):e._e(),"replace"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"行驶里程",prop:"orderItems[0].appointment.drivingRange"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.form.orderItems[0].appointment.drivingRange,callback:function(t){e.$set(e.form.orderItems[0].appointment,"drivingRange",t)},expression:"form.orderItems[0].appointment.drivingRange"}})],1):e._e(),"replace"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"上牌时间",prop:"orderItems[0].appointment.onTime"}},[r("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.orderItems[0].appointment.onTime,callback:function(t){e.$set(e.form.orderItems[0].appointment,"onTime",t)},expression:"form.orderItems[0].appointment.onTime"}})],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?r("el-form-item",{staticClass:"isRequired",attrs:{label:"心仪车型",prop:"orderItems[0].appointment.product.brandId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌",filterable:""},on:{change:e.handleBrandChange},model:{value:e.form.orderItems[0].appointment.product.brandId,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"brandId",t)},expression:"form.orderItems[0].appointment.product.brandId"}},e._l(e.brandList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?r("el-form-item",{staticClass:"isRequired",attrs:{label:"",prop:"orderItems[0].appointment.product.seriesId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列",filterable:""},on:{change:e.handleSeriesChange},model:{value:e.form.orderItems[0].appointment.product.seriesId,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"seriesId",t)},expression:"form.orderItems[0].appointment.product.seriesId"}},e._l(e.seriesList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?r("el-form-item",{staticClass:"isRequired",attrs:{label:"",prop:"orderItems[0].appointment.product.id"}},[r("el-select",{staticClass:"isRequired",staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型"},on:{change:e.productChange},model:{value:e.form.orderItems[0].appointment.product.id,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"id",t)},expression:"form.orderItems[0].appointment.product.id"}},e._l(e.modeList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"裸车总价",prop:"orderItems[0].appointment.product.price"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.orderItems[0].appointment.product.price,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"price",t)},expression:"form.orderItems[0].appointment.product.price"}})],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"金融方案",prop:"orderItems[0].appointment.financialPlan.id"}},[r("el-select",{attrs:{placeholder:"请选择金融方案"},on:{change:function(t){return e.loanTerm(e.form.orderItems[0].appointment.financialPlan.id)}},model:{value:e.form.orderItems[0].appointment.financialPlan.id,callback:function(t){e.$set(e.form.orderItems[0].appointment.financialPlan,"id",t)},expression:"form.orderItems[0].appointment.financialPlan.id"}},e._l(e.financialPlans,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"首付比例",prop:"orderItems[0].appointment.downPayment"}},[r("el-select",{attrs:{placeholder:"请选择首付比例"},on:{change:e.monthPay},model:{value:e.form.orderItems[0].appointment.downPayment,callback:function(t){e.$set(e.form.orderItems[0].appointment,"downPayment",t)},expression:"form.orderItems[0].appointment.downPayment"}},e._l(e.form.orderItems[0].appointment.financialPlan.downPayments,(function(e,t){return r("el-option",{key:t,attrs:{label:Math.round(e)+"%",value:e}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"还款期限",prop:"orderItems[0].appointment.year"}},[r("el-select",{attrs:{placeholder:"请选择还款年限"},on:{change:e.monthPay},model:{value:e.form.orderItems[0].appointment.year,callback:function(t){e.$set(e.form.orderItems[0].appointment,"year",t)},expression:"form.orderItems[0].appointment.year"}},e._l(e.form.orderItems[0].appointment.financialPlan.loanTerms,(function(e,t){return r("el-option",{key:t,attrs:{label:e.year+"年",value:e.year}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"首付金额"}},[r("el-input",{attrs:{value:e.form.orderItems[0].appointment.product.price?e.form.orderItems[0].appointment.product.price*e.form.orderItems[0].appointment.downPayment/100:e.form.orderItems[0].appointment.product.price,disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"贷款额度"}},[r("el-input",{attrs:{value:e.form.orderItems[0].appointment.product.price?e.form.orderItems[0].appointment.product.price-e.form.orderItems[0].appointment.product.price*e.form.orderItems[0].appointment.downPayment/100:e.form.orderItems[0].appointment.product.price,disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"月供"}},[r("el-input",{attrs:{value:e.monthPay(),disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"手续费",prop:"orderItems[0].appointment.fee"}},[r("el-input",{attrs:{placeholder:"请输入手续费"},model:{value:e.form.orderItems[0].appointment.fee,callback:function(t){e.$set(e.form.orderItems[0].appointment,"fee",t)},expression:"form.orderItems[0].appointment.fee"}})],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"身份证",prop:"orderItems[0].appointment.personId"}},[r("el-input",{attrs:{placeholder:"请输入身份证"},model:{value:e.form.orderItems[0].appointment.personId,callback:function(t){e.$set(e.form.orderItems[0].appointment,"personId",t)},expression:"form.orderItems[0].appointment.personId"}})],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"工作单位",prop:"orderItems[0].appointment.workUnit"}},[r("el-input",{attrs:{placeholder:"请输入工作单位"},model:{value:e.form.orderItems[0].appointment.workUnit,callback:function(t){e.$set(e.form.orderItems[0].appointment,"workUnit",t)},expression:"form.orderItems[0].appointment.workUnit"}})],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"房屋情况",prop:"orderItems[0].appointment.houseState"}},[r("el-select",{model:{value:e.form.orderItems[0].appointment.houseState,callback:function(t){e.$set(e.form.orderItems[0].appointment,"houseState",t)},expression:"form.orderItems[0].appointment.houseState"}},[r("el-option",{attrs:{label:"有",value:"1"}}),r("el-option",{attrs:{label:"无",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"上牌城市",prop:"orderItems[0].appointment.onCity"}},[r("el-input",{attrs:{placeholder:"请输入上牌城市"},model:{value:e.form.orderItems[0].appointment.onCity,callback:function(t){e.$set(e.form.orderItems[0].appointment,"onCity",t)},expression:"form.orderItems[0].appointment.onCity"}})],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"意向购车时间",prop:"orderItems[0].appointment.intentionTime"}},[r("el-select",{attrs:{placeholder:"请选择意向购车时间"},model:{value:e.form.orderItems[0].appointment.intentionTime,callback:function(t){e.$set(e.form.orderItems[0].appointment,"intentionTime",t)},expression:"form.orderItems[0].appointment.intentionTime"}},[r("el-option",{attrs:{label:"一年",value:"4"}}),r("el-option",{attrs:{label:"半年",value:"3"}}),r("el-option",{attrs:{label:"三个月",value:"2"}}),r("el-option",{attrs:{label:"两个月",value:"1"}}),r("el-option",{attrs:{label:"一个月",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"月收入",prop:"orderItems[0].appointment.monthIncome"}},[r("el-select",{attrs:{placeholder:"请选择月收入"},model:{value:e.form.orderItems[0].appointment.monthIncome,callback:function(t){e.$set(e.form.orderItems[0].appointment,"monthIncome",t)},expression:"form.orderItems[0].appointment.monthIncome"}},[r("el-option",{attrs:{label:"20000以上",value:"4"}}),r("el-option",{attrs:{label:"15000-19999",value:"3"}}),r("el-option",{attrs:{label:"10000-14999",value:"2"}}),r("el-option",{attrs:{label:"5000-9999",value:"1"}}),r("el-option",{attrs:{label:"0-4999",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"有车情况",prop:"orderItems[0].appointment.carState"}},[r("el-select",{attrs:{placeholder:"请选择有车情况"},model:{value:e.form.orderItems[0].appointment.carState,callback:function(t){e.$set(e.form.orderItems[0].appointment,"carState",t)},expression:"form.orderItems[0].appointment.carState"}},[r("el-option",{attrs:{label:"有",value:"1"}}),r("el-option",{attrs:{label:"无",value:"0"}})],1)],1):e._e(),r("el-form-item",{staticClass:"isRequired",attrs:{label:"顾问",prop:"consultant.id"}},[r("el-select",{attrs:{placeholder:"请选择顾问"},model:{value:e.form.consultant.id,callback:function(t){e.$set(e.form.consultant,"id",t)},expression:"form.consultant.id"}},e._l(e.consultants,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name||"未填写",value:e.id}})})),1)],1),"service"===this.$route.params.orderType?r("el-form-item",{attrs:{label:"业务类型"}},[r("tag-select",{ref:"tagSelect",attrs:{tagList:e.tagList,bAddTag:!1,selectType:"order",selectedTags:e.selectedTags},on:{addSuccess:e.onAddSuccess}})],1):e._e(),r("el-form-item",{attrs:{label:"买家留言",prop:"memo"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[r("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],2),e.showPayment?r("el-collapse-item",{attrs:{name:"4"}},[-1!==e.activeNames.indexOf("4")&&e.handler?r("template",{slot:"title"},[r("div",{staticClass:"title-class"},[r("div",{staticClass:"title-class-one"},[r("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("付款信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("4")&&e.handler?e._e():r("template",{slot:"title"},[e._v("付款信息")]),e.itemId?r("el-form-item",{staticClass:"isRequired",attrs:{label:"支付方式",prop:"paymentMethodId"}},[r("el-select",{attrs:{disabled:"1"!==e.form.type&&"2"!==e.form.type,placeholder:"请选择支付方式"},model:{value:e.form.paymentMethodId,callback:function(t){e.$set(e.form,"paymentMethodId",t)},expression:"form.paymentMethodId"}},e._l(e.paymentMethods,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),r("el-form-item",{staticClass:"isRequired",attrs:{label:"付款方式",prop:"payments[0].paymentType"}},[r("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择付款方式"},on:{change:e.paymentTypeChange},model:{value:e.form.payments[0].paymentType,callback:function(t){e.$set(e.form.payments[0],"paymentType",t)},expression:"form.payments[0].paymentType"}},e._l(e.paymentTypes,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),"会员卡余额"===e.form.payments[0].paymentType?r("el-form-item",{staticClass:"isRequired",attrs:{label:"会员卡",prop:"memberCardId"}},[r("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择会员卡"},on:{change:e.memberCardChange},model:{value:e.form.memberCardId,callback:function(t){e.$set(e.form,"memberCardId",t)},expression:"form.memberCardId"}},e._l(e.listExistCard,(function(e,t){return r("el-option",{key:t,attrs:{label:e.template.name,value:e.id}})})),1)],1):e._e(),"刷卡"===e.form.payments[0].paymentType||"汇款"===e.form.payments[0].paymentType?r("el-form-item",{staticClass:"isRequired",attrs:{label:"付款银行",prop:"payments[0].payBank"}},[r("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择付款银行"},model:{value:e.form.payments[0].payBank,callback:function(t){e.$set(e.form.payments[0],"payBank",t)},expression:"form.payments[0].payBank"}},[r("el-option",{attrs:{label:"中国工商银行",value:"中国工商银行"}}),r("el-option",{attrs:{label:"中国农业银行",value:"中国农业银行"}}),r("el-option",{attrs:{label:"中国银行",value:"中国银行"}}),r("el-option",{attrs:{label:"中国建设银行",value:"中国建设银行"}}),r("el-option",{attrs:{label:"交通银行",value:"交通银行"}}),r("el-option",{attrs:{label:"中信银行",value:"中信银行"}}),r("el-option",{attrs:{label:"广发银行",value:"广发银行"}}),e._v("、 "),r("el-option",{attrs:{label:"深圳发展银行",value:"深圳发展银行"}}),r("el-option",{attrs:{label:"招商银行",value:"招商银行"}}),r("el-option",{attrs:{label:"中国光大银行",value:"中国光大银行"}}),r("el-option",{attrs:{label:"华夏银行",value:"华夏银行"}}),r("el-option",{attrs:{label:"中国民生银行",value:"中国民生银行"}}),r("el-option",{attrs:{label:"兴业银行",value:"兴业银行"}}),r("el-option",{attrs:{label:"上海浦东发展银行",value:"上海浦东发展银行"}}),r("el-option",{attrs:{label:"恒丰银行",value:"恒丰银行"}}),r("el-option",{attrs:{label:"浙商银行",value:"浙商银行"}}),r("el-option",{attrs:{label:"渤海银行",value:"渤海银行"}}),r("el-option",{attrs:{label:"中国邮政储蓄银行",value:"中国邮政储蓄银行"}}),r("el-option",{attrs:{label:"其他银行",value:"其他银行"}})],1)],1):e._e(),"刷卡"===e.form.payments[0].paymentType||"汇款"===e.form.payments[0].paymentType?r("el-form-item",{staticClass:"isRequired",attrs:{label:"付款帐号",prop:"payments[0].payAccount"}},[r("el-input",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请输入付款帐号"},model:{value:e.form.payments[0].payAccount,callback:function(t){e.$set(e.form.payments[0],"payAccount",t)},expression:"form.payments[0].payAccount"}})],1):e._e()],2):e._e(),e.showInfo?r("el-collapse-item",{attrs:{title:"优惠信息",name:"3"}},[e.itemId?r("div",[r("el-form-item",{attrs:{label:"优惠券折扣",prop:"couponDiscount"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.couponDiscount,callback:function(t){e.$set(e.form,"couponDiscount",t)},expression:"form.couponDiscount"}})],1),r("el-form-item",{attrs:{label:"赠送积分",prop:"point"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.point,callback:function(t){e.$set(e.form,"point",t)},expression:"form.point"}})],1)],1):r("div",[r("el-form-item",{attrs:{label:"福利",prop:"couponDiscount"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.couponChange},model:{value:e.form.couponCodeId,callback:function(t){e.$set(e.form,"couponCodeId",t)},expression:"form.couponCodeId"}},e._l(e.form.couponList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.coupon.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"V豆抵扣",prop:"beanDiscount"}},[r("el-input",{attrs:{disabled:!("会员卡余额"===e.form.payments[0].paymentType&&e.form.memberCardId&&e.form.bean),min:0},on:{change:e.beanChange},model:{value:e.form.beanDiscount,callback:function(t){e.$set(e.form,"beanDiscount",t)},expression:"form.beanDiscount"}}),"会员卡余额"===e.form.payments[0].paymentType&&e.form.memberCardId?r("div",[e._v(e._s(e.beanCanUse))]):e._e()],1)],1)]):e._e(),e.showInfo?r("el-collapse-item",{attrs:{title:"其他信息",name:"7"}},[r("el-form-item",{attrs:{label:"创建时间"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.orderTime,callback:function(t){e.$set(e.form,"orderTime",t)},expression:"form.orderTime"}})],1),r("el-form-item",{attrs:{label:"执行时间"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.deliveryTime,callback:function(t){e.$set(e.form,"deliveryTime",t)},expression:"form.deliveryTime"}})],1),r("el-form-item",{attrs:{label:"付款时间"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.paymentTime,callback:function(t){e.$set(e.form,"paymentTime",t)},expression:"form.paymentTime"}})],1),r("el-form-item",{attrs:{label:"完成时间"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.completeTime,callback:function(t){e.$set(e.form,"completeTime",t)},expression:"form.completeTime"}})],1)],1):e._e()],1)],1),r("el-dialog",{attrs:{title:"创建会员",visible:e.dialogVisible,width:"50%",appendToBody:!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"dialogFormModel",attrs:{model:e.formModel,"label-width":"120px",size:"small",rules:e.dialogRules,"inline-message":!0}},[r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{attrs:{placeholder:"请输入手机号，如1888888888"},on:{blur:e.mobileBlur},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),r("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[r("el-input",{attrs:{placeholder:"请输入用户名，如1888888888"},model:{value:e.formModel.userName,callback:function(t){e.$set(e.formModel,"userName",t)},expression:"formModel.userName"}})],1),r("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[r("el-input",{attrs:{placeholder:"请输入昵称，如1888888888"},model:{value:e.formModel.nickname,callback:function(t){e.$set(e.formModel,"nickname",t)},expression:"formModel.nickname"}})],1),r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入姓名，如张三"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入密码"},model:{value:e.formModel.password,callback:function(t){e.$set(e.formModel,"password",t)},expression:"formModel.password"}})],1),r("el-form-item",{attrs:{label:"性别",prop:"gender"}},[r("el-radio-group",{model:{value:e.formModel.gender,callback:function(t){e.$set(e.formModel,"gender",t)},expression:"formModel.gender"}},[r("el-radio",{attrs:{label:"0"}},[e._v("男")]),r("el-radio",{attrs:{label:"1"}},[e._v("女")]),r("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),r("el-form-item",{attrs:{label:"车牌号"}},[r("el-input",{attrs:{placeholder:"请输入车牌号，如浙12345"},model:{value:e.formModel.defaultCarInfo.plateNumber,callback:function(t){e.$set(e.formModel.defaultCarInfo,"plateNumber",t)},expression:"formModel.defaultCarInfo.plateNumber"}})],1),r("el-form-item",{attrs:{label:"品牌"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马",filterable:""},on:{change:e.brandChange},model:{value:e.formModel.defaultCarInfo.brand,callback:function(t){e.$set(e.formModel.defaultCarInfo,"brand",t)},expression:"formModel.defaultCarInfo.brand"}},e._l(e.brandData,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"系列"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系",filterable:""},on:{change:e.seriesChange},model:{value:e.formModel.defaultCarInfo.series,callback:function(t){e.$set(e.formModel.defaultCarInfo,"series",t)},expression:"formModel.defaultCarInfo.series"}},e._l(e.seriesData,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"车型"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系2016款"},model:{value:e.formModel.defaultCarInfo.type,callback:function(t){e.$set(e.formModel.defaultCarInfo,"type",t)},expression:"formModel.defaultCarInfo.type"}},e._l(e.modeData,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"车辆识别代码"}},[r("el-input",{attrs:{placeholder:"请输入车辆识别代码，如1G1BL52P7TR115520"},model:{value:e.formModel.defaultCarInfo.vin,callback:function(t){e.$set(e.formModel.defaultCarInfo,"vin",t)},expression:"formModel.defaultCarInfo.vin"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.createMember()}}},[e._v("确 定")])],1)],1),r("biz-dialog-selector",{staticClass:"memberDialog",attrs:{title:"选择会员",visibility:e.showDialog,appendToBody:!0,keyField:"id",selectionKeys:e.selectionKeys,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,selectionMode:"single",filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.handleConfirmed,open:e.opened,operate:e.dialogOperate,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange}},[r("el-table-column",{attrs:{label:"用户名",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"customer-info"},[t.row.head?r("img",{attrs:{src:t.row.head}}):r("img",{attrs:{src:i("624d")}}),r("div",{staticClass:"wrapper"},[r("div",{staticClass:"title"},[e._v(e._s(t.row.name))]),r("div",{staticClass:"gender"},["0"===t.row.gender?r("i",{staticClass:"male iconfont biz-icon-i-web-m"}):e._e(),"1"===t.row.gender?r("i",{staticClass:"female iconfont biz-icon-i-web-f"}):e._e(),"2"===t.row.gender?r("i",{staticClass:"none iconfont biz-icon-i-web-bm"}):e._e(),r("span",[e._v(e._s(t.row.mobile))])])])])]}}])}),r("el-table-column",{attrs:{prop:"mobile",label:"手机号"}}),r("el-table-column",{attrs:{prop:"createDate",label:"创建日期",formatter:e.createDateConverter,sortable:"custom"}}),r("el-table-column",{attrs:{label:"状态",formatter:e.stateConverter}}),r("el-table-column",{attrs:{prop:"",label:"店铺名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",e._l(t.row.shops,(function(t,i){return r("div",{key:i,staticClass:"customer-info"},[e._v(e._s(t.name))])})),0)]}}])}),r("el-table-column",{attrs:{prop:"lastLoginIp",label:"最后登录地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"customer-info"},[r("span",{staticStyle:{display:"block"}},[e._v(e._s(t.row.loginAddress||t.row.lastLoginIp))])])]}}])}),r("el-table-column",{attrs:{prop:"lastLoginDate",label:"最后登录时间",formatter:e.loginDateConverter,sortable:"custom"}})],1),r("biz-dialog-selector",{attrs:{title:"选择车型",visibility:e.showProductSelector,tableData:e.productTableData,pagination:e.productPagination,selectionMode:"single"},on:{"update:visibility":function(t){e.showProductSelector=t},pageSizeChange:e.productPageSizeChange,currentPageChange:e.productCurrentPageChange,confirmed:e.confirmedProduct}},[r("el-table-column",{attrs:{property:"fullName",label:"名称"}}),r("el-table-column",{attrs:{property:"price",label:"销售价"}})],1)],1)},a=[],s=(i("99af"),i("4de4"),i("7db0"),i("c740"),i("4160"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("ac1f"),i("25f0"),i("3ca3"),i("5319"),i("1276"),i("159b"),i("ddb0"),i("b85c")),o=(i("96cf"),i("1da1")),n=i("5530"),l=i("f36f"),c=i("e42c"),d=i("8330"),p=i("46fc"),u=i("c466"),m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[i("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tags:e.tags,pagination:e.pagination,tableData:e.tableData,loading:e.loading,checkable:e.checkable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange}},[e._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],1)},f=[],h=i("04d3"),g={name:"BizDialogSelector",components:{BizFlexTable:h["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},selectionKeys:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],innerSelection:[]}},methods:{generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]);else{var i=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(i,1)}},open:function(e){console.log(this.selectionKeys),this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){this.innerSelectionKeys.length>0?(this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1):this.$message("请选择一项")},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i>=0&&t.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i<0&&t.innerSelectionKeys.push(e[t.keyField])}))},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},rowClick:function(e,t,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){}},v=g,b=(i("1029"),i("2877")),y=Object(b["a"])(v,m,f,!1,null,null,null),I=y.exports,_=i("2f62"),w=i("18eb"),C=i("0e5e"),M=i("1ab1"),S=i("c596"),k={stateConverter:function(e){return"0"===e.enableState?"停用":"1"===e.enableState?"启用":"--"},createDateConverter:function(e){if(e.createDate){e.createDate=e.createDate.replace(/-/g,"/");var t=new Date(e.createDate);return u["a"].dateConverter(t)}return"--"},loginDateConverter:function(e){if(e.lastLoginDate){e.lastLoginDate=e.lastLoginDate.replace(/-/g,"/");var t=new Date(e.lastLoginDate);return u["a"].dateConverter(t)}return"--"},ipConverter:function(e){return e.lastLoginIp?e.lastLoginIp:"--"}},T={name:"baseInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},open:{type:Boolean,default:function(){return!1}},handler:{type:String},activeNames:{type:Array,default:function(){return["1","2","3","4","5"]}}},components:{BizGrid:l["a"],BizSaveButton:d["a"],BizDialogSelector:I,TagSelect:w["a"]},data:function(){var e=this;return{isShipped:!1,beanCanUse:"",maxOffsetBean:0,minOffsetBean:0,originalAmount:"",orderStateTypeList:[{label:"订单已执行",value:"1"},{label:"交易完成",value:"2"}],beanRate:0,tagList:[],selectedTags:[],restaurants:[],dialogRules:{userName:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[0-9a-zA-Z]+$/,message:"用户名只能为数字或字母",trigger:"blur"},{min:4,max:20,message:"长度在4-20位",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"}],name:[{required:!0,trigger:"blur",message:"请输入姓名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:20,message:"密码应在6-20位之间",trigger:"blur"}],rePassword:[{required:!0,trigger:"blur",message:"请再次输入密码"},{trigger:"blur",validator:function(t,i,r){e.formModel.password===e.formModel.rePassword?r():r(new Error("两次输入密码不一致"))}}]},loading:!1,picDialogVisible:!1,showProductSelector:!1,dialogImageUrl:"",isFirst:!0,showDialog:!1,dialogVisible:!1,showDelivery:!1,showReceiver:!1,flag:!1,data:{type:"",method:""},productTableData:[],imageList:[],consultants:[],shippingMethod:[],deliveryCorps:[],paymentTypes:[],paymentMethods:[],listExistCard:[],brandList:[],seriesList:[],modeList:[],brandData:[],seriesData:[],modeData:[],financialPlans:[],selectionKeys:[],rescueOrganizations:[],cars:[],reasons:[],workers:[],orderItems:[],areaId:"1568",useTime:"",useMileage:"",appointmentDate:"",downPaymentPrice:"",loanPrice:"",formModel:{userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",brand:"",series:"",type:"",vin:""}},form:{bean:"",appointmentData:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}},appointmentDate:"",appointmentEndDate:"",sn:"",type:"",amount:"",amountPrepay:"",amountFinalpay:"",originalAmount:"",offsetAmount:"",curAmount:"",memberCardId:"",userId:"",consultant:{id:""},area:{id:"1568"},car:{id:"",tpye:"",drivingRange:""},address:"",areaName:"",consignee:"",phone:"",zipCode:"",remarks:"",memo:"",promotionDiscount:"",couponDiscount:"",couponCodeId:"",couponCode:{},couponList:[],beanDiscount:"",point:"",giftBean:"",shippingMethodName:"",paymentMethodId:"",shippingMethodId:"",invoiceState:"",orderTime:"",deliveryTime:"",paymentTime:"",completeTime:"",orderItems:[{appointment:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",plateNumber:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}}}],payments:[{paymentType:"",payBank:"",payAccount:""}],member:{nickname:"",gender:"",mobile:""},shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",isLCL:"0",phone:"",zipCode:""}]},operations:[{label:"保存",name:"save",type:"primary"}],adminCurrent:[],dialogLoading:!0,dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},productPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},isCreated:!1,dialogFilters:[{type:"input",label:"",placeholder:"请输入店铺名称",name:"searchValue",value:""}]}},computed:Object(n["a"])(Object(n["a"])({},Object(_["c"])(["currentUser"])),{},{getCouponCode:function(){var e,t=this;return this.form.couponList.forEach((function(i){if(i.id===t.form.couponCodeId)return e=i,!1})),e},showInfo:function(){return!0},showPayment:function(){return!!this.itemId||"1"!==this.form.type},isCreate:function(){return!this.itemId}}),created:function(){this.queryBrandList(),this.getBrandList(),this.getFinancialPlans(),!this.itemId&&this.orderOptions(),this.getStoreTags(),this.testDrives()},watch:{itemId:function(e){this.itemId&&this.init(),this.itemId||(this.resetFormData(),this.form.type="2",this.getStoreTags())},open:function(e){this.isShipped=!1,!this.itemId&&e&&this.isCreated&&this.resetFormData()},form:{deep:!0,immediate:!0,handler:function(e){var t=this;this.showDelivery=!1,this.showReceiver=!1,this.shippingMethod.map((function(i){i.name===e.shippingMethodName&&"1"===i.isNeedDelivery&&(t.showDelivery=!0),i.name===e.shippingMethodName&&"1"===i.isNeedReceiver&&(t.showReceiver=!0)}))}}},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(_["c"])(["getUser"])),k),{},{getDefaultForm:function(){return{bean:"",curAmount:"",couponCodeId:"",couponCode:{},couponList:[],appointmentData:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}},appointmentDate:"",appointmentEndDate:"",sn:"",type:"",amount:"",amountPrepay:"",amountFinalpay:"",originalAmount:"",offsetAmount:"0",memberCardId:"",userId:"",consultant:{id:""},area:{id:"1568",fullanme:""},car:{id:"",tpye:"",drivingRange:""},address:"",areaName:"",consignee:"",phone:"",zipCode:"",remarks:"",memo:"",promotionDiscount:"",couponDiscount:"",beanDiscount:"",point:"",giftBean:"",shippingMethodName:"",paymentMethodId:"",shippingMethodId:"",invoiceState:"",orderTime:"",deliveryTime:"",paymentTime:"",completeTime:"",orderItems:[{appointment:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",plateNumber:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}}}],payments:[{paymentType:"",payBank:"",payAccount:""}],member:{nickname:"",gender:"",mobile:""},shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",phone:"",zipCode:""}]}},onShippingChange:function(){this.form.shippingMethodName&&this.showDelivery||(this.form.shippings[0].freight="",this.getOriginalAmount())},mobileBlur:function(){this.formModel.id||this.formModel.nickname||this.$set(this.formModel,"nickname",this.formModel.mobile),this.formModel.id||this.formModel.userName||this.$set(this.formModel,"userName",this.formModel.mobile)},brandChange:function(e){this.getSeriesList(e),this.formModel.defaultCarInfo.series="",this.formModel.defaultCarInfo.type=""},seriesChange:function(e){this.getModeList(e),this.formModel.defaultCarInfo.type=""},getStoreTags:function(){var e=this,t={categoryType:"订单/服务业务类型",shopId:window.top.SHOP_ID||""};M["a"].get(S["g"].systemSetting.storeTags,t).then((function(t){console.log("订单/服务业务类型标签",t),e.tagList=t.content})).catch((function(e){console.log(e.errorMessage)}))},beanChange:function(){this.getOriginalAmount()},getOriginalAmount:function(){this.isCreate&&(this.form.originalAmount=(Number(this.originalAmount)-Number(this.form.beanDiscount*this.beanRate||"0")-Number(this.form.couponDiscount||"0")+Number(this.form.shippings[0].freight||"0")).toFixed(2),this.getCurAmount())},getCurAmount:function(){this.form.curAmount=(Number(this.form.originalAmount)+Number(this.form.offsetAmount||"0")).toFixed(2),this.form.curAmount<=0&&(this.form.curAmount=0),this.form.curAmount=this.form.curAmount.toString()},freightChange:function(){this.getOriginalAmount()},offsetAmountChange:function(){this.getCurAmount()},curAmountChange:function(){this.form.offsetAmount=Number(this.form.curAmount)+Number(this.form.beanDiscount*this.beanRate)+Number(this.form.couponDiscount)-Number(this.form.originalAmount),this.form.offsetAmount=this.form.offsetAmount.toString()},couponChange:function(){var e=this;this.form.couponList.forEach((function(t){if(t.id===e.form.couponCodeId)return e.form.couponDiscount=t.coupon.amount,!1})),this.getOriginalAmount()},tagMapping:function(){var e={refId:this.itemId,type:"7",tags:this.$refs.tagSelect.getCurSelectedTags(),shopId:window.top.SHOP_ID||""};M["a"].post(S["g"].systemSetting.tagMapping,e).then((function(e){console.log("映射成功")})).catch((function(e){console.log(e.errorMessage)}))},getTagMapping:function(){var e=this;this.selectedTags=[];var t={refId:this.itemId,type:"7",shopId:window.top.SHOP_ID||""};M["a"].get(S["g"].systemSetting.tagMapping,t).then((function(t){console.log("查看映射信息",t),t.data.tags&&(e.selectedTags=t.data.tags)})).catch((function(e){console.log(e.errorMessage)}))},onAddSuccess:function(){this.getStoreTags()},operate:function(e){this[e]()},dateInterval:function(e,t){if(e&&t)return Object(p["a"])(e.split(" ")[1],t.split(" ")[1])},showDialogFc:function(){this.showDialog=!0,this.dialogFilters[0].value=""},monthPay:function(){var e=this;if(this.form.orderItems[0].appointment.year)return this.form.orderItems[0].appointment.financialPlan.loanTerms.map((function(t){t.year===e.form.orderItems[0].appointment.year&&(e.form.orderItems[0].appointment.rate=t.rate)})),((this.form.orderItems[0].appointment.product.price-this.form.orderItems[0].appointment.product.price*this.form.orderItems[0].appointment.downPayment/100)*this.form.orderItems[0].appointment.rate/12*Math.pow(1+this.form.orderItems[0].appointment.rate/12,12*this.form.orderItems[0].appointment.year)/(Math.pow(1+this.form.orderItems[0].appointment.rate/12,12*this.form.orderItems[0].appointment.year)-1)).toFixed(2)},queryProduct:function(){var e=this;c["a"].listProductByTestDrive({clientType:"2",methodName:"ListProductByTestDrive",shopId:this.getUser().shop?this.getUser().shop.id:window.top.SHOP_ID,pageSize:this.productPagination.pageSize,pageNumber:this.productPagination.currentPage},(function(t){e.productTableData=t.content,e.showProductSelector=!0}),(function(t){e.$message.warning(t.errorMessage)}))},confirmedProduct:function(e,t){this.form.orderItems[0].appointment.product.id=t[0].id,this.form.orderItems[0].appointment.product.fullName=t[0].fullName},handleConfirmed:function(e,t){this.form.member.nickname=t[0].nickname,this.form.member.mobile=t[0].mobile,this.form.memberCardId="",this.form.userId=t[0].id,this.$set(this.form.member,"gender",t[0].gender),this.$set(this.form,"selectionKeys",e),this.listExistCardTemplate(),this.form.plateNumber=t[0].defaultCarInfo.plateNumber,this.form.drivingRange=t[0].defaultCarInfo.drivingRange||"",this.form.car.type=t[0].defaultCarInfo.type||"",this.form.car.drivingRange="",this.form.shippings[0].address&&this.itemId||(this.form.shippings[0].address=t[0].defaultReceiver.areaName+t[0].defaultReceiver.address),this.form.shippings[0].consignee&&this.itemId||(this.form.shippings[0].consignee=t[0].name),this.form.shippings[0].phone&&this.itemId||(this.form.shippings[0].phone=t[0].mobile),this.carOptions(this.form.userId),this.getCouponList()},carOptions:function(e){var t,i=this;c["a"].carOptions({memberId:e},(function(e){i.cars=e.cars,i.cars.length>0&&(i.cars.forEach((function(e){if(e.plateNumber===i.form.plateNumber)return t=e,!1})),i.form.car.id=t?t.id:"",i.cars.map((function(e){if(e.id===i.form.car.id)return i.form.car.type=e.type,!1})))}),(function(e){i.$message.warning(e.errorMessage)}))},carChange:function(e){var t=this;this.cars.map((function(i){i.id===e&&(t.form.car.type=i.type,t.form.car.drivingRange=i.drivingRange,t.form.drivingRange=i.drivingRange)}))},createMember:function(){var e=this;this.$refs.dialogFormModel.validate((function(t,i){t&&c["a"].createMember(e.formModel,(function(t){e.loading=!1,e.$message.success("保存成功"),e.dialogVisible=!1,e.form.member.nickname=t.data.name,e.form.member.gender=t.data.gender,e.form.member.mobile=t.data.mobile,e.form.userId=t.data.id,t.data.defaultCarInfo&&(e.cars.push({plateNumber:t.data.defaultCarInfo.plateNumber,id:t.data.defaultCarInfo.id,type:t.data.defaultCarInfo.type}),e.form.car.id=t.data.defaultCarInfo.id,e.form.car.type=t.data.defaultCarInfo.type)}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},resetFormData:function(){this.form=this.getDefaultForm(),this.form.userId="",this.form.memberCardId="",this.listExistCard=[],this.form.member={},this.form.couponList=[],this.form.couponCodeId="",this.form.beanDiscount="",this.paymentTypes=[],this.form.payments[0].paymentType="",this.form.shippings[0].deliveryCorpId="",this.form.originalAmount="",this.form.curAmount="",this.form.car.type="",this.form.car.drivingRange="",this.form.drivingRange="",this.form.plateNumber="",this.form.car.id="",this.form.offsetAmount="",this.form.orderItems[0].appointment.product.brandId="",this.form.orderItems[0].appointment.product.seriesId="",this.form.orderItems[0].appointment.product.id=""},init:function(){var e=this;c["a"].viewOrder(this.getSaveParams(),(function(t){e.form=Object.assign(e.getDefaultForm(),t.order),e.form.curAmount=Number(e.form.originalAmount)+Number(e.form.offsetAmount),console.log(e.form),0===e.form.payments.length?(e.form.payments=[{paymentType:"",payBank:"",payAccount:""}],e.form.payments[0].paymentType=e.form.paymentTypeName):e.form.memberCardId=e.form.payments[0].memberCardId,0===e.form.shippings.length&&(e.form.shippings=[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:e.form.area&&e.form.area.fullName?e.form.area.fullName+e.form.address:e.form.address,consignee:e.form.consignee,phone:e.form.phone,zipCode:e.form.zipCode}]),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.product&&e.form.orderItems[0].appointment.product.brandId&&e.querySeriesList(e.form.orderItems[0].appointment.product.brandId),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.product&&e.form.orderItems[0].appointment.product.seriesId&&e.queryTypeList(e.form.orderItems[0].appointment.product.seriesId),t.order.appointmentDate&&(e.appointmentDate=t.order.appointmentDate),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.reasons&&(e.form.orderItems[0].appointment.reasons=e.form.orderItems[0].appointment.reasons.map((function(e){return e.id}))),e.carOptions(e.form.member.id),e.shippingMethod=t.shippingMethods,e.deliveryCorps=t.deliveryCorps,e.paymentTypes=t.paymentTypes,e.paymentMethods=t.paymentMethods,e.paymentMethods.map((function(i){i.name===t.order.paymentMethodName&&(e.form.paymentMethodId=i.id)})),e.reasons=t.reasons,e.adminCurrent=[{id:t.adminCurrent.id,name:t.adminCurrent.realName}],e.form.consultant.id?e.adminCurrent=[{id:e.form.consultant.id,name:e.form.consultant.realName}]:e.form.consultant={id:t.adminCurrent.id},e.form.area&&(e.areaId=e.form.area.id),"rescue"===e.$route.params.orderType&&(e.imageList=e.form.orderItems[0].appointment.images.map((function(e){return{url:e.path}}))),e.form.type=e.getOrderStatus(e.form.type),e.listExistCardTemplate(),e.listAdminByRole(),"2"===e.form.orderType&&(console.log("查询映射",e.form.orderType),e.getTagMapping(),e.getStoreTags()),e.offsetAmountChange()}),(function(t){e.$message.warning(t.errorMessage)}))},paymentTypeChange:function(e){"会员卡余额"!==e&&(this.form.memberCardId="",this.form.beanDiscount="",this.getOriginalAmount())},memberCardChange:function(){this.getMemberCardInfo(),this.getBeanRate()},getMemberCardInfo:function(){var e=this,t={userCardId:this.form.memberCardId};M["a"].get("/admin/memberCard/memberCard.jhtml",t).then((function(t){e.form.bean=t.content.bean,e.getCouponList()})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getBeanRate:function(){var e=this,t={id:this.form.memberCardId};M["a"].get("/admin/memberCard/memberCard.jhtml",t).then((function(t){e.beanRate=Number(t.rewardSet.cash)/Number(t.rewardSet.vBean)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getCouponList:function(){var e=this;if(0!==this.orderItems.length){this.form.couponList=[];var t=this.orderItems.map((function(e){return{product:{id:e.productId},quantity:e.quantity||""}})),i={shopId:window.top.SHOP_ID||"",cartItems:t,userId:this.form.userId,userCardId:this.form.memberCardId};M["a"].post("/admin/order/couponCodes.jhtml",i).then((function(t){e.form.couponList=t.content,e.maxOffsetBean=t.maxOffsetBean,e.minOffsetBean=t.minOffsetBean})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))}},listAdminByRole:function(){var e=this,t="";t="car"===this.$route.params.orderType?["salesman"]:["afterSale","reception","testDriver"],c["a"].listAdminByRole({roleTypes:t},(function(t){e.loading=!1,e.flag=!1,console.log(e.form.consultant.id),t.dataList.map((function(t){t.id===e.adminCurrent[0].id&&(e.flag=!0)})),e.flag?e.consultants=t.dataList:e.consultants=t.dataList.concat(e.adminCurrent)}),(function(e){console.log(e)}))},loanTerm:function(e){var t=this;c["a"].loanTerms({financialId:e},(function(e){t.loading=!1,t.form.orderItems[0].appointment.financialPlan.downPayments=[e.downPayment,e.downPayment+10,e.downPayment+20,e.downPayment+30],t.form.orderItems[0].appointment.downPayment="",t.form.orderItems[0].appointment.financialPlan.loanTerms=e.loanTerms}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},orderOptions:function(){var e=this,t=!1;this.form.type="交易完成",c["a"].options({shopId:window.top.SHOP_ID},(function(i){e.loading=!1,e.paymentMethods=i.paymentMethods,e.paymentTypes=i.paymentTypes,e.shippingMethod=i.shippingMethods,e.deliveryCorps=i.deliveryCorps,e.reasons=i.reasons,e.rescueOrganizations=i.rescueOrganizations,e.workers=i.workers,e.adminCurrent=[{id:i.adminCurrent.id,name:i.adminCurrent.realName}],e.form.consultant={id:i.adminCurrent.id},e.listAdminByRole(),!e.itemId&&e.showInfo&&(e.paymentTypes.forEach((function(e){if("会员卡余额"===e.name)return t=!0,!1})),e.form.payments[0].paymentType=t?"会员卡余额":e.paymentTypes[0].name),e.form.userId&&e.listExistCardTemplate()}),(function(t){e.loading=!1,"店铺不存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},submitOrder:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,r,a,o,n,l,c,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.analysisAddress(e.currentUser.shop.address);case 2:return i=t.sent,t.next=5,e.analysisAddress(e.form.shippings[0].address);case 5:r=t.sent,a=e.form.orderItems,o=[],n=Object(s["a"])(a);try{for(n.s();!(l=n.n()).done;)for(c=l.value,d=0;d<c.quantity;d++)p={cname:e.currentUser.shop.name,spro:i.province,scity:i.city,num:c.product.vins[d].number,epro:r.province,ecity:r.city,depname:e.form.shippings[0].consignee},o.push(M["a"].post("/admin/order/shipping2XinYue.jhtml",p))}catch(u){n.e(u)}finally{n.f()}Promise.all(o).then((function(t){e.$emit("xrorder")})).catch((function(t){e.$emit("xrorder")}));case 11:case"end":return t.stop()}}),t)})))()},analysisAddress:function(e){return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("开始解析, "+e),t.abrupt("return",new Promise((function(t,i){var r=new window.BMap.Geocoder;r.getPoint(e,(function(e){r.getLocation(e,(function(e){console.log(e),t({province:e.addressComponents.province,city:e.addressComponents.city})}))}))})));case 2:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;if(this.reasons&&this.reasons.length>0&&this.itemId&&this.form.orderItems[0].appointment&&(this.form.orderItems[0].appointment.reasons=this.reasons.map((function(t){return e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.reasons&&-1!==e.form.orderItems[0].appointment.reasons.indexOf(t.id)?{id:t.id,content:t.content}:{id:"",content:""}}))),""===this.form.consultant.id)return this.$message.warning("请输入顾问"),!1;if("ride"===this.$route.params.orderType){if(console.log(this.form.orderItems[0].appointment.plateNumber),""===this.form.orderItems[0].appointment.plateNumber)return this.$message.warning("请输入试驾车号"),!1;if(""===this.form.orderItems[0].appointment.product.fullName)return this.$message.warning("请输入试驾车型"),!1}if(this.itemId)if("shipping"===this.handler){if(this.loading=!0,this.shippingMethod.map((function(t){t.name===e.form.shippingMethodName&&(e.form.shippingMethodId=t.id)})),this.form.deliveryCorpId=this.form.shippings[0].deliveryCorpId,this.showDelivery){if(""===this.form.shippings[0].deliveryCorpId&&"0"===this.form.shippings[0].isLCL)return this.$message.warning("请输入物流公司"),this.loading=!1,!1;if(""===this.form.shippings[0].expressSn&&"0"===this.form.shippings[0].isLCL)return this.$message.warning("请输入物流单号"),this.loading=!1,!1;if(""===this.form.shippings[0].freight||!/^(0|[0-9][0-9]*)(\.\d+)?$/.test(this.form.shippings[0].freight))return this.$message.warning("请输入正确的物流费用"),this.loading=!1,!1;this.showReceiver?this.$set(this.form,"shippingData",{isLCL:this.form.shippings[0].isLCL,phone:this.form.shippings[0].phone||this.form.phone,address:this.form.shippings[0].address||this.form.areaName,consignee:this.form.shippings[0].consignee||this.form.consignee,expressSn:this.form.shippings[0].expressSn,freight:this.form.shippings[0].freight}):this.$set(this.form,"shippingData",{expressSn:this.form.shippings[0].expressSn,freight:this.form.shippings[0].freight})}else this.showReceiver&&!this.showDelivery&&(this.$set(this.form,"shippingData",{phone:this.form.shippings[0].phone||this.form.phone,address:this.form.shippings[0].address||this.form.areaName,consignee:this.form.shippings[0].consignee||this.form.consignee}),this.$set(this.form,"deliveryCorpId",this.form.shippings[0].deliveryCorpId));this.loading=!0,c["a"].shippingOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess"),console.log("shipping-success"),e.isShipped=!0}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}else if("service"===this.handler)this.loading=!0,c["a"].excuteOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}));else if("payment"===this.handler){if(this.loading=!0,this.paymentTypes.map((function(t){t.name===e.form.payments[0].paymentType&&(e.form.paymentTypeId=t.id)})),this.form.payment={payBank:this.form.payments[0].payBank,payAccount:this.form.payments[0].payAccount,amount:this.form.amount},!this.form.payments[0].paymentType||("刷卡"===this.form.payments[0].paymentType||"汇款"===this.form.payments[0].paymentType)&&(""===this.form.payments[0].payBank||""===this.form.payments[0].payAccount))return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.$refs.form.validate((function(t,i){t?c["a"].paymentOrder(e.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})):e.loading=!1}))}else this.loading=!0,c["a"].updateOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess"),"2"===e.form.orderType&&e.tagMapping()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}));else{if(!this.form.payments[0].paymentType)return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.createOrder()}var t=this.deliveryCorps.find((function(t){return t.id===e.form.shippings[0].deliveryCorpId})).name;"shipping"===this.handler&&"新悦物流"===t&&this.submitOrder()},setOrderItems:function(e){this.orderItems=e,this.orderItems.forEach((function(e){e.productId=e.productId?e.productId:e.id}));var t=0;e.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.originalAmount=t,this.form.originalAmount=t,this.offsetAmountChange(),this.form.member.nickname&&this.getCouponList()},createOrder:function(){var e=this;if(this.shippingMethod.map((function(t){t.name===e.form.shippingMethodName&&(e.form.shippingMethodId=t.id)})),this.paymentTypes.map((function(t){t.name===e.form.payments[0].paymentType&&(e.form.paymentTypeId=t.id)})),this.form.appointmentData=this.form.orderItems[0].appointment,"rescue"===this.$route.params.orderType&&(this.form.appointmentData.reasons=this.reasons.map((function(t){return-1!==e.form.appointmentData.reasons.indexOf(t.id)?{id:t.id,content:t.content}:{id:"",content:""}}))),this.showInfo&&!this.form.payments[0].paymentType||this.showInfo&&("刷卡"===this.form.payments[0].paymentType||"汇款"===this.form.payments[0].paymentType)&&(""===this.form.payments[0].payBank||""===this.form.payments[0].payAccount))return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.loading=!0,this.$refs.form.validate((function(t,i){t&&c["a"].createOrder({appointmentData:e.form.orderItems[0].appointment,appointmentDate:e.form.appointmentDate,appointmentEndDate:e.form.appointmentEndDate,sn:e.form.sn,type:e.form.type,orderType:e.$route.params.orderType,orderStatus:"交易完成"===e.form.type?"2":e.form.type,bean:e.form.beanDiscount,couponCode:e.getCouponCode,amount:e.form.amount,amountPrepay:e.form.amountPrepay,paymentTypeId:e.form.paymentTypeId,shippingMethod:{id:e.form.shippingMethodId},amountFinalpay:e.form.amountFinalpay,originalAmount:e.form.originalAmount,offsetAmount:e.form.offsetAmount,freight:e.form.shippings&&e.form.shippings.length?e.form.shippings[0].freight:"",memberCardId:e.form.memberCardId,amountPaid:e.form.curAmount,userId:e.form.userId,consultant:{id:e.form.consultant.id},car:{id:e.form.car.id},area:{id:e.areaId},address:e.form.address,areaName:e.form.areaName,consignee:e.form.consignee,phone:e.form.phone,zipCode:e.form.zipCode,remarks:e.form.remarks,memo:e.form.memo,promotionDiscount:e.form.promotionDiscount,couponDiscount:e.form.couponDiscount,beanDiscount:e.form.beanDiscount,point:e.form.point,giftBean:e.form.giftBean,shippingMethodName:e.form.shippingMethodName,paymentMethodId:e.form.paymentMethodId,invoiceState:e.form.invoiceState,orderTime:e.form.orderTime,deliveryTime:e.form.deliveryTime,paymentTime:e.form.paymentTime,completeTime:e.form.completeTime,orderItems:e.orderItems,payments:[{paymentType:e.form.payments[0].paymentType,payBank:e.form.payments[0].payBank,payAccount:e.form.payments[0].payAccount}],member:{nickname:e.form.member.nickname,gender:e.form.member.gender,mobile:e.form.member.mobile},shippings:[{isLCL:e.form.shippings[0].isLCL,shippingMethod:e.form.shippings[0].shippingMethod,deliveryCorpId:e.form.shippings[0].deliveryCorpId,expressSn:e.form.shippings[0].expressSn,freight:e.form.shippings[0].freight,address:e.form.shippings[0].address,consignee:e.form.shippings[0].consignee,phone:e.form.shippings[0].phone,zipCode:e.form.shippings[0].zipCode}]},(function(t){e.loading=!1,e.$message.success("保存成功"),e.form=e.getDefaultForm(),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.driveStartDate&&(e.form.orderItems[0].appointment.driveStartDate=e.form.orderItems[0].appointment.driveStartDate.split(" ")[1]),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.driveEndDate&&(e.form.orderItems[0].appointment.driveEndDate=e.form.orderItems[0].appointment.driveEndDate.split(" ")[1]),e.$emit("operationSuccess"),e.isCreated=!0,e.itemId=t.id,e.tagMapping()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},productChange:function(){var e=this;this.modeList.map((function(t){t.id===e.form.orderItems[0].appointment.product.id&&(e.form.orderItems[0].appointment.product.price=t.price)}))},listExistCardTemplate:function(){var e=this;c["a"].listExistCardTemplate({userId:this.form.userId},(function(t){e.loading=!1,e.listExistCard=t.content,e.listExistCard.forEach((function(e){e.template.name+=" ¥"+e.balance}))}),(function(e){console.log(e)}))},getFinancialPlans:function(){var e=this;c["a"].getFinancialPlans({shopId:window.top.SHOP_ID||""},(function(t){e.loading=!1,e.financialPlans=t.financials}),(function(e){console.log(e)}))},getSaveParams:function(){return{orderId:this.itemId}},areaChanged:function(e){this.areaId=e,this.isFirst&&(this.areaId="1568",this.isFirst=!1)},handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.form.orderItems[0].appointment.product,"seriesId",""),this.$set(this.form.orderItems[0].appointment.product,"id","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.form.orderItems[0].appointment.product,"id","")},queryMemberList:function(e){var t=this;c["a"].memberList(e,(function(e){t.dialogLoading=!1,t.dialogTableData=e.content,t.dialogPagination.total=Number(e.total)}),(function(e){console.log(e),console.log("code错误")}))},opened:function(){this.dialogPagination.currentPage=1,this.dialogPagination.pageSize=20,this.dialogFilters=[{type:"input",label:"",placeholder:"请输入名称或手机号",name:"searchValue",value:""}],this.queryMemberList(this.getDialogQueryParams())},getDialogQueryParams:function(){return{pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value}},productPageSizeChange:function(e){this.$set(this.productPagination,"pageSize",e)},productCurrentPageChange:function(e){this.$set(this.productPagination,"currentPage",e)},dialogFilterDataChange:function(e){this.dialogPagination.currentPage=1,this.queryMemberList(this.getDialogQueryParams())},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),this.queryMemberList(this.getDialogQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),this.queryMemberList(this.getDialogQueryParams())},handleSuccess:function(e,t,i){this.form.orderItems[0].appointment.images.push({path:e.fis[0].url})},handleRemove:function(e,t){var i=this.form.orderItems[0].appointment.images.findIndex((function(t){return t.path===e.path}));-1!==i&&this.form.orderItems[0].appointment.images.splice(i,1)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.picDialogVisible=!0},dialogOperate:function(e){},queryBrandList:function(){var e=this;c["a"].brands({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;c["a"].series({brandId:e},(function(e){t.seriesList=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},getBrandList:function(){var e=this;C["a"].queryBrandList({},(function(t){e.brandData=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},getSeriesList:function(e){var t=this;C["a"].querySeriesList({brand:e},(function(e){t.seriesData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},getModeList:function(e){var t=this;C["a"].queryTypeList({series:e,brand:this.formModel.defaultCarInfo.brand},(function(e){t.modeData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;c["a"].types({seriesId:e,brandId:this.form.brand},(function(e){t.modeList=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},beforeAvatarUpload:function(e){var t=/^image\/(.*)$/.test(e.type);if(!t)return this.$message.error("请选择符合图片格式的文件上传!"),!1;var i=e.size/1024<=200;return!!i||(this.$message.error("上传图片大小不能超过 200K!"),!1)},addMember:function(){this.formModel={userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",vin:"",brand:"",series:"",type:""}},this.dialogVisible=!0},getOrderStatus:function(e){switch(e){case"11":return"卖家已发货";case"10":return"退款退货完成";case"9":return"退款退货中";case"8":return"已过期";case"7":return"已评价";case"6":return"订单关闭";case"5":return"交易完成";case"4":return"订单已执行";case"3":return"买家已付款";case"2":return"商家已确认";case"1":return"待商家确认";default:return"无"}},testDrives:function(){var e=this,t={pageSize:1e3,pageNumber:1,shopId:window.top.SHOP_ID||""};M["a"].get("/admin/testDriveMgmt/testDrives.jhtml",t).then((function(t){e.restaurants=t.dataList.map((function(e){return{value:e.car.plateNumber,id:e.car.id,type:e.car.type}}))})).catch((function(e){console.log(e.errorMessage)}))},querySearchAsync:function(e,t){var i=this.restaurants,r=e?i.filter(this.createStateFilter(e)):i;t(r)},createStateFilter:function(e){return function(e){return!0}},handleSelect:function(e){this.form.orderItems[0].appointment.product.fullName=e.type}})},x=T,O=(i("0f32"),Object(b["a"])(x,r,a,!1,null,null,null));t["a"]=O.exports},b2d0:function(e,t,i){"use strict";var r=i("cb02"),a=i.n(r);a.a},b4cc:function(e,t,i){"use strict";var r=i("d9b9"),a=i.n(r);a.a},b547:function(e,t,i){},b680:function(e,t,i){"use strict";var r=i("23e7"),a=i("a691"),s=i("408a"),o=i("1148"),n=i("d039"),l=1..toFixed,c=Math.floor,d=function(e,t,i){return 0===t?i:t%2===1?d(e,t-1,i*e):d(e*e,t/2,i)},p=function(e){var t=0,i=e;while(i>=4096)t+=12,i/=4096;while(i>=2)t+=1,i/=2;return t},u=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n((function(){l.call({})}));r({target:"Number",proto:!0,forced:u},{toFixed:function(e){var t,i,r,n,l=s(this),u=a(e),m=[0,0,0,0,0,0],f="",h="0",g=function(e,t){var i=-1,r=t;while(++i<6)r+=e*m[i],m[i]=r%1e7,r=c(r/1e7)},v=function(e){var t=6,i=0;while(--t>=0)i+=m[t],m[t]=c(i/e),i=i%e*1e7},b=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==m[e]){var i=String(m[e]);t=""===t?i:t+o.call("0",7-i.length)+i}return t};if(u<0||u>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(f="-",l=-l),l>1e-21)if(t=p(l*d(2,69,1))-69,i=t<0?l*d(2,-t,1):l/d(2,t,1),i*=4503599627370496,t=52-t,t>0){g(0,i),r=u;while(r>=7)g(1e7,0),r-=7;g(d(10,r,1),0),r=t-1;while(r>=23)v(1<<23),r-=23;v(1<<r),g(1,1),v(2),h=b()}else g(0,i),g(1<<-t,0),h=b()+o.call("0",u);return u>0?(n=h.length,h=f+(n<=u?"0."+o.call("0",u-n)+h:h.slice(0,n-u)+"."+h.slice(n-u))):h=f+h,h}})},b755:function(e,t,i){},b84c:function(e,t,i){},b89e:function(e,t,i){e.exports=i.p+"static/img/pic_default_fail.876971c2.png"},ba46:function(e,t,i){"use strict";var r=i("1bdb"),a=i.n(r);a.a},bea5:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"membership-mgmt__vehicle-info"},[e.isEdit?i("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}}):e._e(),i("el-table",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"85%",size:"small"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[i("biz-empty-table",{attrs:{slot:"empty"},slot:"empty"}),i("el-table-column",{attrs:{prop:"plateNumber",label:"车牌号"}}),i("el-table-column",{attrs:{prop:"type",label:"车型"}}),i("el-table-column",{attrs:{prop:"engineNumber",label:"发动机号"}}),i("el-table-column",{attrs:{prop:"vin",label:"车辆识别代号","min-width":"120"}}),e.ishandler?i("el-table-column",{attrs:{prop:"title",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEdit?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.rowDeleteClickHandler(i,t.row)}}},[e._v(" 删除 ")]):e._e(),e.isEdit?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleRowClick(i,t.row)}}},[e._v(" 编辑 ")]):e._e()]}}],null,!1,1370604828)}):e._e()],1),i("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[e.isEdit?i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.handleOperate}}):e._e(),e.isEdit?i("vehicle-base-info-content",{ref:"baseInfo",attrs:{itemId:e.formId,memberId:e.itemId},on:{operationSuccess:e.handleOperationSuccess}}):e._e()],1)],1)},a=[],s=(i("4160"),i("d3b7"),i("159b"),i("5530")),o=i("8330"),n=i("04d3"),l=i("f36f"),c=i("dcc1"),d=i("c596"),p=i("1ab1"),u=i("3193"),m={data:{loading:!1,ishandler:!0,show:!0,operations:[{label:"新增",name:"add",type:"primary"}]},methods:{getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",userId:this.itemId.id,pageSize:100,pageNumber:1}},query:function(){var e=this;this.loading=!0,p["a"].get(d["o"].vehicleInfo.list,this.getQueryParams()).then((function(t){e.tableData=t.ownCars,e.showForm=!1,e.show=!0})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},add:function(){this.show=!1,this.initForm()},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")}},events:{handleOperate:function(e){this[e]()}}},f={data:{tableData:[],selections:[]},methods:{deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var i={ids:e};p["a"].post(d["o"].vehicleInfo.delete,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))}},events:{rowDeleteClickHandler:function(e,t){e.stopPropagation(),this.deleteItem([t.id])},handleRowClick:function(e){this.initForm(e)},handleSelectionChange:function(e){this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1),this.selections=e}}},h={data:{showForm:!1,formId:{id:""},formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"saveForm",type:"primary"}]},methods:{initForm:function(e){this.formId=e?{id:e.id}:{id:""},this.showForm=!0},cancelForm:function(){this.showForm=!1,this.show=!0},saveForm:function(){var e=this,t=this.$refs.baseInfo.getSaveParams();t.userId=this.itemId.id,t.carSales=this.$refs.baseInfo.getSaveParams().carSalesData,t.carQualityAssurance=this.$refs.baseInfo.getSaveParams().carQualityAssurance,t.car={id:t.id,plateNumber:t.plateNumber,brand:t.brand,series:t.series,type:t.type,shop:t.shop,state:t.state,onTime:t.onTime,isCV:t.isCV,trafficControl:t.trafficControl,remarks:t.remarks,drivingRange:t.drivingRange,carshipId:t.carshipId,vin:t.vin,engineNumber:t.engineNumber,bodyColor:t.bodyColor,plateColor:t.plateColor,fuelGrade:t.fuelGrade,transmissionType:t.transmissionType,dischargeStandard:t.dischargeStandard,productionTime:t.productionTime,terminals:t.terminals,carLicense:t.carLicense},this.formId.id&&p["a"].post(d["o"].vehicleInfo.update,t).then((function(t){e.$message.success("保存成功"),e.query()})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1})),!this.formId.id&&p["a"].post(d["o"].vehicleInfo.add,t).then((function(t){e.$message.success("保存成功"),e.query()})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}},events:{handleOperationSuccess:function(){this.query()}}},g={name:"MembershipMgmtVehicleInfo",components:{BizHeader:n["d"],BizGrid:l["a"],BizSaveButton:o["a"],VehicleBaseInfoContent:u["a"],BizEmptyTable:c["a"]},props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}},alertId:{type:Object,default:function(){return{id:""}}}},data:function(){return Object(s["a"])(Object(s["a"])(Object(s["a"])({},m.data),f.data),h.data)},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},m.methods),m.events),f.methods),f.events),h.methods),h.events),watch:{itemId:function(e,t){e.id&&this.query()},alertId:function(e){e.id&&this.getCallbackInfo(e)}},created:function(){this.itemId.id&&this.query()}},v=g,b=(i("9de1"),i("2877")),y=Object(b["a"])(v,r,a,!1,null,null,null);t["a"]=y.exports},c162:function(e,t,i){},c2cb:function(e,t,i){"use strict";var r=i("fd29"),a=i.n(r);a.a},c365:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"vehicle-mgmt-vehicle__people-picker"},[r("el-input",{attrs:{placeholder:"请选择用户",readonly:"readonly"},model:{value:e.value[e.contentField],callback:function(t){e.$set(e.value,e.contentField,t)},expression:"value[contentField]"}},[r("el-button",{staticClass:"el-icon-circle-plus-outline",staticStyle:{color:"#fa9f33",padding:"10px"},attrs:{slot:"append",type:"primary"},on:{click:e.addMember},slot:"append"}),r("el-button",{staticClass:"iconfont biz-icon-man",staticStyle:{padding:"2px 10px",color:"#fa9f33"},attrs:{slot:"append",type:"primary"},on:{click:e.clickHandler},slot:"append"})],1),r("el-dialog",{attrs:{title:"添加所有者",visible:e.dialogVisible,width:"50%",appendToBody:!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"dialogFormModel",attrs:{model:e.formMember,"label-width":"120px",size:"small",rules:e.dialogRules,"inline-message":!0}},[r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{attrs:{placeholder:"请输入手机号，如1888888888"},on:{blur:e.mobileBlur},model:{value:e.formMember.mobile,callback:function(t){e.$set(e.formMember,"mobile",t)},expression:"formMember.mobile"}})],1),r("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[r("el-input",{attrs:{placeholder:"请输入用户名，如1888888888"},model:{value:e.formMember.userName,callback:function(t){e.$set(e.formMember,"userName",t)},expression:"formMember.userName"}})],1),r("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[r("el-input",{attrs:{placeholder:"请输入昵称，如1888888888"},model:{value:e.formMember.nickname,callback:function(t){e.$set(e.formMember,"nickname",t)},expression:"formMember.nickname"}})],1),r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入姓名，如张三"},model:{value:e.formMember.name,callback:function(t){e.$set(e.formMember,"name",t)},expression:"formMember.name"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入密码"},model:{value:e.formMember.password,callback:function(t){e.$set(e.formMember,"password",t)},expression:"formMember.password"}})],1),r("el-form-item",{attrs:{label:"性别",prop:"gender"}},[r("el-radio-group",{model:{value:e.formMember.gender,callback:function(t){e.$set(e.formMember,"gender",t)},expression:"formMember.gender"}},[r("el-radio",{attrs:{label:"0"}},[e._v("男")]),r("el-radio",{attrs:{label:"1"}},[e._v("女")]),r("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),r("el-form-item",{attrs:{label:"车牌号"}},[r("el-input",{attrs:{placeholder:"请输入车牌号，如浙12345"},model:{value:e.formMember.defaultCarInfo.plateNumber,callback:function(t){e.$set(e.formMember.defaultCarInfo,"plateNumber",t)},expression:"formMember.defaultCarInfo.plateNumber"}})],1),r("el-form-item",{attrs:{label:"品牌"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马",filterable:""},on:{change:e.brandChange},model:{value:e.formMember.defaultCarInfo.brand,callback:function(t){e.$set(e.formMember.defaultCarInfo,"brand",t)},expression:"formMember.defaultCarInfo.brand"}},e._l(e.brandData,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"系列"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系",filterable:""},on:{change:e.seriesChange},model:{value:e.formMember.defaultCarInfo.series,callback:function(t){e.$set(e.formMember.defaultCarInfo,"series",t)},expression:"formMember.defaultCarInfo.series"}},e._l(e.seriesData,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"车型"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系2016款"},model:{value:e.formMember.defaultCarInfo.type,callback:function(t){e.$set(e.formMember.defaultCarInfo,"type",t)},expression:"formMember.defaultCarInfo.type"}},e._l(e.modeData,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"车辆识别代码"}},[r("el-input",{attrs:{placeholder:"请输入车辆识别代码，如1G1BL52P7TR115520"},model:{value:e.formMember.defaultCarInfo.vin,callback:function(t){e.$set(e.formMember.defaultCarInfo,"vin",t)},expression:"formMember.defaultCarInfo.vin"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.createMember()}}},[e._v("确 定")])],1)],1),r("biz-dialog-selector",{attrs:{slot:"float",visibility:e.showDialog,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,selectionMode:"single",isClear:!1,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[r("el-table-column",{attrs:{prop:"userName",label:"会员信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"customer-info"},[t.row.head?r("img",{attrs:{src:t.row.head}}):r("img",{attrs:{src:i("624d")}}),r("div",{staticClass:"wrapper"},[r("div",{staticClass:"title",attrs:{title:t.row.name}},[e._v(e._s(t.row.name))]),r("div",{staticClass:"gender"},["0"===t.row.gender?r("i",{staticClass:"male iconfont biz-icon-i-web-m"}):e._e(),"1"===t.row.gender?r("i",{staticClass:"female iconfont biz-icon-i-web-f"}):e._e(),"2"===t.row.gender?r("i",{staticClass:"none iconfont biz-icon-i-web-bm"}):e._e(),r("span",[e._v(e._s(t.row.mobile||t.row.contactMobile))])])])])]}}])}),r("el-table-column",{attrs:{prop:"nickname",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("1"===t.row.enableState?"启用":"停用")+" ")]}}])}),r("el-table-column",{attrs:{prop:"nickname",label:"店铺"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.shop.name)+" ")]}}])}),r("el-table-column",{attrs:{prop:"nickname",label:"最后登录"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lastLoginDate)+" ")]}}])})],1)],1)},a=[],s=(i("b0c0"),i("af3f")),o=i("e4c3"),n=i("0e5e"),l=i("e42c"),c={name:"VehicleMgmtPeoplePicker",components:{BizDialogSelector:s["a"]},model:{prop:"value",event:"input"},props:{value:{type:Object},contentField:{type:String,default:function(){return"name"}}},data:function(){var e=this;return{text:"",showDialog:!1,dialogLoading:!1,dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入姓名/手机号",name:"searchValue",value:""}],dialogVisible:!1,dialogRules:{userName:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[0-9a-zA-Z]+$/,message:"用户名只能为数字或字母",trigger:"blur"},{min:4,max:20,message:"长度在4-20位",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"}],name:[{required:!0,trigger:"blur",message:"请输入姓名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:20,message:"密码应在6-20位之间",trigger:"blur"}],rePassword:[{required:!0,trigger:"blur",message:"请再次输入密码"},{trigger:"blur",validator:function(t,i,r){e.formMember.password===e.formMember.rePassword?r():r(new Error("两次输入密码不一致"))}}]},formMember:{userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",brand:"",series:"",type:"",vin:""}},brandData:[],seriesData:[],brandList:[],seriesList:[],modeData:[]}},methods:{addMember:function(){this.formMember={userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",vin:"",brand:"",series:"",type:""}},this.queryBrandList(),this.getBrandList(),this.dialogVisible=!0},createMember:function(){var e=this;this.$refs.dialogFormModel.validate((function(t,i){t&&l["a"].createMember(e.formMember,(function(t){e.loading=!1,e.$message.success("保存成功"),e.dialogVisible=!1;var i={defaultCarInfo:{id:t.data.defaultCarInfo?t.data.defaultCarInfo.id:"",brand:t.data.defaultCarInfo?t.data.defaultCarInfo.brand:"",plateNumber:t.data.defaultCarInfo?t.data.defaultCarInfo.plateNumber:"",series:t.data.defaultCarInfo?t.data.defaultCarInfo.series:"",type:t.data.defaultCarInfo?t.data.defaultCarInfo.type:""},gender:t.data.gender,id:t.data.id,mobile:t.data.mobile,name:t.data.name,userName:t.data.name};e.$emit("input",i)}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},mobileBlur:function(){this.formMember.id||this.formMember.nickname||this.$set(this.formMember,"nickname",this.formMember.mobile),this.formMember.id||this.formMember.userName||this.$set(this.formMember,"userName",this.formMember.mobile)},brandChange:function(e){this.getSeriesList(e),this.formMember.defaultCarInfo.series="",this.formMember.defaultCarInfo.type=""},seriesChange:function(e){this.getModeList(e),this.formMember.defaultCarInfo.type=""},queryBrandList:function(){var e=this;n["a"].queryBrandList({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;n["a"].querySeriesList({brand:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},getBrandList:function(){var e=this;n["a"].queryBrandList({},(function(t){e.brandData=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},getSeriesList:function(e){var t=this;n["a"].querySeriesList({brand:e},(function(e){t.seriesData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},getModeList:function(e){var t=this;n["a"].queryTypeList({series:e,brand:this.formMember.defaultCarInfo.brand},(function(e){t.modeData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryPeople:function(e){var t=this;this.dialogLoading=!0,o["a"].queryPeople(e,(function(e){t.dialogTableData=e.content,t.$set(t.dialogPagination,"total",parseInt(e.total)),t.dialogLoading=!1}),(function(e){console.log(e),console.log("code错误")}))},getStatus:function(e){switch(e.enableState){case"0":return"停用";case"1":return"启用"}return""},clickHandler:function(e){this.showDialog=!0},confirmedHandler:function(e,t){var i=t[0];this.text=i.name,this.$emit("input",i)},getDialogQueryParams:function(){return{pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||""}},openedHandler:function(){this.dialogPagination.currentPage=1,this.dialogPagination.pageSize=20,this.dialogFilters=[{type:"input",label:"",placeholder:"请输入姓名/手机号",name:"searchValue",value:""}],this.queryPeople(this.getDialogQueryParams())},dialogFilterDataChange:function(e){this.$set(this.dialogPagination,"currentPage",1),this.queryPeople(this.getDialogQueryParams())},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),this.queryPeople(this.getDialogQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),this.queryPeople(this.getDialogQueryParams())}}},d=c,p=(i("50c2"),i("2877")),u=Object(p["a"])(d,r,a,!1,null,null,null);t["a"]=u.exports},c466:function(e,t,i){"use strict";i("99af"),i("d3b7"),i("ac1f"),i("25f0"),i("5319");t["a"]={nowDate:function(){var e=new Date,t=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getDate()+1<10?"0"+e.getDate():e.getDate();return e.getFullYear().toString()+"-"+t+"-"+i},getMonthDays:function(e){var t=new Date(Date.parse(e.replace(/-/g,"/"))),i=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth()+1,1),a=(r-i)/864e5;return a},halfYearAgo:function(e){var t="";return t=e?new Date(Date.parse(e.replace(/-/g,"/"))):new Date,console.log(t),t.setMonth(t.getMonth()-6),"".concat(t.getFullYear(),"-").concat(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getDate()<10?"0"+t.getDate():t.getDate())},lastMonthDate:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1<10?"0"+e.getMonth():e.getMonth(),r=e.getDate()+1<10?"0"+e.getDate():e.getDate();return"00"===i&&(i="12",t--),t.toString()+"-"+i+"-"+r},nextMonthDate:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1,r=e.getDate(),a=parseInt(i)+1;13===a&&(t=parseInt(t)+1,a=1);var s=new Date(t,a,0);return s=s.getDate(),r>s&&(r=s),a<10&&(a="0"+a),t+"-"+a+"-"+r},lastYearDate:function(){var e=new Date,t=new Date(e.getFullYear()-1,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastTwoYearDate:function(){var e=new Date,t=new Date(e.getFullYear()+2,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastNYearDate:function(e,t){var i=new Date(e),r=new Date(i.getFullYear()+parseInt(t),i.getMonth(),i.getDate());return r.getFullYear()+"-"+this.convertToFullMode(r.getMonth()+1)+"-"+this.convertToFullMode(r.getDate())},dateConverter:function(e){return e instanceof Date?e.getFullYear()+"-"+this.convertToFullMode(e.getMonth()+1)+"-"+this.convertToFullMode(e.getDate()):e},timeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes())+":"+this.convertToFullMode(e.getSeconds()):e},shortTimeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes()):e},dateTimeConverter:function(e){return e instanceof Date?this.dateConverter(e)+" "+this.timeConverter(e):e},convertToFullMode:function(e){return e=e.toString(),1===e.length?"0"+e:e}}},cb02:function(e,t,i){},d158:function(e,t,i){"use strict";var r=i("c162"),a=i.n(r);a.a},d437:function(e,t,i){},d438:function(e,t,i){"use strict";var r=i("e647"),a=i.n(r);a.a},d4c2:function(e,t,i){"use strict";var r=i("e725"),a=i.n(r);a.a},d9b9:function(e,t,i){},e0d7:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"membership-mgmt__base-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}):e._e(),i("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,disabled:!e.isEdit,":inline-message":!0}},[i("el-collapse",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-collapse-item",{attrs:{title:"基本信息",name:"baseInfo"}},["1"===e.formModel.memberType?i("div",[e.formModel.photo?i("el-form-item",{attrs:{label:"人像"}},[i("img",{attrs:{src:e.formModel.photo,width:"60px"}})]):e._e(),i("el-form-item",{attrs:{label:"企业名",prop:"enterpriseName"}},[i("el-input",{model:{value:e.formModel.enterpriseName,callback:function(t){e.$set(e.formModel,"enterpriseName",t)},expression:"formModel.enterpriseName"}})],1),i("el-form-item",{attrs:{label:"关联V服店铺",prop:"enterprise"}},[i("el-input",{attrs:{disabled:""},model:{value:e.formModel.enterprise,callback:function(t){e.$set(e.formModel,"enterprise",t)},expression:"formModel.enterprise"}})],1),i("el-form-item",{attrs:{label:"联系人",prop:"contactPerson"}},[i("el-input",{model:{value:e.formModel.contactPerson,callback:function(t){e.$set(e.formModel,"contactPerson",t)},expression:"formModel.contactPerson"}})],1),i("el-form-item",{attrs:{label:"电话",prop:"contactMobile"}},[i("el-input",{model:{value:e.formModel.contactMobile,callback:function(t){e.$set(e.formModel,"contactMobile",t)},expression:"formModel.contactMobile"}})],1)],1):e._e(),"0"===e.formModel.memberType?i("div",[i("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[i("el-input",{attrs:{type:"phone",maxlength:"11",placeholder:"请输入手机号"},on:{blur:e.mobileBlur},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),i("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[i("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.formModel.userName,callback:function(t){e.$set(e.formModel,"userName",t)},expression:"formModel.userName"}})],1),i("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[i("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.formModel.nickname,callback:function(t){e.$set(e.formModel,"nickname",t)},expression:"formModel.nickname"}})],1),i("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[i("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.formModel.realName,callback:function(t){e.$set(e.formModel,"realName",t)},expression:"formModel.realName"}})],1),e.formModel.id?e._e():i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{attrs:{type:"text",placeholder:"请输入6-16位密码"},model:{value:e.formModel.password,callback:function(t){e.$set(e.formModel,"password",t)},expression:"formModel.password"}})],1),i("el-form-item",{attrs:{label:"性别",prop:"gender"}},[i("el-radio-group",{model:{value:e.formModel.gender,callback:function(t){e.$set(e.formModel,"gender",t)},expression:"formModel.gender"}},[i("el-radio",{attrs:{label:"0"}},[e._v("男")]),i("el-radio",{attrs:{label:"1"}},[e._v("女")]),i("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),i("el-form-item",{attrs:{label:"出生日期",prop:"birth"}},[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入出生日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.birth,callback:function(t){e.$set(e.formModel,"birth",t)},expression:"formModel.birth"}})],1),i("el-form-item",{attrs:{label:"挪车码",prop:"moveCarCode"}},[i("el-input",{attrs:{disabled:""},model:{value:e.formModel.moveCarCode,callback:function(t){e.$set(e.formModel,"moveCarCode",t)},expression:"formModel.moveCarCode"}})],1)],1):e._e(),i("el-form-item",{attrs:{label:"专属顾问",prop:"consultant"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择专属顾问"},model:{value:e.formModel.consultant.id,callback:function(t){e.$set(e.formModel.consultant,"id",t)},expression:"formModel.consultant.id"}},e._l(e.consultant,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"地址"}},[i("biz-area-select",{attrs:{areaId:e.formModel.area.id},on:{areaChanged:e.handleAreaChanged}})],1):e._e(),"1"===e.formModel.memberType?i("el-form-item",{attrs:{label:"地址"}},[i("el-input",{model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1):e._e(),i("el-form-item",{attrs:{label:"状态",prop:"enableState"}},[i("el-switch",{attrs:{"active-value":"1","inactive-color":"#d9d9d9","active-color":"#87d068","inactive-value":"0"},model:{value:e.formModel.enableState,callback:function(t){e.$set(e.formModel,"enableState",t)},expression:"formModel.enableState"}})],1),e.formModel.id?i("el-form-item",{attrs:{label:"用户来源"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:""},model:{value:e.formModel.userSource,callback:function(t){e.$set(e.formModel,"userSource",t)},expression:"formModel.userSource"}},e._l(e.sourceList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),i("el-form-item",{attrs:{label:"会员标签"}},[i("div",{staticStyle:{display:"flex","flex-flow":"wrap"}},[e._l(e.formModel.shopTags,(function(t,r){return i("el-popover",{key:r,attrs:{placement:"bottom-end",width:"200",trigger:"hover"}},[i("div",[e._v(" "+e._s("0"===t.hierarchy?"平台级":"1"===t.hierarchy?"店铺级":"2"===t.hierarchy?"运营商级":"3"===t.hierarchy?"模板级":"用户级")+", 来源："+e._s(t.tagCategory?t.tagCategory.fullName:"")+" ")]),i("div",{staticClass:"tag-container",attrs:{slot:"reference"},slot:"reference"},[i("el-tag",{staticClass:"member-tag",attrs:{closable:!t.deletable||"0"!==t.deletable},on:{close:function(i){return e.onClose(t)}}},[e._v(" "+e._s(t.name))])],1)])})),i("div",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onClickHandle}},[e._v("+")])],1)],2)])],1),i("el-collapse-item",{attrs:{title:"所属店铺",name:"shopInfo"}},[i("el-table",{attrs:{size:"small",data:e.formModel.shops}},[i("el-table-column",{attrs:{label:"店铺名称",prop:"name"}}),i("el-table-column",{attrs:{label:"详细地址",prop:"address"}}),i("el-table-column",{attrs:{label:"销售电话",prop:"mobile"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleDeleteClick(t.row)}}},[e._v("删除")])]}}])})],1)],1),i("el-collapse-item",{attrs:{title:"扩展信息",name:"advanceInfo"}},["0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"情感状态",prop:"emotionalState"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.emotionalState,callback:function(t){e.$set(e.formModel,"emotionalState",t)},expression:"formModel.emotionalState"}},e._l(e.emotionalStateList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"家庭身份",prop:"familialIdentity"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.familialIdentity,callback:function(t){e.$set(e.formModel,"familialIdentity",t)},expression:"formModel.familialIdentity"}},e._l(e.familialIdentityList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"社会身份",prop:"socialIdentity"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.socialIdentity,callback:function(t){e.$set(e.formModel,"socialIdentity",t)},expression:"formModel.socialIdentity"}},e._l(e.socialIdentityList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"学历",prop:"education"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.education,callback:function(t){e.$set(e.formModel,"education",t)},expression:"formModel.education"}},e._l(e.educationList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"收入状况",prop:"incomeState"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.incomeState,callback:function(t){e.$set(e.formModel,"incomeState",t)},expression:"formModel.incomeState"}},e._l(e.incomeStateList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!!e.formModel.id,expression:"!!formModel.id"}],attrs:{label:"创建日期",prop:"name"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.formModel.createDate))])]),"0"===e.formModel.memberType?i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!!e.formModel.id,expression:"!!formModel.id"}],attrs:{label:"最后登录地址",prop:"name"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.formModel.loginAddress||e.formModel.lastLoginIp))])]):e._e(),"0"===e.formModel.memberType?i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!!e.formModel.id,expression:"!!formModel.id"}],attrs:{label:"最后登录日期",prop:"name"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.formModel.lastLoginDate))])]):e._e()],1)],1),i("el-dialog",{staticClass:"member-ship-info",attrs:{title:"添加标签",visible:e.showSelecTags,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.showSelecTags=t}}},[i("div",{staticClass:"member-ship-select-tag"},[i("div",{staticClass:"tag-type"},[i("div",{staticClass:"handel-name"},[e._v("标签种类")]),i("el-cascader",{attrs:{options:e.tagTypeOptions},on:{change:e.tagTypeChange},model:{value:e.tagClass,callback:function(t){e.tagClass=t},expression:"tagClass"}})],1),i("div",{staticClass:"tag-type"},[i("div",{staticClass:"handel-name"},[e._v("标签")]),i("el-cascader",{attrs:{options:e.tagOptions},on:{change:e.tagChange},model:{value:e.selectTag,callback:function(t){e.selectTag=t},expression:"selectTag"}})],1)]),i("biz-save-button",{attrs:{slot:"footer",operations:e.tagOperations},on:{operate:e.tagOperate},slot:"footer"})],1)],1)],1)},a=[],s=(i("4160"),i("c975"),i("d81d"),i("45fc"),i("a434"),i("b0c0"),i("d3b7"),i("159b"),i("5530")),o=i("b85c"),n=i("f36f"),l=i("8330"),c=i("ce2e"),d=i("0e5e"),p=i("c596"),u=i("1ab1"),m=i("c466"),f=i("2f62"),h={data:{activeTab:["baseInfo"],emotionalStateList:[{value:"0",label:"单身贵族"},{value:"1",label:"热恋期"},{value:"2",label:"有家室"}],familialIdentityList:[{value:"0",label:"宝妈"},{value:"1",label:"宝爸"},{value:"2",label:"我还是个宝宝"}],socialIdentityList:[{value:"0",label:"白领"},{value:"1",label:"蓝领"},{value:"2",label:"在校学生"},{value:"3",label:"自由职业"},{value:"4",label:"创业者"},{value:"5",label:"农民"},{value:"6",label:"无业游民"}],educationList:[{value:"0",label:"高中及以下"},{value:"1",label:"专科"},{value:"2",label:"本科"},{value:"3",label:"研究生"},{value:"4",label:"博士生"}],incomeStateList:[{value:"0",label:"入不敷出"},{value:"1",label:"收支平衡"},{value:"2",label:"小康家庭"},{value:"3",label:"富裕家庭"},{value:"4",label:"财务自由"}],tagClass:[],memberTags:[],showSelecTags:!1,brandList:[],seriesList:[],modeList:[],tagTypeOptions:[],tagOptions:[],selectTag:[],arryList:[],tagOperations:[{label:"取消",name:"cancel"},{label:"确认选择",name:"confirm",type:"primary"}],operations:[{label:"保存",name:"save",type:"primary"}],consultant:[],areaId:"1568",sourceList:[{value:"0",label:"推荐注册"},{value:"1",label:"潜客转化"},{value:"2",label:"正常注册"},{value:"3",label:"后台创建"},{value:"4",label:"其他"}]},events:{handleOperate:function(e){this[e]()},tagOperate:function(e){this[e]()}},methods:{}},g=function(){return{gender:"2",enableState:"1",password:"123456",area:{id:"1568"},consultant:{id:""},areaId:"1568",shopTags:[],memberType:"0",enterpriseName:"",enterprise:"",contactPerson:"",contactMobile:"",defaultCarInfo:{plateNumber:"",brand:"",series:"",type:"",vin:""},moveCarCode:"",emotionalState:"",familialIdentity:"",socialIdentity:"",education:"",incomeState:""}},v={data:{loading:!1,formModel:g(),pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}}},events:{handleAreaChanged:function(e){console.log(222),this.formModel.area.id=e}},methods:{mobileBlur:function(){this.formModel.id||this.formModel.nickname||this.$set(this.formModel,"nickname",this.formModel.mobile),this.formModel.id||this.formModel.userName||this.$set(this.formModel,"userName",this.formModel.mobile),this.$refs.form.clearValidate()},handleDeleteClick:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,u["a"].delete("/admin/member/relateShop.jhtml",{shopId:e.id,id:t.itemId.id}).then((function(i){t.formModel.shops.splice(t.formModel.shops.indexOf(e),1),t.$message.success("删除成功")})).catch((function(e){console.log(e),console.log("code错误"),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},handleBrandChange:function(e){this.querySeriesList(e),this.formModel.defaultCarInfo.series="",this.formModel.defaultCarInfo.type=""},handleSeriesChange:function(e){this.queryTypeList(e),this.formModel.defaultCarInfo.type=""},querySeriesList:function(e){var t=this;d["a"].querySeriesList({brand:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryBrandList:function(){var e=this;d["a"].queryBrandList({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;d["a"].queryTypeList({series:e,brand:this.formModel.defaultCarInfo.brand},(function(e){t.modeList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},cancel:function(){this.showSelecTags=!1},confirm:function(){var e;if(this.selectTag.length)if(e=this.selectTag[this.selectTag.length-1],this.containsSameTag(e))this.$message.warning("该标签已存在，请重新选择");else{var t,i,r="",a=Object(o["a"])(this.tagTypeOptions);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(2===this.tagClass.length){if(s.children){var n,l=Object(o["a"])(s.children);try{for(l.s();!(n=l.n()).done;){var c=n.value;this.tagClass[0]===s.value&&this.tagClass[1]===c.value&&(r="会员标签/"+s.label+"/"+c.label)}}catch(p){l.e(p)}finally{l.f()}}}else this.tagClass[0]===s.value&&(r="会员标签/"+s.label)}}catch(p){a.e(p)}finally{a.f()}this.arryList.map((function(i){i.name===e&&(t={id:i.id,name:i.name,hierarchy:i.hierarchy,tagCategory:{fullName:r}})})),this.showSelecTags=!1;var d=this.formModel.shopTags.some((function(e){if(e.name===t.name)return!0}));d||this.formModel.shopTags.push(t)}},onClickHandle:function(){this.showSelecTags=!0,this.selectTag=[],this.tagClass=[]},initModel:function(e){e?(this.formModel=Object.assign(this.getDefaultModel(),e),this.$set(this.formModel,"password",""),this.areaId=this.formModel.area.id||"1568"):this.resetModel()},resetModel:function(){this.formModel=this.getDefaultModel(),this.areaId="1568"},getDefaultModel:function(){return g()},query:function(e){var t=this;this.loading=!0;var i=this.itemId.id;e&&(i=e),u["a"].get(p["o"].baseInfo.query,{id:i,shopId:window.top.SHOP_ID||""}).then((function(e){t.initModel(e.memberData),t.checkIfAdmin()})).catch((function(e){console.log(e),console.log("code错误"),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},checkIfAdmin:function(){var e=this;console.log(this.consultant),u["a"].post("/admin/common/roleAdmins.jhtml",{roleTypes:["afterSaleAdmin","afterSale"]}).then((function(t){if(e.consultant=t.dataList,e.formModel.consultant.id){for(var i=!0,r=0;r<e.consultant.length;r++)e.consultant[r].id===String(e.formModel.consultant.id)&&(i=!1);i&&e.consultant.unshift({id:e.formModel.consultant.id,name:e.formModel.consultant.name})}})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},getConsultant:function(){var e=this;this.loading=!0,u["a"].post("/admin/common/roleAdmins.jhtml",{roleTypes:["afterSaleAdmin","afterSale"]}).then((function(t){e.consultant=t.dataList})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},getSaveParams:function(){return{token:"",shopId:window.top.SHOP_ID||"",consultant:{id:this.formModel.consultant.id},id:this.formModel.id,area:{id:this.formModel.area.id},userName:this.formModel.userName,mobile:this.formModel.mobile,password:this.formModel.password,realName:this.formModel.realName,nickname:this.formModel.nickname,gender:this.formModel.gender,birth:m["a"].dateConverter(this.formModel.birth),enableState:this.formModel.enableState,userSource:this.formModel.userSource,shopTags:this.formModel.shopTags,defaultCarInfo:{plateNumber:this.formModel.defaultCarInfo.plateNumber,brand:this.formModel.defaultCarInfo.brand,series:this.formModel.defaultCarInfo.series,type:this.formModel.defaultCarInfo.type,vin:this.formModel.defaultCarInfo.vin},emotionalState:this.formModel.emotionalState,familialIdentity:this.formModel.familialIdentity,socialIdentity:this.formModel.socialIdentity,education:this.formModel.education,incomeState:this.formModel.incomeState}},containsSameTag:function(e){var t=!1;return this.formModel.shopTags.forEach((function(i){if(e===i)return t=!0,!1})),t},save:function(){var e=this;this.$refs.form.validate((function(t,i){if(!t)return!1;e.loading=!0;var r=function(t){e.$message.success("保存成功"),e.formModel.id||(e.formModel=e.getDefaultModel()),e.$emit("operationSuccess")},a=function(t){console.log(t),console.log("code错误"),e.$message.warning(t.errorMessage),"450"!==t.resultCode&&"1121"!==t.resultCode||e.query(t.memberId)},s=function(t){e.loading=!1},o=e.getSaveParams();e.formModel.id?u["a"].put(p["o"].baseInfo.update,o).then(r).catch(a).finally(s):u["a"].post(p["o"].baseInfo.create,o).then(r).catch(a).finally(s)}))},getTagClassList:function(){var e,t=this,i={categoryType:"会员标签"};"platform"===this.getUser.roleLevel?e=p["g"].systemSetting.platformTagcategories:"shop"===this.getUser.roleLevel&&(e=p["g"].systemSetting.storeTagcategories,i.shopId=window.top.SHOP_ID||""),u["a"].get(e,i).then((function(e){var i,r=e.content;t.tagTypeOptions=[],r.forEach((function(e){i={},i.label=e.name,i.value=e.id,t.tagTypeOptions.push(i),e.children&&e.children.length&&(i.children=[],e.children.forEach((function(e){var t={};t.label=e.name,t.value=e.id,i.children.push(t),e.children&&e.children.length&&(t.children=[],e.children.forEach((function(e){var i={};i.label=e.name,i.value=e.id,t.children.push(i),e.children&&e.children.length&&(i.children=[],e.children.forEach((function(e){var t={};t.label=e.name,t.value=e.id,i.children.push(t)})))})))})))}))})).catch((function(e){"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){}))},onClose:function(e){for(var t=this.formModel.shopTags,i=t.length,r=0;r<i;r++)if(t[r]===e){t.splice(r,1);break}},tagChange:function(e){console.log(e)},tagTypeChange:function(e){var t,i=this,r=e[e.length-1],a={tagCategoryId:r};"platform"===this.getUser.roleLevel?t=p["g"].systemSetting.getPlatformTags:"shop"===this.getUser.roleLevel&&(t=p["g"].systemSetting.storeTags,a.shopId=window.top.SHOP_ID||""),u["a"].get(t,a).then((function(e){console.log(i.tagTypeOptions),i.tagOptions=[];var t,r=Object(o["a"])(e.content);try{for(r.s();!(t=r.n()).done;){var a=t.value;i.tagOptions.push({value:a.name,label:a.name,hierarchy:a.hierarchy})}}catch(s){r.e(s)}finally{r.f()}i.arryList=e.content,console.log(e)})).catch((function(e){console.warn(e)}))}}},b={name:"MembershipMgmtBaseInfo",components:{BizSaveButton:l["a"],BizGrid:n["a"],BizAreaSelect:c["a"]},data:function(){var e=this;return Object(s["a"])(Object(s["a"])(Object(s["a"])({},h.data),v.data),{},{rules:{userName:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[0-9a-zA-Z]+$/,message:"用户名只能为数字或字母",trigger:"blur"},{min:4,max:20,message:"长度在4-20位",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"}],realName:[{required:!0,trigger:"blur",message:"请输入姓名"}],zipCode:[{len:6,message:"邮编位数错误",trigger:"blur"},{pattern:/^[0-9]*$/,message:"邮编格式错误",trigger:"blur"}],enableState:[{required:!0,trigger:"blur",message:"请选择是否启用"}],password:[{required:!0,trigger:"blur",min:6,max:16,message:"长度在6-16个字符"}],rePassword:[{required:!1,trigger:"blur",message:"请再次输入密码"},{trigger:"blur",validator:function(t,i,r){e.formModel.password===e.formModel.rePassword?r():r(new Error("两次输入密码不一致"))}}],userSource:[{required:!0,trigger:"blur",message:"请选择用户来源"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},v.methods),v.events),h.methods),h.events),mounted:function(){console.log(111),this.initModel()},watch:{itemId:function(e,t){this.$refs.form.$el.scrollTop=0,this.$refs.form.clearValidate(),this.activeTab=["baseInfo"],e.id?e.id!==t.id&&(this.getConsultant(),this.query()):(this.getConsultant(),this.initModel())}},computed:Object(s["a"])(Object(s["a"])({},Object(f["c"])(["getUser"])),{},{dateRange:{get:function(){return[this.formModel.beginDate,this.formModel.endDate]},set:function(e){e?(this.formModel.beginDate=e[0],this.formModel.endDate=e[1]):(this.formModel.beginDate="",this.formModel.endDate="")}}}),created:function(){this.getTagClassList(),this.queryBrandList()}},y=b,I=(i("57a5"),i("2877")),_=Object(I["a"])(y,r,a,!1,null,null,null);t["a"]=_.exports},e42c:function(e,t,i){"use strict";var r=i("2497"),a=i("bc3a"),s=i.n(a),o=i("c596");t["a"]={listOrder:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.list,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},viewOrder:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.order:o["g"].orderMgmt.orderMgmt.order,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},updateOrder:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.order:o["g"].orderMgmt.orderMgmt.order,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},createOrder:function(e,t,i){s.a.post("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.order:o["g"].orderMgmt.orderMgmt.order,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},excuteOrder:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.service:o["g"].orderMgmt.orderMgmt.service,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},closeOrder:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.close:o["g"].orderMgmt.orderMgmt.close,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},confirmOrder:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.confirm:o["g"].orderMgmt.orderMgmt.confirm,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},paymentOrder:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.payment:o["g"].orderMgmt.orderMgmt.payment,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},shippingOrder:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.shipping:o["g"].orderMgmt.orderMgmt.shipping,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},repairMaintainHistory:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.repairMaintainHistory,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},listAdminByRole:function(e,t,i){s.a.post(o["g"].orderMgmt.orderMgmt.listAdminByRole,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},listExistCardTemplate:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.listExistCardTemplate,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},viewProducts:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.viewProducts:o["g"].orderMgmt.orderMgmt.viewProducts,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},viewOrderlogs:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.viewOrderlogs:o["g"].orderMgmt.orderMgmt.viewOrderlogs,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},viewOrderRefunds:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.viewOrderRefunds:o["g"].orderMgmt.orderMgmt.viewOrderRefunds,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryInvoiceDetailByOrderID:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.queryInvoiceDetailByOrderID:o["g"].orderMgmt.orderMgmt.queryInvoiceDetailByOrderID,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceMail:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceMail:o["g"].orderMgmt.orderMgmt.invoiceMail,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceMailUpdate:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceMail:o["g"].orderMgmt.orderMgmt.invoiceMail,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceInfoDefault:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceInfoDefault:o["g"].orderMgmt.orderMgmt.invoiceInfoDefault,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceByOrder:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceByOrder:o["g"].orderMgmt.orderMgmt.invoiceByOrder,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceDetailCreate:function(e,t,i){s.a.post("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoice:o["g"].orderMgmt.orderMgmt.invoice,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceDetailUpdate:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoice:o["g"].orderMgmt.orderMgmt.invoice,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceDetail:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceDetail:o["g"].orderMgmt.orderMgmt.invoiceDetail,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},addOrderItems:function(e,t,i){s.a.post("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.addOrderItems:o["g"].orderMgmt.orderMgmt.addOrderItems,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},brands:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.brands,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},series:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.series,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},types:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.types,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},getFinancialPlans:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.getFinancialPlans,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},memberList:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.memberList,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},options:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.options,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},rescuers:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.rescuers,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},export:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.export,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},rescueOrderLogs:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.rescueOrderLogs,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},loanTerms:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.loanTerms,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryOrderKpi:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.queryOrderKpi,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},refundsAudit:function(e,t,i){s.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.refundsAudit:o["g"].orderMgmt.orderMgmt.refundsAudit,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},rescuerSetting:function(e,t,i){s.a.put(o["g"].orderMgmt.orderMgmt.rescuerSetting,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},rescuerDispath:function(e,t,i){s.a.put(o["g"].orderMgmt.orderMgmt.rescuerDispath,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},carOptions:function(e,t,i){s.a.put(o["g"].orderMgmt.orderMgmt.carOptions,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},createMember:function(e,t,i){s.a.post(o["g"].orderMgmt.orderMgmt.createMember,e).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},certificate:function(e,t,i){s.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.certificate:o["g"].orderMgmt.orderMgmt.certificate,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},listProductByTestDrive:function(e,t,i){s.a.get(o["g"].orderMgmt.orderMgmt.listProductByTestDrive,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))}}},e4c3:function(e,t,i){"use strict";var r=i("2497"),a=i("bc3a"),s=i.n(a),o=i("c596");t["a"]={queryPeople:function(e,t,i){s.a.get(o["g"].vehicleMgmt.Component_queryPeople,{params:e}).then(Object(r["a"])(t,i)).catch((function(e){console.error(e)}))},queryVehicles:function(e,t,i,a){s.a.get(e,{params:t}).then(Object(r["a"])(i,a)).catch((function(e){console.error(e)}))}}},e647:function(e,t,i){},e700:function(e,t,i){},e725:function(e,t,i){},e83a:function(e,t,i){e.exports=i.p+"static/img/pic_default_none.8bd264ad.png"},ec6b:function(e,t,i){"use strict";var r=i("b547"),a=i.n(r);a.a},efa0:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"bill-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return i("el-card",{key:t.id},[i("div",{on:{click:function(i){return e.selectItem(t)}}},[i("div",{staticClass:"top"},[i("span",[e._v(e._s(t.consignee))]),i("span",[e._v(e._s(t.phone))])]),i("div",{staticClass:"content"},[i("span",[e._v(e._s(t.areaName+t.address))])])]),i("div",{staticClass:"bottom"},["1"===t.isDefault?i("div",[e._v("默认")]):e._e(),"0"===t.isDefault?i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(i){e.$set(t,"isDefault",i)},expression:"receiver.isDefault"}},[e._v("设为默认 ")]):e._e(),i("div",{staticClass:"handler"},[i("i",{staticClass:"el-icon-edit-outline",on:{click:function(i){return e.editForm(t)}}},[e._v("编辑")]),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"省市"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},a=[],s=(i("d3b7"),i("5530")),o=i("f36f"),n=i("8330"),l=i("1ab1"),c=i("c596"),d=i("2f62"),p=i("ce2e"),u=i("f260"),m=i.n(u),f={components:{BizSaveButton:n["a"],BizAreaSelect:p["a"],BizGrid:o["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(s["a"])(Object(s["a"])({},Object(d["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+m.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(s["a"])(Object(s["a"])({},Object(d["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"].delete(c["g"].hypermarketMgmt.receiver,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].post(c["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].put(c["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.updateSelAddress(e),this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};l["a"].get(c["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},h=f,g=(i("0130"),i("2877")),v=Object(g["a"])(h,r,a,!1,null,null,null);t["a"]=v.exports},f1b1:function(e,t,i){},f3ac:function(e,t,i){e.exports=i.p+"static/img/pic_default_none_100.6603f4ac.png"},f58e:function(e,t,i){"use strict";var r=i("b755"),a=i.n(r);a.a},f604:function(e,t,i){},f606:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFGmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMTEtMTRUMTU6MDE6MjIrMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTA4LTAzVDE5OjEzOjI1KzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTA4LTAzVDE5OjEzOjI1KzA4OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmQ0NWIyMzUyLWJhMzItNDM5NS1iZTliLTgxMTVhNjk1ODBhNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpkNDViMjM1Mi1iYTMyLTQzOTUtYmU5Yi04MTE1YTY5NTgwYTUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkNDViMjM1Mi1iYTMyLTQzOTUtYmU5Yi04MTE1YTY5NTgwYTUiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ0NWIyMzUyLWJhMzItNDM5NS1iZTliLTgxMTVhNjk1ODBhNSIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xNFQxNTowMToyMiswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+kgXFvQAAApVJREFUWIXNl09IVFEYxX/vda+roT9C6EYKkqB/kiEYhLRJB6qNbVrYqhbmYMteUIySrnqLFiEOLmoRumnTpo0pBEVQIARG0cLAqNBpUzIW6L1qi3f905s7zzfDG+zAW3x8Z945zH333vM5xITykEAa6ABagEPAXtP+BXwGpoDnwLj0UXHe68QQrgMyQF9cswYDwLD0yVdsQHncrUC4yIj06S/LgPI4AfSYJwnkgJz0eb+tAeVxDphISDiMdukzWdKA8jgKfKiS+DqOSZ+P64UbavZWWbxIY8OA+eCSWvMo9BgtwCyB2WrzNrbofQMNrZVJfX2LHjpdqlsvffLCFBkrpRZoaEUPOrBYpngKxB2FaOtGvxqxMTJAv2NOuGUbQ3SNQt1J9P3jZaqb36ezcOYmum93KUqNS3C82nHkErzIViQOoMcHwRVRlLRLcLbbsarR755u1inzlKqx1NHoEAQXix0h9yK7BoC+5djre6G6rRt2Rf4DLQJoLNn+8wNxexYen4X9p2BVQ+E7orkz6C8VAqHmTlicg8LcZq1+w/khmJ+OMtDoKI8loMbargVxfRb2HIBVBU8uQ/413PgGOPCoLeBdfQkrGkbMx5r5BK6EhS/oBwejdtBytIGtSBF/K8bnLrvAQhzm+nonzF1wgZnYb04eMy5BjNopTLkEGW6nMBF5FAOIa8+gMQ0rars9HYIDM+PohxejSDVC+ijlMYAt+6WAwxcqv4yya1E7YkD6qMjrWHSNQlNXmcohTI+hx67YOvXSJ78RyRJKwHGxkZTDmXCY6qeinPQ380c4Ew5VWbxI4x8DJq22V1G8fWsiLjJgTEwCTQTDRFLIAU3hmQD+19EsZGLnhtOQEdt4vs+0f1LheP4XcCzJ/0nFX0oAAAAASUVORK5CYII="},f9a5:function(e,t,i){},fc46:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-evaluate"},[i("div",{staticClass:"evaluate-content"},[e.orderInfo&&e.reviews.length?i("div",e._l(e.orderInfo.orderItems,(function(t,r){return i("div",{key:r,staticClass:"my-evaluate-div"},[i("div",{staticClass:"order-info"},[i("div",{staticClass:"info"},[i("img",{attrs:{src:t.thumbnail?t.thumbnail:e.defaultImg},on:{error:e.errorHandle}}),i("div",{staticClass:"info-right"},[i("span",[e._v(e._s(t.name))]),i("span",[e._v("￥"+e._s(e.getAmount(t)))])])])]),e.editable&&t.product?i("div",{staticClass:"evaluate"},[i("div",{staticClass:"title",staticStyle:{"align-items":"center",float:"left"}},[i("span",{staticClass:"iconfont biz-icon-shangpin",staticStyle:{"font-size":"26px",padding:"0px 30px"}}),i("span",{staticStyle:{"padding-right":"30px","font-size":"14px"}},[e._v("商品评分")]),i("el-radio-group",{staticStyle:{height:"10px"},attrs:{horizontal:!0},model:{value:e.reviews[r].score,callback:function(t){e.$set(e.reviews[r],"score",t)},expression:"reviews[index].score"}},e._l(e.options,(function(e,t){return i("el-radio",{key:t,attrs:{label:e}})})),1)],1),i("el-input",{attrs:{type:"textarea",size:"mini",placeholder:"来分享您的使用感受吧...",maxlength:e.maxlength},model:{value:e.reviews[r].content,callback:function(t){e.$set(e.reviews[r],"content",t)},expression:"reviews[index].content"}}),i("img-uploader",{model:{value:e.reviews[r].images,callback:function(t){e.$set(e.reviews[r],"images",t)},expression:"reviews[index].images"}})],1):e._e(),!e.editable&&t.product?i("div",{staticClass:"evaluate-dis"},[i("div",{staticClass:"title",staticStyle:{"align-items":"center",float:"left"}},[i("span",{staticClass:"iconfont biz-icon-shangpin",staticStyle:{"font-size":"26px"}}),i("span",{staticStyle:{"padding-right":"30px","font-size":"14px"}},[e._v("商品评分")]),i("span",[e._v(e._s(e.reviews[r].score?e.已reviews[r].score:""))])]),i("div",{staticClass:"eva-content"},[i("p",{staticStyle:{"margin-bottom":"10px","margin-left":"20px"}},[e._v(e._s(e.reviews[r].content?e.reviews[r].content:"很遗憾，您没有留下任何评价。"))]),i("div",{staticClass:"img-group",staticStyle:{"margin-left":"20px"}},e._l(e.reviews[r].images,(function(t,a){return i("div",{key:a,staticClass:"img-eva"},[t?i("img",{attrs:{src:t},on:{click:function(t){return e.handleImagePreview(e.reviews[r].images,a)}}}):e._e()])})),0)])]):e._e()])})),0):e._e(),i("div",{staticClass:"shop-evaluate"},[i("div",{staticClass:"shop-title"},[i("img",{attrs:{src:e.iconShop}}),i("span",{staticStyle:{fontSize:"14px"}},[e._v("店铺评分")])]),i("div",{staticClass:"shop-item"},[i("span",{staticClass:"label"},[e._v("服务态度")]),i("el-rate",{staticClass:"rate",attrs:{disabled:!e.editable},model:{value:e.serValue,callback:function(t){e.serValue=t},expression:"serValue"}})],1),i("div",{staticClass:"shop-item"},[i("span",{staticClass:"label"},[e._v("服务速度")]),i("el-rate",{staticClass:"rate",attrs:{disabled:!e.editable},model:{value:e.speedValue,callback:function(t){e.speedValue=t},expression:"speedValue"}})],1),i("div",{staticClass:"shop-item"},[i("span",{staticClass:"label"},[e._v("专业技能")]),i("el-rate",{staticClass:"rate",attrs:{disabled:!e.editable},model:{value:e.proValue,callback:function(t){e.proValue=t},expression:"proValue"}})],1)])]),e.editable?i("div",{staticClass:"submit"},[i("span",{staticClass:"btn-submit",on:{click:e.submitEvaluate}},[e._v("提交评价")])]):e._e()])},a=[],s=(i("4160"),i("d81d"),i("a434"),i("a9e3"),i("b680"),i("d3b7"),i("25f0"),i("159b"),i("b85c")),o=i("5530"),n=i("2f62"),l=i("1ab1"),c=i("c596"),d=i("624d"),p=i.n(d),u=i("517a"),m=i.n(u),f=i("2119"),h=i("f606"),g=i.n(h),v={name:"my-evaluate",data:function(){return{iconShop:g.a,defaultImg:p.a,defaultFailImg:m.a,selected:"好评",options:["好评","中评","差评"],evaluateValue:"",maxlength:100,serValue:5,speedValue:5,proValue:5,reviews:[],info:null,initialIndex:0}},props:{orderId:{type:String,default:""},editable:{type:Boolean,default:function(){return!0}}},components:{ImgUploader:f["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])("Order",["orderInfo"])),Object(n["c"])(["getUser"])),watch:{orderId:function(e,t){this.getParams(),this.getOrderInfo()}},methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateOrderInfo"])),{},{showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},images:function(e){var t,i=[],r=Object(s["a"])(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;i.push(a)}}catch(o){r.e(o)}finally{r.f()}return i},handleImagePreview:function(e,t){var i=this;this.initialIndex=t;var r=[];e.map((function(e){r.push(e)}));var a={$props:{imgs:r,initialIndex:"initialIndex",loop:!1},$events:{change:function(e){i.initialIndex=e}}};this.$createImagePreview(Object(o["a"])({},a)).show()},getAmount:function(e){var t=Number(e.price)*Number(e.quantity);return t.toFixed(2)},submitEvaluate:function(){for(var e=this,t={serviceAttitude:this.serValue.toString(),serviceSpeed:this.speedValue.toString(),professional:this.proValue.toString(),methodName:"CreateProductReview",clientType:"2",shopId:this.getUser.shop.id,orderId:this.orderInfo.id,userId:this.getUser.id},i=this.orderInfo.orderItems,r=i.length,a=this.reviews,s=!1,o=0;o<r;o++){if(a[o]&&("好评"===a[o].score?(a[o].score="5",s=!0):"中评"===a[o].score?(a[o].score="3",s=!0):"差评"===a[o].score&&(a[o].score="1",s=!0)),!s&&i[o].product)return void this.$message.warning("请选择商品评分");i[o].product&&(a[o].images=this.images(a[o].images))}i.forEach((function(e,t){if(!e.product)return a.splice(t,1),!1})),s&&(t.reviews=this.reviews),l["a"].post(c["g"].hypermarketMgmt.review,t).then((function(t){e.$message.success("评价成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){}))},errorHandle:function(e){e.currentTarget.src=this.defaultFailImg},getOrderInfo:function(e){var t=this;this.open=!1;var i="";i=e||this.orderId;var r={clientType:this.clientType,methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:i};l["a"].get(c["g"].hypermarketMgmt.queryOrder,r).then((function(e){console.log("订单信息",e);var r,a,s=e.order.orderItems,o=s.length;for(t.reviews=[],a=0;a<o;a++)r={score:"",content:"",reviewOrderId:e.order.id,images:[]},s[a].product&&(r.productId=s[a].product.id),t.reviews.push(r);t.editable?t.updateOrderInfo(e.order):(t.info=e.order,t.getEvaluationInfo(i))})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){}))},getParams:function(){this.editable=!0},getEvaluationInfo:function(e){var t=this,i={clientType:this.clientType,methodName:"QueryOrderReview",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:e};l["a"].get(c["g"].hypermarketMgmt.reviews,i).then((function(e){if(console.log(e),t.serValue=parseInt(e.serviceAttitude),t.speedValue=parseInt(e.serviceSpeed),t.proValue=parseInt(e.professional),e.reviews.length!==t.reviews.length){var i={score:"",content:"",images:[]};e.reviews.unshift(i)}t.reviews=e.reviews;for(var r=t.reviews,a=r.length,s=0;s<a;s++)"5"===r[s].score?r[s].score="好评":"3"===r[s].score?r[s].score="中评":"1"===r[s].score&&(r[s].score="差评");t.updateOrderInfo(t.info)})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){}))}}),created:function(){}},b=v,y=(i("9b2e"),i("2877")),I=Object(y["a"])(b,r,a,!1,null,null,null);t["a"]=I.exports},fd29:function(e,t,i){}}]);