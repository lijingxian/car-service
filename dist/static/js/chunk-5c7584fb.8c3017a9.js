(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c7584fb"],{"0943":function(t,e,a){"use strict";var i=a("1fac"),r=a.n(i);r.a},1148:function(t,e,a){"use strict";var i=a("a691"),r=a("1d80");t.exports="".repeat||function(t){var e=String(r(this)),a="",n=i(t);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(a+=e);return a}},"1fac":function(t,e,a){},"225d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.tableShow,expression:"tableShow"}],ref:"template"},[t._t("default",[a("span",[t._v("编写你自己的打印区域组件，然后slot插入到vue-easy-print")])],{getChineseNumber:t.getChineseNumber})],2),t.buttonShow?a("button",{class:t.buttonClass,attrs:{type:"button"},on:{click:t.print}},[a("span",[t._v("开始打印")])]):t._e()])},r=[],n=(a("a9e3"),a("d3b7"),a("ac1f"),a("25f0"),a("466d"),a("5319"),a("1276"),{name:"vue-easy-print",components:{},props:{spaceRow:{type:Boolean,default:!1},tableData:{type:Object,default:function(){}},tableShow:{type:Boolean,default:!1},buttonShow:{type:Boolean,default:!1},buttonClass:{type:String,default:"el-button el-button--default"},onePageRow:{type:Number,default:5},beforeCopy:Function,beforePrint:Function},data:function(){return{}},mounted:function(){this.init()},methods:{init:function(){var t=this,e=document.getElementById("easyPrintIframe");e?this.getStyle():(e=document.createElement("iframe"),e.id="easyPrintIframe",e.style.position="fixed",e.style.width="0",e.style.height="0",e.style.top="-100px",window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)&&(e.src='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";<\/script></head><body></body>")'),e.onload=function(){t.getStyle()},document.body.appendChild(e))},print:function(){"function"===typeof this.beforeCopy&&this.beforeCopy();var t=document.getElementById("easyPrintIframe");t.contentDocument.body.innerHTML=this.$refs.template.innerHTML,"function"===typeof this.beforePrint&&this.beforePrint(),setTimeout((function(){t.contentWindow.print()}),100)},getStyle:function(){for(var t=document.getElementById("easyPrintIframe"),e="",a=document.querySelectorAll("style"),i=0;i<a.length;i++)e+=a[i].outerHTML;t.contentDocument.head.innerHTML=e;for(var r=document.querySelectorAll("link"),n=0;n<r.length;n++){var s=document.createElement("link");s.setAttribute("rel","stylesheet"),r[n].type?s.setAttribute("type",r[n].type):s.setAttribute("type","text/css"),s.setAttribute("href",r[n].href),s.setAttribute("media","all"),t.contentDocument.head.appendChild(s)}},getChineseNumber:function(t){var e,a,i,r,n,s,o,l,c,u,d,p,f,m,g=99999999999.99,h="零",b="壹",v="贰",y="叁",w="肆",S="伍",_="陆",C="柒",I="捌",D="玖",N="拾",R="佰",k="仟",F="万",L="亿",O="",x="元",P="角",z="分",$="整";if(void 0===t)return"";if(t=t.toString(),""==t)return"";if(null!=t.match(/[^,.\d]/))return"";if(null==t.match(/^((\d{1,3}(,\d{3})*(.((\d{3},)*\d{1,3}))?)|(\d+(.\d+)?))$/))return"";if(t=t.replace(/,/g,""),t=t.replace(/^0+/,""),Number(t)>g)return alert("您输入的金额太大，请重新输入!"),"";if(r=t.split("."),r.length>1?(e=r[0],a=r[1],a=a.substr(0,2)):(e=r[0],a=""),n=new Array(h,b,v,y,w,S,_,C,I,D),s=new Array("",N,R,k),o=new Array("",F,L),l=new Array(P,z),i="",Number(e)>0){for(c=0,u=0;u<e.length;u++)d=e.length-u-1,p=e.substr(u,1),f=d/4,m=d%4,"0"==p?c++:(c>0&&(i+=n[0]),c=0,i+=n[Number(p)]+s[m]),0==m&&c<4&&(i+=o[f]);i+=x}if(""!=a)for(u=0;u<a.length;u++)p=a.substr(u,1),"0"!=p&&(i+=n[Number(p)]+l[u]);return""==i&&(i=h+x),""==a&&(i+=$),i=O+i,i}}}),s=n,o=a("2877"),l=Object(o["a"])(s,i,r,!1,null,null,null),c=l.exports;e["a"]=c},"24e9a":function(t,e,a){},"2f30":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"purchase-return-order-mgmt"},[a("biz-flex-table",{ref:"table",staticClass:"purchase-return-order-mgmt-tabel",attrs:{operations:t.operations,filters:t.filters,tableData:t.tableData,loading:t.loading,pagination:t.pagination},on:{operate:t.operate,"filter-data-change":t.filterDataChange,"selection-change":t.handleSelectionChange,"row-click":t.rowClick,"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},[a("el-table-column",{attrs:{label:"编号",prop:"sn","min-width":"125"}}),a("el-table-column",{attrs:{label:"商品信息",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticStyle:{width:"100%","margin-right":"30px"}},t._l(e.row.itemDatas,(function(e){return a("div",{key:e.id,staticClass:"product-info"},[a("div",{staticClass:"wrapper"},[a("div",{staticClass:"titleClass",attrs:{title:e.productName}},[t._v(t._s(e.productName))])]),a("div",{staticClass:"info-bottom"},[a("div",[t._v(" *"+t._s(e.amount))])])])})),0)])]}}])}),a("el-table-column",{attrs:{label:"供应商信息",prop:"relatePartnerName"}}),a("el-table-column",{attrs:{label:"单据总金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(e.row.totalFee))]}}])}),a("el-table-column",{attrs:{prop:"purchaserName",label:"采购"}}),a("el-table-column",{attrs:{prop:"state",label:"订单状态",formatter:t.getState}}),a("el-table-column",{attrs:{prop:"settleState",label:"结算状态",formatter:t.getSettleState}}),a("el-table-column",{attrs:{prop:"depotState",label:"出库状态",formatter:t.getDepotState}}),a("el-table-column",{attrs:{prop:"date",label:"操作",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",{staticClass:"biz-customcol"},["0"===e.row.state||"1"===e.row.state?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.statusChange(e.row,"1")}}},[t._v("作废")]):t._e(),"0"===e.row.state?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.statusChange(e.row,"0")}}},[t._v("确认")]):t._e(),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.printReturnOrder(e.row)}}},[t._v("打印")])],1)])}}])})],1),a("biz-popup-tabs",{attrs:{open:t.open},on:{close:function(e){t.open=!1}},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[a("base-info",{ref:"baseInfo",attrs:{itemId:t.itemId,isEdit:t.isEdit},on:{operationSuccess:t.operationSuccess}})],1),a("el-tab-pane",{attrs:{label:"商品信息",name:"productinfo"}},[a("product-info",{ref:"productinfo",attrs:{itemId:t.itemId,isEdit:t.isEdit},on:{setReturnOrderItems:t.setReturnOrderItems,operationSuccess:t.operationSuccess}})],1),a("el-tab-pane",{attrs:{label:"关联单据",name:"returnOrderinfo"}},[a("order-info",{ref:"orderinfo",attrs:{itemId:t.itemId,isEdit:t.isEdit},on:{operationSuccess:t.operationSuccess}})],1)],1),a("el-dialog",{attrs:{visible:t.dialogTableVisible,center:"",width:"800px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.print}},[t._v("打印")])],1)])],1),a("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[a("div",{staticClass:"d-p-wrap"},[a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("div",{staticClass:"p-title"},[t._v(t._s(t.title))])]),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[t._v("打印日期："+t._s(t.formatDate((new Date).getTime())))])])],1),a("el-row",{staticClass:"row-top",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("编号："+t._s(t.form.sn))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("创建时间："+t._s(t.form.createDate))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("供应商："+t._s(t.form.relatePartnerName))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("优惠率(%)："+t._s(t.form.discountRate))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("优惠金额(元)："+t._s(t.form.discontFee))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("总金额(元)："+t._s(t.form.totalFee))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("申请人："+t._s(t.form.applierName))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("状态："+t._s(t.form.state))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("采购："+t._s(t.form.purchaserName))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("备注："+t._s(t.form.remark))])])],1),a("el-table",{staticClass:"table-class",attrs:{data:t.gridData}},[a("el-table-column",{attrs:{property:"productName",label:"商品"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.productName))]}}])}),a("el-table-column",{attrs:{property:"price",label:"退货单价(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(e.row.price))]}}])}),a("el-table-column",{attrs:{property:"amount",label:"退货数量"}}),a("el-table-column",{attrs:{property:"totalFee",label:"金额(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(e.row.totalFee))]}}])}),a("el-table-column",{attrs:{property:"depotName",label:"仓库"}})],1)],1)])],1)],1)},r=[],n=(a("99af"),a("d81d"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("3ca3"),a("466d"),a("1276"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),s=a("5530"),o=a("7132"),l=a("04d3"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"apply-base-info"},[t.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}):t._e(),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px",size:"small",disabled:!t.isEdit,"inline-message":!0}},[t.itemId?a("el-form-item",{attrs:{label:"编号",prop:"sn"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.form.sn,callback:function(e){t.$set(t.form,"sn",e)},expression:"form.sn"}})],1):t._e(),a("el-form-item",{staticClass:"isRequired",attrs:{label:"供应商",prop:"relatePartnerName"}},[a("el-input",{attrs:{placeholder:"请选择供应商",disabled:!0},model:{value:t.form.relatePartnerName,callback:function(e){t.$set(t.form,"relatePartnerName",e)},expression:"form.relatePartnerName"}})],1),a("el-form-item",{attrs:{label:"优惠率(%)",prop:"discountRate"}},[a("el-input",{on:{change:t.rateChange},model:{value:t.form.discountRate,callback:function(e){t.$set(t.form,"discountRate",e)},expression:"form.discountRate"}})],1),a("el-form-item",{attrs:{label:"优惠金额(元)",prop:"discontFee"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.form.discontFee,callback:function(e){t.$set(t.form,"discontFee",e)},expression:"form.discontFee"}})],1),a("el-form-item",{attrs:{label:"总金额(元)",prop:"totalFee"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.form.totalFee,callback:function(e){t.$set(t.form,"totalFee",e)},expression:"form.totalFee"}})],1),a("el-form-item",{attrs:{label:"申请人",prop:"applierName"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.form.applierName,callback:function(e){t.$set(t.form,"applierName",e)},expression:"form.applierName"}})],1),a("el-form-item",{attrs:{label:"采购",prop:"purchaserId"}},[a("el-select",{attrs:{placeholder:"请选择采购"},model:{value:t.form.purchaserId,callback:function(e){t.$set(t.form,"purchaserId",e)},expression:"form.purchaserId"}},t._l(t.purchaseList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"订单状态",prop:"state"}},[a("el-input",{attrs:{value:t.stateFormatter,disabled:!0}})],1),a("el-form-item",{attrs:{label:"入库状态",prop:"depotState"}},[a("el-input",{attrs:{value:t.depotStateFormatter,disabled:!0}})],1),a("el-form-item",{attrs:{label:"结算状态",prop:"settleState"}},[a("el-input",{attrs:{value:t.settleStateFormatter,disabled:!0}})],1),a("el-form-item",{attrs:{label:"创建时间",prop:"createDate"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.form.createDate,callback:function(e){t.$set(t.form,"createDate",e)},expression:"form.createDate"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)],1)},u=[],d=a("b85c"),p=a("f36f"),f=a("8330"),m=a("2f62"),g=a("1ab1"),h=a("c596"),b=function(){return{relatePartnerId:"",relatePartnerName:"",relatePartnerType:"",totalFee:"",billType:"",sn:"",applierId:"",applierName:"",relateBill:"",relateBillType:"",discountRate:"0",discontFee:"",settleState:"",depotState:"",state:"",id:"",createDate:"",shopId:"",shop:{},purchaserId:"",purchaserName:""}},v={name:"baseInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},components:{BizGrid:p["a"],BizSaveButton:f["a"]},data:function(){var t=this,e=function(e,a,i){""===t.form.discountRate&&i(new Error("请输入优惠率")),Number(t.form.discountRate)>=0&&Number(t.form.discountRate)<=100?i():i(new Error("优惠率必须为0~100的数字值"))};return{loading:!1,form:b(),totalFee:0,itemDatas:[],purchaseList:[],operations:[{label:"保存",name:"save",type:"primary"}],dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入供应商名称",name:"searchValue",value:""}],rules:{discountRate:[{required:!0,trigger:"blur",validator:e}],purchaserId:[{required:!0,message:"请选择采购",trigger:"blur"}]}}},computed:{stateFormatter:function(){switch(this.form.state){case"0":return"已提交";case"1":return"已确认";case"2":return"处理中";case"3":return"已完成";case"4":return"已作废";default:return"--"}},depotStateFormatter:function(){switch(this.form.depotState){case"0":return"未完成";case"1":return"部分完成";case"2":return"已完成";default:return"--"}},settleStateFormatter:function(){switch(this.form.settleState){case"0":return"未结清";case"1":return"部分结清";case"2":return"已结清";default:return"--"}}},created:function(){this.queryRoleList()},watch:{itemId:function(t){this.form=this.getDefaultModel(),this.totalFee="",this.queryPurchase()}},methods:Object(s["a"])(Object(s["a"])({},Object(m["c"])(["getUser"])),{},{operate:function(t){this[t]()},initModel:function(t){t?(this.form=Object.assign(this.getDefaultModel(),t),this.totalFee=Number(t.totalFee)+Number(t.discontFee)):this.resetModel(),this.$refs.form.resetFields()},resetModel:function(){this.form=this.getDefaultModel()},rateChange:function(t){this.form.discontFee=this.totalFee*(Number(t)/100),this.form.totalFee=this.totalFee-Number(this.form.discontFee)},queryPurchase:function(){var t=this;this.loading=!0,g["a"].get(h["g"].invoicing.purchaseReturnOrderMgmt.shopPurchaseReturnOrder,{shopId:window.top.SHOP_ID||"",id:this.itemId}).then((function(e){t.loading=!1,e.data.purchaserName=t.form.purchaserName,t.initModel(e.data)})).catch((function(e){t.loading=!1,console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},queryRoleList:function(){var t=this;g["a"].post("/admin/common/roleAdmins.jhtml",{roleTypes:["21","22"]}).then((function(e){var a,i=Object(d["a"])(e.dataList);try{for(i.s();!(a=i.n()).done;){var r=a.value;t.form.purchaserId=r.id,t.form.purchaserName=r.name,t.purchaseList.push({name:t.form.purchaserName,id:t.form.purchaserId})}}catch(n){i.e(n)}finally{i.f()}})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)}))},getDefaultModel:function(){return b()},getSaveParams:function(){return{id:this.form.id,relatePartnerId:this.form.relatePartnerId,totalFee:this.form.totalFee,purchaserId:this.form.purchaserId,purchaserName:this.form.purchaserName,discountRate:this.form.discountRate,discontFee:this.form.discontFee,remark:this.form.remark,shopId:window.top.SHOP_ID||""}},save:function(){var t=this;this.$refs.form.validate((function(e,a){if(!e)return!1;t.loading=!0;var i=function(e){t.$message.success("保存成功"),t.$emit("operationSuccess")},r=function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)},n=function(e){t.loading=!1};g["a"].put(h["g"].invoicing.purchaseReturnOrderMgmt.shopPurchaseReturnOrder,t.getSaveParams()).then(i).catch(r).finally(n)}))},setReturnOrderItems:function(t){this.itemDatas=t;var e=0;t.map((function(t){e+=Number(t.amount)*Number(t.price)})),this.totalFee=e,this.form.discontFee=e*this.form.discountRate,this.form.totalFee=e-this.form.discontFee}})},y=v,w=(a("6178"),a("2877")),S=Object(w["a"])(y,c,u,!1,null,null,null),_=S.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"product-info"},[t.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}):t._e(),a("el-form",{attrs:{inline:!0}},[a("el-form-item",{staticClass:"subTotal",attrs:{label:"合计:",prop:"totalFee"}},[t._v("￥"+t._s(t.totalFee?t.totalFee:"0"))])],1),a("biz-list",{key:Math.random(),ref:"table",attrs:{tableData:t.tableData,height:"100%",loading:t.loading}},[a("el-table-column",{attrs:{prop:"productName",label:"商品名称","min-width":"100"}}),a("el-table-column",{attrs:{prop:"price",label:"退货单价(元)","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",{staticClass:"biz-customcol"},[a("el-input",{attrs:{size:"small",disabled:!t.isEdit},on:{change:function(a){return t.priceChange(e.row.price)}},model:{value:e.row.price,callback:function(a){t.$set(e.row,"price",a)},expression:"scope.row.price"}})],1)])}}])}),a("el-table-column",{attrs:{prop:"amount",label:"退货数量","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",{staticClass:"biz-customcol"},[a("el-input-number",{staticStyle:{width:"90px"},attrs:{size:"mini",min:1,disabled:!t.isEdit},on:{change:function(a){return t.amountChange(e.row.amount)}},model:{value:e.row.amount,callback:function(a){t.$set(e.row,"amount",a)},expression:"scope.row.amount"}})],1)])}}])}),a("el-table-column",{attrs:{prop:"totalFee",label:"金额(元)","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",{staticClass:"biz-customcol"},[t._v(t._s(e.row.amount?(Number(e.row.amount)*Number(e.row.price)).toFixed(2):""))])])}}])}),a("el-table-column",{attrs:{prop:"depotId",label:"仓库","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{placeholder:"请选择类型",size:"mini",disabled:!t.isEdit},model:{value:e.row.depotId,callback:function(a){t.$set(e.row,"depotId",a)},expression:"scope.row.depotId"}},t._l(t.storeList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)]}}])}),t.isEdit?a("el-table-column",{attrs:{prop:"date",label:"操作",type:"index","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",{staticClass:"biz-customcol"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.deleteHandeler(e)}}},[t._v("删除")])],1)])}}],null,!1,2138999389)}):t._e()],1),a("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"选择商品",visibility:t.showDialog,tableData:t.giftList,pagination:t.dialogPagination,filters:t.dialogFilters,selectionKeys:t.selectedGiftIds},on:{"update:visibility":function(e){t.showDialog=e},pageSizeChange:t.dialogPageSizeChange,currentPageChange:t.dialogCurrentPageChange,confirmed:t.confirmedProduct,filterDataChange:t.dialogFilterDataChange,selectionChange:t.selectionChange}},[a("el-table-column",{attrs:{property:"fullName",label:"商品名称",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"dialog-column"},[a("img",{staticClass:"productImg",attrs:{src:e.row.image||t.DefaultImg}}),a("div",{staticStyle:{width:"120px"}},[t._v(t._s(e.row.fullName))])])]}}])}),a("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),a("el-table-column",{attrs:{label:"库存"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{width:"120px"}},[t._v(t._s(e.row.realStock))])]}}])})],1)],1)},I=[],D=(a("4160"),a("c975"),a("a434"),a("b680"),a("25f0"),a("159b"),a("7558")),N=a("af3f"),R=a("f3ac"),k=a.n(R),F={name:"ProductInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},selectedGiftList:[],selectedGiftIds:[],showDialog:!1,DefaultImg:k.a,dialogFilters:[{type:"input",placeholder:"请输入编号或商品名",name:"searchbar",value:""}],giftList:[],loading:!1,open:!1,totalFee:"",height:"585",tableData:[],restaurants:[],selections:[],itemDatas:[],dialogTableVisible:!1,storeList:[],selectionList:[],title:"",operations:[{label:"新增商品",name:"addProduct",type:"primary",disabled:!1},{label:"保存",name:"save",type:"primary",disabled:!1}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:D["a"],BizGrid:p["a"],BizSaveButton:f["a"],BizDialogSelector:N["a"]},watch:{itemId:function(t){this.tableData=[],this.totalFee="",this.storeList=[],this.itemId&&this.getList(),this.queryStoreHouseList()}},mounted:function(){var t=document.documentElement.clientHeight||window.innerHeight;this.height=String(t-175)},methods:Object(s["a"])(Object(s["a"])({},Object(m["c"])(["getUser"])),{},{addProduct:function(){this.getGiftList(),this.selectedGiftIds.splice(0,this.selectedGiftIds.length),this.selectedGiftList.splice(0,this.selectedGiftList.length),this.showDialog=!0},dialogPageSizeChange:function(t){this.dialogPagination.pageSize=t,this.getGiftList()},dialogCurrentPageChange:function(t){this.dialogPagination.currentPage=t,this.getGiftList()},dialogFilterDataChange:function(t){this.dialogFilters=t,this.dialogPagination.currentPage=1,this.getGiftList()},getGiftList:function(){var t=this,e={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||""};g["a"].get(h["g"].commodity.getCommodityList,e).then((function(e){t.giftList=e.content,t.dialogPagination.total=Number(e.total)})).catch((function(t){t.errorMessage&&console.log(t.errorMessage)}))},selectionChange:function(t){var e=this;t.forEach((function(t){-1===e.selectionList.indexOf(t)&&e.selectionList.push(t)}))},confirmedProduct:function(t){var e=this;this.selectedGiftIds=t.concat(),this.selectedGiftList=[],this.selectionList.map((function(t){-1!==e.selectedGiftIds.indexOf(t.id)&&(t.amount="1",t.productName=t.fullName,e.selectedGiftList.push(t))}));this.selectedGiftList.map((function(t){Number(t.amount)*Number(t.price)})),this.selectedGiftList.forEach((function(t){e.handleSelect(t),e.listProduct(t)})),this.storeList=[],this.queryStoreHouseList()},operate:function(t){this[t]()},refresh:function(){this.flag=!0,this.getList()},operationSuccess:function(){this.getList()},getList:function(){var t=this;this.loading=!0;var e={id:this.itemId,shopId:window.top.SHOP_ID||""};g["a"].get(h["g"].invoicing.purchaseReturnOrderMgmt.shopPurchaseReturnOrderItems,e).then((function(e){t.tableData=e.itemList,t.totalFee=e.data.totalFee})).catch((function(t){t.errorMessage&&console.log(t.errorMessage)}))},queryStoreHouseList:function(){var t=this;this.loading=!0;var e={shopId:window.top.SHOP_ID||""};g["a"].get(h["g"].invoicing.storeHouseMgmt.shopDepotList,e).then((function(e){var a,i=Object(d["a"])(e.dataList);try{for(i.s();!(a=i.n()).done;){var r=a.value;"1"===r.enabled&&t.storeList.push(r)}}catch(n){i.e(n)}finally{i.f()}})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},handleSelect:function(t){var e=!1;if(t.productId=t.id,t.id="",this.totalFee=(Number(this.totalFee)+Number(t.amount)*Number(t.price)).toFixed(2),0!==this.tableData.length){for(var a=0;a<this.tableData.length;a++)if(this.tableData[a].productId===t.productId){this.tableData[a].amount=(Number(this.tableData[a].amount)+1).toString(),e=!0;break}e||this.tableData.push(t)}else this.tableData.push(t)},deleteHandeler:function(t){var e=this;""===t.row.id?this.tableData.splice(t.$index,1):this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,g["a"].delete(h["g"].invoicing.purchaseReturnOrderMgmt.shopPurchaseReturnOrderItem,{ids:[t.row.id]}).then((function(t){e.$message.success("删除成功"),e.getList()})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))})),this.totalFee=(Number(this.totalFee)-Number(t.row.price)*Number(t.row.amount)).toFixed(2)},save:function(){var t=this;this.itemDatas=this.tableData.map((function(e){return{id:e.id||"",billId:t.itemId,productId:e.productId?e.productId:e.id,amount:e.amount||"",price:e.price||"",depotId:e.depotId||"",productName:e.fullName,specId:e.specId||"",specValue:e.specValue||"",totalFee:e.amount*e.price||""}}));var e=!1;if(this.tableData.forEach((function(t){console.log(t.amount),-1!==String(t.amount).indexOf(".")&&(e=!0)})),e)return this.$message.warning("数量不能为小数"),!1;var a={itemDatas:this.itemDatas};g["a"].post(h["g"].invoicing.purchaseReturnOrderMgmt.shopPurchaseReturnOrderItem,a).then((function(e){t.$message.success("保存成功"),t.$emit("setReturnOrderItems",t.itemDatas),t.$emit("operationSuccess"),t.getList(),t.loading=!1})).catch((function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},amountChange:function(t){var e=0;this.tableData.map((function(t){e+=Number(t.amount)*Number(t.price)})),this.totalFee=e?e.toFixed(2):""},priceChange:function(t){var e=0;this.tableData.map((function(t){e+=Number(t.amount)*Number(t.price)})),this.totalFee=e?e.toFixed(2):""},handleSizeChange:function(t){this.pagination.pageSize=t,this.refresh()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.refresh()}})},L=F,O=(a("949e"),Object(w["a"])(L,C,I,!1,null,null,null)),x=O.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"purchase-order-info"},[a("el-form",{attrs:{"label-width":"110px",size:"small","inline-message":!0}},[a("el-form-item",{attrs:{label:"采购退货申请单"}},t._l(t.applyLists,(function(e){return a("span",{key:e.id,staticClass:"tel-style",attrs:{label:e.sn,value:e.id},on:{click:function(a){return t.onClickApplyList(e)}}},[t._v(t._s(e.sn))])})),0),a("el-form-item",{attrs:{label:"出库单"}},t._l(t.depotBillLists,(function(e){return a("span",{key:e.id,staticClass:"tel-style",attrs:{label:e.sn,value:e.id},on:{click:function(a){return t.onClickStorageList(e)}}},[t._v(t._s(e.sn))])})),0),a("el-form-item",{attrs:{label:"收款单"}},t._l(t.accountBillLists,(function(e){return a("span",{key:e.id,staticClass:"tel-style",attrs:{label:e.sn,value:e.id},on:{click:function(a){return t.onClickReceiptList(e)}}},[t._v(t._s(e.sn))])})),0)],1),a("el-dialog",{attrs:{visible:t.dialogApplyTableVisible,center:"",width:"800px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(e){t.dialogApplyTableVisible=e}}},[a("div",{staticClass:"d-p-wrap"},[a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("div",{staticClass:"p-title"},[t._v("采购退货申请单")])]),a("el-row",{staticClass:"row-top",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("编号："+t._s(t.form.sn))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("创建时间："+t._s(t.form.createDate))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("供应商："+t._s(t.form.relatePartnerName))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("优惠率(%)："+t._s(t.form.discountRate))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("优惠金额(元)："+t._s(t.form.discontFee))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("总金额(元)："+t._s(t.form.totalFee))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("申请人："+t._s(t.form.applierName))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("状态："+t._s(t.form.state))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("备注："+t._s(t.form.remark))])])],1),a("el-table",{staticClass:"table-class",attrs:{data:t.gridApplyData}},[a("el-table-column",{attrs:{property:"productName",label:"商品"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.productName))]}}])}),a("el-table-column",{attrs:{property:"price",label:"采购单价(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(e.row.price))]}}])}),a("el-table-column",{attrs:{property:"amount",label:"退货数量"}}),a("el-table-column",{attrs:{property:"totalFee",label:"金额(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(e.row.totalFee))]}}])}),a("el-table-column",{attrs:{property:"depotName",label:"仓库"}})],1)],1)]),a("el-dialog",{attrs:{visible:t.dialogStorageTableVisible,center:"",width:"800px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(e){t.dialogStorageTableVisible=e}}},[a("div",{staticClass:"d-p-wrap"},[a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("div",{staticClass:"p-title"},[t._v("出库单")])]),a("el-row",{staticClass:"row-top",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("编号："+t._s(t.formDepotOut.sn))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("创建时间："+t._s(t.formDepotOut.createDate))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("供应商："+t._s(t.formDepotOut.relatePartnerName))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("创建人："+t._s(t.formDepotOut.creatorName))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("状态："+t._s(t.formDepotOut.state))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("备注："+t._s(t.formDepotOut.remark))])])],1),a("el-table",{staticClass:"table-class",attrs:{data:t.gridStorageData}},[a("el-table-column",{attrs:{property:"productName",label:"商品","min-width":"200"}}),a("el-table-column",{attrs:{property:"amount",label:"出库数量"}}),a("el-table-column",{attrs:{property:"depotName",label:"仓库"}})],1)],1)]),a("el-dialog",{attrs:{visible:t.dialogReceiptTableVisible,center:"",width:"800px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(e){t.dialogReceiptTableVisible=e}}},[a("div",{staticClass:"d-p-wrap"},[a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("div",{staticClass:"p-title"},[t._v("收款单")])]),a("el-row",{staticClass:"row-top",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("编号："+t._s(t.formReceipt.sn))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("创建时间："+t._s(t.formReceipt.createDate))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("往来方："+t._s(t.formReceipt.relateUnit))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("结算账户："+t._s(t.formReceipt.account))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("付款金额(元)："+t._s(t.formReceipt.amount))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("付款人："+t._s(t.formReceipt.creator))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("状态："+t._s(t.formReceipt.state))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("备注："+t._s(t.formReceipt.remarks))])])],1)],1)])],1)},z=[],$={name:"OrderInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},components:{BizGrid:p["a"]},data:function(){return{loading:!1,dialogVisible:!1,applyLists:[],depotBillLists:[],accountBillLists:[],form:{},formDepotOut:{},formReceipt:{},gridApplyData:[],gridStorageData:[],dialogApplyTableVisible:!1,dialogStorageTableVisible:!1,dialogReceiptTableVisible:!1}},created:function(){},watch:{itemId:function(t){this.applyLists=[],this.depotBillLists=[],this.accountBillLists=[],this.itemId&&this.getList()}},mounted:function(){},methods:{getList:function(){var t=this;g["a"].get(h["g"].invoicing.purchaseReturnOrderMgmt.relateBill,{id:this.itemId||"",shopId:window.top.SHOP_ID||""}).then((function(e){t.applyLists=e.applyList,t.depotBillLists=e.depotBillList,t.accountBillLists=e.accountBillList})).catch((function(t){console.log(t),console.log("code错误")}))},queryApplyList:function(t){var e=this,a={id:t};g["a"].get(h["g"].invoicing.purchaseReturnApplyMgmt.print,a).then((function(t){e.dialogApplyTableVisible=!0,e.title="采购退货申请单",e.form=t.data,"0"===e.form.state?e.form.state="已创建":"1"===e.form.state?e.form.state="已提交":"2"===e.form.state?e.form.state="审核中":"3"===e.form.state?e.form.state="已通过":"4"===e.form.state&&(e.form.state="已驳回"),e.gridApplyData=t.data.itemDatas,e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},queryStorageList:function(t){var e=this,a={id:t};g["a"].get(h["g"].invoicing.depotOutMgmt.print,a).then((function(t){e.dialogStorageTableVisible=!0,e.title="出库单",e.formDepotOut=t.data,"0"===e.formDepotOut.state?e.formDepotOut.state="已创建":"1"===e.formDepotOut.state&&(e.formDepotOut.state="已提交"),e.gridStorageData=t.data.itemDatas,e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},queryReceiptList:function(t){var e=this,a={id:t};g["a"].get(h["g"].finance.receiptMgmt.receipt,a).then((function(a){e.dialogReceiptTableVisible=!0,e.title="收款单",t===a.data.id&&(e.formReceipt.sn=a.data.sn,e.formReceipt.createDate=a.data.createDate,e.formReceipt.relateUnit=a.data.relateUnit.name,e.formReceipt.account=a.data.account.name,e.formReceipt.amount=a.data.amount,e.formReceipt.state=a.data.state,e.formReceipt.creator=a.data.creator,"0"===e.formReceipt.state?e.formReceipt.state="已创建":"1"===e.formReceipt.state&&(e.formReceipt.state="已提交"),e.formReceipt.remarks=a.data.remarks),e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},onClickApplyList:function(t){this.form={},this.gridApplyData=[],this.queryApplyList(t.id)},onClickStorageList:function(t){this.formDepotOut={},this.gridStorageData=[],this.queryStorageList(t.id)},onClickReceiptList:function(t){this.formReceipt={},this.queryReceiptList(t.id)}}},E=$,T=(a("7633"),Object(w["a"])(E,P,z,!1,null,null,null)),M=T.exports,B=a("225d"),A=a("bc3a"),V=a.n(A),j={name:"ReturnOrderMgmtList",data:function(){return{tabName:"info",itemId:"",userId:"",title:"",isEdit:!0,form:{},loading:!1,open:!1,dialogTableVisible:!1,selections:[],operations:[{label:"刷新",name:"refresh",type:""},{label:"导出",name:"export",type:""}],filters:[{type:"select",label:"供应商",name:"supplier",value:"",options:[]},{type:"select",label:"采购",name:"people",value:"",options:[]},{type:"select",label:"订单状态",name:"state",value:"",options:[]},{type:"select",label:"结算状态",name:"state",value:"",options:[]},{type:"select",label:"出库状态",name:"state",value:"",options:[]},{type:"daterange",label:"创建日期",name:"publishDate",value:[]},{type:"input",label:"",placeholder:"请输入采购订单编号",name:"searchValue",value:""}],tableData:[],gridData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9}}},components:{BizPopupTabs:o["a"],BizFlexTable:l["c"],BaseInfo:_,vueEasyPrint:B["a"],ProductInfo:x,OrderInfo:M},created:function(){this.getList(),this.queryFilters()},watch:{},computed:{},mounted:function(){},methods:Object(s["a"])(Object(s["a"])({},Object(m["c"])(["getUser"])),{},{operate:function(t){this[t]()},refresh:function(){this.getList()},operationSuccess:function(t){t&&(this.itemId=String(t)),this.refresh()},statusChange:function(t,e){var a=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={shopId:window.top.SHOP_ID||"",id:t.id,actionType:e};""===t.purchaserName||void 0===t.purchaserName?a.$message.warning("请选择采购人员"):g["a"].get(h["g"].invoicing.purchaseReturnOrderMgmt.state,i).then((function(t){a.$message.success("操作成功！"),a.refresh()})).catch((function(t){t.errorMessage&&a.$message.warning(t.errorMessage)})).finally((function(){}))}))},formatDate:function(t){var e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1,r=e.getDate(),n=a+"-"+(i<10?"0"+i:i)+"-"+(r<10?"0"+r:r);return n},printReturnOrder:function(t){var e=this,a={id:t.id};g["a"].get(h["g"].invoicing.purchaseReturnOrderMgmt.print,a).then((function(t){e.dialogTableVisible=!0,e.title="采购退货订单",e.form=t.data,"0"===e.form.state?e.form.state="已提交":"1"===e.form.state?e.form.state="已确认":"2"===e.form.state?e.form.state="处理中":"3"===e.form.state?e.form.state="已完成":"4"===e.form.state?e.form.state="已作废":e.form.state="",e.gridData=t.data.itemDatas,e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t)})).finally((function(t){e.loading=!1}))},print:function(){this.$refs.easyPrint.print()},export:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,i,r,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={pageSize:t.pagination.pageSize,pageNumber:t.pagination.currentPage,shopId:window.top.SHOP_ID||"",searchValue:t.filters[6].value,supplierId:t.filters[0].value,purchaserId:t.filters[1].value,orderState:t.filters[2].value,settleState:t.filters[3].value,depotState:t.filters[4].value,beginTime:t.filters[5].value[0]?t.filters[5].value[0]+" 00:00:00":"",endTime:t.filters[5].value[1]?t.filters[5].value[1]+" 23:59:59":""},e.prev=1,e.next=4,V.a.post("/admin/order/export.jhtml",a,{responseType:"blob"});case 4:return i=e.sent,console.log("response => ",i),r=new Blob([i.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(i.headers["content-disposition"])),n=decodeURI(i.headers["content-disposition"].split("filename=")[1]),s=document.createElement("a"),s.download=n.match(/"(\S*)"/)[1],s.style.display="none",s.href=URL.createObjectURL(r),document.body.appendChild(s),s.click(),URL.revokeObjectURL(s.href),document.body.removeChild(s),e.abrupt("return");case 20:throw e.prev=20,e.t0=e["catch"](1),new Error(e.t0);case 23:case"end":return e.stop()}}),e,null,[[1,20]])})))()},rowClick:function(t,e,a){this.tabName="info",this.open=!0,this.itemId=t.id,"0"===t.state?this.isEdit=!0:this.isEdit=!1},getList:function(){var t=this,e={pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,shopId:window.top.SHOP_ID||"",searchValue:this.filters[6].value,supplierId:this.filters[0].value,purchaserId:this.filters[1].value,orderState:this.filters[2].value,settleState:this.filters[3].value,depotState:this.filters[4].value,beginTime:this.filters[5].value[0]?this.filters[5].value[0]+" 00:00:00":"",endTime:this.filters[5].value[1]?this.filters[5].value[1]+" 23:59:59":""};this.loading=!0,g["a"].get(h["g"].invoicing.purchaseReturnOrderMgmt.shopPurchaseReturnOrderList,e).then((function(e){console.log(e),t.tableData=e.dataList,t.pagination.total=Number(e.total)})).catch((function(e){t.$message.warning(e.errorMessage),console.log("ERR_REFRESH: ",e)})).finally((function(e){t.loading=!1}))},queryFilters:function(){var t=this,e={shopId:window.top.SHOP_ID||""};g["a"].get(h["g"].invoicing.purchaseReturnOrderMgmt.queryInfos,e).then((function(e){t.filters[0].options=[{label:"全部",value:""}].concat(e.supplierList.map((function(t){return{label:t.name,value:t.id}}))),t.filters[1].options=[{label:"全部",value:""}].concat(e.purchaserList.map((function(t){return{label:t.name,value:t.id}}))),t.filters[2].options=[{label:"全部",value:""}].concat(e.stateList.map((function(t){return{label:t.name,value:t.id}}))),t.filters[3].options=[{label:"全部",value:""}].concat(e.settleStateList.map((function(t){return{label:t.name,value:t.id}}))),t.filters[4].options=[{label:"全部",value:""}].concat(e.depotStateList.map((function(t){return{label:t.name,value:t.id}})))})).catch((function(e){t.$message.warning(e.errorMessage),console.log("ERR_REFRESH: ",e)})).finally((function(t){}))},setReturnOrderItems:function(t){this.$refs.baseInfo.setReturnOrderItems(t)},handleSelectionChange:function(t){this.selections=t,this.operations[1].disabled=!0,t.length>0&&(this.operations[1].disabled=!1)},filterDataChange:function(t){this.pagination.currentPage=1,this.refresh()},handleSizeChange:function(t){this.pagination.pageSize=t,this.refresh()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.refresh()},getState:function(t){switch(t.state){case"0":return"已提交";case"1":return"已确认";case"2":return"处理中";case"3":return"已完成";case"4":return"已作废";default:return"--"}},getSettleState:function(t){switch(t.settleState){case"0":return"未结清";case"1":return"部分结清";case"2":return"已结清";default:return"--"}},getDepotState:function(t){switch(t.depotState){case"0":return"未完成";case"1":return"部分完成";case"2":return"已完成";default:return"--"}}})},H=j,q=(a("6993"),Object(w["a"])(H,i,r,!1,null,null,null));e["default"]=q.exports},"408a":function(t,e,a){var i=a("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=i(t))throw TypeError("Incorrect invocation");return+t}},"57b1":function(t,e,a){},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var i=a("1d80"),r=a("5899"),n="["+r+"]",s=RegExp("^"+n+n+"*"),o=RegExp(n+n+"*$"),l=function(t){return function(e){var a=String(i(e));return 1&t&&(a=a.replace(s,"")),2&t&&(a=a.replace(o,"")),a}};t.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(t,e,a){"use strict";var i=a("9678"),r=a.n(i);r.a},6178:function(t,e,a){"use strict";var i=a("24e9a"),r=a.n(i);r.a},"697f":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:t.title,visible:t.dialogVisible,"append-to-body":t.appendToBody},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close,open:t.open}},[t._t("top"),a("biz-flex-table",{ref:"table",attrs:{showTable:t.showTable,operations:t.operations,filters:t.filters,tags:t.tags,rowKeys:t.rowKeys,pagination:t.pagination,tableData:t.tableData,rowClassName:t.rowClassName,loading:t.loading,memberIds:t.memberIds,checkable:t.checkable,isDepotOutNew:t.isDepotOutNew,checkedTable:t.checkedTable},on:{operate:t.operate,"row-click":t.rowClick,"filter-data-change":t.filterDataChange,"select-all":t.handleSelectAll,select:t.handleSelectionChange,"size-change":t.pageSizeChange,"current-change":t.currentPageChange,"cascader-change":t.cascaderChange,"active-item-change":t.activeItemChange,"sort-change":t.handleSortChange}},[t._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.isClear?a("el-button",{attrs:{size:"small"},on:{click:t.clear}},[t._v("清除")]):t._e(),a("el-button",{attrs:{size:"small"},on:{click:t.close}},[t._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirmed}},[t._v("确定")])],1)],2)},r=[],n=(a("99af"),a("4160"),a("c975"),a("a434"),a("a9e3"),a("159b"),a("04d3")),s={name:"BizDialogSelector",components:{BizFlexTable:n["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(t){return t.id},generateSelectionKeys:function(t,e){if(t.indexOf(e)>=0)this.innerSelectionKeys.push(e[this.keyField]),this.innerSelection.push(e);else{var a=this.innerSelectionKeys.indexOf(e[this.keyField]);this.innerSelectionKeys.splice(a,1),this.innerSelection.splice(a,1)}},open:function(t){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(t){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var t=this;this.tableData.forEach((function(e){t.$refs.table.toggleRowSelection(e,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var t=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(e){t.innerSelectionKeys.indexOf(e[t.keyField])>=0?(t.$refs.table.toggleRowSelection(e,!0),"single"===t.selectionMode&&(t.$refs.table.$refs.table.setCurrentRow(e),t.innerSelection=[e])):t.$refs.table.toggleRowSelection(e,!1)}))},operate:function(t){this.$emit("operate",t)},filterDataChange:function(t){this.$emit("filterDataChange",t)},handleSelectAll:function(t){var e=this;0===t.length?this.tableData.forEach((function(t){var a=e.innerSelectionKeys.indexOf(t[e.keyField]);a>=0&&e.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(t){var a=e.innerSelectionKeys.indexOf(t[e.keyField]);a<0&&e.innerSelectionKeys.push(t[e.keyField])})),this.$emit("selectionChange",t)},handleSelectionChange:function(t,e){this.generateSelectionKeys(t,e),this.$emit("selectionChange",t)},pageSizeChange:function(t){this.$emit("pageSizeChange",t)},currentPageChange:function(t){this.$emit("currentPageChange",t)},cascaderChange:function(t){this.$emit("cascaderChange",t)},activeItemChange:function(t){this.$emit("active-item-change",t)},handleSortChange:function(t){this.$emit("sort-change",t)},rowClick:function(t,e,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[t[this.keyField]],this.innerSelection=[t])}},watch:{visibility:function(t,e){this.dialogVisible=t,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},o=s,l=(a("0943"),a("2877")),c=Object(l["a"])(o,i,r,!1,null,null,null);e["a"]=c.exports},6993:function(t,e,a){"use strict";var i=a("a8e7"),r=a.n(i);r.a},7132:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(e){return e.target!==e.currentTarget?null:t.close(e)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"popup-content",style:t.contentStyle},[t._t("default")],2)])],1)])},r=[],n={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},s=n,o=(a("5b8e"),a("2877")),l=Object(o["a"])(s,i,r,!1,null,null,null),c=l.exports,u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:t.open,contentStyle:t.contentStyle},on:{close:t.close}},[a("el-tabs",{attrs:{type:"border-card",value:t.value},on:{"tab-click":t.tabClick}},[t._t("default")],2)],1)],1)},d=[],p=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var t=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("close")}))},tabClick:function(t){this.$emit("input",t.name)}}}),f=p,m=(a("d4c2"),Object(o["a"])(f,u,d,!1,null,null,null)),g=m.exports;a.d(e,"a",(function(){return g}))},7633:function(t,e,a){"use strict";var i=a("57b1"),r=a.n(i);r.a},"949e":function(t,e,a){"use strict";var i=a("b21c"),r=a.n(i);r.a},9678:function(t,e,a){},a8e7:function(t,e,a){},a9e3:function(t,e,a){"use strict";var i=a("83ab"),r=a("da84"),n=a("94ca"),s=a("6eeb"),o=a("5135"),l=a("c6b6"),c=a("7156"),u=a("c04e"),d=a("d039"),p=a("7c73"),f=a("241c").f,m=a("06cf").f,g=a("9bf2").f,h=a("58a8").trim,b="Number",v=r[b],y=v.prototype,w=l(p(y))==b,S=function(t){var e,a,i,r,n,s,o,l,c=u(t,!1);if("string"==typeof c&&c.length>2)if(c=h(c),e=c.charCodeAt(0),43===e||45===e){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+c}for(n=c.slice(2),s=n.length,o=0;o<s;o++)if(l=n.charCodeAt(o),l<48||l>r)return NaN;return parseInt(n,i)}return+c};if(n(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var _,C=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof C&&(w?d((function(){y.valueOf.call(a)})):l(a)!=b)?c(new v(S(e)),a,C):S(e)},I=i?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),D=0;I.length>D;D++)o(v,_=I[D])&&!o(C,_)&&g(C,_,m(v,_));C.prototype=y,y.constructor=C,s(r,b,C)}},af3f:function(t,e,a){"use strict";var i=a("697f");e["a"]=i["a"]},b21c:function(t,e,a){},b680:function(t,e,a){"use strict";var i=a("23e7"),r=a("a691"),n=a("408a"),s=a("1148"),o=a("d039"),l=1..toFixed,c=Math.floor,u=function(t,e,a){return 0===e?a:e%2===1?u(t,e-1,a*t):u(t*t,e/2,a)},d=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},p=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){l.call({})}));i({target:"Number",proto:!0,forced:p},{toFixed:function(t){var e,a,i,o,l=n(this),p=r(t),f=[0,0,0,0,0,0],m="",g="0",h=function(t,e){var a=-1,i=e;while(++a<6)i+=t*f[a],f[a]=i%1e7,i=c(i/1e7)},b=function(t){var e=6,a=0;while(--e>=0)a+=f[e],f[e]=c(a/t),a=a%t*1e7},v=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==f[t]){var a=String(f[t]);e=""===e?a:e+s.call("0",7-a.length)+a}return e};if(p<0||p>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(m="-",l=-l),l>1e-21)if(e=d(l*u(2,69,1))-69,a=e<0?l*u(2,-e,1):l/u(2,e,1),a*=4503599627370496,e=52-e,e>0){h(0,a),i=p;while(i>=7)h(1e7,0),i-=7;h(u(10,i,1),0),i=e-1;while(i>=23)b(1<<23),i-=23;b(1<<i),h(1,1),b(2),g=v()}else h(0,a),h(1<<-e,0),g=v()+s.call("0",p);return p>0?(o=g.length,g=m+(o<=p?"0."+s.call("0",p-o)+g:g.slice(0,o-p)+"."+g.slice(o-p))):g=m+g,g}})},d4c2:function(t,e,a){"use strict";var i=a("e725"),r=a.n(i);r.a},e725:function(t,e,a){},f3ac:function(t,e,a){t.exports=a.p+"static/img/pic_default_none_100.6603f4ac.png"}}]);