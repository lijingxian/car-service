(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9d062eb2"],{"0943":function(t,e,i){"use strict";var n=i("1fac"),a=i.n(n);a.a},"1fac":function(t,e,i){},2434:function(t,e,i){"use strict";var n=i("3ea4"),a=i.n(n);a.a},"3ea4":function(t,e,i){},"435c":function(t,e,i){"use strict";var n=i("b477"),a=i.n(n);a.a},5194:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"article-publish"},[i("div",{attrs:{slot:"top"},slot:"top"},[i("biz-header",{attrs:{operations:t.operations,filters:t.filters},on:{operate:t.operate,filterDataChange:t.filterDataChange}})],1),i("div",{staticClass:"container"},[0===t.dynamicList.length?i("biz-empty-table"):i("div",{staticClass:"article-list"},t._l(t.dynamicList,(function(e,n){return i("div",{key:e.id},[i("dynamic-item",{attrs:{isDelete:t.isDelete,dynamic:e},on:{deleteDynamic:t.deleteDynamic,lookOver:t.lookOver,select:t.selectDynamic,reply:t.replyDynamic,update:t.refresh,"update:dynamic":function(t){e=t}}}),n+1!==t.dynamicList.length?i("div",{staticClass:"line"}):t._e()],1)})),0)],1),t.dynamicList.length?i("div",{staticClass:"m-pagination",attrs:{slot:"bottom"},slot:"bottom"},[t.dynamicList.length?i("biz-pagination",{attrs:{pagination:t.dynamicPagination},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}):t._e()],1):t._e(),i("dynamic-preview",{attrs:{open:t.previewDialog,dynamicId:t.dynamicId,author:t.dynamicAuthor},on:{"update:open":function(e){t.previewDialog=e}}}),i("div",{attrs:{slot:"float"},slot:"float"},[i("biz-popup-tabs",{attrs:{open:t.openPopup},on:{close:t.onClose},model:{value:t.popupTabName,callback:function(e){t.popupTabName=e},expression:"popupTabName"}},[t.isActivate("dynamicDetail")?i("el-tab-pane",{attrs:{label:"文章详情",name:"dynamicDetail"}},[i("article-info",{attrs:{dynamicId:t.dynamicId,dynamicAuthor:t.dynamicAuthor},on:{refresh:t.refresh}})],1):t._e(),t.isActivate("columnSetting")?i("el-tab-pane",{attrs:{label:"栏目设置",name:"columnSetting"}},[i("column-setting",{attrs:{refresh:t.refreshColumn}})],1):t._e(),t.isActivate("dynamicComment")?i("el-tab-pane",{attrs:{label:"动态评论",name:"dynamicComment"}},[i("dynamic-comment",{attrs:{title:t.dynamicCommentTitle,dynamicId:t.dynamicCommentId},on:{created:t.refresh}})],1):t._e()],1)],1)],1)},a=[],o=(i("caad"),i("b0c0"),i("a9e3"),i("2532"),i("b85c")),s=i("5530"),c=i("04d3"),l=i("f36f"),r=i("9b4d"),m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"article-info"},[i("biz-save-button",{attrs:{operations:t.operations},on:{operate:t.operate}}),i("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"100px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"车友会",prop:"fleetId"}},[i("el-select",{attrs:{disabled:""!==t.dynamicIdNew},on:{change:t.onChange},model:{value:t.form.fleetId,callback:function(e){t.$set(t.form,"fleetId",e)},expression:"form.fleetId"}},t._l(t.motoristsClubList,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),i("el-form-item",{attrs:{label:"栏目",prop:"columnSelList"}},[i("div",{staticClass:"column-style"},[i("el-checkbox-group",{attrs:{size:"small"},model:{value:t.form.columnSelList,callback:function(e){t.$set(t.form,"columnSelList",e)},expression:"form.columnSelList"}},t._l(t.form.columns,(function(e){return i("el-checkbox-button",{key:e.id,staticClass:"tag-column",attrs:{label:e.name}},[t._v(t._s(e.name))])})),1)],1)]),i("el-form-item",{attrs:{label:"文章选择",prop:"artcleName"}},[i("div",{staticClass:"select-article"},[i("el-input",{staticClass:"select-input",attrs:{placeholder:"请选择文章",readonly:""},model:{value:t.form.artcleName,callback:function(e){t.$set(t.form,"artcleName",e)},expression:"form.artcleName"}}),i("el-button",{attrs:{type:"primary",small:"",disabled:""!==t.dynamicIdNew},on:{click:t.addArticle}},[t._v("+")])],1)])],1),i("dynamic-preview",{attrs:{open:t.previewDialog,dynamicId:t.articleId,author:t.dynamicAuthorNew},on:{"update:open":function(e){t.previewDialog=e}}}),i("el-dialog",{staticClass:"dynamic-preview",attrs:{"append-to-body":"",title:"预览",visible:t.previewDialogOpen,width:"450px"},on:{close:t.closePreviewDialog}},[i("div",{staticClass:"bg",style:{background:t.background}},[i("div",{staticClass:"cpreview"},[i("div",{staticClass:"pcontent"},[i("div",{staticClass:"title"},[t._v(t._s(t.articleInfo.title?t.articleInfo.title:""))]),i("div",{staticClass:"detail"},[i("div",{staticClass:"avater"},[i("img",{attrs:{src:this.form.authorData.head||t.DefaultAvatar,alt:""}})]),i("div",{staticClass:"vt"},[i("div",{staticClass:"name"},[t._v(t._s(t.form.authorData.name?t.form.authorData.name:""))]),i("div",{staticClass:"time"},[t._v(t._s(t.articleInfo.publishDate?t.articleInfo.publishDate:""))])])]),i("div",{domProps:{innerHTML:t._s(t.articleInfo.content?t.articleInfo.content:"")}})])])])]),i("biz-dialog-selector",{staticClass:"selector",attrs:{title:"文章选择",loading:t.dialogLoading,selectionMode:"single",isClear:!1,visibility:t.showDialog,tableData:t.tableData,pagination:t.pagination},on:{"update:visibility":function(e){t.showDialog=e},pageSizeChange:t.handleSizeChange,currentPageChange:t.handleCurrentChange,confirmed:t.confirm}},[i("el-table-column",{attrs:{prop:"title",label:"标题"}}),i("el-table-column",{attrs:{prop:"shop.name",label:"店铺"}}),i("el-table-column",{attrs:{prop:"publishDate",label:"发布时间"}})],1)],1)},u=[],d=(i("4160"),i("d81d"),i("159b"),i("8330")),p=i("af3f"),f=i("1ab1"),h=i("c596"),g=i("4139"),y=i("fc15"),v=i("04d5"),b=i("2a8a"),C=i.n(b),I=i("624d"),D=i.n(I),w={name:"article-info",data:function(){return{previewDialogOpen:!1,dynamicIdNew:"",articleId:"",DefaultAvatar:D.a,dynamicAuthorNew:"",previewDialog:!1,background:"url("+C.a+") no-repeat no-repeat",loading:!1,articleCategoryId:"",motoristsClubList:[],showDialog:!1,tableData:[],articleInfo:{},pagination:{pageSize:10,currentPage:1,pageSizes:[10,20,50,100],total:9},dialogLoading:!1,form:{authorData:{},fleetId:"",columnSelList:["推荐"],columns:[],artcleName:"",tagList:[]},rules:{columnSelList:[{required:!0,message:"请选择栏目",trigger:"change"}],artcleName:[{required:!0,message:"请选择文章",trigger:"change"}]},operations:[{disabled:!1,label:"预览",name:"previewDynamic",type:""},{label:"保存",name:"publish",type:"primary"}]}},props:{dynamicId:{type:String},dynamicAuthor:{type:String}},components:{BizSaveButton:d["a"],BizDialogSelector:p["a"],DynamicPreview:v["a"]},computed:{},watch:{dynamicId:function(t){this.dynamicIdNew=t,this.articleInfo={},this.articleId="",this.$refs.form.resetFields(),""===t||"-1"===t?(this.clearForm(),this.form.authorData.head=this.motoristsClubList[0].head,this.form.authorData.name=this.motoristsClubList[0].label):this.refresh()},dynamicAuthorNew:function(t){this.dynamicAuthorNew=t},motoristsClubList:function(t){t&&t.length>0&&(this.form.fleetId=t[0].value,this.form.authorData.head=t[0].head,this.form.authorData.name=t[0].label)}},methods:{closePreviewDialog:function(){this.previewDialogOpen=!1},clearForm:function(){this.form.fleetId=this.motoristsClubList[0].value,this.form.columnSelList=["推荐"],this.form.artcleName="",this.form.authorData={}},operate:function(t){this[t]()},publish:function(){var t,e=this;this.$refs.form.validate((function(i){if(i){if(""===e.form.artcleName)return void e.$notify({title:"警告",message:"请选择发布文章",type:"warning"});var n=[];e.form.columnSelList.map((function(t){e.form.columns.map((function(e){t===e.name&&n.push({id:e.id,name:e.name})})),e.form.columnSelList=n})),""===e.dynamicId?(t={fleet:{id:e.form.fleetId},articleId:e.articleId,columnList:e.form.columnSelList},f["a"].post(h["g"].motoristsClubDynamic.createDynamic,t).then((function(t){e.$message.success("操作成功"),e.$emit("refresh")})).catch((function(t){e.$message.warning(t.errorMessage)}))):(t={articleId:e.articleId,fleet:{id:e.form.fleetId},id:e.dynamicIdNew,columnList:e.form.columnSelList},y["a"].updateDynamic(t,(function(t){e.$message.success("操作成功"),e.$emit("refresh")}),(function(t){console.log(t)})))}}))},previewDynamic:function(){this.articleId&&this.getArticleInfo(),this.previewDialogOpen=!0},getArticleInfo:function(){var t=this,e={articleId:this.articleId};f["a"].get(h["g"].motoristsClubDynamic.articleInfo,e).then((function(e){console.log(e),t.articleInfo=e.article})).catch((function(t){console.log(t.errorMessage)}))},addArticle:function(){this.showDialog=!0,this.getArticleList()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.getArticleList()},rowClick:function(t){this.$emit("selectArticle",t.id)},handleSizeChange:function(t){this.pagination.pageSize=t,this.getArticleList()},getArticleList:function(){var t=this;this.dialogLoading=!0;var e={shopId:window.top.SHOP_ID||"",categoryId:this.articleCategoryId,pageable:{pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize}};f["a"].get(h["g"].motoristsClubDynamic.articleList,e).then((function(e){t.dialogLoading=!1,t.tableData=e.articles,t.pagination.total=Number(e.total)})).catch((function(e){t.dialogLoading=!1,console.log(e)}))},confirm:function(t,e){var i=this;this.tableData.forEach((function(e){if(e.id===t[0])return i.form.artcleName=e.title,i.articleId=e.id,i.dynamicAuthorNew=i.form.fleetId,i.form.tagList=e.tagMapping?e.tagMapping.tags:[],!1}))},getMotoristsClub:function(){var t=this,e={shopId:window.top.SHOP_ID};g["a"].getMotoristsClub(e,(function(e){t.motoristsClubList=[];var i,n=Object(o["a"])(e.content);try{for(n.s();!(i=n.n()).done;){var a=i.value;t.motoristsClubList.push({value:a.id,label:a.name,head:a.head})}}catch(s){n.e(s)}finally{n.f()}t.form.fleetId=t.motoristsClubList[0].label,t.dynamicAuthorNew=t.form.fleetId}),(function(t){console.log(t)}))},onChange:function(t){var e=this;this.motoristsClubList.forEach((function(i){if(i.value===t)return e.form.authorData.head=i.head,e.form.authorData.name=i.label,!1}))},refresh:function(){var t=this;this.loading=!0;var e={spaceId:this.dynamicIdNew};y["a"].selectDynamic(e,(function(e){t.loading=!1,t.form.fleetId=e.data.fleet?e.data.fleet.id:"",t.fleet=e.data.fleet||{},t.dynamicAuthorNew=t.form.fleetId;var i=[];e.data.columnList.map((function(t){i.push(t.name)})),t.form.columnSelList=i||[],t.form.artcleName=e.data.title,t.articleId=e.data.articleId,t.form.authorData=e.data.authorData}),(function(e){t.loading=!1,console.log(e)}))},getCategoryList:function(){var t=this,e={shopId:window.top.SHOP_ID||""};y["a"].getArticleTypeList(e,(function(e){e.articleCategorys.length>1&&(t.articleCategoryId=e.articleCategorys[0].id)}),(function(t){console.log(t)}))},getColumns:function(){var t=this;f["a"].get(h["g"].motoristsClubDynamic.visibleColumns).then((function(e){t.form.columns=e.content})).catch((function(e){t.$message.warning(e.errorMessage)}))}},created:function(){this.getColumns(),this.getCategoryList(),this.getMotoristsClub()}},_=w,S=(i("7441"),i("2877")),k=Object(S["a"])(_,m,u,!1,null,null,null),$=k.exports,L=i("d6b0"),N=i("7132"),z=i("c466"),A=i("1f39"),x=i("7f16"),T=i("2f62"),O={name:"article-publish",data:function(){return{dynamicCommentId:"",dynamicCommentTitle:"",refreshColumn:!1,previewDialog:!1,openPopup:!1,popupTabName:"dynamicDetail",dynamicId:"",dynamicAuthor:"",dynamicList:[],operations:[{label:"添加",name:"add",type:"primary",auth:["admin:fleet.article.add"]},{label:"刷新",name:"refresh",type:""},{label:"栏目设置",name:"columnSetting",type:"",auth:["admin:fleet.article.set"]}],filters:[{type:"select",label:"车友会",name:"add",value:"",options:[]},{type:"daterange",label:"发布时间：",name:"日期区间：",value:["2017-12-12","2018-02-12"]},{type:"input",label:"",placeholder:"请输入作者/标题进行",name:"add",value:""}],dynamicPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9}}},props:{},components:{BizHeader:c["d"],BizPagination:c["f"],DynamicItem:r["a"],ArticleInfo:$,BizEmptyTable:L["a"],BizPopupTabs:N["a"],ColumnSetting:A["a"],DynamicPreview:v["a"],DynamicComment:x["a"],BizGrid:l["a"]},computed:Object(s["a"])(Object(s["a"])({},Object(T["c"])("Authority",["currentAuth"])),{},{isDelete:function(){return this.currentAuth.includes("admin:fleet.article.delete")}}),watch:{},methods:{onClose:function(){this.dynamicId="-1",this.openPopup=!1,this.refreshColumn=!1},isActivate:function(t){return this.popupTabName===t},replyDynamic:function(t,e){this.dynamicCommentId=t,this.dynamicCommentTitle=e,this.popupTabName="dynamicComment",this.popupTabAreaName="dynamicComment",this.openPopup=!0},operate:function(t){this[t]()},filterDataChange:function(){this.dynamicPagination.currentPage=1,this.refresh()},add:function(){this.dynamicId="",this.popupTabName="dynamicDetail",this.openPopup=!0},columnSetting:function(){this.popupTabName="columnSetting",this.openPopup=!0,this.refreshColumn=!0},refresh:function(){this.getDynamicList()},handleSizeChange:function(t){this.dynamicPagination.pageSize=t,this.refresh()},handleCurrentChange:function(t){this.dynamicPagination.currentPage=t,this.refresh()},getDynamicList:function(){var t=this,e={pageable:{pageNumber:this.dynamicPagination.currentPage,pageSize:this.dynamicPagination.pageSize},shopId:window.top.SHOP_ID||"",fleetId:this.filters[0].value,memberId:"",repostType:"1",keyword:this.filters[2].value,beginDate:this.filters[1].value[0],endDate:this.filters[1].value[1]};f["a"].get(h["g"].motoristsClubDynamic.dynamicList,e).then((function(e){console.log("333",e),t.dynamicPagination.total=Number(e.total),t.dynamicList=e.content})).catch((function(t){console.log(t.errorMessage)}))},getMotoristsClub:function(){var t=this,e={shopId:window.top.SHOP_ID};g["a"].getMotoristsClub(e,(function(e){t.filters[0].options=[],t.filters[0].options.push({value:"",label:"全部"});var i,n=Object(o["a"])(e.content);try{for(n.s();!(i=n.n()).done;){var a=i.value;t.filters[0].options.push({value:a.id,label:a.name})}}catch(s){n.e(s)}finally{n.f()}}),(function(t){console.log(t),console.log("code错误")}))},deleteDynamic:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=[];i.push(t);var n={shopId:window.top.SHOP_ID||"",ids:i};g["a"].delete(n,(function(t){e.$message({type:"success",message:"删除成功!"}),e.refresh()}),(function(t){e.$message({type:"warning",message:t.errorMessage})}))}))},lookOver:function(t){var e=t.id,i=t.author;this.dynamicId=e,this.dynamicAuthor=i,this.previewDialog=!0},selectDynamic:function(t){var e=t.id,i=t.author;this.dynamicId=e,this.dynamicAuthor=i,this.popupTabName="dynamicDetail",this.popupTabAreaName="dynamicDetail",this.openPopup=!0},initDate:function(){this.filters[1].value[0]=z["a"].lastMonthDate(),this.filters[1].value[1]=z["a"].nowDate()}},created:function(){this.initDate(),this.getMotoristsClub(),this.getDynamicList()}},P=O,E=(i("93c2"),Object(S["a"])(P,n,a,!1,null,null,null));e["default"]=E.exports},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var n=i("1d80"),a=i("5899"),o="["+a+"]",s=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),l=function(t){return function(e){var i=String(n(e));return 1&t&&(i=i.replace(s,"")),2&t&&(i=i.replace(c,"")),i}};t.exports={start:l(1),end:l(2),trim:l(3)}},"697f":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:t.title,visible:t.dialogVisible,"append-to-body":t.appendToBody},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close,open:t.open}},[t._t("top"),i("biz-flex-table",{ref:"table",attrs:{showTable:t.showTable,operations:t.operations,filters:t.filters,tags:t.tags,rowKeys:t.rowKeys,pagination:t.pagination,tableData:t.tableData,rowClassName:t.rowClassName,loading:t.loading,memberIds:t.memberIds,checkable:t.checkable,isDepotOutNew:t.isDepotOutNew,checkedTable:t.checkedTable},on:{operate:t.operate,"row-click":t.rowClick,"filter-data-change":t.filterDataChange,"select-all":t.handleSelectAll,select:t.handleSelectionChange,"size-change":t.pageSizeChange,"current-change":t.currentPageChange,"cascader-change":t.cascaderChange,"active-item-change":t.activeItemChange,"sort-change":t.handleSortChange}},[t._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.isClear?i("el-button",{attrs:{size:"small"},on:{click:t.clear}},[t._v("清除")]):t._e(),i("el-button",{attrs:{size:"small"},on:{click:t.close}},[t._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirmed}},[t._v("确定")])],1)],2)},a=[],o=(i("99af"),i("4160"),i("c975"),i("a434"),i("a9e3"),i("159b"),i("04d3")),s={name:"BizDialogSelector",components:{BizFlexTable:o["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(t){return t.id},generateSelectionKeys:function(t,e){if(t.indexOf(e)>=0)this.innerSelectionKeys.push(e[this.keyField]),this.innerSelection.push(e);else{var i=this.innerSelectionKeys.indexOf(e[this.keyField]);this.innerSelectionKeys.splice(i,1),this.innerSelection.splice(i,1)}},open:function(t){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(t){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var t=this;this.tableData.forEach((function(e){t.$refs.table.toggleRowSelection(e,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var t=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(e){t.innerSelectionKeys.indexOf(e[t.keyField])>=0?(t.$refs.table.toggleRowSelection(e,!0),"single"===t.selectionMode&&(t.$refs.table.$refs.table.setCurrentRow(e),t.innerSelection=[e])):t.$refs.table.toggleRowSelection(e,!1)}))},operate:function(t){this.$emit("operate",t)},filterDataChange:function(t){this.$emit("filterDataChange",t)},handleSelectAll:function(t){var e=this;0===t.length?this.tableData.forEach((function(t){var i=e.innerSelectionKeys.indexOf(t[e.keyField]);i>=0&&e.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(t){var i=e.innerSelectionKeys.indexOf(t[e.keyField]);i<0&&e.innerSelectionKeys.push(t[e.keyField])})),this.$emit("selectionChange",t)},handleSelectionChange:function(t,e){this.generateSelectionKeys(t,e),this.$emit("selectionChange",t)},pageSizeChange:function(t){this.$emit("pageSizeChange",t)},currentPageChange:function(t){this.$emit("currentPageChange",t)},cascaderChange:function(t){this.$emit("cascaderChange",t)},activeItemChange:function(t){this.$emit("active-item-change",t)},handleSortChange:function(t){this.$emit("sort-change",t)},rowClick:function(t,e,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[t[this.keyField]],this.innerSelection=[t])}},watch:{visibility:function(t,e){this.dialogVisible=t,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},c=s,l=(i("0943"),i("2877")),r=Object(l["a"])(c,n,a,!1,null,null,null);e["a"]=r.exports},"6cad":function(t,e,i){"use strict";var n=i("a40d"),a=i.n(n);a.a},7441:function(t,e,i){"use strict";var n=i("a2ba"),a=i.n(n);a.a},"76cf":function(t,e,i){"use strict";var n=i("8370"),a=i.n(n);a.a},"7f16":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dynamic-comment"},[i("div",{staticClass:"comment"},[i("div",{staticClass:"title"},[t._v(" "+t._s(t.title)+" ")]),i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.getContent(t.comment))}}),i("el-input",{ref:"elinput",attrs:{type:"textarea",rows:4,placeholder:"请输入评论内容"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),i("div",{staticClass:"operator"},[i("el-popover",{ref:"popover",attrs:{width:"430",placement:"bottom-start",trigger:"click"}},[i("i",{staticClass:"iconfont biz-icon-biaoqing",attrs:{slot:"reference"},slot:"reference"},[i("span",[t._v("表情")])]),i("biz-emoji-picker",{on:{choosed:t.chooseEmoji}})],1),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.reply}},[t._v("评论")])],1)],1),i("div",{staticClass:"comment-list"},t._l(t.commentList,(function(e,n){return i("div",{key:e.id},[i("dynamic-comment-item",{attrs:{comment:e,relative:t.relative},on:{support:t.support,deleteComment:t.deleteComment,reply:t.itemReply,"update:comment":function(t){e=t}}}),n+1!==t.commentList.length?i("div",{staticClass:"line"}):t._e()],1)})),0)])},a=[],o=(i("fb6a"),i("b85c")),s=i("e4ab"),c=i("7624"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dynamic-comment-item"},[i("div",{staticClass:"info"},[i("div",{staticClass:"person"},[i("div",{staticClass:"avatar"},[i("img",{attrs:{src:t.comment.member.head||t.DefaultAvatar,alt:""}})]),i("div",{staticClass:"name-time"},[i("div",{staticClass:"name"},[t._v(t._s(t.comment.member.nickname))]),i("div",{staticClass:"time"},[t._v(t._s(t.comment.publishDate))])])]),i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.comment.content)}}),i("div",{staticClass:"handle"},[i("dynamic-comment-item-reply",{staticClass:"p-btn",attrs:{relative:t.relative,name:t.comment.member.nickname},on:{reply:t.reply}},[i("i",{staticClass:"iconfont biz-icon-message2"}),t._v(" "+t._s(t.comment.commentCount)+" ")]),i("div",{staticClass:"p-btn"},[i("i",{staticClass:"iconfont biz-icon-dianzan_normal",class:{active:"1"===t.comment.isSupport},on:{click:t.support}}),i("div",{staticClass:"p-number"},[t._v(t._s(t.comment.supportCount))])]),i("div",{staticClass:"p-btn"},[i("i",{staticClass:"el-icon-delete",on:{click:t.deleteComment}})])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.comment.comments,expression:"comment.comments"}],staticClass:"second-comments"},t._l(t.comment.comments,(function(e){return i("div",{key:e.id,staticClass:"s-comment"},[i("div",{staticClass:"s-name"},[t._v(t._s(e.member.nickname)+"：")]),i("div",{staticClass:"s-content"},[t._v(t._s(e.content))])])})),0)])])},r=[],m=(i("a9e3"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dynamic-comment-item-reply"},[i("el-popover",{ref:"popoverpicture",attrs:{placement:"bottom-end","popper-class":"dynamic-comment-item-reply-popover",offset:t.offset,width:"430",trigger:"click"},on:{show:t.clearInput}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:t.holder},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}}),i("el-button",{attrs:{size:"mini"},on:{click:t.reply}},[t._v("回复")])],1),i("span",{directives:[{name:"popover",rawName:"v-popover:popoverpicture",arg:"popoverpicture"}],staticClass:"name"},[t._t("default")],2)],1)}),u=[],d=(i("b0c0"),{name:"DynamicCommentItemReply",data:function(){return{input:"",offset:0}},mounted:function(){this.offset=this.relative-this.$el.offsetLeft-this.$el.offsetWidth},props:{name:{type:String,required:!0},relative:{type:Number,required:!0}},components:{},computed:{holder:function(){return"回复"+this.name}},methods:{clearInput:function(){this.input=""},reply:function(){""!==this.input?(this.$emit("reply",this.input),this.$refs.popoverpicture.doClose()):this.$notify({title:"警告",message:"内容不能为空",type:"warning"})}}}),p=d,f=(i("2434"),i("2877")),h=Object(f["a"])(p,m,u,!1,null,null,null),g=h.exports,y=i("624d"),v=i.n(y),b={name:"DynamicCommentItem",data:function(){return{input:"",DefaultAvatar:v.a}},props:{relative:{type:Number,required:!0},comment:Object},components:{DynamicCommentItemReply:g},methods:{reply:function(t){this.$emit("reply",{id:this.comment.id,content:t})},support:function(){this.$emit("support",this.comment.id)},deleteComment:function(){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("deleteComment",t.comment.id)})).catch((function(){}))}}},C=b,I=(i("435c"),Object(f["a"])(C,l,r,!1,null,null,null)),D=I.exports,w=i("8028"),_={name:"DynamicComment",data:function(){return{relative:450,commentList:[],comment:"",temp:""}},props:{title:String,dynamicId:{type:String,default:""}},components:{BizEmojiPicker:s["a"],DynamicCommentItem:D},created:function(){this.getCommentList()},watch:{dynamicId:function(t){""!==t&&this.getCommentList()}},methods:{operate:function(t){this[t]()},getCommentList:function(){var t=this,e={spaceId:this.dynamicId,pageable:{pageNumber:1,pageSize:100}};w["a"].getCommentList(e,(function(e){t.commentList=e.content;var i,n=Object(o["a"])(t.commentList);try{for(n.s();!(i=n.n()).done;){var a=i.value;a.content=c["a"].transform(a.content)}}catch(s){n.e(s)}finally{n.f()}}),(function(t){console.log(t)}))},getContent:function(t){},reply:function(){var t=this;if(""!==this.comment){var e={spaceId:this.dynamicId,content:this.comment,spaceCommentId:""};w["a"].reply(e,(function(e){t.comment="",t.getCommentList(),t.$message.success("评论成功"),t.$emit("created")}),(function(t){console.log(t)}))}else this.$notify({title:"警告",message:"评论内容不能为空",type:"warning"})},deleteComment:function(t){var e=this,i=[];i.push(t);var n={ids:i};w["a"].deleteCommnet(n,(function(t){e.$message.success("操作成功"),e.getCommentList(),e.$emit("created")}),(function(t){console.log(t)}))},itemReply:function(t){var e=this,i={spaceId:this.dynamicId,content:t.content,spaceCommentId:t.id};w["a"].reply(i,(function(t){e.$message.success("操作成功"),e.getCommentList(),e.$emit("created")}),(function(t){console.log(t)}))},support:function(t){var e=this,i={spaceCommentId:t};w["a"].supportComment(i,(function(t){e.getCommentList(),e.$emit("created")}),(function(t){console.log(t)}))},chooseEmoji:function(t){var e=this.$refs.elinput.$refs.textarea.selectionStart,i=this.$refs.elinput.$refs.textarea.selectionEnd;this.comment=this.comment.slice(0,e)+t+this.comment.slice(i),this.$refs.popover.doClose()}}},S=_,k=(i("acd5"),Object(f["a"])(S,n,a,!1,null,null,null));e["a"]=k.exports},8370:function(t,e,i){},"84c1":function(t,e,i){},"93c2":function(t,e,i){"use strict";var n=i("84c1"),a=i.n(n);a.a},"9b4d":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dynamic-item"},[i("div",{staticClass:"header"},[t.title?i("div",{staticClass:"title active",on:{click:t.select}},[t._v(" "+t._s(t.title)+" ")]):t._e(),t.title?t._e():i("div",{staticClass:"avatar"},[i("img",{attrs:{src:t.dynamic.authorData.head||t.DefaultAvatar,alt:""}}),i("div",{staticClass:"name"},[t._v(t._s(t.dynamic.authorData.name)+" ")]),i("div",{staticClass:"from"},[t._v(t._s(t.dynamic.publishDate))])]),i("div",{staticClass:"operate"},[i("i",{staticClass:"iconfont biz-icon-chakan",attrs:{title:"查看"},on:{click:t.lookOver}}),i("i",{staticClass:"iconfont biz-icon-vertical_line"}),i("i",{staticClass:"iconfont biz-icon-zhiding",class:{active:"1"===t.dynamic.isTop},attrs:{title:"置顶"},on:{click:t.top}}),i("i",{staticClass:"iconfont biz-icon-vertical_line"}),t.isDelete?i("i",{staticClass:"el-icon-delete",attrs:{title:"删除"},on:{click:t.deleteDynamic}}):t._e()])]),i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.dynamic.content)}}),i("div",{staticClass:"media"},[t._l(t.dynamic.images,(function(e,n){return 0!==t.dynamic.images.length&&0===t.dynamic.videos.length?i("img",{key:n,attrs:{src:e,alt:""},on:{click:function(e){return t.onClickCarouselItem(n)}}}):t._e()})),0!==t.dynamic.videos.length?i("video",{attrs:{controls:"",src:t.dynamic.videos[0]}}):t._e()],2),i("div",{staticClass:"details"},[i("div",{staticClass:"avatar"},[t.title?i("img",{attrs:{src:t.dynamic.authorData.head||t.DefaultAvatar,alt:""}}):t._e(),t.title?i("div",{staticClass:"name"},[t._v(t._s(t.dynamic.authorData.name)+" ")]):t._e(),t.title?i("div",{staticClass:"from"},[t._v(t._s(t.dynamic.publishDate))]):t._e()]),i("div",{staticClass:"handle"},[i("div",{staticClass:"p-btn"},[i("i",{staticClass:"iconfont biz-icon-eye"}),i("div",{staticClass:"p-number"},[t._v(t._s(t.dynamic.readCount))])]),i("div",{staticClass:"p-btn"},[i("i",{staticClass:"iconfont biz-icon-message2",on:{click:t.reply}}),i("div",{staticClass:"p-number"},[t._v(t._s(t.dynamic.commentCount))])]),i("div",{staticClass:"p-btn"},[i("i",{staticClass:"iconfont",class:t.zanClass,on:{click:t.thumbsUp}}),i("div",{staticClass:"p-number"},[t._v(t._s(t.dynamic.supportCount))])])])]),i("el-dialog",{attrs:{title:"",width:"50%",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},open:t.openHandle}},[i("el-carousel",{ref:"carousel",attrs:{height:"600px",autoplay:!1,arrow:"always","initial-index":t.curIndex}},t._l(t.dynamic.images,(function(t,e){return i("el-carousel-item",{key:e,attrs:{name:t}},[i("img",{attrs:{src:t,alt:""}})])})),1)],1)],1)},a=[],o=(i("fb6a"),i("4139")),s=i("624d"),c=i.n(s),l={name:"DynamicItem",data:function(){return{curIndex:"",DefaultAvatar:c.a,editor:null,editorOption:{modules:{toolbar:{}},placeholder:"请输入正文...",theme:"snow"},swiperOption:{autoHeight:!0,spaceBetween:20,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},dialogVisible:!1}},props:{dynamic:Object,isDelete:{type:Boolean}},computed:{zanClass:function(){return{"biz-icon-dianzan_normal":"1"!==this.dynamic.isSupport,active:"1"===this.dynamic.isSupport,"biz-icon-dianzan_press":"1"===this.dynamic.isSupport}},title:function(){var t=this.dynamic.title||"";return t.slice(0,30)}},methods:{openHandle:function(){this.$refs.carousel&&this.$refs.carousel.setActiveItem(this.curIndex)},onClickCarouselItem:function(t){this.curIndex=t,this.dialogVisible=!0},reply:function(){this.$emit("reply",this.dynamic.id,this.dynamic.title)},select:function(){this.$emit("select",{id:this.dynamic.id,author:this.dynamic.author})},thumbsUp:function(){var t=this,e={spaceId:this.dynamic.id};o["a"].thumbsUp(e,(function(e){var i=t.dynamic;"unsupported"===e.type?(i.isSupport="0",i.supportCount--):(i.isSupport="1",i.supportCount++),t.$emit("update:dynamic",i)}),(function(t){console.log(t),console.log("code错误")}))},top:function(){var t=this,e={spaceId:this.dynamic.id};o["a"].top(e,(function(e){var i=t.dynamic;"0"===e.isTop?i.isTop="0":i.isTop="1",t.$emit("update",i)}),(function(t){console.log(t),console.log("code错误")}))},lookOver:function(){this.$emit("lookOver",{id:this.dynamic.id,author:this.dynamic.author})},deleteDynamic:function(){this.$emit("deleteDynamic",this.dynamic.id)}}},r=l,m=(i("76cf"),i("2877")),u=Object(m["a"])(r,n,a,!1,null,null,null);e["a"]=u.exports},a2ba:function(t,e,i){},a40d:function(t,e,i){},a9e3:function(t,e,i){"use strict";var n=i("83ab"),a=i("da84"),o=i("94ca"),s=i("6eeb"),c=i("5135"),l=i("c6b6"),r=i("7156"),m=i("c04e"),u=i("d039"),d=i("7c73"),p=i("241c").f,f=i("06cf").f,h=i("9bf2").f,g=i("58a8").trim,y="Number",v=a[y],b=v.prototype,C=l(d(b))==y,I=function(t){var e,i,n,a,o,s,c,l,r=m(t,!1);if("string"==typeof r&&r.length>2)if(r=g(r),e=r.charCodeAt(0),43===e||45===e){if(i=r.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(r.charCodeAt(1)){case 66:case 98:n=2,a=49;break;case 79:case 111:n=8,a=55;break;default:return+r}for(o=r.slice(2),s=o.length,c=0;c<s;c++)if(l=o.charCodeAt(c),l<48||l>a)return NaN;return parseInt(o,n)}return+r};if(o(y,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var D,w=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof w&&(C?u((function(){b.valueOf.call(i)})):l(i)!=y)?r(new v(I(e)),i,w):I(e)},_=n?p(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;_.length>S;S++)c(v,D=_[S])&&!c(w,D)&&h(w,D,f(v,D));w.prototype=b,b.constructor=w,s(a,y,w)}},acd5:function(t,e,i){"use strict";var n=i("c86f"),a=i.n(n);a.a},af3f:function(t,e,i){"use strict";var n=i("697f");e["a"]=n["a"]},b477:function(t,e,i){},c86f:function(t,e,i){},e4ab:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"emoji-picker"},[i("div",{staticClass:"body"},t._l(t.currentEmojis,(function(e,n){return i("div",{key:n,staticClass:"emoji",on:{click:function(i){return t.choose(e.key)}}},[i("img",{attrs:{src:e.value}})])})),0),i("div",{staticClass:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary",disabled:0===t.index,icon:"el-icon-arrow-left"},on:{click:t.pageUp}}),i("el-button",{attrs:{size:"mini",type:"primary",disabled:t.index+72>109,icon:"el-icon-arrow-right"},on:{click:t.pageDown}})],1)])},a=[],o=(i("fb6a"),i("7624")),s={name:"EmojiPicker",data:function(){return{index:0,emojis:o["a"].emojis}},computed:{currentEmojis:function(){return this.emojis.slice(this.index,this.index+72)}},methods:{pageDown:function(){this.index+=72},pageUp:function(){this.index-=72},choose:function(t){this.$emit("choosed",t)}}},c=s,l=(i("6cad"),i("2877")),r=Object(l["a"])(c,n,a,!1,null,null,null),m=r.exports;i.d(e,"a",(function(){return m}))}}]);