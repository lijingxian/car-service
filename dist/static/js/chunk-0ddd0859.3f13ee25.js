(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ddd0859"],{"075b":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{staticStyle:{width:"100%"},attrs:{value:e.value,placeholder:"请选择",disabled:e.disabled},on:{input:e.handleInput}},e._l(e.shopList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)},n=[],i=a("5530"),r=a("2497"),l=a("bc3a"),s=a.n(l),c=a("2f62"),u={name:"BizShopPicker",components:{},props:{value:{default:function(){return""}},disabled:{type:Boolean,default:function(){return!1}},operatorId:{default:function(){return""}}},data:function(){return{shopList:[]}},methods:Object(i["a"])(Object(i["a"])({},Object(c["c"])(["currentUser"])),{},{queryShop:function(){var e=this;s.a.get("/admin/admin/json/queryShops.jhtml",{params:{companyId:this.operatorId}}).then(Object(r["a"])((function(t){e.shopList=t.shopDatas,0===e.shopList.length&&e.shopList.push(e.currentUser().shop)}),(function(e){console.log(e),console.log("code错误")}))).catch((function(e){console.error(e)}))},handleInput:function(e){this.$emit("input",e)}}),watch:{operatorId:function(e){this.queryShop()}},created:function(){this.queryShop()}},d=u,p=a("2877"),h=Object(p["a"])(d,o,n,!1,null,null,null),f=h.exports;a.d(t,"a",(function(){return f}))},"12d4":function(e,t,a){"use strict";var o=a("68cd"),n=a.n(o);n.a},"239a":function(e,t,a){"use strict";var o=a("2497"),n=a("bc3a"),i=a.n(n),r=a("c596");t["a"]={queryPeople:function(e,t,a){i.a.get(r["g"].terminalMgmt.Component_queryPeople,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryOperators:function(e,t,a){i.a.get(r["g"].terminalMgmt.Component_queryOperators,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))}}},2497:function(e,t,a){"use strict";var o=a("4360"),n=a("a18c");t["a"]=function(e,t){return function(a){var i=a.data;"100"===i.resultCode?e(i):"709"===i.resultCode?(o["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",o["a"].getters.currentUser),n["a"].push("/login")):t(i)}}},"2ba4":function(e,t,a){},"443b":function(e,t,a){"use strict";a("4de4");var o=a("c596"),n=a("1ab1"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":"",visible:e.visible,title:"自定义列","custom-class":"biz-columns",width:"500px"},on:{close:e.onClose}},[a("div",{staticClass:"columns-wrap"},[a("biz-flex-table",{ref:"table",attrs:{checkable:!1,tableData:e.tableData},on:{"selection-change":e.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.getSelectable}}),a("el-table-column",{attrs:{label:"信息",prop:"name"}}),a("el-table-column",{attrs:{prop:"tag",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.$index;return[a("el-button",{attrs:{icon:"el-icon-sort-up",type:"text",disabled:0===o},on:{click:function(t){return e.onUp(o)}}}),a("el-button",{attrs:{icon:"el-icon-sort-down",type:"text",disabled:o===e.tableData.length-1},on:{click:function(t){return e.onBottom(o)}}})]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)])},r=[],l=(a("7db0"),a("a434"),a("b85c")),s=a("04d3"),c={name:"biz-columns",components:{BizFlexTable:s["c"]},props:{visible:Boolean,tableId:String},data:function(){return{id:"",tableName:"",selections:[],tableData:[]}},computed:{},watch:{visible:function(e){e?this.makeRowDisplayable():this.saveSelection()},tableId:function(){this.getTableColumns()}},mounted:function(){this.getTableColumns()},methods:{getTableColumns:function(){var e=this;n["a"].get(o["g"].user.columns,{tableId:this.tableId}).then((function(t){e.tableData=t.data.columnDatas,e.id=t.data.id,e.tableName=t.data.tableName}))},getSelectable:function(e){return e.isEditable},selectionChangeHandler:function(e){this.selections=e},saveSelection:function(){var e,t=this,a=Object(l["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var o=e.value;o.displayable=!1}}catch(s){a.e(s)}finally{a.f()}var n,i=Object(l["a"])(this.selections);try{var r=function(){var e=n.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(i.s();!(n=i.n()).done;)r()}catch(s){i.e(s)}finally{i.f()}},onUp:function(e){this.tableData[e]=this.tableData.splice(e-1,1,this.tableData[e])[0]},onBottom:function(e){this.tableData[e]=this.tableData.splice(e+1,1,this.tableData[e])[0]},onClose:function(){this.$emit("update:visible",!1)},update:function(){var e,t=this,a=Object(l["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var i=e.value;i.displayable=!1}}catch(d){a.e(d)}finally{a.f()}var r,s=Object(l["a"])(this.selections);try{var c=function(){var e=r.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(s.s();!(r=s.n()).done;)c()}catch(d){s.e(d)}finally{s.f()}var u={columnDatas:this.tableData,id:this.id,tableId:this.tableId,tableName:this.tableName};console.log(u),n["a"].put(o["g"].user.columns,u).then((function(e){t.$emit("update"),t.$emit("update:visible",!1)}))},makeRowDisplayable:function(){var e=this;setTimeout((function(){var t,a=Object(l["a"])(e.tableData);try{for(a.s();!(t=a.n()).done;){var o=t.value;e.$refs.table.$refs.table.toggleRowSelection(o,o.displayable)}}catch(n){a.e(n)}finally{a.f()}}),20)}}},u=c,d=(a("ec6b"),a("2877")),p=Object(d["a"])(u,i,r,!1,null,null,null),h=p.exports,f=h;t["a"]={components:{BizColumnOperation:s["a"],BizColumns:f},data:function(){return{columnsSettingVisible:!1,columns:[]}},created:function(){this.getTableId(),this.getColumns()},methods:{onCustomColumns:function(){this.columnsSettingVisible=!0},getColumns:function(){var e=this;console.log(12),n["a"].get(o["A"].columns,{tableId:this.tableId}).then((function(t){e.columns=[],setTimeout((function(){e.columns=t.data.columnDatas.filter((function(e){return e.displayable})),e.$refs.table&&setTimeout((function(){e.$refs.table.doLayout()}),50)}),20)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getTableId:function(){}}}},"460f":function(e,t,a){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var o=a("1d80"),n=a("5899"),i="["+n+"]",r=RegExp("^"+i+i+"*"),l=RegExp(i+i+"*$"),s=function(e){return function(t){var a=String(o(t));return 1&e&&(a=a.replace(r,"")),2&e&&(a=a.replace(l,"")),a}};e.exports={start:s(1),end:s(2),trim:s(3)}},"5b8e":function(e,t,a){"use strict";var o=a("9678"),n=a.n(o);n.a},"68cd":function(e,t,a){},7132:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},n=[],i={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},r=i,l=(a("5b8e"),a("2877")),s=Object(l["a"])(r,o,n,!1,null,null,null),c=s.exports,u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},d=[],p=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),h=p,f=(a("d4c2"),Object(l["a"])(h,u,d,!1,null,null,null)),m=f.exports;a.d(t,"a",(function(){return m}))},"76ae":function(e,t,a){e.exports=a.p+"static/img/moveCode.7c12c321.png"},9678:function(e,t,a){},9906:function(e,t,a){},a9e3:function(e,t,a){"use strict";var o=a("83ab"),n=a("da84"),i=a("94ca"),r=a("6eeb"),l=a("5135"),s=a("c6b6"),c=a("7156"),u=a("c04e"),d=a("d039"),p=a("7c73"),h=a("241c").f,f=a("06cf").f,m=a("9bf2").f,g=a("58a8").trim,b="Number",v=n[b],y=v.prototype,w=s(p(y))==b,C=function(e){var t,a,o,n,i,r,l,s,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:o=2,n=49;break;case 79:case 111:o=8,n=55;break;default:return+c}for(i=c.slice(2),r=i.length,l=0;l<r;l++)if(s=i.charCodeAt(l),s<48||s>n)return NaN;return parseInt(i,o)}return+c};if(i(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var I,S=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof S&&(w?d((function(){y.valueOf.call(a)})):s(a)!=b)?c(new v(C(t)),a,S):C(t)},x=o?h(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;x.length>_;_++)l(v,I=x[_])&&!l(S,I)&&m(S,I,f(v,I));S.prototype=y,y.constructor=S,r(n,b,S)}},b547:function(e,t,a){},baa5:function(e,t,a){var o=a("23e7"),n=a("e58c");o({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},c2c1:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"screen-mgmt"},[a("biz-flex-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{operations:e.operations,tableData:e.tableData,filters:e.filters,pagination:e.pagination},on:{operate:e.operate,"row-click":e.rowClick,"selection-change":e.handleSelectionChange,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"filter-data-change":e.filterDataChange}},[a("el-table-column",{attrs:{prop:"name",label:"挪车码名称","min-width":"100"}}),a("el-table-column",{attrs:{prop:"shop.name",label:"激活数量/生成数量","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.usedCount)+"/"+e._s(t.row.count)+" ")])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"操作信息","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.operator.name)+" ")]),a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.createDate)+" ")])])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("biz-column-operation",{attrs:{row:t.row}},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.deleteRow(t.row.id)}}},[e._v(" 删除 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.load(t.row)}}},[e._v(" 下载 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.printClick(t.row)}}},[e._v(" 打印 ")])],1)]}}])})],1),a("biz-popup-tabs",{attrs:{open:e.openPopup},on:{close:function(t){e.openPopup=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"baseinfo"}},[a("BaseInfo",{ref:"baseinfo",attrs:{open:e.openPopup,id:e.itemId},on:{created:e.refresh}})],1),e.itemId?a("el-tab-pane",{attrs:{label:"挪车码列表",name:"list"}},[a("MoveCodeList",{ref:"list",attrs:{id:e.itemId,shopId:e.shopId},on:{created:e.refresh}})],1):e._e()],1),a("div",{staticClass:"code-div"},[null!=e.codePicList&&0!=e.codePicList.length?a("ul",{attrs:{id:"codeImgviewer"}},e._l(e.codePicList,(function(e,t){return a("li",{key:t},[a("div",{staticStyle:{"page-break-after":"always"},attrs:{id:"codeimg"+t}},[a("div",{staticStyle:{position:"relative"}},[a("img",{staticClass:"code",staticStyle:{width:"600px",height:"500px"},attrs:{src:e.code}})])])])})),0):e._e()])],1)},n=[],i=(a("99af"),a("d81d"),a("b0c0"),a("a9e3"),a("b85c")),r=a("04d3"),l=a("7132"),s=a("1ab1"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"base-info-move-code"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"130px",size:"small","inline-message":!0}},[a("el-form-item",{attrs:{label:"挪车码名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入挪车码名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"生成数量",prop:"count"}},[a("el-input",{attrs:{disabled:!!e.id,placeholder:"生成数量区间值为0-1000"},model:{value:e.form.count,callback:function(t){e.$set(e.form,"count",e._n(t))},expression:"form.count"}})],1),a("el-form-item",{attrs:{label:"挪车码模版",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:!!e.id},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-option",{attrs:{label:"椭圆形",value:"0"}})],1)],1),a("el-form-item",{attrs:{label:"挪车码效果"}},[a("img",{attrs:{src:e.moveCode,width:"260px"}})]),a("el-form-item",{attrs:{label:"所属运营商",prop:"operator"}},[a("biz-operator-picker",{directives:[{name:"show",rawName:"v-show",value:"shop"!==e.getUser.roleLevel&&!e.id,expression:"getUser.roleLevel!=='shop'&&!id"}],on:{input:e.handleOperatorChange},model:{value:e.allocateModel.operator,callback:function(t){e.$set(e.allocateModel,"operator",t)},expression:"allocateModel.operator"}}),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"shop"!==e.getUser.roleLevel&&e.id,expression:"getUser.roleLevel!=='shop'&&id"}],attrs:{disabled:""},model:{value:e.operatorName,callback:function(t){e.operatorName=t},expression:"operatorName"}}),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"shop"===e.getUser.roleLevel,expression:"getUser.roleLevel==='shop'"}],attrs:{disabled:""},model:{value:e.getUser.compy.name,callback:function(t){e.$set(e.getUser.compy,"name",t)},expression:"getUser.compy.name"}})],1),a("el-form-item",{attrs:{label:"所属店铺",prop:"storeData"}},[a("biz-shop-picker",{directives:[{name:"show",rawName:"v-show",value:"shop"!==e.getUser.roleLevel&&!e.id,expression:"getUser.roleLevel!=='shop'&&!id"}],attrs:{operatorId:e.operatorId,disabled:!!e.id},model:{value:e.allocateModel.storeData.id,callback:function(t){e.$set(e.allocateModel.storeData,"id",t)},expression:"allocateModel.storeData.id"}}),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"shop"!==e.getUser.roleLevel&&e.id,expression:"getUser.roleLevel!=='shop'&&id"}],attrs:{disabled:""},model:{value:e.storeName,callback:function(t){e.storeName=t},expression:"storeName"}}),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"shop"===e.getUser.roleLevel,expression:"getUser.roleLevel==='shop'"}],attrs:{disabled:""},model:{value:e.getUser.shop.name,callback:function(t){e.$set(e.getUser.shop,"name",t)},expression:"getUser.shop.name"}})],1),a("el-form-item",{attrs:{label:"生成时间"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.createDate,callback:function(t){e.$set(e.form,"createDate",t)},expression:"form.createDate"}})],1),a("el-form-item",{attrs:{label:"操作人"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.operator.name,callback:function(t){e.$set(e.form.operator,"name",t)},expression:"form.operator.name"}})],1)],1),a("el-dialog",{staticClass:"biz-import-file__uploading-dialog",attrs:{title:e.title,visible:e.uploadingVisible,"append-to-body":""},on:{"update:visible":function(t){e.uploadingVisible=t},close:e.clearTimeOut}},[a("div",{staticClass:"info"},[a("span",{staticClass:"success"},[e._v("成功生成："+e._s(e.count)+"条")]),a("span",{staticClass:"error"},[e._v("共计："+e._s(e.total)+"条")])]),a("el-progress",{staticClass:"biz-import-file__uploading-dialog__progress",attrs:{"stroke-width":12,percentage:e.percentage}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showCurrentInfo,expression:"showCurrentInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("正在生成："+e._s(e.stepkey))])])],1)],1)},u=[],d=a("5530"),p=a("8330"),h=a("dfef"),f=a("075b"),m=a("f36f"),g=a("2f62"),b=a("76ae"),v=a.n(b),y={name:"BaseInfo",data:function(){var e=this;return{loading:!1,dialogVisibleScreen:!1,moveCode:v.a,open:!1,list:[],operatorName:"",storeName:"",percentage:0,count:0,total:0,stepkey:"",t:"",title:"生成中",importingVisible:!1,uploadingVisible:!1,disabled:!1,showCurrentInfo:!0,operations:[{label:"保存",name:"save",type:"primary"}],allocateModel:this.getDefaultAllocateForm(),form:this.getDefaultModel(),rules:{name:[{required:!0,message:"请输入挪车码名称",trigger:"blur"}],count:[{required:!0,message:"请输入生成数量",trigger:"blur"},{pattern:/^([1-9][0-9]{0,2}|1000)$/,message:"生成数量区间值为0-1000",trigger:"blur"}],type:[{required:!0,message:"请选择挪车码模版",trigger:"blur"}],operator:[{required:!0,validator:function(t,a,o){console.log(e.allocateModel.operator),"shop"===e.getUser.roleLevel||e.id||e.allocateModel.operator&&e.allocateModel.operator.length>0?o():o(new Error("请选择所属运营商"))}}],storeData:[{required:!0,validator:function(t,a,o){"platform"!==e.getUser.roleLevel&&"company"!==e.getUser.roleLevel||e.allocateModel.storeData.id||e.id?o():o(new Error("请选择所属店铺"))}}]}}},components:{BizSaveButton:p["a"],BizGrid:m["a"],BizOperatorPicker:h["a"],BizShopPicker:f["a"]},props:{id:{type:String,default:""}},watch:{id:function(e,t){this.$refs.form.clearValidate(),e?e!==t&&this.query():this.form=this.getDefaultModel()}},created:function(){},computed:Object(d["a"])(Object(d["a"])({},Object(g["c"])(["getUser"])),{},{operatorId:function(){return this.allocateModel.operator&&this.allocateModel.operator.length>0&&""===this.allocateModel.operator[this.allocateModel.operator.length-1]?this.allocateModel.operator[this.allocateModel.operator.length-2]:this.allocateModel.operator&&this.allocateModel.operator.length>0&&""!==this.allocateModel.operator[this.allocateModel.operator.length-1]?this.allocateModel.operator[this.allocateModel.operator.length-1]:this.getUser.compy.id}}),methods:{operate:function(e){this[e]()},clearTimeOut:function(){window.clearTimeout(this.t)},handleImport:function(){if(console.log(this.count),this.count=Math.ceil(this.form.count/50)+this.count,this.count>this.form.count)return this.percentage=100,this.count=this.form.count,this.title="生成完成",void this.clearTimeOut();this.percentage=parseInt(this.count/this.form.count*100),this.t=setTimeout(this.handleImport,1e3)},handleOperatorChange:function(e){this.allocateModel.storeData={id:"",name:""}},getDefaultAllocateForm:function(e){return{ids:e||[],operator:[],storeData:{id:"",name:""}}},getDefaultModel:function(){return{count:"",id:"",type:"0",name:"",state:"0",createDate:"",operator:{name:""}}},setDefaultModel:function(){this.form={count:"",id:"",type:"0",name:"",state:"0",createDate:"",operator:{name:""}}},closed:function(){this.dialogVisibleScreen=!1},play:function(){this.dialogVisibleScreen=!0},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.total=e.form.count,e.id?e.update():e.create()}))},query:function(){var e=this,t={moveCarId:this.id};s["a"].get("/admin/movecar/moveCar.jhtml",t).then((function(t){e.form=Object.assign(e.getDefaultModel(),t.data),e.operatorName=t.data.company.name,e.storeName=t.data.store.name})).catch((function(t){e.$message.warning(t.errorMessage)}))},create:function(){var e=this;this.loading=!0;var t="";this.allocateModel.operator&&this.allocateModel.operator.length>0&&""===this.allocateModel.operator[this.allocateModel.operator.length-1]&&(t=this.allocateModel.operator[this.allocateModel.operator.length-2]),this.allocateModel.operator&&this.allocateModel.operator.length>0&&""!==this.allocateModel.operator[this.allocateModel.operator.length-1]&&(t=this.allocateModel.operator[this.allocateModel.operator.length-1]),s["a"].post("/admin/movecar/moveCar.jhtml",{count:this.form.count,type:"0",state:"0",name:this.form.name,company:"shop"!==this.getUser.roleLevel?{id:t}:{id:this.getUser.compy.id},store:"shop"!==this.getUser.roleLevel?{id:this.allocateModel.storeData.id}:{id:this.getUser.shop.id}}).then((function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("created"),e.uploadingVisible=!0,e.handleImport()})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},update:function(){var e=this;this.loading=!0,s["a"].put("/admin/movecar/moveCar.jhtml",this.form).then((function(t){e.loading=!1,e.$message.success("更新成功"),e.$emit("created")})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}}},w=y,C=(a("12d4"),a("2877")),I=Object(C["a"])(w,c,u,!1,null,null,null),S=I.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"move-code-list"},[a("biz-flex-table",{attrs:{checkable:!1,operations:e.operations,filters:e.filters,loading:e.loading,tableData:e.tableData,pagination:e.pagination},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{label:"挪车码",prop:"code"}}),a("el-table-column",{attrs:{label:"URL",prop:"path"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getUrl(t.row.path))+" ")]}}])}),a("el-table-column",{attrs:{label:"状态",prop:"active"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("0"===t.row.active?"未激活":"已激活")+" ")]}}])}),a("el-table-column",{attrs:{label:"会员",prop:"memberData.name"}})],1)],1)},_=[],M=(a("baa5"),a("ac1f"),a("1276"),{name:"MoveCodeList",data:function(){return{orderProperty:"",orderDirection:"",loading:!1,operations:[],filters:[{type:"select",label:"状态",value:"",options:[{label:"全部",value:""},{label:"未激活",value:"0"},{label:"已激活",value:"1"}]}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},tableData:[]}},components:{BizFlexTable:r["c"]},methods:{operate:function(e){this[e]()},getUrl:function(e){var t=e.substring(e.lastIndexOf("/")+1,e.length).split(".")[0];return console.log(t),document.location.protocol+"//"+window.location.host+"/vfuhuizhong/html/wxqrcode.html?type=5&id="+t+"&shopId="+this.shopId},filterDataChange:function(e){this.filters=e,this.pagination.currentPage=1,this.refresh()},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},refresh:function(){var e=this,t={pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,moveCarId:this.id||"",state:this.filters[0].value||""};this.loading=!0,s["a"].get("/admin/movecar/moveCarCodes.jhtml",t).then((function(t){e.loading=!1,e.tableData=t.dataList,e.pagination.total=Number(t.total)})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t)}))},showMessage:function(e,t){this.$message({showClose:!0,message:e,type:t})}},computed:Object(d["a"])({},Object(g["c"])(["getUser"])),created:function(){},mounted:function(){this.refresh()},props:{id:{type:String,default:""},shopId:{type:String,default:""}},watch:{id:function(e,t){e&&e!==t&&(this.filters[0].value="",this.refresh())}}}),D=M,k=(a("fa8f"),Object(C["a"])(D,x,_,!1,null,null,null)),z=k.exports,$=a("c81d"),L=a.n($),N=a("443b"),O={name:"WechatUrlMgmt",data:function(){return{loading:!1,openPopup:!1,itemId:"",shopId:"",moveCodeBg:L.a,tabName:"baseinfo",codePicList:[],multipleSelection:[],filters:[{type:"select",label:"所属店铺",name:"searchValue",filterable:!0,value:"",options:[]},{type:"input",label:"",placeholder:"请输入挪车码名称",name:"searchValue",value:""}],operations:[{label:"添加",name:"add",type:"primary"},{disabled:!0,label:"删除",name:"deleteList",type:""},{label:"刷新",name:"refresh",type:""}],tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizFlexTable:r["c"],BaseInfo:S,BizPopupTabs:l["a"],MoveCodeList:z},mixins:[N["a"]],created:function(){this.refresh(),this.getShop()},mounted:function(){},methods:{operate:function(e){this[e]()},refresh:function(){this.openPopup=!1,this.getList()},load:function(e){if(e.range){var t=document.location.protocol+"//"+window.location.host+"/vfuhuizhong/html/wxqrcode.html?type=5&id="+e.store.id+"XXXXXXXXXX&shopId="+e.store.id+"               XXXXXXXXXX范围："+e.range;this.downLoad(e.name,t),this.updateState(e)}else this.$message.warning("挪车码正在生成中，请稍候下载")},downLoad:function(e,t){var a=document.createElement("a");if(a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),a.setAttribute("download",e),document.createEvent){var o=document.createEvent("MouseEvents");o.initEvent("click",!0,!0),a.dispatchEvent(o)}else a.click()},getShop:function(){var e=this;s["a"].get("/admin/store/pullDownShops.jhtml",{}).then((function(t){e.filters[0].options=[{label:"全部",value:""}].concat(t.shops.map((function(e){return{label:e.name,value:e.id}})))})).catch((function(t){e.$message.warning(t.errorMessage)}))},getList:function(){var e=this;this.loading=!0;var t={shopId:this.filters[0].value||window.top.SHOP_ID||"",searchValue:this.filters[1].value,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};s["a"].get("/admin/movecar/moveCars.jhtml",t).then((function(t){e.loading=!1,e.tableData=t.dataList,e.pagination.total=Number(t.total)})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},updateState:function(e){var t=this,a={count:e.count,id:e.id,type:e.type,name:e.name,state:"1",createDate:e.createDate,store:{id:e.store.id},company:{id:e.company.id}};s["a"].put("/admin/movecar/moveCar.jhtml",a).then((function(e){t.loading=!1})).catch((function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},deleteList:function(){var e,t=[],a=Object(i["a"])(this.multipleSelection);try{for(a.s();!(e=a.n()).done;){var o=e.value;t.push(o.id)}}catch(n){a.e(n)}finally{a.f()}this.delete(t)},deleteRow:function(e){var t=[];t.push(e),this.delete(t)},delete:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={ids:e};s["a"].delete("/admin/movecar/moveCar.jhtml",a).then((function(e){t.$message.success("删除成功"),t.refresh()})).catch((function(e){t.$message.warning(e.errorMessage)}))})).catch((function(){}))},add:function(){this.tabName="baseinfo",this.itemId="",this.openPopup=!0,this.$refs.baseinfo.setDefaultModel()},handleSelectionChange:function(e){this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1),this.multipleSelection=e},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},rowClick:function(e){this.openPopup=!0,this.itemId=e.id,this.shopId=e.store.id},filterDataChange:function(e){this.pagination.currentPage=1,this.getList()},printClick:function(e){var t=this;this.$confirm("确定打印"+e.count+"个挪车码吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={pageSize:1e3,pageNumber:1,moveCarId:e.id||""};t.loading=!0,s["a"].get("/admin/movecar/moveCarCodes.jhtml",a).then((function(a){if(t.loading=!1,t.codePicList=[],a.dataList.map((function(e){t.codePicList.push({moveCodeBg:t.moveCodeBg,code:e.path})})),null!==t.codePicList&&0!==t.codePicList.length){for(var o=window.open(""),n=0;n<t.codePicList.length;n++){var i=document.getElementById("codeimg"+n);o.document.write(i.outerHTML)}o.document.close(),o.focus(),setTimeout((function(){o.print(),o.close()}),100),t.updateState(e)}})).catch((function(e){t.loading=!1,t.$message.warning(e.errorMessage||"操作出现错误","warning"),console.log("ERR_REFRESH: ",e)}))}))}}},P=O,U=(a("f183b"),Object(C["a"])(P,o,n,!1,null,null,null));t["default"]=U.exports},c81d:function(e,t,a){e.exports=a.p+"static/img/moveCodeBg.7d375f75.png"},d4c2:function(e,t,a){"use strict";var o=a("e725"),n=a.n(o);n.a},dfef:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-operator-picker"},[e._l(e.innerValue,(function(t,o){return[a("el-select",{key:o,staticClass:"operator-item",staticStyle:{width:"100%"},attrs:{value:e.innerValue[o],disabled:e.disabled,placeholder:"请选择"},on:{input:function(t){return e.handleInput(t,o)}}},e._l(e.operatorList[o],(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}))],2)},n=[],i=(a("99af"),a("fb6a"),a("a434"),a("239a")),r={name:"BizOperatorPicker",components:{},model:{prop:"value",event:"input"},data:function(){return{innerValue:[""],operatorList:[],operatorMap:{root:{}},props:{label:"name",value:"id",children:"children"}}},props:{value:{type:Array},disabled:{type:Boolean}},methods:{queryOperators:function(){this.doQuery("",0);for(var e=0;e<this.innerValue.length;e++)this.doQuery(this.innerValue[e],e+1)},doQuery:function(e,t){var a=this;(e||0===t)&&i["a"].queryOperators({parentId:e},(function(e){var o=e.content;o.length>0&&(a.operatorList.splice(t,1,o),a.operatorList.length>a.innerValue.length&&(a.innerValue.push(""),a.$emit("input",a.innerValue)))}),(function(e){console.log(e),console.log("code错误")}))},handleInput:function(e,t){var a=[];a=a.concat(this.innerValue.slice(0,t)),a=a.concat([e]),this.$emit("input",a)}},watch:{value:function(e,t){e&&0!==e.length?(this.innerValue=e,this.operatorList=new Array(e.length),this.queryOperators()):this.$emit("input",[""])}},created:function(){this.queryOperators()}},l=r,s=(a("f307"),a("2877")),c=Object(s["a"])(l,o,n,!1,null,null,null),u=c.exports;a.d(t,"a",(function(){return u}))},e58c:function(e,t,a){"use strict";var o=a("fc6a"),n=a("a691"),i=a("50c4"),r=a("a640"),l=a("ae40"),s=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,d=r("lastIndexOf"),p=l("indexOf",{ACCESSORS:!0,1:0}),h=u||!d||!p;e.exports=h?function(e){if(u)return c.apply(this,arguments)||0;var t=o(this),a=i(t.length),r=a-1;for(arguments.length>1&&(r=s(r,n(arguments[1]))),r<0&&(r=a+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:c},e725:function(e,t,a){},ec6b:function(e,t,a){"use strict";var o=a("b547"),n=a.n(o);n.a},f183b:function(e,t,a){"use strict";var o=a("2ba4"),n=a.n(o);n.a},f307:function(e,t,a){"use strict";var o=a("9906"),n=a.n(o);n.a},fa8f:function(e,t,a){"use strict";var o=a("460f"),n=a.n(o);n.a}}]);