(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32f84450"],{1148:function(e,t,r){"use strict";var s=r("a691"),i=r("1d80");e.exports="".repeat||function(e){var t=String(i(this)),r="",n=s(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r}},"118c":function(e,t,r){},"225d":function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{directives:[{name:"show",rawName:"v-show",value:e.tableShow,expression:"tableShow"}],ref:"template"},[e._t("default",[r("span",[e._v("编写你自己的打印区域组件，然后slot插入到vue-easy-print")])],{getChineseNumber:e.getChineseNumber})],2),e.buttonShow?r("button",{class:e.buttonClass,attrs:{type:"button"},on:{click:e.print}},[r("span",[e._v("开始打印")])]):e._e()])},i=[],n=(r("a9e3"),r("d3b7"),r("ac1f"),r("25f0"),r("466d"),r("5319"),r("1276"),{name:"vue-easy-print",components:{},props:{spaceRow:{type:Boolean,default:!1},tableData:{type:Object,default:function(){}},tableShow:{type:Boolean,default:!1},buttonShow:{type:Boolean,default:!1},buttonClass:{type:String,default:"el-button el-button--default"},onePageRow:{type:Number,default:5},beforeCopy:Function,beforePrint:Function},data:function(){return{}},mounted:function(){this.init()},methods:{init:function(){var e=this,t=document.getElementById("easyPrintIframe");t?this.getStyle():(t=document.createElement("iframe"),t.id="easyPrintIframe",t.style.position="fixed",t.style.width="0",t.style.height="0",t.style.top="-100px",window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)&&(t.src='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";<\/script></head><body></body>")'),t.onload=function(){e.getStyle()},document.body.appendChild(t))},print:function(){"function"===typeof this.beforeCopy&&this.beforeCopy();var e=document.getElementById("easyPrintIframe");e.contentDocument.body.innerHTML=this.$refs.template.innerHTML,"function"===typeof this.beforePrint&&this.beforePrint(),setTimeout((function(){e.contentWindow.print()}),100)},getStyle:function(){for(var e=document.getElementById("easyPrintIframe"),t="",r=document.querySelectorAll("style"),s=0;s<r.length;s++)t+=r[s].outerHTML;e.contentDocument.head.innerHTML=t;for(var i=document.querySelectorAll("link"),n=0;n<i.length;n++){var o=document.createElement("link");o.setAttribute("rel","stylesheet"),i[n].type?o.setAttribute("type",i[n].type):o.setAttribute("type","text/css"),o.setAttribute("href",i[n].href),o.setAttribute("media","all"),e.contentDocument.head.appendChild(o)}},getChineseNumber:function(e){var t,r,s,i,n,o,a,c,d,l,p,u,f,m,h=99999999999.99,g="零",v="壹",y="贰",b="叁",I="肆",_="伍",w="陆",S="柒",O="捌",M="玖",C="拾",T="佰",k="仟",R="万",A="亿",x="",j="元",L="角",N="分",P="整";if(void 0===e)return"";if(e=e.toString(),""==e)return"";if(null!=e.match(/[^,.\d]/))return"";if(null==e.match(/^((\d{1,3}(,\d{3})*(.((\d{3},)*\d{1,3}))?)|(\d+(.\d+)?))$/))return"";if(e=e.replace(/,/g,""),e=e.replace(/^0+/,""),Number(e)>h)return alert("您输入的金额太大，请重新输入!"),"";if(i=e.split("."),i.length>1?(t=i[0],r=i[1],r=r.substr(0,2)):(t=i[0],r=""),n=new Array(g,v,y,b,I,_,w,S,O,M),o=new Array("",C,T,k),a=new Array("",R,A),c=new Array(L,N),s="",Number(t)>0){for(d=0,l=0;l<t.length;l++)p=t.length-l-1,u=t.substr(l,1),f=p/4,m=p%4,"0"==u?d++:(d>0&&(s+=n[0]),d=0,s+=n[Number(u)]+o[m]),0==m&&d<4&&(s+=a[f]);s+=j}if(""!=r)for(l=0;l<r.length;l++)u=r.substr(l,1),"0"!=u&&(s+=n[Number(u)]+c[l]);return""==s&&(s=g+j),""==r&&(s+=P),s=x+s,s}}}),o=n,a=r("2877"),c=Object(a["a"])(o,s,i,!1,null,null,null),d=c.exports;t["a"]=d},2497:function(e,t,r){"use strict";var s=r("4360"),i=r("a18c");t["a"]=function(e,t){return function(r){var n=r.data;"100"===n.resultCode?e(n):"709"===n.resultCode?(s["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",s["a"].getters.currentUser),i["a"].push("/login")):t(n)}}},"2ee5":function(e,t,r){},3101:function(e,t,r){"use strict";var s=r("7ba1"),i=r.n(s);i.a},"408a":function(e,t,r){var s=r("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=s(e))throw TypeError("Incorrect invocation");return+e}},4382:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"logistic-following"},[r("div",{staticClass:"product-info"},[r("div",{staticClass:"img"},[r("img",{attrs:{src:e.image||e.defaultProductImg}})]),r("div",{staticClass:"info"},[r("div",{staticClass:"i-item"},[e._v("物流状态： "),r("span",{staticClass:"l-state"},[e._v(e._s(e.logisticState))])]),r("div",{staticClass:"i-item"},[e._v("物流公司："+e._s(e.logistics))]),r("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]),e.shippingTraces&&e.shippingTraces.length>0?r("div",{staticClass:"logistic-info"},[r("div",{staticClass:"track-list"},[r("ul",e._l(e.shippingTraces,(function(t){return r("li",{key:t.id},[r("i",{staticClass:"node-icon"}),r("span",{staticClass:"txt"},[e._v(e._s(t.station))]),r("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0)])]):e._e()])},i=[],n=r("5530"),o=r("2f62"),a=r("1ab1"),c=r("c596"),d=r("e83a"),l=r.n(d),p={name:"LogisticsFollowing",components:{},data:function(){return{shippingSn:"",defaultProductImg:l.a,shippingTraces:[],state:"",logistics:"",expressSn:"",image:""}},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(o["c"])(["getUser"])),Object(o["c"])("Order",["curApplySaleItem","orderInfo"])),{},{logisticState:function(){switch(this.state){case"0":return"无轨迹";case"1":return"已揽收";case"2":return"在途中";case"201":return"到达派件城市";case"3":return"签收";case"4":return"问题件";default:return""}}}),props:{sn:{type:String,default:""}},watch:{},created:function(){},methods:{getLogisticsInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.sn};a["a"].get(c["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.state=t.shipping.state,e.image=t.shipping.shippingItems.length>0?t.shipping.shippingItems[0].image:"",e.logistics=t.shipping.logistics,e.expressSn=t.shipping.expressSn,e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}},u=p,f=(r("b15b"),r("2877")),m=Object(f["a"])(u,s,i,!1,null,null,null);t["a"]=m.exports},"517a":function(e,t,r){e.exports=r.p+"static/img/pic_default_fail_100.b6b0849d.png"},"53c9":function(e,t,r){"use strict";var s=r("990e"),i=r.n(s);i.a},"562c":function(e,t,r){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var s=r("1d80"),i=r("5899"),n="["+i+"]",o=RegExp("^"+n+n+"*"),a=RegExp(n+n+"*$"),c=function(e){return function(t){var r=String(s(t));return 1&e&&(r=r.replace(o,"")),2&e&&(r=r.replace(a,"")),r}};e.exports={start:c(1),end:c(2),trim:c(3)}},"5b8e":function(e,t,r){"use strict";var s=r("9678"),i=r.n(s);i.a},"5eb4":function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("biz-grid",{staticClass:"order-info"},[r("div",{staticClass:"order-info-div"},[r("div",{staticClass:"order-info-content"},[r("div",{staticClass:"order-top-content"},[r("div",{staticClass:"order-follow-up",on:{click:e.onOrderTrack}},[r("span",[e._v("订单跟踪")]),r("div",{staticClass:"order-state"},[r("span",[e._v(e._s(e.getOrderPaymentState))]),r("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]),e.orderInfo.consignee?r("div",{staticClass:"receiver-info"},[r("span",[e._v(e._s(e.orderInfo.consignee))]),r("span",[e._v(e._s(e.orderInfo.phone))]),r("p",[r("i",{staticClass:"el-icon-location-outline",staticStyle:{"margin-right":"5px"}}),e._v(" "+e._s(e.orderInfo.areaName?e.orderInfo.areaName+e.orderInfo.address:e.orderInfo.address)+" ")])]):e._e(),e.orderInfo.appointmentEndDate?r("div",{staticClass:"order-num"},[r("span",[e._v("到店时间：")]),r("span",[e._v(e._s(e.orderInfo.appointmentDate)+"-"+e._s(e.orderInfo.appointmentEndDate.slice(11,20)))])]):e._e(),"6"===e.orderInfo.orderType?r("div",{staticClass:"buy-car"},[r("div",{staticClass:"buy-car-detail"},[r("span",[e._v("心仪车型")]),r("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),r("div",{staticClass:"buy-car-detail"},[r("span",[e._v("已有车型")]),r("span",[e._v(e._s(e.orderInfo?e.orderInfo.orderItems[0].appointment.car.type:""))])])]):e._e(),"7"===e.orderInfo.orderType?r("div",{staticClass:"buy-car"},[r("div",{staticClass:"buy-car-detail"},[r("span",[e._v("心仪车型")]),r("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),r("div",{staticClass:"buy-car-detail"},[r("span",[e._v("裸车价格")]),r("span",[e._v("￥"+e._s(e.orderInfo.orderItems[0].appointment.product.price))])]),r("div",{staticClass:"buy-car-detail"},[r("span",{staticStyle:{"white-space":"nowrap"}},[e._v("首付"+e._s(e.getDownPayment))]),r("span",[e._v("￥"+e._s(e.getInitPay))])]),r("div",{staticClass:"buy-car-detail"},[r("span",[e._v("月供")]),r("span",[e._v("￥"+e._s(e.getMonthPaidNum))])])]):e._e(),"8"===e.orderInfo.orderType?r("div",{staticClass:"buy-car"},[r("div",{staticClass:"buy-car-detail"},[r("span",[e._v("试驾车型")]),r("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),r("div",{staticClass:"buy-car-detail"},[r("span",[e._v("预约时间")]),r("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.appontmentDate.slice(0,10):""))])])]):e._e(),e.orderInfo.invoiceTitle?r("div",{staticClass:"order-follow-up",on:{click:e.selectInvoice}},[r("span",[e._v("发票抬头")]),r("div",{staticClass:"order-state",staticStyle:{color:"#808080"}},[r("span",[e._v(e._s(e.orderInfo.invoiceTitle?e.orderInfo.invoiceTitle:"无"))]),r("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]):e._e()]),r("div",{staticClass:"order-info-new"},[r("div",{staticClass:"shop-name",on:{click:e.goShop}},[r("img",{attrs:{src:e.iconShop}}),r("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(e.orderInfo.shop?e.orderInfo.shop.name:""))])]),e._l(e.orderInfo.orderItems,(function(t,s){return r("div",{key:s},[r("div",{staticClass:"good-info",on:{click:function(r){return e.onClickProduct(t)}}},[r("div",{staticClass:"goods-img"},[r("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:t.thumbnail&&t.thumbnail.indexOf("/")>=0?t.thumbnail:e.defaultImg},on:{error:function(t){return e.imgError(s)}}})]),r("div",{staticClass:"good-right"},[r("div",{staticClass:"good-name"},[r("span",{staticStyle:{flex:"1"}},[e._v(e._s(t.fullName))]),e.showRefund[s]?r("div",{staticClass:"btn-group-div"},[r("div",{staticClass:"btn-group"},[e.showRefund[s]?r("span",{staticClass:"btn-good-pay",on:{click:function(r){return r.stopPropagation(),e.onRefund(t)}}},[e._v(e._s(e.refundsLabel[s]))]):e._e()])]):e._e()]),r("div",{staticStyle:{"margin-bottom":"10px"}},[t.product.barCode?r("span",{staticStyle:{"font-size":"14px","margin-right":"10px"}},[e._v(e._s(t.product.barCode))]):e._e(),r("span",{staticStyle:{"font-size":"14px"}},[e._v("最小包装数："+e._s(t.product.minimumPackQuantity))])]),r("div",{staticClass:"good-price"},[r("span",[e._v("￥"+e._s(t.price))]),r("span",[e._v("X"+e._s(t.quantity))])])])])])})),"1"!==e.orderInfo.isSubscription||e.activity.activityId?e._e():r("div",{staticClass:"subscription"},[r("p",[e._v(" 阶段1：订金￥"+e._s(e.orderInfo.amountPrepay)+" "),r("span",{class:{tips:parseFloat(e.orderInfo.amountPaid)<=0}},[e._v(e._s(parseFloat(e.orderInfo.amountPaid)>0?"已支付":"未支付"))])]),r("p",[e._v(" 阶段2：尾款￥"+e._s(e.orderInfo.amountFinalpay)+" "),r("span",{class:{tips:0!==parseFloat(e.orderInfo.amountPayable)}},[e._v(e._s(0===parseFloat(e.orderInfo.amountPayable)?"已支付":"未支付"))])])])],2),r("div",{staticClass:"price-info-content"},[r("div",{staticClass:"total-price"},[r("span",[e._v("产品总额")]),r("span",[e._v("￥"+e._s(e.getAmount))])]),r("div",{staticClass:"total-price"},[r("span",[e._v("邮费")]),r("span",[e._v("+ ￥"+e._s(e.orderInfo.freight))])]),parseFloat(e.orderInfo.couponDiscount)>0?r("div",{staticClass:"total-price"},[r("span",[e._v("优惠")]),r("span",[e._v("- ￥"+e._s(e.orderInfo.couponDiscount))])]):e._e(),parseFloat(e.getOffsetAmount)>0?r("div",{staticClass:"total-price"},[r("span",[e._v("商家调整")]),r("span",[e._v(e._s(e.getOffsetAmount))])]):e._e(),"1"===e.orderInfo.type?r("div",{staticClass:"total-price"},[r("span",[e._v("需付款")]),r("span",{staticClass:"color"},[e._v("￥"+e._s(e.orderInfo.amountPayable))])]):r("div",{staticClass:"total-price"},[r("span",[e._v("已付款")]),r("span",{staticClass:"color"},[e._v("￥"+e._s(e.orderInfo.amountPaid))])])]),r("div",{staticClass:"pay-type"},[r("span",[e._v("订单编号："+e._s(e.orderInfo.sn))]),e.orderInfo.paymentMethodName?r("span",[e._v("支付方式："+e._s(e.orderInfo.paymentMethodName))]):e._e(),e.orderInfo.shippingMethodName?r("span",[e._v("配送方式："+e._s(e.orderInfo.shippingMethodName))]):e._e(),e.orderInfo.memo?r("div",{staticClass:"message"},[r("span",{staticClass:"label"},[e._v("买家留言：")]),r("span",{staticClass:"buy-message",staticStyle:{"margin-left":"-3px"}},[e._v(e._s(e.orderInfo.memo))])]):e._e(),r("span",[e._v("下单时间："+e._s(e.orderInfo.orderTime))]),e.orderInfo.payments&&e.orderInfo.payments.length?r("span",[e._v("付款时间："+e._s(e.orderInfo.payments[0].paymentDate))]):e._e()])]),r("div",{staticClass:"order-bottom"},[r("div",{staticClass:"btn-group"})])]),r("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},[e.showLogistics?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onLookLogistics(e.orderInfo.shippings?e.orderInfo.shippings[0].sn:"")}}},[e._v("物流跟踪")]):e._e(),"4"===e.orderInfo.state&&"0"===e.orderInfo.shippingWay||"3"===e.orderInfo.state&&"1"===e.orderInfo.shippingWay?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.confirmOrder(e.orderInfo)}}},[e._v("确认收货")]):e._e(),"5"===e.orderInfo.state?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onReview(e.orderInfo.id,e.orderInfo.state)}}},[e._v("立即评价")]):e._e(),e.showLookEvaluate?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onLookEvaluate(e.orderInfo.id,e.orderInfo.state)}}},[e._v("查看评价")]):e._e()],1),e.isPend?r("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},["1"===e.orderInfo.state&&("1"===e.orderInfo.auditState&&"1"===e.orderInfo.audit||"2"===e.orderInfo.auditState&&"1"===e.orderInfo.audit)?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.toPass(e.orderInfo)}}},[e._v("审核")]):e._e()],1):e._e(),r("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(t){e.showPassOrder=t}}},[r("div",[r("div",{staticClass:"reson-container"},[r("span",[e._v("审核结果：")]),r("el-radio",{attrs:{label:"1",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("通过")]),r("el-radio",{attrs:{label:"2",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("驳回")]),r("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[r("span",[e._v("驳回理由：")]),r("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:e.curSelectAjectReason,callback:function(t){e.curSelectAjectReason=t},expression:"curSelectAjectReason"}},e._l(e.reasonAjectList,(function(e){return r("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),r("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showPassOrder=!1}}},[e._v("取消")]),r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange(e.row,e.auditState)}}},[e._v("确定")])],1)]),r("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[r("my-invoice",{ref:"invoice"})],1),r("el-dialog",{attrs:{visible:e.dialogVisiableLog,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableLog=t}}},[r("order-track",{ref:"log"})],1),r("el-dialog",{attrs:{visible:e.dialogApplaySale,title:"售后",center:"","append-to-body":""},on:{"update:visible":function(t){e.dialogApplaySale=t}}},[r("apply-sale",{ref:"applysale",attrs:{isEditable:e.isEditable,itemId:e.orderItemId,dialogApplaySale:e.dialogApplaySale},on:{operationSuccess:e.operationSuccess}})],1),r("el-dialog",{attrs:{visible:e.dialogApplayRefundInfo,"append-to-body":""},on:{"update:visible":function(t){e.dialogApplayRefundInfo=t}}},[r("refund-info",{attrs:{itemId:e.itemId,dialogApplayRefundInfo:e.dialogApplayRefundInfo},on:{operationSuccess:e.operationSuccess,applySaleHanlder:e.applySaleHanlder}})],1)],1)},i=[],n=(r("a9e3"),r("b680"),r("d3b7"),r("ac1f"),r("5319"),r("5530")),o=r("f36f"),a=r("2f62"),c=r("1ab1"),d=r("c596"),l=r("e83a"),p=r.n(l),u=r("517a"),f=r.n(u),m=r("f606"),h=r.n(m),g=r("ce09"),v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order-track"},[r("el-steps",{attrs:{direction:"vertical",space:"auto"}},[r("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[r("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?r("div",{key:t.id},[r("p",[e._v("待商家确认")]),r("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?r("div",{key:t.id},[r("p",[e._v("商家已确认")]),r("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"AuditPassed"===t.type?r("div",{key:t.id},[r("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),r("span",[e._v("审核者："+e._s(t.operator))]),r("p",[e._v(e._s(t.createTime))])]):e._e()}))],2)]),r("el-step",{attrs:{title:"付款",status:"2"===e.active?"finish":"wait "}},[r("div",{attrs:{slot:"description"},slot:"description"},[e.payments.length>0?r("div",[r("p",[e._v("支付方式："+e._s(e.paymentMethod))]),r("p",[e._v("付款方式："+e._s(e.paymentType))]),e._l(e.payments,(function(t){return r("div",{key:t.id},[r("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),r("span",[e._v(e._s("0"===t.paymentStatus?"未支付":"1"===t.paymentStatus?"部分支付":"已支付"))]),r("p",[e._v(e._s(t.paymentDate))]),r("p",[e._v("付款金额：￥"+e._s(t.amount))]),r("p",[e._v("交易号："+e._s(t.sn))])])}))],2):e._e()])]),r("el-step",{attrs:{title:"执行",status:"3"===e.active?"finish":"wait "}},[r("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?r("div",[r("div",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),r("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),r("div",[e.cbp_tmlabel?r("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[r("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),r("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,s){return r("div",{key:s},["6"===t.state?r("div",[r("p",[e._v("自动派单")]),t.refuseRecord?r("div",[r("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason))])]):e._e(),t.refuseRecord?r("div",[r("p",{staticStyle:{color:"#c60007"}},[e._v("自动派单")])]):e._e()]):e._e(),"7"===t.state?r("div",[e._v(" 任务发给 "),t.dispatchRecord?r("div",[e._v("用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile))]):e._e(),t.dispatchRecord?r("div",[e._v(e._s(t.dispatchRecord.createDate))]):e._e(),t.refuseRecord?r("div",[e._v(e._s(t.refuseRecord.reason))]):e._e()]):e._e(),"5"===t.state?r("div",[e._v(" 已拒绝 "),t.refuseRecord?r("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks))]):e._e()]):e._e(),"1"===t.state?r("div",[t.member?r("p",[e._v(e._s(t.member.nickname)+"已出发")]):e._e(),r("p",[e._v(e._s(t.location))]),r("p",[e._v(e._s(t.happenDate))])]):e._e(),"2"===t.state?r("div",[t.member?r("p",[e._v(e._s(t.member.nickname)+"已到达")]):e._e(),r("p",[e._v(e._s(t.location))]),r("p",[e._v(e._s(t.happenDate))])]):e._e(),"3"===t.state?r("div",[r("p",[e._v("完成救援任务")]),r("p",[e._v(e._s(t.happenDate))])]):e._e(),"4"===t.state?r("div",[r("p",[e._v("取消救援任务")]),r("p",[e._v(e._s(t.happenDate))])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?r("div",{key:t.id},[r("p",[e._v("订单已执行")]),r("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.shippings,(function(t){return e.shippings&&e.shippings.length>0?r("div",{key:t.id},["1"===t.shippingStatus?r("p",[e._v("订单已部分发货")]):e._e(),"1"!==t.shippingStatus?r("p",[e._v("订单已执行")]):e._e(),r("p",[e._v(e._s(t.shippingDate))]),r("p",[e._v("物流公司："+e._s(t.logistics))]),r("p",[e._v("物流单号："+e._s(t.expressSn))]),r("p",[e._v(" 收货人："+e._s(t.consignee)+" "),r("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")]),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(r){return e.certificate(t.id)}}},[e._v("凭证")])],1),e._l(t.shippingItems,(function(t,s){return r("p",{key:s},[e._v(e._s(t.name)+"*"+e._s(t.quantity))])})),e.devProcessShippings&&e.devProcessShippings.shippingTraces?r("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.devProcessShippings.shippingTraces,(function(t,s){return r("div",{key:s,staticClass:"shippingTrace"},[r("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),r("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.devProcessShippings.shippingTraces.length?r("div",{style:e.styleObject}):e._e()],2):e._e()],2):e._e()}))],2)]),r("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[r("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?r("div",{key:t.id},[r("p",[e._v("交易完成")]),r("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]),e.isReview?r("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[r("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?r("div",{key:t.id},[r("p",[e._v("买家已评价")]),e._l(e.reviews,(function(t,s){return r("div",{key:s},["0"===t.reviewType?r("div",[r("p",[e._v(e._s(t.happenDate))]),r("p",[e._v("商品："+e._s(t.product.name))]),r("p",[e._v("评分："+e._s(t.score)+"分")]),r("p",[e._v("评语："+e._s(t.content))]),e._l(t.images,(function(t,s){return r("div",{key:s,staticStyle:{display:"inline"}},[r("img",{attrs:{src:t,width:"50"},on:{click:function(r){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?r("div",[r("p",[e._v("店铺评分")]),r("p",[e._v("服务态度："+e._s(t.serviceAttitude)+"分")]),r("p",[e._v("服务速度："+e._s(t.serviceSpeed)+"分")]),r("p",[e._v("专业技能："+e._s(t.professional)+"分")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?r("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[r("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?r("div",{key:t.id},[r("p",[e._v("订单已关闭")]),r("p",[e._v("关闭理由："+e._s(t.content))]),r("p",[e._v("备注："+e._s(t.memo))]),r("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]):e._e()],1),r("el-dialog",{attrs:{title:"",visible:e.outerVisible,"append-to-body":""},on:{"update:visible":function(t){e.outerVisible=t}}},[r("img",{attrs:{src:e.larImg,width:"100%"}})]),r("el-dialog",{attrs:{visible:e.dialogShipping,center:"",width:"1200px","append-to-body":"","custom-class":"printDialog"},on:{"update:visible":function(t){e.dialogShipping=t}}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),r("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[r("div",{staticClass:"d-p-wrap"},[r("el-row",{staticClass:"row",attrs:{gutter:10}},[r("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),r("el-row",{staticClass:"row",attrs:{gutter:10}},[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),r("el-row",{staticClass:"row-top",attrs:{gutter:10}},[r("el-col",{attrs:{span:14}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),r("el-col",{attrs:{span:10}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("订单状态："+e._s("1"===e.shippingsPrint.shippingStatus?"订单已部分发货":"订单已执行"))])])],1),r("el-row",{staticClass:"row",attrs:{gutter:10}},[r("el-col",{attrs:{span:14}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("发货时间："+e._s(e.shippingsPrint.shippingDate?e.shippingsPrint.shippingDate.split(" ")[0]:""))])])],1),r("el-row",{staticClass:"row",attrs:{gutter:10}},[r("el-col",{attrs:{span:14}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.shippingsPrint.logistics))])]),r("el-col",{attrs:{span:10}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shippingsPrint.expressSn))])])],1),r("el-row",{staticClass:"row",attrs:{gutter:10}},[r("el-col",{attrs:{span:14}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("物流费用："+e._s(e.shippingsPrint.freight))])])],1),r("el-row",{staticClass:"row",attrs:{gutter:10}},[r("el-col",{attrs:{span:14}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingsPrint.consignee))])]),r("el-col",{attrs:{span:10}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingsPrint.phone))])])],1),r("el-row",{staticClass:"row",attrs:{gutter:10}},[r("el-col",{attrs:{span:14}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("收货地址："+e._s(e.shippingsPrint.address))])])],1),r("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[r("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?r("div",[e._v("合计")]):r("div",[e._v(e._s(t.$index+1))])]}}])}),r("el-table-column",{attrs:{property:"name",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),r("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),r("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),r("el-table-column",{attrs:{property:"quantity",label:"数量"}}),r("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),r("el-row",{staticClass:"row",attrs:{gutter:10}},[r("el-col",{attrs:{span:18}},[r("div",{staticClass:"grid18"})]),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1)],1)},y=[],b=(r("4160"),r("b0c0"),r("3ca3"),r("466d"),r("1276"),r("159b"),r("ddb0"),r("2b3d"),r("96cf"),r("1da1")),I=r("225d"),_=r("e42c"),w=r("f260"),S=r.n(w),O=r("bc3a"),M=r.n(O),C={name:"order-track",data:function(){return{orderItems:[],loading:!1,open:!1,outerVisible:!1,active:"",larImg:"",orderLogs:[],reviews:[],shippings:[],devProcessShippings:"",payments:[],dialogShipping:!1,form:{},title:"",gridData:[],shippingsPrint:"",memberRescueStates:[],paymentMethodNameReal:"",type:"",amount:"",amountpaid:"",paymentType:"",paymentMethod:"",latestMemberRescueState:"",workers:[],sn:"",consignee:"",fee:"",shippingId:"",operator:"",trackingNo:"",deliveryCorp:"",orderId:"",workerId:"",dispathButton:!1,redispathButton:!1,cbp_tmlabel:!1,imgStyle:"",imageValue:"",currentState:"",preState:"",create:!1,cancel:!1,confirm:!1,service:!1,shipping:!1,payment:!1,complete:!1,review:!1,isCreate:!1,isConfirm:!1,isService:!1,isPayment:!1,isComplete:!1,isReview:!1,isCancel:!1}},props:{},components:{vueEasyPrint:I["a"]},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(a["c"])(["getUser"])),Object(a["c"])("Order",["orderInfo"])),{},{styleObject:function(){return{height:"200px",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+S.a+") 50% 50% / 200px no-repeat"}}}),watch:{},methods:Object(n["a"])(Object(n["a"])({},Object(a["d"])("Order",["updateLucidLogs"])),{},{devProcess:function(){"新悦物流"===this.deliveryCorp&&this.$emit("logistics",this.orderItems[0].product.vins[0].number),"block"===this.$refs.devProcess[0].style.display?this.$refs.devProcess[0].style.display="none":this.$refs.devProcess[0].style.display="block"},print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var r,s,i,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={shippingId:e.shippingId},t.prev=1,t.next=4,M.a.post("/admin/purchaseOrder/voucher/export/shipping.jhtml",r,{responseType:"blob"});case 4:return s=t.sent,console.log("response => ",s),i=new Blob([s.data],{type:"application/vnd.ms-excel"}),n=decodeURI(s.headers["content-disposition"].split("filename=")[1]),o=document.createElement("a"),o.download=n.match(/"(\S*)"/)[1],o.style.display="none",o.href=URL.createObjectURL(i),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},formatDate:function(e){var t=new Date(e),r=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),n=r+"-"+(s<10?"0"+s:s)+"-"+(i<10?"0"+i:i);return n},certificate:function(e){var t=this,r={shippingId:e};c["a"].get("/admin/purchaseOrder/voucher/shipping.jhtml",r).then((function(r){t.dialogShipping=!0,t.title=t.getUser.shop?t.getUser.shop.name+"发货单":"发货单",t.form=r.order,t.shippingId=e,t.shippingsPrint=r.shipping,t.gridData=r.shipping.shippingItems})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},enlarge:function(e){this.larImg=e,this.outerVisible=!0},getLogs:function(){var e=this,t={clientType:"2",methodName:"QueryOrderLog",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id};c["a"].get("/admin/purchaseOrder/orderLogs.jhtml",t).then((function(t){e.orderLogs=t.orderLogs,e.reviews=t.reviews,e.payments=t.payments,t.payments&&t.payments.length>1?e.amountpaid=Number(t.payments[0].amount)+Number(t.payments[1].amount):e.amountpaid="",e.memberRescueStates=t.memberRescueStates,e.latestMemberRescueState=t.latestMemberRescueState,e.workers=t.workers,e.orderId=t.orderId,e.dispathType=t.dispathType,e.shippings=t.shippings,e.devProcessShippings=t.shippings&&t.shippings[0],t.payments&&(e.paymentType=t.payments.length>0?t.payments[0].paymentType:"",e.paymentMethod=t.payments.length>0?t.payments[0].paymentMethod:"",e.amount=t.payments.length>0?t.payments[0].amount:"",e.fee=t.payments.length>0?t.payments[0].fee:"",e.sn=t.payments.length>0?t.payments[0].sn:""),t.shippings&&(e.deliveryCorp=t.shippings.length>0?t.shippings[0].logistics:"",e.trackingNo=t.shippings.length>0?t.shippings[0].expressSn:"",e.operator=t.shippings.length>0?t.shippings[0].consignee:""),e.consignee=t.order.consignee||"",e.currentState=t.orderLogs[t.orderLogs.length-1].type,t.orderLogs.length>1&&(e.preState=t.orderLogs[t.orderLogs.length-2].type),"create"===e.currentState||"confirm"===e.currentState?e.active="1":"service"===e.currentState||"shipping"===e.currentState?e.active="3":"payment"===e.currentState?e.active="2":"complete"===e.currentState?e.active="4":"review"===e.currentState?e.active="5":"cancel"===e.currentState&&(e.active="6"),!e.latestMemberRescueState||"0"!==e.latestMemberRescueState.state&&"1"!==e.dispathType?(e.dispathButton=!0,e.cbp_tmlabel=!1):(e.dispathButton=!1,e.cbp_tmlabel=!0),e.latestMemberRescueState&&"3"!==e.latestMemberRescueState.state&&"8"!==e.latestMemberRescueState.state&&"9"!==e.latestMemberRescueState.state&&"4"!==e.latestMemberRescueState.state&&"0"!==e.latestMemberRescueState.state?e.redispathButton=!1:e.redispathButton=!0,e.isCreate=!1,e.isPayment=!1,e.isComplete=!1,e.isReview=!1,e.isCancel=!1,e.isService=!1,t.orderLogs.forEach((function(t){"create"===t.type&&(e.isCreate=!0),"payment"===t.type&&(e.isPayment=!0),"complete"===t.type&&(e.isComplete=!0),"review"===t.type&&(e.isReview=!0),"cancel"===t.type&&(e.isCancel=!0),"service"===t.type&&(e.isService=!0),"shipping"===t.type&&(e.isService=!0),"confirm"===t.type&&(e.isService=!0)})),e.serviceLogs=t.serviceLogs||[],e.updateLucidLogs(e.serviceLogs)})).catch((function(e){console.log("ERR: ",e)})).finally((function(){}))},dispath:function(e){var t=this;this.id=this.itemId||"",_["a"].rescuerDispath({orderId:this.id,workerId:this.workerId},(function(e){_["a"].rescueOrderLogs({orderId:t.id,dispathType:"0"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,"0"===t.latestMemberRescueState.state||"7"===t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))}),(function(e){console.log(e)}))},rdispath:function(e){var t=this;this.id=this.itemId||"",_["a"].rescueOrderLogs({orderId:this.id,dispathType:"1"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,t.cbp_tmlabel=!0}),(function(e){console.log(e)}))}}),created:function(){this.getLogs()}},T=C,k=(r("3101"),r("2877")),R=Object(k["a"])(T,v,y,!1,null,null,null),A=R.exports,x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"apply-sale-content"},[r("div",{staticClass:"input-area"},[r("el-form",{attrs:{size:"small","label-width":"120px","inline-message":!0}},[r("el-form-item",{attrs:{label:"售后类型："}},[r("el-select",{on:{change:e.inputHandle},model:{value:e.typeStr,callback:function(t){e.typeStr=t},expression:"typeStr"}},e._l(e.options,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"我要退货退款"===e.typeStr||"我要退货（无需退款）"===e.typeStr?r("el-form-item",{attrs:{label:"退货数量："}},[r("el-input-number",{attrs:{size:"mini",min:1},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}})],1):e._e(),"我要换货（无需退款）"===e.typeStr?r("el-form-item",{attrs:{label:"换货数量："}},[r("el-input-number",{attrs:{size:"mini",min:1},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}})],1):e._e(),r("el-form-item",{attrs:{label:"售后原因："}},[r("el-select",{model:{value:e.reasonType,callback:function(t){e.reasonType=t},expression:"reasonType"}},e._l(e.reasonOptions,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"我要换货（无需退款）"===e.typeStr?r("el-form-item",{attrs:{label:"收货地址："}},[r("el-card",{nativeOn:{click:function(t){return e.clickAdress(t)}}},[r("div",{staticClass:"left"},[r("div",{staticClass:"address"},[r("div",{staticClass:"receiver-address"},[r("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),r("div",{staticClass:"icon"},[r("span",[r("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),r("span",{staticStyle:{float:"right"}},[r("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),r("div",[r("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),"我要退货退款"===e.typeStr||"我要退款（无需退货）"===e.typeStr?r("el-form-item",{attrs:{label:"退款金额："}},[r("el-input",{attrs:{disabled:e.disableInput,type:"text"},model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}})],1):e._e(),r("el-form-item",{attrs:{label:"售后说明："}},[r("el-input",{attrs:{placeholder:"请输入退款说明",type:"textarea"},model:{value:e.explain,callback:function(t){e.explain=t},expression:"explain"}})],1),r("el-form-item",{attrs:{label:"上传图片："}},[r("img-uploader",{model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),r("span",[e._v("当前仅支持.jpeg .jpg .png格式，大小10M以内")])],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onConfirm}},[e._v("确定")])],1)],1)],1),r("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[r("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],1)},j=[],L=(r("c975"),r("25f0"),r("b85c")),N=r("2119"),P=r("ea36"),B={name:"ApplySale",data:function(){return{editable:!1,files:[],typeStr:"我要退款（无需退货）",options:["我要退款（无需退货）","我要退货退款","我要换货（无需退款）","我要退货（无需退款）"],reasonType:"多拍/错拍/不想要",reasonOptions:["多拍/错拍/不想要","快递无跟踪记录","空包裹/少货"],amount:"",explain:"",quantity:"",id:"",disabled:!1,uploadimgs:0,disableInput:!1,dialogVisiable:!1,getAddress:{},depotReceiver:""}},props:{isEditable:{type:Boolean,default:!0},open:{type:Boolean,default:!1},itemId:{type:String,default:""}},components:{ImgUploader:N["a"],BillInfo:P["a"]},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(a["c"])(["getUser"])),Object(a["c"])("Order",["orderInfo","curApplySaleItem"])),{},{images:function(){var e,t=[],r=Object(L["a"])(this.files);try{for(r.s();!(e=r.n()).done;){var s=e.value;t.push(s)}}catch(i){r.e(i)}finally{r.f()}return t},type:function(){return this.options.indexOf(this.typeStr).toString()}}),watch:{itemId:function(e,t){this.changeValue(),this.getAddressList()},open:function(e,t){}},mounted:function(){this.amount=this.curApplySaleItem.maxAmountRefundable,this.quantity=this.curApplySaleItem.quantity,this.disableInput=Number(this.curApplySaleItem.minAmountRefundable)===Number(this.curApplySaleItem.maxAmountRefundable),this.getAddressList()},methods:{changeValue:function(){this.amount=this.curApplySaleItem.maxAmountRefundable,this.quantity=this.curApplySaleItem.quantity,this.disableInput=Number(this.curApplySaleItem.minAmountRefundable)===Number(this.curApplySaleItem.maxAmountRefundable)},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};c["a"].get(d["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.depotReceiver=t.receivers[0].id,e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},inputHandle:function(){this.typeStr===this.options[0]?(this.reasonType="多拍/错拍/不想要",this.reasonOptions=["多拍/错拍/不想要","快递无跟踪记录","空包裹/少货"]):this.typeStr===this.options[1]?(this.reasonType="质量问题",this.reasonOptions=["质量问题","颜色/款式/图案与描述不符","商家发错货"]):this.typeStr===this.options[2]?(this.reasonType="质量问题",this.reasonOptions=["质量问题","商家发错货"]):this.typeStr===this.options[3]&&(this.reasonType="质量问题",this.reasonOptions=["质量问题","多拍/错拍/不想要"])},fileSuccess:function(e){console.log(e.response.urls[0])},onConfirm:function(){if(this.typeStr)if(this.reasonType)if(this.amount){var e=/^\d+(?=\.{0,1}\d+$|$)/;e.test(this.amount)?this.isEditable?this.refundsHandle():this.updateRefunds():this.$message.warning("请输入合法数字")}else this.$message.warning("请输入退款金额");else this.$message.warning("请输入售后原因");else this.$message.warning("请输入售后类型")},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},refundsHandle:function(){var e=this,t={orderId:this.curApplySaleItem.orderId,orderItem:{id:this.curApplySaleItem.id,quantity:this.curApplySaleItem.quantity,product:{id:this.curApplySaleItem.productId}},type:this.options.indexOf(this.typeStr).toString(),reason:this.reasonType,amount:this.amount,quantity:this.quantity,depotReceiver:this.depotReceiver,explain:this.explain,images:this.images,methodName:"AddRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,receiverId:this.getAddress.id};c["a"].post(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("申请成功",t),e.$message.success("申请成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)}))},updateRefunds:function(){var e=this,t={amount:this.amount,quantity:this.quantity,depotReceiver:this.depotReceiver,refundsId:this.id,type:this.type,reason:this.reasonType,explain:this.explain,methodName:"UpdateRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,images:this.images,receiverId:this.getAddress.id};c["a"].put(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("修改申请成功",t),e.$message.success("修改申请成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){}))},queryRefunds:function(e){var t=this,r={clientType:"2",methodName:"QueryRefunds",shopId:this.getUser.shop.id,userId:this.getUser.id,id:e};c["a"].get(d["g"].hypermarketMgmt.refunds,r).then((function(e){console.log("修改申请",e),t.typeStr=t.options[e.refunds.type],t.inputHandle(),t.reasonType=e.refunds.reason,t.amount=e.refunds.amount,t.explain=e.refunds.explain,t.id=e.refunds.id;for(var r,s=e.refunds.images,i=s.length,n=0;n<i;n++)t.files.push(r);t.uploadimgs=i})).catch((function(){})).finally((function(){}))},getParams:function(e){this.isEditable||this.queryRefunds(e),"1"!==this.orderInfo.paymentStatus&&"2"!==this.orderInfo.paymentStatus||"0"!==this.orderInfo.shippingStatus?"0"===this.orderInfo.shippingStatus&&"0"===this.orderInfo.paymentStatus?this.options=["我要退货（无需退款）"]:"0"!==this.orderInfo.shippingStatus&&"0"===this.orderInfo.paymentStatus?this.options=["我要退货（无需退款）","我要换货（无需退款）"]:this.options=["我要退款（无需退货）","我要退货退款","我要换货（无需退款）"]:this.options=["我要退款（无需退货）"]},onFinishUpload:function(){this.disabled=!1},onFileUploading:function(){this.disabled=!0},clickAdress:function(){this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e,this.depotReceiver=e.id}},created:function(){}},D=B,E=(r("7bd6"),Object(k["a"])(D,x,j,!1,null,null,null)),U=E.exports,$=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"refund-info"},[r("div",{staticClass:"o-refund-info"},[r("div",{staticClass:"info-list"},[r("div",{staticClass:"info-item"},[r("div",{staticClass:"t"},[e._v("退货类型：")]),r("div",{staticClass:"des"},[e._v(e._s(e.typeStr))])]),r("div",{staticClass:"info-item"},[r("div",{staticClass:"t"},[e._v("退款金额：")]),r("div",{staticClass:"des"},[e._v(e._s(e.amount))])]),r("div",{staticClass:"info-item"},[r("div",{staticClass:"t"},[e._v("退款原因：")]),r("div",{staticClass:"des"},[e._v(e._s(e.reason))])]),r("div",{staticClass:"info-item"},[r("div",{staticClass:"t"},[e._v("退款说明：")]),r("div",{staticClass:"des"},[e._v(e._s(e.explain))])]),e.curRefundsInfo&&e.curRefundsInfo.returns&&"3"===e.curRefundsInfo.returns[0].type?r("div",{staticClass:"info-item"},[r("span",{staticStyle:{"white-space":"nowrap"}},[e._v("退货地址：")]),r("div",{staticClass:"des"},[e._v(e._s("1"===e.type?e.curRefundsInfo.returns[0].address:""))])]):e._e(),e.curRefundsInfo&&e.curRefundsInfo.images&&e.curRefundsInfo.images.length?r("div",{staticClass:"refunds-img"},[r("span",{staticStyle:{"white-space":"nowrap"}},[e._v("上传图片：")]),e._l(e.curRefundsInfo.images,(function(e){return r("img",{key:e,staticStyle:{margin:"0px 5px"},attrs:{src:e,width:"80px",height:"80px"}})}))],2):e._e(),r("div",{staticClass:"order-track-content"},[r("ul",{staticClass:"trace-info"},[e._l(e.logs,(function(t,s){return[r("li",{key:s,class:t.status},[r("p",{domProps:{innerHTML:e._s(t.title)}}),r("span",[e._v(e._s(t.time))])])]}))],2)])]),r("div",{staticClass:"bottom-action"},[e.btnLabel?r("span",{staticClass:"half-action",on:{click:e.selectLogistics}},[e._v(e._s(e.getBtnLabel))]):e._e(),e.showModefyBtn?r("span",{staticClass:"half-action",on:{click:e.modefyApply}},[e._v("修改申请")]):e._e(),e.showCancelBtn?r("span",{staticClass:"half-action",on:{click:e.cancelApply}},[e._v("取消申请")]):e._e(),e.showReApply?r("span",{staticClass:"half-action",on:{click:e.reApplyHandle}},[e._v("重新申请")]):e._e(),e.showShipping?r("span",{staticClass:"half-action",on:{click:e.confirmShipping}},[e._v("确认收货")]):e._e()])]),r("el-dialog",{attrs:{visible:e.dialogInfo,"append-to-body":""},on:{"update:visible":function(t){e.dialogInfo=t}}},[r("logistic-info",{attrs:{refundsId:e.id},on:{operationSuccess:e.operationSuccess}})],1),r("el-dialog",{attrs:{visible:e.dialogFollowing,"append-to-body":""},on:{"update:visible":function(t){e.dialogFollowing=t}}},[r("logistics-following",{ref:"following",attrs:{sn:e.shippingSn}})],1)],1)},z=[],F=(r("d81d"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"logistic-info-content"},[r("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[r("el-form-item",{attrs:{label:"物流公司",prop:"deliveryId"}},[r("el-select",{model:{value:e.form.deliveryId,callback:function(t){e.$set(e.form,"deliveryId",t)},expression:"form.deliveryId"}},e._l(e.deliveryOptions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"物流单号",prop:"trackingNo"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.trackingNo,callback:function(t){e.$set(e.form,"trackingNo",t)},expression:"form.trackingNo"}})],1),r("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),r("el-form-item",{attrs:{label:"退款说明",prop:"explain"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.explain,callback:function(t){e.$set(e.form,"explain",t)},expression:"form.explain"}})],1),r("el-form-item",{attrs:{label:""}},[r("img-uploader",{model:{value:e.form.files,callback:function(t){e.$set(e.form,"files",t)},expression:"form.files"}})],1),r("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)}),G=[],q=r("8330"),V={name:"LogisticInfo",data:function(){return{deliveryOptions:[],formOperations:[{label:"提交退货物流信息",name:"onConfirm",type:"primary"}],rules:{deliveryId:[{required:!0,message:"请选择物流公司",trigger:"blur"}],trackingNo:[{required:!0,message:"请输入物流单号",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^[1][1,2,3,4,5,6,7,8,9][0-9]{9}$/,message:"电话号格式错误",trigger:"blur"}],explain:[{required:!0,message:"请输入退款说明",trigger:"blur"}]},form:this.getDetaultModel()}},props:{refundsId:{type:String,default:""}},components:{ImgUploader:N["a"],BizSaveButton:q["a"]},computed:Object(n["a"])(Object(n["a"])({},Object(a["c"])(["getUser"])),Object(a["c"])("Order",["orderInfo","curApplySaleItem"])),watch:{},created:function(){this.getDeliveries()},methods:Object(n["a"])(Object(n["a"])({},Object(a["d"])("Order",["updateRefundsInfo"])),{},{fileSuccess:function(e){console.log(e.response.urls[0])},getDetaultModel:function(){return{deliveryId:"",files:[],trackingNo:"",mobile:"",explain:""}},operate:function(e){this[e]()},onConfirm:function(){var e=this;this.$refs.form.validate((function(t,r){t&&e.submitLogisticInfo()}))},getDeliveries:function(){var e=this,t={methodName:"ListDeliveryCorp",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,type:"0"};c["a"].get(d["g"].hypermarketMgmt.deliveryCorpsByType,t).then((function(t){e.deliveryOptions=t.deliveryCorps}))},getLogisticsInfo:function(){var e=this,t={methodName:"QueryRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.curApplySaleItem.id};c["a"].get(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("退款详情",t),e.updateRefundsInfo(t)})).catch((function(t){e.$message.warning(t.errorMessage)}))},submitLogisticInfo:function(){var e=this,t={orderId:this.curApplySaleItem.orderId,refundsId:this.refundsId,orderItem:{id:this.curApplySaleItem.id,quantity:this.curApplySaleItem.quantity,product:{id:this.curApplySaleItem.productId}},deliveryId:this.form.deliveryId,delivery:this.form.delivery,trackingNo:this.form.trackingNo,mobile:this.form.mobile,explain:this.form.explain,images:this.form.files,methodName:"AddReturns",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id};c["a"].post(d["g"].hypermarketMgmt.returns,t).then((function(t){console.log("填写物流成功",t),e.$message.success("操作成功"),e.$emit("operationSuccess")}))}})},Y=V,W=(r("53c9"),Object(k["a"])(Y,F,G,!1,null,null,null)),H=W.exports,Z=r("4382"),Q={name:"refund-info",props:{itemId:{type:String,default:""}},data:function(){return{orderItemId:"",type:"",amount:"",reason:"",explain:"",shippingSn:"",btnLabel:!1,dialogInfo:!1,dialogFollowing:!1,id:"",showDialog:!1,showModefyBtn:null,showCancelBtn:null,showReApply:null,showShipping:!1,deliveryCorp:"",trackingNo:"",orderId:""}},components:{LogisticInfo:H,LogisticsFollowing:Z["a"]},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(a["c"])(["getUser"])),Object(a["c"])("Order",["orderInfo","curRefundsInfo"])),{},{typeStr:function(){switch(this.type){case"0":return"我要退款(无需退货)";case"1":return"我要退货退款";case"2":return"我要换货(无需退款)";case"3":return"我要退货(无需退款)";default:return""}},getBtnLabel:function(){return"2"===this.curRefundsInfo.returns[0].type?"填写物流":"3"!==this.curRefundsInfo.returns[0].type&&"4"!==this.curRefundsInfo.returns[0].type&&"5"!==this.curRefundsInfo.returns[0].type||"1"!==this.type&&"2"!==this.type?"":"查看物流"},logs:function(){var e=this,t=[];return this.curRefundsInfo&&this.curRefundsInfo.returns&&this.curRefundsInfo.returns.forEach((function(r,s){var i={};switch(i.time=r.happenDate,r.type){case"0":"0"===e.type?i.title="提交退款(无需退货)申请":"2"===e.type?i.title="提交换货申请":"3"===e.type?i.title="提交退货(无需退款)":i.title="提交退货退款申请";break;case"2":i.title="卖家同意售后申请，等待买家发货给卖家<br/>退货地址："+e.curRefundsInfo.returns[0].address||!1;break;case"3":i.title="买家已退货，等待卖家收货<br/>物流公司："+r.deliveryCorp+"<br/>物流单号："+r.trackingNo;break;case"7":i.title="卖家已收到买家的换货商品，待发出换货商品";break;case"8":i.title="卖家已发货，等待买家收货<br/>物流公司："+r.deliveryCorp+"<br/>物流单号："+r.trackingNo,i.type="8";break;case"1":case"4":i.title="退款失败<br/>拒绝原因："+e.curRefundsInfo.returns[0].details+"<br/>备注："+e.curRefundsInfo.returns[0].remarks;break;case"5":i.title="退款成功";break;case"9":i.title="换货完成";break;default:break}i.status=0===s?"cur":"no-started",t.unshift(i)})),t}}),watch:{itemId:function(e,t){this.getLogisticsInfo()}},created:function(){this.getLogisticsInfo()},methods:Object(n["a"])(Object(n["a"])({},Object(a["d"])("Order",["updateRefundsInfo","updateApplySaleItem"])),{},{confirmShipping:function(){var e=this,t={refundsId:this.curRefundsInfo.id,state:"2"};c["a"].put("/admin/invoicing/purchase/refunds/takeOver.jhtml",t).then((function(t){e.$message.success("操作成功")})).catch((function(){})).finally((function(){}))},getOrderInfo:function(){var e=this,t={clientType:"2",methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderId};c["a"].get(d["g"].hypermarketMgmt.queryOrder,t).then((function(t){t.order.orderItems.map((function(t){t.id===e.itemId&&e.updateApplySaleItem(t)}))})).catch((function(){})).finally((function(){}))},modefyApply:function(){this.$emit("applySaleHanlder",!1,this.id)},reApplyHandle:function(){this.$emit("applySaleHanlder",!0)},operationSuccess:function(){this.dialogInfo=!1,this.getLogisticsInfo()},cancelApply:function(){var e=this;this.$confirm("请确认是否取消退款申请?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.confirmReceive()}))},confirmReceive:function(){var e=this,t={clientType:"2",methodName:"DeleteRefunds",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.itemId};c["a"].delete(d["g"].hypermarketMgmt.refunds,t).then((function(t){e.$message.success("取消申请成功"),e.$emit("operationSuccess")})).catch((function(){})).finally((function(){}))},getLogisticsInfo:function(){var e=this,t={methodName:"QueryRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.itemId};c["a"].get(d["g"].hypermarketMgmt.refundsByOrderItemId,t).then((function(t){console.log("退款详情",t),e.type=t.refunds.type,e.amount=t.refunds.amount,e.reason=t.refunds.reason,e.explain=t.refunds.explain,e.id=t.refunds.id,e.orderId=t.refunds.orderItem.orderId,e.orderInfo&&e.orderInfo.orderItems?e.orderInfo.orderItems.map((function(t){t.id===e.itemId&&e.updateApplySaleItem(t)})):e.getOrderInfo(),t.refunds.returns.forEach((function(t){if("3"===t.type)return e.deliveryCorp=t.deliveryCorp,e.trackingNo=t.trackingNo,e.shippingSn=t.shippingSn,!1})),"2"!==t.refunds.returns[0].type&&"3"!==t.refunds.returns[0].type&&"4"!==t.refunds.returns[0].type&&"5"!==t.refunds.returns[0].type||"0"===e.type?e.btnLabel=!1:e.btnLabel=!0,e.updateRefundsInfo(t.refunds),"3"===t.refunds.returns[0].type||"5"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1):"4"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1,e.showReApply=!0):"2"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showShipping=!1,e.showCancelBtn=!0):"1"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1,e.showReApply=!0):"8"===t.refunds.returns[0].type?e.showShipping=!0:(e.showModefyBtn=!0,e.showCancelBtn=!0)})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)}))},touchCS:function(){this.$router.push({path:"/custom-service"})},selectLogistics:function(){var e=this;"2"===this.curRefundsInfo.returns[0].type?this.dialogInfo=!0:"3"!==this.curRefundsInfo.returns[0].type&&"4"!==this.curRefundsInfo.returns[0].type&&"5"!==this.curRefundsInfo.returns[0].type||(this.dialogFollowing=!0,this.$nextTick((function(){e.$refs.following.getLogisticsInfo()})))}})},X=Q,J=(r("e2f0"),Object(k["a"])(X,$,z,!1,null,null,null)),K=J.exports,ee={name:"order-info",data:function(){return{auditState:"1",remarks:"",row:{},curSelectAjectReason:"申报的商品与实际需要采购的商品不符",reasonAjectList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}],iconShop:h.a,defaultImg:p.a,defaultFailImg:f.a,maxlength:6,passValue:"",dialogVisiable:!1,openCancel:!1,open:!1,showPayment:!1,showPayDeposit:!1,showFinalPayment:!1,showCancelOrder:!1,showBalancePay:!0,thirdPay:!0,showRefund:[],showLogistics:!1,showReceive:!1,showLookEvaluate:!1,showEvaluate:!1,showDialog:!1,refundsLabel:[],loading:!1,showCreatInvoice:!1,dialogVisiableLog:!1,dialogApplaySale:!1,dialogApplayRefundInfo:!1,isEditable:!0,itemId:"",orderItemId:"",showPassOrder:!1}},props:{orderId:{type:String,default:""},isPend:{type:Boolean,default:!1}},watch:{},components:{BizGrid:o["a"],MyInvoice:g["a"],OrderTrack:A,ApplySale:U,RefundInfo:K},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(a["c"])(["getUser"])),Object(a["c"])("RecentActivity",["activity","shop","product"])),Object(a["c"])("Order",["orderConfim","orderInfo","routerFrom","curApplySaleItem"])),Object(a["c"])("Order",["orderInfo","curInvoice"])),{},{getOffsetAmount:function(){var e=this.orderInfo.offsetAmount;return e?Number(e)>=0?"+ ￥"+e:"- ￥"+e.substr(1,e.length-1):""},getAmount:function(){var e,t=this.orderInfo.orderItems,r=0;t&&(e=t.length);for(var s=0;s<e;s++)r+=t[s].price*t[s].quantity;return r.toFixed(2)},getOrderPaymentState:function(){if("1"===this.orderInfo.afterSaleStatus)return"退货退款中";switch(this.orderInfo.type){case"1":return"待付款";case"2":return"待收货";case"3":return"待评价";case"5":return"4"===this.orderInfo.orderType||"5"===this.orderInfo.orderType||"6"===this.orderInfo.orderType||"7"===this.orderInfo.orderType||"8"===this.orderInfo.orderType?"商家已确认":"待发货";case"6":return"已完成";case"7":return"已关闭";case"8":return"订单过期";case"9":return"退款退货中";case"10":return"退款退货完成";case"11":return"待商家确认";default:return""}},getDownPayment:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.downPayment)+"%";return t},getInitPay:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.product.price),r=parseFloat(e.downPayment)*t*.01;return r.toFixed(2)},getMonthPaidNum:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.product.price),r=parseFloat(e.downPayment)*t*.01,s=12*parseInt(e.year),i=t-r,n=parseFloat(parseFloat(e.rate)/12),o=Math.pow(1+n,s)-1;if(0===o)return(0).toFixed(2);var a=i*n*Math.pow(1+n,s)/(Math.pow(1+n,s)-1);return a.toFixed(2)}}),methods:Object(n["a"])(Object(n["a"])({},Object(a["d"])("Order",["updateOrderInfo","updateOrderId","updateApplySaleItem","updateClickItemSelect"])),{},{imgError:function(e){this.$refs.img&&this.$refs.img[e]&&(this.$refs.img[e].src=this.defaultFailImg)},toPass:function(e,t){this.remarks="",this.row=e,this.showPassOrder=!0},statusChange:function(e,t){var r=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.loading=!0;var s={shopId:window.top.SHOP_ID||"",id:e.id,actionType:t,details:"2"===t?r.curSelectAjectReason:"",remarks:r.remarks};c["a"].post("/admin/purchaseOrderManage/audit.jhtml",s).then((function(e){r.$message.success("操作成功！"),r.showPassOrder=!1,r.loading=!1,r.$emit("closeTabByAudit")})).catch((function(e){r.loading=!1,e.errorMessage&&r.$message.warning(e.errorMessage)})).finally((function(){}))}))},confirmOrder:function(e){var t=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var r={clientType:"2",methodName:"UpdateOrder",shopId:t.getUser().shop.id,userId:t.getUser().id,orderId:e.id,type:"1"};c["a"].put(d["g"].hypermarketMgmt.purchaseOrder,r).then((function(e){t.$message.success("操作成功"),t.getList()})).catch((function(e){t.$message.warning(e.errorMessage),t.loading=!1})).finally((function(){}))}))},applySaleHanlder:function(e,t){var r=this;this.isEditable=e,this.dialogApplaySale=!0,this.$nextTick((function(){r.$refs.applysale.getParams(t)}))},operationSuccess:function(){this.dialogApplaySale=!1,this.dialogApplayRefundInfo=!1,this.getOrderInfo()},goShop:function(){},handleCartClick:function(e){this.$router.push({path:"/cart"})},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},selectInvoice:function(){var e=this;this.orderInfo.invoiceTitle||"1"!==this.orderInfo.type?(this.dialogVisiable=!0,this.$nextTick((function(){e.$refs.invoice.getInvoiceInfo()}))):this.$message.warning("本订单暂无发票信息，付款后支持补开发票")},hideCancel:function(){this.openCancel=!1},onCancel:function(){this.open=!1},successHandle:function(e){this.getOrderInfo()},onOrderTrack:function(){var e=this;this.dialogVisiableLog=!0,this.$nextTick((function(){e.$refs.log.getLogs()}))},onConsultation:function(){this.$router.push({path:"/custom-service"})},onPay:function(){this.open=!0},onCancelPay:function(){this.openCancel=!0},onConfirm:function(e){var t=this,r={clientType:"2",methodName:"UpdateOrder",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,type:0,content:e};c["a"].put(d["g"].order.cancelOrder,r).then((function(e){t.routerFrom?t.$router.replace({path:t.routerFrom}):(t.openCancel=!1,t.$router.go(-1),t.getOrderInfo())})).catch((function(){})).finally((function(){}))},getOrderInfo:function(){var e=this;this.updateOrderId(this.orderId),this.open=!1;var t={clientType:"2",methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id};c["a"].get(d["g"].hypermarketMgmt.queryOrder,t).then((function(t){console.log("订单信息2",t),e.updateOrderInfo(t.order),"1"===e.orderInfo.orderType||"13"===e.orderInfo.orderType?e.showBalancePay=!1:e.showBalancePay=!0,parseFloat(e.orderInfo.amountPayable)?e.thirdPay=!0:e.thirdPay=!1,("2"===e.orderInfo.paymentStatus||"3"===e.orderInfo.paymentStatus)&&parseFloat(e.orderInfo.amount)>0&&!e.orderInfo.invoiceTitle?e.showCreatInvoice=!0:e.showCreatInvoice=!1,e.showRefund=[];var r,s=t.order,i=s.orderItems,n=i.length;for(s.shippings.length>0&&"5"!==s.state&&"6"!==s.state&&"7"!==s.state?e.showLogistics=!0:e.showLogistics=!1,r=0;r<n;r++)e.showRefund.push(!1),e.refundsLabel.push("");for(r=0;r<n;r++)("0"!==s.method&&"2"!==s.method||"1"!==s.type||"0"!==s.orderType&&"2"!==s.orderType&&"9"!==s.orderType&&"10"!==s.orderType&&"3"!==s.orderType&&"6"!==s.orderType&&"7"!==s.orderType&&"8"!==s.orderType)&&("0"!==s.method&&""!==s.method||"1"!==s.orderType&&"13"!==s.orderType&&"17"!==s.orderType||"1"!==s.type)&&("11"!==s.type&&"5"!==s.type||"4"!==s.orderType&&"5"!==s.orderType)?e.showCancelOrder=!1:e.showCancelOrder=!0,"0"!==s.method&&""!==s.method||"1"!==s.orderType&&"13"!==s.orderType&&"17"!==s.orderType||"1"!==s.type?e.showPayment=!1:e.showPayment=!0,"0"!==s.method||"0"!==s.orderType&&"2"!==s.orderType&&"4"!==s.orderType&&"5"!==s.orderType&&"9"!==s.orderType&&"10"!==s.orderType||("1"===s.type?(e.showPayment=!1,e.showPayDeposit=!1,e.showFinalPayment=!1,"1"!==s.isSubscription||e.activity.activityId?e.showPayment=!0:0===Number(s.amountPaid)?e.showPayDeposit=!0:(Number(s.amountPayable)>0&&(e.showFinalPayment=!0,e.showCancelOrder=!1),parseFloat(e.orderInfo.orderItems[r].maxAmountRefundable)>0&&(e.showRefund[r]=!0,e.refundsLabel[r]="申请售后"))):"2"===s.type?(e.showReceive=!0,parseFloat(e.orderInfo.orderItems[r].maxAmountRefundable)>0&&(e.showRefund[r]=!0,e.refundsLabel[r]="申请售后")):"3"===s.type?(e.showEvaluate=!0,e.showCancelOrder=!1,e.showReceive=!1,parseFloat(e.orderInfo.orderItems[r].maxAmountRefundable)>0&&(e.showRefund[r]=!0,e.refundsLabel[r]="申请售后")):"5"===s.type&&(parseFloat(e.orderInfo.orderItems[r].maxAmountRefundable)>0&&(e.showRefund[r]=!0,e.refundsLabel[r]="申请售后"),e.showFinalPayment=!1)),"3"!==s.type||"0"!==s.orderType&&"1"!==s.orderType&&"2"!==s.orderType&&"9"!==s.orderType&&"10"!==s.orderType&&"3"!==s.orderType&&"4"!==s.orderType&&"5"!==s.orderType&&"6"!==s.orderType&&"7"!==s.orderType&&"8"!==s.orderType&&"13"!==s.orderType&&"17"!==s.orderType||(e.showEvaluate=!0,e.showCancelOrder=!1),"1"===s.isReviewed?e.showLookEvaluate=!0:e.showLookEvaluate=!1,"1"!==e.orderInfo.orderType&&"13"!==e.orderInfo.orderType&&"17"!==e.orderInfo.orderType&&("6"===e.orderInfo.type?(e.showRefund[r]=!0,e.refundsLabel[r]="售后"):"0"===i[r].refundsState||"2"===i[r].refundsState||"3"===i[r].refundsState?(e.showRefund[r]=!0,e.refundsLabel[r]="申请售后"):"5"===i[r].refundsState?(e.showRefund[r]=!0,e.refundsLabel[r]="退款成功"):"6"===i[r].refundsState?(parseFloat(e.orderInfo.orderItems[r].maxAmountRefundable)>0&&(e.showRefund[r]=!0),e.refundsLabel[r]="申请售后"):"1"!==i[r].refundsState&&"4"!==i[r].refundsState||(e.showRefund[r]=!0,e.refundsLabel[r]="退款失败"))})).catch((function(){})).finally((function(){}))},queryRefunds:function(){this.$router.push({path:this.$route.path+"/myOrder"})},onRefund:function(e){this.updateApplySaleItem(e),console.log("申请退款的信息",e),e.refundsState&&"6"!==e.refundsState?(this.itemId=e.id,this.dialogApplayRefundInfo=!0):(this.orderItemId=e.id,this.dialogApplaySale=!0)},onLookLogistics:function(e){this.$emit("closeTabByLogistics",e)},onConfirmReceive:function(){this.showDialog=!0},onEvaluate:function(){this.$router.push({path:"/my-evaluate/"+this.orderInfo.id+"/true"})},onLookEvaluate:function(e,t){console.log(222),this.$emit("closeTabByEvaluate",e,t)},onReview:function(e,t){this.$emit("closeTabByEvaluate",e,t)},onClickProduct:function(e){},confirmReceive:function(){var e=this,t={clientType:"2",methodName:"UpdateOrder",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,type:"1"};c["a"].put(d["g"].order.cancelOrder,t).then((function(t){console.log("确认收货",t),e.getOrderInfo()})).catch((function(){})).finally((function(){}))},onCreateInvoice:function(){this.updateClickItemSelect(!0),this.$router.push({path:this.$route.fullPath+"/invoiceInfo"})}}),created:function(){}},te=ee,re=(r("cc46"),Object(k["a"])(te,s,i,!1,null,null,null));t["a"]=re.exports},6649:function(e,t,r){"use strict";var s=r("f2d4"),i=r.n(s);i.a},7132:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"biz-fade-t"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[r("transition",{attrs:{name:"biz-fade-t-right"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},i=[],n={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},o=n,a=(r("5b8e"),r("2877")),c=Object(a["a"])(o,s,i,!1,null,null,null),d=c.exports,l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"biz-popup-tabs"},[r("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[r("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},p=[],u=(r("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:d},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),f=u,m=(r("d4c2"),Object(a["a"])(f,l,p,!1,null,null,null)),h=m.exports;r.d(t,"a",(function(){return h}))},"7ba1":function(e,t,r){},"7bd6":function(e,t,r){"use strict";var s=r("562c"),i=r.n(s);i.a},9678:function(e,t,r){},"990e":function(e,t,r){},"9c7b":function(e,t,r){},a9e3:function(e,t,r){"use strict";var s=r("83ab"),i=r("da84"),n=r("94ca"),o=r("6eeb"),a=r("5135"),c=r("c6b6"),d=r("7156"),l=r("c04e"),p=r("d039"),u=r("7c73"),f=r("241c").f,m=r("06cf").f,h=r("9bf2").f,g=r("58a8").trim,v="Number",y=i[v],b=y.prototype,I=c(u(b))==v,_=function(e){var t,r,s,i,n,o,a,c,d=l(e,!1);if("string"==typeof d&&d.length>2)if(d=g(d),t=d.charCodeAt(0),43===t||45===t){if(r=d.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(d.charCodeAt(1)){case 66:case 98:s=2,i=49;break;case 79:case 111:s=8,i=55;break;default:return+d}for(n=d.slice(2),o=n.length,a=0;a<o;a++)if(c=n.charCodeAt(a),c<48||c>i)return NaN;return parseInt(n,s)}return+d};if(n(v,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var w,S=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof S&&(I?p((function(){b.valueOf.call(r)})):c(r)!=v)?d(new y(_(t)),r,S):_(t)},O=s?f(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),M=0;O.length>M;M++)a(y,w=O[M])&&!a(S,w)&&h(S,w,m(y,w));S.prototype=b,b.constructor=S,o(i,v,S)}},b15b:function(e,t,r){"use strict";var s=r("bbfa"),i=r.n(s);i.a},b442:function(e,t,r){"use strict";var s=r("2ee5"),i=r.n(s);i.a},b680:function(e,t,r){"use strict";var s=r("23e7"),i=r("a691"),n=r("408a"),o=r("1148"),a=r("d039"),c=1..toFixed,d=Math.floor,l=function(e,t,r){return 0===t?r:t%2===1?l(e,t-1,r*e):l(e*e,t/2,r)},p=function(e){var t=0,r=e;while(r>=4096)t+=12,r/=4096;while(r>=2)t+=1,r/=2;return t},u=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!a((function(){c.call({})}));s({target:"Number",proto:!0,forced:u},{toFixed:function(e){var t,r,s,a,c=n(this),u=i(e),f=[0,0,0,0,0,0],m="",h="0",g=function(e,t){var r=-1,s=t;while(++r<6)s+=e*f[r],f[r]=s%1e7,s=d(s/1e7)},v=function(e){var t=6,r=0;while(--t>=0)r+=f[t],f[t]=d(r/e),r=r%e*1e7},y=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==f[e]){var r=String(f[e]);t=""===t?r:t+o.call("0",7-r.length)+r}return t};if(u<0||u>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(m="-",c=-c),c>1e-21)if(t=p(c*l(2,69,1))-69,r=t<0?c*l(2,-t,1):c/l(2,t,1),r*=4503599627370496,t=52-t,t>0){g(0,r),s=u;while(s>=7)g(1e7,0),s-=7;g(l(10,s,1),0),s=t-1;while(s>=23)v(1<<23),s-=23;v(1<<s),g(1,1),v(2),h=y()}else g(0,r),g(1<<-t,0),h=y()+o.call("0",u);return u>0?(a=h.length,h=m+(a<=u?"0."+o.call("0",u-a)+h:h.slice(0,a-u)+"."+h.slice(a-u))):h=m+h,h}})},bbfa:function(e,t,r){},cc46:function(e,t,r){"use strict";var s=r("118c"),i=r.n(s);i.a},ce09:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-invoice-my-agency"},[r("div",{staticClass:"invoice-info-my-agency"},[r("span",{staticClass:"invoice-title"},[e._v("发票信息")]),r("el-form",{attrs:{"label-width":"100","inline-message":!0}},[r("el-form-item",{attrs:{label:"发票抬头："}},[e._v(e._s(e.curInvoice.invoiceTitle))]),r("el-form-item",{attrs:{label:"发票类型："}},[e._v(e._s("0"===e.curInvoice.invoiceType?"个人":"1"===e.curInvoice.invoiceType?"增值税普通发票":"2"===e.curInvoice.invoiceType?"增值税专用发票":""))]),r("el-form-item",{attrs:{label:"发票状态："}},[e._v(e._s(e.curInvoice.invoiceState?e.curInvoice.invoiceState:"未申请"))]),r("el-form-item",{attrs:{label:"联系人："}},[e._v(e._s(e.curInvoice.contacts))]),r("el-form-item",{attrs:{label:"联系电话："}},[e._v(e._s(e.curInvoice.mobile))]),r("el-form-item",{attrs:{label:"所在地区："}},[e._v(e._s(e.curInvoice.areaName?e.curInvoice.areaName:e.curInvoice.area.fullName))]),r("el-form-item",{attrs:{label:"详细地址："}},[e._v(e._s(e.curInvoice.address))]),e.expressName?r("el-form-item",{attrs:{label:"快递公司："}},[e._v(" "+e._s(e.expressName)+" ")]):e._e(),e.curInvoice.expressCode?r("el-form-item",{attrs:{label:"快递单号："}},[e._v(" "+e._s(e.curInvoice.expressCode)+" ")]):e._e()],1),this.shippingSn?r("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[r("el-collapse-item",{attrs:{title:"发票追踪",name:"1"}},[r("div",{staticClass:"logistic-info"},[r("div",{staticClass:"track-list"},[e.getTraces?r("ul",e._l(e.shippingTraces,(function(t){return r("li",{key:t.id},[r("i",{staticClass:"node-icon"}),r("span",{staticClass:"txt"},[e._v(e._s(t.station))]),r("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0):e._e(),this.shippingTraces&&0===this.shippingTraces.length?r("ul",[r("div",{staticClass:"info"},[r("div",{staticClass:"i-item"},[e._v(" 物流状态： "),r("span",{staticClass:"l-state"},[e._v(e._s("暂无轨迹"))])]),r("div",{staticClass:"i-item"},[e._v("快递公司："+e._s(e.expressName))]),r("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.curInvoice.expressCode))])])]):e._e()])])])],1):e._e()],1),e.invoiceInfoId?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("提交")]):e._e(),e.invoiceInfoId?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.cancle}},[e._v("取消")]):e._e()],1)},i=[],n=(r("d81d"),r("b0c0"),r("d3b7"),r("5530")),o=r("2f62"),a=r("1ab1"),c=r("c596"),d={name:"my-invoice",data:function(){return{deliverys:[],activeNames:["1"],expressName:"",shippingTraces:[],shippingSn:""}},props:{orderId:{type:String,default:""},orderIds:{type:Array},invoiceInfoId:{type:String,default:""}},components:{},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(o["c"])(["getUser"])),Object(o["c"])("Order",["orderInfo","curInvoice"])),{},{getTraces:function(){return!!(this.shippingTraces&&this.shippingTraces.length>0)}}),watch:{invoiceInfoId:function(e){}},methods:Object(n["a"])(Object(n["a"])({},Object(o["d"])("Order",["updateCurInvoice"])),{},{onContact:function(){this.$router.push({path:"/custom-service"})},getInvoiceInfo:function(){var e=this,t={clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,methodName:"QueryInvoiceBasicInfo"};a["a"].get(c["g"].hypermarketMgmt.invoiceByOrder,t).then((function(t){"0"===t.invoice.invoiceState?(t.invoice.invoiceState="待开票",t.invoice.expressState="待开票"):"1"===t.invoice.invoiceState?(t.invoice.invoiceState="未邮寄",t.invoice.expressState="未邮寄"):"2"===t.invoice.invoiceState&&(t.invoice.invoiceState="已邮寄",t.invoice.expressState="已邮寄"),e.deliverys=t.deliverys,e.shippingSn=t.shipping.sn,e.shippingSn&&e.expressInfo(),e.deliverys.map((function(r){r.id===t.invoice.express&&(e.expressName=r.name)})),t.invoice.area&&(t.invoice.areaName=t.invoice.area.fullName),e.updateCurInvoice(t.invoice)})).catch((function(t){"906"===t.resultCode&&e.updateCurInvoice({})})).finally((function(){}))},handleChange:function(){},cancle:function(){this.$emit("cancle")},submit:function(){var e=this,t={clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,invoiceInfoId:this.curInvoice.id,orderIds:this.orderIds,methodName:"CreateInvoiceBasicInfo"};a["a"].post(c["g"].hypermarketMgmt.applyInvoice,t).then((function(t){e.$message.success("申请成功"),e.$emit("close")})).catch((function(t){e.$message.warning(t.errorMessage),"906"===t.resultCode&&e.updateCurInvoice({})})).finally((function(){}))},expressInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.shippingSn};a["a"].get(c["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}),created:function(){}},l=d,p=(r("6649"),r("2877")),u=Object(p["a"])(l,s,i,!1,null,null,null);t["a"]=u.exports},d4c2:function(e,t,r){"use strict";var s=r("e725"),i=r.n(s);i.a},e2f0:function(e,t,r){"use strict";var s=r("9c7b"),i=r.n(s);i.a},e42c:function(e,t,r){"use strict";var s=r("2497"),i=r("bc3a"),n=r.n(i),o=r("c596");t["a"]={listOrder:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.list,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},viewOrder:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.order:o["g"].orderMgmt.orderMgmt.order,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},updateOrder:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.order:o["g"].orderMgmt.orderMgmt.order,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},createOrder:function(e,t,r){n.a.post("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.order:o["g"].orderMgmt.orderMgmt.order,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},excuteOrder:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.service:o["g"].orderMgmt.orderMgmt.service,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},closeOrder:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.close:o["g"].orderMgmt.orderMgmt.close,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},confirmOrder:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.confirm:o["g"].orderMgmt.orderMgmt.confirm,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},paymentOrder:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.payment:o["g"].orderMgmt.orderMgmt.payment,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},shippingOrder:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.shipping:o["g"].orderMgmt.orderMgmt.shipping,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},repairMaintainHistory:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.repairMaintainHistory,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},listAdminByRole:function(e,t,r){n.a.post(o["g"].orderMgmt.orderMgmt.listAdminByRole,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},listExistCardTemplate:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.listExistCardTemplate,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},viewProducts:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.viewProducts:o["g"].orderMgmt.orderMgmt.viewProducts,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},viewOrderlogs:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.viewOrderlogs:o["g"].orderMgmt.orderMgmt.viewOrderlogs,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},viewOrderRefunds:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.viewOrderRefunds:o["g"].orderMgmt.orderMgmt.viewOrderRefunds,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},queryInvoiceDetailByOrderID:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.queryInvoiceDetailByOrderID:o["g"].orderMgmt.orderMgmt.queryInvoiceDetailByOrderID,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},invoiceMail:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceMail:o["g"].orderMgmt.orderMgmt.invoiceMail,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},invoiceMailUpdate:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceMail:o["g"].orderMgmt.orderMgmt.invoiceMail,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},invoiceInfoDefault:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceInfoDefault:o["g"].orderMgmt.orderMgmt.invoiceInfoDefault,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},invoiceByOrder:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceByOrder:o["g"].orderMgmt.orderMgmt.invoiceByOrder,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},invoiceDetailCreate:function(e,t,r){n.a.post("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoice:o["g"].orderMgmt.orderMgmt.invoice,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},invoiceDetailUpdate:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoice:o["g"].orderMgmt.orderMgmt.invoice,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},invoiceDetail:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.invoiceDetail:o["g"].orderMgmt.orderMgmt.invoiceDetail,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},addOrderItems:function(e,t,r){n.a.post("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.addOrderItems:o["g"].orderMgmt.orderMgmt.addOrderItems,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},brands:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.brands,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},series:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.series,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},types:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.types,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},getFinancialPlans:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.getFinancialPlans,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},memberList:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.memberList,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},options:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.options,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},rescuers:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.rescuers,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},export:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.export,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},rescueOrderLogs:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.rescueOrderLogs,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},loanTerms:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.loanTerms,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},queryOrderKpi:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.queryOrderKpi,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},refundsAudit:function(e,t,r){n.a.put("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.refundsAudit:o["g"].orderMgmt.orderMgmt.refundsAudit,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},rescuerSetting:function(e,t,r){n.a.put(o["g"].orderMgmt.orderMgmt.rescuerSetting,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},rescuerDispath:function(e,t,r){n.a.put(o["g"].orderMgmt.orderMgmt.rescuerDispath,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},carOptions:function(e,t,r){n.a.put(o["g"].orderMgmt.orderMgmt.carOptions,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},createMember:function(e,t,r){n.a.post(o["g"].orderMgmt.orderMgmt.createMember,e).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},certificate:function(e,t,r){n.a.get("purchaseOrder"===window.top.dType?o["g"].orderMgmt.purchaseOrderMgmt.certificate:o["g"].orderMgmt.orderMgmt.certificate,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))},listProductByTestDrive:function(e,t,r){n.a.get(o["g"].orderMgmt.orderMgmt.listProductByTestDrive,{params:e}).then(Object(s["a"])(t,r)).catch((function(e){console.error(e)}))}}},e725:function(e,t,r){},e83a:function(e,t,r){e.exports=r.p+"static/img/pic_default_none.8bd264ad.png"},ea36:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("biz-grid",{staticClass:"bill-info"},[r("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return r("el-card",{key:t.id},[r("div",{on:{click:function(r){return e.selectItem(t)}}},[r("div",{staticClass:"top"},[r("span",[e._v(e._s(t.consignee))]),r("span",[e._v(e._s(t.phone))])]),r("div",{staticClass:"content"},[r("span",[e._v(e._s(t.areaName+t.address))])])]),r("div",{staticClass:"bottom"},["1"===t.isDefault?r("div",[e._v("默认")]):e._e(),"0"===t.isDefault?r("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(r){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(r){e.$set(t,"isDefault",r)},expression:"receiver.isDefault"}},[e._v("设为默认 ")]):e._e(),r("div",{staticClass:"handler"},[r("i",{staticClass:"el-icon-edit-outline",on:{click:function(r){return e.editForm(t)}}},[e._v("编辑")]),r("i",{staticClass:"el-icon-delete",on:{click:function(r){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?r("div",{style:e.styleObject}):e._e(),r("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[r("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small"}},[r("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),r("el-form-item",{attrs:{label:"省市"}},[r("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),r("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[r("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),r("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},i=[],n=(r("d3b7"),r("5530")),o=r("f36f"),a=r("8330"),c=r("1ab1"),d=r("c596"),l=r("2f62"),p=r("ce2e"),u=r("f260"),f=r.n(u),m={components:{BizSaveButton:a["a"],BizAreaSelect:p["a"],BizGrid:o["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(n["a"])(Object(n["a"])({},Object(l["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+f.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(n["a"])(Object(n["a"])({},Object(l["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,r={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){c["a"].delete(d["g"].hypermarketMgmt.receiver,r).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,r){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};c["a"].post(d["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};c["a"].put(d["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.updateSelAddress(e),this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};c["a"].get(d["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},h=m,g=(r("b442"),r("2877")),v=Object(g["a"])(h,s,i,!1,null,null,null);t["a"]=v.exports},f2d4:function(e,t,r){},f606:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFGmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMTEtMTRUMTU6MDE6MjIrMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTA4LTAzVDE5OjEzOjI1KzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTA4LTAzVDE5OjEzOjI1KzA4OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmQ0NWIyMzUyLWJhMzItNDM5NS1iZTliLTgxMTVhNjk1ODBhNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpkNDViMjM1Mi1iYTMyLTQzOTUtYmU5Yi04MTE1YTY5NTgwYTUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkNDViMjM1Mi1iYTMyLTQzOTUtYmU5Yi04MTE1YTY5NTgwYTUiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ0NWIyMzUyLWJhMzItNDM5NS1iZTliLTgxMTVhNjk1ODBhNSIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xNFQxNTowMToyMiswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+kgXFvQAAApVJREFUWIXNl09IVFEYxX/vda+roT9C6EYKkqB/kiEYhLRJB6qNbVrYqhbmYMteUIySrnqLFiEOLmoRumnTpo0pBEVQIARG0cLAqNBpUzIW6L1qi3f905s7zzfDG+zAW3x8Z945zH333vM5xITykEAa6ABagEPAXtP+BXwGpoDnwLj0UXHe68QQrgMyQF9cswYDwLD0yVdsQHncrUC4yIj06S/LgPI4AfSYJwnkgJz0eb+tAeVxDphISDiMdukzWdKA8jgKfKiS+DqOSZ+P64UbavZWWbxIY8OA+eCSWvMo9BgtwCyB2WrzNrbofQMNrZVJfX2LHjpdqlsvffLCFBkrpRZoaEUPOrBYpngKxB2FaOtGvxqxMTJAv2NOuGUbQ3SNQt1J9P3jZaqb36ezcOYmum93KUqNS3C82nHkErzIViQOoMcHwRVRlLRLcLbbsarR755u1inzlKqx1NHoEAQXix0h9yK7BoC+5djre6G6rRt2Rf4DLQJoLNn+8wNxexYen4X9p2BVQ+E7orkz6C8VAqHmTlicg8LcZq1+w/khmJ+OMtDoKI8loMbargVxfRb2HIBVBU8uQ/413PgGOPCoLeBdfQkrGkbMx5r5BK6EhS/oBwejdtBytIGtSBF/K8bnLrvAQhzm+nonzF1wgZnYb04eMy5BjNopTLkEGW6nMBF5FAOIa8+gMQ0rars9HYIDM+PohxejSDVC+ijlMYAt+6WAwxcqv4yya1E7YkD6qMjrWHSNQlNXmcohTI+hx67YOvXSJ78RyRJKwHGxkZTDmXCY6qeinPQ380c4Ew5VWbxI4x8DJq22V1G8fWsiLjJgTEwCTQTDRFLIAU3hmQD+19EsZGLnhtOQEdt4vs+0f1LheP4XcCzJ/0nFX0oAAAAASUVORK5CYII="}}]);