(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2bf2cd8e"],{"08b8":function(t,e,i){"use strict";var n=i("41f9"),a=i.n(n);a.a},"0943":function(t,e,i){"use strict";var n=i("1fac"),a=i.n(n);a.a},"1fac":function(t,e,i){},2497:function(t,e,i){"use strict";var n=i("4360"),a=i("a18c");e["a"]=function(t,e){return function(i){var o=i.data;"100"===o.resultCode?t(o):"709"===o.resultCode?(n["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",n["a"].getters.currentUser),a["a"].push("/login")):e(o)}}},"2c905":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"unknow-problem"},[i("biz-flex-table",{ref:"table",attrs:{operations:t.operations,filters:t.filters,tableData:t.tableData,loading:t.loading,pagination:t.pagination},on:{operate:t.operate,"row-click":t.rowClick,"size-change":t.handleSizeChange,"selection-change":t.handleSelectionChange,"current-change":t.handleCurrentChange}},[i("el-table-column",{attrs:{width:"200",prop:"question",label:"问题"}}),i("el-table-column",{attrs:{prop:"count",label:"次数"}}),i("el-table-column",{attrs:{prop:"date",label:"最近访问时间"}}),i("el-table-column",{attrs:{prop:"answer",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return i.stopPropagation(),t.answer(e.row)}}},[t._v("回答")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return i.stopPropagation(),t.setting(e.row)}}},[t._v("设置为相似问题")])],1)])}}])})],1),i("biz-popup-tabs",{attrs:{open:t.open},on:{close:function(e){t.open=!1}},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"回答",name:"info"}},[i("QaMgmtDetail",{attrs:{itemId:t.itemId},on:{created:t.refresh}})],1),i("el-tab-pane",{attrs:{label:"设置相似问题",name:"problem"}},[i("UnknowProblemInfo",{attrs:{itemId:t.itemId},on:{created:t.refresh}})],1)],1)],1)},a=[],o=(i("4160"),i("a9e3"),i("d3b7"),i("159b"),i("04d3")),s=i("1ab1"),r=i("c596"),c=i("7a16"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"unknow-problem-info"},[i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"125px",size:"small"}},[i("el-form-item",{attrs:{label:"相似问题",prop:"question"}},[i("el-input",{attrs:{disabled:""},model:{value:t.question,callback:function(e){t.question=e},expression:"question"}})],1),i("el-form-item",{attrs:{label:"问题",prop:"similarQuestion"}},[i("el-input",{attrs:{placeholder:"请选择问题",disabled:""},model:{value:t.selectQuestion,callback:function(e){t.selectQuestion=e},expression:"selectQuestion"}},[i("div",{staticClass:"input-append",attrs:{slot:"append"},slot:"append"},[i("el-button",{attrs:{type:"text"},on:{click:t.addQuestion}},[i("i",{staticClass:"iconfont iconfont biz-icon-liebiaoshitu"})])],1)])],1)],1),i("biz-dialog-selector",{attrs:{loading:t.dialogLoading,visibility:t.showDialog,tableData:t.questionList,pagination:t.pagination,filters:t.productFilters,selectionMode:"single",selectionKeys:t.selectedItemKeys},on:{"update:visibility":function(e){t.showDialog=e},pageSizeChange:t.handleSizeChange,currentPageChange:t.handleCurrentChange,confirmed:t.confirm,filterDataChange:t.filterDataChange}},[i("el-table-column",{attrs:{width:"200",prop:"question",label:"问题"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[i("div",[t._v(t._s(e.row.question))]),t._l(e.row.similarQuestion,(function(e){return i("div",{key:e},[t._v(t._s(e))])}))],2)}}])}),i("el-table-column",{attrs:{prop:"answer",label:"答案"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},["1"===e.row.type?i("div",{staticClass:"biz-customcol",domProps:{innerHTML:t._s(e.row.answer)}}):t._e(),"2"===e.row.type?i("div",{staticClass:"biz-customcol"},[i("img",{attrs:{src:e.row.answer,height:"100px"}})]):t._e(),"0"===e.row.type||"3"===e.row.type?i("div",{staticClass:"biz-customcol"},[t._v(" "+t._s(e.row.answer)+" ")]):t._e()])}}])}),i("el-table-column",{attrs:{prop:"type",label:"类型",formatter:t.getType}}),i("el-table-column",{attrs:{prop:"date",label:"变更时间"}})],1)],1)},u=[],f=(i("99af"),i("f36f")),p=i("8330"),d=i("af3f"),m={name:"QaMgmtDetail",props:{itemId:{type:String,default:function(){return""}}},data:function(){return{loading:!1,isSetting:!1,dialogLoading:!1,showDialog:!1,width:320,videoType:"video",selectQuestion:"",question:"",operations:[{label:"保存",name:"save",type:"primary"}],rules:{question:[{required:!0,message:"请填写问题",trigger:"blur"}]},form:{},questionList:[],selectedItemKeys:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},productFilters:[{type:"input",placeholder:"请输入问题关键字",name:"searchbar",value:""}]}},components:{BizGrid:f["a"],BizSaveButton:p["a"],BizDialogSelector:d["a"]},methods:{operate:function(t){this[t]()},typeChange:function(){this.form.answer=""},save:function(){var t=this;this.form.id?s["a"].put(r["f"].smartReception.knowledgeStock,this.form).then((function(e){t.loading=!1,t.$message.success("操作成功"),t.deleteItem(t.itemId)})).catch((function(e){t.loading=!1,console.log("ERR_REFRESH: ",e),t.$message.warning(e.errorMessage)})):this.$message.warning("请选择问题")},deleteItem:function(t){var e=this;this.loading=!0,s["a"].delete(r["f"].smartReception.knowledgeStock,{ids:[t]}).then((function(t){e.$message.success("操作成功"),e.$emit("created"),e.loading=!1})).catch((function(t){e.loading=!1,t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},getType:function(t){switch(t.type){case"0":return"纯文本";case"1":return"富文本";case"2":return"图片";case"3":return"超链接";default:break}},refresh:function(t){var e=this;this.loading=!0;var i={id:this.itemId||t};s["a"].get(r["f"].smartReception.knowledgeStock,i).then((function(t){e.loading=!1,e.question=t.data.question})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),e.$message.warning(t.errorMessage)}))},addQuestion:function(){this.queryQuestionList(),this.showDialog=!0},queryQuestionList:function(){var t=this,e={searchValue:this.productFilters[0].value,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};this.dialogLoading=!0,s["a"].get(r["f"].smartReception.knowledges,e).then((function(e){t.dialogLoading=!1,t.questionList=e.content,t.pagination.total=Number(e.total)})).catch((function(e){t.dialogLoading=!1,t.$message.warning(e.errorMessage||"操作错误")}))},confirm:function(t,e){var i=this;console.log(e),this.selectQuestion=e[0].question;var n={id:e[0].id};s["a"].get(r["f"].smartReception.knowledgeStock,n).then((function(t){i.loading=!1,i.form=Object.assign(t.data,{similarQuestion:t.data.similarQuestion.concat([i.question])})})).catch((function(t){i.loading=!1,console.log("ERR_REFRESH: ",t),i.$message.warning(t.errorMessage)}))},filterDataChange:function(t){this.queryQuestionList()},handleSizeChange:function(t){this.pagination.pageSize=t,this.queryProductList()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.queryProductList()}},mounted:function(){},watch:{itemId:function(t,e){t&&this.refresh()}}},g=m,h=(i("3538"),i("2877")),v=Object(h["a"])(g,l,u,!1,null,null,null),b=v.exports,y=i("7132"),w={name:"QaMgmt",data:function(){return{tabName:"info",itemId:"",loading:!1,open:!1,selections:[],tableData:[],operations:[{label:"忽略",name:"delete",type:"primary"}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},filters:[]}},components:{BizFlexTable:o["c"],QaMgmtDetail:c["a"],BizPopupTabs:y["a"],UnknowProblemInfo:b},created:function(){this.getList()},mounted:function(){},watch:{$route:function(t,e){this.getList()}},methods:{operate:function(t){this[t]()},refresh:function(){this.getList()},exportExcle:function(){},add:function(){this.itemId="",this.open=!0},rowClick:function(t,e,i){this.itemId=t.id,this.open=!0},answer:function(t){this.tabName="info",this.itemId=t.id,this.open=!0},setting:function(t){this.tabName="problem",this.itemId=t.id,this.open=!0},delete:function(){if(this.selections&&this.selections.length>0){var t=[];this.selections.forEach((function(e){t.push(e.id)})),this.deleteItem(t)}else this.$message("请选择一条数据")},deleteItem:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,s["a"].delete(r["f"].smartReception.knowledgeStock,{ids:t}).then((function(t){e.$message.success("操作成功"),e.refresh(),e.loading=!1})).catch((function(t){e.loading=!1,t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))},getList:function(){var t=this,e={pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,shopId:window.top.SHOP_ID||"",type:"10001"};this.loading=!0,s["a"].get(r["f"].smartReception.knowledges,e).then((function(e){t.tableData=e.content,t.pagination.total=Number(e.total),t.loading=!1})).catch((function(e){console.log(e),console.log("code错误"),t.loading=!1,e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},handleSizeChange:function(t){this.pagination.pageSize=t,this.refresh()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.refresh()},handleSelectionChange:function(t){this.selections=t}}},S=w,C=(i("c275"),Object(h["a"])(S,n,a,!1,null,null,null));e["default"]=C.exports},3538:function(t,e,i){"use strict";var n=i("4dbc"),a=i.n(n);a.a},"41f9":function(t,e,i){},"4dbc":function(t,e,i){},"5b8e":function(t,e,i){"use strict";var n=i("9678"),a=i.n(n);a.a},6297:function(t,e,i){"use strict";i("96cf");var n=i("1da1"),a=i("2497"),o=i("bc3a"),s=i.n(o),r=i("c596");e["a"]={getKPI:function(t,e,i){s.a.get(r["g"].activityMgmt.ActivityKPI,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getShopList:function(t,e,i){s.a.get(r["g"].activityMgmt.getShopList,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getActivityList:function(t,e,i){s.a.get(r["g"].activityMgmt.ActivityList,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getInitInfo:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,i,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s.a.get(r["g"].activityMgmt.getInitInfo,{params:e}).then(Object(a["a"])(i,n)).catch((function(t){console.error(t)}));case 1:case"end":return t.stop()}}),t)})));function e(e,i,n){return t.apply(this,arguments)}return e}(),getActivity:function(t,e,i){s.a.get(r["g"].activityMgmt.Activity,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},createActivity:function(t,e,i){s.a.post(r["g"].activityMgmt.Activity,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},updateActivity:function(t,e,i){s.a.put(r["g"].activityMgmt.Activity,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},deleteActivity:function(t,e,i){s.a.delete(r["g"].activityMgmt.Activity,{data:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getMatchActivityList:function(t,e,i){s.a.get(r["g"].activityMgmt.matchActivityList,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getAwardList:function(t,e,i){s.a.get(r["g"].activityMgmt.AwardList,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},createAward:function(t,e,i){s.a.post(r["g"].activityMgmt.Award,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getAward:function(t,e,i){s.a.get(r["g"].activityMgmt.Award,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},updateAward:function(t,e,i){s.a.put(r["g"].activityMgmt.Award,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},deleteAward:function(t,e,i){s.a.delete(r["g"].activityMgmt.Award,{data:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getActivityNotice:function(t,e,i){s.a.get(r["g"].activityMgmt.ActivityNotice,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getLocalActivityNotice:function(t,e,i){s.a.get(r["g"].activityMgmt.LocalActivityNotice,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},updateActivityNotice:function(t,e,i){s.a.put(r["g"].activityMgmt.ActivityNotice,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},updateLocalActivityNotice:function(t,e,i){s.a.put(r["g"].activityMgmt.LocalActivityNotice,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},publishActivityNotice:function(t,e,i){s.a.post(r["g"].activityMgmt.PublishActivityNotice,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},publishLocalActivityNotice:function(t,e,i){s.a.post(r["g"].activityMgmt.PublishLocalActivityNotice,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getActivityParticipant:function(t,e,i){s.a.get(r["g"].activityMgmt.ActivityParticipant,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getBKRecordList:function(t,e,i){s.a.get(r["g"].activityMgmt.BKRecord,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},verification:function(t,e,i){s.a.post(r["g"].activityMgmt.Verification,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},getStatisticsAnalysis:function(t,e,i){s.a.get(r["g"].activityMgmt.StatisticsAnalysis,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},submit:function(t,e,i){s.a.post(r["g"].activityMgmt.Verified,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},PassOrNot:function(t,e,i){s.a.post(r["g"].activityMgmt.Pass,t).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},publishActivity:function(t,e,i){s.a.get(r["g"].activityMgmt.Publish,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},Revocation:function(t,e,i){s.a.get(r["g"].activityMgmt.Revocation,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))},exportAttend:function(t,e,i){s.a.get(r["g"].activityMgmt.exportAttend,{params:t}).then(Object(a["a"])(e,i)).catch((function(t){console.error(t)}))}}},"697f":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:t.title,visible:t.dialogVisible,"append-to-body":t.appendToBody},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close,open:t.open}},[t._t("top"),i("biz-flex-table",{ref:"table",attrs:{showTable:t.showTable,operations:t.operations,filters:t.filters,tags:t.tags,rowKeys:t.rowKeys,pagination:t.pagination,tableData:t.tableData,rowClassName:t.rowClassName,loading:t.loading,memberIds:t.memberIds,checkable:t.checkable,isDepotOutNew:t.isDepotOutNew,checkedTable:t.checkedTable},on:{operate:t.operate,"row-click":t.rowClick,"filter-data-change":t.filterDataChange,"select-all":t.handleSelectAll,select:t.handleSelectionChange,"size-change":t.pageSizeChange,"current-change":t.currentPageChange,"cascader-change":t.cascaderChange,"active-item-change":t.activeItemChange,"sort-change":t.handleSortChange}},[t._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.isClear?i("el-button",{attrs:{size:"small"},on:{click:t.clear}},[t._v("清除")]):t._e(),i("el-button",{attrs:{size:"small"},on:{click:t.close}},[t._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirmed}},[t._v("确定")])],1)],2)},a=[],o=(i("99af"),i("4160"),i("c975"),i("a434"),i("a9e3"),i("159b"),i("04d3")),s={name:"BizDialogSelector",components:{BizFlexTable:o["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(t){return t.id},generateSelectionKeys:function(t,e){if(t.indexOf(e)>=0)this.innerSelectionKeys.push(e[this.keyField]),this.innerSelection.push(e);else{var i=this.innerSelectionKeys.indexOf(e[this.keyField]);this.innerSelectionKeys.splice(i,1),this.innerSelection.splice(i,1)}},open:function(t){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(t){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var t=this;this.tableData.forEach((function(e){t.$refs.table.toggleRowSelection(e,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var t=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(e){t.innerSelectionKeys.indexOf(e[t.keyField])>=0?(t.$refs.table.toggleRowSelection(e,!0),"single"===t.selectionMode&&(t.$refs.table.$refs.table.setCurrentRow(e),t.innerSelection=[e])):t.$refs.table.toggleRowSelection(e,!1)}))},operate:function(t){this.$emit("operate",t)},filterDataChange:function(t){this.$emit("filterDataChange",t)},handleSelectAll:function(t){var e=this;0===t.length?this.tableData.forEach((function(t){var i=e.innerSelectionKeys.indexOf(t[e.keyField]);i>=0&&e.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(t){var i=e.innerSelectionKeys.indexOf(t[e.keyField]);i<0&&e.innerSelectionKeys.push(t[e.keyField])})),this.$emit("selectionChange",t)},handleSelectionChange:function(t,e){this.generateSelectionKeys(t,e),this.$emit("selectionChange",t)},pageSizeChange:function(t){this.$emit("pageSizeChange",t)},currentPageChange:function(t){this.$emit("currentPageChange",t)},cascaderChange:function(t){this.$emit("cascaderChange",t)},activeItemChange:function(t){this.$emit("active-item-change",t)},handleSortChange:function(t){this.$emit("sort-change",t)},rowClick:function(t,e,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[t[this.keyField]],this.innerSelection=[t])}},watch:{visibility:function(t,e){this.dialogVisible=t,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},r=s,c=(i("0943"),i("2877")),l=Object(c["a"])(r,n,a,!1,null,null,null);e["a"]=l.exports},7132:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"biz-fade-t"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(e){return e.target!==e.currentTarget?null:t.close(e)}}},[i("transition",{attrs:{name:"biz-fade-t-right"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"popup-content",style:t.contentStyle},[t._t("default")],2)])],1)])},a=[],o={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},s=o,r=(i("5b8e"),i("2877")),c=Object(r["a"])(s,n,a,!1,null,null,null),l=c.exports,u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"biz-popup-tabs"},[i("biz-popup",{attrs:{open:t.open,contentStyle:t.contentStyle},on:{close:t.close}},[i("el-tabs",{attrs:{type:"border-card",value:t.value},on:{"tab-click":t.tabClick}},[t._t("default")],2)],1)],1)},f=[],p=(i("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:l},methods:{close:function(){var t=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("close")}))},tabClick:function(t){this.$emit("input",t.name)}}}),d=p,m=(i("d4c2"),Object(r["a"])(d,u,f,!1,null,null,null)),g=m.exports;i.d(e,"a",(function(){return g}))},"7a16":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"qa-mgmt-info"},[i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"100px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"类型",prop:"type"}},[i("el-radio-group",{staticStyle:{"line-height":"20px"},on:{change:t.typeChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[i("el-radio",{attrs:{label:"0"}},[t._v("纯文本")]),i("el-radio",{attrs:{label:"1"}},[t._v("富文本")]),i("el-radio",{attrs:{label:"3"}},[t._v("图片")]),i("el-radio",{attrs:{label:"2"}},[t._v("超链接")]),i("el-radio",{attrs:{label:"1002"}},[t._v("音频")]),i("el-radio",{attrs:{label:"1001"}},[t._v("商品")]),i("el-radio",{attrs:{label:"1004"}},[t._v("功能")]),i("el-radio",{attrs:{label:"1005"}},[t._v("活动")]),i("el-radio",{attrs:{label:"1006"}},[t._v("抽奖")])],1)],1),i("el-form-item",{attrs:{label:"匹配方式",prop:"matchMode"}},[i("el-radio-group",{model:{value:t.form.matchMode,callback:function(e){t.$set(t.form,"matchMode",e)},expression:"form.matchMode"}},[i("el-radio",{attrs:{label:"0"}},[t._v("模糊")]),i("el-radio",{attrs:{label:"1"}},[t._v("精准")])],1)],1),i("el-form-item",{attrs:{label:"问答名称",prop:"name"}},[i("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"问题",prop:"question"}},[i("div",{staticStyle:{float:"right"},attrs:{slot:"label"},slot:"label"},[t._v(" 问题 "),i("el-button",{directives:[{name:"popover",rawName:"v-popover:onTimePop",arg:"onTimePop"}],attrs:{type:"text",size:"small"}},[i("i",{staticClass:"iconfont el-icon-question"})]),i("el-popover",{ref:"onTimePop",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"组合问题需要用 & 分隔"}})],1),i("el-input",{attrs:{placeholder:"请输入问题"},model:{value:t.form.question,callback:function(e){t.$set(t.form,"question",e)},expression:"form.question"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-plus"},on:{click:t.addProblem},slot:"append"})],1)],1),t._l(t.form.similarQuestion,(function(e,n){return i("el-form-item",{key:n,attrs:{label:"",prop:"similarQuestion"}},[i("el-input",{attrs:{placeholder:"请输入问题"},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"similarQuestion.name"}})],1)})),"0"===t.form.type||"2"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"answer"}},[i("el-input",{attrs:{placeholder:"请输入答案",type:"textarea",autosize:{minRows:4,maxRows:6}},model:{value:t.form.answer,callback:function(e){t.$set(t.form,"answer",e)},expression:"form.answer"}})],1):t._e(),"1"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"answer"}},[i("biz-editor",{ref:"editor",attrs:{height:"400px",width:"320px"},model:{value:t.form.answer,callback:function(e){t.$set(t.form,"answer",e)},expression:"form.answer"}})],1):t._e(),"3"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"answer"}},[i("BizAvatarUploaderNew",{model:{value:t.form.answer,callback:function(e){t.$set(t.form,"answer",e)},expression:"form.answer"}})],1):t._e(),"1002"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"files"}},[i("biz-file-uploader",{attrs:{data:{type:2},fileList:t.form.fileList},model:{value:t.form.files,callback:function(e){t.$set(t.form,"files",e)},expression:"form.files"}})],1):t._e(),"1004"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"answer"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.answer,callback:function(e){t.$set(t.form,"answer",e)},expression:"form.answer"}},t._l(t.functionAnswerList,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e(),"1005"===t.form.type||"1006"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"activeAnswer"}},[i("div",{staticClass:"product-list el-upload-list el-upload-list--picture-card"},[t._l(t.activeAnswerList,(function(e){return i("div",{key:e.index,staticClass:"img-preview el-upload-list__item is-success",attrs:{tabindex:"0"}},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:e.cover||t.defaultImg,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(i){return t.handleRemoveActive(e.id)}}},[i("i",{staticClass:"el-icon-delete"})])]),i("div",{staticClass:"detail_info"},[i("span",[t._v(t._s(e.title))])])])})),i("div",{staticClass:"avatar-uploader",on:{click:t.addActive}},[i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],2)]):t._e(),"1001"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"productList"}},[i("div",{staticClass:"product-list el-upload-list el-upload-list--picture-card"},[t._l(t.productList,(function(e){return i("div",{key:e.index,staticClass:"img-preview el-upload-list__item is-success",attrs:{tabindex:"0"}},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:e.image||t.defaultImg,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(i){return t.handleRemove(e.id)}}},[i("i",{staticClass:"el-icon-delete"})])]),i("div",{staticClass:"detail_info"},[i("span",[t._v(t._s(e.fullName))]),i("span",[t._v("￥"+t._s(e.price)+"元")])])])})),i("div",{staticClass:"avatar-uploader",on:{click:t.addProduct}},[i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],2)]):t._e(),i("el-form-item",{attrs:{label:"访问次数",prop:"count"}},[i("el-input",{attrs:{disabled:""},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}})],1),i("el-form-item",{attrs:{label:"最近访问时间",prop:"date"}},[i("el-input",{attrs:{disabled:""},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),i("el-form-item",{attrs:{label:"权重",prop:"weight"}},[i("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:t.form.weight,callback:function(e){t.$set(t.form,"weight",e)},expression:"form.weight"}})],1)],2),i("biz-dialog-selector",{attrs:{loading:t.dialogLoading,visibility:t.showDialog,tableData:t.products,pagination:t.pagination,filters:t.productFilters,selectionKeys:t.selectedItemKeys},on:{"update:visibility":function(e){t.showDialog=e},pageSizeChange:t.handleSizeChange,currentPageChange:t.handleCurrentChange,confirmed:t.confirm,filterDataChange:t.filterDataChange}},[i("el-table-column",{attrs:{property:"sn",label:"编号"}}),i("el-table-column",{attrs:{property:"name",label:"名称"}}),i("el-table-column",{attrs:{property:"price",label:"价格"}}),i("el-table-column",{attrs:{prop:"stock",label:"剩余库存/库存总数",sortable:"custom",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[i("div",{staticClass:"biz-customcol"},[t._v(" "+t._s(e.row.availableStock)+"/ "),i("span",{style:{color:t.stateColor(e.row)}},[t._v(t._s(e.row.stock))])])])}}])})],1),i("biz-dialog-selector",{attrs:{loading:t.dialogLoading,visibility:t.showDialogActive,tableData:t.actives,pagination:t.paginationActive,selectionKeys:t.selectedItemKeysActive,filters:t.activeFilters},on:{"update:visibility":function(e){t.showDialogActive=e},pageSizeChange:t.handleSizeChangeActive,currentPageChange:t.handleCurrentChangeActive,confirmed:t.confirmActive,filterDataChange:t.filterDataChangeActive}},[i("el-table-column",{attrs:{prop:"title",label:"活动名称"}}),i("el-table-column",{attrs:{prop:"shopname",label:"店铺名称"}}),i("el-table-column",{attrs:{prop:"type",formatter:t.getState,label:"状态"}}),i("el-table-column",{attrs:{prop:"beginDate",sortable:"custom",label:"开始时间"}}),i("el-table-column",{attrs:{prop:"endDate",sortable:"custom",label:"结束时间"}}),i("el-table-column",{attrs:{prop:"createDate",label:"创建时间"}})],1)],1)},a=[],o=(i("99af"),i("4160"),i("a15b"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("ac1f"),i("1276"),i("159b"),i("f36f")),s=i("8330"),r=i("1ab1"),c=i("c596"),l=i("40ae"),u=i("c17f"),f=i("f3ac"),p=i.n(f),d=i("af3f"),m=i("6297"),g={name:"QaMgmtDetail",props:{itemId:{type:String,default:function(){return""}}},data:function(){var t=this;return{dialogLoading:!1,showDialog:!1,showDialogActive:!1,loading:!1,products:[],actives:[],defaultImg:p.a,selectedItemKeys:[],selectedItemKeysActive:[],productList:[],activeAnswerList:[],videoType:"video",operations:[{label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请填写问答名称",trigger:"blur"}],question:[{required:!0,message:"请填写问题",trigger:"blur"}],files:[{required:!0,message:"请填写答案",trigger:"blur"}],answer:[{required:!0,message:"请填写答案",trigger:"blur"},{trigger:"blur",validator:function(e,i,n){var a=/^(http|https|ftp):\/\/([A-Z0-9][A-Z0-9_-]*(?:\.[A-Z0-9][A-Z0-9_-]*)+):?(\d+)?\/?/i;"2"!==t.form.type||a.test(i)?n():n(new Error("请输入正确的超链接地址"))}}]},productFilters:[{type:"input",placeholder:"请输入编号/商品名",name:"searchbar",value:""}],activeFilters:[{type:"radio",label:"活动类型：",name:"type",value:"2",options:[{label:"抽奖",value:"2"},{label:"活动招募",value:"9"}]}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},paginationActive:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},functionAnswerList:[],form:this.resetForm()}},components:{BizGrid:o["a"],BizSaveButton:s["a"],BizEditor:l["a"],BizAvatarUploaderNew:u["b"],BizFileUploader:u["d"],BizDialogSelector:d["a"]},methods:{stateColor:function(t){return t.stock>5?"#333333":"#f56c6c"},getFunctionAnswerList:function(){var t=this;r["a"].get("/admin/reception/receptionBusseniess.jhtml",{}).then((function(e){t.loading=!1,t.functionAnswerList=e.datas})).catch((function(e){t.loading=!1,console.log("ERR_REFRESH: ",e),t.$message.warning(e.errorMessage)}))},getState:function(t){switch(t.stateStr){case"0":return"未开始";case"1":return"9"===t.typeStr&&t.attendCount<t.maxPersonCount?"进行中":"9"===t.typeStr&&t.attendCount===t.maxPersonCount?"已结束":"进行中";case"2":return"已结束";case"3":return"已创建";case"4":return"已提交";case"5":return"已取消";default:return""}},addActive:function(){"1006"===this.form.type?this.activeFilters=[{type:"radio",label:"活动类型：",name:"type",value:"2",options:[{label:"抽奖",value:"2"}]}]:this.activeFilters=[{type:"radio",label:"活动类型：",name:"type",value:"9",options:[{label:"招募活动",value:"9"}]}],this.showDialogActive=!0,this.getActivityList()},getActivityList:function(){var t=this;this.dialogLoading=!0;var e={typeStr:this.activeFilters[0].value,pageNumber:this.paginationActive.currentPage,pageSize:this.paginationActive.pageSize};m["a"].getActivityList(e,(function(e){t.dialogLoading=!1,t.actives=e.content,t.paginationActive.total=Number(e.total)}),(function(e){t.dialogLoading=!1,console.log(e),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},filterDataChangeActive:function(t){this.paginationActive.currentPage=1,this.getActivityList()},handleSizeChangeActive:function(t){this.paginationActive.pageSize=t,this.getActivityList()},handleCurrentChangeActive:function(t){this.paginationActive.currentPage=t,this.getActivityList()},filterDataChange:function(t){this.pagination.currentPage=1,this.queryProductList()},handleSizeChange:function(t){this.pagination.pageSize=t,this.queryProductList()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.queryProductList()},confirm:function(t){this.selectedItemKeys=t||this.selectedItemKeys,this.form.productList=this.selectedItemKeys.map((function(t){return{id:t}})),this.queryProductsByIds(this.selectedItemKeys),this.$refs.form.clearValidate("productList")},confirmActive:function(t,e){console.log(e),this.selectedItemKeysActive=t||this.selectedItemKeysActive,this.activeAnswerList=e},queryActivesByIds:function(t){var e=this;r["a"].post("/admin/marketing/activityList.jhtml",{ids:t}).then((function(t){e.activeAnswerList=t.activityList})).catch()},queryProductsByIds:function(t){var e=this;r["a"].post(c["d"].publicity.editArticle.findProduct,{ids:t}).then((function(t){e.productList=t.content.concat(e.productList),e.form.productList=e.productList.map((function(t){return{id:t.id}}))})).catch()},queryProductList:function(){var t=this,e={searchValue:this.productFilters[0].value,state:"2",shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};this.dialogLoading=!0,r["a"].get("/admin/product/union/list.jhtml",e).then((function(e){t.dialogLoading=!1,t.products=e.content,t.pagination.total=Number(e.total)})).catch((function(e){t.dialogLoading=!1,t.$message.warning(e.errorMessage||"操作错误")}))},addProduct:function(){this.selectedItemKeys=this.productList,this.productFilters[0].value="",this.pagination.currentPage=1,this.queryProductList(),this.showDialog=!0},handleRemove:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.removePic(t)}))},handleRemoveActive:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.removeActive(t)}))},removeActive:function(t){for(var e=this,i=0;i<this.activeAnswerList.length;i++)this.activeAnswerList[i].id===t&&this.activeAnswerList.splice(i,1),this.selectedItemKeysActive.forEach((function(i,n){if(i===t)return e.selectedItemKeysActive.splice(n,1),!1}))},removePic:function(t){for(var e=this,i=0;i<this.productList.length;i++)this.productList[i].id===t&&this.productList.splice(i,1),this.form.productList=this.productList.map((function(t){return{id:t.id}})),this.selectedItemKeys.forEach((function(i,n){if(i===t)return e.selectedItemKeys.splice(n,1),!1}))},operate:function(t){this[t]()},resetForm:function(){return{question:"",similarQuestion:[],type:"0",answer:"",id:"",name:"",matchMode:"1",weight:"0",files:[],fileList:[]}},clear:function(){this.form=this.resetForm(),this.$refs.form.resetFields(),this.productList=[]},typeChange:function(){this.form.answer=""},save:function(){var t=this;this.$refs.form.validate((function(e,i){if(e){if("10001"===t.form.type)return void t.$message.warning("请选择类型");if("1002"===t.form.type&&(t.form.answer=t.form.files[0]),"1001"===t.form.type){var n=t.form.productList.map((function(t){return t.id}));t.form.answer=n.join(",")}if("1005"===t.form.type||"1006"===t.form.type){var a=t.activeAnswerList.map((function(t){return t.id}));t.form.answer=a.join(",")}t.form.similarQuestion=t.form.similarQuestion.length>0?t.form.similarQuestion.map((function(t){return t.name})):[],t.form=Object.assign(t.form,{similarQuestion:t.form.similarQuestion}),t.form.id?r["a"].put(c["f"].smartReception.knowledgeStock,t.form).then((function(e){t.loading=!1,t.$message.success("更新成功"),t.$emit("created"),t.refresh(e.id)})).catch((function(e){t.loading=!1,console.log("ERR_REFRESH: ",e),t.$message.warning(e.errorMessage)})):r["a"].post(c["f"].smartReception.knowledgeStock,t.form).then((function(e){t.loading=!1,t.$message.success("保存成功"),t.$emit("created"),t.refresh(e.id)})).catch((function(e){t.loading=!1,console.log("ERR_REFRESH: ",e),t.$message.warning(e.errorMessage)}))}}))},refresh:function(t){var e=this;this.loading=!0;var i={id:this.itemId||t};r["a"].get(c["f"].smartReception.knowledgeStock,i).then((function(t){if(e.loading=!1,e.form=Object.assign(e.resetForm(),t.data),"1002"===e.form.type&&(e.form.files=[e.form.answer],e.form.fileList=[{name:e.form.answer,url:e.form.answer}]),e.form.similarQuestion=t.data.similarQuestion&&t.data.similarQuestion.length>0?t.data.similarQuestion.map((function(t){return{name:t}})):[],"10001"===e.form.type&&(e.form.type="0"),"1001"===e.form.type){var i=e.form.answer.split(",");e.queryProductsByIds(i)}if("1005"===e.form.type||"1006"===e.form.type){var n=e.form.answer.split(",");e.queryActivesByIds(n)}})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),e.$message.warning(t.errorMessage)}))},addProblem:function(){this.form.similarQuestion.push({name:""})}},mounted:function(){this.getFunctionAnswerList()},watch:{itemId:function(t,e){this.clear(),t&&this.refresh()}}},h=g,v=(i("08b8"),i("2877")),b=Object(v["a"])(h,n,a,!1,null,null,null);e["a"]=b.exports},9678:function(t,e,i){},af3f:function(t,e,i){"use strict";var n=i("697f");e["a"]=n["a"]},c275:function(t,e,i){"use strict";var n=i("e109"),a=i.n(n);a.a},d4c2:function(t,e,i){"use strict";var n=i("e725"),a=i.n(n);a.a},e109:function(t,e,i){},e725:function(t,e,i){},f3ac:function(t,e,i){t.exports=i.p+"static/img/pic_default_none_100.6603f4ac.png"}}]);