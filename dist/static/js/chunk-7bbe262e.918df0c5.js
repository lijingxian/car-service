(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7bbe262e"],{2497:function(e,t,n){"use strict";var o=n("4360"),a=n("a18c");t["a"]=function(e,t){return function(n){var r=n.data;"100"===r.resultCode?e(r):"709"===r.resultCode?(o["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",o["a"].getters.currentUser),a["a"].push("/login")):t(r)}}},"25eb":function(e,t,n){var o=n("23e7"),a=n("c20d");o({target:"Number",stat:!0,forced:Number.parseInt!=a},{parseInt:a})},"2e2b":function(e,t,n){"use strict";var o=n("79f5"),a=n.n(o);a.a},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var o=n("1d80"),a=n("5899"),r="["+a+"]",i=RegExp("^"+r+r+"*"),s=RegExp(r+r+"*$"),l=function(e){return function(t){var n=String(o(t));return 1&e&&(n=n.replace(i,"")),2&e&&(n=n.replace(s,"")),n}};e.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(e,t,n){"use strict";var o=n("9678"),a=n.n(o);a.a},7132:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"biz-fade-t"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[n("transition",{attrs:{name:"biz-fade-t-right"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},a=[],r={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},i=r,s=(n("5b8e"),n("2877")),l=Object(s["a"])(i,o,a,!1,null,null,null),c=l.exports,u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"biz-popup-tabs"},[n("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[n("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},f=[],p=(n("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),m=p,d=(n("d4c2"),Object(s["a"])(m,u,f,!1,null,null,null)),h=d.exports;n.d(t,"a",(function(){return h}))},"79f5":function(e,t,n){},9678:function(e,t,n){},a0b7:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vehicle-mgmt-cost"},[n("biz-flex-table",{ref:"table",attrs:{filters:e.filters,operations:e.operations,pagination:e.pagination,tableData:e.tableData,loading:e.loading},on:{operate:e.operateHandler,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"row-click":e.rowOperationClickHandler,"selection-change":e.selectionChangeHandler,"filter-data-change":e.filterDataChangeHandler,"sort-change":e.handleSortChange}},[n("el-table-column",{attrs:{prop:"car.plateNumber",label:"车牌号"}}),n("el-table-column",{attrs:{prop:"type",label:"费用类型",formatter:e.typeConverter}}),n("el-table-column",{attrs:{prop:"cost",label:"金额"}}),n("el-table-column",{attrs:{prop:"member.name",label:"申请人",formatter:e.formatName}}),n("el-table-column",{attrs:{prop:"verifyState",label:"状态",formatter:e.stateConverter}}),n("el-table-column",{attrs:{prop:"happenDate",label:"申请日期",sortable:""}}),n("el-table-column",{attrs:{prop:"tag",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"===t.row.needVerify?n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return e.rowOperationClickHandler(t.row)}}},[e._v(" 审核 ")]):e._e()]}}])})],1),n("div",{attrs:{slot:"float"},slot:"float"},[n("cost-popup",{attrs:{open:e.open,itemId:e.itemId},on:{close:function(t){e.open=!1},operationSuccess:e.operationSuccess}})],1)],1)},a=[],r=(n("99af"),n("4160"),n("d81d"),n("b0c0"),n("a9e3"),n("25eb"),n("159b"),n("04d3")),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[n("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[n("cost-base-info",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1)],1)},s=[],l=n("7132"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("biz-grid",{staticClass:"vehicle-mgmt-cost__base-info"},["1"===e.itemId.needVerify?n("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}):e._e(),n("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,disabled:"0"===e.itemId.needVerify}},[n("el-form-item",{attrs:{label:"日期"}},[n("span",[e._v(e._s(e.formModel.happenDate))])]),n("el-form-item",{attrs:{label:"车牌"}},[n("span",[e._v(e._s(e.formModel.car.plateNumber))])]),n("el-form-item",{attrs:{label:"驾驶员"}},[n("span",[e._v(e._s(e.formModel.member.name||e.formModel.member.nickname))])]),n("el-form-item",{attrs:{label:"费用类型"}},[n("span",[e._v(e._s(e.typeConverter(e.formModel.type)+" "+(e.formModel.userDefineAlias||"")))])]),n("el-form-item",{attrs:{label:"金额"}},[n("span",[e._v(e._s(e.formModel.cost))])]),n("el-form-item",{attrs:{label:"状态"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.verifyState,callback:function(t){e.$set(e.formModel,"verifyState",t)},expression:"formModel.verifyState"}},e._l(e.stateList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{label:"审核人"}},[n("span",[e._v(e._s(e.formModel.operator.name))])]),n("el-form-item",{attrs:{label:"备注"}},[n("el-input",{attrs:{placeholder:"请输入备注信息",type:"textarea"},model:{value:e.formModel.verifyRemarks,callback:function(t){e.$set(e.formModel,"verifyRemarks",t)},expression:"formModel.verifyRemarks"}})],1),n("el-form-item",{attrs:{label:"凭证"}},e._l(e.formModel.images,(function(t,o){return n("img",{key:o,staticClass:"uploaded-image",attrs:{src:t},on:{click:function(n){return e.handleImageClick(n,t)}}})})),0)],1),n("el-dialog",{staticClass:"avatar-preview-dialog",attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",{staticClass:"review"},[n("img",{attrs:{src:e.imgUrl,alt:""}})])])],1)},u=[],f=n("f36f"),p=n("8330"),m=n("2497"),d=n("bc3a"),h=n.n(d),g=n("c596"),b={query:function(e,t,n){h.a.get(g["g"].vehicleMgmt.CostBaseInfo_query,{params:e}).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))},add:function(e,t,n){h.a.post(g["g"].vehicleMgmt.CostBaseInfo_save,e).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))},update:function(e,t,n){h.a.post(g["g"].vehicleMgmt.CostBaseInfo_save,e).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))},queryTypeList:function(e,t,n){h.a.get(g["g"].vehicleMgmt.VehicleMgmtCost_queryTypeList,{params:e}).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))}},v={name:"CostBaseInfo",components:{BizSaveButton:p["a"],BizGrid:f["a"]},data:function(){return{dialogVisible:!1,imgUrl:"",pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},operations:[{label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请输入设备名称",trigger:"blur"}]},stateList:[],formModel:this.getDefaultModel(),activeNames:["1"],typeList:[]}},props:{itemId:{type:Object,default:function(){return{id:""}}}},created:function(){this.stateList=[{id:"0",name:"未审核"},{id:"1",name:"审核通过"},{id:"2",name:"审核未通过"}],this.queryTypeList()},methods:{getSaveParams:function(){return{id:this.formModel.id,verifyState:this.formModel.verifyState,remarks:this.formModel.verifyRemarks}},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return{car:{},member:{},operator:{},list:[]}},operateHandler:function(e){this[e]()},handleAddressChange:function(e){this.formModel.address=e},handleUploadSuccess:function(e){this.formModel.cover=e},handleImageClick:function(e,t){this.dialogVisible=!0,this.imgUrl=t},typeConverter:function(e){return this.typeList.length>0?this.typeList[Number(e)]?this.typeList[Number(e)].label:"":e},queryTypeList:function(){var e=this;b.queryTypeList({},(function(t){e.typeList=t.content}),(function(e){console.log(e),console.log("code错误")}))},save:function(){var e=this;this.$refs.form.validate((function(t,n){if(!t)return!1;e.formModel.id?b.update(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)})):b.add(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))}))}},computed:{point:{get:function(){return{lng:this.formModel.lngBaidu,lat:this.formModel.latBaidu}},set:function(e){e&&(this.formModel.lngBaidu=e.lng,this.formModel.latBaidu=e.lat)}}},watch:{itemId:function(e,t){var n=this;e.id?b.query({id:e.id},(function(e){var t=Object.assign(n.getDefaultModel(),e.content);n.formModel=t,n.$refs.form.resetFields(),n.activeNames=["1"]}),(function(e){console.log(e),console.log("code错误")})):(this.resetModel(),this.$refs.form.resetFields(),this.activeNames=["1"])}}},y=v,M=(n("2e2b"),n("2877")),I=Object(M["a"])(y,c,u,!1,null,null,null),C=I.exports,S={name:"CostPopup",components:{BizPopupTabs:l["a"],CostBaseInfo:C},props:{open:{type:Boolean},itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{tabSelection:"0"}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)}},watch:{open:function(e){var t=this;e&&setTimeout((function(){t.tabSelection="0"}),500)}}},_=S,N=Object(M["a"])(_,i,s,!1,null,null,null),q=N.exports,P={query:function(e,t,n){h.a.get(g["g"].vehicleMgmt.VehicleMgmtCost_query,{params:e}).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))},queryPlateNumbers:function(e,t,n){h.a.get(g["g"].vehicleMgmt.VehicleMgmtCost_queryPlateNumbers,{params:e}).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))},queryPersonList:function(e,t,n){h.a.get(g["g"].vehicleMgmt.VehicleMgmtCost_queryPersonList,{params:e}).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))},queryStateList:function(e,t,n){h.a.get(g["g"].vehicleMgmt.VehicleMgmtCost_queryStateList,{params:e}).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))},queryTypeList:function(e,t,n){h.a.get(g["g"].vehicleMgmt.VehicleMgmtCost_queryTypeList,{params:e}).then(Object(m["a"])(t,n)).catch((function(e){console.error(e)}))},export:function(e){console.log(e),window.open(g["g"].vehicleMgmt.VehicleMgmtCost_export+"?fleetId="+e.fleetId+(e.ids?"&ids="+e.ids:"")+(e.carId?"&carId="+e.carId:"")+(e.carCostType?"&carCostType="+e.carCostType:"")+(e.memberId?"&memberId="+e.memberId:"")+(e.state?"&state="+e.state:"")+(e.beginDate?"&beginDate="+e.beginDate:"")+(e.endDate?"&endDate="+e.endDate:""))}},k=n("1ab1"),w={name:"VehicleMgmtCost",components:{BizFlexTable:r["c"],CostPopup:q},props:{},data:function(){return{itemId:{id:""},classId:"",selections:[],open:!1,needVerify:"0",loading:!1,tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},operations:[{label:"导出",name:"exportOperate",type:""},{label:"返回",name:"goBack",type:""}],filters:[{type:"select",label:"车牌号",name:"searchValue",value:"",options:[]},{type:"select",label:"费用类型",name:"searchValue",value:"",options:[]},{type:"select",label:"申请人",name:"searchValue",value:"",options:[]},{type:"select",label:"状态",name:"searchValue",value:"",options:[]},{type:"daterange",label:"时间",name:"searchValue",value:""}],sortData:{}}},methods:{formatName:function(e,t){return e.member.name||e.member.nickname},goBack:function(){this.$router.go(-1)},isMotorcadeMode:function(){return!!this.$route.params.groupId},getMotorcadeId:function(){return this.$route.params.groupId},operationSuccess:function(){this.open=!1,this.query()},operateHandler:function(e){this[e]()},pageSizeChange:function(e){this.pagination.pageSize=e,this.pagination.currentPage=1,this.query()},currentPageChange:function(e){this.pagination.currentPage=e,this.query()},rowOperationClickHandler:function(e){this.itemId={id:e.id,needVerify:e.needVerify},this.needVerify=e.needVerify,this.open=!0},selectionChangeHandler:function(e){this.selections=e},filterDataChangeHandler:function(){this.pagination={pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},this.query()},handleSortChange:function(e){this.sortData={column:e.prop,sort:e.order?"ascending"===e.order?"asc":"desc":void 0},this.query()},typeConverter:function(e){return this.filters[1].options.length>0?this.filters[1].options[Number(e.type)+1]?this.filters[1].options[Number(e.type)+1].label:"":e.type},stateConverter:function(e){return this.filters[3].options.length>0?this.filters[3].options[Number(e.verifyState)+1].label:e.verifyState},getQueryParams:function(){return{pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,carId:this.filters[0].value,fleetId:this.getMotorcadeId(),carCostType:this.filters[1].value,memberId:this.filters[2].value,state:this.filters[3].value,beginDate:this.filters[4].value[0],endDate:this.filters[4].value[1],orderProperty:this.sortData.column,orderDirection:this.sortData.sort}},query:function(){var e=this;P.query(this.getQueryParams(),(function(t){e.tableData=t.content,e.$set(e.pagination,"total",Number.parseInt(t.total))}),(function(e){console.log(e),console.log("code错误")}))},queryPlateNumbers:function(){var e=this;P.queryPlateNumbers(this.getQueryParams(),(function(t){var n=[{value:"",label:"全部"}];t.content.forEach((function(e){n.push({value:e.id,label:e.plateNumber})})),e.$set(e.filters[0],"options",n)}),(function(e){console.log(e),console.log("code错误")}))},queryStateList:function(){var e=this;P.queryStateList(this.getQueryParams(),(function(t){t.content.unshift({value:"",label:"全部"}),e.$set(e.filters[3],"options",t.content)}),(function(e){console.log(e),console.log("code错误")}))},queryPersonList:function(){var e=this;P.queryPersonList({fleetId:this.getMotorcadeId()},(function(t){t.listFleetDriver.map((function(e){e.label=e.name,e.value=e.id})),t.listFleetDriver.unshift({value:"",label:"全部"}),e.$set(e.filters[2],"options",t.listFleetDriver)}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(){var e=this;P.queryTypeList({},(function(t){t.content.unshift({value:"",label:"全部"}),e.$set(e.filters[1],"options",t.content)}),(function(e){console.log(e),console.log("code错误")}))},exportOperate:function(){var e=this.selections.map((function(e){return e.id}));P.export(Object.assign({},this.getQueryParams(),{ids:e}))},queryKPI:function(){var e=this;k["a"].get(g["B"].kpi_cost,{fleetId:this.getMotorcadeId()}).then((function(t){e.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:"今日新增费用审核".concat(t.count,"条，未审核记录共").concat(t.noExamine,"条 "),duration:3e3})})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))}},created:function(){this.queryStateList(),this.queryTypeList(),this.queryPlateNumbers(),this.queryPersonList(),this.query()},mounted:function(){this.queryKPI()}},$=w,x=Object(M["a"])($,o,a,!1,null,null,null);t["default"]=x.exports},a9e3:function(e,t,n){"use strict";var o=n("83ab"),a=n("da84"),r=n("94ca"),i=n("6eeb"),s=n("5135"),l=n("c6b6"),c=n("7156"),u=n("c04e"),f=n("d039"),p=n("7c73"),m=n("241c").f,d=n("06cf").f,h=n("9bf2").f,g=n("58a8").trim,b="Number",v=a[b],y=v.prototype,M=l(p(y))==b,I=function(e){var t,n,o,a,r,i,s,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:o=2,a=49;break;case 79:case 111:o=8,a=55;break;default:return+c}for(r=c.slice(2),i=r.length,s=0;s<i;s++)if(l=r.charCodeAt(s),l<48||l>a)return NaN;return parseInt(r,o)}return+c};if(r(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var C,S=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof S&&(M?f((function(){y.valueOf.call(n)})):l(n)!=b)?c(new v(I(t)),n,S):I(t)},_=o?m(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;_.length>N;N++)s(v,C=_[N])&&!s(S,C)&&h(S,C,d(v,C));S.prototype=y,y.constructor=S,i(a,b,S)}},c20d:function(e,t,n){var o=n("da84"),a=n("58a8").trim,r=n("5899"),i=o.parseInt,s=/^[+-]?0[Xx]/,l=8!==i(r+"08")||22!==i(r+"0x16");e.exports=l?function(e,t){var n=a(String(e));return i(n,t>>>0||(s.test(n)?16:10))}:i},d4c2:function(e,t,n){"use strict";var o=n("e725"),a=n.n(o);a.a},e725:function(e,t,n){}}]);