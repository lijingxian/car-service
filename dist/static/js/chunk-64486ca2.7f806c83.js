(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64486ca2","chunk-22dd6a1d"],{"0413":function(e,t,a){"use strict";var o=a("1b99"),n=a.n(o);n.a},"069c":function(e,t,a){"use strict";var o=a("53c6"),n=a.n(o);n.a},"0943":function(e,t,a){"use strict";var o=a("1fac"),n=a.n(o);n.a},"0edd":function(e,t,a){"use strict";var o=a("d48f"),n=a.n(o);n.a},"1b99":function(e,t,a){},"1fac":function(e,t,a){},"202d":function(e,t,a){},2497:function(e,t,a){"use strict";var o=a("4360"),n=a("a18c");t["a"]=function(e,t){return function(a){var r=a.data;"100"===r.resultCode?e(r):"709"===r.resultCode?(o["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",o["a"].getters.currentUser),n["a"].push("/login")):t(r)}}},"25eb":function(e,t,a){var o=a("23e7"),n=a("c20d");o({target:"Number",stat:!0,forced:Number.parseInt!=n},{parseInt:n})},2766:function(e,t,a){},"2abe":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("potential-customer-base-info",{ref:"base",attrs:{itemId:e.itemId,viewMode:e.viewMode},on:{operationSuccess:e.operationSuccess}})],1),e.itemId.id?a("el-tab-pane",{attrs:{label:"购买意向",name:"1"}},[a("potential-customer-intention",{attrs:{itemId:e.itemId,viewMode:e.viewMode},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId.id?a("el-tab-pane",{attrs:{label:"回访记录",name:"3"}},[a("potential-customer-callback-record",{attrs:{itemId:e.itemId,alertId:e.alertId,viewMode:e.viewMode},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId.id?a("el-tab-pane",{attrs:{label:"试乘试驾",name:"4"}},[a("potential-customer-test-drive",{attrs:{itemId:e.itemId,alertId:e.alertId,viewMode:e.viewMode},on:{operationSuccess:e.operationSuccess}})],1):e._e()],1)},n=[],r=(a("d3b7"),a("7132")),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer-mgmt__base-info"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"渠道",prop:"customerChannel"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择渠道",filterable:""},on:{change:e.channelChange},model:{value:e.formModel.customerChannel.id,callback:function(t){e.$set(e.formModel.customerChannel,"id",t)},expression:"formModel.customerChannel.id"}},e._l(e.channelList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{type:"phone",placeholder:"请输入手机号",maxlength:"11",disabled:!!e.itemId.id},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}},[a("template",{slot:"append"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCreateClick}},[e._v("创建会员")])],1)],2)],1),a("el-form-item",{attrs:{label:"客户姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入客户姓名"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"客户类型",prop:"customerType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择客户类型",filterable:""},on:{change:e.customerTypeChange},model:{value:e.formModel.customerType,callback:function(t){e.$set(e.formModel,"customerType",t)},expression:"formModel.customerType"}},e._l(e.customerTypeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"性别",prop:"gernder"}},[a("el-radio-group",{model:{value:e.formModel.gernder,callback:function(t){e.$set(e.formModel,"gernder",t)},expression:"formModel.gernder"}},[a("el-radio",{attrs:{label:"male"}},[e._v("男")]),a("el-radio",{attrs:{label:"female"}},[e._v("女")]),a("el-radio",{attrs:{label:"unknown"}},[e._v("保密")])],1)],1),a("el-form-item",{attrs:{label:"头像",prop:"image"}},[a("BizAvatarUploaderNew",{model:{value:e.formModel.head,callback:function(t){e.$set(e.formModel,"head",t)},expression:"formModel.head"}})],1),a("el-form-item",{attrs:{label:"建档日期",prop:"entryDate"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"请选择建档日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,clearable:!1,disabled:!!e.itemId.id},model:{value:e.formModel.entryDate,callback:function(t){e.$set(e.formModel,"entryDate",t)},expression:"formModel.entryDate"}})],1),a("el-form-item",{attrs:{label:"首次邀约来店"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:e.itemId.id?"----":"选择首次邀约来店",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:!!e.itemId.id},model:{value:e.formModel.inshopDate,callback:function(t){e.$set(e.formModel,"inshopDate",t)},expression:"formModel.inshopDate"}})],1),a("el-form-item",{attrs:{label:"销售顾问",prop:"salesAdvisor"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择销售顾问",filterable:""},model:{value:e.formModel.salesAdvisor.id,callback:function(t){e.$set(e.formModel.salesAdvisor,"id",t)},expression:"formModel.salesAdvisor.id"}},e._l(e.salesList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name||"未填写",value:e.id}})})),1)],1),a("el-collapse",{attrs:{accordion:""},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{name:"1",title:"扩展信息"}},[a("el-form-item",{attrs:{label:"婚姻状况"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择婚姻状况",filterable:""},model:{value:e.formModel.maritalStatus,callback:function(t){e.$set(e.formModel,"maritalStatus",t)},expression:"formModel.maritalStatus"}},e._l(e.maritalStatusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"地址"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"请输入地址"},model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1),a("el-form-item",{attrs:{label:"职业"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"请输入职业"},model:{value:e.formModel.job,callback:function(t){e.$set(e.formModel,"job",t)},expression:"formModel.job"}})],1)],1)],1)],1)],1)},s=[],l=(a("99af"),a("d81d"),a("b0c0"),a("5530")),c=a("f36f"),d=a("8330"),u=a("c596"),m=a("1ab1"),f=a("c466"),p=a("2f62"),h=a("c17f"),g={customerTypeList:[{label:"个人",value:"personal"},{label:"行业",value:"company"}],maritalStatusList:[{label:"已婚",value:"married"},{label:"未婚",value:"unmarried"}],salesList:[],activeNames:[],pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},operations:[{label:"保存",name:"save",type:"primary",auth:["admin:potential.edit"]}]},b=function(){return{customerChannel:{id:""},entryDate:new Date,salesAdvisor:{id:""},gernder:"unknown",head:"/resources/admin/images/Avatar.png",customerType:"personal"}},v={data:{loading:!1,channelList:[],defaultUser:"/resources/admin/images/Avatar.png",formModel:b()},events:{handleOperate:function(e){this[e]()}},methods:{customerTypeChange:function(){this.$refs.form.clearValidate("customerType")},channelChange:function(){this.$refs.form.clearValidate("customerChannel")},queryConsumerInfo:function(){var e=this;m["a"].get(u["u"].baseInfo.editQuery,{shopId:window.top.SHOP_ID||"",id:this.itemId.id,viewMode:this.viewMode}).then((function(t){if(e.salesList&&0!==e.salesList.length||(t.potentialConsumer&&t.potentialConsumer.salesAdvisor&&t.potentialConsumer.salesAdvisor.id?e.salesList=[{name:"无",id:""}].concat([{name:t.potentialConsumer.salesAdvisor.name,id:t.potentialConsumer.salesAdvisor.id}]):e.salesList=[{name:"无",id:""}].concat([{name:e.getUser().realName,id:e.getUser().id}])),t.potentialConsumer){var a=t.potentialConsumer;a.entryDate=new Date(a.entryDate),a.inshopDate=a.inshopDate?new Date(a.inshopDate):void 0,a.salesAdvisor||(a.salesAdvisor={id:""}),e.formModel=a;var o=!0;e.salesList.map((function(e){t.potentialConsumer.salesAdvisor&&t.potentialConsumer.salesAdvisor.id&&e.id===t.potentialConsumer.salesAdvisor.id&&(o=!1)})),o&&t.potentialConsumer.salesAdvisor&&t.potentialConsumer.salesAdvisor.id&&(e.salesList=e.salesList.concat([{name:t.potentialConsumer.salesAdvisor.name,id:t.potentialConsumer.salesAdvisor.id}]))}else{var n=e.getDefaultModel();n.salesAdvisor.id=e.getUser().id,e.formModel=n}})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(t){e.loading=!1}))},resetModel:function(){this.formModel=this.getDefaultModel()},getChannelList:function(){var e=this;m["a"].get(u["u"].customerChannels,{shopId:window.top.SHOP_ID||""}).then((function(t){e.channelList=t.dataList.map((function(e){return{value:e.id,label:e.name}}))})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},getDefaultModel:function(){return b()},getSaveParams:function(){return{token:"",id:this.formModel.id,customerChannel:{id:this.formModel.customerChannel.id},entryDate:f["a"].dateConverter(this.formModel.entryDate),inshopDate:f["a"].dateConverter(this.formModel.inshopDate),potentialConsumerId:this.formModel.potentialConsumerId,salesAdvisor:{id:this.formModel.salesAdvisor.id},name:this.formModel.name,gernder:this.formModel.gernder,head:this.formModel.head,customerType:this.formModel.customerType,mobile:this.formModel.mobile,maritalStatus:this.formModel.maritalStatus,address:this.formModel.address,job:this.formModel.job,shopId:window.top.SHOP_ID||"",viewMode:this.viewMode}},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0;var o=e.getSaveParams();!e.formModel.id&&m["a"].post(u["u"].baseInfo.add,o).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess",t.potentialConsumerId)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1})),e.formModel.id&&m["a"].put(u["u"].baseInfo.update,o).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}))}}},y={events:{handleCreateClick:function(e){/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/.test(this.formModel.mobile)&&this.createMember()}},methods:{createMember:function(){var e=this;this.loading=!0,m["a"].post(u["u"].baseInfo.createMember,{shopId:window.top.SHOP_ID||"",gender:this.formModel.gernder,mobile:this.formModel.mobile,name:this.formModel.name,userSource:"1",viewMode:this.viewMode}).then((function(t){e.$message.success("创建成功")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}}},M={name:"PotentialCustomerBaseInfo",components:{BizSaveButton:d["a"],BizGrid:c["a"],BizAvatarUploaderNew:h["b"]},data:function(){var e=this,t=function(t,a,o){return e.formModel.customerChannel.id?o():o(new Error("请选择渠道"))};return Object(l["a"])(Object(l["a"])(Object(l["a"])({},g),v.data),{},{rules:{customerChannel:[{required:!0,validator:t,trigger:"blur"}],name:[{required:!0,message:"请输入客户姓名",trigger:"blur"},{max:20,message:"客户姓名长度不得超过20位",trigger:"blur"}],gernder:[{required:!0,message:"请选择性别",trigger:"blur"}],entryDate:[{required:!0,message:"请输入建档日期",trigger:"blur"}],customerType:[{required:!0,message:"请选择客户类型",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}},viewMode:{type:String,default:function(){return"merge"}}},computed:Object(l["a"])({},Object(p["c"])("Sales",["potentialInfo","consumerInfo"])),methods:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},Object(p["c"])(["getUser"])),Object(p["d"])("Sales",["updatePotentialInfo","updateConsumer"])),v.methods),v.events),y.methods),y.events),watch:{itemId:function(e,t){this.$refs.form.clearValidate(),this.activeNames=[],this.potentialInfo.sales&&(this.salesList=[{name:"无",id:""}].concat(this.potentialInfo.sales)),e.id&&this.queryConsumerInfo()}},created:function(){this.getChannelList(),this.salesList=this.potentialInfo.sales||[],this.itemId.id&&this.queryConsumerInfo()}},w=M,I=(a("9433"),a("2877")),S=Object(I["a"])(w,i,s,!1,null,null,null),C=S.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer-mgmt__intention"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"客户意向级别",prop:"level"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择客户意向级别",disabled:""},model:{value:e.formModel.level,callback:function(t){e.$set(e.formModel,"level",t)},expression:"formModel.level"}},e._l(e.intentionLevelList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"购买意向",prop:"type"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addProduct}},[e._v("添加")])],1),a("el-form-item",{attrs:{label:""}},[a("el-table",{staticClass:"p-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"small"}},[a("el-table-column",{attrs:{prop:"productName",label:"意向商品"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[t.row.productName?a("div",{staticClass:"biz-customcol"},[e._v(" "+e._s(t.row.productName)+" ")]):a("div",{staticClass:"biz-customcol"},[e._v(" "+e._s(t.row.seriesName)+" ")])])}}])}),a("el-table-column",{attrs:{prop:"memo",label:"描述"}}),a("el-table-column",{attrs:{label:"操作",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.deleteHandler(t.row)}}},[e._v(" 删除 ")])],1)}}])})],1)],1),a("el-form-item",{attrs:{label:"意向车色"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"请输入意向车色"},model:{value:e.formModel.carColor,callback:function(t){e.$set(e.formModel,"carColor",t)},expression:"formModel.carColor"}})],1),a("el-form-item",{attrs:{label:"付款方式"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择付款方式"},model:{value:e.formModel.paymentMethod,callback:function(t){e.$set(e.formModel,"paymentMethod",t)},expression:"formModel.paymentMethod"}},e._l(e.paymentList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"预算"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.formModel.budget,callback:function(t){e.$set(e.formModel,"budget",t)},expression:"formModel.budget"}})],1),a("el-form-item",{attrs:{label:"购买方式"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择购买方式"},model:{value:e.formModel.purchaseMode,callback:function(t){e.$set(e.formModel,"purchaseMode",t)},expression:"formModel.purchaseMode"}},e._l(e.purchaseModeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"原使用商品"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择原使用商品",filterable:""},model:{value:e.formModel.originalBrand,callback:function(t){e.$set(e.formModel,"originalBrand",t)},expression:"formModel.originalBrand"}},e._l(e.brandList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"预计购买日期"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择预计购买日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.purchaseDate,callback:function(t){e.$set(e.formModel,"purchaseDate",t)},expression:"formModel.purchaseDate"}})],1),a("el-form-item",{attrs:{label:"购买目的"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择购买目的"},model:{value:e.formModel.purpose,callback:function(t){e.$set(e.formModel,"purpose",t)},expression:"formModel.purpose"}},e._l(e.purposeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"购买侧重点"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择购买侧重点"},model:{value:e.formModel.emphasis,callback:function(t){e.$set(e.formModel,"emphasis",t)},expression:"formModel.emphasis"}},e._l(e.emphasisList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"竞争商品1"}},[a("el-input",{attrs:{maxlength:"50",placeholder:"请输入竞争商品1"},model:{value:e.formModel.competingCar,callback:function(t){e.$set(e.formModel,"competingCar",t)},expression:"formModel.competingCar"}})],1),a("el-form-item",{attrs:{label:"关注因素"}},[a("el-input",{attrs:{maxlength:"50",placeholder:"请输入关注因素"},model:{value:e.formModel.concernedfactors,callback:function(t){e.$set(e.formModel,"concernedfactors",t)},expression:"formModel.concernedfactors"}})],1),a("el-form-item",{attrs:{label:"竞争商品2"}},[a("el-input",{attrs:{maxlength:"50",placeholder:"请输入竞争商品2"},model:{value:e.formModel.competingCar2,callback:function(t){e.$set(e.formModel,"competingCar2",t)},expression:"formModel.competingCar2"}})],1),a("el-form-item",{attrs:{label:"关注因素"}},[a("el-input",{attrs:{maxlength:"50",placeholder:"请输入关注因素"},model:{value:e.formModel.concernedfactors2,callback:function(t){e.$set(e.formModel,"concernedfactors2",t)},expression:"formModel.concernedfactors2"}})],1),a("el-form-item",{attrs:{label:"客户特征"}},[a("el-input",{attrs:{maxlength:"50",placeholder:"请输入客户特征"},model:{value:e.formModel.feature,callback:function(t){e.$set(e.formModel,"feature",t)},expression:"formModel.feature"}})],1)],1),a("el-dialog",{attrs:{title:"意向商品",visible:e.dialogVisible,width:"30%","append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"dialogForm",attrs:{size:"small","label-width":"110px",model:e.dialogForm,rules:e.dialogRules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"品牌",prop:"brandId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌"},on:{change:e.handleBrandChange},model:{value:e.dialogForm.brandId,callback:function(t){e.$set(e.dialogForm,"brandId",t)},expression:"dialogForm.brandId"}},e._l(e.brandList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"系列",prop:"seriesId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列"},on:{change:e.handleSeriesChange},model:{value:e.dialogForm.seriesId,callback:function(t){e.$set(e.dialogForm,"seriesId",t)},expression:"dialogForm.seriesId"}},e._l(e.seriesList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"车型",prop:"productId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型"},on:{change:e.handleTypeChange},model:{value:e.dialogForm.productId,callback:function(t){e.$set(e.dialogForm,"productId",t)},expression:"dialogForm.productId"}},e._l(e.modeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"描述",prop:"memo"}},[a("el-input",{attrs:{placeholder:"请输入描述",maxlength:"30"},model:{value:e.dialogForm.memo,callback:function(t){e.$set(e.dialogForm,"memo",t)},expression:"dialogForm.memo"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)],1)},D=[],k=(a("c975"),a("a434"),a("e42c")),x={intentionLevelList:[],paymentList:[{label:"现金",value:"cash"},{label:"按揭",value:"mortgage"}],purchaseModeList:[{label:"新购",value:"new_buy"},{label:"增购",value:"add_buy"},{label:"换购",value:"change_buy"}],purposeList:[{label:"家庭用车",value:"family"},{label:"商务用车",value:"business"},{label:"生活",value:"life"},{label:"休闲",value:"leisure"},{label:"上班",value:"work"},{label:"其他",value:"others"}],emphasisList:[{label:"外形",value:"appearance"},{label:"动力",value:"power"},{label:"费用",value:"cost"},{label:"舒适",value:"comfort"},{label:"安全",value:"safety"},{label:"操控",value:"manipulative"},{label:"价格",value:"price"},{label:"品牌",value:"brand"},{label:"配置",value:"configure"},{label:"其他",value:"other"}],pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()}},tableData:[],saveTableData:[],productId:"",products:[],seriesId:"",series:[],dialogVisible:!1,operations:[{label:"保存",name:"save",type:"primary",auth:["admin:potential.edit"]}]},T={data:{brandList:[],seriesList:[],modeList:[]},methods:{queryBrandList:function(){var e=this;k["a"].brands({category:"car"},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;k["a"].series({brandId:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;k["a"].types({seriesId:e,brand:this.dialogForm.brandId},(function(e){t.modeList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))}},events:{handleBrandChange:function(e){this.querySeriesList(e),this.productId="",this.seriesId="",this.$set(this.dialogForm,"seriesId",""),this.$set(this.dialogForm,"productId",""),this.$refs.dialogForm.clearValidate("brandId")},handleSeriesChange:function(e){this.queryTypeList(e),this.productId="",this.seriesId=e,this.$set(this.dialogForm,"productId",""),this.$refs.dialogForm.clearValidate("seriesId")},handleTypeChange:function(e){this.productId=e,this.$refs.dialogForm.clearValidate("productId")}}},$=function(){return{}},_={data:{loading:!1,formModel:$(),dialogForm:$()},events:{handleOperate:function(e){this[e]()}},methods:Object(l["a"])(Object(l["a"])({},Object(p["d"])("Sales",["updatePotentialInfo","updateConsumer"])),{},{queryConsumerInfo:function(){var e=this;m["a"].get(u["u"].baseInfo.editQuery,{shopId:window.top.SHOP_ID||"",id:this.itemId.id,viewMode:this.viewMode}).then((function(t){var a=t.potentialConsumer;a.nextVisitTime=a.nextVisitTime?f["a"].dateConverter(new Date(a.nextVisitTime)):void 0,a.purchaseDate=a.purchaseDate?f["a"].dateConverter(new Date(a.purchaseDate)):void 0,e.formModel=a,e.tableData=a.intentionCars})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(t){e.loading=!1}))},addProduct:function(){this.dialogForm={},this.dialogVisible=!0},confirm:function(){var e=this;this.$refs.dialogForm.validate((function(t,a){if(t){if(e.tableData.map((function(t){e.products.push(t.productId),e.series.push(t.seriesId)})),e.productId&&-1!==e.products.indexOf(e.productId))return void e.$message.warning("已添加此意向车型，不能重复添加");if(!e.productId&&-1!==e.series.indexOf(e.seriesId))return void e.$message.warning("已添加此意向车型，不能重复添加");var o="",n="";e.modeList.map((function(t){t.id===e.productId&&(o=t.name)})),e.seriesList.map((function(t){t.id===e.dialogForm.seriesId&&(n=t.name)})),e.tableData.push({brandId:e.dialogForm.brandId,seriesId:e.dialogForm.seriesId,memo:e.dialogForm.memo,productName:o,seriesName:n,productId:e.productId}),e.dialogVisible=!1}}))},deleteHandler:function(e){this.tableData.splice(this.tableData.indexOf(e),1)},deleteRecommend:function(e){this.tableData.splice(this.tableData.indexOf(e),1),this.products.splice(this.products.indexOf(e.id),1)},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return $()},getSaveParams:function(){return{token:"",id:this.formModel.id,level:this.formModel.level,nextVisitTime:this.formModel.nextVisitTime,carColor:this.formModel.carColor,paymentMethod:this.formModel.paymentMethod,budget:this.formModel.budget,purchaseMode:this.formModel.purchaseMode,purchaseDate:this.formModel.purchaseDate,purpose:this.formModel.purpose,emphasis:this.formModel.emphasis,carBrand:this.formModel.carBrand,competingCar:this.formModel.competingCar,concernedfactors:this.formModel.concernedfactors,competingCar2:this.formModel.competingCar2,concernedfactors2:this.formModel.concernedfactors2,feature:this.formModel.feature,originalBrand:this.formModel.originalBrand,intentionCars:this.tableData,viewMode:this.viewMode,shopId:window.top.SHOP_ID||""}},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0;var o=e.getSaveParams();m["a"].put(u["u"].intention.save,o).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess",e.formModel.id)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}))}})},L={name:"PotentialCustomerIntention",components:{BizSaveButton:d["a"],BizGrid:c["a"]},data:function(){return Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},x),_.data),T.data),{},{rules:{},dialogRules:{brandId:[{required:!0,trigger:"blur",message:"请选择品牌"}],seriesId:[{required:!0,trigger:"blur",message:"请选择系列"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}},viewMode:{type:String,default:function(){return"merge"}}},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},Object(p["c"])(["getUser"])),_.methods),_.events),T.methods),T.events),computed:Object(l["a"])(Object(l["a"])({},Object(p["c"])("Sales",["potentialInfo","consumerInfo"])),{},{consumerState:function(){return this.$store.state.potentialCustomer.consumerState}}),watch:{itemId:function(e,t){this.intentionLevelList=this.potentialInfo.intentionLevels,e.id&&this.queryConsumerInfo()}},created:function(){this.queryBrandList(),this.intentionLevelList=this.potentialInfo.intentionLevels,console.log("intentionList: ",this.intentionLevelList),this.itemId.id&&this.queryConsumerInfo()}},j=L,P=(a("6c4f"),Object(I["a"])(j,O,D,!1,null,null,null)),z=P.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer-mgmt__callback-record"},[a("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}}),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"400",size:"small"},on:{"row-click":e.handleRowClick}},[a("el-table-column",{attrs:{prop:"visitDate",label:"回访日期",formatter:e.dateConverter1}}),a("el-table-column",{attrs:{prop:"visitResult",label:"回访内容"}}),a("el-table-column",{attrs:{prop:"nextVisitDate",label:"下次回访日期",formatter:e.dateConverter}}),a("biz-empty-table-tab",{attrs:{slot:"empty"},slot:"empty"})],1),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[a("el-radio-group",{attrs:{disabled:!!this.formModel.id},on:{change:e.levelChange},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}},[a("el-radio",{attrs:{label:"1"}},[e._v("核心H")]),a("el-radio",{attrs:{label:"2"}},[e._v("重要A")]),a("el-radio",{attrs:{label:"3"}},[e._v("意向B")]),a("el-radio",{attrs:{label:"4"}},[e._v("一般C")]),a("el-radio",{attrs:{label:"0"}},[e._v("签约O")]),a("el-radio",{attrs:{label:"5"}},[e._v("战败F")]),a("el-radio",{attrs:{label:"6"}},[e._v("交车D")]),a("el-radio",{attrs:{label:"7"}},[e._v("无意向N")])],1),a("el-form-item",{attrs:{label:"下次回访日期",prop:"nextVisitDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择下次回访日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd hh:mm:ss",clearable:!1,disabled:!!this.formModel.id,"picker-options":e.pickerOptions},model:{value:e.formModel.nextVisitDate,callback:function(t){e.$set(e.formModel,"nextVisitDate",t)},expression:"formModel.nextVisitDate"}})],1),"6"===e.level?a("el-form-item",{attrs:{label:"交车日期",prop:"deliveryDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择交车日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd hh:mm:ss",clearable:!1,disabled:!!this.formModel.id},model:{value:e.formModel.deliveryDate,callback:function(t){e.$set(e.formModel,"deliveryDate",t)},expression:"formModel.deliveryDate"}})],1):e._e(),a("el-form-item",{attrs:{label:"回访内容",prop:"visitResult"}},[a("el-input",{attrs:{maxlength:"100",disabled:!!this.formModel.id,placeholder:"请输入回访内容"},model:{value:e.formModel.visitResult,callback:function(t){e.$set(e.formModel,"visitResult",t)},expression:"formModel.visitResult"}})],1),"0"===e.level?a("el-form-item",{attrs:{label:"订单号"}},[a("el-input",{attrs:{readonly:"",disabled:!0},model:{value:e.formModel.orderSn,callback:function(t){e.$set(e.formModel,"orderSn",t)},expression:"formModel.orderSn"}},[a("div",{staticClass:"input-operation",attrs:{slot:"append"},slot:"append"},[a("el-button",{attrs:{type:"text"},on:{click:e.handleListClick}},[a("i",{staticClass:"iconfont biz-icon-liebiaoshitu"})])],1)])],1):e._e(),"0"===e.level?a("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌",disabled:!!this.formModel.id},on:{change:e.handleBrandChange},model:{value:e.formModel.brand,callback:function(t){e.$set(e.formModel,"brand",t)},expression:"formModel.brand"}},e._l(e.brandList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"0"===e.level?a("el-form-item",{attrs:{label:"系列",prop:"series"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列",disabled:!!this.formModel.id},on:{change:e.handleSeriesChange},model:{value:e.formModel.series,callback:function(t){e.$set(e.formModel,"series",t)},expression:"formModel.series"}},e._l(e.seriesList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"0"===e.level?a("el-form-item",{attrs:{label:"车型",prop:"product"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型",disabled:!!this.formModel.id},model:{value:e.formModel.product,callback:function(t){e.$set(e.formModel,"product",t)},expression:"formModel.product"}},e._l(e.modeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"5"===e.level?a("el-form-item",{attrs:{label:"战败原因",prop:"failureReason"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择战败原因",disabled:!!this.formModel.id},model:{value:e.formModel.failureReason,callback:function(t){e.$set(e.formModel,"failureReason",t)},expression:"formModel.failureReason"}},e._l(e.reasonList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1):e._e()],1),this.formModel.id?e._e():a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.formOperations},on:{operate:e.handleOperate}})],1),a("pc-order-picker",{ref:"orderPicker",attrs:{itemId:e.itemId,memberId:e.memberId},on:{input:e.handleOrderSelected}})],1)},F=[],q=(a("4160"),a("ac1f"),a("5319"),a("159b"),a("04d3")),A=a("6401"),R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"potential-customer__order-picker"},[a("biz-dialog-selector",{attrs:{slot:"float",title:"选择订单",visibility:e.showDialog,loading:e.loading,tableData:e.tableData,pagination:e.pagination,selectionMode:"single",isClear:!1,filters:e.filters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[a("el-table-column",{attrs:{prop:"sn",label:"订单编号"}}),a("el-table-column",{attrs:{prop:"orderTime",label:"订单时间"}}),a("el-table-column",{attrs:{prop:"orderType",label:"订单分类",formatter:e.orderTypeFormatter}}),a("el-table-column",{attrs:{prop:"orderItems",label:"商品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.orderItems,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])}))}}])}),a("el-table-column",{attrs:{prop:"consignee",label:"会员昵称"}}),a("el-table-column",{attrs:{prop:"plateNumber",label:"车牌"}}),a("el-table-column",{attrs:{prop:"amount",label:"订单金额"}}),a("el-table-column",{attrs:{prop:"amountPaid",label:"实付金额"}})],1)],1)},N=[],V=(a("a9e3"),a("af3f")),E={name:"PcOrderPicker",components:{BizDialogSelector:V["a"]},model:{prop:"value",event:"input"},data:function(){return{showDialog:!1,loading:!1,tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},filters:[{type:"input",label:"",placeholder:"请输入姓名/手机号",name:"searchValue",value:""}]}},props:{value:{type:Object},itemId:{type:Object},memberId:{type:Object}},methods:{orderTypeFormatter:function(e){var t={0:"普通商品订单",1:"充值订单",2:"服务订单",3:"一键救援预约",4:"维修预约",5:"保养预约",6:"置换预约",7:"贷款购车预约",8:"试乘试驾预约",9:"整车订单",10:"普通订单",11:"维修保养订单",12:"产品订单",13:"sim卡充值订单",14:"平台服务",15:"短信服务"};return t[e.orderType]},query:function(e){var t=this;this.loading=!0,m["a"].get(u["u"].sign.orderList,e).then((function(e){t.tableData=e.content,t.pagination.total=Number(e.total)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))},getStatus:function(e){switch(e.enableState){case"0":return"停用";case"1":return"启用"}return""},clickHandler:function(e){this.showDialog=!0},confirmedHandler:function(e,t){var a=t[0];this.$emit("input",a)},getQueryParams:function(){return{pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,searchValue:this.filters[0].value,searchProperty:"sn",id:this.itemId.id,orderType:"car",memberId:this.memberId?this.memberId.id:""}},openedHandler:function(){this.pagination.currentPage=1,this.pagination.pageSize=20,this.filters=[{type:"input",label:"",placeholder:"请输入订单号",name:"searchValue",value:""}],this.query(this.getQueryParams())},dialogFilterDataChange:function(e){this.pagination.currentPage=1,this.query(this.getQueryParams())},dialogPageSizeChange:function(e){this.$set(this.pagination,"pageSize",e),this.query(this.getQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.pagination,"currentPage",e),this.query(this.getQueryParams())}}},H=E,K=Object(I["a"])(H,R,N,!1,null,null,null),U=K.exports,Q={data:{loading:!1,pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()}},operations:[{label:"新建",name:"add",type:"primary",auth:["admin:potential.edit"]}]},methods:{getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",potentialConsumerId:this.itemId.id,viewMode:this.viewMode,pageSize:100,pageNumber:1}},query:function(){var e=this;this.loading=!0,m["a"].get(u["u"].callbackRecord.list,this.getQueryParams()).then((function(t){e.tableData=t.content,e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},getCallbackInfo:function(e){var t=this;m["a"].get(u["u"].callbackRecord.updateCallbackRecord,{visitRecordId:e.id}).then((function(e){t.formModel.id=e.visitRecord.id,t.formModel.nextVisitDate=e.visitRecord.nextVisitDate||"",t.formModel.visitResult=e.visitRecord.visitResult||"",t.level=e.visitRecord.level||"",e.visitRecord.sign?(t.formModel.brand=e.visitRecord.sign.brandId,t.querySeriesList(e.visitRecord.sign.brandId),t.formModel.series=e.visitRecord.sign.seriesId,t.queryTypeList(e.visitRecord.sign.seriesId),t.formModel.product=e.visitRecord.sign.productId,t.formModel.orderSn=e.visitRecord.sign.orderSn):e.visitRecord.delivery?t.formModel.deliveryDate=e.visitRecord.delivery.deliveryDate||"":(t.formModel.brand="",t.formModel.series="",t.formModel.product="",t.formModel.orderSn=""),e.visitRecord.defeat?t.formModel.failureReason=e.visitRecord.defeat.reason:t.formModel.failureReason="",t.showForm=!0})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},add:function(){this.formModel={},this.showForm=!0},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")}},events:{handleOperate:function(e){this[e]()}}},Y={data:{tableData:[],selections:[]},methods:{dateConverter:function(e){if(e.nextVisitDate){e.nextVisitDate=e.nextVisitDate.replace(/-/g,"/");var t=new Date(e.nextVisitDate);return f["a"].dateConverter(t)}return"--"},dateConverter1:function(e){if(e.visitDate){e.visitDate=e.visitDate.replace(/-/g,"/");var t=new Date(e.visitDate);return f["a"].dateConverter(t)}return"--"},typeConverter:function(e){var t={alarm:"提醒回访",sale:"交车回访",insurance:"首保回访",failure:"战败"};return t[e.reasonType]},modeConverter:function(e){var t={call:"电话",inshop:"到店"};return t[e.mode]},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var a={ids:e};m["a"].delete(u["u"].callbackRecord.delete,a).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))}},events:{rowDeleteClickHandler:function(e,t){e.stopPropagation(),this.deleteItem([t.id])},handleRowClick:function(e){this.$refs.form.clearValidate(),this.getCallbackInfo(e)},handleSelectionChange:function(e){this.selections=e}}},G=function(){return{visitResult:"",nextVisitDate:""}},W={data:{showForm:!1,brandList:[],seriesList:[],modeList:[],reasonList:[],memberId:{id:""},level:"1",formModel:G(),rules:{visitResult:[{required:!0,message:"回访内容不少于5个字符",trigger:"blur",min:5}],deliveryDate:[{required:!0,message:"请输入交车日期",trigger:["blur","change"]}],brand:[{required:!0,message:"请选择品牌",trigger:["blur","change"]}],series:[{required:!0,message:"请选择系列",trigger:["blur","change"]}],product:[{required:!0,message:"请选择车型",trigger:["blur","change"]}],failureReason:[{required:!0,message:"请选择战败原因",trigger:["blur","change"]}]},formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"saveForm",type:"primary"}]},methods:{initForm:function(e){this.showForm=!0;var t=G();this.formModel=e?Object.assign(t,e):t,this.$refs.form&&this.$refs.form.resetFields()},levelChange:function(){this.formModel=G(),this.$refs.form.clearValidate()},queryBrandList:function(){var e=this;m["a"].get(u["u"].failure.queryBrandList,{brandId:"",seriesId:""}).then((function(t){e.brandList=t.dataList})).catch((function(t){e.brandList=t}))},querySeriesList:function(e){var t=this;m["a"].get(u["u"].failure.querySeriesList,{brandId:e}).then((function(e){t.seriesList=e.dataList})).catch((function(e){t.seriesList=e}))},queryTypeList:function(e){var t=this;m["a"].get(u["u"].failure.queryModeList,{brandId:this.formModel.failureBrandId,seriesId:e}).then((function(e){t.modeList=e.dataList})).catch((function(e){t.modeList=e}))},handleListClick:function(e){this.consumerInfo.potentialConsumer.member&&(this.memberId=this.consumerInfo.potentialConsumer.member),this.$refs.orderPicker.showDialog=!0},handleOrderSelected:function(e){this.$set(this.formModel,"orderSn",e.sn),this.$set(this.formModel,"orderId",e.id),this.$set(this.formModel,"brand",e.products[0].brandId),this.querySeriesList(e.products[0].brandId),this.$set(this.formModel,"series",e.products[0].seriesId),this.queryTypeList(e.products[0].seriesId),this.$set(this.formModel,"product",e.products[0].id)},handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.formModel,"series",""),this.$set(this.formModel,"product","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.formModel,"product","")},cancelForm:function(){this.showForm=!1},getSaveParams:function(){return{token:"",id:this.formModel.id,nextVisitDate:this.formModel.nextVisitDate,mode:this.formModel.mode,visitResult:this.formModel.visitResult,delivery:{deliveryDate:this.formModel.deliveryDate},level:this.level,sign:{orderId:this.formModel.orderId,brandId:this.formModel.brand,seriesId:this.formModel.series,productId:this.formModel.product},defeat:{reason:this.formModel.failureReason},alarmRecordId:this.formModel.alarmRecordId,potentialConsumerId:this.itemId.id,viewMode:this.viewMode,shopId:window.top.SHOP_ID||""}},saveForm:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;if(!e.formModel.visitResult)return!1;e.loading=!0;var o=e.getSaveParams();!e.formModel.id&&m["a"].post(u["u"].callbackRecord.add,o).then((function(t){e.query(),e.$message.success("添加成功"),e.$emit("operationSuccess"),e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1})),e.formModel.id&&m["a"].put(u["u"].callbackRecord.update,o).then((function(t){e.query(),e.$message.success("更新成功"),e.$emit("operationSuccess"),e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))}},events:{}},X={name:"PotentialCustomerCallbackRecord",components:{BizHeader:q["d"],BizGrid:c["a"],BizSaveButton:d["a"],BizEmptyTableTab:A["a"],PcOrderPicker:U},props:{itemId:{type:Object,default:function(){return{id:""}}},viewMode:{type:String,default:function(){return"merge"}},alertId:{type:Object,default:function(){return{id:""}}}},data:function(){return Object(l["a"])(Object(l["a"])(Object(l["a"])({},Q.data),Y.data),W.data)},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},Q.methods),Q.events),Y.methods),Y.events),W.methods),W.events),watch:{itemId:function(e,t){this.$refs.form.clearValidate(),e.id&&(this.query(),this.reasonList=this.potentialInfo.failureReasons)},alertId:function(e){e.id&&this.getCallbackInfo(e)}},computed:Object(l["a"])({},Object(p["c"])("Sales",["potentialInfo","consumerInfo"])),created:function(){this.queryBrandList(),this.reasonList=this.potentialInfo.failureReasons,this.itemId.id&&this.query()}},J=X,Z=(a("0edd"),Object(I["a"])(J,B,F,!1,null,null,null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer-mgmt__test-drive"},[a("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}}),a("el-table",{attrs:{data:e.tableData,height:"300",size:"small"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[a("biz-empty-table-tab",{attrs:{slot:"empty"},slot:"empty"}),a("el-table-column",{attrs:{type:"selection",width:"30"}}),a("el-table-column",{attrs:{label:"日期",prop:"testTime",formatter:e.dateConverter,"min-width":"105"}}),a("el-table-column",{attrs:{label:"开始时间",prop:"startTime",formatter:e.startTimeConverter,"min-width":"80"}}),a("el-table-column",{attrs:{label:"结束时间",prop:"endTime",formatter:e.endTimeConverter,"min-width":"80"}}),a("el-table-column",{attrs:{label:"开始里程(km)",prop:"startMileage","min-width":"90"}}),a("el-table-column",{attrs:{label:"结束里程(km)",prop:"endMileage","min-width":"90"}}),a("el-table-column",{attrs:{label:"试驾车型","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.product?t.row.product.name:"")+" ")]}}])}),a("el-table-column",{attrs:{prop:"tag",label:"操作","min-width":"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"margin-right":"4px"},attrs:{type:"text",size:"mini"},on:{click:function(a){return e.rowDeleteClickHandler(a,t.row)}}},[e._v(" 删除 ")])]}}])})],1),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"},{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],staticClass:"box-card",staticStyle:{"margin-top":"20px",width:"100%"}},[a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"试驾日期",prop:"testTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择试驾日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",clearable:!1},model:{value:e.formModel.testTime,callback:function(t){e.$set(e.formModel,"testTime",t)},expression:"formModel.testTime"}})],1),a("el-form-item",{attrs:{label:"试驾车型",prop:"product"}},[a("el-input",{attrs:{placeholder:"请选择试驾车型"},on:{focus:e.queryProduct},model:{value:e.formModel.product.name,callback:function(t){e.$set(e.formModel.product,"name",t)},expression:"formModel.product.name"}})],1),a("el-form-item",{attrs:{label:"开始时间",prop:"startTimeText"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",editable:!1,clearable:!1},model:{value:e.formModel.startTimeText,callback:function(t){e.$set(e.formModel,"startTimeText",t)},expression:"formModel.startTimeText"}})],1),a("el-form-item",{attrs:{label:"结束时间",prop:"endTimeText"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",editable:!1,clearable:!1},model:{value:e.formModel.endTimeText,callback:function(t){e.$set(e.formModel,"endTimeText",t)},expression:"formModel.endTimeText"}})],1),a("el-form-item",{attrs:{label:"使用时间(分)",prop:"useTime"}},[a("el-input",{attrs:{value:e.dateInterval(e.formModel.endTimeText,e.formModel.startTimeText),disabled:!0}})],1),a("el-form-item",{attrs:{label:"开始里程(km)",prop:"startMileage"}},[a("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formModel.startMileage,callback:function(t){e.$set(e.formModel,"startMileage",t)},expression:"formModel.startMileage"}})],1),a("el-form-item",{attrs:{label:"结束里程(km)",prop:"endMileage"}},[a("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formModel.endMileage,callback:function(t){e.$set(e.formModel,"endMileage",t)},expression:"formModel.endMileage"}})],1),a("el-form-item",{attrs:{label:"使用里程(km)"}},[a("el-input",{attrs:{value:e.useMileage,disabled:!0}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"请输入备注"},model:{value:e.formModel.remarks,callback:function(t){e.$set(e.formModel,"remarks",t)},expression:"formModel.remarks"}})],1)],1),a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.formOperations},on:{operate:e.handleOperate}})],1),a("biz-dialog-selector",{attrs:{title:"选择车型",visibility:e.showProductSelector,tableData:e.productTableData,pagination:e.productPagination,selectionMode:"single"},on:{"update:visibility":function(t){e.showProductSelector=t},pageSizeChange:e.productPageSizeChange,currentPageChange:e.productCurrentPageChange,confirmed:e.confirmedProduct}},[a("el-table-column",{attrs:{property:"fullName",label:"名称"}}),a("el-table-column",{attrs:{property:"price",label:"销售价"}})],1)],1)},ae=[],oe=(a("4d63"),a("25f0"),a("1276"),a("46fc")),ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[a("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tags:e.tags,pagination:e.pagination,tableData:e.tableData,loading:e.loading,checkable:e.checkable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange}},[e._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],1)},re=[],ie={name:"BizDialogSelector",components:{BizFlexTable:q["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},selectionKeys:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],innerSelection:[]}},methods:{generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]);else{var a=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(a,1)}},open:function(e){console.log(this.selectionKeys),this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){this.innerSelectionKeys.length>0?(this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1):this.$message("请选择一项")},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a>=0&&t.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a<0&&t.innerSelectionKeys.push(e[t.keyField])}))},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},rowClick:function(e,t,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){}},se=ie,le=(a("ef0b"),Object(I["a"])(se,ne,re,!1,null,null,null)),ce=le.exports,de={data:{loading:!1,showProductSelector:!1,operations:[{label:"新建",name:"add",type:"primary",auth:["admin:potential.edit"]},{disabled:!0,label:"删除",name:"delete",type:"",auth:["admin:potential.edit"]}],productTableData:[],productPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入店铺名称",name:"searchValue",value:""}]},methods:Object(l["a"])(Object(l["a"])({},Object(p["c"])(["getUser"])),{},{dateInterval:function(e,t){if(e&&t)return Object(oe["a"])(e.split(" ")[1],t.split(" ")[1])},queryProduct:function(){var e=this;k["a"].listProductByTestDrive({clientType:"2",methodName:"ListProductByTestDrive",shopId:this.getUser().shop?this.getUser().shop.id:window.top.SHOP_ID,pageSize:this.productPagination.pageSize,pageNumber:this.productPagination.currentPage},(function(t){e.productTableData=t.content,e.productPagination.total=Number(t.total),e.showProductSelector=!0}),(function(t){e.$message.warning(t.errorMessage)}))},getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",viewMode:this.viewMode,potentialConsumerId:this.itemId.id,pageSize:100,pageNumber:1}},getLevel:function(e){return"1"===e?"核心客户H":"2"===e?"重要客户A":"3"===e?"意向客户B":"4"===e?"一般客户C":"0"===e?"签约O":"5"===e?"战败F":"6"===e?"交车D":"7"===e?"无意向N":void 0},query:function(){var e=this;this.loading=!0,m["a"].get(u["u"].testDrive.list,this.getQueryParams()).then((function(t){e.tableData=t.dataList,e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},add:function(){this.initForm()},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")},productPageSizeChange:function(e){this.$set(this.productPagination,"pageSize",e)},productCurrentPageChange:function(e){this.$set(this.productPagination,"currentPage",e)},confirmedProduct:function(e,t){this.$set(this.formModel.product,"id",t[0].id),this.$set(this.formModel.product,"name",t[0].fullName)}}),events:{handleOperate:function(e){this[e]()}}},ue={data:{tableData:[],selections:[]},methods:{dateConverter:function(e){if(e.testTime){e.testTime=e.testTime.replace(/-/g,"/");var t=new Date(e.testTime);return f["a"].dateConverter(t)}return"--"},startTimeConverter:function(e){if(e.startTime){e.startTime=e.startTime.replace(/-/g,"/");var t=new Date(e.startTime);return f["a"].shortTimeConverter(t)}return"--"},endTimeConverter:function(e){if(e.endTime){e.endTime=e.endTime.replace(/-/g,"/");var t=new Date(e.endTime);return f["a"].shortTimeConverter(t)}return"--"},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var a={viewMode:t.viewMode,ids:e};m["a"].delete(u["u"].testDrive.delete,a).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))}},events:{rowDeleteClickHandler:function(e,t){e.stopPropagation(),this.deleteItem([t.id])},handleRowClick:function(e){this.queryItem(e.id)},handleSelectionChange:function(e){this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1),this.selections=e}}},me=function(){return{testTime:null,startTimeText:null,endTimeText:null,brand:null,series:null,product:{id:"",name:""}}},fe={data:{formLoading:!1,showForm:!1,formModel:me(),modeList:[{value:"call",label:"电话"},{value:"inshop",label:"到店"}],reasonList:[{value:"alarm",label:"提醒回访"},{value:"sale",label:"交车回访"},{value:"insurance",label:"首保回访"},{value:"failure",label:"战败"}],formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"saveForm",type:"primary"}]},methods:{queryItem:function(e){var t=this;this.formLoading=!0,m["a"].get(u["u"].testDrive.item,{testDriveRecordId:e,potentialConsumerId:this.itemId.id,viewMode:this.viewMode}).then((function(e){var a=e.testDriveRecord;a.startTimeText=a.startTime,a.endTimeText=a.endTime,a.brand=a.product.brandId?a.product.brandId.toString():"",a.series=a.product.seriesId?a.product.seriesId.toString():"",t.initForm(a),a.brand&&t.querySeriesList(t.formModel.brand),a.series&&t.queryTypeList(t.formModel.series)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.formLoading=!1}))},initForm:function(e){this.showForm=!0;var t=me();this.formModel=e?Object.assign(t,e):t,this.$refs.form&&this.$refs.form.resetFields()},cancelForm:function(){this.showForm=!1},getSaveParams:function(){return{token:"",id:this.formModel.id,testTime:this.formModel.testTime.length>10?this.formModel.testTime:this.formModel.testTime+" "+this.formModel.startTimeText.split(" ")[1],startMileage:this.formModel.startMileage,endMileage:this.formModel.endMileage,remarks:this.formModel.remarks,product:{id:this.formModel.product.id},startTime:this.formModel.testTime+" "+this.formModel.startTimeText.split(" ")[1],endTime:this.formModel.testTime+" "+this.formModel.endTimeText.split(" ")[1],potentialConsumerId:this.itemId.id,shopId:window.top.SHOP_ID||"",viewMode:this.viewMode}},saveForm:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0;var o=e.getSaveParams();!e.formModel.id&&m["a"].post(u["u"].testDrive.add,o).then((function(t){e.query(),e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1})),e.formModel.id&&m["a"].put(u["u"].testDrive.update,o).then((function(t){e.query(),e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))},convertDate:function(e,t){var a=f["a"].dateConverter(e);return a=a.replace(/-/g,"/"),new Date(a+" "+t)}},events:{}},pe={data:{brandList:[],seriesList:[],modeList:[]},methods:{queryBrandList:function(){var e=this;m["a"].get(u["u"].failure.queryBrandList,{brandId:"",seriesId:"",category:"car"}).then((function(t){e.brandList=t.dataList})).catch((function(t){e.brandList=t}))},querySeriesList:function(e){var t=this;m["a"].get(u["u"].failure.querySeriesList,{brandId:e}).then((function(e){t.seriesList=e.dataList})).catch((function(e){t.seriesList=e}))},queryTypeList:function(e){var t=this;m["a"].get(u["u"].failure.queryModeList,{brandId:this.formModel.failureBrandId,seriesId:e}).then((function(e){t.modeList=e.dataList})).catch((function(e){t.modeList=e}))}},events:{handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.formModel,"series",""),this.$set(this.formModel,"product","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.formModel,"product","")}}},he={name:"PotentialCustomerTestDrive",components:{BizHeader:q["d"],BizGrid:c["a"],BizSaveButton:d["a"],BizEmptyTableTab:A["a"],BizDialogSelector:ce},props:{itemId:{type:Object,default:function(){return{id:""}}},viewMode:{type:String,default:function(){return"merge"}}},data:function(){var e=this;return Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},de.data),ue.data),fe.data),pe.data),{},{rules:{testTime:[{required:!0,message:"请选择试驾日期",trigger:"blur"}],startTimeText:[{required:!0,message:"请选择开始时间",trigger:"blur"},{trigger:"blur",validator:function(t,a,o){e.formModel.startTimeText>e.formModel.endTimeText?o(new Error("开始时间不能大于结束时间")):o()}}],endTimeText:[{required:!0,message:"请选择结束时间",trigger:"blur"},{trigger:"blur",validator:function(t,a,o){e.formModel.startTimeText>e.formModel.endTimeText?o(new Error("结束时间不能小于开始时间")):o()}}],startMileage:[{required:!0,message:"请输入开始里程",trigger:"blur"},{trigger:"blur",validator:function(t,a,o){var n=new RegExp(/^\+?[1-9][0-9]*$/);n.test(e.formModel.startMileage)?o():o(new Error("请输入一个大于0的整数"))}}],endMileage:[{required:!0,message:"请输入结束里程",trigger:"blur"},{trigger:"blur",validator:function(t,a,o){var n=new RegExp(/^\+?[1-9][0-9]*$/);n.test(e.formModel.endMileage)?Number(e.formModel.endMileage)<Number(e.formModel.startMileage)?o(new Error("结束里程不能小于开始里程")):o():o(new Error("请输入一个大于0的整数"))}}],brand:[{required:!0,message:"请选择品牌",trigger:["blur","change"]}],series:[{required:!0,message:"请选择车系",trigger:["blur","change"]}],product:[{required:!0,message:"请选择车型",trigger:["blur","change"]},{trigger:"blur",validator:function(t,a,o){e.formModel.product.name?o():o(new Error("请选择试驾车型"))}}]}})},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},de.methods),de.events),ue.methods),ue.events),fe.methods),fe.events),pe.methods),pe.events),computed:{useTime:function(){var e=this.convertDate(this.formModel.testTime,this.formModel.startTimeText),t=this.convertDate(this.formModel.testTime,this.formModel.endTimeText),a=t-e;return isNaN(a)?"----":a/1e3/60},useMileage:function(){var e=Number(this.formModel.endMileage)-Number(this.formModel.startMileage);return isNaN(e)?"----":e}},watch:{itemId:function(e,t){e.id&&this.query()}},created:function(){this.queryBrandList(),this.itemId.id&&this.query()}},ge=he,be=(a("069c"),Object(I["a"])(ge,te,ae,!1,null,null,null)),ve=be.exports,ye=a("439f"),Me={name:"PotentialCustomerPopup",components:{BizPopupTabs:r["a"],PotentialCustomerBaseInfo:C,PotentialCustomerIntention:z,PotentialCustomerCallbackRecord:ee,PotentialCustomerTestDrive:ve},props:{open:{type:Boolean},itemId:{type:Object,default:function(){return{id:""}}},defaultTab:{type:String,default:function(){return"0"}},viewMode:{type:String,default:function(){return"merge"}}},data:function(){return{tabSelection:"0",alertId:{id:""},showFailure:!0,showSign:!0}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)},handleCallbackAlert:function(e){this.alertId=Object.assign({},e),this.tabSelection="3"},query:function(){var e=this;m["a"].get(u["u"].baseInfo.editQuery,{shopId:window.top.SHOP_ID||"",id:this.itemId.id,viewMode:this.viewMode}).then((function(t){var a=t.potentialConsumer,o="0";"1"===a.signTrackingResult&&a.deliverySalesAdvisor&&a.deliverySalesAdvisor.id?o="1":"1"===a.failureTrackingResult&&a.failureSalesAdvisor&&a.failureSalesAdvisor.id&&(o="2"),e.$store.commit("changeConsumerState",{value:o})})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}},computed:{consumerState:function(){return this.$store.state.potentialCustomer.consumerState}},watch:{open:function(e){var t=this;e&&setTimeout((function(){t.tabSelection=t.defaultTab?t.defaultTab:"0",ye["a"].clearMessageBoxes(),t.$message({showClose:!0,message:t.itemId.id?"创建或编辑潜客档案，完善客户信息。从营销活动、试乘试驾等自动建档的潜客需要您完善客户信息":"手动创建潜客档案，填写客户姓名电话等信息，越完整越好哦"})}),500)},itemId:function(e){this.$store.commit("changeConsumerState",{value:"-1"}),e.id?this.query():(this.showFailure=!0,this.showSign=!0)},tabSelection:function(e){switch(this.$refs.dataStreamTab&&this.$refs.dataStreamTab.clearInterval(),ye["a"].clearMessageBoxes(),e){case"0":this.$message({showClose:!0,message:this.itemId.id?"创建或编辑潜客档案，完善客户信息。从营销活动、试乘试驾等自动建档的潜客需要您完善客户信息":"手动创建潜客档案，填写客户姓名电话等信息，越完整越好哦"});break;case"1":this.$message({showClose:!0,message:"回访并确定潜客个性化需求，意向越完整越好；并按照O/H/A/B/C的标准给客户意向分级"});break;case"2":this.$refs.callbackAlert.updateHeight();break;case"3":this.$message({showClose:!0,message:"潜客的定期回访，持续跟踪，回访记录在案；通过回访挖掘客户需求，展现产品优势，预约客户到店试驾"});break;case"4":this.$message({showClose:!0,message:"记录潜客试乘试驾记录；试乘试驾能进一步建立客户信心，激发客户购买欲！"});break;case"5":this.$message({showClose:!0,message:"记录战败情况，以便分析战败原因，提高成交率；战败信息需销售经理确认"});break;case"6":this.$message({showClose:!0,message:"记录签约信息，签约信息需销售经理确认"});break}}}},we=Me,Ie=Object(I["a"])(we,o,n,!1,null,null,null);t["a"]=Ie.exports},"2c5e":function(e,t,a){},"439f":function(e,t,a){"use strict";a("4160"),a("159b");t["a"]={clearMessageBoxes:function(){var e=document.querySelectorAll(".el-message");e.forEach((function(e){e.remove()}))}}},"443b":function(e,t,a){"use strict";a("4de4");var o=a("c596"),n=a("1ab1"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":"",visible:e.visible,title:"自定义列","custom-class":"biz-columns",width:"500px"},on:{close:e.onClose}},[a("div",{staticClass:"columns-wrap"},[a("biz-flex-table",{ref:"table",attrs:{checkable:!1,tableData:e.tableData},on:{"selection-change":e.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.getSelectable}}),a("el-table-column",{attrs:{label:"信息",prop:"name"}}),a("el-table-column",{attrs:{prop:"tag",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.$index;return[a("el-button",{attrs:{icon:"el-icon-sort-up",type:"text",disabled:0===o},on:{click:function(t){return e.onUp(o)}}}),a("el-button",{attrs:{icon:"el-icon-sort-down",type:"text",disabled:o===e.tableData.length-1},on:{click:function(t){return e.onBottom(o)}}})]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)])},i=[],s=(a("7db0"),a("a434"),a("b85c")),l=a("04d3"),c={name:"biz-columns",components:{BizFlexTable:l["c"]},props:{visible:Boolean,tableId:String},data:function(){return{id:"",tableName:"",selections:[],tableData:[]}},computed:{},watch:{visible:function(e){e?this.makeRowDisplayable():this.saveSelection()},tableId:function(){this.getTableColumns()}},mounted:function(){this.getTableColumns()},methods:{getTableColumns:function(){var e=this;n["a"].get(o["g"].user.columns,{tableId:this.tableId}).then((function(t){e.tableData=t.data.columnDatas,e.id=t.data.id,e.tableName=t.data.tableName}))},getSelectable:function(e){return e.isEditable},selectionChangeHandler:function(e){this.selections=e},saveSelection:function(){var e,t=this,a=Object(s["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var o=e.value;o.displayable=!1}}catch(l){a.e(l)}finally{a.f()}var n,r=Object(s["a"])(this.selections);try{var i=function(){var e=n.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(r.s();!(n=r.n()).done;)i()}catch(l){r.e(l)}finally{r.f()}},onUp:function(e){this.tableData[e]=this.tableData.splice(e-1,1,this.tableData[e])[0]},onBottom:function(e){this.tableData[e]=this.tableData.splice(e+1,1,this.tableData[e])[0]},onClose:function(){this.$emit("update:visible",!1)},update:function(){var e,t=this,a=Object(s["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var r=e.value;r.displayable=!1}}catch(u){a.e(u)}finally{a.f()}var i,l=Object(s["a"])(this.selections);try{var c=function(){var e=i.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(l.s();!(i=l.n()).done;)c()}catch(u){l.e(u)}finally{l.f()}var d={columnDatas:this.tableData,id:this.id,tableId:this.tableId,tableName:this.tableName};console.log(d),n["a"].put(o["g"].user.columns,d).then((function(e){t.$emit("update"),t.$emit("update:visible",!1)}))},makeRowDisplayable:function(){var e=this;setTimeout((function(){var t,a=Object(s["a"])(e.tableData);try{for(a.s();!(t=a.n()).done;){var o=t.value;e.$refs.table.$refs.table.toggleRowSelection(o,o.displayable)}}catch(n){a.e(n)}finally{a.f()}}),20)}}},d=c,u=(a("ec6b"),a("2877")),m=Object(u["a"])(d,r,i,!1,null,null,null),f=m.exports,p=f;t["a"]={components:{BizColumnOperation:l["a"],BizColumns:p},data:function(){return{columnsSettingVisible:!1,columns:[]}},created:function(){this.getTableId(),this.getColumns()},methods:{onCustomColumns:function(){this.columnsSettingVisible=!0},getColumns:function(){var e=this;console.log(12),n["a"].get(o["A"].columns,{tableId:this.tableId}).then((function(t){e.columns=[],setTimeout((function(){e.columns=t.data.columnDatas.filter((function(e){return e.displayable})),e.$refs.table&&setTimeout((function(){e.$refs.table.doLayout()}),50)}),20)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getTableId:function(){}}}},4653:function(e,t,a){},"46fc":function(e,t,a){"use strict";a("ac1f"),a("1276");t["a"]=function(e,t){if(!e||!t)return 0;var a=t.split(":"),o=e.split(":"),n=60*(o[0]-a[0])+(o[1]-a[1]);return n<0?0:n}},"4b90":function(e,t,a){"use strict";a("4160"),a("a15b"),a("ac1f"),a("5319"),a("159b");t["a"]={toURLParams:function(e){var t=[],a=function(a){t.push("&"),e[a]instanceof Array?e[a].forEach((function(e,o){0!==o&&t.push("&"),t.push(a),t.push("="),t.push(e)})):(t.push(a),t.push("="),t.push(e[a]))};for(var o in e)a(o);return encodeURI(t.join("").replace("&","?"))}}},"53c6":function(e,t,a){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var o=a("1d80"),n=a("5899"),r="["+n+"]",i=RegExp("^"+r+r+"*"),s=RegExp(r+r+"*$"),l=function(e){return function(t){var a=String(o(t));return 1&e&&(a=a.replace(i,"")),2&e&&(a=a.replace(s,"")),a}};e.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(e,t,a){"use strict";var o=a("9678"),n=a.n(o);n.a},6401:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-empty-table",style:e.emptyStyle})},n=[],r=a("f260"),i=a.n(r),s={name:"",data:function(){return{EmptyImg:i.a}},components:{},computed:{emptyStyle:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+i.a+") 50% 50% / auto 200px no-repeat"}}},methods:{},mounted:function(){}},l=s,c=a("2877"),d=Object(c["a"])(l,o,n,!1,null,null,null);t["a"]=d.exports},"64ec":function(e,t,a){},"674b":function(e,t,a){},"697f":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),a("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?a("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},n=[],r=(a("99af"),a("4160"),a("c975"),a("a434"),a("a9e3"),a("159b"),a("04d3")),i={name:"BizDialogSelector",components:{BizFlexTable:r["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var a=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(a,1),this.innerSelection.splice(a,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a>=0&&t.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},s=i,l=(a("0943"),a("2877")),c=Object(l["a"])(s,o,n,!1,null,null,null);t["a"]=c.exports},"6c4f":function(e,t,a){"use strict";var o=a("674b"),n=a.n(o);n.a},7132:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},n=[],r={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},i=r,s=(a("5b8e"),a("2877")),l=Object(s["a"])(i,o,n,!1,null,null,null),c=l.exports,d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},u=[],m=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),f=m,p=(a("d4c2"),Object(s["a"])(f,d,u,!1,null,null,null)),h=p.exports;a.d(t,"a",(function(){return h}))},"7c99":function(e,t,a){"use strict";var o=a("2766"),n=a.n(o);n.a},"8dd6":function(e,t,a){"use strict";var o=a("ef19"),n=a.n(o);n.a},"912a":function(e,t,a){},9433:function(e,t,a){"use strict";var o=a("202d"),n=a.n(o);n.a},9678:function(e,t,a){},"99f0":function(e,t,a){"use strict";var o=a("4653"),n=a.n(o);n.a},"9b77":function(e,t,a){},a9e3:function(e,t,a){"use strict";var o=a("83ab"),n=a("da84"),r=a("94ca"),i=a("6eeb"),s=a("5135"),l=a("c6b6"),c=a("7156"),d=a("c04e"),u=a("d039"),m=a("7c73"),f=a("241c").f,p=a("06cf").f,h=a("9bf2").f,g=a("58a8").trim,b="Number",v=n[b],y=v.prototype,M=l(m(y))==b,w=function(e){var t,a,o,n,r,i,s,l,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:o=2,n=49;break;case 79:case 111:o=8,n=55;break;default:return+c}for(r=c.slice(2),i=r.length,s=0;s<i;s++)if(l=r.charCodeAt(s),l<48||l>n)return NaN;return parseInt(r,o)}return+c};if(r(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var I,S=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof S&&(M?u((function(){y.valueOf.call(a)})):l(a)!=b)?c(new v(w(t)),a,S):w(t)},C=o?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),O=0;C.length>O;O++)s(v,I=C[O])&&!s(S,I)&&h(S,I,p(v,I));S.prototype=y,y.constructor=S,i(n,b,S)}},af3f:function(e,t,a){"use strict";var o=a("697f");t["a"]=o["a"]},b547:function(e,t,a){},baa5:function(e,t,a){var o=a("23e7"),n=a("e58c");o({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},c20d:function(e,t,a){var o=a("da84"),n=a("58a8").trim,r=a("5899"),i=o.parseInt,s=/^[+-]?0[Xx]/,l=8!==i(r+"08")||22!==i(r+"0x16");e.exports=l?function(e,t){var a=n(String(e));return i(a,t>>>0||(s.test(a)?16:10))}:i},c466:function(e,t,a){"use strict";a("99af"),a("d3b7"),a("ac1f"),a("25f0"),a("5319");t["a"]={nowDate:function(){var e=new Date,t=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()+1<10?"0"+e.getDate():e.getDate();return e.getFullYear().toString()+"-"+t+"-"+a},getMonthDays:function(e){var t=new Date(Date.parse(e.replace(/-/g,"/"))),a=new Date(t.getFullYear(),t.getMonth(),1),o=new Date(t.getFullYear(),t.getMonth()+1,1),n=(o-a)/864e5;return n},halfYearAgo:function(e){var t="";return t=e?new Date(Date.parse(e.replace(/-/g,"/"))):new Date,console.log(t),t.setMonth(t.getMonth()-6),"".concat(t.getFullYear(),"-").concat(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getDate()<10?"0"+t.getDate():t.getDate())},lastMonthDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1<10?"0"+e.getMonth():e.getMonth(),o=e.getDate()+1<10?"0"+e.getDate():e.getDate();return"00"===a&&(a="12",t--),t.toString()+"-"+a+"-"+o},nextMonthDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,o=e.getDate(),n=parseInt(a)+1;13===n&&(t=parseInt(t)+1,n=1);var r=new Date(t,n,0);return r=r.getDate(),o>r&&(o=r),n<10&&(n="0"+n),t+"-"+n+"-"+o},lastYearDate:function(){var e=new Date,t=new Date(e.getFullYear()-1,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastTwoYearDate:function(){var e=new Date,t=new Date(e.getFullYear()+2,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastNYearDate:function(e,t){var a=new Date(e),o=new Date(a.getFullYear()+parseInt(t),a.getMonth(),a.getDate());return o.getFullYear()+"-"+this.convertToFullMode(o.getMonth()+1)+"-"+this.convertToFullMode(o.getDate())},dateConverter:function(e){return e instanceof Date?e.getFullYear()+"-"+this.convertToFullMode(e.getMonth()+1)+"-"+this.convertToFullMode(e.getDate()):e},timeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes())+":"+this.convertToFullMode(e.getSeconds()):e},shortTimeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes()):e},dateTimeConverter:function(e){return e instanceof Date?this.dateConverter(e)+" "+this.timeConverter(e):e},convertToFullMode:function(e){return e=e.toString(),1===e.length?"0"+e:e}}},c4a2:function(e,t,a){"use strict";var o=a("2c5e"),n=a.n(o);n.a},c8d1:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"potential-customer-mgmt"},[a("div",{staticClass:"toggle-btn",on:{click:e.isShow}},[e._v(" "+e._s(e.toggleRecommendTxt)+" "),a("div",{staticClass:"iconfont biz-icon-i-web-zd1",class:{"rotate-180":e.showRecommend}})]),a("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,loading:e.loading,checkable:!1,pagination:e.pagination},on:{operate:e.handleOperate,"size-change":e.handlePageSizeChange,"current-change":e.handleCurrentPageChange,"selection-change":e.handleSelectionChange,"filter-data-change":e.handleFilterDataChange,"row-click":e.handleRowClick,"sort-change":e.handleSortChange,"active-item-change":e.activeItemChange,"cascader-change":e.cascaderChange}},[e.hasAuthImport?a("template",{slot:"operation"},[a("import-file",{ref:"importFile",staticStyle:{"margin-left":"10px"},attrs:{tableData:e.importResult,importLoading:e.importLoading,total:e.total,disabled:e.disabled,count:e.count,percentage:e.percentage,stepkey:e.stepkey,action:"/admin/customer/importConsumer.jhtml",name:"uFile"},on:{clearTimeOut:e.clearTimeOut,restProcess:e.restProcess,"handle-import":e.handleImport}},[a("el-table-column",{attrs:{label:"编号",prop:"line",width:"50"}}),a("el-table-column",{attrs:{label:"消息",prop:"result"}})],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"",size:"mini"},on:{click:function(t){return e.changeView(e.viewMode)}}},[e._v(e._s("record"===e.viewMode?"记录视图":"合并视图"))])],1):e._e(),a("el-table-column",{attrs:{label:"潜客信息","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"customer-info"},[t.row.head?a("img",{attrs:{src:t.row.head}}):a("img",{attrs:{src:"/resources/admin/images/Avatar.png"}}),a("div",{staticClass:"wrapper"},[a("div",{staticClass:"title"},[e._v(e._s(t.row.name))]),a("div",{staticClass:"gender"},["male"===t.row.gernder?a("i",{staticClass:"male iconfont biz-icon-i-web-m"}):e._e(),"female"===t.row.gernder?a("i",{staticClass:"female iconfont biz-icon-i-web-f"}):e._e(),"unknown"===t.row.gernder?a("i",{staticClass:"none iconfont biz-icon-i-web-bm"}):e._e(),a("span",[e._v(e._s(t.row.mobile))])])])])]}}])}),a("el-table-column",{attrs:{label:"意向商品","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(t.row.intentionCars.length>0?t.row.intentionCars[0].intentionName:""))])])]}}])}),a("el-table-column",{attrs:{label:"渠道","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(t.row.customerChannel&&t.row.customerChannel.name?t.row.customerChannel.name:""))])])]}}])}),a("el-table-column",{attrs:{label:"潜客级别","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(t.row.level)+e._s(t.row.levelInfo))])])]}}])}),a("el-table-column",{attrs:{label:"潜客跟踪","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v("顾问："+e._s(e.salesConverter(t.row)))]),a("div",{staticClass:"overflow"},[e._v("建档日期："+e._s(e.createDateConverter(t.row)))]),a("div",{staticClass:"overflow"},[e._v("下次回访日期："+e._s(e.backDateConverter(t.row)))])])]}}])})],2),a("div",{attrs:{slot:"float"},slot:"float"},[a("right-popup",{ref:"RightPopup",attrs:{open:e.open,itemId:e.itemId,viewMode:e.viewMode,defaultTab:e.defaultTab},on:{close:function(t){e.open=!1},operationSuccess:e.handleOperationSuccess}}),a("callback-setting-popup",{attrs:{open:e.openCallback,itemId:e.callbackId},on:{close:function(t){e.openCallback=!1},operationSuccess:e.handleCallbackOperationSuccess}}),a("biz-popup-tabs",{attrs:{open:e.openTest},on:{close:function(t){e.openTest=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:"试驾协议",name:"first"}},[a("TestDriveAgreement",{attrs:{open:e.openTest}})],1)],1)],1),a("el-dialog",{attrs:{title:"潜客分配",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",[e._v("将选中"+e._s(e.selections.length)+"个潜客分配至")]),a("el-form",[a("el-form-item",{attrs:{label:"分配顾问：",prop:"salesAdvisor"}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.salesAdvisor,callback:function(t){e.salesAdvisor=t},expression:"salesAdvisor"}},e._l(e.salesList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmDistribute}},[e._v("确 定")])],1)],1),a("biz-columns",{attrs:{visible:e.columnsSettingVisible,tableId:e.tableId},on:{"update:visible":function(t){e.columnsSettingVisible=t},update:e.getColumns}})],1)},n=[],r=(a("99af"),a("4160"),a("caad"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("25eb"),a("d3b7"),a("ac1f"),a("2532"),a("3ca3"),a("466d"),a("1276"),a("159b"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),i=a("5530"),s=a("04d3"),l=a("ccf0"),c=a("2abe"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[a("el-tab-pane",{attrs:{label:"意向设置",name:"0"}},[a("intention-setting",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1),a("el-tab-pane",{attrs:{label:"回访设置",name:"1"}},[a("callback-setting",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1),a("el-tab-pane",{attrs:{label:"线索设置",name:"2"}},[a("clue-setting",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1),a("el-tab-pane",{attrs:{label:"渠道设置",name:"3"}},[a("channel-setting",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1)],1)},u=[],m=a("7132"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer__callback-setting"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"span-method":e.arraySpanMethod,size:"small"}},[a("el-table-column",{attrs:{prop:"level",label:"意向等级","min-width":"90",formatter:e.upperCaseConverter},scopedSlots:e._u([{key:"default",fn:function(t){return["FOLLOWLIMIT"!==t.row.level?a("div",[e._v(" "+e._s(t.row.level)+" ")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"remarks",label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(" "+e._s(t.row.remarks)+" ")])]}}])}),a("el-table-column",{attrs:{label:"回访间隔","min-width":"240"},scopedSlots:e._u([{key:"default",fn:function(t){return["FOLLOWLIMIT"!==t.row.level?a("el-radio-group",{staticClass:"callback-radio",attrs:{size:"mini"},model:{value:t.row.callback,callback:function(a){e.$set(t.row,"callback",a)},expression:"scope.row.callback"}},[a("el-radio",{attrs:{label:!1}},[e._v("不回访")]),a("el-radio",{attrs:{label:!0}},[e._v("回访")])],1):e._e(),"FOLLOWLIMIT"!==t.row.level?a("el-input",{attrs:{disabled:!t.row.callback,type:"number",size:"mini",min:"0"},model:{value:t.row.visitInterval,callback:function(a){e.$set(t.row,"visitInterval",a)},expression:"scope.row.visitInterval"}}):e._e()]}}])})],1)],1)},p=[],h=(a("c975"),a("f36f")),g=a("8330"),b=a("c596"),v=a("1ab1"),y={data:{loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],tableData:[],day:""},methods:{upperCaseConverter:function(e){return e.level.toUpperCase()},arraySpanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(8===t&&1===a)return[1,2]},query:function(){var e=this;this.loading=!0,v["a"].get(b["u"].callbackSetting.callbackSetting,{shopId:window.top.SHOP_ID||""}).then((function(t){t.dataList.map((function(e){"FOLLOWLIMIT"===e.level?e.callback=!0:e.callback=!!e.visitInterval})),e.tableData=t.dataList})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},checkValid:function(e){for(var t=0;t<e.length;t++)if(e[t].callback){var a=e[t].visitInterval;if(a.indexOf(".")>=0)return this.$message.warning("回访间隔必须为大于0的整数"),!1;var o=Number(a);if(isNaN(o)||o<=0)return this.$message.warning("回访间隔必须为大于0的整数"),!1}return!0},convertSaveData:function(e){var t=[];return e.forEach((function(e){var a=Object.assign({},e);a.callback?a.visitInterval=Number.parseInt(a.visitInterval):a.visitInterval="",t.push(a)})),t},save:function(){var e=this,t=this.checkValid(this.tableData);if(t){var a=this.convertSaveData(this.tableData);v["a"].post(b["u"].callbackSetting.callbackSetting,{shopId:window.top.SHOP_ID||"",dataList:a}).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}}},events:{operateHandler:function(e){this[e]()}}},M={name:"CallbackSetting",components:{BizSaveButton:g["a"],BizGrid:h["a"]},data:function(){return Object(i["a"])({},y.data)},props:{itemId:{type:Object,default:function(){return{id:""}}}},created:function(){this.itemId.id&&this.query()},methods:Object(i["a"])(Object(i["a"])({},y.events),y.methods),watch:{itemId:function(e,t){console.log(e),this.query()}}},w=M,I=(a("c4a2"),a("2877")),S=Object(I["a"])(w,f,p,!1,null,null,null),C=S.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer__channel-setting"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"120px",model:e.form}},[a("el-form-item",{attrs:{label:"潜客渠道"}},e._l(e.tableData,(function(t,o){return a("div",{key:o},[a("el-input",{attrs:{disabled:"0"===t.supportEdit},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"data.name"}},[e.tableData.length-1===o?a("el-button",{attrs:{slot:"append",icon:"el-icon-circle-plus"},on:{click:e.add},slot:"append"}):e._e(),"1"===t.supportEdit?a("el-button",{attrs:{slot:"append",icon:"el-icon-circle-close"},on:{click:function(a){return e.remove(t)}},slot:"append"}):e._e()],1)],1)})),0)],1)],1)},D=[],k={data:{loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],form:{},tableData:[],tempData:[],day:""},methods:{upperCaseConverter:function(e){return e.level.toUpperCase()},query:function(){var e=this;this.loading=!0,v["a"].get(b["u"].customerChannels,{shopId:window.top.SHOP_ID||""}).then((function(t){e.tableData=t.dataList})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},convertSaveData:function(e){var t=[];return e.forEach((function(e){var a=Object.assign({},e);t.push(a)})),t},add:function(){this.tableData.push({id:"",name:"",supportEdit:"1"})},remove:function(e){var t=this;this.$confirm("删除当前渠道，则将当前渠道下全部潜客渠道置空","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.tableData.splice(t.tableData.indexOf(e),1),e.operateType="D",t.tempData.push(e)})).finally((function(){t.loading=!1}))},save:function(){var e=this,t=this.convertSaveData(this.tableData.concat(this.tempData));v["a"].post(b["u"].customerChannels,{shopId:window.top.SHOP_ID||"",dataList:t}).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}},events:{operateHandler:function(e){this[e]()}}},x={name:"ChannelSetting",components:{BizSaveButton:g["a"],BizGrid:h["a"]},data:function(){return Object(i["a"])({},k.data)},props:{itemId:{type:Object,default:function(){return{id:""}}}},created:function(){this.itemId.id&&this.query()},methods:Object(i["a"])(Object(i["a"])({},k.events),k.methods),watch:{itemId:function(e,t){console.log(e),this.query()}}},T=x,$=(a("f8da"),Object(I["a"])(T,O,D,!1,null,null,null)),_=$.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer__clue-setting"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"span-method":e.arraySpanMethod}},[a("el-table-column",{attrs:{prop:"remarks",label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){return["FOLLOWLIMIT"===t.row.level?a("div",[a("el-input",{attrs:{size:"mini"},model:{value:t.row.visitInterval,callback:function(a){e.$set(t.row,"visitInterval",a)},expression:"scope.row.visitInterval"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("潜客分配后，")]),a("div",{attrs:{slot:"append"},slot:"append"},[e._v("天未跟进回访，抛回公海")])])],1):a("div",[e._v(" "+e._s(t.row.remarks)+" ")])]}}])}),a("el-table-column",{attrs:{label:"设置",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return["FOLLOWLIMIT"!==t.row.level?a("el-radio-group",{staticClass:"callback-radio",attrs:{size:"mini"},model:{value:t.row.isValid,callback:function(a){e.$set(t.row,"isValid",a)},expression:"scope.row.isValid"}},[a("el-radio",{attrs:{label:"1"}},[e._v("可见")]),a("el-radio",{attrs:{label:"0"}},[e._v("不可见")])],1):e._e()]}}])})],1)],1)},j=[],P={data:{loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],form:{},tableData:[],day:""},methods:{upperCaseConverter:function(e){return e.level.toUpperCase()},arraySpanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(2===t&&0===a)return[1,2]},query:function(){var e=this;this.loading=!0,v["a"].get(b["u"].callbackSetting.callbackSetting,{shopId:window.top.SHOP_ID||"",type:"track"}).then((function(t){e.tableData=t.dataList})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},convertSaveData:function(e){var t=[];return e.forEach((function(e){var a=Object.assign({},e);a.visitInterval=Number.parseInt(a.visitInterval),t.push(a)})),t},save:function(){var e=this,t=this.convertSaveData(this.tableData);v["a"].post(b["u"].callbackSetting.callbackSetting,{shopId:window.top.SHOP_ID||"",dataList:t}).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}},events:{operateHandler:function(e){this[e]()}}},z={name:"ClueSetting",components:{BizSaveButton:g["a"],BizGrid:h["a"]},data:function(){return Object(i["a"])({},P.data)},props:{itemId:{type:Object,default:function(){return{id:""}}}},created:function(){this.itemId.id&&this.query()},methods:Object(i["a"])(Object(i["a"])({},P.events),P.methods),watch:{itemId:function(e,t){console.log(e),this.query()}}},B=z,F=(a("e663"),Object(I["a"])(B,L,j,!1,null,null,null)),q=F.exports,A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer__intention-setting"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"level",label:"意向等级","min-width":"90",formatter:e.upperCaseConverter},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.level)+" ")]}}])}),a("el-table-column",{attrs:{prop:"remarks",label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",disabled:"0"===t.row.supportEdit},model:{value:t.row.remarks,callback:function(a){e.$set(t.row,"remarks",a)},expression:"scope.row.remarks"}})]}}])})],1)],1)},R=[],N={data:{loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],tableData:[],day:""},methods:{upperCaseConverter:function(e){return e.level.toUpperCase()},query:function(){var e=this;this.loading=!0,v["a"].get(b["u"].intentionSettings,{shopId:window.top.SHOP_ID||""}).then((function(t){e.tableData=t.dataList})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},convertSaveData:function(e){var t=[];return e.forEach((function(e){var a=Object.assign({},e);t.push(a)})),t},save:function(){var e=this,t=this.convertSaveData(this.tableData);v["a"].post(b["u"].intentionSettings,{shopId:window.top.SHOP_ID||"",dataList:t}).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}},events:{operateHandler:function(e){this[e]()}}},V={name:"IntentionSetting",components:{BizSaveButton:g["a"],BizGrid:h["a"]},data:function(){return Object(i["a"])({},N.data)},props:{itemId:{type:Object,default:function(){return{id:""}}}},created:function(){this.itemId.id&&this.query()},methods:Object(i["a"])(Object(i["a"])({},N.events),N.methods),watch:{itemId:function(e,t){console.log(e),this.query()}}},E=V,H=(a("99f0"),Object(I["a"])(E,A,R,!1,null,null,null)),K=H.exports,U={name:"CallbackSettingPopup",components:{BizPopupTabs:m["a"],CallbackSetting:C,IntentionSetting:K,ClueSetting:q,ChannelSetting:_},props:{open:{type:Boolean},itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{tabSelection:"0"}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)}},watch:{open:function(e){var t=this;e&&setTimeout((function(){t.tabSelection="0"}),500)}}},Q=U,Y=Object(I["a"])(Q,d,u,!1,null,null,null),G=Y.exports,W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"test-drive-agreement"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"试驾协议",prop:"protocol"}},[a("BizAvatarUploaderNew",{model:{value:e.form.protocol,callback:function(t){e.$set(e.form,"protocol",t)},expression:"form.protocol"}})],1)],1)],1)},X=[],J=a("c17f"),Z={name:"TestDriveAgreement",data:function(){return{isCreated:!0,loading:!1,list:[],operations:[{label:"保存",name:"save",type:"primary",auth:["admin:potential.edit"]}],form:{id:"",protocol:""},rules:{protocol:[{required:!0,message:"请上传试驾协议",trigger:"blur"}]}}},props:{open:{type:Boolean,default:function(){return!1}}},components:{BizSaveButton:g["a"],BizGrid:h["a"],BizAvatarUploaderNew:J["b"]},created:function(){},computed:{},watch:{open:function(e,t){e&&(this.query(),this.$refs.form.clearValidate())}},methods:{operate:function(e){this[e]()},query:function(){var e=this;v["a"].get("/admin/order/testDrive/protocol.jhtml",{shopId:window.top.SHOP_ID||""}).then((function(t){e.form=Object.assign({},t.content)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;v["a"].post("/admin/order/testDrive/protocol.jhtml",e.form).then((function(t){e.$message.success("保存成功")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))}))},handleUploadSuccess:function(e){this.form.protocol=e,this.$refs.form.clearValidate(["protocol"])}}},ee=Z,te=(a("7c99"),Object(I["a"])(ee,W,X,!1,null,null,null)),ae=te.exports,oe=a("c466"),ne=a("4b90"),re=a("2f62"),ie={platformAdmin:0,platformOperator:1,operatorAdmin:2,shopOperator:3,service:4,serviceAdmin:5,market:6,salesman:7,afterSale:8,generalManager:9,rescuer:10,reception:11,finance:12,guard:13,marketAdmin:14,salesmanAdmin:15,afterSaleAdmin:16,financeAdmin:17},se=a("443b"),le=a("bc3a"),ce=a.n(le),de=[{value:"created",label:"已建档"},{value:"intention",label:"意向客户"},{value:"signed",label:"已签约"},{value:"failed",label:"已战败"},{value:"finished",label:"已结束"}],ue={itemId:{id:""},selections:[],salesAdvisor:"",defaultTab:"0",tabName:"first",openTest:!1,consumerStateList:de,channelList:[],open:!1,isAdmin:!1},me={loading:!1,dialogVisible:!1,viewMode:"merge",tableData:[],showRecommend:!1,operations:[{label:"新增",name:"add",type:"primary",auth:["admin:potential.add"]},{label:"刷新",name:"refresh",type:""},{label:"模板下载",name:"download",type:""},{label:"导出",name:"export",type:"",auth:["admin:potential.export"]}],filters:[{type:"cascader",label:"意向车型",name:"potentialId",filterable:!1,value:[],class:"hidden",options:[]},{type:"select",label:"渠道",name:"channel",value:"",class:"hidden",options:[]},{type:"select",label:"潜客级别",name:"level",value:"",class:"hidden",options:[{value:"",label:"全部"},{value:"0",label:"O"},{value:"1",label:"H"},{value:"2",label:"A"},{value:"3",label:"B"},{value:"4",label:"C"},{value:"5",label:"F"},{value:"6",label:"D"},{value:"7",label:"N"}]},{type:"select",label:"顾问",name:"potentialId",value:"",class:"hidden",options:[]},{type:"input",label:"",placeholder:"请输入客户姓名/电话",name:"searchValue",value:""}],pagination:{pageSize:20,currentPage:1,total:0},salesList:[],sortInfo:{},carType:[]},fe=Object(i["a"])(Object(i["a"])({},Object(re["d"])("Sales",["updatePotentialInfo","updateConsumer"])),{},{changeView:function(e){this.pagination.currentPage=1,this.viewMode="merge"===e?"record":"merge",this.query()},test:function(){this.openTest=!0},querySalesList:function(){var e=this;v["a"].get(b["u"].mainPage.salesList,this.getQueryParams()).then((function(t){var a=t.dataList;a.map((function(e){e.value=e.id,e.label=e.name})),a.unshift({value:"-1",label:"未分配"}),a.unshift({value:"",label:"全部"}),e.$set(e.filters[3],"options",a)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},queryKpi:function(){var e=this;v["a"].get(b["u"].mainPage.kpi,this.getQueryParams()).then((function(t){e.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:"累计潜客记录".concat(t.totalCount,"条，\n            今日新增潜客").concat(t.dayCount,"人，\n            意向客户").concat(t.intentionCount,"人，\n            签约").concat(t.signedCount,"人，\n            战败").concat(t.failureCount,"人"),duration:3e3})})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},distribute:function(){var e=this;0!==this.selections.length?(v["a"].get(b["u"].mainPage.salesList,this.getQueryParams()).then((function(t){var a=t.dataList;a.map((function(e){e.value=e.id,e.label=e.name})),a.unshift({value:"-1",label:"未分配"}),e.salesList=a})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})),this.dialogVisible=!0):this.$message.warning("请选择要分配的潜客")},channelListData:function(){var e=this;v["a"].get(b["u"].customerChannels,{shopId:window.top.SHOP_ID||""}).then((function(t){e.channelList=t.dataList,e.filters[1].options=[{label:"全部",value:""}].concat(t.dataList.map((function(e){return{label:e.name,value:e.id}})))})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},confirmDistribute:function(){var e=this,t=[];this.selections.map((function(e){t.push(e.id)}));var a={ids:t,adminId:this.salesAdvisor,viewMode:this.viewMode};v["a"].put(b["u"].mainPage.distribute,a).then((function(t){e.$message.success("分配成功"),e.query(),e.dialogVisible=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},export:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,o,n,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=[],e.selections.forEach((function(e){a.push(e.id)})),o={potentialIds:a||[],shopId:window.top.SHOP_ID||"",level:e.filters[2].value||"",customerChannelId:e.filters[1].value||"",salesAdvisorId:e.filters[3].value||"",searchValue:e.filters[4].value||"",nameormobile:e.filters[4].value||"",orderProperty:e.sortInfo.column||"",orderDirection:e.sortInfo.sort||"",viewMode:e.viewMode||"",pageSize:e.pagination.pageSize||"",pageNumber:e.pagination.currentPage||""},t.prev=3,t.next=6,ce.a.post(b["u"].mainPage.export,o,{responseType:"blob"});case 6:return n=t.sent,console.log("response => ",n),r=new Blob([n.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(n.headers["content-disposition"])),i=decodeURI(n.headers["content-disposition"].split("filename=")[1]),s=document.createElement("a"),s.download=i.match(/"(\S*)"/)[1],s.style.display="none",s.href=URL.createObjectURL(r),document.body.appendChild(s),s.click(),URL.revokeObjectURL(s.href),document.body.removeChild(s),t.abrupt("return");case 22:throw t.prev=22,t.t0=t["catch"](3),new Error(t.t0);case 25:case"end":return t.stop()}}),t,null,[[3,22]])})))()},getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",level:this.filters[2].value,customerChannelId:this.filters[1].value,salesAdvisorId:this.filters[3].value,searchValue:this.filters[4].value,nameormobile:this.filters[4].value,orderProperty:this.sortInfo.column,orderDirection:this.sortInfo.sort,viewMode:this.viewMode,pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,brandId:this.carType[0]||"",seriesId:this.carType[1]||""}},query:function(){var e=this;this.loading=!0,v["a"].get(b["u"].mainPage.potentialCustomerList,this.getQueryParams()).then((function(t){e.tableData=t.content,e.$set(e.pagination,"total",Number.parseInt(t.total))})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},queryPotentialInfo:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v["a"].get(b["u"].baseInfo.addQuery,{shopId:window.top.SHOP_ID||"",id:e,viewMode:t.viewMode});case 3:return o=a.sent,console.log("response => ",o),t.updatePotentialInfo(o),a.abrupt("return");case 9:throw a.prev=9,a.t0=a["catch"](0),new Error(a.t0);case 12:case"end":return a.stop()}}),a,null,[[0,9]])})))()},queryConsumerInfo:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v["a"].get(b["u"].baseInfo.editQuery,{shopId:window.top.SHOP_ID||"",id:e,viewMode:t.viewMode});case 3:return o=a.sent,console.log("response => ",o),t.updateConsumer(o),a.abrupt("return");case 9:throw a.prev=9,a.t0=a["catch"](0),new Error(a.t0);case 12:case"end":return a.stop()}}),a,null,[[0,9]])})))()},queryPotentialBaseInfo:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.queryConsumerInfo(e);case 3:t.itemId={id:e},t.open=!0,a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$message.warning(a.t0.errorMessage);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},refresh:function(){this.query()},driveItem:function(e){this.defaultTab="4",this.queryPotentialBaseInfo(String(e))},signItem:function(e){this.defaultTab="6",this.queryPotentialBaseInfo(String(e))},failItem:function(e){this.defaultTab="5",this.queryPotentialBaseInfo(String(e))},abandonItem:function(e){var t=this;this.$confirm("是否确认废弃?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var a=ne["a"].toURLParams({ids:e});v["a"].post(b["u"].mainPage.potentialCustomer_abandon+a,{}).then((function(e){t.$message.success("废弃成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var a=ne["a"].toURLParams({ids:e});v["a"].post(b["u"].mainPage.potentialCustomer_delete+a,{}).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")},add:function(){this.defaultTab="0",this.open=!0,this.itemId={id:""},this.$refs.RightPopup.$refs.base.resetModel(),this.$refs.RightPopup.$refs.base.getChannelList()},purposeConverter:function(e){return"".concat(e.purposeBrand," ").concat(e.purposeSeries," ").concat(e.purposeProduct)},stateConverter:function(e){for(var t=0;t<this.consumerStateList.length;t++)if(this.consumerStateList[t].value===e.consumerState)return this.consumerStateList[t].label;return""},salesConverter:function(e){return e.salesAdvisor&&e.salesAdvisor.name?e.salesAdvisor.name:"--"},createDateConverter:function(e){if(!e.entryDate)return"";var t=new Date(e.entryDate);return oe["a"].dateConverter(t)},backDateConverter:function(e){if(!e.nextVisitTime)return"--";var t=new Date(e.nextVisitTime);return oe["a"].dateConverter(t)},checkRole:function(e){if(!e)return!1;for(var t=0;t<e.length;t++)if(Number(e[t].type)===ie.salesmanAdmin)return!0;return!1},showMessage:function(e,t){this.$message({message:e,type:t,duration:1e3,showClose:!0})}}),pe={handleOperationSuccess:function(e){this.query(),e&&this.queryPotentialBaseInfo(e)},handleOperate:function(e){this[e]()},handlePageSizeChange:function(e){this.pagination.pageSize=e,this.pagination.currentPage=1,this.query()},handleCurrentPageChange:function(e){this.pagination.currentPage=e,this.query()},handleSelectionChange:function(e){this.selections=e},handleFilterDataChange:function(e){console.log(e),this.pagination.currentPage=1,this.query()},handleRowClick:function(e,t,a){this.defaultTab="0",this.queryPotentialBaseInfo(String(e.id)),this.$refs.RightPopup.$refs.base.getChannelList()},handleSortChange:function(e){console.log("column",e),this.sortInfo={column:e.prop,sort:e.order?"ascending"===e.order?"asc":"desc":void 0},this.query()},handleRouterPush:function(e,t){e.stopPropagation(),this.$router.push({name:this.$route.params.isSys?"tag-group-all-mgmt":"tag-group-mgmt",params:{isSys:"isSys",classId:t.id}})},handleDriveClick:function(e,t){e.stopPropagation(),this.driveItem(t.id)},handleSignClick:function(e,t){e.stopPropagation(),this.signItem(t.id)},handleFailClick:function(e,t){e.stopPropagation(),this.failItem(t.id)},handleAbandonClick:function(e,t){e.stopPropagation(),this.abandonItem([t.id])},handleDeleteClick:function(e,t){e.stopPropagation(),this.deleteItem([t.id])}},he={data:{importResult:[],importLoading:!1,disabled:!1,total:0,count:0,t:"",percentage:0,stepkey:""},methods:{isShow:function(){this.showRecommend?(this.filters[0].class="hidden",this.filters[1].class="hidden",this.filters[2].class="hidden",this.filters[3].class="hidden"):(this.filters[0].class="show",this.filters[1].class="show",this.filters[2].class="show",this.filters[3].class="show"),this.showRecommend=!this.showRecommend},cascaderChange:function(e){this.carType=e,this.query()},activeItemChange:function(e){this.getSeriesList(e[0])},getBrandList:function(){var e=this;v["a"].get(b["u"].failure.queryBrandList,{category:"car"}).then((function(t){var a;e.filters[0].options=[],a={},a.label="全部",a.value="",e.filters[0].options.push(a),t.dataList.forEach((function(t){a={},a.label=t.name,a.value=t.id,a.children=[],e.filters[0].options.push(a)}))})).catch((function(e){console.log(e.errorMessage)}))},getSeriesList:function(e){var t,a=this;v["a"].get(b["u"].failure.querySeriesList,{brandId:e}).then((function(o){a.filters[0].options.forEach((function(a){if(a.value===e)return a.children=[],o.dataList.forEach((function(e){t={},t.label=e.name,t.value=e.id,a.children.push(t)})),!1}))})).catch((function(e){console.log(e)}))}},events:{download:function(){window.open("/upload/mode/V%E6%9C%8D%E7%88%B1%E8%BD%A6_%E6%BD%9C%E5%AE%A2%E5%AF%BC%E5%85%A5%E6%A8%A1%E6%9D%BF.xlsx")},clearTimeOut:function(){window.clearTimeout(this.t)},restProcess:function(){this.total=0,this.count=0,this.stepkey="",this.percentage=0},handleImport:function(){var e=this,t="/admin/customer/importProgress.jhtml";v["a"].get(t,{}).then((function(t){t.data.total||(e.total=0,e.count=0,e.stepkey="",e.percentage=0),t.data.total&&(e.total=Number(t.data.total||0),e.count=Number(t.data.count||0),e.stepkey=t.data.remark,e.percentage=Number(t.data.rate),e.$refs.importFile.title=t.data.title),t.data&&t.data.rate&&"100"===t.data.rate?(e.refresh(),e.clearTimeOut(),e.$refs.importFile.showCurrentInfo=!1,e.$refs.importFile.title="导入完成",e.disabled=!1,t.data&&t.data.results&&t.data.results.length>0&&(e.importResult=t.data.results,e.$refs.importFile.uploadingVisible=!1,e.$refs.importFile.importingVisible=!0)):t.data&&t.data.rate&&"100"!==t.data.rate&&(e.t&&e.clearTimeOut(),e.t=setTimeout(e.handleImport,2e3),e.$refs.importFile.uploadingVisible=!0,e.$refs.importFile.showCurrentInfo=!0,e.disabled=!0)})).catch((function(e){console.log(e),console.log("code错误")}))}}},ge={data:{openCallback:!1,callbackId:{id:""}},events:{handleCallbackOperationSuccess:function(e){this.openCallback=!1}},methods:{callbackSetting:function(e){this.callbackId={id:""},this.openCallback=!0}}},be={name:"PotentialCustomerMgmt",components:{BizFlexTable:s["c"],ImportFile:l["b"],RightPopup:c["a"],CallbackSettingPopup:G,BizPopupTabs:m["a"],TestDriveAgreement:ae},props:{},data:function(){return Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({tableId:"7"},ue),me),he.data),ge.data)},computed:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(re["c"])("Sales",["potentialInfo","consumerInfo"])),Object(re["c"])("Authority",["currentAuth"])),{},{hasAuthImport:function(){return this.currentAuth.includes("admin:potential.import")},hasAuthDistribute:function(){return this.currentAuth.includes("admin:potential.distribution")},hasAuthSet:function(){return this.currentAuth.includes("admin:potential.set")},toggleRecommendTxt:function(){var e=this.showRecommend;return e?"收起":"筛选"}}),mixins:[se["a"]],methods:Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({getWidth:function(e){switch(e.id){case"1":return"130";case"2":return"180";case"4":return"100";default:return""}},getSortable:function(e){switch(e.id){case"6":return"custom";case"7":return"custom";default:return!1}},getProp:function(e){switch(e.id){case"6":return"entryDate";case"7":return"nextVisitTime";default:return""}}},Object(re["c"])(["getUser"])),fe),pe),he.methods),he.events),ge.methods),ge.events),created:function(){this.$store.registerModule("potentialCustomer",{state:{consumerState:"0"},mutations:{changeConsumerState:function(e,t){e.consumerState=t.value}}}),this.channelListData(),this.queryPotentialInfo(""),this.query(),this.querySalesList(),this.getBrandList(),this.queryKpi()},mounted:function(){this.isAdmin=this.checkRole(this.getUser().roleDatas);var e=!1;this.isAdmin?(this.operations.map((function(t){if("潜客设置"===t.label)return e=!1,!1;e=!0})),e&&(this.hasAuthDistribute&&this.operations.push({label:"分配",name:"distribute",type:""}),this.hasAuthSet&&this.operations.push({label:"潜客设置",name:"callbackSetting",type:""}))):this.isAdmin||e||this.operations.splice(this.operations.length-2,2)},destroyed:function(){this.$store.unregisterModule("potentialCustomer")}},ve=be,ye=(a("8dd6"),Object(I["a"])(ve,o,n,!1,null,null,null));t["default"]=ye.exports},ccf0:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-import-file"},[a("el-upload",{attrs:{"show-file-list":!1,"on-success":e.handleSuccess,"on-error":e.handleError,"on-progress":e.handleProgress,"before-upload":e.handleBeforeUpload,data:e.data,name:e.name,action:e.action,accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}},[e.disabled?a("el-button",{attrs:{size:"mini",type:"",loading:e.loading},on:{click:function(t){return t.stopPropagation(),e.handleImport(t)}}},[e.$slots.content||e.content?a("div",{staticClass:"biz-card__header"},[e._t("content",[e._v(e._s(e.content))])],2):e._e()]):e._e(),e.disabled?e._e():a("el-button",{attrs:{size:"mini",type:"",loading:e.loading}},[e.$slots.content||e.content?a("div",{staticClass:"biz-card__header"},[e._t("content",[e._v(e._s(e.content))])],2):e._e()])],1),a("el-dialog",{staticClass:"biz-import-file__uploading-dialog",attrs:{title:e.title,visible:e.uploadingVisible,"append-to-body":""},on:{"update:visible":function(t){e.uploadingVisible=t},close:e.clearTimeOut}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showInfo,expression:"showInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("成功导入："+e._s(e.count)+"条")]),a("span",{staticClass:"error"},[e._v("共计："+e._s(e.total)+"条")])]),a("el-progress",{staticClass:"biz-import-file__uploading-dialog__progress",attrs:{"stroke-width":12,percentage:e.percentage}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showCurrentInfo,expression:"showCurrentInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("正在导入："+e._s(e.stepkey))])])],1),a("el-dialog",{staticClass:"biz-import-file__importing-dialog",attrs:{title:"导入结果",visible:e.importingVisible,"append-to-body":""},on:{"update:visible":function(t){e.importingVisible=t}}},[a("div",{staticClass:"importing-dialog__content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.importLoading,expression:"importLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{size:"small",stripe:"",border:"",height:400,data:e.tableData,"tooltip-effect":"dark","element-loading-text":"导入中，请稍后"}},[e._t("default")],2)],1)])],1)},n=[],r=(a("c975"),a("baa5"),a("b0c0"),a("a9e3"),{name:"ImportFile",props:{showInfo:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}},showProcess:{type:Boolean,default:function(){return!1}},content:{type:String,default:function(){return"导入"}},data:{type:Object,default:function(){return{type:"3"}}},name:{type:String,default:function(){return"file"}},action:{type:String,default:function(){return"/admin/file/uploads.jhtml"}},tableData:{type:Array,required:!0},total:{type:Number,default:function(){return 0}},count:{type:Number,default:function(){return 0}},percentage:{type:Number,default:function(){return 0}},stepkey:{type:String,default:function(){return""}},importLoading:{type:Boolean,default:function(){return!1}}},data:function(){return{loading:!1,t:"",title:"导入中",showCurrentInfo:!0,uploadingVisible:!1,importingVisible:!1}},methods:{handleBeforeUpload:function(e){if(this.clearTimeOut(),-1===e.name.indexOf("."))return this.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)"),!1;var t=e.name.lastIndexOf("."),a=e.name.substring(t+1);if(!/(?:xls|xlsx)$/i.test(a))return this.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)"),!1;this.textEl&&(this.textEl.style.left=0)},handleProgress:function(e,t,a){console.log("导入中"),this.uploadingVisible=!0,this.$emit("restProcess");var o=this;setTimeout((function(){o.handleImport()}),2e3)},handleSuccess:function(e,t,a){var o=this;console.log("导入完成"),"100"===e.resultCode?setTimeout((function(){if(e.fis){var t=e.fis[0].url;t?o.doImport(t,e):o.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)")}}),600):(console.log("失败1"),this.$message.warning("发生错误"),this.uploadingVisible=!1)},handleError:function(e,t,a){console.log("失败"),e?this.$message.warning(e):(this.uploadingVisible=!1,this.$message.warning("发生错误"))},clearTimeOut:function(){this.$emit("clearTimeOut")},handleImport:function(e){this.uploadingVisible=!0,this.$emit("handle-import",e)},doImport:function(e,t){var a=this;setTimeout((function(){a.importingVisible=!0}),0),this.$emit("on-import",e,t)}}}),i=r,s=(a("0413"),a("2877")),l=Object(s["a"])(i,o,n,!1,null,null,null),c=l.exports,d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-import-file"},[a("el-dialog",{staticClass:"biz-import-file__uploading-dialog",attrs:{title:e.title,visible:e.uploadingVisible,"append-to-body":""},on:{"update:visible":function(t){e.uploadingVisible=t},close:e.clearTimeOut}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showInfo,expression:"showInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("成功导出："+e._s(e.count)+"条")]),a("span",{staticClass:"error"},[e._v("共计："+e._s(e.total)+"条")])]),a("el-progress",{staticClass:"biz-import-file__uploading-dialog__progress",attrs:{"stroke-width":12,percentage:e.percentage}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showCurrentInfo,expression:"showCurrentInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("正在导出："+e._s(e.stepkey))])])],1)],1)},u=[],m={name:"ImportFile",props:{showInfo:{type:Boolean,default:function(){return!0}},total:{type:Number,default:function(){return 0}},count:{type:Number,default:function(){return 0}},percentage:{type:Number,default:function(){return 0}},stepkey:{type:String,default:function(){return""}}},data:function(){return{loading:!1,t:"",title:"导出中",showCurrentInfo:!0,uploadingVisible:!1}},methods:{clearTimeOut:function(){this.$emit("clearTimeOut")}}},f=m,p=(a("e7d9"),Object(s["a"])(f,d,u,!1,null,null,null)),h=p.exports;a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return h}))},d48f:function(e,t,a){},d4c2:function(e,t,a){"use strict";var o=a("e725"),n=a.n(o);n.a},d6e3:function(e,t,a){},e42c:function(e,t,a){"use strict";var o=a("2497"),n=a("bc3a"),r=a.n(n),i=a("c596");t["a"]={listOrder:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.list,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},viewOrder:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.order:i["g"].orderMgmt.orderMgmt.order,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},updateOrder:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.order:i["g"].orderMgmt.orderMgmt.order,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},createOrder:function(e,t,a){r.a.post("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.order:i["g"].orderMgmt.orderMgmt.order,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},excuteOrder:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.service:i["g"].orderMgmt.orderMgmt.service,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},closeOrder:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.close:i["g"].orderMgmt.orderMgmt.close,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},confirmOrder:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.confirm:i["g"].orderMgmt.orderMgmt.confirm,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},paymentOrder:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.payment:i["g"].orderMgmt.orderMgmt.payment,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},shippingOrder:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.shipping:i["g"].orderMgmt.orderMgmt.shipping,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},repairMaintainHistory:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.repairMaintainHistory,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},listAdminByRole:function(e,t,a){r.a.post(i["g"].orderMgmt.orderMgmt.listAdminByRole,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},listExistCardTemplate:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.listExistCardTemplate,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},viewProducts:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.viewProducts:i["g"].orderMgmt.orderMgmt.viewProducts,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},viewOrderlogs:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.viewOrderlogs:i["g"].orderMgmt.orderMgmt.viewOrderlogs,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},viewOrderRefunds:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.viewOrderRefunds:i["g"].orderMgmt.orderMgmt.viewOrderRefunds,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryInvoiceDetailByOrderID:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.queryInvoiceDetailByOrderID:i["g"].orderMgmt.orderMgmt.queryInvoiceDetailByOrderID,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},invoiceMail:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.invoiceMail:i["g"].orderMgmt.orderMgmt.invoiceMail,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},invoiceMailUpdate:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.invoiceMail:i["g"].orderMgmt.orderMgmt.invoiceMail,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},invoiceInfoDefault:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.invoiceInfoDefault:i["g"].orderMgmt.orderMgmt.invoiceInfoDefault,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},invoiceByOrder:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.invoiceByOrder:i["g"].orderMgmt.orderMgmt.invoiceByOrder,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},invoiceDetailCreate:function(e,t,a){r.a.post("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.invoice:i["g"].orderMgmt.orderMgmt.invoice,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},invoiceDetailUpdate:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.invoice:i["g"].orderMgmt.orderMgmt.invoice,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},invoiceDetail:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.invoiceDetail:i["g"].orderMgmt.orderMgmt.invoiceDetail,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},addOrderItems:function(e,t,a){r.a.post("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.addOrderItems:i["g"].orderMgmt.orderMgmt.addOrderItems,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},brands:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.brands,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},series:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.series,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},types:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.types,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},getFinancialPlans:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.getFinancialPlans,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},memberList:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.memberList,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},options:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.options,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},rescuers:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.rescuers,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},export:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.export,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},rescueOrderLogs:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.rescueOrderLogs,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},loanTerms:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.loanTerms,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryOrderKpi:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.queryOrderKpi,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},refundsAudit:function(e,t,a){r.a.put("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.refundsAudit:i["g"].orderMgmt.orderMgmt.refundsAudit,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},rescuerSetting:function(e,t,a){r.a.put(i["g"].orderMgmt.orderMgmt.rescuerSetting,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},rescuerDispath:function(e,t,a){r.a.put(i["g"].orderMgmt.orderMgmt.rescuerDispath,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},carOptions:function(e,t,a){r.a.put(i["g"].orderMgmt.orderMgmt.carOptions,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},createMember:function(e,t,a){r.a.post(i["g"].orderMgmt.orderMgmt.createMember,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},certificate:function(e,t,a){r.a.get("purchaseOrder"===window.top.dType?i["g"].orderMgmt.purchaseOrderMgmt.certificate:i["g"].orderMgmt.orderMgmt.certificate,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},listProductByTestDrive:function(e,t,a){r.a.get(i["g"].orderMgmt.orderMgmt.listProductByTestDrive,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))}}},e58c:function(e,t,a){"use strict";var o=a("fc6a"),n=a("a691"),r=a("50c4"),i=a("a640"),s=a("ae40"),l=Math.min,c=[].lastIndexOf,d=!!c&&1/[1].lastIndexOf(1,-0)<0,u=i("lastIndexOf"),m=s("indexOf",{ACCESSORS:!0,1:0}),f=d||!u||!m;e.exports=f?function(e){if(d)return c.apply(this,arguments)||0;var t=o(this),a=r(t.length),i=a-1;for(arguments.length>1&&(i=l(i,n(arguments[1]))),i<0&&(i=a+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}:c},e663:function(e,t,a){"use strict";var o=a("64ec"),n=a.n(o);n.a},e725:function(e,t,a){},e7d9:function(e,t,a){"use strict";var o=a("9b77"),n=a.n(o);n.a},ec6b:function(e,t,a){"use strict";var o=a("b547"),n=a.n(o);n.a},ef0b:function(e,t,a){"use strict";var o=a("912a"),n=a.n(o);n.a},ef19:function(e,t,a){},f8da:function(e,t,a){"use strict";var o=a("d6e3"),n=a.n(o);n.a}}]);