(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22ba3dd0","chunk-4bb544e8","chunk-22dd6a1d"],{"016c":function(t,e,i){var r=function(){var t=new Date,e=4,i=3,n=2,a=1,s=e,o={setLogLevel:function(t){s=t==this.debug?a:t==this.info?n:t==this.warn?i:(this.error,e)},debug:function(e,i){a>=s&&console.debug("["+r.getDurationString(new Date-t,1e3)+"]","["+e+"]",i)},info:function(e,i){n>=s&&console.info("["+r.getDurationString(new Date-t,1e3)+"]","["+e+"]",i)},warn:function(e,n){i>=s&&console.warn("["+r.getDurationString(new Date-t,1e3)+"]","["+e+"]",n)},error:function(i,n){e>=s&&console.error("["+r.getDurationString(new Date-t,1e3)+"]","["+i+"]",n)}};return o}();r.getDurationString=function(t,e){function i(t,e){var i=""+t,r=i.split(".");while(r[0].length<e)r[0]="0"+r[0];return r.join(".")}var r=e||1,n=t/r,a=Math.floor(n/3600);n-=3600*a;var s=Math.floor(n/60);n-=60*s;var o=1e3*n;return n=Math.floor(n),o-=1e3*n,o=Math.floor(o),a+":"+i(s,2)+":"+i(n,2)+"."+i(o,3)},r.printRanges=function(t){var e=t.length;if(e>0){for(var i="",n=0;n<e;n++)n>0&&(i+=","),i+="["+r.getDurationString(t.start(n))+","+r.getDurationString(t.end(n))+"]";return i}return"(empty)"};var n=function(t){if(!(t instanceof ArrayBuffer))throw"Needs an array buffer";this.buffer=t,this.uint8=new Uint8Array(t),this.position=0};n.prototype.getPosition=function(){return this.position},n.prototype.getEndPosition=function(){return this.buffer.byteLength},n.prototype.getLength=function(){return this.buffer.byteLength},n.prototype.seek=function(t){var e=Math.max(0,Math.min(this.uint8.length,t));this.position=isNaN(e)||!isFinite(e)?0:e},n.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},n.prototype.readUint8=function(){var t;if(this.position+1<=this.uint8.length)return t=this.uint8[this.position],this.position++,t;throw"Not enough bytes in buffer"},n.prototype.readUint16=function(){var t,e,i;if(this.position+2<=this.uint8.length)return t=this.uint8[this.position],this.position++,e=this.uint8[this.position],this.position++,i=t<<8|e,i;throw"Not enough bytes in buffer"},n.prototype.readUint24=function(){var t;if(this.position+3<=this.uint8.length)return t=this.uint8[this.position]<<16,this.position++,t|=this.uint8[this.position]<<8,this.position++,t|=this.uint8[this.position],this.position++,t;throw"Not enough bytes in buffer"},n.prototype.readUint32=function(){var t;if(this.position+4<=this.uint8.length)return t=this.uint8[this.position]<<24,this.position++,t|=this.uint8[this.position]<<16,this.position++,t|=this.uint8[this.position]<<8,this.position++,t|=this.uint8[this.position],this.position++,t;throw"Not enough bytes in buffer"},n.prototype.readUint64=function(){var t;if(this.position+8<=this.uint8.length)return t=this.readUint32()<<32,t|=this.readUint32(),t;throw"Not enough bytes in buffer"},n.prototype.readString=function(t){if(this.position+t<=this.uint8.length){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(this.readUint8());return e}throw"Not enough bytes in buffer"},n.prototype.readCString=function(){var t=[];while(1){var e=this.readUint8();if(0===e)break;t.push(e)}return String.fromCharCode.apply(null,t)},n.prototype.readInt8=function(){return this.readUint8()},n.prototype.readInt16=function(){return this.readUint16()},n.prototype.readInt32=function(){return this.readUint32()},n.prototype.readUint8Array=function(t){for(var e=[],i=0;i<t;i++)e[i]=this.readUint8();return e},n.prototype.readInt16Array=function(t){for(var e=[],i=0;i<t;i++)e[i]=this.readUint16();return e},n.prototype.readUint32Array=function(t){for(var e=[],i=0;i<t;i++)e[i]=this.readUint32();return e},n.prototype.readInt32Array=function(t){for(var e=[],i=0;i<t;i++)e[i]=this.readInt32();return e};var a=function(t,e,i){this._byteOffset=e||0,t instanceof ArrayBuffer?this.buffer=t:"object"==typeof t?(this.dataView=t,e&&(this._byteOffset+=e)):this.buffer=new ArrayBuffer(t||0),this.position=0,this.endianness=null==i?a.LITTLE_ENDIAN:i};a.prototype={},a.prototype.getPosition=function(){return this.position},a.prototype._realloc=function(t){if(this._dynamicSize){var e=this._byteOffset+this.position+t,i=this._buffer.byteLength;if(e<=i)e>this._byteLength&&(this._byteLength=e);else{i<1&&(i=1);while(e>i)i*=2;var r=new ArrayBuffer(i),n=new Uint8Array(this._buffer),a=new Uint8Array(r,0,n.length);a.set(n),this.buffer=r,this._byteLength=e}}},a.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var t=new ArrayBuffer(this._byteLength),e=new Uint8Array(t),i=new Uint8Array(this._buffer,0,e.length);e.set(i),this.buffer=t}},a.BIG_ENDIAN=!1,a.LITTLE_ENDIAN=!0,a.prototype._byteLength=0,Object.defineProperty(a.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(a.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(t){this._buffer=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(a.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(t){this._byteOffset=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(a.prototype,"dataView",{get:function(){return this._dataView},set:function(t){this._byteOffset=t.byteOffset,this._buffer=t.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+t.byteLength}}),a.prototype.seek=function(t){var e=Math.max(0,Math.min(this.byteLength,t));this.position=isNaN(e)||!isFinite(e)?0:e},a.prototype.isEof=function(){return this.position>=this._byteLength},a.prototype.mapUint8Array=function(t){this._realloc(1*t);var e=new Uint8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=1*t,e},a.prototype.readInt32Array=function(t,e){t=null==t?this.byteLength-this.position/4:t;var i=new Int32Array(t);return a.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),a.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},a.prototype.readInt16Array=function(t,e){t=null==t?this.byteLength-this.position/2:t;var i=new Int16Array(t);return a.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),a.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},a.prototype.readInt8Array=function(t){t=null==t?this.byteLength-this.position:t;var e=new Int8Array(t);return a.memcpy(e.buffer,0,this.buffer,this.byteOffset+this.position,t*e.BYTES_PER_ELEMENT),this.position+=e.byteLength,e},a.prototype.readUint32Array=function(t,e){t=null==t?this.byteLength-this.position/4:t;var i=new Uint32Array(t);return a.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),a.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},a.prototype.readUint16Array=function(t,e){t=null==t?this.byteLength-this.position/2:t;var i=new Uint16Array(t);return a.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),a.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},a.prototype.readUint8Array=function(t){t=null==t?this.byteLength-this.position:t;var e=new Uint8Array(t);return a.memcpy(e.buffer,0,this.buffer,this.byteOffset+this.position,t*e.BYTES_PER_ELEMENT),this.position+=e.byteLength,e},a.prototype.readFloat64Array=function(t,e){t=null==t?this.byteLength-this.position/8:t;var i=new Float64Array(t);return a.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),a.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},a.prototype.readFloat32Array=function(t,e){t=null==t?this.byteLength-this.position/4:t;var i=new Float32Array(t);return a.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),a.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},a.prototype.readInt32=function(t){var e=this._dataView.getInt32(this.position,null==t?this.endianness:t);return this.position+=4,e},a.prototype.readInt16=function(t){var e=this._dataView.getInt16(this.position,null==t?this.endianness:t);return this.position+=2,e},a.prototype.readInt8=function(){var t=this._dataView.getInt8(this.position);return this.position+=1,t},a.prototype.readUint32=function(t){var e=this._dataView.getUint32(this.position,null==t?this.endianness:t);return this.position+=4,e},a.prototype.readUint16=function(t){var e=this._dataView.getUint16(this.position,null==t?this.endianness:t);return this.position+=2,e},a.prototype.readUint8=function(){var t=this._dataView.getUint8(this.position);return this.position+=1,t},a.prototype.readFloat32=function(t){var e=this._dataView.getFloat32(this.position,null==t?this.endianness:t);return this.position+=4,e},a.prototype.readFloat64=function(t){var e=this._dataView.getFloat64(this.position,null==t?this.endianness:t);return this.position+=8,e},a.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,a.memcpy=function(t,e,i,r,n){var a=new Uint8Array(t,e,n),s=new Uint8Array(i,r,n);a.set(s)},a.arrayToNative=function(t,e){return e==this.endianness?t:this.flipArrayEndianness(t)},a.nativeToEndian=function(t,e){return this.endianness==e?t:this.flipArrayEndianness(t)},a.flipArrayEndianness=function(t){for(var e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=0;i<t.byteLength;i+=t.BYTES_PER_ELEMENT)for(var r=i+t.BYTES_PER_ELEMENT-1,n=i;r>n;r--,n++){var a=e[n];e[n]=e[r],e[r]=a}return t},a.prototype.failurePosition=0,String.fromCharCodeUint8=function(t){for(var e=[],i=0;i<t.length;i++)e[i]=t[i];return String.fromCharCode.apply(null,e)},a.prototype.readString=function(t,e){return null==e||"ASCII"==e?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(null==t?this.byteLength-this.position:t)]):new TextDecoder(e).decode(this.mapUint8Array(t))},a.prototype.readCString=function(t){var e=this.byteLength-this.position,i=new Uint8Array(this._buffer,this._byteOffset+this.position),r=e;null!=t&&(r=Math.min(t,e));for(var n=0;n<r&&0!==i[n];n++);var a=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(n)]);return null!=t?this.position+=r-n:n!=e&&(this.position+=1),a};var s=Math.pow(2,32);a.prototype.readUint64=function(){return this.readUint32()*s+this.readUint32()},a.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},e.DataStream=a,a.prototype.save=function(t){var e=new Blob([this.buffer]),i=window.webkitURL||window.URL;if(!i||!i.createObjectURL)throw"DataStream.save: Can't create object URL.";var r=i.createObjectURL(e),n=document.createElement("a");n.setAttribute("href",r),n.setAttribute("download",t),n.click(),i.revokeObjectURL(r)},a.prototype._dynamicSize=!0,Object.defineProperty(a.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(t){t||this._trimAlloc(),this._dynamicSize=t}}),a.prototype.shift=function(t){var e=new ArrayBuffer(this._byteLength-t),i=new Uint8Array(e),r=new Uint8Array(this._buffer,t,i.length);i.set(r),this.buffer=e,this.position-=t},a.prototype.writeInt32Array=function(t,e){if(this._realloc(4*t.length),t instanceof Int32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)a.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt32Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeInt32(t[i],e)},a.prototype.writeInt16Array=function(t,e){if(this._realloc(2*t.length),t instanceof Int16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)a.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt16Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeInt16(t[i],e)},a.prototype.writeInt8Array=function(t){if(this._realloc(1*t.length),t instanceof Int8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)a.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt8Array(t.length);else for(var e=0;e<t.length;e++)this.writeInt8(t[e])},a.prototype.writeUint32Array=function(t,e){if(this._realloc(4*t.length),t instanceof Uint32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)a.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint32Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeUint32(t[i],e)},a.prototype.writeUint16Array=function(t,e){if(this._realloc(2*t.length),t instanceof Uint16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)a.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint16Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeUint16(t[i],e)},a.prototype.writeUint8Array=function(t){if(this._realloc(1*t.length),t instanceof Uint8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)a.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint8Array(t.length);else for(var e=0;e<t.length;e++)this.writeUint8(t[e])},a.prototype.writeFloat64Array=function(t,e){if(this._realloc(8*t.length),t instanceof Float64Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)a.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat64Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeFloat64(t[i],e)},a.prototype.writeFloat32Array=function(t,e){if(this._realloc(4*t.length),t instanceof Float32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)a.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat32Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeFloat32(t[i],e)},a.prototype.writeInt32=function(t,e){this._realloc(4),this._dataView.setInt32(this.position,t,null==e?this.endianness:e),this.position+=4},a.prototype.writeInt16=function(t,e){this._realloc(2),this._dataView.setInt16(this.position,t,null==e?this.endianness:e),this.position+=2},a.prototype.writeInt8=function(t){this._realloc(1),this._dataView.setInt8(this.position,t),this.position+=1},a.prototype.writeUint32=function(t,e){this._realloc(4),this._dataView.setUint32(this.position,t,null==e?this.endianness:e),this.position+=4},a.prototype.writeUint16=function(t,e){this._realloc(2),this._dataView.setUint16(this.position,t,null==e?this.endianness:e),this.position+=2},a.prototype.writeUint8=function(t){this._realloc(1),this._dataView.setUint8(this.position,t),this.position+=1},a.prototype.writeFloat32=function(t,e){this._realloc(4),this._dataView.setFloat32(this.position,t,null==e?this.endianness:e),this.position+=4},a.prototype.writeFloat64=function(t,e){this._realloc(8),this._dataView.setFloat64(this.position,t,null==e?this.endianness:e),this.position+=8},a.prototype.writeUCS2String=function(t,e,i){null==i&&(i=t.length);for(var r=0;r<t.length&&r<i;r++)this.writeUint16(t.charCodeAt(r),e);for(;r<i;r++)this.writeUint16(0)},a.prototype.writeString=function(t,e,i){var r=0;if(null==e||"ASCII"==e)if(null!=i){var n=Math.min(t.length,i);for(r=0;r<n;r++)this.writeUint8(t.charCodeAt(r));for(;r<i;r++)this.writeUint8(0)}else for(r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));else this.writeUint8Array(new TextEncoder(e).encode(t.substring(0,i)))},a.prototype.writeCString=function(t,e){var i=0;if(null!=e){var r=Math.min(t.length,e);for(i=0;i<r;i++)this.writeUint8(t.charCodeAt(i));for(;i<e;i++)this.writeUint8(0)}else{for(i=0;i<t.length;i++)this.writeUint8(t.charCodeAt(i));this.writeUint8(0)}},a.prototype.writeStruct=function(t,e){for(var i=0;i<t.length;i+=2){var r=t[i+1];this.writeType(r,e[t[i]],e)}},a.prototype.writeType=function(t,e,i){var r;if("function"==typeof t)return t(this,e);if("object"==typeof t&&!(t instanceof Array))return t.set(this,e,i);var n=null,s="ASCII",o=this.position;switch("string"==typeof t&&/:/.test(t)&&(r=t.split(":"),t=r[0],n=parseInt(r[1])),"string"==typeof t&&/,/.test(t)&&(r=t.split(","),t=r[0],s=parseInt(r[1])),t){case"uint8":this.writeUint8(e);break;case"int8":this.writeInt8(e);break;case"uint16":this.writeUint16(e,this.endianness);break;case"int16":this.writeInt16(e,this.endianness);break;case"uint32":this.writeUint32(e,this.endianness);break;case"int32":this.writeInt32(e,this.endianness);break;case"float32":this.writeFloat32(e,this.endianness);break;case"float64":this.writeFloat64(e,this.endianness);break;case"uint16be":this.writeUint16(e,a.BIG_ENDIAN);break;case"int16be":this.writeInt16(e,a.BIG_ENDIAN);break;case"uint32be":this.writeUint32(e,a.BIG_ENDIAN);break;case"int32be":this.writeInt32(e,a.BIG_ENDIAN);break;case"float32be":this.writeFloat32(e,a.BIG_ENDIAN);break;case"float64be":this.writeFloat64(e,a.BIG_ENDIAN);break;case"uint16le":this.writeUint16(e,a.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(e,a.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(e,a.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(e,a.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(e,a.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(e,a.LITTLE_ENDIAN);break;case"cstring":this.writeCString(e,n);break;case"string":this.writeString(e,s,n);break;case"u16string":this.writeUCS2String(e,this.endianness,n);break;case"u16stringle":this.writeUCS2String(e,a.LITTLE_ENDIAN,n);break;case"u16stringbe":this.writeUCS2String(e,a.BIG_ENDIAN,n);break;default:if(3==t.length){for(var l=t[1],d=0;d<e.length;d++)this.writeType(l,e[d]);break}this.writeStruct(t,e);break}null!=n&&(this.position=o,this._realloc(n),this.position=o+n)},a.prototype.writeUint64=function(t){var e=Math.floor(t/s);this.writeUint32(e),this.writeUint32(4294967295&t)},a.prototype.writeUint24=function(t){this.writeUint8((16711680&t)>>16),this.writeUint8((65280&t)>>8),this.writeUint8(255&t)},a.prototype.adjustUint32=function(t,e){var i=this.position;this.seek(t),this.writeUint32(e),this.seek(i)},a.prototype.mapInt32Array=function(t,e){this._realloc(4*t);var i=new Int32Array(this._buffer,this.byteOffset+this.position,t);return a.arrayToNative(i,null==e?this.endianness:e),this.position+=4*t,i},a.prototype.mapInt16Array=function(t,e){this._realloc(2*t);var i=new Int16Array(this._buffer,this.byteOffset+this.position,t);return a.arrayToNative(i,null==e?this.endianness:e),this.position+=2*t,i},a.prototype.mapInt8Array=function(t){this._realloc(1*t);var e=new Int8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=1*t,e},a.prototype.mapUint32Array=function(t,e){this._realloc(4*t);var i=new Uint32Array(this._buffer,this.byteOffset+this.position,t);return a.arrayToNative(i,null==e?this.endianness:e),this.position+=4*t,i},a.prototype.mapUint16Array=function(t,e){this._realloc(2*t);var i=new Uint16Array(this._buffer,this.byteOffset+this.position,t);return a.arrayToNative(i,null==e?this.endianness:e),this.position+=2*t,i},a.prototype.mapFloat64Array=function(t,e){this._realloc(8*t);var i=new Float64Array(this._buffer,this.byteOffset+this.position,t);return a.arrayToNative(i,null==e?this.endianness:e),this.position+=8*t,i},a.prototype.mapFloat32Array=function(t,e){this._realloc(4*t);var i=new Float32Array(this._buffer,this.byteOffset+this.position,t);return a.arrayToNative(i,null==e?this.endianness:e),this.position+=4*t,i};var o=function(){this.buffers=[],this.bufferIndex=-1};o.prototype=new a(new ArrayBuffer,0,a.BIG_ENDIAN),o.prototype.initialized=function(){var t;return this.bufferIndex>-1||(this.buffers.length>0?(t=this.buffers[0],0===t.fileStart?(this.buffer=t,this.bufferIndex=0,r.debug("MultiBufferStream","Stream ready for parsing"),!0):(r.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1)):(r.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1))},ArrayBuffer.concat=function(t,e){r.debug("ArrayBuffer","Trying to create a new buffer of size: "+(t.byteLength+e.byteLength));var i=new Uint8Array(t.byteLength+e.byteLength);return i.set(new Uint8Array(t),0),i.set(new Uint8Array(e),t.byteLength),i.buffer},o.prototype.reduceBuffer=function(t,e,i){var r;return r=new Uint8Array(i),r.set(new Uint8Array(t,e,i)),r.buffer.fileStart=t.fileStart+e,r.buffer.usedBytes=0,r.buffer},o.prototype.insertBuffer=function(t){for(var e=!0,i=0;i<this.buffers.length;i++){var n=this.buffers[i];if(t.fileStart<=n.fileStart){if(t.fileStart===n.fileStart){if(t.byteLength>n.byteLength){this.buffers.splice(i,1),i--;continue}r.warn("MultiBufferStream","Buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+") already appended, ignoring")}else t.fileStart+t.byteLength<=n.fileStart||(t=this.reduceBuffer(t,0,n.fileStart-t.fileStart)),r.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.splice(i,0,t),0===i&&(this.buffer=t);e=!1;break}if(t.fileStart<n.fileStart+n.byteLength){var a=n.fileStart+n.byteLength-t.fileStart,s=t.byteLength-a;if(!(s>0)){e=!1;break}t=this.reduceBuffer(t,a,s)}}e&&(r.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.push(t),0===i&&(this.buffer=t))},o.prototype.logBufferLevel=function(t){var e,i,n,a,s,o=[],l="";for(n=0,a=0,e=0;e<this.buffers.length;e++)i=this.buffers[e],0===e?(s={},o.push(s),s.start=i.fileStart,s.end=i.fileStart+i.byteLength,l+="["+s.start+"-"):s.end===i.fileStart?s.end=i.fileStart+i.byteLength:(s={},s.start=i.fileStart,l+=o[o.length-1].end-1+"], ["+s.start+"-",s.end=i.fileStart+i.byteLength,o.push(s)),n+=i.usedBytes,a+=i.byteLength;o.length>0&&(l+=s.end-1+"]");var d=t?r.info:r.debug;0===this.buffers.length?d("MultiBufferStream","No more buffer in memory"):d("MultiBufferStream",this.buffers.length+" stored buffer(s) ("+n+"/"+a+" bytes): "+l)},o.prototype.cleanBuffers=function(){var t,e;for(t=0;t<this.buffers.length;t++)e=this.buffers[t],e.usedBytes===e.byteLength&&(r.debug("MultiBufferStream","Removing buffer #"+t),this.buffers.splice(t,1),t--)},o.prototype.mergeNextBuffer=function(){var t;if(this.bufferIndex+1<this.buffers.length){if(t=this.buffers[this.bufferIndex+1],t.fileStart===this.buffer.fileStart+this.buffer.byteLength){var e=this.buffer.byteLength,i=this.buffer.usedBytes,n=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,t),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=i,this.buffer.fileStart=n,r.debug("ISOFile","Concatenating buffer for box parsing (length: "+e+"->"+this.buffer.byteLength+")"),!0}return!1}return!1},o.prototype.findPosition=function(t,e,i){var n,a=null,s=-1;n=!0===t?0:this.bufferIndex;while(n<this.buffers.length){if(a=this.buffers[n],!(a.fileStart<=e))break;s=n,i&&(a.fileStart+a.byteLength<=e?a.usedBytes=a.byteLength:a.usedBytes=e-a.fileStart,this.logBufferLevel()),n++}return-1!==s?(a=this.buffers[s],a.fileStart+a.byteLength>=e?(r.debug("MultiBufferStream","Found position in existing buffer #"+s),s):-1):-1},o.prototype.findEndContiguousBuf=function(t){var e,i,r,n=void 0!==t?t:this.bufferIndex;if(i=this.buffers[n],this.buffers.length>n+1)for(e=n+1;e<this.buffers.length;e++){if(r=this.buffers[e],r.fileStart!==i.fileStart+i.byteLength)break;i=r}return i.fileStart+i.byteLength},o.prototype.getEndFilePositionAfter=function(t){var e=this.findPosition(!0,t,!1);return-1!==e?this.findEndContiguousBuf(e):t},o.prototype.addUsedBytes=function(t){this.buffer.usedBytes+=t,this.logBufferLevel()},o.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},o.prototype.seek=function(t,e,i){var n;return n=this.findPosition(e,t,i),-1!==n?(this.buffer=this.buffers[n],this.bufferIndex=n,this.position=t-this.buffer.fileStart,r.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(r.debug("MultiBufferStream","Position "+t+" not found in buffered data"),!1)},o.prototype.getPosition=function(){if(-1===this.bufferIndex||null===this.buffers[this.bufferIndex])throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},o.prototype.getLength=function(){return this.byteLength},o.prototype.getEndPosition=function(){if(-1===this.bufferIndex||null===this.buffers[this.bufferIndex])throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength};var l=function(){var t=3,e=4,i=5,n=6,a=[];a[t]="ES_Descriptor",a[e]="DecoderConfigDescriptor",a[i]="DecoderSpecificInfo",a[n]="SLConfigDescriptor";var s=this,o={};return this.parseOneDescriptor=function(t){var e,i,n,s=0;e=t.readUint8(),n=t.readUint8();while(128&n)s=(127&n)<<7,n=t.readUint8();return s+=127&n,r.debug("MPEG4DescriptorParser","Found "+(a[e]||"Descriptor "+e)+", size "+s+" at position "+t.getPosition()),i=a[e]?new o[a[e]](s):new o.Descriptor(s),i.parse(t),i},o.Descriptor=function(t,e){this.tag=t,this.size=e,this.descs=[]},o.Descriptor.prototype.parse=function(t){this.data=t.readUint8Array(this.size)},o.Descriptor.prototype.findDescriptor=function(t){for(var e=0;e<this.descs.length;e++)if(this.descs[e].tag==t)return this.descs[e];return null},o.Descriptor.prototype.parseRemainingDescriptors=function(t){var e=t.position;while(t.position<e+this.size){var i=s.parseOneDescriptor(t);this.descs.push(i)}},o.ES_Descriptor=function(e){o.Descriptor.call(this,t,e)},o.ES_Descriptor.prototype=new o.Descriptor,o.ES_Descriptor.prototype.parse=function(t){if(this.ES_ID=t.readUint16(),this.flags=t.readUint8(),this.size-=3,128&this.flags?(this.dependsOn_ES_ID=t.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,64&this.flags){var e=t.readUint8();this.URL=t.readString(e),this.size-=e+1}else this.URL=null;32&this.flags?(this.OCR_ES_ID=t.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(t)},o.ES_Descriptor.prototype.getOTI=function(t){var i=this.findDescriptor(e);return i?i.oti:0},o.ES_Descriptor.prototype.getAudioConfig=function(t){var r=this.findDescriptor(e);if(!r)return null;var n=r.findDescriptor(i);return n&&n.data?(248&n.data[0])>>3:null},o.DecoderConfigDescriptor=function(t){o.Descriptor.call(this,e,t)},o.DecoderConfigDescriptor.prototype=new o.Descriptor,o.DecoderConfigDescriptor.prototype.parse=function(t){this.oti=t.readUint8(),this.streamType=t.readUint8(),this.bufferSize=t.readUint24(),this.maxBitrate=t.readUint32(),this.avgBitrate=t.readUint32(),this.size-=13,this.parseRemainingDescriptors(t)},o.DecoderSpecificInfo=function(t){o.Descriptor.call(this,i,t)},o.DecoderSpecificInfo.prototype=new o.Descriptor,o.SLConfigDescriptor=function(t){o.Descriptor.call(this,n,t)},o.SLConfigDescriptor.prototype=new o.Descriptor,this},d={ERR_NOT_ENOUGH_DATA:0,OK:1,boxCodes:["mdat","idat","free","skip","avcC","hvcC","ftyp","styp","payl","vttC","rtp ","sdp ","btrt","frma","trpy","tpyl","totl","tpay","dmed","dimm","drep","nump","npck","maxr","tmin","tmax","dmax","pmax","payt","vmhd","smhd","hmhd","idat","meco","udta","strk","free","skip"],fullBoxCodes:["mvhd","tkhd","mdhd","hdlr","vmhd","smhd","hmhd","nmhd","url ","urn ","ctts","cslg","stco","co64","stsc","stss","stsz","stz2","stts","stsh","mehd","trex","mfhd","tfhd","trun","tfdt","esds","subs","txtC","sidx","emsg","prft","pssh","elst","dref","url ","urn ","sbgp","sgpd","cprt","iods","ssix","tfra","mfro","pdin","tsel","trep","leva","stri","stsg","schm","stvi","padb","stdp","sdtp","saio","saiz","meta","xml ","bxml","iloc","pitm","ipro","iinf","infe","iref","mere","kind","elng"],containerBoxCodes:[["moov",["trak","sidx"]],["trak"],["edts"],["mdia"],["minf"],["dinf"],["stbl",["sgpd"]],["mvex",["trex"]],["moof",["traf"]],["traf",["trun"]],["vttc"],["tref"],["iref"],["udta"],["mfra"],["meco"],["hnti"],["hinf"],["strk"],["strd"],["sinf"],["rinf"],["schi"],["trgr"],["udta",["kind"]],["iprp"]],sampleEntryCodes:[{prefix:"Visual",types:["mp4v","avc1","avc2","avc3","avc4","avcp","drac","encv","mjp2","mvc1","mvc2","resv","s263","svc1","vc-1","hvc1","hev1"]},{prefix:"Audio",types:["mp4a","ac-3","alac","dra1","dtsc","dtse",,"dtsh","dtsl","ec-3","enca","g719","g726","m4ae","mlpa","raw ","samr","sawb","sawp","sevc","sqcp","ssmv","twos",".mp3"]},{prefix:"Hint",types:["fdp ","m2ts","pm2t","prtp","rm2t","rrtp","rsrp","rtp ","sm2t","srtp"]},{prefix:"Metadata",types:["metx","mett","urim"]},{prefix:"Subtitle",types:["stpp","wvtt","sbtt","tx3g","stxt"]},{prefix:"System",types:["mp4s"]}],sampleGroupEntryCodes:["roll","prol","alst","rap ","tele","avss","avll","sync","tscl","tsas","stsa","scif","mvif","scnm","dtrt","vipr","tele","rash"],trackGroupTypes:["msrc"],initialize:function(){var t,e,i;for(d.FullBox.prototype=new d.Box,d.ContainerBox.prototype=new d.Box,d.SampleEntry.prototype=new d.FullBox,d.TrackGroupTypeBox.prototype=new d.FullBox,i=d.boxCodes.length,t=0;t<i;t++)d[d.boxCodes[t]+"Box"]=function(t){return function(e){d.Box.call(this,d.boxCodes[t],e)}}(t),d[d.boxCodes[t]+"Box"].prototype=new d.Box;for(i=d.fullBoxCodes.length,t=0;t<i;t++)d[d.fullBoxCodes[t]+"Box"]=function(t){return function(e){d.FullBox.call(this,d.fullBoxCodes[t],e)}}(t),d[d.fullBoxCodes[t]+"Box"].prototype=new d.FullBox;for(i=d.containerBoxCodes.length,t=0;t<i;t++)d[d.containerBoxCodes[t][0]+"Box"]=function(t,e){return function(i){if(d.ContainerBox.call(this,d.containerBoxCodes[t][0],i),e){this.subBoxNames=e;for(var r=e.length,n=0;n<r;n++)this[e[n]+"s"]=[]}}}(t,d.containerBoxCodes[t][1]),d[d.containerBoxCodes[t][0]+"Box"].prototype=new d.ContainerBox;for(i=d.sampleEntryCodes.length,e=0;e<i;e++){var r=d.sampleEntryCodes[e].prefix,n=d.sampleEntryCodes[e].types,a=n.length;for(d[r+"SampleEntry"]=function(t,e){d.SampleEntry.call(this,t,e)},d[r+"SampleEntry"].prototype=new d.SampleEntry,t=0;t<a;t++)d[n[t]+"SampleEntry"]=function(t,e){return function(i){d[d.sampleEntryCodes[t].prefix+"SampleEntry"].call(this,d.sampleEntryCodes[t].types[e],i)}}(e,t),d[n[t]+"SampleEntry"].prototype=new d[r+"SampleEntry"]}for(i=d.sampleGroupEntryCodes.length,t=0;t<i;t++)d[d.sampleGroupEntryCodes[t]+"SampleGroupEntry"]=function(t){return function(e){d.SampleGroupEntry.call(this,d.sampleGroupEntryCodes[t],e)}}(t),d[d.sampleGroupEntryCodes[t]+"SampleGroupEntry"].prototype=new d.SampleGroupEntry;for(i=d.trackGroupTypes.length,t=0;t<i;t++)d[d.trackGroupTypes[t]+"Box"]=function(t){return function(e){d.TrackGroupTypeBox.call(this,d.trackGroupTypes[t],e)}}(t),d[d.trackGroupTypes[t]+"Box"].prototype=new d.TrackGroupTypeBox},Box:function(t,e){this.type=t,this.size=e},FullBox:function(t,e){d.Box.call(this,t,e),this.flags=0,this.version=0},ContainerBox:function(t,e){d.Box.call(this,t,e),this.boxes=[]},SampleEntry:function(t,e,i,r){d.Box.call(this,t,e),this.hdr_size=i,this.start=r,this.boxes=[]},SampleGroupEntry:function(t){this.grouping_type=t},TrackGroupTypeBox:function(t,e){d.FullBox.call(this,t,e)}};d.initialize(),d.TKHD_FLAG_ENABLED=1,d.TKHD_FLAG_IN_MOVIE=2,d.TKHD_FLAG_IN_PREVIEW=4,d.TFHD_FLAG_BASE_DATA_OFFSET=1,d.TFHD_FLAG_SAMPLE_DESC=2,d.TFHD_FLAG_SAMPLE_DUR=8,d.TFHD_FLAG_SAMPLE_SIZE=16,d.TFHD_FLAG_SAMPLE_FLAGS=32,d.TFHD_FLAG_DUR_EMPTY=65536,d.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,d.TRUN_FLAGS_DATA_OFFSET=1,d.TRUN_FLAGS_FIRST_FLAG=4,d.TRUN_FLAGS_DURATION=256,d.TRUN_FLAGS_SIZE=512,d.TRUN_FLAGS_FLAGS=1024,d.TRUN_FLAGS_CTS_OFFSET=2048,e.BoxParser=d,d.SampleEntry.prototype.isVideo=function(){return!1},d.SampleEntry.prototype.isAudio=function(){return!1},d.SampleEntry.prototype.isSubtitle=function(){return!1},d.SampleEntry.prototype.isMetadata=function(){return!1},d.SampleEntry.prototype.isHint=function(){return!1},d.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},d.SampleEntry.prototype.getWidth=function(){return""},d.SampleEntry.prototype.getHeight=function(){return""},d.SampleEntry.prototype.getChannelCount=function(){return""},d.SampleEntry.prototype.getSampleRate=function(){return""},d.SampleEntry.prototype.getSampleSize=function(){return""},d.VisualSampleEntry.prototype.isVideo=function(){return!0},d.VisualSampleEntry.prototype.getWidth=function(){return this.width},d.VisualSampleEntry.prototype.getHeight=function(){return this.height},d.AudioSampleEntry.prototype.isAudio=function(){return!0},d.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},d.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},d.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},d.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},d.MetadataSampleEntry.prototype.isMetadata=function(){return!0},d.decimalToHex=function(t,e){var i=Number(t).toString(16);e="undefined"===typeof e||null===e?e=2:e;while(i.length<e)i="0"+i;return i},d.avc1SampleEntry.prototype.getCodec=function(){var t=d.SampleEntry.prototype.getCodec.call(this);return this.avcC?t+"."+d.decimalToHex(this.avcC.AVCProfileIndication)+d.decimalToHex(this.avcC.profile_compatibility)+d.decimalToHex(this.avcC.AVCLevelIndication):t},d.hvc1SampleEntry.prototype.getCodec=function(){var t,e=d.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(e+=".",this.hvcC.general_profile_space){case 0:e+="";break;case 1:e+="A";break;case 2:e+="B";break;case 3:e+="C";break}e+=this.hvcC.general_profile_idc,e+=".";var i=this.hvcC.general_profile_compatibility,r=0;for(t=0;t<32;t++){if(r|=1&i,31==t)break;r<<=1,i>>=1}e+=d.decimalToHex(r,0),e+=".",0===this.hvcC.general_tier_flag?e+="L":e+="H",e+=this.hvcC.general_level_idc;var n=!1,a="";for(t=5;t>=0;t--)(this.hvcC.general_constraint_indicator[t]||n)&&(a="."+d.decimalToHex(this.hvcC.general_constraint_indicator[t],0)+a,n=!0);e+=a}return e},d.mp4aSampleEntry.prototype.getCodec=function(){var t=d.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var e=this.esds.esd.getOTI(),i=this.esds.esd.getAudioConfig();return t+"."+d.decimalToHex(e)+(i?"."+i:"")}return t},d.stxtSampleEntry.prototype.getCodec=function(){var t=d.SampleEntry.prototype.getCodec.call(this);return this.mime_format?t+"."+this.mime_format:t},d.parseOneBox=function(t,e){var i,n,a=t.getPosition(),s=0;if(t.getEndPosition()-a<8)return r.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:d.ERR_NOT_ENOUGH_DATA};var o=t.readUint32(),l=t.readString(4);if(r.debug("BoxParser","Found box of type "+l+" and size "+o+" at position "+a),s=8,"uuid"==l&&(n=t.readUint8Array(16),s+=16),1==o){if(t.getEndPosition()-t.getPosition()<8)return t.seek(a),r.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+l+'" box'),{code:d.ERR_NOT_ENOUGH_DATA};o=t.readUint64(),s+=8}else if(0===o&&"mdat"!==l)throw"Unlimited box size not supported";return a+o>t.getEndPosition()?(t.seek(a),r.warn("BoxParser",'Not enough data in stream to parse the entire "'+l+'" box'),{code:d.ERR_NOT_ENOUGH_DATA,type:l,size:o,hdr_size:s,start:a}):e?{code:d.OK,type:l,size:o,hdr_size:s,start:a}:(d[l+"Box"]?i=new d[l+"Box"](o):("uuid"!==l&&r.warn("BoxParser","Unknown box type: "+l),i=new d.Box(l,o),n&&(i.uuid=n)),i.hdr_size=s,i.start=a,i.write===d.Box.prototype.write&&"mdat"!==i.type&&(r.warn("BoxParser",i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(t)),i.parse(t),{code:d.OK,box:i,size:o})},d.Box.prototype.parse=function(t){"mdat"!=this.type?this.data=t.readUint8Array(this.size-this.hdr_size):0===this.size?t.seek(t.getEndPosition()):t.seek(this.start+this.size)},d.Box.prototype.parseDataAndRewind=function(t){this.data=t.readUint8Array(this.size-this.hdr_size),t.position-=this.size-this.hdr_size},d.FullBox.prototype.parseDataAndRewind=function(t){this.parseFullHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,t.position-=this.size-this.hdr_size},d.FullBox.prototype.parseFullHeader=function(t){this.version=t.readUint8(),this.flags=t.readUint24(),this.hdr_size+=4},d.FullBox.prototype.parse=function(t){this.parseFullHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)},d.ContainerBox.prototype.parse=function(t){var e,i;while(t.getPosition()<this.start+this.size)e=d.parseOneBox(t,!1),i=e.box,this.boxes.push(i),this.subBoxNames&&-1!=this.subBoxNames.indexOf(i.type)?this[this.subBoxNames[this.subBoxNames.indexOf(i.type)]+"s"].push(i):this[i.type]=i},d.Box.prototype.parseLanguage=function(t){this.language=t.readUint16();var e=[];e[0]=this.language>>10&31,e[1]=this.language>>5&31,e[2]=31&this.language,this.languageString=String.fromCharCode(e[0]+96,e[1]+96,e[2]+96)},d.TrackGroupTypeBox.prototype.parse=function(t){this.parseFullHeader(t),this.track_group_id=t.readUint32()},d.TrackReferenceTypeBox=function(t,e,i,r){d.Box.call(this,t,e),this.hdr_size=i,this.start=r},d.TrackReferenceTypeBox.prototype=new d.Box,d.TrackReferenceTypeBox.prototype.parse=function(t){this.track_ids=t.readUint32Array((this.size-this.hdr_size)/4)},d.avcCBox.prototype.parse=function(t){var e,i,r,n;for(this.configurationVersion=t.readUint8(),this.AVCProfileIndication=t.readUint8(),this.profile_compatibility=t.readUint8(),this.AVCLevelIndication=t.readUint8(),this.lengthSizeMinusOne=3&t.readUint8(),i=31&t.readUint8(),n=this.size-this.hdr_size-6,this.SPS=new Array(i),e=0;e<i;e++)r=t.readUint16(),this.SPS[e]=t.readUint8Array(r),n-=2+r;for(i=t.readUint8(),n--,this.PPS=new Array(i),e=0;e<i;e++)r=t.readUint16(),this.PPS[e]=t.readUint8Array(r),n-=2+r;n>0&&(this.ext=t.readUint8Array(n))},d.btrtBox.prototype.parse=function(t){this.bufferSizeDB=t.readUint32(),this.maxBitrate=t.readUint32(),this.avgBitrate=t.readUint32()},d.co64Box.prototype.parse=function(t){var e,i;if(this.parseFullHeader(t),e=t.readUint32(),this.chunk_offsets=[],0===this.version)for(i=0;i<e;i++)this.chunk_offsets.push(t.readUint64());else this.data=t.readUint8Array(this.size-this.hdr_size-4)},d.cprtBox.prototype.parse=function(t){this.parseFullHeader(t),this.parseLanguage(t),this.notice=t.readCString(),t.getPosition()>this.start+this.size&&(r.warn("BoxParser","Parsed more than the size of the box (null-terminated string problem?)"),t.seek(this.start+this.size))},d.cslgBox.prototype.parse=function(t){this.parseFullHeader(t),0===this.version?(this.compositionToDTSShift=t.readInt32(),this.leastDecodeToDisplayDelta=t.readInt32(),this.greatestDecodeToDisplayDelta=t.readInt32(),this.compositionStartTime=t.readInt32(),this.compositionEndTime=t.readInt32()):this.data=t.readUint8Array(this.size-this.hdr_size-4)},d.cttsBox.prototype.parse=function(t){var e,i;if(this.parseFullHeader(t),e=t.readUint32(),this.sample_counts=[],this.sample_offsets=[],0===this.version)for(i=0;i<e;i++)this.sample_counts.push(t.readUint32()),this.sample_offsets.push(t.readInt32());else if(1==this.version)for(i=0;i<e;i++)this.sample_counts.push(t.readUint32()),this.sample_offsets.push(t.readInt32());else this.data=t.readUint8Array(this.size-this.hdr_size-4)},d.dimmBox.prototype.parse=function(t){this.bytessent=t.readUint64()},d.dmaxBox.prototype.parse=function(t){this.time=t.readUint32()},d.dmedBox.prototype.parse=function(t){this.bytessent=t.readUint64()},d.drefBox.prototype.parse=function(t){var e,i;this.parseFullHeader(t),this.entries=[];for(var r=t.readUint32(),n=0;n<r;n++)e=d.parseOneBox(t,!1),i=e.box,this.entries.push(i)},d.drepBox.prototype.parse=function(t){this.bytessent=t.readUint64()},d.elngBox.prototype.parse=function(t){this.parseFullHeader(t),this.extended_language=t.readString(this.size-this.hdr_size)},d.elstBox.prototype.parse=function(t){this.parseFullHeader(t),this.entries=[];for(var e=t.readUint32(),i=0;i<e;i++){var r={};this.entries.push(r),1===this.version?(r.segment_duration=t.readUint64(),r.media_time=t.readInt64()):(r.segment_duration=t.readUint32(),r.media_time=t.readInt32()),r.media_rate_integer=t.readInt16(),r.media_rate_fraction=t.readInt16()}},d.emsgBox.prototype.parse=function(t){this.parseFullHeader(t),this.scheme_id_uri=t.readCString(),this.value=t.readCString(),this.timescale=t.readUint32(),this.presentation_time_delta=t.readUint32(),this.event_duration=t.readUint32(),this.id=t.readUint32();var e=this.size-this.hdr_size-(16+(this.scheme_id_uri.length+1)+(this.value.length+1));this.message_data=t.readUint8Array(e)},d.esdsBox.prototype.parse=function(t){this.parseFullHeader(t);var e=t.readUint8Array(this.size-this.hdr_size);if("undefined"!==typeof l){var i=new l;this.esd=i.parseOneDescriptor(new a(e.buffer,0,a.BIG_ENDIAN))}},d.frmaBox.prototype.parse=function(t){this.data_format=t.readString(4)},d.ftypBox.prototype.parse=function(t){var e=this.size-this.hdr_size;this.major_brand=t.readString(4),this.minor_version=t.readUint32(),e-=8,this.compatible_brands=[];var i=0;while(e>=4)this.compatible_brands[i]=t.readString(4),e-=4,i++},d.hdlrBox.prototype.parse=function(t){this.parseFullHeader(t),0===this.version?(t.readUint32(),this.handler=t.readString(4),t.readUint32Array(3),this.name=t.readString(this.size-this.hdr_size-20),"\0"===this.name[this.name.length-1]&&(this.name=this.name.slice(0,-1))):this.data=t.readUint8Array(this.size-this.hdr_size)},d.hvcCBox.prototype.parse=function(t){var e,i,r,n;this.configurationVersion=t.readUint8(),n=t.readUint8(),this.general_profile_space=n>>6,this.general_tier_flag=(32&n)>>5,this.general_profile_idc=31&n,this.general_profile_compatibility=t.readUint32(),this.general_constraint_indicator=t.readUint8Array(6),this.general_level_idc=t.readUint8(),this.min_spatial_segmentation_idc=4095&t.readUint16(),this.parallelismType=3&t.readUint8(),this.chromaFormat=3&t.readUint8(),this.bitDepthLumaMinus8=7&t.readUint8(),this.bitDepthChromaMinus8=7&t.readUint8(),this.avgFrameRate=t.readUint16(),n=t.readUint8(),this.constantFrameRate=n>>6,this.numTemporalLayers=(13&n)>>3,this.temporalIdNested=(4&n)>>2,this.lengthSizeMinusOne=3&n,this.nalu_arrays=[];var a=t.readUint8();for(e=0;e<a;e++){var s=[];this.nalu_arrays.push(s),n=t.readUint8(),s.completeness=(128&n)>>7,s.nalu_type=63&n;var o=t.readUint16();for(i=0;i<o;i++){var l={};s.push(l),r=t.readUint16(),l.data=t.readUint8Array(r)}}},d.iinfBox.prototype.parse=function(t){var e;this.parseFullHeader(t),0===this.version?this.entry_count=t.readUint16():this.entry_count=t.readUint32(),this.item_infos=[];for(var i=0;i<this.entry_count;i++)e=d.parseOneBox(t,!1),"infe"!==e.box.type&&r.error("BoxParser","Expected 'infe' box, got "+e.box.type),this.item_infos[i]=e.box},d.ilocBox.prototype.parse=function(t){var e;this.parseFullHeader(t),e=t.readUint8(),this.offset_size=e>>4&15,this.length_size=15&e,e=t.readUint8(),this.base_offset_size=e>>4&15,1===this.version||2===this.version?this.index_size=15&e:this.index_size=0,this.items=[];var i=0;if(this.version<2)i=t.readUint16();else{if(2!==this.version)throw"version of iloc box not supported";i=t.readUint32()}for(var r=0;r<i;r++){var n={};if(this.items.push(n),this.version<2)n.item_ID=t.readUint16();else{if(2!==this.version)throw"version of iloc box not supported";n.item_ID=t.readUint16()}switch(1!==this.version&&2!==this.version||(n.construction_method=15&t.readUint16()),n.data_reference_index=t.readUint16(),this.base_offset_size){case 0:n.base_offset=0;break;case 4:n.base_offset=t.readUint32();break;case 8:n.base_offset=t.readUint64();break;default:throw"Error reading base offset size"}var a=t.readUint16();n.extents=[];for(var s=0;s<a;s++){var o={};if(n.extents.push(o),1===this.version||2===this.version)switch(this.index_size){case 0:o.extent_index=0;break;case 4:o.extent_index=t.readUint32();break;case 8:o.extent_index=t.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:o.extent_offset=0;break;case 4:o.extent_offset=t.readUint32();break;case 8:o.extent_offset=t.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:o.extent_length=0;break;case 4:o.extent_length=t.readUint32();break;case 8:o.extent_length=t.readUint64();break;default:throw"Error reading extent index"}}}},d.infeBox.prototype.parse=function(t){if(this.parseFullHeader(t),0!==this.version&&1!==this.version||(this.item_ID=t.readUint16(),this.item_protection_index=t.readUint16(),this.item_name=t.readCString(),this.content_type=t.readCString(),this.content_encoding=t.readCString()),1===this.version)return this.extension_type=t.readString(4),r.warn("BoxParser","Cannot parse extension type"),void t.seek(this.start+this.size);this.version>=2&&(2===this.version?this.item_ID=t.readUint16():3===this.version&&(this.item_ID=t.readUint32()),this.item_protection_index=t.readUint16(),this.item_type=t.readString(4),this.name=t.readCString(),"mime"===this.item_type?(this.content_type=t.readCString(),this.content_encoding=t.readCString()):"uri "===this.item_type&&(this.item_uri_type=t.readCString())),t.getPosition()>this.start+this.size&&(r.warn("BoxParser","Parsed more than the size of the box (null-terminated string problem?)"),t.seek(this.start+this.size))},d.irefBox=function(t){d.FullBox.call(this,"iref",t),this.references=[]},d.irefBox.prototype=new d.FullBox,d.irefBox.prototype.parse=function(t){var e,i;this.parseFullHeader(t);while(t.getPosition()<this.start+this.size)e=d.parseOneBox(t,!0),i=0===this.version?new d.SingleItemTypeReferenceBox(e.type,e.size,e.hdr_size,e.start):new d.SingleItemTypeReferenceBoxLarge(e.type,e.size,e.hdr_size,e.start),i.write===d.Box.prototype.write&&"mdat"!==i.type&&(r.warn("BoxParser",i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(t)),i.parse(t),this.references.push(i)},d.kindBox=function(t){d.FullBox.call(this,"kind",t),this.schemeURI="",this.value=""},d.kindBox.prototype=new d.FullBox,d.kindBox.prototype.parse=function(t){this.parseFullHeader(t),this.schemeURI=t.readCString(),this.value=t.readCString()},d.levaBox.prototype.parse=function(t){this.parseFullHeader(t);var e=t.readUint8();this.levels=[];for(var i=0;i<e;i++){var n={};this.levels[i]=n,n.track_ID=t.readUint32();var a=t.readUint8();switch(n.padding_flag=a>>7,n.assignment_type=127&a,n.assignment_type){case 0:n.grouping_type=t.readUint32();break;case 1:n.grouping_type=t.readUint32(),n.grouping_type_parameter=t.readUint32();break;case 2:break;case 3:break;case 4:n.sub_track_id=t.readUint32();break;default:r.warn("BoxParser","Unknown leva assignement type")}}},d.maxrBox.prototype.parse=function(t){this.period=t.readUint32(),this.bytes=t.readUint32()},d.mdhdBox.prototype.parse=function(t){this.parseFullHeader(t),1==this.version?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.parseLanguage(t),t.readUint16()},d.mehdBox.prototype.parse=function(t){this.parseFullHeader(t),1==this.version?this.fragment_duration=t.readUint64():this.fragment_duration=t.readUint32()},d.metaBox.prototype.parse=function(t){this.parseFullHeader(t),this.boxes=[],d.ContainerBox.prototype.parse.call(this,t)},d.mfhdBox.prototype.parse=function(t){this.parseFullHeader(t),this.sequence_number=t.readUint32()},d.mfroBox.prototype.parse=function(t){this.parseFullHeader(t),this.size=t.readUint32()},d.mvhdBox.prototype.parse=function(t){this.flags=0,this.parseFullHeader(t),1==this.version?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.rate=t.readUint32(),this.volume=t.readUint16()>>8,t.readUint16(),t.readUint32Array(2),this.matrix=t.readUint32Array(9),t.readUint32Array(6),this.next_track_id=t.readUint32()},d.npckBox.prototype.parse=function(t){this.packetssent=t.readUint32()},d.numpBox.prototype.parse=function(t){this.packetssent=t.readUint64()},d.padbBox.prototype.parse=function(t){this.parseFullHeader(t);var e=t.readUint32();this.padbits=[];for(var i=0;i<Math.floor((e+1)/2);i++)this.padbits=t.readUint8()},d.paylBox.prototype.parse=function(t){this.text=t.readString(this.size-this.hdr_size)},d.paytBox.prototype.parse=function(t){this.payloadID=t.readUint32();var e=t.readUint8();this.rtpmap_string=t.readString(e)},d.pdinBox.prototype.parse=function(t){this.parseFullHeader(t);var e=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var i=0;i<e;i++)this.rate[i]=t.readUint32(),this.initial_delay[i]=t.readUint32()},d.pitmBox.prototype.parse=function(t){this.parseFullHeader(t),0===this.version?this.item_id=t.readUint16():this.item_id=t.readUint32()},d.pmaxBox.prototype.parse=function(t){this.bytes=t.readUint32()},d.prftBox.prototype.parse=function(t){this.parseFullHeader(t),this.ref_track_id=t.readUint32(),this.ntp_timestamp=t.readUint64(),0===this.version?this.media_time=t.readUint32():this.media_time=t.readUint64()},d.psshBox.prototype.parse=function(t){if(this.parseFullHeader(t),this.system_id=t.readUint8Array(16),this.version>0){var e=t.readUint32();this.kid=[];for(var i=0;i<e;i++)this.kid[i]=t.readUint8Array(16)}var r=t.readUint32();r>0&&(this.data=t.readUint8Array(r))},d["rtp Box"].prototype.parse=function(t){this.descriptionformat=t.readString(4),this.sdptext=t.readString(this.size-this.hdr_size-4)},d.saioBox.prototype.parse=function(t){this.parseFullHeader(t),1&this.flags&&(this.aux_info_type=t.readUint32(),this.aux_info_type_parameter=t.readUint32());var e=t.readUint32();this.offset=[];for(var i=0;i<e;i++)0===this.version?this.offset[i]=t.readUint32():this.offset[i]=t.readUint64()},d.saizBox.prototype.parse=function(t){this.parseFullHeader(t),1&this.flags&&(this.aux_info_type=t.readUint32(),this.aux_info_type_parameter=t.readUint32()),this.default_sample_info_size=t.readUint8();var e=t.readUint32();if(this.sample_info_size=[],0===this.default_sample_info_size)for(var i=0;i<e;i++)this.sample_info_size[i]=t.readUint32()},d.mettSampleEntry.prototype.parse=function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)},d.metxSampleEntry.prototype.parse=function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.parseFooter(t)},d.SampleEntry.prototype.parseHeader=function(t){t.readUint8Array(6),this.data_reference_index=t.readUint16(),this.hdr_size+=8},d.SampleEntry.prototype.parse=function(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)},d.SampleEntry.prototype.parseDataAndRewind=function(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,t.position-=this.size-this.hdr_size},d.SampleEntry.prototype.parseFooter=function(t){var e,i;while(t.getPosition()<this.start+this.size)e=d.parseOneBox(t,!1),i=e.box,this.boxes.push(i),this[i.type]=i},d.VisualSampleEntry.prototype.parse=function(t){this.parseHeader(t),t.readUint16(),t.readUint16(),t.readUint32Array(3),this.width=t.readUint16(),this.height=t.readUint16(),this.horizresolution=t.readUint32(),this.vertresolution=t.readUint32(),t.readUint32(),this.frame_count=t.readUint16(),this.compressorname=t.readString(32),this.depth=t.readUint16(),t.readUint16(),this.parseFooter(t)},d.AudioSampleEntry.prototype.parse=function(t){this.parseHeader(t),t.readUint32Array(2),this.channel_count=t.readUint16(),this.samplesize=t.readUint16(),t.readUint16(),t.readUint16(),this.samplerate=t.readUint32()/65536,this.parseFooter(t)},d.sbttSampleEntry.prototype.parse=function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)},d.stppSampleEntry.prototype.parse=function(t){this.parseHeader(t),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.auxiliary_mime_types=t.readCString(),this.parseFooter(t)},d.stxtSampleEntry.prototype.parse=function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)},d.tx3gSampleEntry.prototype.parse=function(t){this.parseHeader(t),this.displayFlags=t.readUint32(),this.horizontal_justification=t.readInt8(),this.vertical_justification=t.readInt8(),this.bg_color_rgba=t.readUint8Array(4),this.box_record=t.readInt16Array(4),this.style_record=t.readUint8Array(12),this.parseFooter(t)},d.alstSampleGroupEntry.prototype.parse=function(t){var e,i=t.readUint16();for(this.first_output_sample=t.readUint16(),this.sample_offset=[],e=0;e<i;e++)this.sample_offset[e]=t.readUint32();var r=this.description_length-4-4*i;for(this.num_output_samples=[],this.num_total_samples=[],e=0;e<r/4;e++)this.num_output_samples[e]=t.readUint16(),this.num_total_samples[e]=t.readUint16()},d.avllSampleGroupEntry.prototype.parse=function(t){this.layerNumber=t.readUint8(),this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()},d.avssSampleGroupEntry.prototype.parse=function(t){this.subSequenceIdentifier=t.readUint16(),this.layerNumber=t.readUint8();var e=t.readUint8();this.durationFlag=e>>7,this.avgRateFlag=e>>6&1,this.durationFlag&&(this.duration=t.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()),this.dependency=[];for(var i=t.readUint8(),r=0;r<i;r++){var n={};this.dependency.push(n),n.subSeqDirectionFlag=t.readUint8(),n.layerNumber=t.readUint8(),n.subSequenceIdentifier=t.readUint16()}},d.dtrtSampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.mvifSampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.prolSampleGroupEntry.prototype.parse=function(t){this.roll_distance=t.readInt16()},d["rap SampleGroupEntry"].prototype.parse=function(t){var e=t.readUint8();this.num_leading_samples_known=e>>7,this.num_leading_samples=127&e},d.rashSampleGroupEntry.prototype.parse=function(t){if(this.operation_point_count=t.readUint16(),this.description_length!==2+(1===this.operation_point_count?2:6*this.operation_point_count)+9)r.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=t.readUint8Array(this.description_length-2);else{if(1===this.operation_point_count)this.target_rate_share=t.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var e=0;e<this.operation_point_count;e++)this.available_bitrate[e]=t.readUint32(),this.target_rate_share[e]=t.readUint16()}this.maximum_bitrate=t.readUint32(),this.minimum_bitrate=t.readUint32(),this.discard_priority=t.readUint8()}},d.rollSampleGroupEntry.prototype.parse=function(t){this.roll_distance=t.readInt16()},d.SampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=t.readUint8Array(this.description_length)},d.scifSampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.scnmSampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.stsaSampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.syncSampleGroupEntry.prototype.parse=function(t){var e=t.readUint8();this.NAL_unit_type=63&e},d.teleSampleGroupEntry.prototype.parse=function(t){var e=t.readUint8();this.level_independently_decodable=e>>7},d.tsasSampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.tsclSampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.viprSampleGroupEntry.prototype.parse=function(t){r.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.sbgpBox.prototype.parse=function(t){this.parseFullHeader(t),this.grouping_type=t.readString(4),1===this.version?this.grouping_type_parameter=t.readUint32():this.grouping_type_parameter=0,this.entries=[];for(var e=t.readUint32(),i=0;i<e;i++){var r={};this.entries.push(r),r.sample_count=t.readInt32(),r.group_description_index=t.readInt32()}},d.schmBox.prototype.parse=function(t){this.parseFullHeader(t),this.scheme_type=t.readString(4),this.scheme_version=t.readUint32(),1&this.flags&&(this.scheme_uri=t.readString(this.size-this.hdr_size-8))},d["sdp Box"].prototype.parse=function(t){this.sdptext=t.readString(this.size-this.hdr_size)},d.sdtpBox.prototype.parse=function(t){var e;this.parseFullHeader(t);var i=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var r=0;r<i;r++)e=t.readUint8(),this.is_leading[r]=e>>6,this.sample_depends_on[r]=e>>4&3,this.sample_is_depended_on[r]=e>>2&3,this.sample_has_redundancy[r]=3&e},d.sgpdBox.prototype.parse=function(t){this.parseFullHeader(t),this.grouping_type=t.readString(4),r.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),1===this.version?this.default_length=t.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=t.readUint32()),this.entries=[];for(var e=t.readUint32(),i=0;i<e;i++){var n;n=d[this.grouping_type+"SampleGroupEntry"]?new d[this.grouping_type+"SampleGroupEntry"](this.grouping_type):new d.SampleGroupEntry(this.grouping_type),this.entries.push(n),1===this.version&&0===this.default_length?n.description_length=t.readUint32():n.description_length=this.default_length,n.write===d.SampleGroupEntry.prototype.write&&(r.warn("BoxParser"," SampleEntry for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),n.data=t.readUint8Array(n.description_length),t.position-=n.description_length),n.parse(t)}},d.sidxBox.prototype.parse=function(t){this.parseFullHeader(t),this.reference_ID=t.readUint32(),this.timescale=t.readUint32(),0===this.version?(this.earliest_presentation_time=t.readUint32(),this.first_offset=t.readUint32()):(this.earliest_presentation_time=t.readUint64(),this.first_offset=t.readUint64()),t.readUint16(),this.references=[];for(var e=t.readUint16(),i=0;i<e;i++){var r={};this.references.push(r);var n=t.readUint32();r.reference_type=n>>31&1,r.referenced_size=2147483647&n,r.subsegment_duration=t.readUint32(),n=t.readUint32(),r.starts_with_SAP=n>>31&1,r.SAP_type=n>>28&7,r.SAP_delta_time=268435455&n}},d.SingleItemTypeReferenceBox=function(t,e,i,r){d.Box.call(this,t,e),this.hdr_size=i,this.start=r},d.SingleItemTypeReferenceBox.prototype=new d.Box,d.SingleItemTypeReferenceBox.prototype.parse=function(t){this.from_item_ID=t.readUint16();var e=t.readUint16();this.references=[];for(var i=0;i<e;i++)this.references[i]=t.readUint16()},d.SingleItemTypeReferenceBoxLarge=function(t,e,i,r){d.Box.call(this,t,e),this.hdr_size=i,this.start=r},d.SingleItemTypeReferenceBoxLarge.prototype=new d.Box,d.SingleItemTypeReferenceBoxLarge.prototype.parse=function(t){this.from_item_ID=t.readUint32();var e=t.readUint16();this.references=[];for(var i=0;i<e;i++)this.references[i]=t.readUint32()},d.ssixBox.prototype.parse=function(t){this.parseFullHeader(t),this.subsegments=[];for(var e=t.readUint32(),i=0;i<e;i++){var r={};this.subsegments.push(r),r.ranges=[];for(var n=t.readUint32(),a=0;a<n;a++){var s={};r.ranges.push(s),s.level=t.readUint8(),s.range_size=t.readUint24()}}},d.stcoBox.prototype.parse=function(t){var e;this.parseFullHeader(t),e=t.readUint32(),0===this.version?this.chunk_offsets=t.readUint32Array(e):this.data=t.readUint8Array(this.size-this.hdr_size-4)},d.stdpBox.prototype.parse=function(t){this.parseFullHeader(t);var e=(this.size-this.hdr_size)/2;this.priority=[];for(var i=0;i<e;i++)this.priority[i]=t.readUint16()},d.striBox.prototype.parse=function(t){this.parseFullHeader(t),this.switch_group=t.readUint16(),this.alternate_group=t.readUint16(),this.sub_track_id=t.readUint32();var e=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var i=0;i<e;i++)this.attribute_list[i]=t.readUint32()},d.stscBox.prototype.parse=function(t){var e,i;if(this.parseFullHeader(t),e=t.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],0===this.version)for(i=0;i<e;i++)this.first_chunk.push(t.readUint32()),this.samples_per_chunk.push(t.readUint32()),this.sample_description_index.push(t.readUint32());else this.data=t.readUint8Array(this.size-this.hdr_size-4)},d.stsdBox=function(t){d.FullBox.call(this,"stsd",t),this.entries=[]},d.stsdBox.prototype=new d.FullBox,d.stsdBox.prototype.parse=function(t){var e,i,n,a;for(this.parseFullHeader(t),n=t.readUint32(),e=1;e<=n;e++)i=d.parseOneBox(t,!0),d[i.type+"SampleEntry"]?(a=new d[i.type+"SampleEntry"](i.size),a.hdr_size=i.hdr_size,a.start=i.start):(r.warn("BoxParser","Unknown sample entry type: "+i.type),a=new d.SampleEntry(i.type,i.size,i.hdr_size,i.start)),a.write===d.SampleEntry.prototype.write&&(r.warn("BoxParser",a.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),a.parseDataAndRewind(t)),a.parse(t),this.entries.push(a)},d.stsgBox.prototype.parse=function(t){this.parseFullHeader(t),this.grouping_type=t.readUint32();var e=t.readUint16();this.group_description_index=[];for(var i=0;i<e;i++)this.group_description_index[i]=t.readUint32()},d.stshBox.prototype.parse=function(t){var e,i;if(this.parseFullHeader(t),e=t.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],0===this.version)for(i=0;i<e;i++)this.shadowed_sample_numbers.push(t.readUint32()),this.sync_sample_numbers.push(t.readUint32());else this.data=t.readUint8Array(this.size-this.hdr_size-4)},d.stssBox.prototype.parse=function(t){var e,i;if(this.parseFullHeader(t),i=t.readUint32(),0===this.version)for(this.sample_numbers=[],e=0;e<i;e++)this.sample_numbers.push(t.readUint32());else this.data=t.readUint8Array(this.size-this.hdr_size-4)},d.stszBox.prototype.parse=function(t){var e;if(this.parseFullHeader(t),this.sample_sizes=[],0===this.version)if(this.sample_size=t.readUint32(),this.sample_count=t.readUint32(),0===this.sample_size)this.sample_sizes=t.readUint32Array(this.sample_count);else for(e=0;e<this.sample_count;e++)this.sample_sizes[e]=this.sample_size;else this.data=t.readUint8Array(this.size-this.hdr_size)},d.sttsBox.prototype.parse=function(t){var e,i,n;if(this.parseFullHeader(t),e=t.readUint32(),this.sample_counts=[],this.sample_deltas=[],0===this.version)for(i=0;i<e;i++)this.sample_counts.push(t.readUint32()),n=t.readInt32(),n<0&&(r.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),n=1),this.sample_deltas.push(n);else this.data=t.readUint8Array(this.size-this.hdr_size-4)},d.stviBox.prototype.parse=function(t){this.parseFullHeader(t);var e=t.readUint32();this.single_view_allowed=3&e,this.stereo_scheme=t.readUint32();var i,r,n=t.readUint32();this.stereo_indication_type=t.readString(n),this.boxes=[];while(t.getPosition()<this.start+this.size)i=d.parseOneBox(t,!1),r=i.box,this.boxes.push(r),this[r.type]=r},d.stxtSampleEntry.prototype.parse=function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)},d.stypBox.prototype.parse=function(t){d.ftypBox.prototype.parse.call(this,t)},d.stz2Box.prototype.parse=function(t){var e,i;if(this.parseFullHeader(t),this.sample_sizes=[],0===this.version)if(this.reserved=t.readUint24(),this.field_size=t.readUint8(),i=t.readUint32(),4===this.field_size)for(e=0;e<i;e+=2){var n=t.readUint8();this.sample_sizes[e]=n>>4&15,this.sample_sizes[e+1]=15&n}else if(8===this.field_size)for(e=0;e<i;e++)this.sample_sizes[e]=t.readUint8();else if(16===this.field_size)for(e=0;e<i;e++)this.sample_sizes[e]=t.readUint16();else r.error("BoxParser","Error in length field in stz2 box");else this.data=t.readUint8Array(this.size-this.hdr_size)},d.subsBox.prototype.parse=function(t){var e,i,r,n;for(this.parseFullHeader(t),r=t.readUint32(),this.samples=[],e=0;e<r;e++){var a={};if(this.samples[e]=a,a.sample_delta=t.readUint32(),a.subsamples=[],n=t.readUint16(),n>0)for(i=0;i<n;i++){var s={};a.subsamples.push(s),1==this.version?s.size=t.readUint32():s.size=t.readUint16(),s.priority=t.readUint8(),s.discardable=t.readUint8(),s.reserved=t.readUint32()}}},d.tfdtBox.prototype.parse=function(t){this.parseFullHeader(t),1==this.version?this.baseMediaDecodeTime=t.readUint64():this.baseMediaDecodeTime=t.readUint32()},d.tfhdBox.prototype.parse=function(t){var e=0;this.parseFullHeader(t),this.track_id=t.readUint32(),this.size-this.hdr_size>e&&this.flags&d.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=t.readUint64(),e+=8):this.base_data_offset=0,this.size-this.hdr_size>e&&this.flags&d.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=t.readUint32(),e+=4):this.default_sample_description_index=0,this.size-this.hdr_size>e&&this.flags&d.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=t.readUint32(),e+=4):this.default_sample_duration=0,this.size-this.hdr_size>e&&this.flags&d.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=t.readUint32(),e+=4):this.default_sample_size=0,this.size-this.hdr_size>e&&this.flags&d.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=t.readUint32(),e+=4):this.default_sample_flags=0},d.tfraBox.prototype.parse=function(t){this.parseFullHeader(t),this.track_ID=t.readUint32(),t.readUint24();var e=t.readUint8();this.length_size_of_traf_num=e>>4&3,this.length_size_of_trun_num=e>>2&3,this.length_size_of_sample_num=3&e,this.entries=[];for(var i=t.readUint32(),r=0;r<i;r++)1===this.version?(this.time=t.readUint64(),this.moof_offset=t.readUint64()):(this.time=t.readUint32(),this.moof_offset=t.readUint32()),this.traf_number=t["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=t["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=t["readUint"+8*(this.length_size_of_sample_num+1)]()},d.tkhdBox.prototype.parse=function(t){this.parseFullHeader(t),1==this.version?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint32()),t.readUint32Array(2),this.layer=t.readInt16(),this.alternate_group=t.readInt16(),this.volume=t.readInt16()>>8,t.readUint16(),this.matrix=t.readInt32Array(9),this.width=t.readUint32(),this.height=t.readUint32()},d.tmaxBox.prototype.parse=function(t){this.time=t.readUint32()},d.tminBox.prototype.parse=function(t){this.time=t.readUint32()},d.totlBox.prototype.parse=function(t){this.bytessent=t.readUint32()},d.tpayBox.prototype.parse=function(t){this.bytessent=t.readUint32()},d.tpylBox.prototype.parse=function(t){this.bytessent=t.readUint64()},d.trefBox.prototype.parse=function(t){var e,i;while(t.getPosition()<this.start+this.size)e=d.parseOneBox(t,!0),i=new d.TrackReferenceTypeBox(e.type,e.size,e.hdr_size,e.start),i.write===d.Box.prototype.write&&"mdat"!==i.type&&(r.warn("BoxParser",i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(t)),i.parse(t),this.boxes.push(i)},d.trepBox.prototype.parse=function(t){this.parseFullHeader(t),this.track_ID=t.readUint32(),this.boxes=[];while(t.getPosition()<this.start+this.size)ret=d.parseOneBox(t,!1),box=ret.box,this.boxes.push(box)},d.trexBox.prototype.parse=function(t){this.parseFullHeader(t),this.track_id=t.readUint32(),this.default_sample_description_index=t.readUint32(),this.default_sample_duration=t.readUint32(),this.default_sample_size=t.readUint32(),this.default_sample_flags=t.readUint32()},d.trpyBox.prototype.parse=function(t){this.bytessent=t.readUint64()},d.trunBox.prototype.parse=function(t){var e=0;if(this.parseFullHeader(t),this.sample_count=t.readUint32(),e+=4,this.size-this.hdr_size>e&&this.flags&d.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=t.readInt32(),e+=4):this.data_offset=0,this.size-this.hdr_size>e&&this.flags&d.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=t.readUint32(),e+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>e)for(var i=0;i<this.sample_count;i++)this.flags&d.TRUN_FLAGS_DURATION&&(this.sample_duration[i]=t.readUint32()),this.flags&d.TRUN_FLAGS_SIZE&&(this.sample_size[i]=t.readUint32()),this.flags&d.TRUN_FLAGS_FLAGS&&(this.sample_flags[i]=t.readUint32()),this.flags&d.TRUN_FLAGS_CTS_OFFSET&&(0===this.version?this.sample_composition_time_offset[i]=t.readUint32():this.sample_composition_time_offset[i]=t.readInt32())},d.tselBox.prototype.parse=function(t){this.parseFullHeader(t),this.switch_group=t.readUint32();var e=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var i=0;i<e;i++)this.attribute_list[i]=t.readUint32()},d.tx3gSampleEntry.prototype.parse=function(t){this.parseHeader(t),this.displayFlags=t.readUint32(),this.horizontal_justification=t.readInt8(),this.vertical_justification=t.readInt8(),this.bg_color_rgba=t.readUint8Array(4),this.box_record=t.readInt16Array(4),this.style_record=t.readUint8Array(12),this.parseFooter(t)},d.txtCBox.prototype.parse=function(t){this.parseFullHeader(t),this.config=t.readCString()},d["url Box"].prototype.parse=function(t){this.parseFullHeader(t),1!==this.flags?this.location=t.readCString():this.size-this.hdr_size&&(r.warn("BoxParser","Invalid urlBox - contains data but flag not set"),this.location=t.readString(this.size-this.hdr_size))},d["urn Box"].prototype.parse=function(t){this.parseFullHeader(t),this.name=t.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=t.readCString())},d.vmhdBox.prototype.parse=function(t){this.parseFullHeader(t),this.graphicsmode=t.readUint16(),this.opcolor=t.readUint16Array(3)},d.vttCBox.prototype.parse=function(t){this.text=t.readString(this.size-this.hdr_size)},d.Box.prototype.writeHeader=function(t,e){this.size+=8,this.size>s&&(this.size+=8),"uuid"===this.type&&(this.size+=16),r.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+t.getPosition()+(e||"")),this.size>s?t.writeUint32(1):(this.sizePosition=t.getPosition(),t.writeUint32(this.size)),t.writeString(this.type,null,4),"uuid"===this.type&&t.writeUint8Array(this.uuid),this.size>s&&t.writeUint64(this.size)},d.FullBox.prototype.writeHeader=function(t){this.size+=4,d.Box.prototype.writeHeader.call(this,t," v="+this.version+" f="+this.flags),t.writeUint8(this.version),t.writeUint24(this.flags)},d.Box.prototype.write=function(t){"mdat"===this.type?this.data&&(this.size=this.data.length,this.writeHeader(t),t.writeUint8Array(this.data)):(this.size=this.data.length,this.writeHeader(t),t.writeUint8Array(this.data))},d.ContainerBox.prototype.write=function(t){this.size=0,this.writeHeader(t);for(var e=0;e<this.boxes.length;e++)this.boxes[e]&&(this.boxes[e].write(t),this.size+=this.boxes[e].size);r.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},d.TrackReferenceTypeBox.prototype.write=function(t){this.size=4*this.track_ids.length,this.writeHeader(t),t.writeUint32Array(this.track_ids)},d.avcCBox.prototype.write=function(t){var e;for(this.size=7,e=0;e<this.SPS.length;e++)this.size+=2+this.SPS[e].length;for(e=0;e<this.PPS.length;e++)this.size+=2+this.PPS[e].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(t),t.writeUint8(this.configurationVersion),t.writeUint8(this.AVCProfileIndication),t.writeUint8(this.profile_compatibility),t.writeUint8(this.AVCLevelIndication),t.writeUint8(this.lengthSizeMinusOne+252),t.writeUint8(this.SPS.length+224),e=0;e<this.SPS.length;e++)t.writeUint16(this.SPS[e].length),t.writeUint8Array(this.SPS[e]);for(t.writeUint8(this.PPS.length),e=0;e<this.PPS.length;e++)t.writeUint16(this.PPS[e].length),t.writeUint8Array(this.PPS[e]);this.ext&&t.writeUint8Array(this.ext)},d.co64Box.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),e=0;e<this.chunk_offsets.length;e++)t.writeUint64(this.chunk_offsets[e])},d.cslgBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=20,this.writeHeader(t),t.writeInt32(this.compositionToDTSShift),t.writeInt32(this.leastDecodeToDisplayDelta),t.writeInt32(this.greatestDecodeToDisplayDelta),t.writeInt32(this.compositionStartTime),t.writeInt32(this.compositionEndTime)},d.cttsBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length),e=0;e<this.sample_counts.length;e++)t.writeUint32(this.sample_counts[e]),1===this.version?t.writeInt32(this.sample_offsets[e]):t.writeUint32(this.sample_offsets[e])},d.drefBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.entries.length);for(var e=0;e<this.entries.length;e++)this.entries[e].write(t),this.size+=this.entries[e].size;r.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},d.elngBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(t),t.writeString(this.extended_language)},d.elstBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(t),t.writeUint32(this.entries.length);for(var e=0;e<this.entries.length;e++){var i=this.entries[e];t.writeUint32(i.segment_duration),t.writeInt32(i.media_time),t.writeInt16(i.media_rate_integer),t.writeInt16(i.media_rate_fraction)}},d.emsgBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=16+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(t),t.writeCString(this.scheme_id_uri),t.writeCString(this.value),t.writeUint32(this.timescale),t.writeUint32(this.presentation_time_delta),t.writeUint32(this.event_duration),t.writeUint32(this.id),t.writeUint8Array(this.message_data)},d.ftypBox.prototype.write=function(t){this.size=8+4*this.compatible_brands.length,this.writeHeader(t),t.writeString(this.major_brand,null,4),t.writeUint32(this.minor_version);for(var e=0;e<this.compatible_brands.length;e++)t.writeString(this.compatible_brands[e],null,4)},d.hdlrBox.prototype.write=function(t){this.size=20+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(t),t.writeUint32(0),t.writeString(this.handler,null,4),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeCString(this.name)},d.kindBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(t),t.writeCString(this.schemeURI),t.writeCString(this.value)},d.mdhdBox.prototype.write=function(t){this.size=20,this.flags=0,this.version=0,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration),t.writeUint16(this.language),t.writeUint16(0)},d.mehdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.fragment_duration)},d.mfhdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.sequence_number)},d.mvhdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=96,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration),t.writeUint32(this.rate),t.writeUint16(this.volume<<8),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32Array(this.matrix),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(this.next_track_id)},d.SampleEntry.prototype.writeHeader=function(t){this.size=8,d.Box.prototype.writeHeader.call(this,t),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint16(this.data_reference_index)},d.SampleEntry.prototype.writeFooter=function(t){for(var e=0;e<this.boxes.length;e++)this.boxes[e].write(t),this.size+=this.boxes[e].size;r.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},d.SampleEntry.prototype.write=function(t){this.writeHeader(t),t.writeUint8Array(this.data),this.size+=this.data.length,r.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},d.VisualSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=70,t.writeUint16(0),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint16(this.width),t.writeUint16(this.height),t.writeUint32(this.horizresolution),t.writeUint32(this.vertresolution),t.writeUint32(0),t.writeUint16(this.frame_count),t.writeString(this.compressorname,null,32),t.writeUint16(this.depth),t.writeInt16(-1),this.writeFooter(t)},d.AudioSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=20,t.writeUint32(0),t.writeUint32(0),t.writeUint16(this.channel_count),t.writeUint16(this.samplesize),t.writeUint16(0),t.writeUint16(0),t.writeUint32(this.samplerate<<16),this.writeFooter(t)},d.SampleGroupEntry.prototype.write=function(t){t.writeUint8Array(this.data)},d.sbgpBox.prototype.write=function(t){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(t),t.writeString(this.grouping_type,null,4),t.writeUint32(this.grouping_type_parameter),t.writeUint32(this.entries.length);for(var e=0;e<this.entries.length;e++){var i=this.entries[e];t.writeInt32(i.sample_count),t.writeInt32(i.group_description_index)}},d.sgpdBox.prototype.write=function(t){var e,i;for(this.flags=0,this.size=12,e=0;e<this.entries.length;e++)i=this.entries[e],1===this.version&&(0===this.default_length&&(this.size+=4),this.size+=i.data.length);for(this.writeHeader(t),t.writeString(this.grouping_type,null,4),1===this.version&&t.writeUint32(this.default_length),this.version>=2&&t.writeUint32(this.default_sample_description_index),t.writeUint32(this.entries.length),e=0;e<this.entries.length;e++)i=this.entries[e],1===this.version&&0===this.default_length&&t.writeUint32(i.description_length),i.write(t)},d.sidxBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=20+12*this.references.length,this.writeHeader(t),t.writeUint32(this.reference_ID),t.writeUint32(this.timescale),t.writeUint32(this.earliest_presentation_time),t.writeUint32(this.first_offset),t.writeUint16(0),t.writeUint16(this.references.length);for(var e=0;e<this.references.length;e++){var i=this.references[e];t.writeUint32(i.reference_type<<31|i.referenced_size),t.writeUint32(i.subsegment_duration),t.writeUint32(i.starts_with_SAP<<31|i.SAP_type<<28|i.SAP_delta_time)}},d.stcoBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),t.writeUint32Array(this.chunk_offsets)},d.stscBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(t),t.writeUint32(this.first_chunk.length),e=0;e<this.first_chunk.length;e++)t.writeUint32(this.first_chunk[e]),t.writeUint32(this.samples_per_chunk[e]),t.writeUint32(this.sample_description_index[e])},d.stsdBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(t),t.writeUint32(this.entries.length),this.size+=4,e=0;e<this.entries.length;e++)this.entries[e].write(t),this.size+=this.entries[e].size;r.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},d.stshBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(t),t.writeUint32(this.shadowed_sample_numbers.length),e=0;e<this.shadowed_sample_numbers.length;e++)t.writeUint32(this.shadowed_sample_numbers[e]),t.writeUint32(this.sync_sample_numbers[e])},d.stssBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(t),t.writeUint32(this.sample_numbers.length),t.writeUint32Array(this.sample_numbers)},d.stszBox.prototype.write=function(t){var e,i=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0){e=0;while(e+1<this.sample_sizes.length){if(this.sample_sizes[e+1]!==this.sample_sizes[0]){i=!1;break}e++}}else i=!1;this.size=8,i||(this.size+=4*this.sample_sizes.length),this.writeHeader(t),i?t.writeUint32(this.sample_sizes[0]):t.writeUint32(0),t.writeUint32(this.sample_sizes.length),i||t.writeUint32Array(this.sample_sizes)},d.sttsBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length),e=0;e<this.sample_counts.length;e++)t.writeUint32(this.sample_counts[e]),t.writeUint32(this.sample_deltas[e])},d.tfdtBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,1===this.version&&(this.size+=4),this.writeHeader(t),1===this.version?t.writeUint64(this.baseMediaDecodeTime):t.writeUint32(this.baseMediaDecodeTime)},d.tfhdBox.prototype.write=function(t){this.version=0,this.size=4,this.flags&d.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&d.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&d.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&d.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&d.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(t),t.writeUint32(this.track_id),this.flags&d.TFHD_FLAG_BASE_DATA_OFFSET&&t.writeUint64(this.base_data_offset),this.flags&d.TFHD_FLAG_SAMPLE_DESC&&t.writeUint32(this.default_sample_description_index),this.flags&d.TFHD_FLAG_SAMPLE_DUR&&t.writeUint32(this.default_sample_duration),this.flags&d.TFHD_FLAG_SAMPLE_SIZE&&t.writeUint32(this.default_sample_size),this.flags&d.TFHD_FLAG_SAMPLE_FLAGS&&t.writeUint32(this.default_sample_flags)},d.tkhdBox.prototype.write=function(t){this.version=0,this.size=80,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.track_id),t.writeUint32(0),t.writeUint32(this.duration),t.writeUint32(0),t.writeUint32(0),t.writeInt16(this.layer),t.writeInt16(this.alternate_group),t.writeInt16(this.volume<<8),t.writeUint16(0),t.writeInt32Array(this.matrix),t.writeUint32(this.width),t.writeUint32(this.height)},d.trexBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=20,this.writeHeader(t),t.writeUint32(this.track_id),t.writeUint32(this.default_sample_description_index),t.writeUint32(this.default_sample_duration),t.writeUint32(this.default_sample_size),t.writeUint32(this.default_sample_flags)},d.trunBox.prototype.write=function(t){this.version=0,this.size=4,this.flags&d.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&d.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&d.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&d.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&d.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&d.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(t),t.writeUint32(this.sample_count),this.flags&d.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=t.getPosition(),t.writeInt32(this.data_offset)),this.flags&d.TRUN_FLAGS_FIRST_FLAG&&t.writeUint32(this.first_sample_flags);for(var e=0;e<this.sample_count;e++)this.flags&d.TRUN_FLAGS_DURATION&&t.writeUint32(this.sample_duration[e]),this.flags&d.TRUN_FLAGS_SIZE&&t.writeUint32(this.sample_size[e]),this.flags&d.TRUN_FLAGS_FLAGS&&t.writeUint32(this.sample_flags[e]),this.flags&d.TRUN_FLAGS_CTS_OFFSET&&(0===this.version?t.writeUint32(this.sample_composition_time_offset[e]):t.writeInt32(this.sample_composition_time_offset[e]))},d["url Box"].prototype.write=function(t){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(t),this.location&&t.writeCString(this.location)},d["urn Box"].prototype.write=function(t){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(t),t.writeCString(this.name),this.location&&t.writeCString(this.location)},d.vmhdBox.prototype.write=function(t){this.version=0,this.flags=1,this.size=8,this.writeHeader(t),t.writeUint16(this.graphicsmode),t.writeUint16Array(this.opcolor)},d.cttsBox.prototype.unpack=function(t){var e,i,r;for(r=0,e=0;e<this.sample_counts.length;e++)for(i=0;i<this.sample_counts[e];i++)t[r].pts=t[r].dts+this.sample_offsets[e],r++},d.sttsBox.prototype.unpack=function(t){var e,i,r;for(r=0,e=0;e<this.sample_counts.length;e++)for(i=0;i<this.sample_counts[e];i++)t[r].dts=0===r?0:t[r-1].dts+this.sample_deltas[e],r++},d.stcoBox.prototype.unpack=function(t){var e;for(e=0;e<this.chunk_offsets.length;e++)t[e].offset=this.chunk_offsets[e]},d.stscBox.prototype.unpack=function(t){var e,i,r,n,a;for(n=0,a=0,e=0;e<this.first_chunk.length;e++)for(i=0;i<(e+1<this.first_chunk.length?this.first_chunk[e+1]:1/0);i++)for(a++,r=0;r<this.samples_per_chunk[e];r++){if(!t[n])return;t[n].description_index=this.sample_description_index[e],t[n].chunk_index=a,n++}},d.stszBox.prototype.unpack=function(t){var e;for(e=0;e<this.sample_sizes.length;e++)t[e].size=this.sample_sizes[e]};var p=function(){};p.prototype.parseSample=function(t){var e,i,r=new n(t.buffer);e=[];while(!r.isEos())i=d.parseOneBox(r,!1),i.code===d.OK&&"vttc"===i.box.type&&e.push(i.box);return e},p.prototype.getText=function(t,e,i){function r(t,e,i){return i=i||"0",t+="",t.length>=e?t:new Array(e-t.length+1).join(i)+t}function n(t){var e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60),n=Math.floor(t-3600*e-60*i),a=Math.floor(1e3*(t-3600*e-60*i-n));return r(e,2)+":"+r(i,2)+":"+r(n,2)+"."+r(a,3)}for(var a=this.parseSample(i),s="",o=0;o<a.length;o++){var l=a[o];s+=n(t)+" --\x3e "+n(e)+"\r\n",s+=l.payl.text}return s};var c=function(){};c.prototype.parseSample=function(t){var e,i={};i.resources=[];var r=new n(t.data.buffer);if(t.subsamples&&0!==t.subsamples.length){if(i.documentString=r.readString(t.subsamples[0].size),t.subsamples.length>1)for(e=1;e<t.subsamples.length;e++)i.resources[e]=r.readUint8Array(t.subsamples[e].size)}else i.documentString=r.readString(t.data.length);return i.document=(new DOMParser).parseFromString(i.documentString,"application/xml"),i};var h=function(){};h.prototype.parseSample=function(t){var e,i=new n(t.data.buffer);return e=i.readString(t.data.length),e},h.prototype.parseConfig=function(t){var e,i=new n(t.buffer);return i.readUint32(),e=i.readCString(),e};var u=function(t){this.stream=t,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1};u.prototype.parse=function(){var t,e,i=!1;if(!this.restoreParsePosition||this.restoreParsePosition())while(1){if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}if(this.saveParsePosition&&this.saveParsePosition(),t=d.parseOneBox(this.stream,i),t.code===d.ERR_NOT_ENOUGH_DATA){if(this.processIncompleteBox){if(this.processIncompleteBox(t))continue;return}return}switch(e=t.box,this.boxes.push(e),e.type){case"mdat":this.mdats.push(e);break;case"moof":this.moofs.push(e);break;case"moov":this.moovStartFound=!0,0===this.mdats.length&&(this.isProgressive=!0);default:void 0!==this[e.type]&&r.warn("ISOFile","Duplicate Box of type: "+e.type+", overriding previous occurrence"),this[e.type]=e;break}this.updateUsedBytes&&this.updateUsedBytes(e,t)}},u.prototype.getBox=function(t){var e=this.getBoxes(t,!0);return e.length?e[0]:null},u.prototype.getBoxes=function(t,e){var i=[];return u._sweep.call(this,t,i,e),i},u._sweep=function(t,e,i){for(var r in this.type&&this.type==t&&e.push(this),this.boxes){if(e.length&&i)return;u._sweep.call(this.boxes[r],t,e,i)}},e.ISOFile=u,u.prototype.lastBoxStartPosition=0,u.prototype.parsingMdat=null,u.prototype.nextParsePosition=0,u.prototype.discardMdatData=!1,u.prototype.processIncompleteBox=function(t){var e,i,r;return"mdat"===t.type?(e=new d[t.type+"Box"](t.size),this.parsingMdat=e,this.boxes.push(e),this.mdats.push(e),e.start=t.start,e.hdr_size=t.hdr_size,this.stream.addUsedBytes(e.hdr_size),this.lastBoxStartPosition=e.start+e.size,r=this.stream.seek(e.start+e.size,!1,this.discardMdatData),r?(this.parsingMdat=null,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=e.start+e.size,!1)):("moov"===t.type&&(this.moovStartFound=!0,0===this.mdats.length&&(this.isProgressive=!0)),i=this.stream.mergeNextBuffer(),i?(this.nextParsePosition=this.stream.getEndPosition(),!0):(t.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+t.size:this.nextParsePosition=this.stream.getEndPosition(),!1))},u.prototype.hasIncompleteMdat=function(){return null!==this.parsingMdat},u.prototype.processIncompleteMdat=function(){var t,e;return t=this.parsingMdat,e=this.stream.seek(t.start+t.size,!1,this.discardMdatData),e?(r.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},u.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},u.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},u.prototype.updateUsedBytes=function(t,e){"mdat"===t.type?(this.stream.addUsedBytes(t.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(t.size-t.hdr_size)):this.stream.addUsedBytes(t.size)},u.prototype.lastMoofIndex=0,u.prototype.samplesDataSize=0,u.prototype.resetTables=function(){var t,e,i,r,n,a,s,o;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,t=0;t<this.moov.traks.length;t++){e=this.moov.traks[t],e.tkhd.duration=0,e.mdia.mdhd.duration=0,i=e.mdia.minf.stbl.stco||e.mdia.minf.stbl.co64,i.chunk_offsets=[],r=e.mdia.minf.stbl.stsc,r.first_chunk=[],r.samples_per_chunk=[],r.sample_description_index=[],n=e.mdia.minf.stbl.stsz||e.mdia.minf.stbl.stz2,n.sample_sizes=[],a=e.mdia.minf.stbl.stts,a.sample_counts=[],a.sample_deltas=[],s=e.mdia.minf.stbl.ctts,s&&(s.sample_counts=[],s.sample_offsets=[]),o=e.mdia.minf.stbl.stss;var l=e.mdia.minf.stbl.boxes.indexOf(o);-1!=l&&(e.mdia.minf.stbl.boxes[l]=null)}},u.prototype.buildSampleLists=function(){var t,e,i,r,n,a,s,o,l,d,p,c,h,u,f,m,g,b,y,v,x,_,w;for(t=0;t<this.moov.traks.length;t++){for(i=this.moov.traks[t],i.samples=[],r=i.mdia.minf.stbl.stco||i.mdia.minf.stbl.co64,n=i.mdia.minf.stbl.stsc,a=i.mdia.minf.stbl.stsz||i.mdia.minf.stbl.stz2,s=i.mdia.minf.stbl.stts,o=i.mdia.minf.stbl.ctts,l=i.mdia.minf.stbl.stss,d=i.mdia.minf.stbl.stsd,p=i.mdia.minf.stbl.subs,g=-1,b=-1,y=-1,v=-1,x=0,_=0,w=0,e=0;e<a.sample_sizes.length;e++){var S={};S.number=e,S.track_id=i.tkhd.track_id,S.timescale=i.mdia.mdhd.timescale,S.alreadyRead=0,i.samples[e]=S,S.size=a.sample_sizes[e],0===e?(h=1,c=0,S.chunk_index=h,S.chunk_run_index=c,m=n.samples_per_chunk[c],f=0,u=c+1<n.first_chunk.length?n.first_chunk[c+1]-1:1/0):e<m?(S.chunk_index=h,S.chunk_run_index=c):(h++,S.chunk_index=h,f=0,h<=u||(c++,u=c+1<n.first_chunk.length?n.first_chunk[c+1]-1:1/0),S.chunk_run_index=c,m+=n.samples_per_chunk[c]),S.description_index=n.sample_description_index[S.chunk_run_index]-1,S.description=d.entries[S.description_index],S.offset=r.chunk_offsets[S.chunk_index-1]+f,f+=S.size,e>g&&(b++,g<0&&(g=0),g+=s.sample_counts[b]),e>0?(i.samples[e-1].duration=s.sample_deltas[b],S.dts=i.samples[e-1].dts+i.samples[e-1].duration):S.dts=0,o?(e>=y&&(v++,y<0&&(y=0),y+=o.sample_counts[v]),S.cts=i.samples[e].dts+o.sample_offsets[v]):S.cts=S.dts,l?e==l.sample_numbers[x]-1?(S.is_rap=!0,x++):S.is_rap=!1:S.is_rap=!0,p&&p.samples[_].sample_delta+w==e&&(S.subsamples=p.samples[_].subsamples,w+=p.samples[_].sample_delta)}e>0&&(i.samples[e-1].duration=Math.max(i.mdia.mdhd.duration-i.samples[e-1].dts,0))}},u.prototype.updateSampleLists=function(){var t,e,i,r,n,a,s,o,l,p,c,h,u,f,m;if(void 0!==this.moov)while(this.lastMoofIndex<this.moofs.length)if(l=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,"moof"==l.type)for(p=l,t=0;t<p.trafs.length;t++){for(c=p.trafs[t],h=this.getTrackById(c.tfhd.track_id),u=this.getTrexById(c.tfhd.track_id),r=c.tfhd.flags&d.TFHD_FLAG_SAMPLE_DESC?c.tfhd.default_sample_description_index:u?u.default_sample_description_index:1,n=c.tfhd.flags&d.TFHD_FLAG_SAMPLE_DUR?c.tfhd.default_sample_duration:u?u.default_sample_duration:0,a=c.tfhd.flags&d.TFHD_FLAG_SAMPLE_SIZE?c.tfhd.default_sample_size:u?u.default_sample_size:0,s=c.tfhd.flags&d.TFHD_FLAG_SAMPLE_FLAGS?c.tfhd.default_sample_flags:u?u.default_sample_flags:0,e=0;e<c.truns.length;e++){var g=c.truns[e];for(i=0;i<g.sample_count;i++){f={},f.number=h.samples.length,c.first_sample_index=h.samples.length,h.samples.push(f),f.track_id=h.tkhd.track_id,f.timescale=h.mdia.mdhd.timescale,f.description_index=r-1,f.description=h.mdia.minf.stbl.stsd.entries[f.description_index],f.size=a,g.flags&d.TRUN_FLAGS_SIZE&&(f.size=g.sample_size[i]),f.duration=n,g.flags&d.TRUN_FLAGS_DURATION&&(f.duration=g.sample_duration[i]),h.first_traf_merged||i>0?f.dts=h.samples[h.samples.length-2].dts+h.samples[h.samples.length-2].duration:(c.tfdt?f.dts=c.tfdt.baseMediaDecodeTime:f.dts=0,h.first_traf_merged=!0),f.cts=f.dts,g.flags&d.TRUN_FLAGS_CTS_OFFSET&&(f.cts=f.dts+g.sample_composition_time_offset[i]),m=s,g.flags&d.TRUN_FLAGS_FLAGS?m=g.sample_flags[i]:0===i&&g.flags&d.TRUN_FLAGS_FIRST_FLAG&&(m=g.first_sample_flags),f.is_rap=!(m>>16&1);var b=!!(c.tfhd.flags&d.TFHD_FLAG_BASE_DATA_OFFSET),y=!!(c.tfhd.flags&d.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),v=!!(g.flags&d.TRUN_FLAGS_DATA_OFFSET),x=0;x=b?c.tfhd.base_data_offset:y||0===e?p.start:o,f.offset=0===e&&0===i?v?x+g.data_offset:x:o,o=f.offset+f.size}}if(c.subs){var _=c.first_sample_index;for(e=0;e<c.subs.samples.length;e++)_+=c.subs.samples[e].sample_delta,f=h.samples[_-1],f.subsamples=c.subs.samples[e].subsamples}}},u.prototype.getSample=function(t,e){var i,n=t.samples[e];if(!this.moov)return null;if(n.data){if(n.alreadyRead==n.size)return n}else n.data=new Uint8Array(n.size),n.alreadyRead=0,this.samplesDataSize+=n.size,r.debug("ISOFile","Allocating sample #"+e+" on track #"+t.tkhd.track_id+" of size "+n.size+" (total: "+this.samplesDataSize+")");var s=this.stream.findPosition(!0,n.offset+n.alreadyRead,!1);if(s>-1){i=this.stream.buffers[s];var o=i.byteLength-(n.offset+n.alreadyRead-i.fileStart);return n.size-n.alreadyRead<=o?(r.debug("ISOFile","Getting sample #"+e+" data (alreadyRead: "+n.alreadyRead+" offset: "+(n.offset+n.alreadyRead-i.fileStart)+" read size: "+(n.size-n.alreadyRead)+" full size: "+n.size+")"),a.memcpy(n.data.buffer,n.alreadyRead,i,n.offset+n.alreadyRead-i.fileStart,n.size-n.alreadyRead),i.usedBytes+=n.size-n.alreadyRead,this.stream.logBufferLevel(),n.alreadyRead=n.size,n):(r.debug("ISOFile","Getting sample #"+e+" partial data (alreadyRead: "+n.alreadyRead+" offset: "+(n.offset+n.alreadyRead-i.fileStart)+" read size: "+o+" full size: "+n.size+")"),a.memcpy(n.data.buffer,n.alreadyRead,i,n.offset+n.alreadyRead-i.fileStart,o),n.alreadyRead+=o,i.usedBytes+=o,this.stream.logBufferLevel(),null)}return null},u.prototype.releaseSample=function(t,e){var i=t.samples[e];return i.data?(this.samplesDataSize-=i.size,i.data=null,i.alreadyRead=0,i.size):0},u.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},u.prototype.getCodecs=function(){var t,e="";for(t=0;t<this.moov.traks.length;t++){var i=this.moov.traks[t];t>0&&(e+=","),e+=i.mdia.minf.stbl.stsd.entries[0].getCodec()}return e},u.prototype.getTrexById=function(t){var e;if(!this.moov||!this.moov.mvex)return null;for(e=0;e<this.moov.mvex.trexs.length;e++){var i=this.moov.mvex.trexs[e];if(i.track_id==t)return i}return null},u.prototype.getTrackById=function(t){if(void 0===this.moov)return null;for(var e=0;e<this.moov.traks.length;e++){var i=this.moov.traks[e];if(i.tkhd.track_id==t)return i}return null},u.prototype.items=[],u.prototype.itemsDataSize=0,u.prototype.flattenItemInfo=function(){var t,e,i,n=this.items,a=this.meta;if(null!==a&&void 0!==a&&void 0!==a.hdlr&&void 0!==a.iinf){for(t=0;t<a.iinf.item_infos.length;t++)i={},i.id=a.iinf.item_infos[t].item_ID,n[i.id]=i,i.ref_to=[],i.name=a.iinf.item_infos[t].item_name,a.iinf.item_infos[t].protection_index>0&&(i.protection=a.ipro.protections[a.iinf.item_infos[t].protection_index-1]),a.iinf.item_infos[t].item_type?i.type=a.iinf.item_infos[t].item_type:i.type="mime",i.content_type=a.iinf.item_infos[t].content_type,i.content_encoding=a.iinf.item_infos[t].content_encoding;if(a.iloc)for(t=0;t<a.iloc.items.length;t++){var s=a.iloc.items[t];if(i=n[s.item_ID],0!==s.data_reference_index&&(r.warn("Item storage with reference to other files: not supported"),i.source=a.dinf.boxes[s.data_reference_index-1]),void 0!==s.construction_method)switch(r.warn("Item storage with construction_method : not supported"),s.construction_method){case 0:break;case 1:break;case 2:break}else for(i.extents=[],i.size=0,e=0;e<s.extents.length;e++)i.extents[e]={},i.extents[e].offset=s.extents[e].extent_offset+s.base_offset,i.extents[e].length=s.extents[e].extent_length,i.extents[e].alreadyRead=0,i.size+=i.extents[e].length}if(a.pitm&&(n[a.pitm.item_id].primary=!0),a.iref)for(t=0;t<a.iref.references.length;t++){var o=a.iref.references[t];for(e=0;e<o.references.length;e++)n[o.from_item_ID].ref_to.push({type:o.type,id:o.references[e]})}}},u.prototype.getItem=function(t){var e,i;if(!this.meta)return null;if(i=this.items[t],!i.data&&i.size)i.data=new Uint8Array(i.size),i.alreadyRead=0,this.itemsDataSize+=i.size,r.debug("ISOFile","Allocating item #"+t+" of size "+i.size+" (total: "+this.itemsDataSize+")");else if(i.alreadyRead===i.size)return i;for(var n=0;n<i.extents.length;n++){var s=i.extents[n];if(s.alreadyRead!==s.length){var o=this.stream.findPosition(!0,s.offset+s.alreadyRead,!1);if(!(o>-1))return null;e=this.stream.buffers[o];var l=e.byteLength-(s.offset+s.alreadyRead-e.fileStart);if(!(s.length-s.alreadyRead<=l))return r.debug("ISOFile","Getting item #"+t+" extent #"+n+" partial data (alreadyRead: "+s.alreadyRead+" offset: "+(s.offset+s.alreadyRead-e.fileStart)+" read size: "+l+" full extent size: "+s.length+" full item size: "+i.size+")"),a.memcpy(i.data.buffer,i.alreadyRead,e,s.offset+s.alreadyRead-e.fileStart,l),s.alreadyRead+=l,i.alreadyRead+=l,e.usedBytes+=l,this.stream.logBufferLevel(),null;r.debug("ISOFile","Getting item #"+t+" extent #"+n+" data (alreadyRead: "+s.alreadyRead+" offset: "+(s.offset+s.alreadyRead-e.fileStart)+" read size: "+(s.length-s.alreadyRead)+" full extent size: "+s.length+" full item size: "+i.size+")"),a.memcpy(i.data.buffer,i.alreadyRead,e,s.offset+s.alreadyRead-e.fileStart,s.length-s.alreadyRead),e.usedBytes+=s.length-s.alreadyRead,this.stream.logBufferLevel(),s.alreadyRead=s.length,i.alreadyRead+=s.length}}return i.alreadyRead===i.size?i:null},u.prototype.releaseItem=function(t){var e=this.items[t];if(e.data){this.itemsDataSize-=e.size,e.data=null,e.alreadyRead=0;for(var i=0;i<e.extents.length;i++){var r=e.extents[i];r.alreadyRead=0}return e.size}return 0},u.prototype.processItems=function(t){for(var e in this.items){var i=this.items[e];this.getItem(i.id),t&&!i.sent&&(t(i),i.sent=!0,i.data=null)}},u.prototype.hasItem=function(t){for(var e in this.items){var i=this.items[e];if(i.name===t)return i.id}return-1},u.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},u.prototype.getPrimaryItem=function(){return this.meta&&this.meta.pitm?this.getItem(this.meta.pitm.item_id):null},u.prototype.write=function(t){for(var e=0;e<this.boxes.length;e++)this.boxes[e].write(t)},u.writeInitializationSegment=function(t,e,i){var n,s;r.debug("ISOFile","Generating initialization segment");var o=new a;for(o.endianness=a.BIG_ENDIAN,t.mvex=new d.mvexBox,t.boxes.push(t.mvex),e&&(t.mvex.mehd=new d.mehdBox,t.mvex.boxes.push(t.mvex.mehd),t.mvex.mehd.fragment_duration=e),n=0;n<t.traks.length;n++)s=new d.trexBox,t.mvex.boxes.push(s),t.mvex.trexs.push(s),s.track_id=t.traks[n].tkhd.track_id,s.default_sample_description_index=1,s.default_sample_duration=i,s.default_sample_size=0,s.default_sample_flags=65536;return t.write(o),o.buffer};var f=function(t){this.inputStream=new o,this.keepMdatData=void 0===t||t,this.inputIsoFile=new u(this.inputStream),this.inputIsoFile.discardMdatData=!this.keepMdatData,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1};f.prototype.setSegmentOptions=function(t,e,i){var r=this.inputIsoFile.getTrackById(t);if(r){var n={};this.fragmentedTracks.push(n),n.id=t,n.user=e,n.trak=r,r.nextSample=0,n.segmentStream=null,n.nb_samples=1e3,n.rapAlignement=!0,i&&(i.nbSamples&&(n.nb_samples=i.nbSamples),i.rapAlignement&&(n.rapAlignement=i.rapAlignement))}},f.prototype.unsetSegmentOptions=function(t){for(var e=-1,i=0;i<this.fragmentedTracks.length;i++){var r=this.fragmentedTracks[i];r.id==t&&(e=i)}e>-1&&this.fragmentedTracks.splice(e,1)},f.prototype.setExtractionOptions=function(t,e,i){var r=this.inputIsoFile.getTrackById(t);if(r){var n={};this.extractedTracks.push(n),n.id=t,n.user=e,n.trak=r,r.nextSample=0,n.nb_samples=1e3,n.samples=[],i&&i.nbSamples&&(n.nb_samples=i.nbSamples)}},f.prototype.unsetExtractionOptions=function(t){for(var e=-1,i=0;i<this.extractedTracks.length;i++){var r=this.extractedTracks[i];r.id==t&&(e=i)}e>-1&&this.extractedTracks.splice(e,1)},f.prototype.createSingleSampleMoof=function(t){var e=new d.moofBox,i=new d.mfhdBox;i.sequence_number=this.nextMoofNumber,this.nextMoofNumber++,e.boxes.push(i);var r=new d.trafBox;e.boxes.push(r);var n=new d.tfhdBox;r.boxes.push(n),n.track_id=t.track_id,n.flags=d.TFHD_FLAG_DEFAULT_BASE_IS_MOOF;var a=new d.tfdtBox;r.boxes.push(a),a.baseMediaDecodeTime=t.dts;var s=new d.trunBox;return r.boxes.push(s),e.trun=s,s.flags=d.TRUN_FLAGS_DATA_OFFSET|d.TRUN_FLAGS_DURATION|d.TRUN_FLAGS_SIZE|d.TRUN_FLAGS_FLAGS|d.TRUN_FLAGS_CTS_OFFSET,s.data_offset=0,s.first_sample_flags=0,s.sample_count=1,s.sample_duration=[],s.sample_duration[0]=t.duration,s.sample_size=[],s.sample_size[0]=t.size,s.sample_flags=[],s.sample_flags[0]=0,s.sample_composition_time_offset=[],s.sample_composition_time_offset[0]=t.cts-t.dts,e},f.prototype.createFragment=function(t,e,i,n){var s=this.inputIsoFile.getTrackById(e),o=this.inputIsoFile.getSample(s,i);if(null==o)return o=s.samples[i],this.nextSeekPosition?this.nextSeekPosition=Math.min(o.offset+o.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=s.samples[i].offset+o.alreadyRead,null;var l=n||new a;l.endianness=a.BIG_ENDIAN;var p=this.createSingleSampleMoof(o);p.write(l),p.trun.data_offset=p.size+8,r.debug("MP4Box","Adjusting data_offset with new value "+p.trun.data_offset),l.adjustUint32(p.trun.data_offset_position,p.trun.data_offset);var c=new d.mdatBox;return c.data=o.data,c.write(l),l},f.prototype.processSamples=function(){var t,e;if(this.sampleProcessingStarted){if(this.isFragmentationInitialized&&null!==this.onSegment)for(t=0;t<this.fragmentedTracks.length;t++){var i=this.fragmentedTracks[t];e=i.trak;while(e.nextSample<e.samples.length&&this.sampleProcessingStarted){r.debug("MP4Box","Creating media fragment on track #"+i.id+" for sample "+e.nextSample);var n=this.createFragment(this.inputIsoFile,i.id,e.nextSample,i.segmentStream);if(!n)break;if(i.segmentStream=n,e.nextSample++,(e.nextSample%i.nb_samples===0||e.nextSample>=e.samples.length)&&(r.info("MP4Box","Sending fragmented data on track #"+i.id+" for samples ["+Math.max(0,e.nextSample-i.nb_samples)+","+(e.nextSample-1)+"]"),r.info("MP4Box","Sample data size in memory: "+this.inputIsoFile.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(i.id,i.user,i.segmentStream.buffer,e.nextSample),i.segmentStream=null,i!==this.fragmentedTracks[t]))break}}if(null!==this.onSamples)for(t=0;t<this.extractedTracks.length;t++){var a=this.extractedTracks[t];e=a.trak;while(e.nextSample<e.samples.length&&this.sampleProcessingStarted){r.debug("MP4Box","Exporting on track #"+a.id+" sample #"+e.nextSample);var s=this.inputIsoFile.getSample(e,e.nextSample);if(!s)break;if(e.nextSample++,a.samples.push(s),(e.nextSample%a.nb_samples===0||e.nextSample>=e.samples.length)&&(r.debug("MP4Box","Sending samples on track #"+a.id+" for sample "+e.nextSample),this.onSamples&&this.onSamples(a.id,a.user,a.samples),a.samples=[],a!==this.extractedTracks[t]))break}}}},f.prototype.checkBuffer=function(t){if(null===t||void 0===t)throw"Buffer must be defined and non empty";if(void 0===t.fileStart)throw"Buffer must have a fileStart property";return 0===t.byteLength?(r.warn("MP4Box","Ignoring empty buffer (fileStart: "+t.fileStart+")"),this.inputStream.logBufferLevel(),!1):(r.info("MP4Box","Processing buffer (fileStart: "+t.fileStart+")"),t.usedBytes=0,this.inputStream.insertBuffer(t),this.inputStream.logBufferLevel(),!!this.inputStream.initialized()||(r.warn("MP4Box","Not ready to start parsing"),!1))},f.prototype.appendBuffer=function(t){var e;if(!this.checkBuffer||this.checkBuffer(t))return this.inputIsoFile.parse(),this.inputIsoFile.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.inputIsoFile.moov?(this.processSamples&&(this.sampleListBuilt||(this.inputIsoFile.buildSampleLists(),this.sampleListBuilt=!0),this.inputIsoFile.updateSampleLists()),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples&&this.processSamples(),this.nextSeekPosition?(e=this.nextSeekPosition,this.nextSeekPosition=void 0):e=this.inputIsoFile.nextParsePosition,this.inputStream.getEndFilePositionAfter&&(e=this.inputStream.getEndFilePositionAfter(e))):e=null!==this.inputIsoFile?this.inputIsoFile.nextParsePosition:0,this.inputIsoFile.meta&&(this.inputIsoFile.flattenItemInfo&&!this.itemListBuilt&&(this.inputIsoFile.flattenItemInfo(),this.itemListBuilt=!0),this.inputIsoFile.processItems&&this.inputIsoFile.processItems(this.onItem)),this.inputStream.cleanBuffers&&(r.info("MP4Box","Done processing buffer (fileStart: "+t.fileStart+") - next buffer to fetch should have a fileStart position of "+e),this.inputStream.logBufferLevel(),this.inputStream.cleanBuffers(),this.inputStream.logBufferLevel(!0),r.info("MP4Box","Sample data size in memory: "+this.inputIsoFile.getAllocatedSampleDataSize())),e},f.prototype.getInfo=function(){var t,e,i,r,n,a={},s=new Date(4,0,1,0,0,0,0).getTime();if(this.inputIsoFile.moov)for(a.hasMoov=!0,a.duration=this.inputIsoFile.moov.mvhd.duration,a.timescale=this.inputIsoFile.moov.mvhd.timescale,a.isFragmented=null!=this.inputIsoFile.moov.mvex,a.isFragmented&&this.inputIsoFile.moov.mvex.mehd?a.fragment_duration=this.inputIsoFile.moov.mvex.mehd.fragment_duration:a.fragment_duration=0,a.isProgressive=this.inputIsoFile.isProgressive,a.hasIOD=null!=this.inputIsoFile.moov.iods,a.brands=[],a.brands.push(this.inputIsoFile.ftyp.major_brand),a.brands=a.brands.concat(this.inputIsoFile.ftyp.compatible_brands),a.created=new Date(s+1e3*this.inputIsoFile.moov.mvhd.creation_time),a.modified=new Date(s+1e3*this.inputIsoFile.moov.mvhd.modification_time),a.tracks=[],a.audioTracks=[],a.videoTracks=[],a.subtitleTracks=[],a.metadataTracks=[],a.hintTracks=[],a.otherTracks=[],t=0;t<this.inputIsoFile.moov.traks.length;t++){if(i=this.inputIsoFile.moov.traks[t],n=i.mdia.minf.stbl.stsd.entries[0],r={},a.tracks.push(r),r.id=i.tkhd.track_id,r.references=[],i.tref)for(e=0;e<i.tref.boxes.length;e++)ref={},r.references.push(ref),ref.type=i.tref.boxes[e].type,ref.track_ids=i.tref.boxes[e].track_ids;for(r.created=new Date(s+1e3*i.tkhd.creation_time),r.modified=new Date(s+1e3*i.tkhd.modification_time),r.movie_duration=i.tkhd.duration,r.layer=i.tkhd.layer,r.alternate_group=i.tkhd.alternate_group,r.volume=i.tkhd.volume,r.matrix=i.tkhd.matrix,r.track_width=i.tkhd.width/65536,r.track_height=i.tkhd.height/65536,r.timescale=i.mdia.mdhd.timescale,r.duration=i.mdia.mdhd.duration,r.codec=n.getCodec(),r.kind=i.udta&&i.udta.kinds.length?i.udta.kinds[0]:{schemeURI:"",value:""},r.language=i.mdia.elng?i.mdia.elng.extended_language:i.mdia.mdhd.languageString,r.nb_samples=i.samples.length,r.size=0,e=0;e<r.nb_samples;e++)r.size+=i.samples[e].size;r.bitrate=8*r.size*r.timescale/r.duration,n.isAudio()?(a.audioTracks.push(r),r.audio={},r.audio.sample_rate=n.getSampleRate(),r.audio.channel_count=n.getChannelCount(),r.audio.sample_size=n.getSampleSize()):n.isVideo()?(a.videoTracks.push(r),r.video={},r.video.width=n.getWidth(),r.video.height=n.getHeight()):n.isSubtitle()?a.subtitleTracks.push(r):n.isHint()?a.hintTracks.push(r):n.isMetadata()?a.metadataTracks.push(r):a.otherTracks.push(r)}else a.hasMoov=!1;return a},f.prototype.writeFile=function(){var t=new a;return t.endianness=a.BIG_ENDIAN,this.inputIsoFile.write(t),t.buffer},f.prototype.initializeSegmentation=function(){var t,e,i,n;for(null===this.onSegment&&r.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.inputIsoFile.resetTables()),e=[],t=0;t<this.fragmentedTracks.length;t++){var a=new d.moovBox;a.mvhd=this.inputIsoFile.moov.mvhd,a.boxes.push(a.mvhd),i=this.inputIsoFile.getTrackById(this.fragmentedTracks[t].id),a.boxes.push(i),a.traks.push(i),n={},n.id=i.tkhd.track_id,n.user=this.fragmentedTracks[t].user,n.buffer=u.writeInitializationSegment(a,this.inputIsoFile.moov.mvex&&this.inputIsoFile.moov.mvex.mehd?this.inputIsoFile.moov.mvex.mehd.fragment_duration:void 0,this.inputIsoFile.moov.traks[t].samples.length>0?this.inputIsoFile.moov.traks[t].samples[0].duration:0),e.push(n)}return e},f.prototype.releaseUsedSamples=function(t,e){var i=0,n=this.inputIsoFile.getTrackById(t);n.lastValidSample||(n.lastValidSample=0);for(var a=n.lastValidSample;a<e;a++)i+=this.inputIsoFile.releaseSample(n,a);r.info("MP4Box","Track #"+t+" released samples up to "+e+" (released size: "+i+", remaining: "+this.inputIsoFile.samplesDataSize+")"),n.lastValidSample=e},f.prototype.flush=function(){r.info("MP4Box","Flushing remaining samples"),this.inputIsoFile.updateSampleLists(),this.processSamples(),this.inputStream.cleanBuffers(),this.inputStream.logBufferLevel(!0)},f.prototype.seekTrack=function(t,e,i){var n,a,s,o=1/0,l=0,d=0;if(0===i.samples.length)return r.info("MP4Box","No sample in track, cannot seek! Using time "+r.getDurationString(0,1)+" and offset: 0"),{offset:0,time:0};for(n=0;n<i.samples.length;n++){if(a=i.samples[n],0===n)d=0,s=a.timescale;else if(a.cts>t*a.timescale){d=n-1;break}e&&a.is_rap&&(l=n)}e&&(d=l),t=i.samples[d].cts,i.nextSample=d;while(i.samples[d].alreadyRead===i.samples[d].size)d++;return o=i.samples[d].offset+i.samples[d].alreadyRead,r.info("MP4Box","Seeking to "+(e?"RAP":"")+" sample #"+i.nextSample+" on track "+i.tkhd.track_id+", time "+r.getDurationString(t,s)+" and offset: "+o),{offset:o,time:t/s}},f.prototype.seek=function(t,e){var i,n,a,s=this.inputIsoFile.moov,o={offset:1/0,time:1/0};if(this.inputIsoFile.moov){for(a=0;a<s.traks.length;a++)i=s.traks[a],n=this.seekTrack(t,e,i),n.offset<o.offset&&(o.offset=n.offset),n.time<o.time&&(o.time=n.time);return r.info("MP4Box","Seeking at time "+r.getDurationString(o.time,1)+" needs a buffer with a fileStart position of "+o.offset),o.offset===1/0?o={offset:this.inputIsoFile.nextParsePosition,time:0}:o.offset=this.inputStream.getEndFilePositionAfter(o.offset),r.info("MP4Box","Adjusted seek position (after checking data already in buffer): "+o.offset),o}throw"Cannot seek: moov not received!"},f.prototype.getTrackSamplesInfo=function(t){var e=this.inputIsoFile.getTrackById(t);return e?e.samples:void 0},f.prototype.getTrackSample=function(t,e){var i=this.inputIsoFile.getTrackById(t),r=this.inputIsoFile.getSample(i,e);return r},f.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples()},f.prototype.stop=function(){this.sampleProcessingStarted=!1},e.MP4Box=f},"0413":function(t,e,i){"use strict";var r=i("1b99"),n=i.n(r);n.a},"09db":function(t,e,i){"use strict";var r=i("2120"),n=i.n(r);n.a},"0bb1":function(t,e,i){},"0c6f":function(t,e,i){"use strict";var r=i("40ad"),n=i.n(r);n.a},"11e9":function(t,e,i){"use strict";var r=i("2497"),n=i("bc3a"),a=i.n(n),s=i("c596");e["a"]={getCommodityList:function(t,e,i){a.a.get(s["g"].commodity.getCommodityList,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},delete:function(t,e,i){a.a.delete(s["g"].commodity.delete,{data:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},query:function(t,e,i){a.a.get(s["g"].commodity.query,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},soldoutAndPutaway:function(t,e,i){a.a.post(s["g"].commodity.soldoutAndPutaway,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},cloneProduct:function(t,e,i){a.a.post(s["g"].commodity.cloneProduct,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},queryPlatformCategoryTree:function(t,e,i){a.a.get(s["g"].commodity.queryPlatformCategoryTree,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},queryPlatformImportInfo:function(t,e,i){a.a.get(s["g"].commodity.queryPlatformImportInfo,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},importPlatformProduct:function(t,e,i){a.a.post(s["g"].commodity.importPlatformProduct,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},audit:function(t,e,i){a.a.post(s["g"].commodity.audit,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},auditTarget:function(t,e,i){a.a.post(s["g"].commodity.auditTarget,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},recallProduct:function(t,e,i){a.a.get(s["g"].commodity.recallProduct,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},queryFilters:function(t,e,i){a.a.get(s["g"].commodity.queryFilters,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))}}},1370:function(t,e,i){},"1b99":function(t,e,i){},2120:function(t,e,i){},2299:function(t,e,i){"use strict";var r=i("2497"),n=i("bc3a"),a=i.n(n),s=i("c596");e["a"]={getImageGroups:function(t,e,i){a.a.get(s["g"].commodity.getImageGroups,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateImageGroups:function(t,e,i){a.a.put(s["g"].commodity.updateImageGroups,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateProductVrMediaBath:function(t,e,i){a.a.put(s["g"].commodity.updateProductVrMediaBath,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},getImageGroups_pm:function(t,e,i){a.a.get(s["g"].commodity.getImageGroups_pm,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateImageGroups_pm:function(t,e,i){a.a.put(s["g"].commodity.updateImageGroups_pm,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateProductVrMediaBath_pm:function(t,e,i){a.a.put(s["g"].commodity.updateProductVrMediaBath_pm,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))}}},2497:function(t,e,i){"use strict";var r=i("4360"),n=i("a18c");e["a"]=function(t,e){return function(i){var a=i.data;"100"===a.resultCode?t(a):"709"===a.resultCode?(r["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",r["a"].getters.currentUser),n["a"].push("/login")):e(a)}}},"25c2":function(t,e,i){},"25eb":function(t,e,i){var r=i("23e7"),n=i("c20d");r({target:"Number",stat:!0,forced:Number.parseInt!=n},{parseInt:n})},2753:function(t,e,i){"use strict";var r=i("c846"),n=i.n(r);n.a},"2c90":function(t,e,i){},"392e":function(t,e,i){"use strict";var r=i("2497"),n=i("bc3a"),a=i.n(n),s=i("c596");e["a"]={queryProductBasicInfo:function(t,e,i){a.a.get(s["g"].commodity.queryProductBasicInfo,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateProductBasicInfo:function(t,e,i){a.a.put(s["g"].commodity.updateProductBasicInfo,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},creatProductBasicInfo:function(t,e,i){a.a.post(s["g"].commodity.creatProductBasicInfo,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},creatBenefitsBasicInfo:function(t,e,i){a.a.post("/admin/shopProduct/benefitsProduct/basicInfo.jhtml",t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},queryProductDetail:function(t,e,i){a.a.get(s["g"].commodity.queryProductDetail,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateProductDetail:function(t,e,i){a.a.put(s["g"].commodity.queryProductDetail,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},queryProductDetail_pm:function(t,e,i){a.a.get(s["g"].commodity.queryProductDetail_pm,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateProductDetail_pm:function(t,e,i){a.a.put(s["g"].commodity.updateProductDetail_pm,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))}}},"40ad":function(t,e,i){},"40ae":function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"biz-editor",style:t.style},[i("div",{staticStyle:{display:"none"}},[i("el-upload",{ref:"imageUploader",attrs:{multiple:"",accept:"image/*",action:t.serverUrl,"show-file-list":!1,name:"file",data:t.fileData0,"on-success":t.uploadSuccess}}),i("el-upload",{ref:"videoUploader",attrs:{accept:"video/*",action:t.serverUrl,"show-file-list":!1,name:"file",data:t.fileData3,"before-upload":t.beforeUpload,"on-progress":t.handleProgress,"on-success":t.uploadSuccess}}),i("video",{ref:"videoTool"})],1),i("toolbar",{ref:"toolbar",class:{disabledStyle:t.disabled},attrs:{toolbars:t.toolbars},on:{"on-editor-execCommand":t.execCommand}}),0!==t.percentage?i("el-progress",{attrs:{slot:"header","text-inside":!0,"stroke-width":18,percentage:t.percentage},slot:"header"}):t._e(),i("editor-body",{attrs:{canPaste:t.canPaste,value:t.value,height:t.height,width:t.width,config:t.config,disabled:t.disabled},on:{input:t.onInput,ready:t.init}})],1)},n=[],a=(i("99af"),i("c975"),i("a15b"),i("baa5"),i("b0c0"),i("a9e3"),i("25eb"),i("d3b7"),i("b85c")),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editor-body",style:t.style},[i("div",{attrs:{id:t.id}})])},o=[],l=(i("4160"),i("fb6a"),i("b64b"),i("4d63"),i("ac1f"),i("25f0"),i("466d"),i("5319"),i("159b"),i("96cf"),i("1da1")),d=i("d4ec"),p=i("bee2"),c=i("1ab1"),h=function(){function t(){Object(d["a"])(this,t),this.listeners={}}return Object(p["a"])(t,[{key:"on",value:function(t,e){void 0===this.listeners[t]&&(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"emit",value:function(t){this.listeners[t]&&this.listeners[t].forEach((function(t){return t()}))}}]),t}(),u={name:"UeditorWrap",data:function(){return{imgList:[],reg:new RegExp(/<img [^>]* src=['"](http[s]*:\/\/[^'"]+)[^>]*>/g,"i"),id:"editor"+Math.random().toString().slice(-10),editor:null,status:0,initValue:"",defaultConfig:{toolbars:[],initialFrameWidth:null,autoHeightEnabled:!1,initialFrameHeight:300,enableAutoSave:!1,wordCount:!1,elementPathEnabled:!1,scaleEnabled:!1,UEDITOR_HOME_URL:"./static/ueditorh/"}}},props:{canPaste:{type:Boolean,default:function(){return!0}},value:{type:String,default:""},config:{type:Object,default:function(){return{}}},height:{type:String},width:{type:String},toolbar:{type:Array,default:function(){return[]}},disabled:{type:Boolean,defualt:function(){return!1}}},components:{},computed:{mixedConfig:function(){return Object.assign({},this.defaultConfig,this.config)},style:function(){var t={};return this.height&&(t.height=this.height),this.width&&(t.width=this.width),t}},methods:{initEditor:function(){var t=this;this.$nextTick((function(){t.editor=window.UE.getEditor(t.id,t.mixedConfig),t.editor.addListener("ready",(function(){t.status=2,t.editor.setContent(t.initValue),t.$emit("ready",t.editor),t.editor.addListener("contentChange",(function(){t.$emit("input",t.editor.getContent())})),t.editor.addListener("beforepaste",function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(i,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.canPaste||(r.html=""),setTimeout((function(){t.getImgList()}),50);case 2:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}())}))}))},checkDependencies:function(){var t=this;return new Promise((function(e,i){var r=!!window.UE&&!!window.UEDITOR_CONFIG&&0!==Object.keys(window.UEDITOR_CONFIG).length&&!!window.UE.getEditor;r?e():window.loadEnv?window.loadEnv.on("scriptsLoaded",(function(){e()})):(window.loadEnv=new h,t.loadConfig().then((function(){return t.loadCore()})).then((function(){e(),window.loadEnv.emit("scriptsLoaded")})))}))},loadConfig:function(){var t=this;return new Promise((function(e,i){if(window.UE&&window.UEDITOR_CONFIG&&0!==Object.keys(window.UEDITOR_CONFIG).length)e();else{var r=document.createElement("script");r.type="text/javascript",r.src=t.mixedConfig.UEDITOR_HOME_URL+"ueditor.config.js",document.getElementsByTagName("head")[0].appendChild(r),r.onload=function(){window.UE&&window.UEDITOR_CONFIG&&0!==Object.keys(window.UEDITOR_CONFIG).length?e():console.error("加载ueditor.config.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!\n",r.src)}}}))},loadCore:function(){var t=this;return new Promise((function(e,i){if(window.UE&&window.UE.getEditor)e();else{var r=document.createElement("script");r.type="text/javascript",r.src=t.mixedConfig.UEDITOR_HOME_URL+"ueditor.all.min.js",document.getElementsByTagName("head")[0].appendChild(r),r.onload=function(){window.UE&&window.UE.getEditor?e():console.error("加载ueditor.all.min.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!\n",r.src)}}}))},setContent:function(t){t===this.editor.getContent()||this.editor.setContent(t)},getImgList:function(){var t=this.editor.getContent(),e=/<img[^>]* src=['"](http[s]*:\/\/[^'"]+)[^>]*>/g;this.imgList=t.match(e)||[]},setNewImg:function(t){var e=this,i=t.match(/src=['"]?([^'"]*)['"]?/i)[1];i=i.replace(/(\?|#)[^'"]*/,"");var r={url:i};c["a"].post("/admin/file/downloadFromNet.jhtml",r).then((function(i){var r=e.editor.getContent();r=r.replace(t,'<img src="'.concat(i.path,'" style="max-width: 100%;">')),e.$emit("input",r)}))}},beforeDestroy:function(){this.editor&&this.editor.destroy&&this.editor.destroy()},watch:{value:{handler:function(t){var e=this;switch(this.status){case 0:this.status=1,this.initValue=t,this.checkDependencies().then((function(){return e.initEditor()}));break;case 1:this.initValue=t;break;case 2:this.setContent(t),setTimeout((function(){e.getImgList()}),50);break;default:break}},immediate:!0},imgList:function(t){var e,i=Object(a["a"])(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.setNewImg(r)}}catch(n){i.e(n)}finally{i.f()}},disabled:function(t){t?this.editor.setDisabled():this.editor.setEnabled()}}},f=u,m=(i("c708"),i("2877")),g=Object(m["a"])(f,s,o,!1,null,null,null),b=g.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"biz-editor-toolbar"},t._l(t.toolbars,(function(e,r){return i("div",{key:r,staticClass:"toolbar-row"},t._l(e,(function(e,n){return i("div",{key:n,staticClass:"toolitem"},["toolbtn"===e.type?i("ToolButton",{attrs:{toolbar:e},on:{"on-toolbutton-click":t.handleButtonClick}}):t._e(),"toolcolorpicker"===e.type?i("ToolColorPicker",{ref:"picker",refInFor:!0,attrs:{toolbar:e},on:{"on-toolpicker-click":t.handleButtonClick}}):t._e(),"toolselect"===e.type?i("ToolSelect",{ref:"picker",refInFor:!0,attrs:{toolbar:e},on:{"on-toolselect-click":t.handleButtonClick}}):t._e(),"toolinput"===e.type?i("ToolInput",{ref:"inputPicker",refInFor:!0,attrs:{toolbar:e},on:{"on-toolinput-click":t.handleButtonClick}}):t._e(),"separator"===e.type?i("span",{key:r+"|"+n,staticClass:"toolseparator"}):t._e()],1)})),0)})),0)},v=[],x={bind:function(t,e,i){function r(i){if(t.contains(i.target))return!1;e.expression&&e.value(i)}t.__vueClickOutside__=r,document.addEventListener("click",r)},update:function(){},unbind:function(t,e){document.removeEventListener("click",t.__vueClickOutside__),delete t.__vueClickOutside__}},_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.onListHide,expression:"onListHide"}],class:"editor-toolbar-input toolbar-input-"+t.toolbar.name},[i("el-tooltip",{attrs:{"popper-class":"euditor-tip",effect:"dark",content:t.toolbar.title,placement:"top",enterable:!1}},[i("div",{staticClass:"btn-c",on:{click:t.onListShow}},[i("input",{ref:"input",staticClass:"edui-input",attrs:{type:"text"},domProps:{value:t.toolbar.value},on:{blur:t.checkInput,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.blur(e)}}}),i("div",{staticClass:"edui-button edui-select"},[i("i",{staticClass:"triangle"})])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"edui-toolbar-selectlist"},[i("ul",t._l(t.options,(function(e,r){return i("li",{key:r,on:{click:function(i){return t.onSelect(e.value)}}},[e.value==t.toolbar.value?i("i",{staticClass:"el-icon-check"}):t._e(),i("span",[t._v(t._s(e.label))])])})),0)])],1)},w=[],S={name:"EToolInput",props:{toolbar:Object},directives:{clickoutside:x},components:{},data:function(){return{visible:!1,options:[{label:"10px",value:"10px"},{label:"11px",value:"11px"},{label:"12px",value:"12px"},{label:"14px",value:"14px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"24px",value:"24px"},{label:"36px",value:"36px"}]}},methods:{onListShow:function(){this.visible=!this.visible},onListHide:function(){this.visible=!1},onSelect:function(t){this.$emit("on-toolinput-click",this.toolbar.name,t),this.onListHide()},checkInput:function(t){var e=t.target.value;this.$emit("on-toolinput-click",this.toolbar.name,e),this.onListHide()},blur:function(){this.$refs.input.blur()}}},I=S,U=(i("92cd"),Object(m["a"])(I,_,w,!1,null,null,null)),k=U.exports,z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:"editor-toolbar-btn toolbar-btn-"+t.toolbar.name+t.toolbar.value},[i("el-tooltip",{attrs:{"popper-class":"euditor-tip",effect:"dark",content:t.toolbar.title,placement:"top",enterable:!1}},[i("div",{staticClass:"toolbar-btn",class:{checked:this.checked},attrs:{disabled:t.disabled},on:{click:t.onClick}},[i("i",{staticClass:"weui_edui_icon"})])])],1)},F=[],C={name:"EToolButton",props:{toolbar:Object,imageFloatMask:Boolean},computed:{disabled:function(){return this.toolbar.disabled},checked:function(){return this.toolbar.checked}},methods:{onClick:function(){this.$emit("on-toolbutton-click",this.toolbar.name,this.toolbar.value)}},mounted:function(){}},B=C,D=(i("c820"),Object(m["a"])(B,z,F,!1,null,null,null)),T=D.exports,E=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.onListHide,expression:"onListHide"}],class:"editor-toolbar-select toolbar-select-"+t.toolbar.name},[i("el-tooltip",{attrs:{"popper-class":"euditor-tip",effect:"dark",content:t.toolbar.title,placement:"top",enterable:!1}},[i("div",{staticClass:"btn-c",on:{click:t.onListShow}},[i("div",{staticClass:"edui-button"},[i("i",{staticClass:"edui-toolbar-icon"})]),i("div",{staticClass:"edui-button edui-select"},[i("i",{staticClass:"triangle"})])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"edui-toolbar-selectlist"},[i("ul",t._l(t.options,(function(e,r){return i("li",{key:r,on:{click:function(i){return t.onSelect(e.value)}}},[e.value==t.toolbar.value?i("i",{staticClass:"el-icon-check"}):t._e(),i("span",[t._v(t._s(e.label))])])})),0)])],1)},P=[],M={name:"EToolSelect",props:{toolbar:Object},directives:{clickoutside:x},components:{},data:function(){return{visible:!1}},computed:{options:function(){return"lineheight"===this.toolbar.name?[{label:"1",value:1},{label:"1.5",value:1.5},{label:"1.75",value:1.75},{label:"2",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5}]:"indentboth"===this.toolbar.name?[{label:"无",value:"0px"},{label:"8",value:"8px"},{label:"16",value:"16px"},{label:"32",value:"32px"},{label:"48",value:"48px"}]:[]}},methods:{onListShow:function(){this.visible=!this.visible},onListHide:function(){this.visible=!1},onSelect:function(t){this.onListHide(),this.$emit("on-toolselect-click",this.toolbar.name,t)}}},L=M,A=(i("9056"),Object(m["a"])(L,E,P,!1,null,null,null)),R=A.exports,V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.onListHide,expression:"onListHide"}],class:"editor-toolbar-color-picker toolbar-color-picker-"+t.toolbar.name},[i("el-tooltip",{attrs:{"popper-class":"euditor-tip",effect:"dark",content:t.toolbar.title,placement:"top",enterable:!1}},[i("div",{staticClass:"btn-c",on:{click:t.onListShow}},[i("div",{staticClass:"edui-button"},[i("i",{staticClass:"edui-toolbar-icon"}),i("i",{staticClass:"colorbar",style:{backgroundColor:this.toolbar.value}})]),i("div",{staticClass:"edui-button edui-select"},[i("i",{staticClass:"triangle"})])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"edui-toolpicker-panel"},[i("div",{staticClass:"recent_color color_box"},[i("p",{staticClass:"title"},[t._v("最近使用颜色")]),i("div",{}),i("div",{staticClass:"clear",attrs:{title:"清除颜色"},on:{click:t.removeColor}}),i("div",{staticClass:"item-wrapper"},t._l(t.recentColorList,(function(e,r){return i("div",{key:r,staticClass:"b-item",style:{backgroundColor:e},attrs:{title:e},on:{click:function(i){return t.onSelect(e)}}})})),0)]),i("div",{staticClass:"basic_color color_box"},[i("p",{staticClass:"title"},[t._v("基本色")]),i("div",{staticClass:"item-wrapper"},t._l(t.baseColorList,(function(e,r){return i("div",{key:r,staticClass:"b-item",style:{backgroundColor:e},attrs:{title:e},on:{click:function(i){return t.onSelect(e)}}})})),0)]),i("div",{staticClass:"input_color"},[i("div",{staticClass:"preview",style:{backgroundColor:t.toolbar.value},on:{click:function(e){return t.onSelect("#"+t.toolbar.value)}}}),i("div",{staticClass:"input_wrap"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.toolbar.value,expression:"toolbar.value"}],attrs:{type:"text"},domProps:{value:t.toolbar.value},on:{input:function(e){e.target.composing||t.$set(t.toolbar,"value",e.target.value)}}})]),i("div",{staticClass:"js_ok",on:{click:function(e){return t.onSelect(t.toolbar.value)}}},[t._v("确认")])])])],1)},N=[],O=(i("a434"),{name:"EToolColorPicker",props:{toolbar:Object},directives:{clickoutside:x},components:{},data:function(){return{visible:!1,baseColorList:["#ffffff","#ffd7d5","#ffdaa9","#fffed5","#d4fa00","#73fcd6","#a5c8ff","#ffacd5","#ff7faa","#d6d6d6","#ffacaa","#ffb995","#fffb00","#73fa79","#00fcff","#78acfe","#d84fa9","#ff4f79","#b2b2b2","#d7aba9","#ff6827","#ffda51","#00d100","#00d5ff","#0080ff","#ac39ff","#ff2941","#888888","#7a4442","#ff4c00","#ffa900","#3da742","#3daad6","#0052ff","#7a4fd6","#d92142","#000000","#7b0c00","#ff4c41","#d6a841","#407600","#007aaa","#021eaa","#797baa","#ab1942"]}},computed:{recentColorList:function(){var t=window.localStorage.recentColorList;return t=t?JSON.parse(t):[],t}},methods:{onListShow:function(){this.visible=!0},onListHide:function(){this.visible=!1},removeColor:function(){var t="backcolor"===this.toolbar.name?"background-color":"color";this.$emit("on-toolpicker-click","removeformat","",t),this.toolbar.value="#FFFFFF",this.onListHide()},onSelect:function(t){this.$emit("on-toolpicker-click",this.toolbar.name,t),this.onListHide(),this.storeRecentColor(t)},storeRecentColor:function(t){for(var e=this.recentColorList,i=e.unshift(t),r=1;r<i;r++)if(e[r]===t){e.splice(r,1),i--;break}i>8&&(e.length=9),window.localStorage.recentColorList=JSON.stringify(e)}}}),G=O,H=(i("51a1"),Object(m["a"])(G,V,N,!1,null,null,null)),j=H.exports,W={name:"toolbar-component",components:{ToolInput:k,ToolButton:T,ToolSelect:R,ToolColorPicker:j},directives:{clickoutside:x},props:{listVisible:Boolean,imageFloatMask:Boolean,toolbars:{type:Array,default:function(){return[[{name:"undo",title:"撤销",type:"toolbtn",status:"disabled"},{name:"redo",title:"重做",type:"toolbtn",status:"disabled"},{type:"separator"},{name:"fontsize",title:"字号",type:"toolinput"},{name:"blockquote",title:"引用",type:"toolbtn",status:"checked"},{name:"horizontal",title:"分割线",type:"toolbtn",status:""},{name:"removeformat",title:"清除格式",type:"toolbtn",status:""},{name:"formatmatch",title:"格式刷",type:"toolbtn",status:""},{name:"simpleupload",title:"图片上传",type:"toolbtn",status:""},{name:"insertvideo",title:"视频",type:"toolbtn",status:""}],[{name:"bold",title:"加粗",type:"toolbtn",status:"checked"},{name:"italic",title:"斜体",type:"toolbtn",status:"checked"},{name:"underline",title:"下划线",type:"toolbtn",status:""},{name:"forecolor",title:"字体颜色",type:"toolcolorpicker"},{name:"backcolor",title:"背景色",type:"toolcolorpicker"},{type:"separator"},{name:"indent",title:"首行缩进",type:"toolbtn",status:"checked"},{type:"separator"},{name:"justify",title:"居左对齐",type:"toolbtn",value:"left",status:"checked"},{name:"justify",title:"居中对齐",type:"toolbtn",value:"center",status:"checked"},{name:"justify",title:"居右对齐",type:"toolbtn",value:"right",status:"checked"},{name:"justify",title:"两端对齐",type:"toolbtn",value:"justify",status:"checked"},{type:"separator"},{name:"rowspacing",title:"段前距",type:"toolselect",value:"top"},{name:"rowspacing",title:"段后距",type:"toolselect",value:"bottom"},{name:"lineheight",title:"行间距",type:"toolselect"},{type:"separator"},{name:"orderedlist",title:"有序列表",type:"toolselect",prefix:"insert"},{name:"unorderedlist",title:"无序列表",type:"toolselect",prefix:"insert"},{type:"separator"},{name:"imagefloat",title:"默认",type:"toolbtn",value:"none",status:"checked disabled"},{name:"imagefloat",title:"左浮动",type:"toolbtn",value:"left",status:"checked disabled"},{name:"imagefloat",title:"右浮动",type:"toolbtn",value:"right",status:"checked disabled"},{name:"imagefloat",title:"居中",type:"toolbtn",value:"center",status:"checked disabled"},{name:"insertImage",title:"图片",type:"extra-button"}]]}}},data:function(){return{}},methods:{clearVisible:function(){this.$refs.picker.forEach((function(t){t.onListHide()})),this.$refs.inputPicker.forEach((function(t){t.onListHide()}))},handleButtonClick:function(t,e){this.$emit("on-editor-execCommand",t,e)}}},Z=W,$=(i("6f9b"),Object(m["a"])(Z,y,v,!1,null,null,null)),Y=$.exports,J=i("016c").MP4Box,q={name:"biz-editor",components:{Toolbar:Y,EditorBody:b},props:{value:{type:String,default:""},height:{type:String,default:"300px"},width:{type:String,default:"360px"},hasImage:{type:Boolean,default:function(){return!0}},hasVideo:{type:Boolean,default:function(){return!1}},hasLink:{type:Boolean,default:function(){return!1}},canPaste:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{dataRatio:0,fileData0:{type:"0"},fileData3:{type:"2"},serverUrl:"/admin/file/uploads.jhtml",percentage:0,editor:null,isImage:!1,toolbarsData:[[{name:"fontsize",title:"字号",type:"toolinput",value:"16px"},{name:"bold",title:"加粗",type:"toolbtn",value:"",checked:!1},{name:"italic",title:"斜体",type:"toolbtn",value:"",checked:!1},{name:"underline",title:"下划线",type:"toolbtn",value:"",checked:!1},{type:"separator"},{name:"forecolor",title:"字体颜色",type:"toolcolorpicker",value:"#000000",visible:!0},{name:"backcolor",title:"背景色",type:"toolcolorpicker",value:"#FFFFFF",visible:!0}],[{name:"indent",title:"首行缩进",type:"toolbtn",value:"",checked:!1},{name:"indentboth",title:"两端缩进",type:"toolselect",label:"无",value:"0px"},{name:"justify",title:"居左对齐",type:"toolbtn",value:"left",checked:!1},{name:"justify",title:"居中对齐",type:"toolbtn",value:"center",checked:!1},{name:"justify",title:"居右对齐",type:"toolbtn",value:"right",checked:!1},{name:"justify",title:"两端对齐",type:"toolbtn",value:"justify",checked:!1},{name:"lineheight",title:"行间距",type:"toolselect",label:"1",value:1}]]}},computed:{config:function(){var t={};return t.initialFrameHeight=parseInt(this.height),t},style:function(){var t={};return this.width&&(-1!==this.width.indexOf("%")?t.width=this.width:t.width=parseInt(this.width)+2+"px"),t},toolbars:function(){var t=this.toolbarsData;return this.hasImage&&t[0].push({name:"uploadimage",title:"图片",type:"toolbtn",value:"",checked:!1}),this.hasVideo&&t[0].push({name:"uploadvideo",title:"视频",type:"toolbtn",value:"",checked:!1}),this.hasLink&&t[0].push({name:"link",title:"超链接",type:"toolbtn",value:"",checked:!1}),t}},watch:{},created:function(){},methods:{init:function(t){this.editor=t,this.editor.addListener("selectionchange",this.onSelectionChange),this.onFocus()},onFocus:function(){this.editor.addListener("focus",function(){console.log("focus"),this.$refs.toolbar.clearVisible()}.bind(this)),this.editor.addListener("blur",function(){console.log("blur"),this.$refs.toolbar.clearVisible()}.bind(this))},execCommand:function(t,e){"uploadimage"===t?(this.isImage=!0,this.$refs.imageUploader.$refs["upload-inner"].$refs.input.click()):"uploadvideo"===t?(this.isImage=!1,this.$refs.videoUploader.$refs["upload-inner"].$refs.input.click()):"link"===t?this.$emit("openLink"):this.editor.execCommand(t,e)},execCommandLink:function(t){this.editor.execCommand("link",{href:t})},onInput:function(t){this.$emit("input",t)},onSelectionChange:function(){var t,e=Object(a["a"])(this.toolbars);try{for(e.s();!(t=e.n()).done;){var i,r=t.value,n=Object(a["a"])(r);try{for(n.s();!(i=n.n()).done;){var s=i.value,o=["bold","italic","underline","indent"];if(-1!==o.indexOf(s.name)){var l=this.editor.queryCommandState(s.name);s.checked=1===l||!0===l}var d=["justify"];if(-1!==d.indexOf(s.name)){var p=this.editor.queryCommandValue(s.name);s.checked=!1,s.value===p&&(s.checked=!0)}var c=["forecolor","backcolor","lineheight","fontsize","indentboth"];if(-1!==c.indexOf(s.name)){var h=this.editor.queryCommandValue(s.name);s.value=h}}}catch(u){n.e(u)}finally{n.f()}}}catch(u){e.e(u)}finally{e.f()}},beforeUpload:function(t){var e=this;return t.size/1024/1024>100?(this.$emit("video-oversize",{message:"视频文件过大，最大支持100M",type:"warning"}),!1):"video/ogg"===t.type||"video/webm"===t.type||("video/mp4"===t.type?new Promise((function(i,r){var n="MediaSource"in window,a=function(t){for(var r=[],a=0;a<t.tracks.length;++a)r.push(t.tracks[a].codec);if(n){var s='video/mp4; codecs="'+r.join(", ")+'"';MediaSource.isTypeSupported(s)?i(!0):e.$emit("video-wrong-format",{message:"视频格式不支持,仅支持ogg、webm和部分mp4",type:"warning"})}},s=new FileReader;s.readAsDataURL(t),s.addEventListener("load",(function(){var t=s.result;e.$refs.videoTool.src=t,e.$refs.videoTool.addEventListener("loadedmetadata",(function(){var t=e.$refs.videoTool.videoWidth/e.$refs.videoTool.videoHeight;e.dataRatio=t<1.33?1.33:t}))}));var o=new FileReader;o.readAsArrayBuffer(t),o.addEventListener("loadend",(function(){var t=o.result;t.fileStart=0;var e=new J;e.onReady=a,e.appendBuffer(t)}))})):(this.$emit("video-wrong-format",{message:"视频格式不支持,仅支持ogg、webm和部分mp4",type:"warning"}),!1))},handleProgress:function(t){this.percentage=Number.parseInt(t.percent)},uploadSuccess:function(t,e){this.isImage?this.editor.execCommand("inserthtml",'<img src="'.concat(t.fis[0].url,'" style="max-width: 100%;">')):(this.percentage=0,this.imsertVideo(t))},imsertVideo:function(t){var e=t.fis[0].url.substring(0,t.fis[0].url.lastIndexOf("."))+".jpg",i='<p style="display: none;">0</p></p><p><video poster="'.concat(e,'" style="width:100%;" controls ><source type="video/mp4" src="').concat(t.fis[0].url,'" ></video></p>');this.editor.execCommand("inserthtml",i)}}},X=q,Q=(i("6e0b"),Object(m["a"])(X,r,n,!1,null,null,null)),K=Q.exports,tt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"biz-eidtor-template",style:t.templateStyle},[i("el-menu",{attrs:{"default-active":"0"},on:{select:t.handleSelect}},[i("el-menu-item",{attrs:{index:"0"}},[i("template",{slot:"title"},[i("span",[t._v("样式")])])],2),i("el-menu-item",{attrs:{index:"1"}},[i("template",{slot:"title"},[i("span",[t._v("模板")])])],2)],1),"0"===t.selectedNav?i("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[i("el-tab-pane",{attrs:{label:"标题",name:"first"}},t._l(t.styleTitles,(function(e){return i("div",{key:e.index,staticClass:"tab-item",domProps:{innerHTML:t._s(e)},on:{click:function(i){return t.templateSelect(e)}}})})),0),i("el-tab-pane",{attrs:{label:"正文",name:"second"}},t._l(t.styleContents,(function(e){return i("div",{key:e.index,staticClass:"tab-item",domProps:{innerHTML:t._s(e)},on:{click:function(i){return t.templateSelect(e)}}})})),0),i("el-tab-pane",{attrs:{label:"引导",name:"third"}},t._l(t.styleGuides,(function(e){return i("div",{key:e.index,staticClass:"tab-item",domProps:{innerHTML:t._s(e)},on:{click:function(i){return t.templateSelect(e)}}})})),0),i("el-tab-pane",{attrs:{label:"图文",name:"fourth"}},t._l(t.styleImgs,(function(e){return i("div",{key:e.index,staticClass:"tab-item",domProps:{innerHTML:t._s(e)},on:{click:function(i){return t.templateSelect(e)}}})})),0),i("el-tab-pane",{attrs:{label:"布局",name:"fifth"}},t._l(t.styleLayouts,(function(e){return i("div",{key:e.index,staticClass:"tab-item",domProps:{innerHTML:t._s(e)},on:{click:function(i){return t.templateSelect(e)}}})})),0),i("el-tab-pane",{attrs:{label:"行业",name:"sixth"}},t._l(t.styleTrades,(function(e){return i("div",{key:e.index,staticClass:"tab-item",domProps:{innerHTML:t._s(e)},on:{click:function(i){return t.templateSelect(e)}}})})),0)],1):t._e(),"1"===t.selectedNav?i("div",[t._m(0),i("div",{staticClass:"el-tabs__content"},t._l(t.templates,(function(e){return i("div",{key:e.index,staticClass:"tab-item",domProps:{innerHTML:t._s(e)},on:{click:function(i){return t.templateSelect(e)}}})})),0)]):t._e()],1)},et=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"el-tabs__header is-top"},[i("div",{staticClass:"el-tabs__nav-wrap is-top"},[i("div",{staticClass:"el-tabs__nav-scroll"},[i("div",{staticClass:"el-tabs__nav",staticStyle:{transform:"translateX(0px)"},attrs:{role:"tablist"}},[i("div",{staticClass:"el-tabs__item is-top",staticStyle:{width:"376px","text-align":"center"},attrs:{role:"tab",tabindex:"-1"}},[t._v("系统模板")])])])])])}],it={name:"BizEditorTemplate",props:{templateStyle:{type:Object,default:function(){return{width:"445px",height:"100%"}}}},data:function(){return{selectedNav:"0",activeTab:"first",styleTitles:['<br>\n        <p style="margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: rgb(239, 112, 96); min-height: 32px; border-bottom-width: 2px; border-bottom-style: solid; border-color: rgb(239, 112, 96); text-align: justify;">\n          <span class="autonum" placeholder="1" style="border-radius: 80% 100% 90% 20%; color: #FFFFFF; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px; word-wrap: break-word !important; background-color: #EF7060;" data-original-title="" title="">1</span><strong class="brush" data-brushtype="text"></strong>\n        </p>\n        <br>','<br>\n        <div style="clear: both; padding: 0px; border: 0px none; margin:5px 0px;">\n          <div style="border-top-width: 2.5px; border-top-style: solid; border-color: rgb(239, 112, 96); font-size: 1em; font-weight: inherit; text-decoration: inherit; color: rgb(255, 255, 255); box-sizing: border-box;">\n            <div style="border: 0px rgb(239, 112, 96); margin: 2px 0px 0px; overflow: hidden; padding: 0px; color: inherit;">\n              <div style="display: inline-block; font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; color: inherit; border-color: rgb(239, 112, 96); background-color: transparent;">\n                <div class="brush" data-bcless="darken" data-brushtype="text" style="display: inline-block; line-height: 1.4em; padding: 5px 10px; height: 32px; vertical-align: top; font-size: 16px; font-family: inherit; font-weight: bold; float: left; color: inherit; border-color: rgb(212, 43, 21); box-sizing: border-box !important; background: rgb(239, 112, 96);">\n                  请输入标题\n                </div>\n                <div style="display: inline-block; vertical-align: top; font-size: 16px; width: 0px; height: 0px; border-top-width: 32px; border-top-style: solid; border-top-color: rgb(239, 112, 96); border-right-width: 32px; border-right-style: solid; border-right-color: transparent; border-top-right-radius: 4px; border-bottom-left-radius: 2px; color: inherit; box-sizing: border-box !important;">\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="margin: 0.8em 0 0.5em 0;font-size: 16px;line-height: 32px; font-weight: bold;">\n          <div style="display: inline-block; float: left; min-width: 32px; height: 32px; vertical-align: top; text-align: center;  ">\n            <div style="display: table; width: 100%; color: inherit; border-color: rgb(72, 192, 163);" data-width="100%">\n              <div style="display: table-cell;text-indent: 0; vertical-align: middle; font-style: normal; color: rgb(255, 255, 255); border-color: rgb(72, 192, 163);">\n                <span class="autonum" style="color:#C6C6C7; font-size:50px" data-original-title="" title="">1</span></div>\n              <div style="height: 70px;margin-left: -6px; margin-top:5px;border-left:1px solid rgb(198,198,199);background-color: rgb(254,254,254); box-sizing: border-box;transform: rotate(35deg);-webkit-transform: rotate(35deg);-moz-transform: rotate(35deg);-o-transform: rotate(35deg);"></div>\n            </div>\n          </div>\n          <div style="margin-left: 40px;padding-top:18px; font-style:normal;font-size:30px; color: #737373; border-color: rgb(72, 192, 163);">\n            <span class="brush" data-brushtype="text" style="color:#737373; font-size:20px">请输入标题</span></div>\n        </div>\n        <br>','<br>\n        <div class="" style="border-left:5px solid #666765;font-size: 16px;font-weight:bold; line-height: 32px;color:#666;padding: 5px 10px; margin: 10px 0px;">\n          <p>\n            你在跳一个深坑之前，要知道它有多深才行。当你在这个世界上还有快乐可寻的时候，万不可走绝路，否则不久你也许会觉醒，那时后悔就太迟了。 by 席勒\n          </p>\n        </div>\n        <br>'],styleContents:['<br>\n        <div style="margin-top: 0px; padding: 0px 5px; line-height: 10px; color: inherit; border: 1px solid rgb(226, 121, 97);">\n          <div style="padding: 0px; font-size: 16px; color: inherit; height: 8px; margin: -8px 0px 0px 140px; width: 50%; background-color: rgb(254, 254, 254);" data-width="50%">\n            <div style="width: 8px; height: 8px; border-radius: 100%; line-height: 1; box-sizing: border-box; font-size: 18px; text-decoration: inherit; border-color: rgb(226, 121, 97); display: inline-block; margin: 0px; color: inherit; background-color: rgb(226, 121, 97);"></div>\n          </div>\n          <div class="brush" data-style="text-indent: 2em;" style="padding: 0px; line-height: 2em; color: rgb(62, 62, 62); font-size: 14px; margin: 15px;">\n            <p style="text-indent: 2em;">\n              我这个二十岁的人，一再严肃地反省到自己由于孤儿根性养成的怪脾气，我正因为受不了那种令人窒息的忧郁感，这才走上伊豆的旅程。\n            </p>&#8203;<br>\n            <p style="text-indent: 2em;">\n              ——川端康成《伊豆的舞女》\n            </p>\n          </div>\n          <div style="padding: 0px; background-color: rgb(254, 254, 254); font-size: 16px; color: inherit; text-align: right; height: 10px; margin: 0px 0px -4px 25px; width: 65%;" data-width="65%">\n            <div style="margin: 0px auto 1px; border-radius: 100%; line-height: 1; box-sizing: border-box; text-decoration: inherit; border-color: rgb(226, 121, 97); display: inline-block; height: 8px; width: 8px; color: inherit; background-color: rgb(226, 121, 97);"></div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="color: inherit; font-size: 16px; padding: 5px 10px 0px 35px; margin-left: 27px; border-left-width: 2px; border-left-style: dotted; border-left-color: rgb(228, 228, 228);">\n          <div class="autonum" style="width: 32px; height: 32px; margin-left: -53px; margin-top: 23px; color: rgb(255, 255, 255); text-align: center; line-height: 32px; border-radius: 16px; background: rgb(157, 180, 194);" data-original-title="" title="">\n            1\n          </div>\n          <div class="" style="margin-top: -30px;padding-bottom: 10px; color: inherit;">\n            <p>\n              是真的有过那种，巴不得把自己的生活全盘托出奉献给谁，那人却讪笑着推诿着时远时近的经历，才开始觉得，比起一段风雨飘摇的感情，最该关照的永远是自己。 by 陈大力\n            </p>\n          </div>\n        </div>\n        <br>','<br>\n        <blockquote style="margin: 3px; padding: 10px 15px; border-width: 3px; border-color: rgb(102, 142, 104); border-top-left-radius: 50px; border-bottom-right-radius: 50px; box-shadow: rgb(165, 165, 165) 5px 5px 2px; background-color: rgb(250, 250, 250);">\n          <div class="brush" data-style="margin-top: 15px; margin-bottom: 0px; padding: 0px; color: rgb(107, 77, 64); line-height: 2em; font-size: 20px; border-color: rgb(107, 77, 64);font-size: 18px;font-weight:bold;">\n            <p style="margin-top: 15px; margin-bottom: 0px; padding: 0px; color: rgb(102, 142, 104); line-height: 2em; font-size: 20px; border-color: rgb(102, 142, 104);">\n              <span style="font-size:18px"><strong style="border-color: rgb(102, 142, 104); color: inherit;">读而思</strong></span>\n            </p>\n          </div>\n          <p style="margin-top: -10px; margin-bottom: 0px; padding: 0px; line-height: 2em; min-height: 1.5em; color: inherit;">\n            <span style="font-size:12px"><strong class="brush" data-brushtype="text" style="border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; color: rgb(255, 255, 255); font-size: 13px; padding: 0px 15px; background-color: rgb(102, 142, 104);">duersi</strong></span>\n          </p>\n          <div class="brush" data-style="margin-top: 0px; margin-bottom: 0px; padding: 0px; line-height: 2em; font-size: 14px; min-height: 1.5em; color: inherit;">\n            <p>\n              <span style="font-size:14px">编辑完成后，将内容复制粘贴到微信后台素材管理的编辑器中即可。</span>\n            </p>\n            <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; line-height: 2em; font-size: 16px; min-height: 1.5em; color: inherit;">\n              <br>\n            </p>\n          </div>\n        </blockquote>\n        <br>','<br>\n        <div class="layout" style="margin: 5px auto; border: 3px solid rgb(89, 155, 171); padding: 5px;">\n          <div data-bcless="lighten" style="border: 1px solid rgb(157, 196, 205); padding: 15px; text-align: center; color: inherit;">\n            <p class="title" style="color: inherit;font-size: 12px;">\n              <span class="brush" data-brushtype="text"></span>\n            </p>\n            <p style="color:inherit;">\n              <strong style="color:inherit"><span class="brush" style="color:inherit; font-size:16px">操作方便才是硬道理</span></strong>\n            </p>\n          </div>\n        </div>\n        <br>','<br>\n        <div class="layout" style="border: 0px; margin: 5px auto; box-sizing: border-box; padding: 0px;">\n          <div style="height: 25px; box-sizing: border-box; color: inherit;">\n            <div style="height: 100%; width: 50px; float: left; border-top-width: 2px; border-top-style: solid; border-color: rgb(172, 29, 16); border-left-width: 2px; border-left-style: solid; box-sizing: border-box; color: inherit;"></div>\n            <div style="display: inline-block; color: rgb(172, 29, 16); clear: both; box-sizing: border-box; border-color: rgb(172, 29, 16);"></div>\n          </div>\n          <div class="brush" data-style="color: rgb(51, 51, 51); font-size: 1em; line-height: 1.75em; word-break: break-all; word-wrap: break-word; text-align: justify;" style="margin: -0.8em 0.3em; padding: 0.8em; box-sizing: border-box; color: inherit;">\n            <p style="color: rgb(51, 51, 51); font-size: 1em; line-height: 1.75em; word-break: break-all; word-wrap: break-word; text-align: justify;">\n              反正人生不是在此处失败，就是在彼处失败。失败者才不管别的有多重要。任性一回，不然一辈子都憋屈。 by 毛利\n            </p>\n          </div>\n          <div style="height: 25px; box-sizing: border-box; color: inherit;">\n            <div style="height: 100%; width: 50px; float: right; border-bottom-width: 2px; border-bottom-style: solid; border-color: rgb(172, 29, 16); border-right-width: 2px; border-right-style: solid; box-sizing: border-box; color: inherit;"></div>\n          </div>\n        </div>\n        <br>'],styleGuides:['<br>\n        <p style="text-align:center;">\n          <img data-id="87820" data-role="guide-img" title="引导关注" src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9pYW5xMDNVVVdHbUt6Y2V0amhySjBUaWE5UHhUZFNLcWJWam9HNXNYM3hpYmRGbkdlZ1NSSldhVFRqQzR3d0VhVUxaUWhZT1duVnVsU2liNkJWd3BQOGljV2VRLzA/d3hfZm10PWdpZg==" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9pYW5xMDNVVVdHbUt6Y2V0amhySjBUaWE5UHhUZFNLcWJWam9HNXNYM3hpYmRGbkdlZ1NSSldhVFRqQzR3d0VhVUxaUWhZT1duVnVsU2liNkJWd3BQOGljV2VRLzA/d3hfZm10PWdpZg==" style="display: inline;width:95%">\n        </p>\n        <br>','<br>\n        <div style="border: none; width: 98%; margin-right: auto; margin-left: auto;" data-width="98%">\n          <div style="width: 100%; border: 1px solid rgb(53, 49, 53); padding-bottom: 3em;box-sizing:border-box;" data-width="100%">\n            <div style="width: 100%; background: rgb(53, 49, 53); height: auto; overflow: hidden; box-sizing: border-box; padding: 3em 2em 6em; text-align: center;" data-width="100%">\n              <div style="margin-right: 8px;width: 100%;font-size: 3em;font-family: arial;color: #fff;line-height: 0.8em;display: inline-block;text-align:center;font-weight: bolder;vertical-align: top;" data-width="100%"></div><br>\n              <div class="brush" style="font-size:1em;line-height:1.5em;color:#fff;">\n                <p>\n                  谁可相依？近处，要有可以依傍的亲人朋友，远处，要有神或者佛；实处，要有金钱，虚处，要有信仰。远近都有，虚实结合，才能填补人生的各种窟窿，抵挡生命中各种不妥，不至于凄云惨雾。 by 韩松落\n                </p>\n              </div>\n            </div>\n            <div style="width: 40%; margin-right: auto; margin-left: auto; overflow: hidden; margin-top: -4em;" data-width="40%">\n              <img style="width:100%;border:1px solid #1F1E20;" src="/resources/admin/images/article/qrcode.jpg" data-ke-src="/resources/admin/images/article/qrcode.jpg" data-width="100%">\n            </div>\n            <div style="width: 100%; font-size: 1.4em; margin-top: 0.2em; margin-bottom: 0.2em; text-align: center;" data-width="100%">\n              V服爱车\n            </div>\n            <div style="width: 100%; font-size: 1em; color: rgb(126, 126, 126); margin-top: 0.2em; margin-bottom: 0.2em; text-align: center;" data-width="100%">\n              长按识别二维码，关注V服爱车\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <p class="brush" style="margin-top: 0px; margin-bottom: 0px; font-size: 15.5556px; padding: 0px; max-width: 100%; min-height: 1.5em; line-height: 2em; word-wrap: break-word; word-break: normal; border-radius: 5px; color: rgb(255, 255, 255); text-align: center; background-color: rgb(128, 177, 53);" data-brushtype="text">\n          ↓↓↓ 点击"阅读原文" 【查看更多信息】 &nbsp;\n        </p>\n        <br>','<br>\n        <div style="border: none; margin: 0.8em 0px 0.3em; box-sizing: border-box; padding: 0px;">\n          <div style="text-align: center; text-decoration: inherit; color: rgb(255, 255, 255); border-color: rgb(123, 154, 181); box-sizing: border-box;">\n            <div style="width: 0px; margin: 0px 0px 0px 90px; border-bottom-width: 0.8em; border-bottom-style: solid; border-bottom-color: rgb(123, 154, 181); border-top-color: rgb(123, 154, 181); box-sizing: border-box; height: 10px; color: inherit; border-left-width: 0.8em !important; border-left-style: solid !important; border-left-color: transparent !important; border-right-width: 0.8em !important; border-right-style: solid !important; border-right-color: transparent !important;"></div>\n            <div class="brush" data-brushtype="text" style="padding: 0.5em; line-height: 1.2em; font-size: 1em; box-sizing: border-box; color: inherit; border-color: rgb(123, 154, 181); border-radius: 4px; background-color: rgb(123, 154, 181);">\n              <strong style="color:inherit">点击标题下「蓝色微信名」可快速关注</strong>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <p style="text-align:center;">\n          <img title="猫抓毛线球引导分享" src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9jWlYyaFJwdUFQak9qSUVBMU9qU2ljWEhjaWE5TWo5UlFqc09RVTh4R1hpYVlYWWZpYm9Nb0FKbXJyVHpPSjRtWDgxOXZqaGpYaG9EZ0lzZXBBdEs2S3k2OEEvMA==" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9jWlYyaFJwdUFQak9qSUVBMU9qU2ljWEhjaWE5TWo5UlFqc09RVTh4R1hpYVlYWWZpYm9Nb0FKbXJyVHpPSjRtWDgxOXZqaGpYaG9EZ0lzZXBBdEs2S3k2OEEvMA==" style="display: inline;">\n        </p>\n        <br>'],styleImgs:['<br>\n        <div style="border: 0px; box-sizing: border-box; width: 100%; clear: both; overflow: hidden; padding: 0px;" data-width="100%">\n          <div class="layout" style="box-sizing: border-box; width: 65%; float: left; padding: 0px 0.1em 0px 0px;" data-width="65%">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUVhUSW9LTkZBN29tSUFCUkRXMlhpYTAzSlNxZU01UFM5Q3loM3JFZXdtVmljYXNZcU5XSWVwMnlBLzA/d3hfZm10PWpwZWc=" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUVhUSW9LTkZBN29tSUFCUkRXMlhpYTAzSlNxZU01UFM5Q3loM3JFZXdtVmljYXNZcU5XSWVwMnlBLzA/d3hfZm10PWpwZWc=" style="box-sizing: border-box; margin: 0px; height: auto !important; visibility: visible !important; width: 100%;" width="100%" height="auto" border="0" opacity="" mapurl="" title="" alt="" data-width="100%">\n          </div>\n          <div class="layout" style="display: inline-block; width: 35%; box-sizing: border-box; float: left; padding: 0px 0px 0px 0.1em;" data-width="35%">\n            <div class="brush" data-brushtype="text" style="box-sizing: border-box; margin-right: 4px; padding: 4px 6px; border-bottom-width: 2px; border-bottom-style: solid; font-size: 1.2em; font-weight: bold;color: rgb(102,97,91); border-color: rgb(102,97,91);">\n              机会论\n            </div>\n            <div class="brush" data-styel="line-height: 2em;" style="box-sizing: border-box; margin-right: 0.3em; padding: 0.3em 0.5em; color: rgb(102,97,91); font-size: 0.9em;">\n              <p style="line-height: 2em;">\n                机会是给有准备的人\n              </p>\n              <p style="line-height: 2em;">\n                但准备的人多了\n              </p>\n              <p style="line-height: 2em;">\n                机会\n              </p>\n              <p style="line-height: 2em;">\n                决定摇号\n              </p>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="text-align:center;">\n          <div style="display:inline-block;text-align:right;">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUTE0cng2aWJocGdSUWhSYTdpYzBjeWtqSmxoQUFXZlM4aWFkYkx4aDlnMVpzUHBWWUdWT0V3QVRxUS8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUTE0cng2aWJocGdSUWhSYTdpYzBjeWtqSmxoQUFXZlM4aWFkYkx4aDlnMVpzUHBWWUdWT0V3QVRxUS8wP3d4X2ZtdD1qcGVn" style="border-radius: 50%; display: inline-block; width: 110px; margin: 0px; height: 110px !important;" width="110" height="110" border="0" opacity="" mapurl="" title="" alt="">\n          </div>\n          <div style="border-left-width: 1px; border-left-style: solid; border-color: rgb(173, 167, 105); padding-left: 1em; text-align: left; display: inline-block; height: 6em; vertical-align: top; color: rgb(173, 167, 105); margin-top: 0.5em; margin-left: 10px; padding-top: 5px;">\n            <div class="brush" data-brushtype="text" style="width: 100%; height: 50%; font-size: 1.4em; border-color: rgb(173, 167, 105); color: inherit; margin-bottom: 0.5em;" data-width="100%">\n              计划\n            </div>\n            <div class="brush" data-brushtype="text" style="font-size: 16px; border-color: rgb(173, 167, 105); color: inherit;">\n              = Planning =\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="text-align: center;">\n          <div style="display: inline-block; vertical-align: top; width:50%;" data-width="50%">\n            <div style="width: 8em;display:inline-block;">\n              <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUWFrMHY1Um9SaWNsOWxOcmlheUlyOG83aWF5NFpBekMySGliWkxaRURUOTZON0NWT2dEUHQzajRCSXcvMD93eF9mbXQ9anBlZw==" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUWFrMHY1Um9SaWNsOWxOcmlheUlyOG83aWF5NFpBekMySGliWkxaRURUOTZON0NWT2dEUHQzajRCSXcvMD93eF9mbXQ9anBlZw==" style="border-radius: 50%; width: 8em; margin: 0px; height: auto !important;" width="8em" height="auto" border="0" opacity="" mapurl="" title="" alt="">\n            </div>\n          </div>\n          <div style="display: inline-block; vertical-align: top; border-left-width: 1px;box-sizing:border-box; border-left-style: solid; border-left-color: rgb(139, 162, 176); padding-bottom: 2em; width: 50%; padding-top: 0.5em;" data-width="50%">\n            <div style="border: 1px solid;box-sizing:border-box; color: rgb(255, 255, 255); font-size: 18px; width: 0.8em; height: 0.8em; line-height: 0.8em; margin-left: -0.42em; border-radius: 100%; margin-top: 3em; background-color: rgb(139, 162, 176);"></div>\n            <div style="padding-left: 20px;box-sizing:border-box;margin-top:-4.5em;">\n              <div style="border: 1px solid rgb(139, 162, 176); padding: 10px;box-sizing:border-box;" class="brush">\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">一个爱我的人，</span>\n                </p>\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">如果爱得讲话结结巴巴，</span>\n                </p>\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">语无伦次，</span>\n                </p>\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">我就知道他爱我</span>\n                </p>\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">——木心</span>\n                </p>\n              </div>\n            </div>\n          </div>\n          <div style="vertical-align: top;box-sizing:border-box; width: 50%; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(139, 162, 176); display: inline-block; margin-right: -2px;" data-width="50%">\n            <div style="padding-right:20px;box-sizing:border-box;">\n              <div style="box-sizing:border-box;border: 1px solid rgb(139, 162, 176); padding: 10px;" class="brush">\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">一个爱我的人</span>\n                </p>\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">如果爱得讲话结结巴巴</span>\n                </p>\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">语无伦次</span>\n                </p>\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">我就知道他爱我</span>\n                </p>\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">——木心</span>\n                </p>\n              </div>\n            </div>\n          </div>\n          <div style="display: inline-block; vertical-align: top; width: 50%; padding-bottom: 2em;box-sizing:border-box;" data-width="50%">\n            <div style="border: 1px solid; color: rgb(255, 255, 255); font-size: 18px; width: 0.8em; height: 0.8em; line-height: 0.8em; border-radius: 100%; margin-top: 3em; margin-left: -0.34em; background-color: rgb(139, 162, 176);"></div>\n            <div style="width: 8em;display:inline-block;">\n              <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUVFpYmRtZU5wS0tUeGpjWVF1eG9XZ3dFZ0NPZmlhaWE3MEJodTFNZHBpYkFWUEdBTVFDTEpZTWljMGliZy8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUVFpYmRtZU5wS0tUeGpjWVF1eG9XZ3dFZ0NPZmlhaWE3MEJodTFNZHBpYkFWUEdBTVFDTEpZTWljMGliZy8wP3d4X2ZtdD1qcGVn" style="border-radius: 50%; width: 8em; margin: -64px 0px 0px; height: auto !important;" width="8em" height="auto" border="0" opacity="" mapurl="" title="" alt="">\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="padding:5px;margin:0 auto;text-align:center;">\n          <div style="display:inline-block;">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9jWlYyaFJwdUFQamczc3hvVHR5OGRNSDM2U2lhUWxuMG9pY3EzcDRhRTU4aWNSZ0tIUEwyVW9WeFVVTnRkMmNuWm1rT2lhTGtIRUZmelRpYlB4aWFKUG1xSXYwdy8w" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9jWlYyaFJwdUFQamczc3hvVHR5OGRNSDM2U2lhUWxuMG9pY3EzcDRhRTU4aWNSZ0tIUEwyVW9WeFVVTnRkMmNuWm1rT2lhTGtIRUZmelRpYlB4aWFKUG1xSXYwdy8w" style="width:290px;height:auto !important;" class="assistant">\n          </div>\n          <div style="margin-left: 1%; margin-right: 1%; margin-top: -45px; padding: 15px; color: rgb(123, 123, 111); background: rgb(245, 245, 244);">\n            <div style="border: solid 1px rgb(198,198,198);box-shadow:rgb(220,220,220) 0px 0px 5px;padding:8px;">\n              <img style="width: 100%; margin: 0px;" src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkdObGJjam4yVXd3a21Yc25qU2VqRzJzZnVzUFBNdUliY3Z6RWpXZlBiOGlidTVBdGR4Y1FhbnVqSXlIdzlpYlpHUUYzRktrb2xFYzl6QS8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkdObGJjam4yVXd3a21Yc25qU2VqRzJzZnVzUFBNdUliY3Z6RWpXZlBiOGlidTVBdGR4Y1FhbnVqSXlIdzlpYlpHUUYzRktrb2xFYzl6QS8wP3d4X2ZtdD1qcGVn" width="100%" height="" border="0" opacity="" mapurl="" title="" alt="" data-width="100%">\n              <div style="margin-top:15px;margin-bottom:5px;" class="brush">\n                <p style="line-height: 1.75; font-size: 14px; color: rgb(112, 112, 112); text-align: justify;">\n                  你是你自己的裁决者。你过去和现在做得有多好，由你自己说了算。别人永远不能审判你，就算是神。\n                </p>\n                <p style="line-height: 1.75; font-size: 14px; color: rgb(112, 112, 112); text-align: right;">\n                  <span style="line-height: 1.75;">——《与神对话》</span>\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="position:relative;width:50%;float:left;" data-width="50%">\n          <div style="width:100%;height:80%;overflow:hidden;" data-width="100%">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpel9qcGcvemlhZEREUXhiQ0pGYVhuWGZnZjg5anVvSVE1VTF1MWd2M0pJVmpTVHZITFJpYWx4Q2dCM3FEV205azdQc0Frc1NZaHFBcVc5RFFkbGJrRU52ckRiNVYwUS8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpel9qcGcvemlhZEREUXhiQ0pGYVhuWGZnZjg5anVvSVE1VTF1MWd2M0pJVmpTVHZITFJpYWx4Q2dCM3FEV205azdQc0Frc1NZaHFBcVc5RFFkbGJrRU52ckRiNVYwUS8wP3d4X2ZtdD1qcGVn" style="width: 100%; margin: 0px;" width="100%" height="" border="0" mapurl="" title="" alt="" data-width="100%">\n          </div>\n        </div>\n        <div style="float:left;width:44%;margin-top:3%;margin-left:4%;" data-style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-width="44%">\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            在季节的车上，\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            如果你要提前下车，\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            请别推醒装睡的我，\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            这样我可以沉睡到终点，\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            假装不知道你已经离开。\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            ——张嘉佳\n          </p>\n        </div>\n        <div style="clear:both;"></div>\n        <br>'],styleLayouts:['<br>\n        <div style="border: 0px none; padding: 0px; position: relative;">\n          <div style="border-color: rgb(157, 180, 194); color: rgb(255, 255, 255); padding: 35px; background-color: rgb(157, 180, 194);">\n            <div class="layout" style="margin: 0px auto; ">\n              <p class="brush" data-brushtype="text" style="font-size: 24px; font-weight: bold; border-color: rgb(157, 180, 194); color: inherit;">\n                纯底色大边距大段内容\n              </p>\n              <div class="brush" style="border-color: rgb(157, 180, 194); color: inherit;">\n                <p style="border-color: rgb(157, 180, 194); color: inherit;">\n                  日本的设计师提出过一个配色黄金比例，是70：25：5，其中的70%为大面积使用的主色，25%为辅助色，5%为点缀色。一般情况下建议画面色彩不超过3种，3种是指的3种色相，比如深红和暗红既可以视为一种色相。\n                </p>\n                <p style="border-color: rgb(157, 180, 194); color: inherit;">\n                  <br>\n                </p>\n                <p style="border-color: rgb(157, 180, 194); color: inherit;">\n                  一般来说颜色用的越少越好，颜色越少画面越简洁，作品会显得更加成熟。\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="margin-right: auto; margin-left: auto; clear: both; position: relative; width: 100%; overflow: hidden;" data-width="100%">\n          <div style="margin: 0.5em 0.5em 1.5em; border: 0px;">\n            <div style="margin-top: 0em; border: 2px solid rgb(0, 0, 0); border-radius: 0.8em; color: rgb(51, 51, 51); font-size: 1em; box-shadow: rgb(189, 189, 189) 0px 3px 5px;">\n              <div class="brush" style="font-size: 14px;padding: 1.4em 5em 1em 1em;line-height: 1.4; text-decoration: inherit;">\n                <p>\n                  有时想想，独居斗室和天涯浪迹好像是一件事情，身处寂寞和身处喧嚣其实也没什么两样，身外的整个世界都是镜子，我们必须自己认得自己。——马良《人间卧底》\n                </p>\n              </div>\n            </div>\n            <div style="margin-top:-3.5em;margin-right: 10px; line-height: 1.4; text-align: right;">\n              <div style="width:50px;display:inline-block;">\n                <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei84ZmJBNmJNVENlSktpYUlZcURSYXAwVGZEcVg5Unh0Z0N6aWFJVXNjZVhLaWJvdExjdmliNlJXUVJZU2liZjNZa1Q0QmlhS21qOHhrdjJMNklhd1hXdFdKbldlZy8wP3d4X2ZtdD1wbmc=" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei84ZmJBNmJNVENlSktpYUlZcURSYXAwVGZEcVg5Unh0Z0N6aWFJVXNjZVhLaWJvdExjdmliNlJXUVJZU2liZjNZa1Q0QmlhS21qOHhrdjJMNklhd1hXdFdKbldlZy8wP3d4X2ZtdD1wbmc=" style="width:100%" data-width="100%">\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="border: 0px none; padding: 0px;">\n          <div class="layout" style="margin:10px auto;width:70%" data-width="70%">\n            <div class="_editor" style="border: 0px none; padding: 0px; margin: 0px; position: relative;">\n              <p class="brush" data-brushtype="text" style="font-size: 16px; margin: 10px 0px; padding: 10px; max-width: 100%; border-top-style: solid; border-top-width: 1px; border-left-width: 0px; border-bottom-style: solid; border-bottom-width: 1px; line-height: 25px; color: rgb(33, 33, 34); text-align: center; border-color: rgb(33, 33, 34);">\n                大边距居中\n              </p>\n            </div>\n            <p style="text-align:right; color: inherit;">\n              自由调整两侧边距\n            </p>\n            <div class="brush" data-style="font-size:14px;text-align:center" style="line-height: 25px; color: inherit;">\n              <p style="color: inherit; text-align: center;">\n                单列居中样式，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                内部嵌套插入其它样式，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                内容宽度的自定义，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                让自己的文章更与众不同。<br>\n              </p>\n              <p style="color: inherit;">\n                <br>\n              </p>\n              <p style="color: inherit; text-align: center;">\n                <span style="color: inherit;"></span><br>\n              </p>\n              <p style="color: inherit; text-align: center;">\n                <span style="line-height: 25px; text-align: center;">缩短</span>您的排版时间，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                提升排版体验，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                工作就应该成为享受！\n              </p>\n              <p>\n                <br>\n              </p>\n              <p>\n                <br>\n              </p>\n              <p style="color: inherit;">\n                <br>\n              </p>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="border: 0px none; padding: 0px; position: relative;">\n          <div style="margin-top:5px;">\n            <div style="width:50%;display:inline-block;box-sizing:border-box;float:left;padding-right:10px" class="layout" data-width="50%">\n              <div style="padding:20px 25px;box-sizing:border-box;border:1px solid #e7e7e7;text-align:center;">\n                <p>\n                  <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUTZTYm1sWlJ3TU9XeWdiaWFFU0dTNHJUb0RpYXFIakN4QzVmZGJXNTNYOFBQRm9LWEd4TmlhTFAyZy8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUTZTYm1sWlJ3TU9XeWdiaWFFU0dTNHJUb0RpYXFIakN4QzVmZGJXNTNYOFBQRm9LWEd4TmlhTFAyZy8wP3d4X2ZtdD1qcGVn" style="margin: 0px 0px 15px; height: 50px !important;" width="" height="50" border="0" opacity="" mapurl="" title="" alt="">\n                </p>\n                <p class="brush" data-brushtype="text" style="font-size:16px;font-weight:bold;margin:0 0 10px 0;">\n                </p>\n                <div class="brush" data-style="clear:none;">\n                  <p style="clear:none;margin:0 0;line-height:1.5em;">\n                    生而排版\n                  </p>\n                  <p style="clear:none;margin:0 0;line-height:1.5em;">\n                    <span style="text-align:center">为你而美</span>\n                  </p>\n                </div>\n              </div>\n            </div>\n            <div style="padding-left:10px;box-sizing:border-box;width:50%;display:inline-block;text-align:center;" class="layout" data-width="50%">\n              <div style="padding:20px 25px;box-sizing:border-box;border:1px solid #e7e7e7;">\n                <p>\n                  <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUXVtVjNldEJzV2RpYWlhbkljUnFRcURobE1jWHJKN2NVRm1YMGRPQVVjTWgybUtpY1VWbk9yNDhLUS8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUXVtVjNldEJzV2RpYWlhbkljUnFRcURobE1jWHJKN2NVRm1YMGRPQVVjTWgybUtpY1VWbk9yNDhLUS8wP3d4X2ZtdD1qcGVn" style="margin: 0px 0px 15px; height: 50px !important;" width="" height="50" border="0" opacity="" mapurl="" title="" alt="">\n                </p>\n                <p class="brush" data-brushtype="text" style="font-size:16px;font-weight:bold;margin:0 0 10px 0;">\n                  秒刷\n                </p>\n                <div class="brush" data-style="clear:none;margin:0 0;line-height:1.5em;">\n                  <p style="clear:none;margin:0 0;line-height:1.5em;">\n                    一键排版\n                  </p>\n                  <p style="clear:none;margin:0 0;line-height:1.5em;">\n                    珍惜生命\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="margin:2px;text-algin:center;">\n          <div style="border: 2px groove rgb(252, 180, 43); padding-bottom: 1.2em; font-weight: inherit; text-align: center; text-decoration: inherit; box-sizing: border-box; color: inherit; margin: 0px; background-color: transparent;display: inline-block;">\n            <div class="layout" style="width: 40%; float: left; display: inline-block; padding:20px 15px; text-align: left; box-sizing: border-box; color: inherit; margin: 0px;" data-width="40%">\n              <div style="box-sizing: border-box; color: rgb(252, 180, 43); border-color: rgb(252, 180, 43); padding: 0px; margin: 0px;">\n                <div style="border-color: rgb(252, 180, 43); box-sizing: border-box; color: inherit; display: inline-block; font-size: 24px; font-weight: inherit; line-height: 1.5em; text-align: left; text-decoration: inherit; padding: 0px; margin: 0px;">\n                  <span style="box-sizing:border-box; color:#262626; margin:0px; padding:0px"><strong class="brush" data-brushtype="text" style="box-sizing:border-box; color:inherit; margin:0px; padding:0px"></strong></span>\n                </div>\n              </div>\n              <div style="color: rgb(252, 180, 43); margin: 0px; font-size: 1.5em; line-height: 1em; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box; border-color: rgb(252, 180, 43); padding: 0px;">\n                <div style="box-sizing: border-box; color: inherit; border-color: rgb(252, 180, 43); padding: 0px; margin: 0px;">\n                  <span style="box-sizing:border-box; color:#262626; font-size:24px; margin:0px; padding:0px"><strong style="border-color:rgb(252, 180, 43); box-sizing:border-box; color:inherit; font-size:24px; margin:0px; padding:0px"><span class="brush" data-brushtype="text" style="box-sizing:border-box; color:inherit; font-size:24px; margin:0px; padding:0px">编辑器</span></strong></span>\n                </div>\n              </div>\n            </div>\n            <div class="layout" style="display: inline-block; float: right; border-left-width: 2px; border-left-style: groove; border-color: rgb(252, 180, 43); width: 60%; margin-top: 15px; padding-left: 1.5em; vertical-align: middle; box-sizing: border-box; font-weight: inherit; text-align: left; text-decoration: inherit; color: inherit;" data-width="60%">\n              <div class="brush" data-style="color: inherit; font-size: 14px; margin-bottom:0.8em; box-sizing: border-box; padding: 0px; line-height: 1.2em;font-weight:bold;" style="width: 100%; box-sizing: border-box; color: inherit; padding: 0px; margin:3px 0px;" data-width="100%">\n                <p style="color: inherit; font-size: 24px; margin-bottom:0.8em; box-sizing: border-box; padding: 0px; line-height: 1em;">\n                  <strong style="box-sizing:border-box; color:inherit; margin:0px; padding:0px"><span style="box-sizing:border-box; color:inherit; font-size:14px; line-height:1em; margin:0px; padding:0px">V服编辑器是一款在线编辑工具，为您提供丰富的样式，精美的模板</span></strong>\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>'],styleTrades:['<br>\n        <div style="padding: 20px; color: rgb(255, 255, 255); background-color: rgb(226, 121, 97);">\n          <div style="padding: 10px; color: rgb(255, 255, 255); margin: 0px; border: 2px solid rgba(254, 254, 254, 0.8); background: rgb(226, 121, 97);">\n            <div style="border: 0px; box-sizing: border-box; width: 100%; clear: both;  padding: 0px; text-align: center; color: rgb(255,255,255);height:60px" data-width="100%">\n              <div style="box-sizing: border-box; width: 42%; float: left; padding:3px 0px; text-align: right; color: inherit;" data-width="42%">\n                <div style="color: inherit;padding:0px;">\n                  <p style="box-sizing: border-box; margin-top: 3px; margin-bottom: 0; margin-right: 0.2em; padding: 3px 0px 0px; color: inherit; line-height: 1.3em; text-align: right; font-size: 18px; border-color: rgb(226, 121, 97);">\n                    <strong><span class="sh" data-brushtype="text" style="border-color: #E27961; color: inherit; font-size: 18px;">SAVE</span></strong>\n                  </p>\n                  <p style="box-sizing: border-box; margin-top: 0; margin-bottom: 0; margin-right: 0.2em; padding: 0px 0px 3px; line-height: 1.2em; text-align: right; font-size: 18px; text-indent: 0em; border-color: rgb(226, 121, 97);">\n                    <strong><span class="brush" data-brushtype="text" style="border-color: #E27961; color: inherit; font-size: 18px;">UPTO</span></strong>\n                  </p>\n                </div>\n              </div>\n              <div style="display: inline-block; width: 58%; box-sizing: border-box; float: right; padding: 0px; text-align: left; color: inherit;" data-width="58%">\n                <div style="color: inherit;height:60px">\n                  <p style="box-sizing: border-box; margin-top: 0; margin-bottom: 0; margin-right: 0.2em; padding: 3px 0px; color: inherit; line-height: 3.5em; text-align: left; border-color: rgb(226, 121, 97);">\n                    <span style="color:inherit"><strong><span class="brush" data-brushtype="text" style="border-color: #E27961; color: inherit; font-size: 55px;">50%</span></strong></span>\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="margin: 16px 0% 8px; text-align: center; position: static;">\n            <div style="padding: 32px 16px 16px; box-sizing:border-box;white-space: normal; background-image: -webkit-repeating-linear-gradient(135deg, transparent, transparent 4px, white 4px, white 12px); background-color: rgb(226, 223, 223);">\n              <div style="width: 32px; margin: -40px auto; font-size: 64px; line-height: 1; color: rgb(226, 223, 223); background: white;">\n                  “\n              </div>\n              <div style="padding: 8px; box-sizing:border-box;background-color: rgb(255, 255, 255);">\n                <div style="margin-top: -35px; margin-right: 0%; margin-left: 0%; position: static;">\n                  <div style="display: inline-block; width: 55%; vertical-align: top; background-color: rgb(254, 255, 255);" data-width="55%">\n                    <div style="position: static;">\n                      <div style="color: rgb(133, 118, 106); font-size: 20px;">\n                        <div>\n                          <p>\n                            全场满100<strong>包邮</strong>\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                    <div style="position: static;">\n                      <div style="text-align: left; font-size: 12px; color: rgb(160, 160, 160); letter-spacing: 1px;">\n                        <p style="text-align: center;">\n                          9.22 10:00 - 9.28 10:00\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div style="position: static;margin-top:20px;margin-bottom:10px;">\n                  <div style="display: inline-block; vertical-align: top; width: 50%; padding: 5px;box-sizing:border-box;" data-width="50%">\n                    <div style="position: static;">\n                      <div style="letter-spacing: 1px;">\n                        <div>\n                          <p>\n                            <span style="font-size: 7px;">￥&nbsp;</span><span style="font-size: 35px;"><strong><span style="line-height: 1.6;">10</span></strong></span><span style="font-size: 14px;"><strong><span style="line-height: 1.6;">优惠券</span></strong></span>\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                    <div style="margin-right: 0%; margin-bottom: 8px; margin-left: 0%; position: static;">\n                      <div style="border-top: 1px dotted rgb(11, 11, 11);"></div>\n                    </div>\n                    <div style="position: static;">\n                      <div style="position: static;">\n                        <p style="font-size: 13px;">\n                          订单满150元使用\n                        </p>\n                      </div>\n                    </div>\n                    <div style="position: relative;">\n                      <div style="margin-top: 10px; margin-bottom: 10px; position: static;">\n                        <div class="" style="display: inline-block;border: 2px solid rgb(133, 118, 106);box-sizing:border-box;padding: 0.1em 0.5em;border-radius: 3px;color: rgb(255, 255, 255);font-size: 14px;background-color: rgb(133, 118, 106);">\n                          <p>\n                            抢先领取&gt;&gt;\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <div style="display: inline-block; vertical-align: top; width: 50%;" data-width="50%">\n                    <div style="display: inline-block; width: 100%; border-width: 0px 0px 0px 1px; border-style: solid; border-left-color: rgb(226, 223, 223); border-right-color: rgb(226, 223, 223); padding: 5px;box-sizing:border-box;" data-width="100%">\n                      <div style="position: static;">\n                        <div style="letter-spacing: 1px;">\n                          <p>\n                            <span style="font-size: 7px;">￥&nbsp;</span><span style="font-size: 35px;"><strong><span style="line-height: 1.6;">50</span></strong></span><span style="font-size: 14px;"><strong><span style="line-height: 1.6;">优惠券</span></strong><strong><span style="line-height: 1.6;"></span></strong></span>\n                          </p>\n                        </div>\n                      </div>\n                      <div style="position: static;">\n                        <div style="margin-right: 0%; margin-bottom: 8px; margin-left: 0%; position: static;">\n                          <div style="border-top: 1px dotted rgb(11, 11, 11);"></div>\n                        </div>\n                      </div>\n                      <div style="position: static;">\n                        <div style="font-size: 13px;">\n                          <p>\n                            订单满350元使用\n                          </p>\n                        </div>\n                      </div>\n                      <div style="position: static;">\n                        <div style="margin-top: 10px; margin-bottom: 10px; position: static;">\n                          <div style="display: inline-block;border: 2px solid rgb(133, 118, 106);box-sizing:border-box;padding: 0.1em 0.5em;border-radius: 3px;color: rgb(255, 255, 255);font-size: 14px;background-color: rgb(133, 118, 106);">\n                            <p>\n                              抢先领取&gt;&gt;\n                            </p>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <br>','<br>\n        <div style="background-color:#fbfbfb;padding:10px;">\n            <p style="font-family:\'Microsoft Yahei\';color:#333;margin:0;padding:10px;">\n              <strong class="brush" data-brushtype="text">联系我们</strong>\n            </p>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 -135px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">电话：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">155xxxxxxxx</span><span style="display:block;float:right;margin-right:10px;font-weight:bold;line-height:38px;width:20px;height:36px;background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-repeat:no-repeat;background-position:0 -197px;"></span>\n            </div>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 -472px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:11px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">QQ：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">25822xxxx</span>\n            </div>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 0px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:8px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">微信：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">xxxx</span>\n            </div>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 -270px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">地址：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">xx省xx市xx区xx</span><span style="display:block;float:right;margin-right:10px;font-weight:bold;line-height:38px;"></span>\n            </div>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9RS0R4clZZZWhpY2ViZ3d6Y1JkZjlXZmRFWHBWRjFlQkREekc4b3FEdmdYQjBseURNaGljbFlxa21nY295QjkycFF4Y3doOTVGWWlhdlBlZG5raWJuSWlhcEJBLzA/d3hfZm10PXBuZw==);background-position:0 -31px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">官网：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">www.135editor.com/</span><span style="display:block;float:right;margin-right:10px;font-weight:bold;line-height:38px;width:20px;height:36px;background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-repeat:no-repeat;background-position:0 -197px;"></span>\n            </div>\n            <div style="overflow:hidden;font-size:14px;border-bottom:1px solid #ddd;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 -99px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">邮箱：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">xxxxx@xxxx.xx</span>\n            </div>\n          </div>\n          <br>','<br>\n        <div style="text-align:center;">\n            <div style="width:280px;height:auto !important;padding:16px 5px;background-image: url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkZkVDVTZ2traWJlZGpQcUhtSGd1Z3ZTZERpYmU0ZUJrYlN6aWJEZ3hLTjhkczM1Q1NOdmljQVRBcEdvRGpUeFV0TUZpYlFYNHY4blcxZ1E3US8wP3d4X2ZtdD1wbmc=); background-size:contain; background-repeat: no-repeat;background-position:50% 0;display:inline-block;">\n              <div class="brush" style="margin: 3px auto; padding:5px 16px;color: rgb(62, 62, 62);border:2px solid rgba(254,254,254,0.3);display:inline-block;">\n                <p style="text-align: center; margin-top: 0; margin-bottom: 0;">\n                  <span style=";font-size: 18px;;color: #FFFFFF;">￥5优惠券</span>\n                </p>\n                <div style="padding:6px 50px; font-size: 18px; text-align: center; background-color: rgb(254, 254, 254);display:inline-block;">\n                  <strong><span style="color: #CB254E;" class="brush" data-brushtype="text">立即领取</span></strong>\n                </div>\n                <p style="text-align: center; margin-top: 0; margin-bottom: 0;">\n                  <span style="color: #FFFFFF;" class="brush" data-brushtype="text">（满10元使用）</span>\n                </p>\n              </div>\n            </div>\n          </div>\n          <br>','<br>\n        <div style="display:inline-block;transform: rotate(0deg);-webkit-transform: rotate(0deg);-moz-transform: rotate(0deg);-o-transform: rotate(0deg);">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkVLS2RKUk1aZWlhREV3Z2RrVGJZb0dhWmlhOGF0c1FpYVRPT2pQNlBER2tIanNNUDY2T2NlcHFYSW0xSGoxVlZIZGdHZEZySWZwQlI2ZEEvMD93eF9mbXQ9cG5n" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkVLS2RKUk1aZWlhREV3Z2RrVGJZb0dhWmlhOGF0c1FpYVRPT2pQNlBER2tIanNNUDY2T2NlcHFYSW0xSGoxVlZIZGdHZEZySWZwQlI2ZEEvMD93eF9mbXQ9cG5n" style="width: 120px !important; height: auto !important;" class="assistant">\n          </div>\n          <div style="color: inherit;margin-top: -5.8em;">\n            <p style="line-height: 1.75em; font-size: 12px; text-align: center;">\n              <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkVMZGx6Ym1hYjBZRVF1RFNKcTU1YXAxd3JpYmJKRzFtSlNUWVBYTThwOHlCWk5YUXdMZWVENExkUGlhcFBPSEN5VkEyOWdqSFd3UXNzdy8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkVMZGx6Ym1hYjBZRVF1RFNKcTU1YXAxd3JpYmJKRzFtSlNUWVBYTThwOHlCWk5YUXdMZWVENExkUGlhcFBPSEN5VkEyOWdqSFd3UXNzdy8wP3d4X2ZtdD1qcGVn" style="width: 100%; margin: 0px;" width="100%" height="" border="0" opacity="" mapurl="" title="" alt="" data-width="100%">\n            </p>\n            <p style="line-height: 1.75em; font-size: 12px; text-align: center;">\n              <span style="font-size: 14px;" class="brush" data-brushtype="text">渐变色衬衫 ￥140</span>\n            </p>\n          </div>\n          <br>'],templates:['<br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <div>\n            <img src="/resources/admin/images/article/bottom.png" data-ke-src="/resources/admin/images/article/bottom.png" width="100%">\n          </div>\n          <br>','<br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <div>\n            <img src="/resources/admin/images/article/bottom1.png" data-ke-src="/resources/admin/images/article/bottom1.png" width="100%" height="150">\n          </div>\n          <br>']}},components:{},methods:{templateSelect:function(t){this.$emit("templateSelect",t)},handleSelect:function(t,e){this.selectedNav=t}}},rt=it,nt=(i("45e8"),Object(m["a"])(rt,tt,et,!1,null,null,null)),at=nt.exports;i.d(e,"a",(function(){return K})),i.d(e,"b",(function(){return at}))},"44e0":function(t,e,i){"use strict";var r=i("2497"),n=i("bc3a"),a=i.n(n),s=i("c596");e["a"]={getParameterGroups:function(t,e,i){a.a.get(s["g"].commodity.getParameterGroups,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateParameterGroups:function(t,e,i){a.a.put(s["g"].commodity.updateParameterGroups,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))}}},"453a":function(t,e,i){},"45e8":function(t,e,i){"use strict";var r=i("6611"),n=i.n(r);n.a},"474c":function(t,e,i){},4792:function(t,e,i){"use strict";var r=i("b670"),n=i.n(r);n.a},"4b5f":function(t,e,i){"use strict";var r=i("2497"),n=i("bc3a"),a=i.n(n),s=i("c596");e["a"]={getSpecificationGroups:function(t,e,i){console.log("[---- dachao ----] [API-商品规格-get] getSpecificationGroups() params=",t),a.a.get(s["g"].commodity.getSpecificationGroups,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},updateSpecificationGroups:function(t,e,i){console.log("[---- dachao ----] [API-商品规格-put] updateSpecificationGroups() params=",t),a.a.put(s["g"].commodity.updateSpecificationGroups,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))}}},"51a1":function(t,e,i){"use strict";var r=i("453a"),n=i.n(r);n.a},"522c":function(t,e,i){},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var r=i("1d80"),n=i("5899"),a="["+n+"]",s=RegExp("^"+a+a+"*"),o=RegExp(a+a+"*$"),l=function(t){return function(e){var i=String(r(e));return 1&t&&(i=i.replace(s,"")),2&t&&(i=i.replace(o,"")),i}};t.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(t,e,i){"use strict";var r=i("9678"),n=i.n(r);n.a},6611:function(t,e,i){},"6e0b":function(t,e,i){"use strict";var r=i("ff5b"),n=i.n(r);n.a},"6f9b":function(t,e,i){"use strict";var r=i("b61f"),n=i.n(r);n.a},7132:function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"biz-fade-t"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(e){return e.target!==e.currentTarget?null:t.close(e)}}},[i("transition",{attrs:{name:"biz-fade-t-right"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"popup-content",style:t.contentStyle},[t._t("default")],2)])],1)])},n=[],a={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},s=a,o=(i("5b8e"),i("2877")),l=Object(o["a"])(s,r,n,!1,null,null,null),d=l.exports,p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"biz-popup-tabs"},[i("biz-popup",{attrs:{open:t.open,contentStyle:t.contentStyle},on:{close:t.close}},[i("el-tabs",{attrs:{type:"border-card",value:t.value},on:{"tab-click":t.tabClick}},[t._t("default")],2)],1)],1)},c=[],h=(i("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:d},methods:{close:function(){var t=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("close")}))},tabClick:function(t){this.$emit("input",t.name)}}}),u=h,f=(i("d4c2"),Object(o["a"])(u,p,c,!1,null,null,null)),m=f.exports;i.d(e,"a",(function(){return m}))},"74a1":function(t,e,i){},"868c":function(t,e,i){"use strict";var r=i("a057"),n=i.n(r);n.a},9056:function(t,e,i){"use strict";var r=i("25c2"),n=i.n(r);n.a},"92cd":function(t,e,i){"use strict";var r=i("0bb1"),n=i.n(r);n.a},9678:function(t,e,i){},"9b77":function(t,e,i){},a057:function(t,e,i){},a213:function(t,e,i){"use strict";var r=i("2c90"),n=i.n(r);n.a},a27e:function(t,e,i){},a2a7:function(t,e,i){"use strict";var r=i("2497"),n=i("bc3a"),a=i.n(n),s=i("c596");e["a"]={getVehicleBrands:function(t,e,i){a.a.get(s["g"].commodity.getVehicleBrands,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},getVehicleSeries:function(t,e,i){a.a.get(s["g"].commodity.getSeries,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},getVehicleNames:function(t,e,i){a.a.get(s["g"].commodity.getVehicleNames,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},createVehicle:function(t,e,i){a.a.post(s["g"].commodity.createVehicle,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))}}},a6a5:function(t,e,i){"use strict";var r=i("c2ca"),n=i.n(r);n.a},a9e3:function(t,e,i){"use strict";var r=i("83ab"),n=i("da84"),a=i("94ca"),s=i("6eeb"),o=i("5135"),l=i("c6b6"),d=i("7156"),p=i("c04e"),c=i("d039"),h=i("7c73"),u=i("241c").f,f=i("06cf").f,m=i("9bf2").f,g=i("58a8").trim,b="Number",y=n[b],v=y.prototype,x=l(h(v))==b,_=function(t){var e,i,r,n,a,s,o,l,d=p(t,!1);if("string"==typeof d&&d.length>2)if(d=g(d),e=d.charCodeAt(0),43===e||45===e){if(i=d.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(d.charCodeAt(1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+d}for(a=d.slice(2),s=a.length,o=0;o<s;o++)if(l=a.charCodeAt(o),l<48||l>n)return NaN;return parseInt(a,r)}return+d};if(a(b,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var w,S=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof S&&(x?c((function(){v.valueOf.call(i)})):l(i)!=b)?d(new y(_(e)),i,S):_(e)},I=r?u(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),U=0;I.length>U;U++)o(y,w=I[U])&&!o(S,w)&&m(S,w,f(y,w));S.prototype=v,v.constructor=S,s(n,b,S)}},aad0:function(t,e,i){"use strict";var r=i("522c"),n=i.n(r);n.a},ad5b:function(t,e,i){"use strict";var r=i("a27e"),n=i.n(r);n.a},b603:function(t,e,i){},b61f:function(t,e,i){},b670:function(t,e,i){},baa5:function(t,e,i){var r=i("23e7"),n=i("e58c");r({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},bee2:function(t,e,i){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}i.d(e,"a",(function(){return n}))},c047:function(t,e,i){"use strict";var r=i("b603"),n=i.n(r);n.a},c20d:function(t,e,i){var r=i("da84"),n=i("58a8").trim,a=i("5899"),s=r.parseInt,o=/^[+-]?0[Xx]/,l=8!==s(a+"08")||22!==s(a+"0x16");t.exports=l?function(t,e){var i=n(String(t));return s(i,e>>>0||(o.test(i)?16:10))}:s},c2ca:function(t,e,i){},c563:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"commodity-mgmt"},[i("biz-flex-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{operations:t.operations,filters:t.filters,tableData:t.tableData,pagination:t.pagination},on:{operate:t.operate,"filter-data-change":t.filterDataChange,"selection-change":t.handleSelectionChange,"row-click":t.rowClick,"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"sort-change":t.handleSortChange,"active-item-change":t.activeItemChange,"cascader-change":t.cascaderChange}},[i("el-table-column",{attrs:{label:"商品","min-width":"220px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[i("div",{staticStyle:{width:"100%"}},[i("div",{staticClass:"product-info-content"},[e.row.image&&" "!==e.row.image?i("img",{attrs:{src:e.row.image,onerror:t.errorImg}}):i("img",{attrs:{src:"/resources/admin/images/default/product-default-100.png"}}),i("div",{staticClass:"wrapper"},[i("div",{staticClass:"titleClass",attrs:{title:e.row.fullName}},[t._v(t._s(e.row.fullName))]),i("div",{staticClass:"overflow"},[t._v(t._s(e.row.barCode))])])])])])]}}])}),i("el-table-column",{attrs:{label:"分类","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{width:"100%"}},[i("div",{staticClass:"overflow"},[t._v(t._s(e.row.categoryName))])])]}}])}),i("el-table-column",{attrs:{label:"批发价","min-width":"120px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{width:"100%"}},[i("div",{staticClass:"overflow"},[t._v("￥"+t._s(e.row.purchasePrice))])])]}}])}),i("el-table-column",{attrs:{label:"操作",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),t.deleteRecommend(e.row.id)}}},[t._v("删除")])],1)])}}])})],1),i("Product-popup",{attrs:{slot:"float",open:t.open,id:t.addId,isEdit:t.isEdit,categoryType:t.categoryType,baseInfo:t.rowBaseInfo},on:{close:function(e){t.open=!1,t.addId=""},operationSuccess:t.refresh,createdProductSuccess:t.createdProductSuccess},slot:"float"}),i("biz-popup-tabs",{attrs:{open:t.openimport},on:{close:function(e){t.openimport=!1}},model:{value:t.importtabName,callback:function(e){t.importtabName=e},expression:"importtabName"}},[i("el-tab-pane",{attrs:{label:"导入商品",name:"baseinfo"}},[i("ImportProduct",{ref:"openimport",attrs:{open:t.openimport,refreshSign:t.refreshSign},on:{operationSuccess:t.refresh,openPoup:t.openPoup,closePoup:t.closePoup}})],1)],1),i("biz-popup-tabs",{attrs:{open:t.createVehicle},on:{close:function(e){t.createVehicle=!1}},model:{value:t.createVehicleTabName,callback:function(e){t.createVehicleTabName=e},expression:"createVehicleTabName"}},[i("el-tab-pane",{attrs:{label:"创建整车",name:"createVehicle"}},[i("CreateVehicle",{attrs:{open:t.createVehicle},on:{operationSuccess:t.refresh}})],1)],1)],1)},n=[],a=(i("4160"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("d3b7"),i("ac1f"),i("25f0"),i("3ca3"),i("466d"),i("1276"),i("159b"),i("ddb0"),i("2b3d"),i("b85c")),s=(i("96cf"),i("1da1")),o=i("5530"),l=i("04d3"),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"lead-base-info-s-product"},[i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}),i("el-form",{ref:"form",attrs:{rules:t.rules,size:"small","inline-message":!0}},[i("div",{staticClass:"radio"},[i("el-radio-group",{on:{change:t.handleShowTypeChange},model:{value:t.showType,callback:function(e){t.showType=e},expression:"showType"}},[i("el-radio",{attrs:{label:"文件导入"}},[t._v("从本地文件导入")]),i("el-radio",{attrs:{label:"平台导入"}},[t._v("从平台导入")])],1)],1),i("div",{staticClass:"importFile"},[i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"文件导入"===t.showType,expression:"showType === '文件导入'"}]},[i("import-file",{ref:"importFile",staticStyle:{"margin-left":"10px"},attrs:{tableData:t.importResult,importLoading:t.importLoading,total:t.total,disabled:t.disabled,count:t.count,percentage:t.percentage,stepkey:t.stepkey,action:"/admin/invoicingProduct/importSupplierProduct.jhtml",name:"uFile"},on:{clearTimeOut:t.clearTimeOut,restProcess:t.restProcess,"handle-import":t.handleImport}},[i("el-table-column",{attrs:{label:"编号",prop:"line",width:"50"}}),i("el-table-column",{attrs:{label:"消息",prop:"result"}})],1),i("div",{staticClass:"downloadButton"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.downloadTemplate}},[t._v("模板下载")])],1)],1)],1),i("div",[i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"平台导入"===t.showType,expression:"showType === '平台导入'"}]},[[i("div",{staticClass:"category-select"},[i("el-form",{attrs:{"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{staticClass:"isRequired",attrs:{label:"分类：",prop:"topProductCategoryId"}},[i("el-select",{attrs:{placeholder:"请选择分类"},on:{change:t.topCategoryChange},model:{value:t.topProductCategoryId,callback:function(e){t.topProductCategoryId=e},expression:"topProductCategoryId"}},t._l(t.topCategoryOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),i("el-select",{directives:[{name:"show",rawName:"v-show",value:0!==t.subCategoryOptions.length,expression:"subCategoryOptions.length !== 0"}],attrs:{placeholder:"请选择二级分类"},on:{change:t.subCategoryChange},model:{value:t.subProductCategoryId,callback:function(e){t.subProductCategoryId=e},expression:"subProductCategoryId"}},t._l(t.subCategoryOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t.show?i("el-form-item",{attrs:{label:"品牌："}},[i("el-select",{attrs:{placeholder:"请选择品牌",filterable:""},on:{change:t.getSeriesName},model:{value:t.brandId,callback:function(e){t.brandId=e},expression:"brandId"}},t._l(t.brandOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e(),t.show?i("el-form-item",{attrs:{label:"系列："}},[i("el-checkbox-group",{model:{value:t.seriesId,callback:function(e){t.seriesId=e},expression:"seriesId"}},[i("div",{staticClass:"checkbox-group"},t._l(t.seriesOptions,(function(e){return i("el-checkbox",{key:e.id,attrs:{label:e.id},on:{change:t.conditionChange}},[i("div",{staticClass:"checkbox-group-item"},[t._v(t._s(e.name))])])})),1)])],1):t._e(),t.show?i("el-form-item",{attrs:{label:"销售状态："}},[i("el-checkbox-group",{on:{change:t.conditionChange},model:{value:t.saleStates,callback:function(e){t.saleStates=e},expression:"saleStates"}},[i("div",{staticClass:"checkbox-group"},[i("el-checkbox",{attrs:{label:"1"}},[i("div",{staticClass:"checkbox-group-item"},[t._v("在售")])]),i("el-checkbox",{attrs:{label:"0"}},[i("div",{staticClass:"checkbox-group-item"},[t._v("停售")])])],1)])],1):t._e(),i("el-form-item",{attrs:{label:t.show?"车型":"商品"}},[i("biz-list",{ref:"table",attrs:{height:t.heightList,tableData:t.modeList},on:{handleSelectionChange:t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"50"}}),i("el-table-column",{attrs:{prop:"name",label:"名称"}})],1)],1)],1)],1)]],2)],1)])],1)},p=[],c=(i("99af"),i("a15b"),i("8330")),h=i("f36f"),u=i("ccf0"),f=i("11e9"),m=i("1ab1"),g={name:"CommodityMgmtBaseInfo",data:function(){return{heightList:"300",multipleSelection:[],modeList:[],operations:[{label:"确定",name:"save",type:"primary",disabled:!0}],rules:{topProductCategoryId:[{required:!0,message:"请选择分类",trigger:"blur"}]},allCategory:[],topCategoryOptions:[],subCategoryOptions:[],brandOptions:[],seriesOptions:[],showType:"文件导入",topProductCategoryId:"",subProductCategoryId:"",brandId:"",seriesId:[],saleStates:[],importLoading:!1,importResult:[],disabled:!1,show:!1,total:0,count:0,t:"",percentage:0,stepkey:"",loading:!1}},props:{open:{type:Boolean,default:!1}},watch:{open:function(t){t?this.query():(this.allCategory=[],this.topProductCategoryId="",this.subProductCategoryId="",this.topCategoryOptions=[],this.subCategoryOptions=[],this.brandId="",this.brandOptions=[],this.seriesId=[],this.seriesOptions=[],this.importResult=[],this.successCount=0,this.failCount=0,this.modeList=[],this.show=!1,this.showType="文件导入")}},components:{BizGrid:h["a"],BizSaveButton:c["a"],ImportFile:u["b"],BizList:l["e"]},created:function(){this.handleImport()},computed:{},methods:{operate:function(t){this[t]()},downloadTemplate:function(){window.open("/upload/mode/V服爱车_供应商_商品导入模板.xlsx")},handleSelectionChange:function(t){this.multipleSelection=t},conditionChange:function(){var t=this,e=[];this.multipleSelection.map((function(t){e.push(t.id)}));var i={productCategoryId:""===this.subProductCategoryId?this.topProductCategoryId:this.subProductCategoryId,brandIds:this.brandId,seriesIds:this.seriesId.join("&seriesIds="),saleStates:this.saleStates.join("&saleStates=")},r=[];for(var n in i)r.push("".concat(n,"=").concat(i[n]));m["a"].get("/admin/shopProduct/queryPlatformImportInfo/v2.jhtml?"+r.join("&")).then((function(e){t.modeList=e.data})).catch((function(t){console.log(t),console.log("code错误")}))},handleShowTypeChange:function(t){this.operations[0].disabled="平台导入"!==t},clearTimeOut:function(){window.clearTimeout(this.t)},restProcess:function(){this.total=0,this.count=0,this.stepkey="",this.percentage=0},handleImport:function(){var t=this,e="/admin/invoicingProduct/importProgress.jhtml";m["a"].get(e,{type:"17"}).then((function(e){e.data.total||(t.total=0,t.count=0,t.stepkey="",t.percentage=0),e.data.total&&(t.total=Number(e.data.total||0),t.count=Number(e.data.count||0),t.stepkey=e.data.remark,t.percentage=Number(e.data.rate),t.$refs.importFile.title=e.data.title),e.data&&e.data.rate&&"100"===e.data.rate?(t.clearTimeOut(),t.$refs.importFile.showCurrentInfo=!1,t.$refs.importFile.title="导入完成",t.$emit("operationSuccess"),e.data&&e.data.results&&e.data.results.length>0&&(t.importResult=e.data.results,t.$refs.importFile.uploadingVisible=!1,t.$refs.importFile.importingVisible=!0),t.disabled=!1):e.data&&e.data.rate&&"100"!==e.data.rate?(t.t&&t.clearTimeOut(),t.t=setTimeout(t.handleImport,2e3),t.$refs.importFile.uploadingVisible=!0,t.$refs.importFile.showCurrentInfo=!0,t.disabled=!0):t.$refs.importFile.uploadingVisible=!1})).catch((function(t){console.log(t),console.log("code错误")}))},handleImportCar:function(){var t=this,e="/admin/shopProduct/importProgress.jhtml";m["a"].get(e,{type:"12"}).then((function(e){e.data.total||(t.total=0,t.count=0,t.stepkey="",t.percentage=0),e.data.total&&(t.total=Number(e.data.total||0),t.count=Number(e.data.count||0),t.stepkey=e.data.remark,t.percentage=Number(e.data.rate),t.$refs.importFile.title=e.data.title),e.data&&e.data.rate&&"100"===e.data.rate?(t.clearTimeOut(),t.$refs.importFile.showCurrentInfo=!1,t.$refs.importFile.title="导入完成",e.data&&e.data.results&&e.data.results.length>0&&(t.importResult=e.data.results,t.$refs.importFile.uploadingVisible=!1,t.$refs.importFile.importingVisible=!0),t.disabled=!1):e.data&&e.data.rate&&"100"!==e.data.rate?(t.t&&t.clearTimeOut(),t.t=setTimeout(t.handleImportCar,2e3),t.$refs.importFile.uploadingVisible=!0,t.$refs.importFile.showCurrentInfo=!0,t.disabled=!0):(t.$refs.importFile.uploadingVisible=!1,t.$emit("openPoup"))})).catch((function(t){console.log(t),console.log("code错误")}))},getUploadProductFileParam:function(t){return{shopId:window.top.SHOP_ID||"",filePath:t}},query:function(){this.queryPlatformCategoryTree()},queryPlatformCategoryTree:function(){var t=this;this.allCategory=[],this.topProductCategoryId="",this.subProductCategoryId="",this.topCategoryOptions=[],this.subCategoryOptions=[],this.brandId="",this.brandOptions=[],this.seriesId=[],this.seriesOptions=[];var e={};f["a"].queryPlatformCategoryTree(e,(function(e){t.allCategory=e.platformCategoryTree,t.setTopCategoryOptions(),t.setSubCategoryOptions()}),(function(t){console.log(t)}))},setTopCategoryOptions:function(){var t=[];this.allCategory.forEach((function(e){e.topCategory&&t.push(e)})),this.topCategoryOptions=t},setSubCategoryOptions:function(){var t=this,e=[];""!==this.topProductCategoryId&&this.allCategory.forEach((function(i){i.parentId===t.topProductCategoryId&&e.push(i)})),this.subCategoryOptions=e},topCategoryChange:function(){this.setSubCategoryOptions(),this.subProductCategoryId="",this.getBrandName()},subCategoryChange:function(){this.getBrandName()},getBrandName:function(){var t=this;this.brandId="",this.brandOptions=[],this.seriesId=[],this.seriesOptions=[];var e={productCategoryId:""===this.subProductCategoryId?this.topProductCategoryId:this.subProductCategoryId};f["a"].queryPlatformImportInfo(e,(function(e){var i="";t.topCategoryOptions.map((function(e){e.id===t.topProductCategoryId&&(i=e.type)})),t.modeList=[],"car"===i?(t.show=!0,t.brandOptions=e.data):(t.show=!1,t.conditionChange())}),(function(t){console.log(t)}))},getSeriesName:function(){var t=this;this.seriesId=[],this.seriesOptions=[],this.modeList=[];var e={productCategoryId:""===this.subProductCategoryId?this.topProductCategoryId:this.subProductCategoryId,brandIds:this.brandId};f["a"].queryPlatformImportInfo(e,(function(e){t.seriesOptions=e.data}),(function(t){console.log(t)}))},save:function(){var t=this,e=[];this.multipleSelection.map((function(t){e.push(t.id)}));var i={shopId:window.top.SHOP_ID||"",productCategoryId:""===this.subProductCategoryId?this.topProductCategoryId:this.subProductCategoryId,productIds:e};0!==e.length?(this.operations[0].disabled=!0,this.$emit("closePoup"),setTimeout((function(){t.handleImportCar()}),200),m["a"].post("/admin/shopProduct/importPlatformProduct/v2.jhtml",i).then((function(e){t.$message({type:"success",message:"导入成功!"}),t.loading=!1,t.operations[0].disabled=!1,t.$emit("operationSuccess")})).catch((function(e){t.loading=!1,t.$refs.importFile.uploadingVisible=!1,t.operations[0].disabled=!1,console.log(e)}))):this.$message.warning("请选择待导入的车型或者商品")}}},b=g,y=(i("aad0"),i("2877")),v=Object(y["a"])(b,d,p,!1,null,null,null),x=v.exports,_=i("2f62"),w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-popup-tabs",{attrs:{open:t.open},on:{close:t.close},model:{value:t.tabSelection,callback:function(e){t.tabSelection=e},expression:"tabSelection"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"baseinfo"}},[i("BaseInfo",{attrs:{open:t.open,id:t.id,isEdit:t.isEdit,baseInfo:t.baseInfo,tabSelection:t.tabSelection},on:{operationSuccess:t.operationSuccess,createdProductSuccess:t.createdProductSuccess}})],1),t.id&&"0"===t.categoryType?i("el-tab-pane",{attrs:{label:"车辆识别码",name:"code"}},[i("vin-code",{attrs:{open:t.open,itemId:t.id,isEdit:t.isEdit,tabSelection:t.tabSelection}})],1):t._e(),t.id?i("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[i("Detail",{attrs:{open:t.open,id:t.id,isEdit:t.isEdit,tabSelection:t.tabSelection},on:{operationSuccess:t.operationSuccess}})],1):t._e(),t.id&&"7"!==t.baseInfo.productType?i("el-tab-pane",{attrs:{label:"参数",name:"parameter"}},[i("Parameter",{attrs:{open:t.open,id:t.id,isEdit:t.isEdit,tabSelection:t.tabSelection},on:{operationSuccess:t.operationSuccess}})],1):t._e(),t.id?i("el-tab-pane",{attrs:{label:"图片",name:"pictureInfo"}},[i("PictureInfo",{attrs:{open:t.open,id:t.id,isEdit:t.isEdit,tabSelection:t.tabSelection},on:{operationSuccess:t.operationSuccess}})],1):t._e(),t.id?i("el-tab-pane",{attrs:{label:"规格",name:"specification"}},[i("specification",{attrs:{open:t.open,id:t.id,isEdit:t.isEdit,tabSelection:t.tabSelection},on:{operationSuccess:t.operationSuccess}})],1):t._e()],1)},S=[],I=i("7132"),U=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"add-product-base-info"},[t.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}):t._e(),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"productDataForm",attrs:{"label-width":"130px",size:"small",model:t.productDataModel,rules:t.productDataRules,disabled:!t.isEdit,"inline-message":!0}},[i("el-form-item",{attrs:{label:"商品编号："}},[i("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:t.productDataModel.id?"请输入编号":"创建成功后自动生成",readonly:!0,disabled:!0},model:{value:t.productDataModel.sn,callback:function(e){t.$set(t.productDataModel,"sn",e)},expression:"productDataModel.sn"}})],1),i("el-form-item",{attrs:{label:"商品条码：",prop:"barCode"}},[i("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入条码"},model:{value:t.productDataModel.barCode,callback:function(e){t.$set(t.productDataModel,"barCode",e)},expression:"productDataModel.barCode"}})],1),i("el-form-item",{attrs:{label:"商品分类：",required:!0}},[i("el-cascader",{attrs:{options:t.categoryOptions,"change-on-select":"","show-all-levels":!1},on:{change:t.categoryChange},model:{value:t.productDataModel.categoryId,callback:function(e){t.$set(t.productDataModel,"categoryId",e)},expression:"productDataModel.categoryId"}})],1),i("product-category-select",{attrs:{initializing:t.initializing,refreshSign:t.refreshSign,brandId:t.productDataModel.brandId,categoryId:t.productDataModel.categoryId[0],seriesId:t.productDataModel.seriesId,name:t.productDataModel.name},on:{"update:brandId":function(e){return t.$set(t.productDataModel,"brandId",e)},"update:brand-id":function(e){return t.$set(t.productDataModel,"brandId",e)},"update:seriesId":function(e){return t.$set(t.productDataModel,"seriesId",e)},"update:series-id":function(e){return t.$set(t.productDataModel,"seriesId",e)},"update:name":function(e){return t.$set(t.productDataModel,"name",e)}}}),i("el-form-item",{attrs:{label:"批发价：",prop:"purchasePrice"}},[i("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入批发价"},model:{value:t.productDataModel.purchasePrice,callback:function(e){t.$set(t.productDataModel,"purchasePrice",e)},expression:"productDataModel.purchasePrice"}})],1),i("el-form-item",{attrs:{label:"商品缩略图：",prop:"image"}},[i("BizAvatarUploaderNew",{model:{value:t.productDataModel.image,callback:function(e){t.$set(t.productDataModel,"image",e)},expression:"productDataModel.image"}})],1),i("el-form-item",{attrs:{label:"支付方式：",prop:"paymentMethodIds"}},[i("el-checkbox-group",{model:{value:t.productDataModel.paymentMethodIds,callback:function(e){t.$set(t.productDataModel,"paymentMethodIds",e)},expression:"productDataModel.paymentMethodIds"}},t._l(t.payOptions,(function(e){return i("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])})),1)],1),i("el-form-item",{attrs:{label:"配送方式：",prop:"shippingMethodIds"}},[i("el-checkbox-group",{staticClass:"shipping-method",model:{value:t.productDataModel.shippingMethodIds,callback:function(e){t.$set(t.productDataModel,"shippingMethodIds",e)},expression:"productDataModel.shippingMethodIds"}},t._l(t.shippingMethods,(function(e){return i("el-checkbox",{key:e.id,attrs:{label:e.id,disabled:t.isCarOrService&&"到店服务"!==e.name}},[t._v(t._s(e.name))])})),1)],1)],1)],1)},k=[],z=(i("c975"),i("c17f")),F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"product-category-select"},[i("el-form",{attrs:{"label-width":"130px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"品牌："}},[i("el-select",{staticStyle:{width:"80%"},attrs:{value:t.brandId,placeholder:"请输入品牌"},on:{change:t.brandChange}},t._l(t.brandOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),i("el-form-item",{attrs:{label:"系列："}},[i("el-select",{staticStyle:{width:"80%"},attrs:{value:t.seriesId,placeholder:"请输入系列"},on:{change:t.seriesChange}},t._l(t.seriesOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),i("el-form-item",{attrs:{label:"名称：",required:!0}},[i("el-autocomplete",{attrs:{value:t.name,"fetch-suggestions":t.querySearchAsync,placeholder:"请输入名称"},on:{input:t.onInputName,select:t.selectName}})],1)],1)],1)},C=[],B=(i("4de4"),i("c596")),D={name:"ProductCategorySelect",data:function(){return{brandOptions:[],seriesOptions:[],restaurants:[]}},props:{initializing:{type:Boolean,default:!1},categoryId:{type:String,default:""},brandId:{type:String,default:""},seriesId:{type:String,default:""},name:{type:String,default:""}},computed:{},created:function(){},watch:{categoryId:function(t){t&&this.getBrands(),this.initializing||this.$emit("update:brandId","")},brandId:function(t){if(!t)return this.seriesOptions=[],void this.$emit("update:seriesId","");this.initializing||this.$emit("update:seriesId",""),this.getSeries()},seriesId:function(t){if(!t)return this.restaurants=[],void this.$emit("update:name","");this.initializing||this.$emit("update:name",""),this.getName()}},mounted:function(){},methods:{querySearchAsync:function(t,e){var i=this.restaurants,r=t?i.filter(this.createStateFilter(t)):i;clearTimeout(this.timeout),this.timeout=setTimeout((function(){e(r)}),300*Math.random())},createStateFilter:function(t){return function(t){return!0}},getBrands:function(){var t=this;if(""!==this.categoryId){var e={categoryId:this.categoryId};m["a"].get(B["g"].commodity.getBrands,e).then((function(e){t.brandOptions=e.brands}))}},getSeries:function(){var t=this;if(""!==this.brandId){var e={shopBrandId:this.brandId};m["a"].get(B["g"].commodity.getSeries,e).then((function(e){t.seriesOptions=e.series}))}},getName:function(){var t=this;if(""!==this.seriesId){var e={shopBrandId:this.brandId,shopSeriesId:this.seriesId};m["a"].get(B["g"].commodity.getName,e).then((function(e){t.restaurants=e.Type.map((function(t){return{value:t,id:t}}))}))}},categoryChange:function(t){this.$emit("update:categoryId",t)},brandChange:function(t){this.$emit("update:brandId",t)},seriesChange:function(t){this.$emit("update:seriesId",t)},onInputName:function(t){this.$emit("update:name",t)},selectName:function(t){this.$emit("update:name",t.value)}}},T=D,E=(i("a213"),Object(y["a"])(T,F,C,!1,null,null,null)),P=E.exports,M=i("cc55"),L=function t(e){var i,r=[],n=Object(a["a"])(e);try{for(n.s();!(i=n.n()).done;){var s=i.value,o={value:s.id,label:s.name};if(s.childrenProductCategoryDataList&&s.childrenProductCategoryDataList.length>0&&(o.children=t(s.childrenProductCategoryDataList)),s.children&&s.children.length>0){o.hasOwnProperty("children")||(o.children=[]);var l,d=A(s.childrenProductCategoryDataList),p=Object(a["a"])(d);try{for(p.s();!(l=p.n()).done;){var c=l.value;o.children.push(c)}}catch(h){p.e(h)}finally{p.f()}}r.push(o)}}catch(h){n.e(h)}finally{n.f()}return r},A=function(t){var e,i=[],r=Object(a["a"])(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;i.push({label:n.name,value:n.id})}}catch(s){r.e(s)}finally{r.f()}return i},R={name:"CommodityMgmtBaseInfo",data:function(){var t=this,e=function(e,i,r){t.productDataModel.categoryId&&t.productDataModel.categoryId.length>0?r():r(new Error("请选择商品分类"))},i=function(e,i,r){t.productDataModel.purchasePrice&&Number(t.productDataModel.purchasePrice)>=0?r():r(new Error("批发价必须为数字值"))},r=function(e,i,r){t.productDataModel.paymentMethodIds.length>0?r():r(new Error("请至少选择一种支付方式"))},n=function(e,i,r){t.productDataModel.shippingMethodIds.length>0?r():r(new Error("请至少选择一种配送方式"))},a=function(e,i,r){"undefined"!==typeof t.productDataModel.image&&""!==t.productDataModel.image?r():r(new Error("缩略图必须上传"))};return{operations:[{label:"保存",name:"save",type:"primary",disabled:!1}],productDataRules:{categoryId:[{required:!0,trigger:"blur",validator:e}],purchasePrice:[{required:!0,trigger:"blur",validator:i}],paymentMethodIds:[{required:!0,trigger:"blur",validator:r}],shippingMethodIds:[{required:!0,trigger:"blur",validator:n}],image:[{required:!0,trigger:"blur",validator:a}],name:[{required:!0,message:"请输入商品名称",trigger:"blur"}]},isCreated:"true",defaultImg:"/resources/admin/images/default/product-default.png",productDataModel:this.getDefaultProductDataModel(),categoryOptions:[],payOptions:[],shippingMethods:[],productCategoryManage:[],inputVisible:!1,inputValue:"",loading:!1,refreshSign:!0,initializing:!1}},components:{BizGrid:h["a"],BizSaveButton:c["a"],BizAvatarUploaderNew:z["b"],ProductCategorySelect:P},props:{id:{type:String,default:""},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}},baseInfo:{type:Object}},watch:{open:function(t){t?""!==this.id?this.isCreated=!1:(this.isCreated=!0,this.productDataModel=this.getDefaultProductDataModel(),this.queryPaymentMethods(),this.queryShippingMethods()):(this.isCreated=!0,this.payOptions=[],this.shippingMethods=[])},id:function(t,e){var i=this;t?!0===this.open&&"baseinfo"===this.tabSelection&&(this.getProductCategoryList(this.baseInfo.shopId),this.queryPaymentMethods(),this.queryShippingMethods(),this.$nextTick((function(){i.refresh()}))):this.productDataModel=this.getDefaultProductDataModel()}},created:function(){this.getDefaultImg(),this.getProductCategoryList()},computed:{isShowVin:function(){var t=this,e=!1;return this.productCategoryManage.map((function(i){console.log(i.name),i.id===t.productDataModel.categoryId[t.productDataModel.categoryId.length-1]&&"car"===i.type?e=!0:i.childrenProductCategoryDataList&&i.childrenProductCategoryDataList.map((function(i){i.id===t.productDataModel.categoryId[t.productDataModel.categoryId.length-1]&&"car"===i.type&&(e=!0)}))})),e},isCarOrService:function(){var t=this,e=!1;return console.log(this.productCategoryManage),this.productCategoryManage.map((function(i){console.log(i.name),i.id!==t.productDataModel.categoryId[t.productDataModel.categoryId.length-1]||"car"!==i.type&&"carService"!==i.type?i.childrenProductCategoryDataList&&i.childrenProductCategoryDataList.map((function(i){i.id!==t.productDataModel.categoryId[t.productDataModel.categoryId.length-1]||"car"!==i.type&&"carService"!==i.type||(e=!0)})):e=!0})),e}},methods:{operate:function(t){this[t]()},categoryChange:function(t){console.log(this.productDataModel.categoryId)},getDefaultImg:function(){var t=this,e={type:"displaySetting"};m["a"].get("/admin/settings/settings.jhtml",e).then((function(e){e.settingList.defaultThumbnailProductImage&&(t.defaultImg=e.settingList.defaultThumbnailProductImage)})).catch((function(e){console.log(e),console.log("code错误"),t.$message.warning(e.errorMessage)}))},getDefaultProductDataModel:function(){return{shopId:window.top.SHOP_ID||"",id:"",sn:"",categoryId:[],fullName:"",brandId:"",seriesId:"",name:"",image:this.defaultImg,purchasePrice:"",paymentMethodIds:[],shippingMethodIds:[],barCode:"",vin:""}},getSaveProductDataModel:function(){var t,e=this,i=[],r=Object(a["a"])(this.productDataModel.paymentMethodIds);try{for(r.s();!(t=r.n()).done;){var n=t.value;i.push({id:n})}}catch(d){r.e(d)}finally{r.f()}this.productCategoryManage.map((function(t){console.log(t.name),t.id!==e.productDataModel.categoryId[e.productDataModel.categoryId.length-1]||"car"!==t.type&&"carService"!==t.type?t.childrenProductCategoryDataList&&t.childrenProductCategoryDataList.map((function(t){t.id!==e.productDataModel.categoryId[e.productDataModel.categoryId.length-1]||"car"!==t.type&&"carService"!==t.type||e.shippingMethods.map((function(t){"到店服务"===t.name&&(e.productDataModel.shippingMethodIds=[t.id])}))})):e.shippingMethods.map((function(t){"到店服务"===t.name&&(e.productDataModel.shippingMethodIds=[t.id])}))}));var s,o=Object(a["a"])(this.shippingMethods);try{for(o.s();!(s=o.n()).done;){var l=s.value;l.productValid="0",-1!==this.productDataModel.shippingMethodIds.indexOf(l.id)&&(l.productValid="1")}}catch(d){o.e(d)}finally{o.f()}return{shopId:this.productDataModel.shopId,id:this.productDataModel.id,sn:this.productDataModel.sn,categoryId:this.productDataModel.categoryId[this.productDataModel.categoryId.length-1],brandId:this.productDataModel.brandId,seriesId:this.productDataModel.seriesId,name:this.productDataModel.name,fullName:this.productDataModel.fullName,image:this.productDataModel.image,purchasePrice:this.productDataModel.purchasePrice||"0",paymentMethods:i,shippingMethods:this.shippingMethods,barCode:this.productDataModel.barCode,vin:this.productDataModel.vin}},handleUploadSuccess:function(t){console.log(t),this.productDataModel.image=t},getParentCategory:function(t,e){var i=this;this.productDataModel.categoryId=[],t.forEach((function(t,r){if(t.value===e)return i.productDataModel.categoryId.unshift(t.value),!1;t.children&&t.children.forEach((function(r){if(r.value===e)return i.productDataModel.categoryId.unshift(r.value),i.productDataModel.categoryId.unshift(t.value),console.log(i.productDataModel.categoryId),!1;r.children&&r.children.forEach((function(n){if(n.value===e)return i.productDataModel.categoryId.unshift(n.value),i.productDataModel.categoryId.unshift(r.value),i.productDataModel.categoryId.unshift(t.value),!1;n.children&&n.children.forEach((function(a){if(a.value===e)return i.productDataModel.categoryId.unshift(a.value),i.productDataModel.categoryId.unshift(n.value),i.productDataModel.categoryId.unshift(r.value),i.productDataModel.categoryId.unshift(t.value),!1}))}))}))}))},queryPaymentMethods:function(){var t=this,e={shopId:window.top.SHOP_ID||""};m["a"].get(B["g"].invoicing.productMgmt.shopPaymentMethods,e).then((function(e){t.payOptions=e.paymentMethods,t.productDataModel.paymentMethodIds=[];var i,r=Object(a["a"])(t.payOptions);try{for(r.s();!(i=r.n()).done;){var n=i.value;t.productDataModel.paymentMethodIds.push(n.id)}}catch(s){r.e(s)}finally{r.f()}})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},queryShippingMethods:function(){var t=this,e={shopId:window.top.SHOP_ID||""};m["a"].get(B["g"].invoicing.productMgmt.shopShippingMethods,e).then((function(e){t.shippingMethods=e.dataList,t.productDataModel.shippingMethodIds=[];var i,r=Object(a["a"])(t.shippingMethods);try{for(r.s();!(i=r.n()).done;){var n=i.value;t.productDataModel.shippingMethodIds.push(n.id)}}catch(s){r.e(s)}finally{r.f()}})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},refresh:function(){var t=this;this.initializing=!0,this.loading=!0;var e={id:this.id,shopId:window.top.SHOP_ID||""};m["a"].get(B["g"].invoicing.productMgmt.supplierBasicInfo,e).then((function(e){t.refreshSign=!t.refreshSign,t.productDataModel=t.convert2ProductDataModel(e.data),t.getParentCategory(t.categoryOptions,t.productDataModel.categoryId[0]),t.$nextTick((function(){t.initializing=!1,t.loading=!1}))})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},convert2ProductDataModel:function(t){var e,i=[],r=Object(a["a"])(t.paymentMethods);try{for(r.s();!(e=r.n()).done;){var n=e.value;i.push(n.id)}}catch(p){r.e(p)}finally{r.f()}var s,o=[],l=Object(a["a"])(t.shippingMethods);try{for(l.s();!(s=l.n()).done;){var d=s.value;o.push(d.id)}}catch(p){l.e(p)}finally{l.f()}return{shopId:t.shopId,id:t.id,sn:t.sn,barCode:t.barCode,vin:t.vin,fullName:t.fullName,categoryId:[t.categoryId],brandId:t.brandId,seriesId:t.seriesId,name:t.name,image:t.image?t.image:this.defaultImg,purchasePrice:t.purchasePrice||"0.00",paymentMethodIds:i,shippingMethodIds:o}},save:function(){var t=this;""!==this.productDataModel.name?""!==this.productDataModel.categoryId[0]?this.$refs.productDataForm.validate((function(e){if(!e)return!1;t.isCreated?t.createProduct():t.updateProduct()})):this.$message.warning("商品分类不能为空"):this.$message.warning("商品名称不能为空")},createProduct:function(){var t=this,e=this.getSaveProductDataModel();m["a"].post(B["g"].invoicing.productMgmt.supplierBasicInfo,e).then((function(e){t.$message.success("添加商品基本信息成功"),t.id=e.id,t.isCreated=!1,t.refresh(),t.$emit("operationSuccess"),t.$emit("createdProductSuccess",e.id)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},updateProduct:function(){var t=this,e=this.getSaveProductDataModel();m["a"].put(B["g"].invoicing.productMgmt.supplierBasicInfo,e).then((function(e){t.refresh(),t.$message.success("更新商品基本信息成功"),t.$emit("operationSuccess")})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},getProductCategoryList:function(t){var e=this,i={shopId:t||window.top.SHOP_ID||"",pageNumber:1,pageSize:1e3};M["a"].getProductCategoryList(i,(function(t){e.productCategoryManage=t.ProductCategoryManage,e.categoryOptions=L(t.ProductCategoryManage),e.loading=!1}),(function(t){console.log(t),e.$message.warning(t.errorMessage),e.loading=!1}))}}},V=R,N=(i("a6a5"),Object(y["a"])(V,U,k,!1,null,null,null)),O=N.exports,G=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"category-mgmt__specification"},[t.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operateHandler},slot:"top"}):t._e(),i("el-form",{attrs:{size:"small",disabled:!t.isEdit,"inline-message":!0}},[i("label",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"}},[t._v("请选择商品规格：")]),i("div",{staticStyle:{margin:"15px"}}),i("el-form-item",[i("el-checkbox-group",{staticStyle:{"margin-left":"10px"},on:{change:t.handleCheckedChange},model:{value:t.checkedIds,callback:function(e){t.checkedIds=e},expression:"checkedIds"}},t._l(t.allSpecificationList,(function(e){return i("el-checkbox",{key:e.name,attrs:{label:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.commodityList}},[t._l(t.allSpecificationList,(function(e){return e.checked?i("el-table-column",{key:e.id,attrs:{label:e.name},scopedSlots:t._u([{key:"default",fn:function(r){return t._l(r.row.specificationValueData,(function(r){return i("div",{key:r.id,attrs:{label:r.name}},[i("el-select",{directives:[{name:"show",rawName:"v-show",value:e.id===r.specificationId,expression:"specification.id === valueItem.specificationId"}],attrs:{placeholder:"请选择"},model:{value:r.id,callback:function(e){t.$set(r,"id",e)},expression:"valueItem.id"}},t._l(e.options,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)}))}}],null,!0)}):t._e()})),t.showEditOperationColumn?i("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return t.isEdit?[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return t.rowDeleteClickHandler(e.row)}}},[t._v(" 删除 ")])]:void 0}}],null,!0)}):t._e()],2)],1)},H=[],j=(i("c740"),i("4b5f")),W={name:"Specification",components:{BizSaveButton:c["a"],BizGrid:h["a"]},data:function(){return{showEditOperationColumn:!1,operations:[{label:"增加规格商品",name:"addSpecificationCommodityOperation",type:"primary",disabled:!0},{label:"保存",name:"saveSpecificationEditOperation",type:"primary"}],checkedIds:[],allSpecificationList:[],commodityList:[]}},computed:{},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(t){"specification"===t&&""!==this.id&&this.query()},open:function(t){t||(this.checkedIds=[],this.allSpecificationList=[],this.commodityList=[],this.showEditOperationColumn=!1)}},created:function(){},methods:{refresh:function(){this.query()},query:function(){var t=this,e={shopId:window.top.SHOP_ID||"",id:this.id};j["a"].getSpecificationGroups(e,(function(e){t.allSpecificationList=t.getAllSpecificationList(e.categorySpecifications),t.allSpecificationList.length>0?t.operations[0].disabled=!1:t.operations[0].disabled=!0,t.commodityList=t.getCommodityList(e.allProductSpecifications),t.checkedIds=t.sortCheckedIds(),t.handleCheckedChange(t.checkedIds)}),(function(e){t.$message.warning(e.errorMessage)}))},getAllSpecificationList:function(t){var e=this,i=[];return t.forEach((function(t,r){i.push({id:t.id,name:t.name,type:t.type,sort:t.sort,options:e.getSpecificationValueOptions(t.specificationValueData),checked:!1})})),i},getSpecificationValueOptions:function(t){var e=[];return t.forEach((function(t,i){e.push({id:t.id,name:t.name,sort:t.sort,image:t.image,specificationId:t.specificationId})})),e},getCommodityList:function(t){var e=this,i=[];return t.forEach((function(t,r){i.push({productId:t.productData.id,specificationValueData:e.getCommoditySpecificationValueData(t.specificationValueDatas)})})),i},getCommoditySpecificationValueData:function(t){var e=this,i=[];return t.forEach((function(t,r){e.addCheckedIds(t.specificationId),i.push({id:t.id,name:t.name,sort:t.sort,image:t.image,specificationId:t.specificationId})})),i},addCheckedIds:function(t){var e=this.checkedIds.findIndex((function(e){return e===t}));-1===e&&this.checkedIds.push(t)},sortCheckedIds:function(){var t=this,e=[];return this.allSpecificationList.forEach((function(i,r){var n=t.checkedIds.findIndex((function(t){return t===i.id}));-1!==n&&e.push(t.checkedIds[n])})),e},update:function(){var t=this,e=this.getAllProductSpecificationsParams();this.hasProductWithSameSpecification(e)?this.$message.warning("不能创建相同的商品规格"):j["a"].updateSpecificationGroups(e,(function(e){t.$message.success("更新商品规格成功"),t.query(),t.$emit("operationSuccess")}),(function(e){t.$message.warning(e.errorMessage)}))},hasProductWithSameSpecification:function(t){var e=this,i=!1;return t.forEach((function(r,n){!0!==i&&t.forEach((function(t,n){!0!==i&&r.productData.id!==t.productData.id&&e.isSameSpecificationValueDatas(r.specificationValueDatas,t.specificationValueDatas)&&(i=!0)}))})),i},isSameSpecificationValueDatas:function(t,e){var i=!0;return t.forEach((function(t,r){var n=e.findIndex((function(e){return e.id===t.id}));-1===n&&(i=!1)})),i},getAllProductSpecificationsParams:function(){var t=this,e=[];return this.commodityList.forEach((function(i,r){e.push({productData:t.getProductDataParams(i.productId),specificationValueDatas:t.getSpecificationValueDatasaParams(i.specificationValueData)})})),e},getProductDataParams:function(t){return{id:t,parameterGroups:[],productImages:[],productImageDatas:[],reviews:[],specificationGroups:[]}},getSpecificationValueDatasaParams:function(t){var e=this,i=[];return t.forEach((function(t,r){var n=e.checkedIds.findIndex((function(e){return e===t.specificationId}));-1!==n&&i.push({id:t.id,name:t.name,image:t.image,sort:t.sort,specificationId:t.specificationId})})),i},operateHandler:function(t){this[t]()},rowDeleteClickHandler:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=[];i.push(t.productId);var r={ids:i};e.commodityList.splice(e.commodityList.indexOf(t),1),f["a"].delete(r,(function(i){e.$message({type:"success",message:"删除成功!"}),e.$emit("operationSuccess"),t.productId===e.id?e.$emit("close"):e.query()}),(function(t){console.log(t)}))})).catch((function(){}))},addSpecificationCommodityOperation:function(){if(!this.showEditOperationColumn)return this.$message.warning("请选择商品规格"),!1;var t={productId:"",specificationValueData:this.getNewSpecificationValueList()};this.commodityList.push(t)},getNewSpecificationValueList:function(){var t=this,e=[];return this.checkedIds.forEach((function(i,r){var n=t.allSpecificationList.findIndex((function(t){return t.id===i}));-1!==n&&e.push({id:"",name:"",image:"",sort:"",specificationId:t.allSpecificationList[n].id})})),e},handleCheckedChange:function(t){var e=this;this.allSpecificationList.forEach((function(i,r){var n=t.findIndex((function(t){return t===i.id}));if(-1!==n)return e.allSpecificationList[r].checked=!0,e.AddNewColumn2Commodity(e.allSpecificationList[r]),!0;e.allSpecificationList[r].checked=!1})),this.showEditOperationColumn=this.hasCheckedSpecification()},hasCheckedSpecification:function(){var t=!1;return this.allSpecificationList.forEach((function(e,i){e.checked&&(t=!0)})),t},AddNewColumn2Commodity:function(t){this.commodityList.forEach((function(e,i){var r=e.specificationValueData.findIndex((function(e){return e.specificationId===t.id}));-1===r&&e.specificationValueData.push({id:"",name:"",image:"",sort:"",specificationId:t.id})}))},saveSpecificationEditOperation:function(){this.update()}}},Z=W,$=(i("ad5b"),Object(y["a"])(Z,G,H,!1,null,null,null)),Y=$.exports,J=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"propetry-base-info"},[t.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}):t._e(),i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"106px",size:"small",disabled:!t.isEdit,"inline-message":!0}},[i("el-form-item",{attrs:{label:"商品介绍"}}),i("div",{staticClass:"h-editor"},[i("biz-editor",{attrs:{height:"400px",width:"430px"},model:{value:t.form.introduction,callback:function(e){t.$set(t.form,"introduction",e)},expression:"form.introduction"}})],1),i("el-form-item",{attrs:{label:"购买须知"}}),i("div",{staticClass:"h-editor"},[i("biz-editor",{attrs:{height:"400px",width:"430px"},model:{value:t.form.notice,callback:function(e){t.$set(t.form,"notice",e)},expression:"form.notice"}})],1),i("el-form-item",{attrs:{label:"产品售后"}}),i("div",{staticClass:"h-editor"},[i("biz-editor",{attrs:{height:"400px",width:"430px"},model:{value:t.form.afterSale,callback:function(e){t.$set(t.form,"afterSale",e)},expression:"form.afterSale"}})],1),i("el-form-item",{attrs:{label:"语音播报介绍","label-width":"135px"}}),i("div",{staticClass:"y-editor"},[i("el-input",{attrs:{type:"textarea",maxlength:"200",autosize:{minRows:5,maxRows:8}},model:{value:t.form.memo,callback:function(e){t.$set(t.form,"memo",e)},expression:"form.memo"}})],1)],1)],1)},q=[],X=i("40ae"),Q=i("392e"),K={name:"CommodityMgmtBaseInfo",data:function(){return{isCreated:!1,operations:[{label:"保存",name:"update",type:"primary"}],form:{introduction:"",notice:"",afterSale:"",memo:""}}},props:{id:{type:String},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(t){"detail"===t&&""!==this.id&&this.refresh()},open:function(t){t||(this.form.introduction="",this.form.notice="",this.form.afterSale="",this.form.memo="")}},components:{BizSaveButton:c["a"],BizGrid:h["a"],BizEditor:X["a"]},created:function(){},computed:{},methods:{checkVideo:function(t){this.$message.warning(t)},operate:function(t){this[t]()},onSubmit:function(){console.log("submit!")},refresh:function(){var t=this,e={id:this.id};this.isCreated=!0,Q["a"].queryProductDetail(e,(function(e){t.form.introduction=e.introduction,t.form.notice=e.notice,t.form.afterSale=e.afterSale,t.form.memo=e.memo,t.$nextTick((function(){t.isCreated=!1}))}),(function(t){console.log(t)}))},update:function(){var t=this,e={id:this.id,introduction:this.form.introduction,notice:this.form.notice,afterSale:this.form.afterSale,memo:this.form.memo};Q["a"].updateProductDetail(e,(function(e){t.$message.success("操作成功")}),(function(e){""!==e.errorMessage&&t.$message.warning(e.errorMessage),console.log(e)}))}}},tt=K,et=(i("f3a0"),Object(y["a"])(tt,J,q,!1,null,null,null)),it=et.exports,rt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"commodity-mgmt-picture-info"},[t.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}):t._e(),i("el-form",{ref:"form",attrs:{size:"small","label-position":"top","label-width":"110px",disabled:!t.isEdit,"inline-message":!0}},[i("el-form-item",{attrs:{label:"所有图片限制200K以下,建议尺寸3:2"}}),i("el-form-item",{attrs:{label:"轮播主图管理"}},[i("ProductAvatarPictureCardUploader",{class:{disabled:t.uploadDisabled},attrs:{imageList:t.carouselImages,productId:t.id,isMainPicture:!0},on:{"upload-success":t.handleCarouselUpload,"remove-success":t.handleCarouselRemove}})],1),i("el-form-item",{attrs:{label:"VR资源管理"}},[i("el-radio-group",{on:{change:t.sourceTypeChange},model:{value:t.sourceType,callback:function(e){t.sourceType=e},expression:"sourceType"}},[i("el-radio",{attrs:{label:"0"}},[t._v("本地资源包")]),i("el-radio",{attrs:{label:"1"}},[t._v("第三方资源地址")])],1),i("ProductVrFileUploader",{directives:[{name:"show",rawName:"v-show",value:"0"===t.sourceType,expression:"sourceType==='0'"}],attrs:{open:t.open,fileList:t.vrFileList,productId:t.id,isTestDrive:!1},on:{"upload-success":t.handleVRUpload,"remove-success":t.handleVRRemove}}),i("el-input",{directives:[{name:"show",rawName:"v-show",value:"1"===t.sourceType,expression:"sourceType==='1'"}],attrs:{type:"textarea",autosize:{minRows:5,maxRows:8}},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}})],1),i("el-form-item",{attrs:{label:"试驾视频 (请上传视频文件)"}},[i("ProductVrFileUploader",{attrs:{open:t.open,fileList:t.testDriverList,productId:t.id,isTestDrive:!0},on:{"upload-success":t.handleTestDriveUpload,"remove-success":t.handleTestDriveRemove}})],1),i("el-form-item",{attrs:{label:"内饰图片管理"}},[i("ProductAvatarPictureCardUploader",{attrs:{imageList:t.interiorsImages,productId:t.id},on:{"upload-success":t.handleInteriorsUpload,"remove-success":t.handleInteriorsRemove}})],1),i("el-form-item",{attrs:{label:"空间图片管理"}},[i("ProductAvatarPictureCardUploader",{attrs:{imageList:t.spaceImages,productId:t.id},on:{"upload-success":t.handleSpaceUpload,"remove-success":t.handleSpaceRemove}})],1),i("el-form-item",{attrs:{label:"图解资源管理"}},[i("ProductAvatarPictureCardUploader",{attrs:{imageList:t.diagramImages,productId:t.id},on:{"upload-success":t.handleDiagramUpload,"remove-success":t.handleDiagramRemove}})],1),i("el-form-item",{attrs:{label:"车身图片管理"}},[i("el-col",{attrs:{span:11}},[i("el-input",{model:{value:t.fullScreenName,callback:function(e){t.fullScreenName=e},expression:"fullScreenName"}})],1),i("el-col",{attrs:{span:11}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.addFullScreen(e)}}},[t._v("添加颜色")])],1)],1),t._l(t.fullScreenList,(function(e){return i("el-form-item",{key:e.name},[i("el-tag",{attrs:{closable:!t.hasFullScreenImages(e),"disable-transitions":!1,type:"info",size:"warning"},on:{close:function(i){return t.handleCloseFullScreen(e)}}},[t._v(" "+t._s(e.name)+" ")]),i("ProductAvatarPictureCardUploader",{attrs:{imageList:e.fullScreenImages,parentElementName:e.name},on:{"upload-success":t.handleFullScreenUpload,"remove-success":t.handleFullScreenRemove}})],1)})),i("el-form-item",{attrs:{label:"360图片管理"}},[i("el-col",{attrs:{span:11}},[i("el-input",{model:{value:t.appearanceName,callback:function(e){t.appearanceName=e},expression:"appearanceName"}})],1),i("el-col",{attrs:{span:11}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.addAppearance(e)}}},[t._v("添加颜色")])],1)],1),t._l(t.appearanceList,(function(e){return i("el-form-item",{key:e.name},[i("el-tag",{attrs:{closable:!t.hasAppearanceImages(e),"disable-transitions":!1,type:"info",size:"warning"},on:{close:function(i){return t.handleClose(e)}}},[t._v(" "+t._s(e.name)+" ")]),i("ProductAvatarPictureCardUploader",{attrs:{imageList:e.appearanceImages,parentElementName:e.name},on:{"upload-success":t.handleAppearanceUpload,"remove-success":t.handleAppearanceRemove}})],1)}))],2)],1)},nt=[],at=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"product-vr-file-uploader"},[i("el-upload",{attrs:{accept:"application/zip,video/*",name:t.uploadName,action:t.uploadAction,data:t.uploadData,"file-list":t.fileList,"on-remove":t.handleRemove,"on-success":t.handleSuccess,"on-error":t.handleError,"before-upload":t.beforeAvatarUpload}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasFile(),expression:"hasFile()"}],attrs:{size:"small",type:"primary",disabled:!t.preview,loading:t.loading},on:{click:function(e){return e.stopPropagation(),t.handlePreview(e)}}},[t._v("预览")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasFile(),expression:"hasFile()"}],attrs:{size:"small",type:"primary",disabled:t.preview},on:{click:function(e){return e.stopPropagation(),t.handlePreview(e)}}},[t._v("取消预览")]),i("iframe",{directives:[{name:"show",rawName:"v-show",value:!t.preview,expression:"!preview"}],ref:"vrFrame",staticClass:"vrframe",attrs:{src:t.url,frameborder:"0"}})],1)},st=[],ot=(i("baa5"),i("bc3a")),lt=i.n(ot),dt={name:"ProductVrFileUploader",data:function(){return{preview:!0,loading:!1,url:""}},props:{isTestDrive:{type:Boolean,default:!1},productId:String,open:{type:Boolean,default:!1},fileList:{type:Array,default:function(){return[]}}},watch:{open:function(t){t||(this.url="",this.preview=!0)}},computed:{uploadAction:function(){return this.isTestDrive?"/admin/file/uploads.jhtml":"/admin/shopProduct/productVrZip.jhtml"},uploadName:function(){return this.isTestDrive?"file":"uploadFile0"},uploadData:function(){return this.isTestDrive?{type:"2"}:{productId:this.productId}}},methods:{handlePreview:function(){var t=this;if(this.isTestDrive)!0===this.preview?(this.url=this.getFilePath(),setTimeout((function(){t.preview=!1}),800)):(this.url="",this.preview=!0);else if(!0===this.preview){var e=this.getFilePath();this.loading=!0,lt.a.get(e).then((function(e){t.loading=!1,t.url=t.getFilePath(),t.$refs.vrFrame.contentWindow.location.reload(!0),setTimeout((function(){t.preview=!1}),800),console.log("url请求成功")})).catch((function(e){t.loading=!1,404===e.response.status?t.$message.warning("文件解析,十分钟后可预览"):console.log("url请求失败:",e.response)}))}else this.url="",this.loading=!1,this.preview=!0},handleRemove:function(t,e){this.$emit("remove-success",t,e),this.url="",this.preview=!0},handleSuccess:function(t,e,i){this.$emit("upload-success",t,e,i),this.url="",this.preview=!0},beforeAvatarUpload:function(t){if(this.isTestDrive){var e=/^video\/(.*)$/.test(t.type);return e||this.$message.error("请选择符合视频格式的文件上传!"),e}var i="application/zip"===t.type;if(!i){var r=t.name.substring(t.name.lastIndexOf(".")).toLowerCase();if(".zip"!==r)return this.$message.error("请选择zip格式的VR资源包!"),i}var n=t.size/1024/1024<=200;return n||this.$message.error("请上传小于200M的文件!"),n},handleError:function(t,e,i){t?this.$message.warning(t):this.$message.warning("发生错误")},hasFile:function(){return 0!==this.fileList.length},getFilePath:function(){if(0!==this.fileList.length){var t=this.fileList[0].url.indexOf("/upload/");if(-1===t)return console.log("文件路径错误",this.fileList[0].url),"";var e=location.protocol+"//"+location.host,i=this.fileList[0].url.substr(t),r=e+i;return this.isTestDrive||(r+="/index.html"),console.log("src",r),r}return""}}},pt=dt,ct=(i("0c6f"),Object(y["a"])(pt,at,st,!1,null,null,null)),ht=ct.exports,ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"product-avatar-picture-card-uploader"},[i("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{accept:"image/*","list-type":"picture-card","file-list":t.imageList,name:"uploadFile0","on-success":t.handleSuccess,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"before-upload":t.beforeAvatarUpload,action:t.uploadAction,data:t.uploadData,multiple:""}},[i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),i("el-dialog",{staticClass:"avatar-preview-dialog",attrs:{"append-to-body":!0,visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"review"},[i("img",{attrs:{src:t.imgUrl,alt:""}})])])],1)},ft=[],mt={name:"ProductAvatarPictureCardUploader",data:function(){return{imgUrl:{type:String,default:""},dialogVisible:!1}},props:{parentElementName:String,shopId:window.top.SHOP_ID||"",productId:String,isMainPicture:{type:Boolean,default:function(){return!1}},imageList:{type:Array,default:function(){return[]}}},computed:{uploadAction:function(){return this.isMainPicture?"/admin/shopProduct/productImagesFile.jhtml":"/admin/vrMedia/uploadVrImage.jhtml"},uploadData:function(){return console.log("uploadData"),{shopId:window.top.SHOP_ID||"",productId:this.productId,type:"0"}}},methods:{handleRemove:function(t,e){this.$emit("remove-success",t)},handlePreview:function(t){this.imgUrl=t.url,this.dialogVisible=!0},handleSuccess:function(t,e,i){this.$emit("upload-success",t,e,this.parentElementName)},beforeAvatarUpload:function(t){var e=/^image\/(.*)$/.test(t.type);if(!e)return this.$message.error("请选择符合图片格式的文件上传!"),!1;var i=t.size/1024<=200;return i?!this.isMainPicture||(this.$refs.upload.$refs["upload-inner"].fileList.length<=5||(this.$message.error("轮播主图最多可添加5个"),!1)):(this.$message.error("上传图片大小不能超过 200K!"),!1)}}},gt=mt,bt=(i("c047"),Object(y["a"])(gt,ut,ft,!1,null,null,null)),yt=bt.exports,vt=i("2299"),xt={name:"CommodityMgmtPictureInfo",components:{BizSaveButton:c["a"],BizGrid:h["a"],ProductVrFileUploader:ht,ProductAvatarPictureCardUploader:yt},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"}],preview:!1,appearanceName:"",fullScreenName:"",image:"",wideImage:"",VrMediaData:[],productImageDatas:[],sourceType:"0",defaultType:"",url:"",carouselImages:[],vrFileList:[],testDriverList:[],interiorsImages:[],spaceImages:[],diagramImages:[],fullScreenList:[],appearanceList:[]}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(t){"pictureInfo"===t&&""!==this.id&&this.query()},open:function(t){t||(this.image="",this.wideImage="",this.VrMediaData=[],this.productImageDatas=[],this.carouselImages=[],this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.fullScreenList=[],this.appearanceList=[])}},created:function(){},computed:{uploadDisabled:function(){return this.productImageDatas.length>=5}},methods:{operate:function(t){this[t]()},sourceTypeChange:function(t){t!==this.defaultType&&("0"===t?this.vrFileList=[]:this.url="")},addAppearance:function(){var t=this;if(this.appearanceName){var e=this.appearanceList.findIndex((function(e){return e.name===t.appearanceName}));if(-1===e){var i={name:this.appearanceName,appearanceImages:[]};this.appearanceList.push(i)}this.appearanceName=""}},addFullScreen:function(){var t=this;if(this.fullScreenName){var e=this.fullScreenList.findIndex((function(e){return e.name===t.fullScreenName}));if(-1===e){var i={name:this.fullScreenName,fullScreenImages:[]};this.fullScreenList.push(i)}this.fullScreenName=""}},updateCarouselImages:function(){for(var t=[],e=0;e<this.productImageDatas.length;e++)t.push({name:this.productImageDatas[e].title,url:this.productImageDatas[e].source});this.carouselImages=t},updateVrData:function(){var t=this;this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.fullScreenImages=[],this.appearanceList=[],this.fullScreenList=[],this.vrFileList=[],this.testDriverList=[];for(var e=function(e){var i={url:t.VrMediaData[e].filePath,color:t.VrMediaData[e].color,mediaType:t.VrMediaData[e].mediaType};if("vr"===t.VrMediaData[e].mediaType)t.vrFileList.push({name:t.VrMediaData[e].filePath,url:t.VrMediaData[e].filePath});else if("testdrive"===t.VrMediaData[e].mediaType)t.testDriverList.push({name:t.VrMediaData[e].filePath,url:t.VrMediaData[e].filePath});else if("interiors"===t.VrMediaData[e].mediaType)t.interiorsImages.push(i);else if("space"===t.VrMediaData[e].mediaType)t.spaceImages.push(i);else if("diagram"===t.VrMediaData[e].mediaType)t.diagramImages.push(i);else if("facade"===t.VrMediaData[e].mediaType){if(t.VrMediaData[e].color){var r=t.fullScreenList.findIndex((function(i){return i.name===t.VrMediaData[e].color}));if(-1===r){var n={name:t.VrMediaData[e].color,fullScreenImages:[]};n.fullScreenImages.push(i),t.fullScreenList.push(n)}else t.fullScreenList[r].fullScreenImages.push(i)}}else if("appearance"===t.VrMediaData[e].mediaType&&t.VrMediaData[e].color){var a=t.appearanceList.findIndex((function(i){return i.name===t.VrMediaData[e].color}));if(-1===a){var s={name:t.VrMediaData[e].color,appearanceImages:[]};s.appearanceImages.push(i),t.appearanceList.push(s)}else t.appearanceList[a].appearanceImages.push(i)}},i=0;i<this.VrMediaData.length;i++)e(i)},handleCarouselUpload:function(t,e){"100"===t.resultCode&&this.productImageDatas.push({large:t.map[0].large,medium:t.map[0].medium,order:"",source:t.map[0].source,thumbnail:t.map[0].thumbnail,title:e.name})},handleCarouselRemove:function(t){var e=this.productImageDatas.findIndex((function(e){return e.source===t.url}));-1===e?(e=this.productImageDatas.findIndex((function(e){return e.source===t.response.map[0].source})),-1!==e&&this.productImageDatas.splice(e,1)):this.productImageDatas.splice(e,1)},getImage:function(t){return{color:"",fileName:this.getFileName(t),filePath:"",id:"",large:"",mediaType:t,medium:"",sortSn:"",thumbnail:"",sourceType:this.sourceType,title:this.getTitle(t),zipKey:""}},getFileName:function(t){return"interiors"===t?"inside":"space"===t?"size":"diagram"===t?"pictureInfo":"appearance"===t||"facade"===t?"car":"testdrive"===t?"drive":"vr"===t?"vr":""},getTitle:function(t){return"interiors"===t?"内饰":"space"===t?"空间":"diagram"===t?"图解":"appearance"===t?"360":"facade"===t?"外观":"testdrive"===t?"试驾":"vr"===t?"VR":""},handleVRUpload:function(t,e,i){if("100"===t.resultCode){var r=this.getImage("vr");r.filePath=t.path,this.AddVrData(r);var n=[];n.push({name:t.path,url:t.path}),this.vrFileList=n}},handleVRRemove:function(t,e){this.vrFileList=[];var i=this.VrMediaData.findIndex((function(e){return"vr"===e.mediaType&&e.filePath===t.url}));-1===i?(i=this.VrMediaData.findIndex((function(e){return"vr"===e.mediaType&&e.filePath===t.response.map[0].source})),-1!==i&&this.VrMediaData.splice(i,1)):this.VrMediaData.splice(i,1)},handleTestDriveUpload:function(t,e,i){if("100"===t.resultCode){var r=this.getImage("testdrive");r.filePath=t.urls[0],this.AddVrData(r);var n=[];n.push({name:t.urls[0],url:t.urls[0]}),this.testDriverList=n}},handleTestDriveRemove:function(t,e){this.testDriverList=[];var i=this.VrMediaData.findIndex((function(e){return"testdrive"===e.mediaType&&e.filePath===t.url}));-1===i?(i=this.VrMediaData.findIndex((function(e){return"testdrive"===e.mediaType&&e.filePath===t.response.urls[0]})),-1!==i&&this.VrMediaData.splice(i,1)):this.VrMediaData.splice(i,1)},handleInteriorsUpload:function(t,e){if("100"===t.resultCode){var i=this.getImage("interiors");i.filePath=t.map[0].source,i.large=t.map[0].large,i.medium=t.map[0].medium,i.thumbnail=t.map[0].thumbnail,this.AddVrData(i)}},handleInteriorsRemove:function(t){var e=this.VrMediaData.findIndex((function(e){return"interiors"===e.mediaType&&e.filePath===t.url}));-1===e?(e=this.VrMediaData.findIndex((function(e){return"interiors"===e.mediaType&&e.filePath===t.response.map[0].source})),-1!==e&&this.VrMediaData.splice(e,1)):this.VrMediaData.splice(e,1)},handleSpaceUpload:function(t,e){if("100"===t.resultCode){var i=this.getImage("space");i.filePath=t.map[0].source,i.large=t.map[0].large,i.medium=t.map[0].medium,i.thumbnail=t.map[0].thumbnail,this.AddVrData(i)}},handleSpaceRemove:function(t){var e=this.VrMediaData.findIndex((function(e){return"space"===e.mediaType&&e.filePath===t.url}));-1===e?(e=this.VrMediaData.findIndex((function(e){return"space"===e.mediaType&&e.filePath===t.response.map[0].source})),-1!==e&&this.VrMediaData.splice(e,1)):this.VrMediaData.splice(e,1)},handleFullScreenUpload:function(t,e,i){if("100"===t.resultCode){var r=this.getImage("facade");r.color=i,r.filePath=t.map[0].large,r.large=t.map[0].large,r.medium=t.map[0].medium,r.thumbnail=t.map[0].thumbnail,r.fileName=t.map[0].fileName,r.source=t.map[0].source,this.AddVrData(r)}},handleFullScreenRemove:function(t){var e=this.VrMediaData.findIndex((function(e){return"facade"===e.mediaType&&e.filePath===t.url}));-1===e?(e=this.VrMediaData.findIndex((function(e){return"facade"===e.mediaType&&e.filePath===t.response.map[0].large})),-1!==e&&this.VrMediaData.splice(e,1)):this.VrMediaData.splice(e,1)},handleDiagramUpload:function(t,e){if("100"===t.resultCode){var i=this.getImage("diagram");i.filePath=t.map[0].source,i.large=t.map[0].large,i.medium=t.map[0].medium,i.thumbnail=t.map[0].thumbnail,this.AddVrData(i)}},handleDiagramRemove:function(t){var e=this.VrMediaData.findIndex((function(e){return"diagram"===e.mediaType&&e.filePath===t.url}));-1===e?(e=this.VrMediaData.findIndex((function(e){return"diagram"===e.mediaType&&e.filePath===t.response.map[0].source})),-1!==e&&this.VrMediaData.splice(e,1)):this.VrMediaData.splice(e,1)},handleAppearanceUpload:function(t,e,i){if("100"===t.resultCode){var r=this.getImage("appearance");r.color=i,r.filePath=t.map[0].large,r.large=t.map[0].large,r.medium=t.map[0].medium,r.thumbnail=t.map[0].thumbnail,r.fileName=t.map[0].fileName,r.source=t.map[0].source,this.AddVrData(r)}},handleAppearanceRemove:function(t){var e=this.VrMediaData.findIndex((function(e){return"appearance"===e.mediaType&&e.filePath===t.url}));-1===e?(e=this.VrMediaData.findIndex((function(e){return"appearance"===e.mediaType&&e.filePath===t.response.map[0].large})),-1!==e&&this.VrMediaData.splice(e,1)):this.VrMediaData.splice(e,1)},AddVrData:function(t){if("vr"===t.mediaType||"testdrive"===t.mediaType){var e=this.VrMediaData.findIndex((function(e){return e.mediaType===t.mediaType}));-1!==e?this.VrMediaData[e]=t:this.VrMediaData.push(t)}else this.VrMediaData.push(t)},DelVrData:function(t){var e=this.VrMediaData.findIndex((function(e){return e.filePath===t.url}));-1!==e&&this.VrMediaData.splice(e,1)},query:function(){var t=this,e={id:this.id};vt["a"].getImageGroups(e,(function(e){t.image=e.image,t.wideImage=e.wideImage,t.VrMediaData=e.VrMediaData,t.productImageDatas=e.productImageDatas,t.updateCarouselImages(),t.updateVrData(),t.VrMediaData.map((function(e){"vr"===e.mediaType&&(t.sourceType=e.sourceType,t.defaultType=e.sourceType,t.url=e.filePath)})),console.log("获取商品图片成功")}),(function(e){""!==e.errorMessage&&t.$message.warning(e.errorMessage),console.log("获取商品图片失败",t.id)}))},save:function(){var t=this,e={id:this.id,shopId:window.top.SHOP_ID||"",image:this.image,wideImage:this.wideImage,productImageDatas:this.productImageDatas};vt["a"].updateImageGroups(e,(function(e){t.saveVR(!0)}),(function(e){""!==e.errorMessage&&t.$message.warning(e.errorMessage),t.saveVR(!1),console.log("更新商品轮播主图失败",t.id)}))},saveVR:function(t){var e=this;"1"===this.sourceType&&this.VrMediaData.push({color:"",fileName:"vr",filePath:this.url,id:"",large:"",mediaType:"vr",medium:"",sortSn:"",thumbnail:"",sourceType:this.sourceType,title:"vr",zipKey:""});var i={productId:this.id,shopId:window.top.SHOP_ID||"",datas:this.VrMediaData};vt["a"].updateProductVrMediaBath(i,(function(t){e.query(),e.$message.success("更新商品图片成功")}),(function(i){""!==i.errorMessage&&e.$message.warning(i.errorMessage),!0===t&&e.query(),console.log("更新商品VR资源失败",e.id)}))},handleClose:function(t){this.appearanceList=this.appearanceList.filter((function(e){return e.name!==t.name}))},handleCloseFullScreen:function(t){this.fullScreenList=this.fullScreenList.filter((function(e){return e.name!==t.name}))},hasFullScreenImages:function(t){var e=this.VrMediaData.findIndex((function(e){return"fullScreen"===e.mediaType&&e.color===t.name}));return-1!==e},hasAppearanceImages:function(t){var e=this.VrMediaData.findIndex((function(e){return"appearance"===e.mediaType&&e.color===t.name}));return-1!==e}}},_t=xt,wt=(i("d431"),Object(y["a"])(_t,rt,nt,!1,null,null,null)),St=wt.exports,It=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"commodity-mgmt-parameter"},[t.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}):t._e(),i("el-form",{ref:"form",attrs:{size:"small","label-width":"120px",disabled:!t.isEdit,"inline-message":!0}},t._l(t.parameterGroups,(function(e){return i("div",{key:e.id},[i("el-form-item",{staticStyle:{"font-weight":"bold"},attrs:{label:e.name+"："}}),t._l(e.parameters,(function(e){return i("el-form-item",{key:e.id,attrs:{label:e.name+"：",value:e.id}},["1"===e.type?i("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"parameter.value"}},t._l(t.configureOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.value}})})),1):"2"===e.type?i("el-select",{staticStyle:{width:"80%"},attrs:{filterable:"","allow-create":"",clearable:""},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"parameter.value"}},t._l(t.assembleOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.value}})})),1):i("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入参数"},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"parameter.value"}})],1)}))],2)})),0)],1)},Ut=[],kt=i("44e0"),zt={name:"CommodityMgmtParameter",components:{BizSaveButton:c["a"],BizGrid:h["a"]},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"}],configureOptions:[{id:"0",name:"-",value:"-"},{id:"1",name:"●",value:"●"},{id:"2",name:"○",value:"○"}],assembleOptions:[{id:"0",name:"主-/副-",value:"主-/副-"},{id:"1",name:"主-/副●",value:"主-/副●"},{id:"2",name:"主-/副○",value:"主-/副○"},{id:"3",name:"主●/副-",value:"主●/副-"},{id:"4",name:"主●/副●",value:"主●/副●"},{id:"5",name:"主●/副○",value:"主●/副○"},{id:"6",name:"主○/副-",value:"主○/副-"},{id:"7",name:"主○/副●",value:"主○/副●"},{id:"8",name:"主○/副○",value:"主○/副○"},{id:"9",name:"前-/后-",value:"前-/后-"},{id:"10",name:"前-/后●",value:"前-/后●"},{id:"11",name:"前-/后○",value:"前-/后○"},{id:"12",name:"前●/后-",value:"前●/后-"},{id:"13",name:"前●/后●",value:"前●/后●"},{id:"14",name:"前●/后○",value:"前●/后○"},{id:"15",name:"前○/后-",value:"前○/后-"},{id:"16",name:"前○/后●",value:"前○/后●"},{id:"17",name:"前○/后○",value:"前○/后○"},{id:"18",name:"自动-",value:"自动-"},{id:"19",name:"自动●",value:"自动●"},{id:"20",name:"自动○",value:"自动○"},{id:"21",name:"手动-",value:"手动-"},{id:"22",name:"手动●",value:"手动●"},{id:"23",name:"手动○",value:"手动○"}],parameterGroups:[]}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(t){"parameter"===t&&""!==this.id&&this.query()},open:function(t){t||(this.parameterGroups=[])}},created:function(){},computed:{},methods:{operate:function(t){this[t]()},query:function(){var t=this,e={id:this.id};kt["a"].getParameterGroups(e,(function(e){t.parameterGroups=e.parameterGroups,console.log("获取商品参数成功")}),(function(e){""!==e.errorMessage&&t.$message.warning(e.errorMessage),console.log("获取商品参数失败",t.id)}))},save:function(){var t=this,e={id:this.id,parameterGroups:this.parameterGroups};kt["a"].updateParameterGroups(e,(function(e){t.query(),t.$message.success("更新商品参数成功")}),(function(e){""!==e.errorMessage&&t.$message.warning(e.errorMessage),console.log("更新商品参数失败",t.id)}))}}},Ft=zt,Ct=(i("868c"),Object(y["a"])(Ft,It,Ut,!1,null,null,null)),Bt=Ct.exports,Dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vin-code"},[i("biz-flex-table",{attrs:{operations:t.operations,filters:t.filters,tableData:t.tableData,pagination:t.pagination},on:{operate:t.operate,"filter-data-change":t.filterDataChange,"selection-change":t.handleSelectionChange,"row-click":t.rowClick,"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},[i("el-table-column",{attrs:{"min-width":"100",prop:"number",label:"车辆识别码（VIN码）"}}),i("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(i){return i.stopPropagation(),t.del(e.row.id)}}},[t._v("删除")])]}}])})],1),i("el-card",{directives:[{name:"show",rawName:"v-show",value:t.showForm,expression:"showForm"}],staticClass:"box-card",staticStyle:{position:"absolute",bottom:"0px",width:"100%"}},[i("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:t.formModel,rules:t.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"车辆识别码",prop:"number"}},[i("el-input",{attrs:{placeholder:"请输入车辆识别码"},model:{value:t.formModel.number,callback:function(e){t.$set(t.formModel,"number",e)},expression:"formModel.number"}})],1)],1),i("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:t.formOperations},on:{operate:t.handleOperate}})],1)],1)},Tt=[],Et={name:"RecordsList",data:function(){return{timer:null,formModel:{number:"",id:"",productId:""},isSetting:!1,open:!1,showForm:!1,tabName:"first",operations:[{label:"添加",name:"add",type:"primary"},{label:"删除",name:"del",disabled:!0},{label:"刷新",name:"refresh",type:""}],formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"save",type:"primary"}],filters:[{type:"input",label:"",placeholder:"车辆识别码（VIN码）",value:""}],rules:{number:[{required:!0,message:"请输入车辆识别码",trigger:"blur"}]},pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},tableData:[],multiSelected:[]}},props:{itemId:{type:String},row:{type:Object,default:function(){return{}}}},methods:{operate:function(t){this[t]()},handleOperate:function(t){this[t]()},add:function(){this.formModel.number="",this.formModel.id="",this.showForm=!0},cancelForm:function(){this.showForm=!1},save:function(){var t=this;this.formModel.productId=this.itemId,this.$refs.form.validate((function(e){e&&(t.formModel.id&&m["a"].put("/admin/product/vinManage/vinCode.jhtml",t.formModel).then((function(e){t.$message.success("更新成功"),t.showForm=!1,t.refresh()})).catch((function(e){console.log(e),t.$message.warning(e.errorMessage)})),!t.formModel.id&&m["a"].post("/admin/product/vinManage/vinCode.jhtml",t.formModel).then((function(e){t.$message.success("保存成功"),t.showForm=!1,t.refresh()})).catch((function(e){console.log(e),t.$message.warning(e.errorMessage)})))}))},del:function(t){var e=this,i=t?Array(t):this.multiSelected;0!==i.length?this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={ids:i,shopId:window.top.SHOP_ID};m["a"].delete("/admin/product/vinManage/vinCode.jhtml",t).then((function(t){e.$message.success("删除成功"),e.refresh()})).catch((function(t){console.log(t),console.log("code错误")}))})):this.$message.warning("未选择删除条目")},filterDataChange:function(t){console.log("> ",t),this.filters=t,this.pagination.currentPage=1,this.refresh()},handleSelectionChange:function(t){var e=this;this.multiSelected=[],t.length>0?this.operations[1].disabled=!1:this.operations[1].disabled=!0,t.map((function(t){e.multiSelected=e.multiSelected.concat(t.id)}))},rowClick:function(t){this.formModel.number=t.number,this.formModel.id=t.id,this.showForm=!0},handleSizeChange:function(t){this.pagination.pageSize=t,this.refresh()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.refresh()},close:function(){this.open=!1},refresh:function(){var t=this;console.log("filters: ",this.filters),this.showForm=!1;var e={productId:this.itemId,searchValue:this.filters[0].value,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};m["a"].get("/admin/product/vinManage/vinCodes.jhtml",e).then((function(e){t.tableData=e.dataList,t.pagination.total=Number(e.total)})).catch((function(e){console.log(e),t.$message.warning(e.errorMessage)}))},showMessage:function(t,e){this.$message({showClose:!0,message:t,type:e})}},computed:Object(o["a"])({},Object(_["c"])(["getUser"])),created:function(){this.refresh()},watch:{itemId:function(t,e){this.refresh()}},components:{BizFlexTable:l["c"],BizSaveButton:c["a"]}},Pt=Et,Mt=(i("4792"),Object(y["a"])(Pt,Dt,Tt,!1,null,null,null)),Lt=Mt.exports,At={name:"ProductPopup",components:{BizPopupTabs:I["a"],BaseInfo:O,Specification:Y,Detail:it,PictureInfo:St,Parameter:Bt,VinCode:Lt},props:{baseInfo:{type:Object,default:function(){return{shop:{name:""}}}},open:{type:Boolean},isEdit:{type:Boolean},id:{type:String,default:""},categoryType:{type:String,default:""}},data:function(){return{tabSelection:"baseinfo"}},methods:{close:function(t){this.$emit("close",t)},operationSuccess:function(t){this.$emit("operationSuccess",t)},createdProductSuccess:function(t,e){this.$emit("createdProductSuccess",t,e)}},watch:{open:function(t){t||(this.tabSelection="baseinfo")}}},Rt=At,Vt=Object(y["a"])(Rt,w,S,!1,null,null,null),Nt=Vt.exports,Ot=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"create-vehicle"},[i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{rules:t.rules,"label-width":"100px",model:t.form,size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"品牌：",prop:"brandId"}},[i("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},on:{change:t.getVehicleSeries},model:{value:t.form.brandId,callback:function(e){t.$set(t.form,"brandId",e)},expression:"form.brandId"}},t._l(t.brandOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),i("el-form-item",{attrs:{label:"系列："}},[i("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},on:{change:t.getVehicleNames},model:{value:t.form.seriesId,callback:function(e){t.$set(t.form,"seriesId",e)},expression:"form.seriesId"}},t._l(t.seriesOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),i("el-form-item",{attrs:{label:"名称："}},[i("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},model:{value:t.form.nameId,callback:function(e){t.$set(t.form,"nameId",e)},expression:"form.nameId"}},t._l(t.nameOptions,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1)},Gt=[],Ht=i("a2a7"),jt={name:"CreatVehicle",components:{BizSaveButton:c["a"],BizGrid:h["a"]},data:function(){return{loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],rules:{brandId:[{required:!0,message:"请选择品牌",trigger:["blur","change"]}]},brandOptions:[],seriesOptions:[],nameOptions:[],form:{brandId:"",seriesId:"",nameId:""}}},props:{open:{type:Boolean}},watch:{open:function(t){t?this.getVehicleBrands():(this.brandOptions=[],this.seriesOptions=[],this.nameOptions=[],this.form.brandId="",this.form.seriesId="",this.form.nameId="")}},created:function(){},computed:{},methods:{operate:function(t){this[t]()},getVehicleBrands:function(){var t=this;this.form.brandId="",this.form.seriesId="",this.form.nameId="";var e={shopId:window.top.SHOP_ID||""};Ht["a"].getVehicleBrands(e,(function(e){t.brandOptions=e.brands}),(function(i){""!==i.errorMessage&&t.$message.warning(i.errorMessage),console.log("获取品牌失败:",e)}))},getVehicleSeries:function(){var t=this;if(this.form.seriesId="",this.form.nameId="",""===this.form.brandId)return this.seriesOptions=[],void(this.nameOptions=[]);var e={shopBrandId:this.form.brandId};Ht["a"].getVehicleSeries(e,(function(e){t.seriesOptions=e.series}),(function(i){""!==i.errorMessage&&t.$message.warning(i.errorMessage),console.log("获取系列失败:",e)}))},getVehicleNames:function(){var t=this;if(this.form.nameId="",""!==this.form.seriesId){var e={brandId:this.form.brandId,seriesId:this.form.seriesId};Ht["a"].getVehicleNames(e,(function(e){t.nameOptions=e.CarTypes}),(function(i){""!==i.errorMessage&&t.$message.warning(i.errorMessage),console.log("获取名称失败:",e)}))}else this.nameOptions=[]},save:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;t.loading=!0;var i={shopId:window.top.SHOP_ID||"",brandId:t.form.brandId,seriesId:t.form.seriesId,type:t.form.nameId};Ht["a"].createVehicle(i,(function(e){t.loading=!1,t.$emit("operationSuccess"),t.$message.success("创建整车成功")}),(function(e){t.loading=!1,""!==e.errorMessage&&t.$message.warning(e.errorMessage),console.log("创建整车失败")}))}))}}},Wt=jt,Zt=(i("2753"),Object(y["a"])(Wt,Ot,Gt,!1,null,null,null)),$t=Zt.exports,Yt={name:"CommodityMgmt",data:function(){return{productCategoryId:"",rowBaseInfo:{},loading:!1,defaultImg:"/resources/admin/images/default/product-default.png",errorImg:'this.src="/resources/admin/images/default/product-default.png"',importtabName:"baseinfo",createVehicleTabName:"createVehicle",refreshSign:!0,multipleSelection:[],editShopIds:[],addId:"",categoryType:"",open:!1,isEdit:!0,openimport:!1,createVehicle:!1,operations:[{label:"添加",name:"add",type:"primary"},{disabled:!0,label:"删除",name:"deleteList",type:""},{label:"刷新",name:"refresh",type:""},{disabled:!0,label:"克隆",name:"clone",type:""},{label:"导入",name:"lead",type:""},{label:"导出",name:"export",type:""}],filters:[{type:"cascader",label:"分类",name:"category",filterable:!1,value:[],options:[]},{type:"select",label:"品牌",value:"",options:[]},{type:"input",label:"",placeholder:"请输入编号/名称/条码",value:""}],tableData:[],categoryDatas:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},sortInfo:{}}},components:{ProductPopup:Nt,BizFlexTable:l["c"],ImportProduct:x,BizPopupTabs:I["a"],CreateVehicle:$t},created:function(){this.getUser(),this.refresh(),this.queryFilters(),this.getEditableStores(),this.getDefalutImg();var t="维护店铺商品，编辑商品基本信息、详情、商品图片以及商品规格、属性等";this.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:t,duration:3e3})},mounted:function(){},methods:Object(o["a"])(Object(o["a"])({},Object(_["c"])(["getUser"])),{},{operate:function(t){this[t]()},refresh:function(){this.getList()},createdProductSuccess:function(t,e){this.addId=t,this.rowBaseInfo.productType=e},rowClick:function(t){this.refreshSign=!this.refreshSign,this.addId=t.id,this.categoryType=t.categoryType,this.rowBaseInfo=t,this.open=!0},getEditableStores:function(){var t=this;m["a"].get(B["j"].editableStores,{resourceType:"2"}).then((function(e){t.editShopIds=[],e.dataList.map((function(e){t.editShopIds.push(e.id)}))})).catch((function(t){console.log(t),console.log("code错误")}))},getDefalutImg:function(){var t=this;m["a"].get("/admin/settings/settings.jhtml",{type:"displaySetting"}).then((function(e){e.settingList.defaultThumbnailProductImage&&e.settingList.defaultThumbnailProductImage&&(t.defaultImg=e.settingList.defaultThumbnailProductImage)})).catch((function(t){console.log(t),console.log("code错误")}))},getList:function(){var t=this,e={productCategoryId:this.productCategoryId,brandId:this.getSelectedBrandId(),searchValue:this.filters[2].value,shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};!0!==this.open&&!0!==this.openimport&&!0!==this.createVehicle&&(this.loading=!0),m["a"].get(B["k"].productMgmt.supplierList,e).then((function(e){t.loading=!1,t.tableData=e.dataList,t.pagination.total=Number(e.total)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},export:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var i,r,n,a,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=[],t.multipleSelection&&t.multipleSelection.length>0&&t.multipleSelection.forEach((function(t){i.push(t.id)})),r={ids:i,productCategoryId:t.productCategoryId,brandId:t.getSelectedBrandId(),searchValue:t.filters[2].value,shopId:window.top.SHOP_ID||"",pageNumber:t.pagination.currentPage,pageSize:t.pagination.pageSize},e.prev=3,e.next=6,lt.a.post("/admin/invoicingProduct/supplierProducts/export.jhtml",r,{responseType:"blob"});case 6:return n=e.sent,console.log("response => ",n),a=new Blob([n.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(n.headers["content-disposition"])),s=decodeURI(n.headers["content-disposition"].split("filename=")[1]),o=document.createElement("a"),o.download=s.match(/"(\S*)"/)[1],o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o),e.abrupt("return");case 22:throw e.prev=22,e.t0=e["catch"](3),new Error(e.t0);case 25:case"end":return e.stop()}}),e,null,[[3,22]])})))()},filterDataChange:function(t){this.pagination.currentPage=1,this.refresh()},lead:function(){this.$refs.openimport.handleImportCar()},openPoup:function(){this.openimport=!0},closePoup:function(){this.openimport=!1},creat:function(){this.createVehicle=!0},add:function(){this.addId="",this.isEdit=!0,this.open=!0},cascaderChange:function(t){this.productCategoryId=t[t.length-1],t.length>1&&""===this.productCategoryId&&(this.productCategoryId=t[t.length-2]),this.refresh()},activeItemChange:function(t){var e=this,i={shopId:this.getUser().shop.id,parentId:t.toString()};m["a"].get("/admin/shopProduct/productCategorys.jhtml",i).then((function(i){var r;e.setCategoryFilters(),e.filters[0].options.forEach((function(e){e.value===t[0]&&(r=e.children)})),i.dateList.forEach((function(t){r.push({value:t.id,label:t.name})}))})).catch((function(){}))},handleSelectionChange:function(t){this.operations[1].disabled=!0,this.operations[3].disabled=!0,(t.length>0||"shop"!==this.getUser().roleLevel)&&(this.operations[1].disabled=!1,this.operations[3].disabled=!1),this.multipleSelection=t},handleSizeChange:function(t){this.pagination.pageSize=t,this.refresh()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.refresh()},deleteRecommend:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=[];i.push(t);var r={ids:i};f["a"].delete(r,(function(t){e.$message({type:"success",message:"删除成功!"}),e.refresh()}),(function(t){console.log(t)}))})).catch((function(){}))},deleteList:function(){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e,i=[],r=Object(a["a"])(t.multipleSelection);try{for(r.s();!(e=r.n()).done;){var n=e.value;i.push(n.id)}}catch(o){r.e(o)}finally{r.f()}var s={ids:i};f["a"].delete(s,(function(e){t.$message({type:"success",message:"删除成功!"}),t.refresh()}),(function(t){console.log(t)}))})).catch((function(){}))},clone:function(){var t,e=this,i=[],r=Object(a["a"])(this.multipleSelection);try{for(r.s();!(t=r.n()).done;){var n=t.value;i.push(n.id)}}catch(o){r.e(o)}finally{r.f()}var s={ids:i};f["a"].cloneProduct(s,(function(t){e.$message({type:"success",message:"克隆成功!"}),e.refresh()}),(function(t){console.log(t),e.$message.error(t.errorMessage)}))},queryFilters:function(){var t=this,e={shopId:window.top.SHOP_ID||""};f["a"].queryFilters(e,(function(e){t.categoryDatas=e.categoryDatas,t.setCategoryFilters(),t.setBrandFilters(e.brandDatas)}),(function(i){""!==i.errorMessage&&t.$message.error(i.errorMessage),console.log("获取过滤器失败",e)}))},handleSortChange:function(t){console.log("column",t),this.sortInfo={column:t.prop,sort:t.order?"ascending"===t.order?"asc":"desc":void 0},this.getList()},setCategoryFilters:function(){var t=[{value:"",label:"全部"}];this.categoryDatas.forEach((function(e){t.push({value:e.id,label:e.name,children:[{label:"全部",value:""}]})})),this.filters[0].options=t},setBrandFilters:function(t){this.filters[1].options=t.map((function(t){return{value:t.id,label:t.name}})),this.filters[1].options.splice(0,0,{value:"",label:"全部"})},getSelectedBrandId:function(){return this.filters[1].value}})},Jt=Yt,qt=(i("09db"),Object(y["a"])(Jt,r,n,!1,null,null,null));e["default"]=qt.exports},c708:function(t,e,i){"use strict";var r=i("1370"),n=i.n(r);n.a},c820:function(t,e,i){"use strict";var r=i("474c"),n=i.n(r);n.a},c846:function(t,e,i){},cc55:function(t,e,i){"use strict";var r=i("2497"),n=i("bc3a"),a=i.n(n),s=i("c596");e["a"]={getProductCategoryList:function(t,e,i){a.a.get(s["g"].commodity.getProductCategoryList,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},deleteProductCategory:function(t,e,i){a.a.delete(s["g"].commodity.deleteProductCategory,{data:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},getInputProductCategoryList:function(t,e,i){console.log("[---- dachao ----] [API-从平台导入-get] getInputProductCategoryList() params=",t),a.a.get(s["g"].commodity.getInputProductCategoryList,{params:t}).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))},saveInputProductCategoryList:function(t,e,i){console.log("[---- dachao ----] [API-从平台导入-post] saveInputProductCategoryList() params=",t),a.a.post(s["g"].commodity.saveInputProductCategoryList,t).then(Object(r["a"])(e,i)).catch((function(t){console.error(t)}))}}},ccf0:function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"biz-import-file"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":t.handleSuccess,"on-error":t.handleError,"on-progress":t.handleProgress,"before-upload":t.handleBeforeUpload,data:t.data,name:t.name,action:t.action,accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}},[t.disabled?i("el-button",{attrs:{size:"mini",type:"",loading:t.loading},on:{click:function(e){return e.stopPropagation(),t.handleImport(e)}}},[t.$slots.content||t.content?i("div",{staticClass:"biz-card__header"},[t._t("content",[t._v(t._s(t.content))])],2):t._e()]):t._e(),t.disabled?t._e():i("el-button",{attrs:{size:"mini",type:"",loading:t.loading}},[t.$slots.content||t.content?i("div",{staticClass:"biz-card__header"},[t._t("content",[t._v(t._s(t.content))])],2):t._e()])],1),i("el-dialog",{staticClass:"biz-import-file__uploading-dialog",attrs:{title:t.title,visible:t.uploadingVisible,"append-to-body":""},on:{"update:visible":function(e){t.uploadingVisible=e},close:t.clearTimeOut}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showInfo,expression:"showInfo"}],staticClass:"info"},[i("span",{staticClass:"success"},[t._v("成功导入："+t._s(t.count)+"条")]),i("span",{staticClass:"error"},[t._v("共计："+t._s(t.total)+"条")])]),i("el-progress",{staticClass:"biz-import-file__uploading-dialog__progress",attrs:{"stroke-width":12,percentage:t.percentage}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showCurrentInfo,expression:"showCurrentInfo"}],staticClass:"info"},[i("span",{staticClass:"success"},[t._v("正在导入："+t._s(t.stepkey))])])],1),i("el-dialog",{staticClass:"biz-import-file__importing-dialog",attrs:{title:"导入结果",visible:t.importingVisible,"append-to-body":""},on:{"update:visible":function(e){t.importingVisible=e}}},[i("div",{staticClass:"importing-dialog__content"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.importLoading,expression:"importLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{size:"small",stripe:"",border:"",height:400,data:t.tableData,"tooltip-effect":"dark","element-loading-text":"导入中，请稍后"}},[t._t("default")],2)],1)])],1)},n=[],a=(i("c975"),i("baa5"),i("b0c0"),i("a9e3"),{name:"ImportFile",props:{showInfo:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}},showProcess:{type:Boolean,default:function(){return!1}},content:{type:String,default:function(){return"导入"}},data:{type:Object,default:function(){return{type:"3"}}},name:{type:String,default:function(){return"file"}},action:{type:String,default:function(){return"/admin/file/uploads.jhtml"}},tableData:{type:Array,required:!0},total:{type:Number,default:function(){return 0}},count:{type:Number,default:function(){return 0}},percentage:{type:Number,default:function(){return 0}},stepkey:{type:String,default:function(){return""}},importLoading:{type:Boolean,default:function(){return!1}}},data:function(){return{loading:!1,t:"",title:"导入中",showCurrentInfo:!0,uploadingVisible:!1,importingVisible:!1}},methods:{handleBeforeUpload:function(t){if(this.clearTimeOut(),-1===t.name.indexOf("."))return this.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)"),!1;var e=t.name.lastIndexOf("."),i=t.name.substring(e+1);if(!/(?:xls|xlsx)$/i.test(i))return this.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)"),!1;this.textEl&&(this.textEl.style.left=0)},handleProgress:function(t,e,i){console.log("导入中"),this.uploadingVisible=!0,this.$emit("restProcess");var r=this;setTimeout((function(){r.handleImport()}),2e3)},handleSuccess:function(t,e,i){var r=this;console.log("导入完成"),"100"===t.resultCode?setTimeout((function(){if(t.fis){var e=t.fis[0].url;e?r.doImport(e,t):r.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)")}}),600):(console.log("失败1"),this.$message.warning("发生错误"),this.uploadingVisible=!1)},handleError:function(t,e,i){console.log("失败"),t?this.$message.warning(t):(this.uploadingVisible=!1,this.$message.warning("发生错误"))},clearTimeOut:function(){this.$emit("clearTimeOut")},handleImport:function(t){this.uploadingVisible=!0,this.$emit("handle-import",t)},doImport:function(t,e){var i=this;setTimeout((function(){i.importingVisible=!0}),0),this.$emit("on-import",t,e)}}}),s=a,o=(i("0413"),i("2877")),l=Object(o["a"])(s,r,n,!1,null,null,null),d=l.exports,p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"biz-import-file"},[i("el-dialog",{staticClass:"biz-import-file__uploading-dialog",attrs:{title:t.title,visible:t.uploadingVisible,"append-to-body":""},on:{"update:visible":function(e){t.uploadingVisible=e},close:t.clearTimeOut}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showInfo,expression:"showInfo"}],staticClass:"info"},[i("span",{staticClass:"success"},[t._v("成功导出："+t._s(t.count)+"条")]),i("span",{staticClass:"error"},[t._v("共计："+t._s(t.total)+"条")])]),i("el-progress",{staticClass:"biz-import-file__uploading-dialog__progress",attrs:{"stroke-width":12,percentage:t.percentage}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showCurrentInfo,expression:"showCurrentInfo"}],staticClass:"info"},[i("span",{staticClass:"success"},[t._v("正在导出："+t._s(t.stepkey))])])],1)],1)},c=[],h={name:"ImportFile",props:{showInfo:{type:Boolean,default:function(){return!0}},total:{type:Number,default:function(){return 0}},count:{type:Number,default:function(){return 0}},percentage:{type:Number,default:function(){return 0}},stepkey:{type:String,default:function(){return""}}},data:function(){return{loading:!1,t:"",title:"导出中",showCurrentInfo:!0,uploadingVisible:!1}},methods:{clearTimeOut:function(){this.$emit("clearTimeOut")}}},u=h,f=(i("e7d9"),Object(o["a"])(u,p,c,!1,null,null,null)),m=f.exports;i.d(e,"b",(function(){return d})),i.d(e,"a",(function(){return m}))},d431:function(t,e,i){"use strict";var r=i("74a1"),n=i.n(r);n.a},d4c2:function(t,e,i){"use strict";var r=i("e725"),n=i.n(r);n.a},d4ec:function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.d(e,"a",(function(){return r}))},db98:function(t,e,i){},e58c:function(t,e,i){"use strict";var r=i("fc6a"),n=i("a691"),a=i("50c4"),s=i("a640"),o=i("ae40"),l=Math.min,d=[].lastIndexOf,p=!!d&&1/[1].lastIndexOf(1,-0)<0,c=s("lastIndexOf"),h=o("indexOf",{ACCESSORS:!0,1:0}),u=p||!c||!h;t.exports=u?function(t){if(p)return d.apply(this,arguments)||0;var e=r(this),i=a(e.length),s=i-1;for(arguments.length>1&&(s=l(s,n(arguments[1]))),s<0&&(s=i+s);s>=0;s--)if(s in e&&e[s]===t)return s||0;return-1}:d},e725:function(t,e,i){},e7d9:function(t,e,i){"use strict";var r=i("9b77"),n=i.n(r);n.a},f3a0:function(t,e,i){"use strict";var r=i("db98"),n=i.n(r);n.a},ff5b:function(t,e,i){}}]);