(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5afa9274"],{"0870":function(e,t,a){"use strict";var r=a("17c1"),i=a.n(r);i.a},"0fb4":function(e,t,a){"use strict";var r=a("fe22"),i=a.n(r);i.a},"17c1":function(e,t,a){},2299:function(e,t,a){"use strict";var r=a("2497"),i=a("bc3a"),n=a.n(i),o=a("c596");t["a"]={getImageGroups:function(e,t,a){n.a.get(o["g"].commodity.getImageGroups,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},updateImageGroups:function(e,t,a){n.a.put(o["g"].commodity.updateImageGroups,e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductVrMediaBath:function(e,t,a){n.a.put(o["g"].commodity.updateProductVrMediaBath,e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},getImageGroups_pm:function(e,t,a){n.a.get(o["g"].commodity.getImageGroups_pm,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},updateImageGroups_pm:function(e,t,a){n.a.put(o["g"].commodity.updateImageGroups_pm,e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductVrMediaBath_pm:function(e,t,a){n.a.put(o["g"].commodity.updateProductVrMediaBath_pm,e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))}}},2497:function(e,t,a){"use strict";var r=a("4360"),i=a("a18c");t["a"]=function(e,t){return function(a){var n=a.data;"100"===n.resultCode?e(n):"709"===n.resultCode?(r["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",r["a"].getters.currentUser),i["a"].push("/login")):t(n)}}},"392e":function(e,t,a){"use strict";var r=a("2497"),i=a("bc3a"),n=a.n(i),o=a("c596");t["a"]={queryProductBasicInfo:function(e,t,a){n.a.get(o["g"].commodity.queryProductBasicInfo,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductBasicInfo:function(e,t,a){n.a.put(o["g"].commodity.updateProductBasicInfo,e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},creatProductBasicInfo:function(e,t,a){n.a.post(o["g"].commodity.creatProductBasicInfo,e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},creatBenefitsBasicInfo:function(e,t,a){n.a.post("/admin/shopProduct/benefitsProduct/basicInfo.jhtml",e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductDetail:function(e,t,a){n.a.get(o["g"].commodity.queryProductDetail,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductDetail:function(e,t,a){n.a.put(o["g"].commodity.queryProductDetail,e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductDetail_pm:function(e,t,a){n.a.get(o["g"].commodity.queryProductDetail_pm,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductDetail_pm:function(e,t,a){n.a.put(o["g"].commodity.updateProductDetail_pm,e).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))}}},"42b8":function(e,t,a){},"5b8e":function(e,t,a){"use strict";var r=a("9678"),i=a.n(r);i.a},6882:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-mgmt"},[a("biz-flex-table",{ref:"table",attrs:{loading:e.loading,operations:e.operations,filters:e.filters,tableData:e.tableData,pagination:e.pagination},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"selection-change":e.handleSelectionChange,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"cost",label:"成本价"}}),a("el-table-column",{attrs:{prop:"marketPrice",label:"市场价"}}),a("el-table-column",{attrs:{prop:"image",label:"展示图片"},scopedSlots:e._u([{key:"default",fn:function(e){return a("div",{},[a("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.image,alt:""}})])}}])}),a("el-table-column",{attrs:{prop:"weight",label:"重量"}}),a("el-table-column",{attrs:{prop:"category",label:"分类",formatter:e.categoryFormatter}}),a("el-table-column",{attrs:{width:"50",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.deleteProduct(t.row.id)}}},[e._v("删除")])]}}])})],1),a("product-mgmt-popup",{attrs:{slot:"float",open:e.openPopup,id:e.productId},on:{close:function(t){e.openPopup=!1,e.productId=""},refreshProduct:e.refresh,createdProductSuccess:e.createdProductSuccess},slot:"float"})],1)},i=[],n=(a("a9e3"),a("b85c")),o=a("5530"),s=a("04d3"),c=a("2497"),l=a("bc3a"),u=a.n(l),d=a("c596"),p={getProductList:function(e,t,a){u.a.get(d["g"].systemSetting.getProductList,{params:e}).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))},deleteBasicData:function(e,t,a){u.a.delete(d["g"].systemSetting.deleteBasicData,{data:e}).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))},queryBasicData:function(e,t,a){u.a.get(d["g"].systemSetting.queryBasicData,{params:e}).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))},createBasicData:function(e,t,a){u.a.post(d["g"].systemSetting.createBasicData,e).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))},updateBasicData:function(e,t,a){u.a.put(d["g"].systemSetting.updateBasicData,e).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))}},m=a("2f62"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.clickTabName,callback:function(t){e.clickTabName=t},expression:"clickTabName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"Product"}},[a("product-setting",{attrs:{open:e.open,id:e.id},on:{refreshProduct:e.refreshProduct,createdProductSuccess:e.createdProductSuccess}})],1),e.id?a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("Detail",{attrs:{open:e.open,id:e.id},on:{operationSuccess:e.refreshProduct}})],1):e._e(),e.id?a("el-tab-pane",{attrs:{label:"图片",name:"pictureInfo"}},[a("PictureInfo",{attrs:{open:e.open,id:e.id},on:{operationSuccess:e.refreshProduct}})],1):e._e()],1)},h=[],g=a("7132"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"product-setting"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"名称:",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"成本价:",prop:"cost"}},[a("el-input",{attrs:{placeholder:"请输入成本价"},model:{value:e.form.cost,callback:function(t){e.$set(e.form,"cost",t)},expression:"form.cost"}})],1),a("el-form-item",{attrs:{label:"市场价:",prop:"marketPrice"}},[a("el-input",{attrs:{placeholder:"请输入市场价"},model:{value:e.form.marketPrice,callback:function(t){e.$set(e.form,"marketPrice",t)},expression:"form.marketPrice"}})],1),a("el-form-item",{attrs:{label:"展示图片:",prop:"image"}},[a("BizAvatarUploaderNew",{model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1),a("el-form-item",{attrs:{label:"重量:",prop:"weight"}},[a("el-input",{attrs:{placeholder:"请输入重量"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight",t)},expression:"form.weight"}},[a("template",{slot:"append"},[e._v("克")])],2)],1),a("el-form-item",{attrs:{label:"类型:",prop:"category"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.typeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1)},b=[],y=(a("b0c0"),a("4d63"),a("ac1f"),a("25f0"),a("f36f")),D=a("8330"),P=a("c17f"),I={name:"ProductSetting",components:{BizSaveButton:D["a"],BizGrid:y["a"],BizAvatarUploaderNew:P["b"]},data:function(){var e=this,t=function(t,a,r){Number(e.form.cost)>=0?r():r(new Error("成本价必须为数字值"))},a=function(t,a,r){Number(e.form.marketPrice)>=0?r():r(new Error("市场价必须为数字值"))},r=function(t,a,r){var i=new RegExp(/^([1-9]\d*|[0]{1,1})$/);i.test(e.form.weight)?r():r(new Error("重量必须为正整数或零"))};return{operations:[{label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请输入产品名称",trigger:"change"}],cost:[{required:!1,trigger:"change",validator:t}],marketPrice:[{required:!1,trigger:"change",validator:a}],weight:[{required:!1,trigger:"change",validator:r}],category:[{required:!0,message:"请选择类型",trigger:"change"}]},form:{id:"",name:"",cost:"",marketPrice:"",image:"",unit:"",weight:"0",category:"",introduction:"",memo:""},productList:[],typeList:[]}},props:{id:{type:String,default:""},open:{type:Boolean,default:!1}},created:function(){},methods:{save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;""===e.id?e.add():e.update()}))},refresh:function(){var e=this,t={id:this.id};p.queryBasicData(t,(function(t){e.form.id=t.generalType.id,e.form.name=t.generalType.name,e.form.cost=t.generalType.cost,e.form.marketPrice=t.generalType.marketPrice,e.form.image=t.generalType.image,e.form.unit=t.generalType.unit,e.form.weight=parseInt(t.generalType.weight),e.form.category=t.generalType.category,e.form.introduction=t.generalType.introduction,e.form.memo=t.generalType.memo,e.typeList=t.types}),(function(t){e.$message.warning(t.errorMessage)}))},operateHandler:function(e){this[e]()},add:function(){var e=this,t={id:this.form.id,name:this.form.name,cost:this.form.cost,marketPrice:this.form.marketPrice,image:this.form.image,unit:this.form.unit,weight:this.form.weight,category:this.form.category,introduction:this.form.introduction,memo:this.form.memo};p.createBasicData(t,(function(t){e.$message.success("操作成功"),e.$emit("refreshProduct"),e.$emit("createdProductSuccess",t.id)}),(function(t){e.$message.warning(t.errorMessage)}))},update:function(){var e=this,t={id:this.form.id,name:this.form.name,cost:this.form.cost,marketPrice:this.form.marketPrice,image:this.form.image,unit:this.form.unit,weight:this.form.weight,category:this.form.category,introduction:this.form.introduction,memo:this.form.memo};p.updateBasicData(t,(function(t){e.$message.success("操作成功"),e.$emit("refreshProduct"),e.refresh()}),(function(t){e.$message.warning(t.errorMessage)}))},clearFormData:function(){this.form.id="",this.form.name="",this.form.cost="",this.form.marketPrice="",this.form.image="",this.form.unit="",this.form.weight="0",this.form.category="",this.form.introduction="",this.form.memo=""}},computed:{},watch:{id:function(e){!0===this.open&&this.refresh()},open:function(e){e?""===this.id&&this.refresh():this.clearFormData()}}},w=I,S=(a("0fb4"),a("2877")),V=Object(S["a"])(w,v,b,!1,null,null,null),M=V.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"propetry-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"106px",size:"small",disabled:!e.isEdit}},[a("el-form-item",{attrs:{label:"商品介绍"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"418px"},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1),a("el-form-item",{attrs:{label:"购买须知"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"418px"},model:{value:e.form.notice,callback:function(t){e.$set(e.form,"notice",t)},expression:"form.notice"}})],1),a("el-form-item",{attrs:{label:"产品售后"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"418px"},model:{value:e.form.afterSale,callback:function(t){e.$set(e.form,"afterSale",t)},expression:"form.afterSale"}})],1),a("el-form-item",{attrs:{label:"语音播报介绍","label-width":"135px"}}),a("div",{staticClass:"y-editor"},[a("el-input",{attrs:{type:"textarea",maxlength:"200",autosize:{minRows:5,maxRows:8},width:"430px"},model:{value:e.form.broadcast,callback:function(t){e.$set(e.form,"broadcast",t)},expression:"form.broadcast"}})],1)],1)],1)},x=[],$=a("40ae"),C=a("392e"),L={name:"CommodityMgmtBaseInfo",data:function(){return{isCreated:!1,operations:[{label:"保存",name:"update",type:"primary"}],form:{introduction:"",notice:"",afterSale:"",broadcast:""}}},props:{id:{type:String},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{open:function(e){e||(this.form.introduction="",this.form.notice="",this.form.afterSale="",this.form.broadcast="")}},components:{BizSaveButton:D["a"],BizGrid:y["a"],BizEditor:$["a"]},created:function(){},computed:{},mounted:function(){this.id&&this.refresh()},methods:{checkVideo:function(e){this.$message.warning(e)},operate:function(e){this[e]()},onSubmit:function(){console.log("submit!")},refresh:function(){var e=this,t={id:this.id};this.isCreated=!0,C["a"].queryProductDetail_pm(t,(function(t){e.form.introduction=t.data.introduction,e.form.notice=t.data.notice,e.form.afterSale=t.data.afterSale,e.form.broadcast=t.data.broadcast,e.$nextTick((function(){e.isCreated=!1}))}),(function(e){console.log(e)}))},update:function(){var e=this,t={id:this.id,introduction:this.form.introduction,notice:this.form.notice,afterSale:this.form.afterSale,broadcast:this.form.broadcast};C["a"].updateProductDetail_pm(t,(function(t){e.$message.success("操作成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log(t)}))}}},B=L,_=(a("c7a5"),Object(S["a"])(B,T,x,!1,null,null,null)),z=_.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"commodity-mgmt-picture-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{size:"small","label-position":"top","label-width":"110px",disabled:!e.isEdit}},[a("el-form-item",{attrs:{label:"所有图片限制200K以下,建议尺寸3:2"}}),a("el-form-item",{attrs:{label:"轮播主图管理"}},[a("ProductAvatarPictureCardUploader",{class:{disabled:e.uploadDisabled},attrs:{imageList:e.carouselImages,productId:e.id,isMainPicture:!0},on:{"upload-success":e.handleCarouselUpload,"remove-success":e.handleCarouselRemove}})],1),a("el-form-item",{attrs:{label:"VR资源管理"}},[a("el-radio-group",{on:{change:e.sourceTypeChange},model:{value:e.sourceType,callback:function(t){e.sourceType=t},expression:"sourceType"}},[a("el-radio",{attrs:{label:"0"}},[e._v("本地资源包")]),a("el-radio",{attrs:{label:"1"}},[e._v("第三方资源地址")])],1),a("ProductVrFileUploader",{directives:[{name:"show",rawName:"v-show",value:"0"===e.sourceType,expression:"sourceType==='0'"}],attrs:{open:e.open,fileList:e.vrFileList,productId:e.id,isTestDrive:!1},on:{"upload-success":e.handleVRUpload,"remove-success":e.handleVRRemove}}),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"1"===e.sourceType,expression:"sourceType==='1'"}],attrs:{type:"textarea",autosize:{minRows:5,maxRows:8}},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})],1),a("el-form-item",{attrs:{label:"试驾视频 (请上传视频文件)"}},[a("ProductVrFileUploader",{attrs:{open:e.open,fileList:e.testDriverList,productId:e.id,isTestDrive:!0},on:{"upload-success":e.handleTestDriveUpload,"remove-success":e.handleTestDriveRemove}})],1),a("el-form-item",{attrs:{label:"内饰图片管理"}},[a("ProductAvatarPictureCardUploader",{attrs:{imageList:e.interiorsImages,productId:e.id},on:{"upload-success":e.handleInteriorsUpload,"remove-success":e.handleInteriorsRemove}})],1),a("el-form-item",{attrs:{label:"空间图片管理"}},[a("ProductAvatarPictureCardUploader",{attrs:{imageList:e.spaceImages,productId:e.id},on:{"upload-success":e.handleSpaceUpload,"remove-success":e.handleSpaceRemove}})],1),a("el-form-item",{attrs:{label:"图解资源管理"}},[a("ProductAvatarPictureCardUploader",{attrs:{imageList:e.diagramImages,productId:e.id},on:{"upload-success":e.handleDiagramUpload,"remove-success":e.handleDiagramRemove}})],1),a("el-form-item",{attrs:{label:"车身图片管理"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.fullScreenName,callback:function(t){e.fullScreenName=t},expression:"fullScreenName"}})],1),a("el-col",{attrs:{span:11}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.addFullScreen(t)}}},[e._v("添加颜色")])],1)],1),e._l(e.fullScreenList,(function(t){return a("el-form-item",{key:t.name},[a("el-tag",{attrs:{closable:!e.hasFullScreenImages(t),"disable-transitions":!1,type:"info",size:"warning"},on:{close:function(a){return e.handleCloseFullScreen(t)}}},[e._v(" "+e._s(t.name)+" ")]),a("ProductAvatarPictureCardUploader",{attrs:{imageList:t.fullScreenImages,parentElementName:t.name},on:{"upload-success":e.handleFullScreenUpload,"remove-success":e.handleFullScreenRemove}})],1)})),a("el-form-item",{attrs:{label:"360图片管理"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.appearanceName,callback:function(t){e.appearanceName=t},expression:"appearanceName"}})],1),a("el-col",{attrs:{span:11}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.addAppearance(t)}}},[e._v("添加颜色")])],1)],1),e._l(e.appearanceList,(function(t){return a("el-form-item",{key:t.name},[a("el-tag",{attrs:{closable:!e.hasAppearanceImages(t),"disable-transitions":!1,type:"info",size:"warning"},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t.name)+" ")]),a("ProductAvatarPictureCardUploader",{attrs:{imageList:t.appearanceImages,parentElementName:t.name},on:{"upload-success":e.handleAppearanceUpload,"remove-success":e.handleAppearanceRemove}})],1)}))],2)],1)},N=[],F=(a("4de4"),a("c740"),a("d81d"),a("a434"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-vr-file-uploader"},[a("el-upload",{attrs:{accept:"application/zip,video/*",name:e.uploadName,action:e.uploadAction,data:e.uploadData,"file-list":e.fileList,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.beforeAvatarUpload}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hasFile(),expression:"hasFile()"}],attrs:{size:"small",type:"primary",disabled:!e.preview,loading:e.loading},on:{click:function(t){return t.stopPropagation(),e.handlePreview(t)}}},[e._v(" 预览")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hasFile(),expression:"hasFile()"}],attrs:{size:"small",type:"primary",disabled:e.preview},on:{click:function(t){return t.stopPropagation(),e.handlePreview(t)}}},[e._v("取消预览")]),a("iframe",{directives:[{name:"show",rawName:"v-show",value:!e.preview,expression:"!preview"}],ref:"vrFrame",staticClass:"vrframe",attrs:{src:e.url,frameborder:"0"}})],1)}),U=[],O=(a("c975"),a("baa5"),{name:"ProductVrFileUploader",data:function(){return{preview:!0,loading:!1,url:""}},props:{isTestDrive:{type:Boolean,default:!1},productId:String,open:{type:Boolean,default:!1},fileList:{type:Array,default:function(){return[]}}},watch:{open:function(e){e||(this.url="",this.preview=!0)}},computed:{uploadAction:function(){return this.isTestDrive?"/admin/file/uploads.jhtml":"/admin/baseData/baseDataVrZip.jhtml"},uploadName:function(){return this.isTestDrive?"file":"uploadFile0"},uploadData:function(){return this.isTestDrive?{type:"2",name:"file"}:{productId:this.productId,name:"uploadFile0"}}},methods:{handlePreview:function(){var e=this;if(this.isTestDrive)!0===this.preview?(this.url=this.getFilePath(),setTimeout((function(){e.preview=!1}),800)):(this.url="",this.preview=!0);else if(!0===this.preview){var t=this.getFilePath();this.loading=!0,u.a.get(t).then((function(t){e.loading=!1,e.url=e.getFilePath(),e.$refs.vrFrame.contentWindow.location.reload(!0),setTimeout((function(){e.preview=!1}),800),console.log("url请求成功")})).catch((function(t){e.loading=!1,404===t.response.status?e.$message.warning("文件解析,十分钟后可预览"):console.log("url请求失败:",t.response)}))}else this.url="",this.loading=!1,this.preview=!0},handleRemove:function(e,t){this.$emit("remove-success",e,t),this.url="",this.preview=!0},handleSuccess:function(e,t,a){this.$emit("upload-success",e,t,a),this.url="",this.preview=!0},beforeAvatarUpload:function(e){if(this.isTestDrive){var t=/^video\/(.*)$/.test(e.type);return t||this.$message.error("请选择符合视频格式的文件上传!"),t}var a="application/zip"===e.type;if(!a){var r=e.name.substring(e.name.lastIndexOf(".")).toLowerCase();if(".zip"!==r)return this.$message.error("请选择zip格式的VR资源包!"),a}var i=e.size/1024/1024<=200;return i||this.$message.error("请上传小于200M的文件!"),i},handleError:function(e,t,a){e?this.$message.warning(e):this.$message.warning("发生错误")},hasFile:function(){return 0!==this.fileList.length},getFilePath:function(){if(0!==this.fileList.length){var e=this.fileList[0].url.indexOf("/upload/");if(-1===e)return console.log("文件路径错误",this.fileList[0].url),"";var t=location.protocol+"//"+location.host,a=this.fileList[0].url.substr(e),r=t+a;return this.isTestDrive||(r+="/index.html"),console.log("src",r),r}return""}}}),j=O,A=(a("8779"),Object(S["a"])(j,F,U,!1,null,null,null)),R=A.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-avatar-picture-card-uploader"},[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{accept:"image/*","list-type":"picture-card","file-list":e.imageList,name:"uploadFile0","on-success":e.handleSuccess,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.beforeAvatarUpload,action:e.uploadAction,data:e.uploadData,multiple:""}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("el-dialog",{staticClass:"avatar-preview-dialog",attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"review"},[a("img",{attrs:{src:e.imgUrl,alt:""}})])])],1)},q=[],G={name:"ProductAvatarPictureCardUploader",data:function(){return{imgUrl:{type:String,default:""},dialogVisible:!1}},props:{parentElementName:String,shopId:window.top.SHOP_ID||"",productId:String,isMainPicture:{type:Boolean,default:function(){return!1}},imageList:{type:Array,default:function(){return[]}}},computed:{uploadAction:function(){return this.isMainPicture?"/admin/baseData/baseDataImagesFile.jhtml":"/admin/vrMedia/uploadVrImage.jhtml"},uploadData:function(){return console.log("uploadData"),{shopId:window.top.SHOP_ID||"",productId:this.productId,type:"0"}}},methods:{handleRemove:function(e,t){this.$emit("remove-success",e)},handlePreview:function(e){this.imgUrl=e.url,this.dialogVisible=!0},handleSuccess:function(e,t,a){this.$emit("upload-success",e,t,this.parentElementName)},beforeAvatarUpload:function(e){var t=/^image\/(.*)$/.test(e.type);if(!t)return this.$message.error("请选择符合图片格式的文件上传!"),!1;var a=e.size/1024<=200;return a?!this.isMainPicture||(this.$refs.upload.$refs["upload-inner"].fileList.length<=5||(this.$message.error("轮播主图最多可添加5个"),!1)):(this.$message.error("上传图片大小不能超过 200K!"),!1)}}},H=G,K=(a("bf3f"),Object(S["a"])(H,E,q,!1,null,null,null)),J=K.exports,W=a("2299"),Z={name:"CommodityMgmtPictureInfo",components:{BizSaveButton:D["a"],BizGrid:y["a"],ProductVrFileUploader:R,ProductAvatarPictureCardUploader:J},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"}],preview:!1,appearanceName:"",fullScreenName:"",image:"",wideImage:"",VrMediaData:[],productImageDatas:[],sourceType:"0",defaultType:"",url:"",carouselImages:[],vrFileList:[],testDriverList:[],interiorsImages:[],spaceImages:[],diagramImages:[],fullScreenList:[],appearanceList:[]}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{open:function(e){e||(this.image="",this.wideImage="",this.VrMediaData=[],this.productImageDatas=[],this.carouselImages=[],this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.fullScreenList=[],this.appearanceList=[])}},created:function(){},computed:{uploadDisabled:function(){return this.productImageDatas.length>=5}},mounted:function(){this.id&&this.query()},methods:{operate:function(e){this[e]()},sourceTypeChange:function(e){e!==this.defaultType&&("0"===e?this.vrFileList=[]:this.url="")},addAppearance:function(){var e=this;if(this.appearanceName){var t=this.appearanceList.findIndex((function(t){return t.name===e.appearanceName}));if(-1===t){var a={name:this.appearanceName,appearanceImages:[]};this.appearanceList.push(a)}this.appearanceName=""}},addFullScreen:function(){var e=this;if(this.fullScreenName){var t=this.fullScreenList.findIndex((function(t){return t.name===e.fullScreenName}));if(-1===t){var a={name:this.fullScreenName,fullScreenImages:[]};this.fullScreenList.push(a)}this.fullScreenName=""}},updateCarouselImages:function(){for(var e=[],t=0;t<this.productImageDatas.length;t++)e.push({name:this.productImageDatas[t].title,url:this.productImageDatas[t].source});this.carouselImages=e},updateVrData:function(){var e=this;this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.fullScreenImages=[],this.appearanceList=[],this.fullScreenList=[],this.vrFileList=[],this.testDriverList=[];for(var t=function(t){var a={url:e.VrMediaData[t].filePath,color:e.VrMediaData[t].color,mediaType:e.VrMediaData[t].mediaType};if("vr"===e.VrMediaData[t].mediaType)e.vrFileList.push({name:e.VrMediaData[t].filePath,url:e.VrMediaData[t].filePath});else if("testdrive"===e.VrMediaData[t].mediaType)e.testDriverList.push({name:e.VrMediaData[t].filePath,url:e.VrMediaData[t].filePath});else if("interiors"===e.VrMediaData[t].mediaType)e.interiorsImages.push(a);else if("space"===e.VrMediaData[t].mediaType)e.spaceImages.push(a);else if("diagram"===e.VrMediaData[t].mediaType)e.diagramImages.push(a);else if("facade"===e.VrMediaData[t].mediaType){if(e.VrMediaData[t].color){var r=e.fullScreenList.findIndex((function(a){return a.name===e.VrMediaData[t].color}));if(-1===r){var i={name:e.VrMediaData[t].color,fullScreenImages:[]};i.fullScreenImages.push(a),e.fullScreenList.push(i)}else e.fullScreenList[r].fullScreenImages.push(a)}}else if("appearance"===e.VrMediaData[t].mediaType&&e.VrMediaData[t].color){var n=e.appearanceList.findIndex((function(a){return a.name===e.VrMediaData[t].color}));if(-1===n){var o={name:e.VrMediaData[t].color,appearanceImages:[]};o.appearanceImages.push(a),e.appearanceList.push(o)}else e.appearanceList[n].appearanceImages.push(a)}},a=0;a<this.VrMediaData.length;a++)t(a)},handleCarouselUpload:function(e,t){"100"===e.resultCode&&this.productImageDatas.push({large:e.map[0].large,medium:e.map[0].medium,order:"",source:e.map[0].source,thumbnail:e.map[0].thumbnail,title:t.name})},handleCarouselRemove:function(e){var t=this.productImageDatas.findIndex((function(t){return t.source===e.url}));-1===t?(t=this.productImageDatas.findIndex((function(t){return t.source===e.response.map[0].source})),-1!==t&&this.productImageDatas.splice(t,1)):this.productImageDatas.splice(t,1)},getImage:function(e){return{color:"",fileName:this.getFileName(e),filePath:"",id:"",large:"",mediaType:e,medium:"",sortSn:"",thumbnail:"",sourceType:this.sourceType,title:this.getTitle(e),zipKey:""}},getFileName:function(e){return"interiors"===e?"inside":"space"===e?"size":"diagram"===e?"pictureInfo":"appearance"===e||"facade"===e?"car":"testdrive"===e?"drive":"vr"===e?"vr":""},getTitle:function(e){return"interiors"===e?"内饰":"space"===e?"空间":"diagram"===e?"图解":"appearance"===e?"360":"facade"===e?"外观":"testdrive"===e?"试驾":"vr"===e?"VR":""},handleVRUpload:function(e,t,a){if("100"===e.resultCode){var r=this.getImage("vr");r.filePath=e.path,this.AddVrData(r);var i=[];i.push({name:e.path,url:e.path}),this.vrFileList=i}},handleVRRemove:function(e,t){this.vrFileList=[];var a=this.VrMediaData.findIndex((function(t){return"vr"===t.mediaType&&t.filePath===e.url}));-1===a?(a=this.VrMediaData.findIndex((function(t){return"vr"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==a&&this.VrMediaData.splice(a,1)):this.VrMediaData.splice(a,1)},handleTestDriveUpload:function(e,t,a){if("100"===e.resultCode){var r=this.getImage("testdrive");r.filePath=e.urls[0],this.AddVrData(r);var i=[];i.push({name:e.urls[0],url:e.urls[0]}),this.testDriverList=i}},handleTestDriveRemove:function(e,t){this.testDriverList=[];var a=this.VrMediaData.findIndex((function(t){return"testdrive"===t.mediaType&&t.filePath===e.url}));-1===a?(a=this.VrMediaData.findIndex((function(t){return"testdrive"===t.mediaType&&t.filePath===e.response.urls[0]})),-1!==a&&this.VrMediaData.splice(a,1)):this.VrMediaData.splice(a,1)},handleInteriorsUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("interiors");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleInteriorsRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"interiors"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"interiors"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleSpaceUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("space");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleSpaceRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"space"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"space"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleFullScreenUpload:function(e,t,a){if("100"===e.resultCode){var r=this.getImage("facade");r.color=a,r.filePath=e.map[0].large,r.large=e.map[0].large,r.medium=e.map[0].medium,r.thumbnail=e.map[0].thumbnail,r.fileName=e.map[0].fileName,r.source=e.map[0].source,this.AddVrData(r)}},handleFullScreenRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"facade"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"facade"===t.mediaType&&t.filePath===e.response.map[0].large})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleDiagramUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("diagram");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleDiagramRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"diagram"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"diagram"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleAppearanceUpload:function(e,t,a){if("100"===e.resultCode){var r=this.getImage("appearance");r.color=a,r.filePath=e.map[0].large,r.large=e.map[0].large,r.medium=e.map[0].medium,r.thumbnail=e.map[0].thumbnail,r.fileName=e.map[0].fileName,r.source=e.map[0].source,this.AddVrData(r)}},handleAppearanceRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.filePath===e.response.map[0].large})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},AddVrData:function(e){if("vr"===e.mediaType||"testdrive"===e.mediaType){var t=this.VrMediaData.findIndex((function(t){return t.mediaType===e.mediaType}));-1!==t?this.VrMediaData[t]=e:this.VrMediaData.push(e)}else this.VrMediaData.push(e)},DelVrData:function(e){var t=this.VrMediaData.findIndex((function(t){return t.filePath===e.url}));-1!==t&&this.VrMediaData.splice(t,1)},query:function(){var e=this,t={id:this.id};W["a"].getImageGroups_pm(t,(function(t){e.image=t.image,e.wideImage=t.wideImage,e.VrMediaData=t.VrMediaData,e.productImageDatas=t.productImageDatas,e.updateCarouselImages(),e.updateVrData(),e.VrMediaData.map((function(t){"vr"===t.mediaType&&(e.sourceType=t.sourceType,e.defaultType=t.sourceType,e.url=t.filePath)})),console.log("获取商品图片成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品图片失败",e.id)}))},save:function(){var e=this,t={id:this.id,shopId:window.top.SHOP_ID||"",image:this.image,wideImage:this.wideImage,productImageDatas:this.productImageDatas};W["a"].updateImageGroups_pm(t,(function(t){e.saveVR(!0)}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),e.saveVR(!1),console.log("更新商品轮播主图失败",e.id)}))},saveVR:function(e){var t=this;"1"===this.sourceType&&(this.VrMediaData=[],this.VrMediaData.push({color:"",fileName:"vr",filePath:this.url,id:"",large:"",mediaType:"vr",medium:"",sortSn:"",thumbnail:"",sourceType:this.sourceType,title:"vr",zipKey:""}));var a={id:this.id,shopId:window.top.SHOP_ID||"",datas:this.VrMediaData};W["a"].updateProductVrMediaBath_pm(a,(function(e){t.$message.success("更新商品图片成功")}),(function(a){""!==a.errorMessage&&t.$message.warning(a.errorMessage),!0===e&&t.query(),console.log("更新商品VR资源失败",t.id)}))},handleClose:function(e){this.appearanceList=this.appearanceList.filter((function(t){return t.name!==e.name}))},handleCloseFullScreen:function(e){this.fullScreenList=this.fullScreenList.filter((function(t){return t.name!==e.name}))},hasFullScreenImages:function(e){var t=this.VrMediaData.findIndex((function(t){return"fullScreen"===t.mediaType&&t.color===e.name}));return-1!==t},hasAppearanceImages:function(e){var t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.color===e.name}));return-1!==t}}},Q=Z,X=(a("ab138"),Object(S["a"])(Q,k,N,!1,null,null,null)),Y=X.exports,ee={name:"ProductMgmtPopup",components:{BizPopupTabs:g["a"],ProductSetting:M,Detail:z,PictureInfo:Y},props:{open:{type:Boolean},id:{type:String},tabName:{type:String}},data:function(){return{openPopup:!1,clickTabName:"Product"}},computed:{},methods:{close:function(e){this.$emit("close",e)},refreshProduct:function(e){this.$emit("refreshProduct",e)},createdProductSuccess:function(e){this.$emit("createdProductSuccess",e)}},watch:{}},te=ee,ae=Object(S["a"])(te,f,h,!1,null,null,null),re=ae.exports,ie={name:"ProductMgmt",data:function(){return{loading:!1,productId:"",refreshSign:!0,openPopup:!1,multipleSelection:[],operations:[{label:"添加",name:"add",type:"primary"},{disabled:!0,label:"删除",name:"deleteList",type:""},{label:"刷新",name:"refresh",type:""}],filters:[{type:"input",label:"",placeholder:"请输入关键字",name:"searchValue",value:""}],tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9}}},components:{BizFlexTable:s["c"],ProductMgmtPopup:re},created:function(){this.getUser(),this.refresh()},mounted:function(){},methods:Object(o["a"])(Object(o["a"])({},Object(m["c"])(["getUser"])),{},{operate:function(e){this[e]()},refresh:function(){this.getList()},getList:function(){var e=this,t={pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,searchProperty:"name",searchValue:this.filters[0].value};!0!==this.openPopup&&(this.loading=!0),p.getProductList(t,(function(t){e.tableData=t.sessionLogList,e.pagination.total=Number(t.total),e.loading=!1}),(function(t){console.log(t),e.$message.warning(t.errorMessage),e.loading=!1}))},filterDataChange:function(e){this.pagination.currentPage=1,this.refresh()},deleteList:function(){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t,a=[],r=Object(n["a"])(e.multipleSelection);try{for(r.s();!(t=r.n()).done;){var i=t.value;a.push(i.id)}}catch(s){r.e(s)}finally{r.f()}var o={ids:a};p.deleteBasicData(o,(function(t){e.$message({type:"success",message:"删除成功!"}),e.refresh()}),(function(t){console.log(t),e.$message.warning(t.errorMessage)}))})).catch((function(){}))},deleteProduct:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];a.push(e);var r={ids:a};p.deleteBasicData(r,(function(e){t.$message({type:"success",message:"删除成功!"}),t.refresh()}),(function(e){console.log(e),t.$message.warning(e.errorMessage)}))})).catch((function(){}))},categoryFormatter:function(e){switch(e.category){case"1":return"车品";case"2":return"汽车服务";default:break}},add:function(){this.openPopup=!0,this.productId=""},handleSelectionChange:function(e){this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1),this.multipleSelection=e},rowClick:function(e){this.openPopup=!0,this.productId=e.id},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},typeFilterHandler:function(e,t){return t.type===e},statusFilterHandler:function(e,t){return t.state===e},createdProductSuccess:function(e){this.productId=e}})},ne=ie,oe=(a("0870"),Object(S["a"])(ne,r,i,!1,null,null,null));t["default"]=oe.exports},"6b35":function(e,t,a){},7132:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},i=[],n={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},o=n,s=(a("5b8e"),a("2877")),c=Object(s["a"])(o,r,i,!1,null,null,null),l=c.exports,u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},d=[],p=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:l},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),m=p,f=(a("d4c2"),Object(s["a"])(m,u,d,!1,null,null,null)),h=f.exports;a.d(t,"a",(function(){return h}))},8779:function(e,t,a){"use strict";var r=a("6b35"),i=a.n(r);i.a},9678:function(e,t,a){},ab138:function(e,t,a){"use strict";var r=a("42b8"),i=a.n(r);i.a},bf3f:function(e,t,a){"use strict";var r=a("e68a"),i=a.n(r);i.a},c7a5:function(e,t,a){"use strict";var r=a("fb30"),i=a.n(r);i.a},d4c2:function(e,t,a){"use strict";var r=a("e725"),i=a.n(r);i.a},e68a:function(e,t,a){},e725:function(e,t,a){},fb30:function(e,t,a){},fe22:function(e,t,a){}}]);