(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b50a94a"],{"1a08":function(e,t,a){},2086:function(e,t,a){"use strict";var n=a("2497"),i=a("bc3a"),r=a.n(i),o=a("c596");t["a"]={getList:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.getMemberCardList,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getRightsList:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.getList,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},listDistributeRights:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.listDistributeRights,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},listCardTemplate:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.listCardTemplate,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getlistVbean:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.getlistVbean,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getIntegralList:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.getIntegralList,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},listProduct:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.listProduct,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryUserRights:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.queryUserRights,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryUserCoupons:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.queryUserCoupons,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},listByRights:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.listByRights,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getVipCardInfo:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.getVipCardInfo,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getVipCardTemplate:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.getVipCardTemplate,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},memberRankList:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.memberRankList,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},setting:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.setting,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},settingUpdate:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.setting,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryPeople:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.queryPeople,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){r.a.delete(o["g"].memberCardMgmt.memberCard.deleteManage,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},verification:function(e,t,a){r.a.post(o["g"].memberCardMgmt.vipRights.verification,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},updateTemplate:function(e,t,a){r.a.put(o["g"].memberCardMgmt.memberCard.updateTemplate,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},createTemplate:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.updateTemplate,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},delTemplate:function(e,t,a){r.a.delete(o["g"].memberCardMgmt.memberCard.updateTemplate,{data:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},distributeRights:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.distributeRights,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},distributeAssignedRights:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.distributeAssignedRights,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},updateVipCardState:function(e,t,a){r.a.put(o["g"].memberCardMgmt.memberCard.updateVipCardState,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},createVipCard:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.createVipCard,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},createBean:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.createBean,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},createPoint:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.createPoint,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},addScore:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.addScore,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},reduceDeposit:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.reduceDeposit,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getlistUpgrade:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.getlistUpgrade,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getlistStore:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.getlistStore,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},updateGrade:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.updateGrade,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getVipCardGradeInfo:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.getVipCardGradeInfo,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},editVipCardGrade:function(e,t,a){r.a.put(o["g"].memberCardMgmt.memberCard.VipCardGrade,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},addVipCardGrade:function(e,t,a){r.a.post(o["g"].memberCardMgmt.memberCard.VipCardGrade,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},delVipCardGrade:function(e,t,a){r.a.delete(o["g"].memberCardMgmt.memberCard.VipCardGrade,{data:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},listAuthority:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.listAuthority,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},vipRightsList:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.getList,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryrightsClass:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.get,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},getFirstClassifies:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.getFirstClassifies,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},rightsCouponList:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.rightsCouponList,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryRightsCoupon:function(e,t,a){r.a.get(o["g"].memberCardMgmt.vipRights.queryRightsCoupon,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},memberCardBox:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.memberCardBox,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},editRightsClass:function(e,t,a){r.a.put(o["g"].memberCardMgmt.vipRights.edit,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},createRightsClass:function(e,t,a){r.a.post(o["g"].memberCardMgmt.vipRights.add,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},rightsCouponUpdate:function(e,t,a){r.a.put(o["g"].memberCardMgmt.vipRights.rightsCouponUpdate,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},rightsCouponCreate:function(e,t,a){r.a.post(o["g"].memberCardMgmt.vipRights.rightsCouponCreate,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},deleteRightscoupon:function(e,t,a){r.a.delete(o["g"].memberCardMgmt.vipRights.deleteRightscoupon,{data:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},deleteRights:function(e,t,a){r.a.delete(o["g"].memberCardMgmt.vipRights.delete,{data:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},certificate:function(e,t,a){r.a.get(o["g"].memberCardMgmt.memberCard.certificate,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))}}},2497:function(e,t,a){"use strict";var n=a("4360"),i=a("a18c");t["a"]=function(e,t){return function(a){var r=a.data;"100"===r.resultCode?e(r):"709"===r.resultCode?(n["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",n["a"].getters.currentUser),i["a"].push("/login")):t(r)}}},"33ba":function(e,t,a){"use strict";var n=a("7741"),i=a.n(n);i.a},"378c":function(e,t,a){"use strict";var n=a("81f1"),i=a.n(n);i.a},"4a4c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"member-card-template-list"},[a("div",{attrs:{slot:"top"},slot:"top"},[a("div",{staticClass:"member-mgmt-top"},[e.isEdit?a("biz-header",{attrs:{operations:e.operations,filters:e.filters},on:{operate:e.operate,filterDataChange:e.filterDataChange}}):e._e(),e.isEdit?e._e():a("biz-header",{attrs:{filters:e.filters},on:{filterDataChange:e.filterDataChange}})],1)]),a("div",{staticClass:"content"},[a("div",{staticClass:"promise-list-card"},[e._l(e.cardList,(function(t,n){return a("a",{key:n,staticClass:"promise-item",on:{click:function(a){return e.handleClick(t,a)}}},[a("div",{staticClass:"center-content"},[a("div",{staticClass:"title-class"},[a("span",{staticClass:"title-name"},[e._v(e._s(t.name)+" ")]),"1"===t.isDefault?a("span",{staticClass:"font"},[e._v("默认")]):e._e()]),"1"===t.unionConfig.editable&&e.isEdit||"shop"!==e.getUser.roleLevel?a("el-switch",{attrs:{"active-color":"#87d068","inactive-color":"#d9d9d9","active-value":"1","inactive-value":"0","active-text":"1"===t.state?"已打开":"已关闭"},on:{change:function(a){return e.stateChange(t)}},model:{value:t.state,callback:function(a){e.$set(t,"state",a)},expression:"item.state"}}):e._e()],1),a("div",{staticClass:"content"},[a("div",{staticClass:"shop-name"},[e._v(e._s(t.shop.name))])]),a("div",{staticClass:"content"},[a("div",{staticClass:"count",attrs:{title:t.description}},[e._v(e._s(t.description))])]),a("div",{staticClass:"contenttext"},[e._v(" 有效期："+e._s(t.beginDate.split(" ")[0])+"——"+e._s(t.endDate.split(" ")[0])+" ")]),"1"===t.unionConfig.editable&&e.hasAuthDel||"shop"!==e.getUser.roleLevel?a("div",{staticClass:"close",on:{click:function(a){return a.stopPropagation(),e.handleClose(t,a)}}},[a("i",{staticClass:"el-icon-close"})]):e._e()])})),0===e.cardList.length?a("div",{style:e.styleObject}):e._e()],2)]),a("div",{attrs:{slot:"float"},slot:"float"},[a("biz-popup-tabs",{attrs:{open:e.openPopup},on:{close:function(t){e.openPopup=!1}},model:{value:e.popupTabName,callback:function(t){e.popupTabName=t},expression:"popupTabName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[a("base-info",{ref:"baseInfo",attrs:{itemId:e.itemId,isEdit:e.flag},on:{operationSuccess:e.operationSuccess}})],1),e.show?a("el-tab-pane",{attrs:{label:"等级",name:"second"}},[a("member-card-grade-info",{ref:"gradeInfo",attrs:{itemId:e.itemId,isEdit:e.flag},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.show?a("el-tab-pane",{attrs:{label:"奖励设置",name:"third"}},[a("member-awards",{ref:"awardsInfo",attrs:{itemId:e.itemId,isEdit:e.flag},on:{operationSuccess:e.operationSuccess}})],1):e._e()],1)],1),a("biz-pagination",{attrs:{slot:"bottom",pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange},slot:"bottom"})],1)},i=[],r=(a("a4d3"),a("e01a"),a("caad"),a("c975"),a("d81d"),a("b0c0"),a("a9e3"),a("d3b7"),a("2532"),a("5530")),o=a("04d3"),s=a("f36f"),l=a("7132"),c=a("1ab1"),m=a("f260"),u=a.n(m),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"member-card-template-info"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"content"},[e.isEdit?a("biz-save-button",{staticStyle:{"margin-right":"0px"},attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",staticClass:"item",attrs:{model:e.form,"label-width":"120px",size:"small",rules:e.rules,disabled:!e.isEdit,"inline-message":!0}},[a("el-form-item",{attrs:{label:"会员卡名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入卡名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"会员卡描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:10},placeholder:"请输入会员卡描述"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:"有效期开始日期",prop:"date"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","start-placeholder":"开始日期"},model:{value:e.form.beginDate,callback:function(t){e.$set(e.form,"beginDate",t)},expression:"form.beginDate"}})],1),a("el-form-item",{attrs:{label:"有效期截止日期",prop:"date"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","start-placeholder":"截至日期"},model:{value:e.form.endDate,callback:function(t){e.$set(e.form,"endDate",t)},expression:"form.endDate"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"state"}},[a("el-switch",{attrs:{"active-color":"#87d068","inactive-color":"#d9d9d9","active-value":"1","inactive-value":"0"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}})],1),a("el-form-item",{attrs:{label:"默认会员卡",prop:"isDefault"}},[a("el-switch",{attrs:{disabled:e.disabled,"active-color":"#87d068","inactive-color":"#d9d9d9","active-value":"1","inactive-value":"0"},model:{value:e.form.isDefault,callback:function(t){e.$set(e.form,"isDefault",t)},expression:"form.isDefault"}})],1)],1)],1)])},g=[],p=a("8330"),f=a("2086"),h=a("c466"),b={name:"MemberCardTemplateMgmt",props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{loading:!1,gradeList:[],templateId:"",isCreated:!1,disabled:!1,form:{name:"",description:"",state:"1",isDefault:"0",beginDate:"",endDate:""},rules:{name:[{required:!0,message:"请输入卡模版名称",trigger:"blur"}]},operations:[{label:"保存",name:"save",type:"primary"}]}},components:{BizGrid:s["a"],BizSaveButton:p["a"]},computed:{dateRange:{get:function(){return this.form.beginDate&&this.form.endDate?[this.form.beginDate,this.form.endDate]:[h["a"].nowDate(),h["a"].lastTwoYearDate()]},set:function(e){e?(this.form.beginDate=e[0],this.form.endDate=e[1]):(this.form.beginDate="",this.form.endDate="")}}},created:function(){},mounted:function(){},watch:{itemId:function(e,t){this.$refs.form.clearValidate(),e.id?e.id!==t.id&&this.getList():e.id!==t.id&&this.initModel()}},methods:{operate:function(e){this[e]()},operationSuccess:function(){this.getList()},initModel:function(){this.form={name:"",description:"",state:"1",isDefault:"0",beginDate:h["a"].nowDate(),endDate:h["a"].lastTwoYearDate()}},refresh:function(){},getList:function(){var e=this;this.loading=!0,this.itemId.id&&f["a"].getVipCardTemplate({templateId:this.itemId.id||""},(function(t){e.form=t.content,"1"===t.content.isDefault?e.disabled=!0:e.disabled=!1,e.loading=!1}),(function(e){console.log(e),console.log("code错误")}))},save:function(){var e=this;this.form.beginDate&&this.form.endDate&&this.form.beginDate>this.form.endDate?this.$message.warning("开始日期不能大于结束日期"):(this.itemId.id&&f["a"].updateTemplate({id:this.itemId.id||"",name:this.form.name,description:this.form.description,beginDate:this.form.beginDate,endDate:this.form.endDate,state:this.form.state,isDefault:this.form.isDefault,shopId:window.top.SHOP_ID||""},(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),console.log("code错误")})),!this.itemId.id&&f["a"].createTemplate({name:this.form.name,description:this.form.description,beginDate:this.form.beginDate,endDate:this.form.endDate,isDefault:this.form.isDefault,state:this.form.state,shopId:window.top.SHOP_ID||""},(function(t){e.$message.success("保存成功"),e.itemId.id=t.templateId,e.getList(),e.$emit("operationSuccess",t.templateId),e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),console.log("code错误")})),this.templateId&&this.$refs.awards.save())}}},v=b,C=(a("378c"),a("2877")),B=Object(C["a"])(v,d,g,!1,null,null,null),y=B.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"member-awards"},[e.isEdit?a("biz-header",{attrs:{operations:e.operations},on:{operate:e.operate}}):e._e(),a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-form",{ref:"form",staticStyle:{"border-bottom":"1px solid #ebeef5"},attrs:{size:"small","label-width":"205px",model:e.form,rules:e.rules,disabled:!e.isEdit}},[a("el-collapse-item",{attrs:{title:"完善信息",name:"1"}},[a("el-form-item",{staticClass:"display-inline",attrs:{label:"完善个人信息，赠送V豆数量",prop:"memberBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.memberBean,callback:function(t){e.$set(e.form,"memberBean",t)},expression:"form.memberBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"完善车辆信息，赠送V豆数量",prop:"carBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.carBean,callback:function(t){e.$set(e.form,"carBean",t)},expression:"form.carBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"完善行驶证信息，赠送V豆数量",prop:"vehicleLicense"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.vehicleLicense,callback:function(t){e.$set(e.form,"vehicleLicense",t)},expression:"form.vehicleLicense"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"完善质保信息，赠送V豆数量",prop:"qualityAssuranceBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.qualityAssuranceBean,callback:function(t){e.$set(e.form,"qualityAssuranceBean",t)},expression:"form.qualityAssuranceBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"完善保险信息，赠送V豆数量",prop:"insuranceBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.insuranceBean,callback:function(t){e.$set(e.form,"insuranceBean",t)},expression:"form.insuranceBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"完善保养信息，赠送V豆数量",prop:"maintainBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.maintainBean,callback:function(t){e.$set(e.form,"maintainBean",t)},expression:"form.maintainBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"完善年检信息，赠送V豆数量",prop:"inspectionBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.inspectionBean,callback:function(t){e.$set(e.form,"inspectionBean",t)},expression:"form.inspectionBean"}})],1)],1),a("el-collapse-item",{attrs:{title:"促活",name:"2"}},[a("el-form-item",{staticClass:"display-inline",attrs:{label:"首次进入店铺送V豆数量",prop:"loginShopBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.loginShopBean,callback:function(t){e.$set(e.form,"loginShopBean",t)},expression:"form.loginShopBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"每次签到奖励V豆数量",prop:"signBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.signBean,callback:function(t){e.$set(e.form,"signBean",t)},expression:"form.signBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"每连续签到天数",prop:"continueSignTimes"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.continueSignTimes,callback:function(t){e.$set(e.form,"continueSignTimes",t)},expression:"form.continueSignTimes"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"再奖励V豆数量",prop:"continueSignBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.continueSignBean,callback:function(t){e.$set(e.form,"continueSignBean",t)},expression:"form.continueSignBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"每次社区发帖奖励V豆数量",prop:"spaceBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.spaceBean,callback:function(t){e.$set(e.form,"spaceBean",t)},expression:"form.spaceBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"每日发帖奖励次数上限",prop:"spaceLimit"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.spaceLimit,callback:function(t){e.$set(e.form,"spaceLimit",t)},expression:"form.spaceLimit"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"每次分享奖励V豆数量",prop:"shareBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.shareBean,callback:function(t){e.$set(e.form,"shareBean",t)},expression:"form.shareBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"每日分享奖励次数上限",prop:"shareTimesLimit"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.shareTimesLimit,callback:function(t){e.$set(e.form,"shareTimesLimit",t)},expression:"form.shareTimesLimit"}})],1)],1),a("el-collapse-item",{attrs:{title:"鼓励设备使用",name:"3"}},[a("el-form-item",{staticClass:"display-inline",attrs:{label:"每周不良驾驶行为小于次数",prop:"drivingBehaviorScore"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.drivingBehaviorScore,callback:function(t){e.$set(e.form,"drivingBehaviorScore",t)},expression:"form.drivingBehaviorScore"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送V豆数",prop:"drivingBehaviorBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.drivingBehaviorBean,callback:function(t){e.$set(e.form,"drivingBehaviorBean",t)},expression:"form.drivingBehaviorBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"每周里程累计公里数达到",prop:"mileCount"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.mileCount,callback:function(t){e.$set(e.form,"mileCount",t)},expression:"form.mileCount"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送V豆数",prop:"mileBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.mileBean,callback:function(t){e.$set(e.form,"mileBean",t)},expression:"form.mileBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"视频/拍照每日超过次数",prop:"shotLimit"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.shotLimit,callback:function(t){e.$set(e.form,"shotLimit",t)},expression:"form.shotLimit"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"每次消耗V豆数",prop:"shotBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.shotBean,callback:function(t){e.$set(e.form,"shotBean",t)},expression:"form.shotBean"}})],1)],1),a("el-collapse-item",{attrs:{title:"消费充值奖励",name:"4"}},[a("el-form-item",{staticClass:"display-inline",attrs:{label:"会员卡消费金额（元）",prop:"consume"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.cardConsume,callback:function(t){e.$set(e.form,"cardConsume",t)},expression:"form.cardConsume"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送V豆数",prop:"consumeBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.cardConsumeBean,callback:function(t){e.$set(e.form,"cardConsumeBean",t)},expression:"form.cardConsumeBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送积分",prop:"consumePoint"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.cardConsumePoint,callback:function(t){e.$set(e.form,"cardConsumePoint",t)},expression:"form.cardConsumePoint"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"其他消费金额（元）",prop:"consume"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.consume,callback:function(t){e.$set(e.form,"consume",t)},expression:"form.consume"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送V豆数",prop:"consumeBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.consumeBean,callback:function(t){e.$set(e.form,"consumeBean",t)},expression:"form.consumeBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送积分",prop:"consumePoint"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.consumePoint,callback:function(t){e.$set(e.form,"consumePoint",t)},expression:"form.consumePoint"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"会员卡充值金额（元）",prop:"recharge"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.recharge,callback:function(t){e.$set(e.form,"recharge",t)},expression:"form.recharge"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送V豆数",prop:"rechargeBean"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.rechargeBean,callback:function(t){e.$set(e.form,"rechargeBean",t)},expression:"form.rechargeBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送积分",prop:"rechargePoint"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.rechargePoint,callback:function(t){e.$set(e.form,"rechargePoint",t)},expression:"form.rechargePoint"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送金额（元）",prop:"rechargeCash"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.rechargeCash,callback:function(t){e.$set(e.form,"rechargeCash",t)},expression:"form.rechargeCash"}})],1),e._l(e.form.extraRecharges,(function(t){return a("div",{key:t.id},[a("el-form-item",{staticClass:"display-inline",attrs:{label:"会员卡充值金额（元）",prop:"recharge"}},[a("el-input-number",{attrs:{min:0},model:{value:t.recharge,callback:function(a){e.$set(t,"recharge",a)},expression:"item.recharge"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送V豆数",prop:"bean"}},[a("el-input-number",{attrs:{min:0},model:{value:t.bean,callback:function(a){e.$set(t,"bean",a)},expression:"item.bean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送积分",prop:"point"}},[a("el-input-number",{attrs:{min:0},model:{value:t.point,callback:function(a){e.$set(t,"point",a)},expression:"item.point"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"赠送金额（元）",prop:"cash"}},[a("el-input-number",{attrs:{min:0},model:{value:t.cash,callback:function(a){e.$set(t,"cash",a)},expression:"item.cash"}})],1),a("i",{staticClass:"el-icon-error",on:{click:function(a){return e.deleteExtraRecharges(t)}}})],1)})),a("i",{staticClass:"el-icon-circle-plus-outline",on:{click:e.addExtraRecharges}},[a("span",[e._v("添加")])])],2),a("el-collapse-item",{attrs:{title:"V豆线上消费",name:"5"}},[a("el-form-item",{staticClass:"display-inline",attrs:{label:"抵现1元须消耗V豆数数量",prop:"vBean"}},[a("el-input-number",{attrs:{min:1,maxlength:7},model:{value:e.form.vBean,callback:function(t){e.$set(e.form,"vBean",t)},expression:"form.vBean"}})],1),a("el-form-item",{staticClass:"display-inline",attrs:{label:"V豆抵现上限（%）",prop:"arrivalRate"}},[a("el-input-number",{attrs:{min:0,max:100},model:{value:e.form.arrivalRate,callback:function(t){e.$set(e.form,"arrivalRate",t)},expression:"form.arrivalRate"}})],1)],1)],1)],1)],1)},$=[],M=(a("a434"),a("25f0"),{name:"MemberAwards",props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},components:{BizGrid:s["a"],BizHeader:o["d"]},data:function(){return{loading:!1,formLoading:!1,showForm:!1,selections:[],tableData:[],activeNames:["0","1","2","3","4","5"],form:{memberBean:"5",carBean:"5",insuranceBean:"5",maintainBean:"5",inspectionBean:"5",qualityAssuranceBean:"5",loginShopBean:"50",signBean:"1",continueSignTimes:"5",continueSignBean:"10",spaceBean:"1",spaceLimit:"5",shareBean:"1",shareTimesLimit:"5",drivingBehaviorScore:"7",drivingBehaviorBean:"100",vehicleLicense:"5",mileCount:"300",mileBean:"100",shotLimit:"3",shotBean:"5",cardConsume:"",cardConsumeBean:"",cardConsumePoint:"",consume:"1",consumeBean:"1",consumePoint:"1",recharge:"",rechargeBean:"",rechargePoint:"",rechargeCash:"",vBean:"100",arrivalRate:"2",extraRecharges:[]},operations:[{label:"保存",name:"save",type:"primary"}],rules:{memberBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],carBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],insuranceBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],maintainBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],qualityAssuranceBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],inspectionBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],loginShopBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],signBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],continueSignTimes:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],continueSignBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],spaceBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],spaceLimit:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],shareBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],shareTimesLimit:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],drivingBehaviorScore:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],drivingBehaviorBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],vehicleLicense:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],mileCount:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],mileBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],shotLimit:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],shotBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],consume:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],consumeBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],consumePoint:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],cardConsume:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],cardConsumeBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],cardConsumePoint:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],recharge:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],rechargeBean:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],rechargePoint:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],rechargeCash:[{pattern:/^\d+$/,message:"请输入正整数",trigger:"blur"}],vBean:[{required:!0,trigger:"blur",message:"必填"},{pattern:/^[1-9]\d*$/,message:"请输入正确的数值",trigger:"blur"}],arrivalRate:[{required:!0,trigger:"blur",message:"必填"},{pattern:/^\d\.([0-9]{1,2}|[0-9][1-9])$|^[0-9]\d{0,1}(\.\d{1,2}){0,1}$|^100(\.0{1,2}){0,1}$/,message:"请输入正确的数值",trigger:"blur"}]}}},created:function(){},mounted:function(){},watch:{itemId:function(e,t){this.$refs.form.clearValidate(),e.id?e.id!==t.id&&this.getList():e.id!==t.id&&this.initModel()}},methods:{addExtraRecharges:function(){this.form.extraRecharges.push({id:Math.floor(1e5*Math.random()).toString(),recharge:"",bean:"",point:"",cash:""})},deleteExtraRecharges:function(e){this.form.extraRecharges.splice(this.form.extraRecharges.indexOf(e),1)},initModel:function(){this.form={memberBean:"5",carBean:"5",insuranceBean:"5",maintainBean:"5",qualityAssuranceBean:"",inspectionBean:"5",loginShopBean:"50",signBean:"1",continueSignTimes:"5",continueSignBean:"10",spaceBean:"1",spaceLimit:"5",shareBean:"1",shareTimesLimit:"5",drivingBehaviorScore:"7",drivingBehaviorBean:"100",vehicleLicense:"5",mileCount:"300",mileBean:"100",shotLimit:"3",shotBean:"5",consume:"1",consumeBean:"1",consumePoint:"1",recharge:"",rechargeBean:"",rechargePoint:"",rechargeCash:"",vBean:"100",arrivalRate:"2",extraRecharges:[]}},operate:function(e){this[e]()},getList:function(){var e=this;f["a"].setting({userCardTemplateId:this.itemId.id||""},(function(t){e.form=Object.assign(e.form,t.content),e.loading=!1}),(function(e){console.log(e),console.log("code错误")}))},save:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.form.userCardTemplateId=e.itemId.id,e.form.signTimes="1",e.form.cash="1",e.form.shareTimes="1",e.itemId.id&&f["a"].settingUpdate(e.form,(function(t){e.$message.success("保存成功"),e.loading=!1}),(function(t){e.$message.warning(t.errorMessage),console.log("code错误")})))}))}}}),D=M,I=(a("923a"),Object(C["a"])(D,w,$,!1,null,null,null)),x=I.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"member-grade-info"},[e.isEdit?a("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}}):e._e(),a("el-table",{attrs:{data:e.tableData,height:"300",stripe:"","highlight-current-row":"","tooltip-effect":"dark",size:"small"},on:{"selection-change":e.handleSelectionChange,"row-click":e.rowClick}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"等级",prop:"name"}}),a("el-table-column",{attrs:{label:"积分标准",prop:"point"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#87d068","inactive-color":"#d9d9d9","active-value":"1","inactive-value":"0",disabled:!e.isEdit},on:{change:function(a){return e.stateChange(t.row)}},model:{value:t.row.state,callback:function(a){e.$set(t.row,"state",a)},expression:"scope.row.state"}})]}}])}),a("el-table-column",{attrs:{label:"等级权益",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},e._l(t.row.rights,(function(t){return t.rights?a("div",{key:t.id,attrs:{label:t.name+":",prop:"rights"}},e._l(t.rights,(function(t){return"1"===t.isSelected?a("div",{key:t.id,attrs:{label:t.name,"true-label":"1","false-label":"0"}},[e._v(e._s(t.name))]):e._e()})),0):e._e()})),0)}}])})],1),a("div",{staticClass:"biz-pagination"},[a("el-pagination",{attrs:{total:e.pagination.total,"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize,layout:"total, prev, pager, next"},on:{"current-change":e.handleCurrentChange}})],1),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"},{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px",size:"small",rules:e.rules,disabled:!e.isEdit}},[a("el-form-item",{attrs:{label:"等级名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入等级名称",maxlength:6},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"等级图标",prop:"image"}},[a("BizAvatarUploaderNew",{attrs:{disabled:!e.isEdit},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1),a("el-form-item",{attrs:{label:"积分标准",prop:"point"}},[a("div",{staticStyle:{display:"inline"},attrs:{slot:"label"},slot:"label"},[e._v(" 积分标准 "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:point",arg:"point"}],attrs:{type:"text",size:"small"}},[a("i",{staticClass:"iconfont el-icon-question"})]),a("el-popover",{ref:"point",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"会员积分达到积分标准时等级将会提升到此等级"}})],1),a("el-input-number",{model:{value:e.form.point,callback:function(t){e.$set(e.form,"point",t)},expression:"form.point"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"state"}},[a("el-switch",{attrs:{"active-color":"#87d068","inactive-color":"#d9d9d9","active-value":"1","inactive-value":"0"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}})],1),a("el-form-item",{attrs:{label:"等级权益"}},[a("div",{attrs:{slot:"label"},slot:"label"},[e._v(" 等级权益 "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:rights",arg:"rights"}],attrs:{type:"text",size:"small"}},[a("i",{staticClass:"iconfont el-icon-question"})]),a("el-popover",{ref:"rights",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"等级权益可在【会员权益】里添加或修改"}})],1),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.dialogTableVisible=!0}}},[e._v("选择")])],1),e._l(e.form.rights,(function(t){return t.rights?a("div",{key:t.id,attrs:{prop:"rights"}},e._l(t.rights,(function(t){return"1"===t.isSelected?a("div",{key:t.id,staticClass:"rights-selected"},[a("img",{attrs:{src:t.logo||e.defaultImg,width:"50px",height:"50px"}}),a("div",{staticClass:"right_name",attrs:{title:t.name}},[e._v(e._s(t.name))])]):e._e()})),0):e._e()}))],2),e.isEdit?a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.formOperations},on:{operate:e.handleOperate}}):e._e()],1),a("el-dialog",{attrs:{title:"权益选择",center:"",visible:e.dialogTableVisible,width:"80%","append-to-body":"","custom-class":"rights-select","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogTableVisible=t},close:e.closed}},[a("el-form",{ref:"formDialog",attrs:{"label-width":"120px",size:"small"}},e._l(e.form.rights,(function(t){return t.rights?a("el-form-item",{key:t.id,attrs:{label:t.name+":",prop:"rights"}},e._l(t.rights,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.name,disabled:"0"===t.valid,"true-label":"1","false-label":"0"},model:{value:t.isSelected,callback:function(a){e.$set(t,"isSelected",a)},expression:"item.isSelected"}},[a("img",{attrs:{src:t.logo||e.defaultImg,width:"50px",height:"50px"}}),a("div",{staticClass:"right_name",attrs:{title:t.name}},[e._v(e._s(t.name))])])})),1):e._e()})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer",align:"right"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.cancle}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确认选择")])],1)],1)],1)},k=[],T=(a("4160"),a("159b"),a("c17f")),O={name:"MemberGradeInfo",props:{itemId:{type:Object,default:function(){return{id:""}}},templateId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},components:{BizHeader:o["d"],BizGrid:s["a"],BizAvatarUploaderNew:T["b"],BizSaveButton:p["a"]},data:function(){return{loading:!1,formLoading:!1,defaultImg:"/resources/admin/images/default/icon_vip.png",showForm:!1,dialogTableVisible:!1,flag:!1,selectionIds:[],currentRights:[],id:"",form:{name:"",image:this.defaultImg,point:"",state:"1",rights:[]},operations:[{label:"添加",name:"add",type:"primary"},{label:"删除",name:"delete",type:"",disabled:!0}],formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"save",type:"primary"}],selections:[],tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},rules:{name:[{required:!0,message:"请输入等级名称",trigger:"change"}],point:[{required:!0,message:"请输入积分标准",trigger:"blur"},{pattern:/^\+?[0-9]\d*$/,message:"请输入正确的积分",trigger:"blur"}]}}},created:function(){this.getDefaultImg()},watch:{itemId:function(e,t){this.$refs.form.clearValidate(),e.id?e.id!==t.id&&this.getList():e.id!==t.id&&this.initModel()}},methods:{showNotify:function(e,t){this.$notify({showClose:!0,message:e,type:t})},closed:function(){this.flag||this.cancle()},cancle:function(){var e=this;this.dialogTableVisible=!1,this.flag=!1,this.form.rights=this.form.rights.forEach((function(e){e.rights.forEach((function(e){"1"===e.isSelected&&(e.isSelected="0")}))})),this.id&&f["a"].getVipCardGradeInfo({rankId:this.id||"",shopId:window.top.SHOP_ID||""},(function(t){e.form.rights=t.content.rights,e.form.rights.forEach((function(t){t.rights.forEach((function(t){-1!==e.selectionIds.indexOf(t.id)&&(t.isSelected="1")}))}))}),(function(t){e.formLoading=!1,console.log(t),console.log("code错误")}))},confirm:function(){var e=this;this.dialogTableVisible=!1,this.flag=!0,this.selectionIds=[],this.form.rights.forEach((function(t){t.rights.forEach((function(t){"1"===t.isSelected&&e.selectionIds.push(t.id)}))}))},getDefaultImg:function(){var e=this,t={type:"displaySetting"};c["a"].get("/admin/settings/settings.jhtml",t).then((function(t){t.settingList.defaultThumbnailProductImage&&(e.defaultImg=t.settingList.defaultThumbnailProductImage)})).catch((function(t){console.log(t),console.log("code错误"),e.$message.warning(t.errorMessage)}))},stateChange:function(e){var t=this;f["a"].editVipCardGrade({id:e.id,name:e.name,image:e.image,point:e.point,state:e.state,rights:e.rights,template:{id:this.itemId.id}},(function(e){t.$message.success("操作成功"),t.loading=!1}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},initModel:function(){this.form={name:"",image:this.defaultImg,point:"",state:"1",rights:[]}},add:function(){this.showForm=!0,this.initModel(),this.getRights()},cancelForm:function(){this.showForm=!1},getList:function(){var e=this;this.showForm=!1,f["a"].memberRankList({templateId:this.itemId.id||"",shopId:window.top.SHOP_ID||""},(function(t){e.tableData=t.content,e.pagination.total=Number(t.total),e.loading=!1}),(function(e){console.log(e),console.log("code错误")}))},query:function(e){var t=this;this.formLoading=!0,this.id=e,f["a"].getVipCardGradeInfo({rankId:e||"",shopId:window.top.SHOP_ID||""},(function(e){t.form=Object.assign(t.form,e.content),t.formLoading=!1,t.currentRights=t.form.rights}),(function(e){t.formLoading=!1,console.log(e),console.log("code错误")}))},getRights:function(){var e=this;f["a"].getRightsList({shopId:window.top.SHOP_ID||""},(function(t){e.form.name="",e.form.point="",e.form.state="1",e.form.rights=t.content,e.currentRights=e.form.rights}),(function(e){console.log(e),console.log("code错误")}))},rowClick:function(e,t,a){if("状态"===a.label)return!1;this.query(e.id),this.showForm=!0},handleOperate:function(e){this[e]()},handleSelectionChange:function(e){e.length>0?this.operations[1].disabled=!1:this.operations[1].disabled=!0,this.selections=e},handleCurrentChange:function(e){this.pagination.currentPage=e,this.getList()},delete:function(){var e=this,t=[];this.selections.map((function(e){t.push(e.id)})),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,f["a"].delVipCardGrade({userRankIds:t,shopId:window.top.SHOP_ID||""},(function(t){e.$message.success("删除成功"),e.getList(),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},save:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.loading=!0,e.form.id&&f["a"].editVipCardGrade(e.form,(function(t){e.$message.success("保存成功"),e.loading=!1,e.getList()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})),e.form.id||(e.form.template={id:e.itemId.id}),!e.form.id&&f["a"].addVipCardGrade(e.form,(function(t){e.$message.success("保存成功"),e.loading=!1,e.getList()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})))}))}}},L=O,_=(a("33ba"),Object(C["a"])(L,S,k,!1,null,null,null)),j=_.exports,R=a("c596"),V=a("2f62"),P={name:"MemebrCardList",data:function(){return{loading:!1,memberInfo:!1,isEdit:!0,show:!0,flag:!0,itemId:{id:""},height:"100%",isCreated:!1,dialogTableVisible:!1,popupTabName:"first",memberName:"memberInfo",openPopup:!1,editShopIds:[],cardList:[],multipleSelection:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},operations:[{label:"添加",name:"create",type:"primary",auth:["admin:memberCardTemplate.add"]},{label:"刷新",name:"refresh",type:""}],filters:[{type:"select",label:"所属店铺",name:"shopName",value:"",options:[]},{type:"select",label:"状态",name:"state",value:"",options:[{value:"",label:"全部"},{value:"0",label:"停用"},{value:"1",label:"启用"}]},{type:"input",label:"",placeholder:"请输入会员卡名称",name:"searchValue",value:""}]}},components:{BizGrid:s["a"],BizHeader:o["d"],BizPagination:o["f"],BizPopupTabs:l["a"],BaseInfo:y,MemberAwards:x,MemberCardGradeInfo:j},created:function(){this.getList(),this.listAuthority(),this.queryShopList()},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(V["c"])(["getUser"])),Object(V["c"])("Authority",["currentAuth"])),{},{hasAuthDel:function(){return this.currentAuth.includes("admin:memberCardTemplate.delete")},styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+u.a+") 50% 50% / 20% no-repeat"}}}),mounted:function(){},methods:{operate:function(e){this[e]()},refresh:function(){this.getList()},operationSuccess:function(e){this.getList(),this.show=!0,this.$nextTick((function(){e&&(this.itemId={id:e})}))},create:function(){this.show=!1,this.flag=!0,this.popupTabName="first",this.itemId={id:""},this.openPopup=!0},queryShopList:function(){var e=this;c["a"].get(R["o"].mainPage.shopList,{shopId:window.top.SHOP_ID||"",sourceType:"6"}).then((function(t){var a=t.shops;a.map((function(e){e.value=e.id,e.label=e.name})),a.unshift({value:"",label:"全部"}),e.$set(e.filters[0],"options",a)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))},stateChange:function(e){var t=this;this.loading=!0,f["a"].updateTemplate({id:e.id||"",name:e.name,description:e.description,beginDate:e.beginDate,endDate:e.endDate,state:e.state,isDefault:e.isDefault,shopId:window.top.SHOP_ID||""},(function(e){t.$message.success("操作成功"),t.loading=!1}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage),console.log("code错误")}))},listAuthority:function(){var e=this;f["a"].listAuthority({},(function(t){t.authorities.indexOf("admin:memberCardTemplate.edit")>0?e.isEdit=!0:e.isEdit=!1,e.getEditableStores()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},getEditableStores:function(){var e=this;c["a"].get(R["j"].editableStores,{resourceType:"6"}).then((function(t){e.editShopIds=[],t.dataList.map((function(t){e.editShopIds.push(t.id)}))})).catch((function(e){console.log(e),console.log("code错误")}))},getList:function(){var e=this,t={state:this.filters[1].value,searchShopId:this.filters[0].value,searchValue:this.filters[2].value,shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};c["a"].get("/admin/memberCardTemplate/memberCardTemplates.jhtml",t).then((function(t){e.cardList=t.content,e.pagination.total=Number(t.total)})).catch((function(t){console.log("errdata: ",t),e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},handleClick:function(e,t){if("el-switch__core"===t.target.className)return!1;this.show=!0,this.$nextTick((function(){"1"===e.unionConfig.editable&&this.isEdit||"shop"!==this.getUser.roleLevel?this.flag=!0:this.flag=!1,this.itemId={id:String(e.id)},this.popupTabName="first",this.openPopup=!0}))},handleClose:function(e){var t=this,a=[];a.push(e.id),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,f["a"].delTemplate({templateIds:a,shopId:window.top.SHOP_ID||""},(function(e){t.$message.success("删除成功"),t.getList(),t.loading=!1}),(function(e){t.$message.warning(e.errorMessage),t.loading=!1,console.log("code错误")}))}))},filterDataChange:function(){this.getList()},handleSizeChange:function(e){this.pagination.pageSize=e,this.getList()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.getList()},rowClick:function(e){this.openPopup=!0,this.$nextTick((function(){this.itemId={id:String(e.id)}}))},handleSelectionChange:function(e){e.length>0&&(this.operations[2].disabled=!1,this.operations[3].disabled=!1),this.multipleSelection=e}}},z=P,E=(a("c9e6"),Object(C["a"])(z,n,i,!1,null,null,null));t["default"]=E.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var n=a("1d80"),i=a("5899"),r="["+i+"]",o=RegExp("^"+r+r+"*"),s=RegExp(r+r+"*$"),l=function(e){return function(t){var a=String(n(t));return 1&e&&(a=a.replace(o,"")),2&e&&(a=a.replace(s,"")),a}};e.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(e,t,a){"use strict";var n=a("9678"),i=a.n(n);i.a},"6c7e":function(e,t,a){},7132:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},i=[],r={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},o=r,s=(a("5b8e"),a("2877")),l=Object(s["a"])(o,n,i,!1,null,null,null),c=l.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},u=[],d=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),g=d,p=(a("d4c2"),Object(s["a"])(g,m,u,!1,null,null,null)),f=p.exports;a.d(t,"a",(function(){return f}))},7741:function(e,t,a){},"81f1":function(e,t,a){},"923a":function(e,t,a){"use strict";var n=a("1a08"),i=a.n(n);i.a},9678:function(e,t,a){},a9e3:function(e,t,a){"use strict";var n=a("83ab"),i=a("da84"),r=a("94ca"),o=a("6eeb"),s=a("5135"),l=a("c6b6"),c=a("7156"),m=a("c04e"),u=a("d039"),d=a("7c73"),g=a("241c").f,p=a("06cf").f,f=a("9bf2").f,h=a("58a8").trim,b="Number",v=i[b],C=v.prototype,B=l(d(C))==b,y=function(e){var t,a,n,i,r,o,s,l,c=m(e,!1);if("string"==typeof c&&c.length>2)if(c=h(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(r=c.slice(2),o=r.length,s=0;s<o;s++)if(l=r.charCodeAt(s),l<48||l>i)return NaN;return parseInt(r,n)}return+c};if(r(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var w,$=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof $&&(B?u((function(){C.valueOf.call(a)})):l(a)!=b)?c(new v(y(t)),a,$):y(t)},M=n?g(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),D=0;M.length>D;D++)s(v,w=M[D])&&!s($,w)&&f($,w,p(v,w));$.prototype=C,C.constructor=$,o(i,b,$)}},c466:function(e,t,a){"use strict";a("99af"),a("d3b7"),a("ac1f"),a("25f0"),a("5319");t["a"]={nowDate:function(){var e=new Date,t=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()+1<10?"0"+e.getDate():e.getDate();return e.getFullYear().toString()+"-"+t+"-"+a},getMonthDays:function(e){var t=new Date(Date.parse(e.replace(/-/g,"/"))),a=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()+1,1),i=(n-a)/864e5;return i},halfYearAgo:function(e){var t="";return t=e?new Date(Date.parse(e.replace(/-/g,"/"))):new Date,console.log(t),t.setMonth(t.getMonth()-6),"".concat(t.getFullYear(),"-").concat(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getDate()<10?"0"+t.getDate():t.getDate())},lastMonthDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1<10?"0"+e.getMonth():e.getMonth(),n=e.getDate()+1<10?"0"+e.getDate():e.getDate();return"00"===a&&(a="12",t--),t.toString()+"-"+a+"-"+n},nextMonthDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),i=parseInt(a)+1;13===i&&(t=parseInt(t)+1,i=1);var r=new Date(t,i,0);return r=r.getDate(),n>r&&(n=r),i<10&&(i="0"+i),t+"-"+i+"-"+n},lastYearDate:function(){var e=new Date,t=new Date(e.getFullYear()-1,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastTwoYearDate:function(){var e=new Date,t=new Date(e.getFullYear()+2,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastNYearDate:function(e,t){var a=new Date(e),n=new Date(a.getFullYear()+parseInt(t),a.getMonth(),a.getDate());return n.getFullYear()+"-"+this.convertToFullMode(n.getMonth()+1)+"-"+this.convertToFullMode(n.getDate())},dateConverter:function(e){return e instanceof Date?e.getFullYear()+"-"+this.convertToFullMode(e.getMonth()+1)+"-"+this.convertToFullMode(e.getDate()):e},timeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes())+":"+this.convertToFullMode(e.getSeconds()):e},shortTimeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes()):e},dateTimeConverter:function(e){return e instanceof Date?this.dateConverter(e)+" "+this.timeConverter(e):e},convertToFullMode:function(e){return e=e.toString(),1===e.length?"0"+e:e}}},c9e6:function(e,t,a){"use strict";var n=a("6c7e"),i=a.n(n);i.a},d4c2:function(e,t,a){"use strict";var n=a("e725"),i=a.n(n);i.a},e725:function(e,t,a){}}]);