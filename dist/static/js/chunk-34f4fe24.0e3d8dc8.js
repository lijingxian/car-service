(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34f4fe24"],{"066a":function(e,t,a){"use strict";var o=a("8e86"),n=a.n(o);n.a},"07e7":function(e,t,a){},"0943":function(e,t,a){"use strict";var o=a("1fac"),n=a.n(o);n.a},"0e97":function(e,t,a){},"11e9":function(e,t,a){"use strict";var o=a("2497"),n=a("bc3a"),r=a.n(n),i=a("c596");t["a"]={getCommodityList:function(e,t,a){r.a.get(i["g"].commodity.getCommodityList,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){r.a.delete(i["g"].commodity.delete,{data:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},query:function(e,t,a){r.a.get(i["g"].commodity.query,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},soldoutAndPutaway:function(e,t,a){r.a.post(i["g"].commodity.soldoutAndPutaway,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},cloneProduct:function(e,t,a){r.a.post(i["g"].commodity.cloneProduct,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryPlatformCategoryTree:function(e,t,a){r.a.get(i["g"].commodity.queryPlatformCategoryTree,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryPlatformImportInfo:function(e,t,a){r.a.get(i["g"].commodity.queryPlatformImportInfo,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},importPlatformProduct:function(e,t,a){r.a.post(i["g"].commodity.importPlatformProduct,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},audit:function(e,t,a){r.a.post(i["g"].commodity.audit,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},auditTarget:function(e,t,a){r.a.post(i["g"].commodity.auditTarget,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},recallProduct:function(e,t,a){r.a.get(i["g"].commodity.recallProduct,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryFilters:function(e,t,a){r.a.get(i["g"].commodity.queryFilters,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))}}},"1fac":function(e,t,a){},2497:function(e,t,a){"use strict";var o=a("4360"),n=a("a18c");t["a"]=function(e,t){return function(a){var r=a.data;"100"===r.resultCode?e(r):"709"===r.resultCode?(o["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",o["a"].getters.currentUser),n["a"].push("/login")):t(r)}}},"40dd":function(e,t,a){"use strict";var o=a("9e1d"),n=a.n(o);n.a},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var o=a("1d80"),n=a("5899"),r="["+n+"]",i=RegExp("^"+r+r+"*"),s=RegExp(r+r+"*$"),l=function(e){return function(t){var a=String(o(t));return 1&e&&(a=a.replace(i,"")),2&e&&(a=a.replace(s,"")),a}};e.exports={start:l(1),end:l(2),trim:l(3)}},"5b54":function(e,t,a){"use strict";var o=a("2497"),n=a("bc3a"),r=a.n(n),i=a("c596");t["a"]={query:function(e,t,a){r.a.get(i["g"].activityMgmt.PromotionContent_query,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},update:function(e,t,a){r.a.put(i["g"].activityMgmt.PromotionContent_query,e).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryGiftList:function(e,t,a){r.a.get(i["g"].activityMgmt.PromotionContent_queryGift,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductList:function(e,t,a){r.a.get(i["g"].activityMgmt.PromotionContent_queryProduct,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))},queryBaseInfo:function(e,t,a){r.a.get(i["g"].activityMgmt.PromotionBaseInfo_query,{params:e}).then(Object(o["a"])(t,a)).catch((function(e){console.error(e)}))}}},"697f":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),a("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?a("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},n=[],r=(a("99af"),a("4160"),a("c975"),a("a434"),a("a9e3"),a("159b"),a("04d3")),i={name:"BizDialogSelector",components:{BizFlexTable:r["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var a=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(a,1),this.innerSelection.splice(a,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a>=0&&t.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},s=i,l=(a("0943"),a("2877")),c=Object(l["a"])(s,o,n,!1,null,null,null);t["a"]=c.exports},"81d5":function(e,t,a){"use strict";var o=a("7b0b"),n=a("23cb"),r=a("50c4");e.exports=function(e){var t=o(this),a=r(t.length),i=arguments.length,s=n(i>1?arguments[1]:void 0,a),l=i>2?arguments[2]:void 0,c=void 0===l?a:n(l,a);while(c>s)t[s++]=e;return t}},"8e86":function(e,t,a){},"9e1d":function(e,t,a){},a2b5:function(e,t,a){"use strict";var o=a("07e7"),n=a.n(o);n.a},a9e3:function(e,t,a){"use strict";var o=a("83ab"),n=a("da84"),r=a("94ca"),i=a("6eeb"),s=a("5135"),l=a("c6b6"),c=a("7156"),d=a("c04e"),u=a("d039"),p=a("7c73"),h=a("241c").f,f=a("06cf").f,m=a("9bf2").f,g=a("58a8").trim,b="Number",y=n[b],v=y.prototype,S=l(p(v))==b,w=function(e){var t,a,o,n,r,i,s,l,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:o=2,n=49;break;case 79:case 111:o=8,n=55;break;default:return+c}for(r=c.slice(2),i=r.length,s=0;s<i;s++)if(l=r.charCodeAt(s),l<48||l>n)return NaN;return parseInt(r,o)}return+c};if(r(b,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var C,I=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof I&&(S?u((function(){v.valueOf.call(a)})):l(a)!=b)?c(new y(w(t)),a,I):w(t)},M=o?h(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),P=0;M.length>P;P++)s(y,C=M[P])&&!s(I,C)&&m(I,C,f(y,C));I.prototype=v,v.constructor=I,i(n,b,I)}},af3f:function(e,t,a){"use strict";var o=a("697f");t["a"]=o["a"]},b834:function(e,t,a){},baa5:function(e,t,a){var o=a("23e7"),n=a("e58c");o({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},bd21:function(e,t,a){},c27f:function(e,t,a){"use strict";var o=a("bd21"),n=a.n(o);n.a},c456:function(e,t,a){"use strict";var o=a("f7f1"),n=a.n(o);n.a},cb29:function(e,t,a){var o=a("23e7"),n=a("81d5"),r=a("44d2");o({target:"Array",proto:!0},{fill:n}),r("fill")},cea6:function(e,t,a){"use strict";var o=a("0e97"),n=a.n(o);n.a},e58c:function(e,t,a){"use strict";var o=a("fc6a"),n=a("a691"),r=a("50c4"),i=a("a640"),s=a("ae40"),l=Math.min,c=[].lastIndexOf,d=!!c&&1/[1].lastIndexOf(1,-0)<0,u=i("lastIndexOf"),p=s("indexOf",{ACCESSORS:!0,1:0}),h=d||!u||!p;e.exports=h?function(e){if(d)return c.apply(this,arguments)||0;var t=o(this),a=r(t.length),i=a-1;for(arguments.length>1&&(i=l(i,n(arguments[1]))),i<0&&(i=a+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}:c},ec43:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"agent-mgmt"},[a("biz-header",{attrs:{slot:"top",operations:e.operations,filters:e.filters},on:{operate:e.handleOperate,"filter-data-change":e.handleFilterDataChange},slot:"top"},[a("template",{slot:"operation"},[a("import-file",{ref:"importFile",staticStyle:{"margin-left":"10px"},attrs:{tableData:e.importResult,importLoading:e.importLoading,total:e.total,disabled:e.disabled,count:e.count,percentage:e.percentage,stepkey:e.stepkey,action:"/admin/cooperationInfo/importAgent.jhtml",name:"uFile"},on:{clearTimeOut:e.clearTimeOut,restProcess:e.restProcess,"handle-import":e.handleImport}},[a("el-table-column",{attrs:{label:"编号",width:"50",prop:"line"}}),a("el-table-column",{attrs:{label:"结果",prop:"result"}})],1)],1)],2),a("expand-table",{ref:"expandTable",staticStyle:{height:"95%","min-height":"95%"},attrs:{data:e.tableData,loading:e.loading,isSearch:e.isSearch},on:{"expand-change":e.expandChange,delete:e.handleDeleteClick,"row-click":e.handleRowClick,handleAdmin:e.handleAdmin,handleAgent:e.handleAgent}}),a("biz-pagination",{attrs:{pagination:e.pagination}}),a("div",{attrs:{slot:"float"},slot:"float"},[a("biz-popup-tabs",{attrs:{open:e.open},on:{close:function(t){e.open=!1}},model:{value:e.tabSection,callback:function(t){e.tabSection=t},expression:"tabSection"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"baseinfo"}},[a("agent-base-info",{attrs:{itemId:e.itemId,parentId:e.parentId,parentName:e.parentName,grade:e.grade},on:{operationSuccess:e.handleOperationSuccess}})],1),e.itemId.id?a("el-tab-pane",{attrs:{label:"代理商品",name:"productinfo"}},[a("agent-product-info",{ref:"agnetProduct",attrs:{itemId:e.itemId,grade:e.grade},on:{operationSuccess:e.handleOperationSuccess}})],1):e._e()],1),a("biz-popup-tabs",{attrs:{open:e.openPlatform},on:{close:function(t){e.openPlatform=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:"选择平台门店",name:"1"}},[a("agent-platform-info",{ref:"platform",attrs:{itemId:e.itemId},on:{operationSuccess:e.handleOperationSuccess}})],1),a("el-tab-pane",{attrs:{label:"添加非平台门店",name:"2"}},[a("agent-unplatform-info",{ref:"unplatform",attrs:{itemId:e.itemId},on:{operationSuccess:e.handleOperationSuccess}})],1)],1)],1)],1)},n=[],r=(a("4160"),a("b0c0"),a("a9e3"),a("d3b7"),a("159b"),a("5530")),i=a("b85c"),s=a("ccf0"),l=a("f36f"),c=a("04d3"),d=a("7132"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"agent-mgmt__base-info"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"上级代理商",prop:"parentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formModel.parentName,callback:function(t){e.$set(e.formModel,"parentName",t)},expression:"formModel.parentName"}})],1),a("el-form-item",{attrs:{label:"代理商级别",prop:"grade"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formModel.grade,callback:function(t){e.$set(e.formModel,"grade",t)},expression:"formModel.grade"}})],1),a("el-form-item",{attrs:{label:"门店名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入门店名称"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入地址"},model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1),a("el-form-item",{attrs:{label:"联系人",prop:"contact"}},[a("el-input",{attrs:{placeholder:"请输入联系人"},model:{value:e.formModel.contact,callback:function(t){e.$set(e.formModel,"contact",t)},expression:"formModel.contact"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.formModel.phone,callback:function(t){e.$set(e.formModel,"phone",t)},expression:"formModel.phone"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.formModel.email,callback:function(t){e.$set(e.formModel,"email",t)},expression:"formModel.email"}})],1),a("el-form-item",{attrs:{label:"启用",prop:"state"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#ff7300","inactive-color":"#d9d9d9"},model:{value:e.formModel.state,callback:function(t){e.$set(e.formModel,"state",t)},expression:"formModel.state"}})],1)],1)],1)},p=[],h=a("8330"),f=a("c596"),m=a("1ab1"),g=a("2f62"),b={operations:[{label:"保存",name:"save",type:"primary",auth:["admin:agent.edit"]}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}},y=function(){return{parentId:"",parentName:"",grade:"",name:"",shopId:"",address:"",contact:"",phone:"",email:"",state:"1",remark:"",sourceShopId:""}},v={data:{loading:!1,formModel:y()},events:{handleOperate:function(e){this[e]()}},methods:{initModel:function(e){e?(e.parentName=this.parentName,this.formModel=Object.assign(this.getDefaultModel(),e),"0"===e.grade?this.formModel.grade="一级":"1"===e.grade?this.formModel.grade="二级":this.formModel.grade="三级"):(this.resetModel(),this.formModel.parentId=this.parentId,this.formModel.parentName=this.parentName,this.formModel.grade=String(Number(this.grade)+1),"0"===this.formModel.grade?this.formModel.grade="一级":"1"===this.formModel.grade?this.formModel.grade="二级":this.formModel.grade="三级"),this.$refs.form.resetFields()},query:function(){var e=this;this.loading=!0,m["a"].get(f["g"].invoicing.supplierMgmt.shopSupplier,{shopId:window.top.SHOP_ID||"",id:this.itemId.id,cooperationType:"1"}).then((function(t){e.initModel(t.data)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return y()},getSaveParams:function(){return{id:this.formModel.id,parentId:this.parentId,grade:this.grade,name:this.formModel.name,address:this.formModel.address,phone:this.formModel.phone,contact:this.formModel.contact,email:this.formModel.email,state:this.formModel.state,remark:this.formModel.remark,shopId:window.top.SHOP_ID||"",cooperationType:"1",sourceShopId:this.formModel.sourceShopId}},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0;var o=function(t){e.$message.success("保存成功"),e.formModel.id||(e.formModel.id=t.id),e.$emit("operationSuccess",e.formModel.id)},n=function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)},r=function(t){e.loading=!1};e.formModel.id?m["a"].put(f["g"].invoicing.supplierMgmt.shopSupplier,e.getSaveParams()).then(o).catch(n).finally(r):m["a"].post(f["g"].invoicing.supplierMgmt.shopSupplier,e.getSaveParams()).then(o).catch(n).finally(r)}))}}},S={name:"AgentBaseInfo",components:{BizSaveButton:h["a"],BizGrid:l["a"]},data:function(){return Object(r["a"])(Object(r["a"])(Object(r["a"])({},b),v.data),{},{rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],phone:[{required:!0,message:"电话不能少于5位,不能大于11位",trigger:"blur",min:5,max:11},{pattern:/^[-0-9]*$/,message:"请输入数字",trigger:"blur"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}},parentId:{type:String,default:function(){return""}},parentName:{type:String},grade:{type:String}},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(g["c"])(["getUser"])),v.methods),v.events),watch:{itemId:function(e,t){e.id?this.query():this.initModel()}},created:function(){}},w=S,C=(a("c27f"),a("2877")),I=Object(C["a"])(w,u,p,!1,null,null,null),M=I.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"agent-product-info"},[a("biz-grid",[a("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,loading:e.loading,pagination:e.pagination},on:{operate:e.operatePw,"size-change":e.handlePageSizeChange,"current-change":e.handleCurrentPageChange,"filter-data-change":e.handleFilterDataChange,"selection-change":e.handleSelectionChange,"active-item-change":e.activeItemChange,"cascader-change":e.cascaderChange}},[a("el-table-column",{attrs:{label:"商品名称",prop:"fullName","min-width":"130"}}),a("el-table-column",{attrs:{prop:"barCode",label:"条码"}}),a("el-table-column",{attrs:{prop:"categoryName",label:"分类","min-width":"80"}}),a("el-table-column",{attrs:{prop:"brandName",label:"品牌"}}),a("el-table-column",{attrs:{prop:"supplier.name",label:"供应商"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.supplier?t.row.supplier.name:""))]}}])}),a("el-table-column",{attrs:{prop:"grade",label:"价格等级",formatter:e.getGrade}}),a("el-table-column",{attrs:{prop:"tag",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.rowClick(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.deleteLine(t.row)}}},[e._v("删除")])],1)]}}])})],1),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showProductAgentWay,center:"","append-to-body":"","custom-class":"product-dialog"},on:{"update:visible":function(t){e.showProductAgentWay=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[a("el-form-item",{attrs:{label:"商品价格等级",prop:"grade"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.grade,callback:function(t){e.$set(e.form,"grade",t)},expression:"form.grade"}},[e._v("一级")]),a("el-radio",{attrs:{label:"1"},model:{value:e.form.grade,callback:function(t){e.$set(e.form,"grade",t)},expression:"form.grade"}},[e._v("二级")]),a("el-radio",{attrs:{label:"2"},model:{value:e.form.grade,callback:function(t){e.$set(e.form,"grade",t)},expression:"form.grade"}},[e._v("三级")])],1),a("el-form-item",{attrs:{label:"代理商品范围",prop:"productAgentWay",error:e.errAdmit}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.productAgentWay,callback:function(t){e.$set(e.form,"productAgentWay",t)},expression:"form.productAgentWay"}},[e._v("全部")]),a("el-radio",{attrs:{label:"2"},model:{value:e.form.productAgentWay,callback:function(t){e.$set(e.form,"productAgentWay",t)},expression:"form.productAgentWay"}},[e._v("按品牌")]),a("el-radio",{attrs:{label:"1"},model:{value:e.form.productAgentWay,callback:function(t){e.$set(e.form,"productAgentWay",t)},expression:"form.productAgentWay"}},[e._v("按分类")]),a("el-radio",{attrs:{label:"4"},model:{value:e.form.productAgentWay,callback:function(t){e.$set(e.form,"productAgentWay",t)},expression:"form.productAgentWay"}},[e._v("按供应商")]),a("el-radio",{attrs:{label:"3"},model:{value:e.form.productAgentWay,callback:function(t){e.$set(e.form,"productAgentWay",t)},expression:"form.productAgentWay"}},[e._v("按商品")]),a("product-agent-way",{attrs:{productAgentWay:e.form.productAgentWay,baseInfo:e.baseInfo},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)],1),a("biz-save-button",{attrs:{operations:e.operationsPw},on:{operate:e.operatePw}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"}],attrs:{slot:"bottom"},slot:"bottom"},[a("el-form",{ref:"formModel",attrs:{model:e.formModel,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"productAgentWay"}},[a("el-input",{attrs:{type:"text",disabled:""},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"商品价格等级",prop:"grade"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.formModel.grade,callback:function(t){e.$set(e.formModel,"grade",t)},expression:"formModel.grade"}},[e._v("一级")]),a("el-radio",{attrs:{label:"1"},model:{value:e.formModel.grade,callback:function(t){e.$set(e.formModel,"grade",t)},expression:"formModel.grade"}},[e._v("二级")]),a("el-radio",{attrs:{label:"2"},model:{value:e.formModel.grade,callback:function(t){e.$set(e.formModel,"grade",t)},expression:"formModel.grade"}},[e._v("三级")])],1)],1),a("biz-save-button",{attrs:{operations:e.operationsEdit},on:{operate:e.operatePw}})],1)],1)],1)},k=[],x=(a("99af"),a("d81d"),a("a434"),a("25f0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"agent-participation-way"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"4"===e.productAgentWay,expression:"productAgentWay === '4'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:e.addSuppliers}},[e._v("添加")]),a("el-table",{ref:"supplierTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.supplierTableData,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name",label:"供应商"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delSupplier(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"Product"===e.productAgentWay||"3"===e.productAgentWay,expression:"productAgentWay === 'Product'||productAgentWay === '3'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:e.addProducts}},[e._v("添加")]),a("el-table",{ref:"productTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.products,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"fullName",label:"商品"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delProduct(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"ShopBrand"===e.productAgentWay||"2"===e.productAgentWay,expression:"productAgentWay === 'ShopBrand'||productAgentWay === '2'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:e.addBrands}},[e._v("添加")]),a("el-table",{ref:"brandTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.shopBrands,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name",label:"品牌"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delBrand(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"ProductCategory"===e.productAgentWay||"1"===e.productAgentWay,expression:"productAgentWay === 'ProductCategory'||productAgentWay === '1'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showClassSelector=!e.showClassSelector}}},[e._v("添加")]),a("el-table",{ref:"cateTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.productCategories,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark","row-key":"id"}},[a("el-table-column",{attrs:{prop:"name",label:"分类"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delClass(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("biz-dialog-selector",{attrs:{title:"选择商品",visibility:e.showProductSelector,tableData:e.productTableData,pagination:e.productPagination,filters:e.productFilters,selectionKeys:e.selectedProducts,max:5},on:{"update:visibility":function(t){e.showProductSelector=t},pageSizeChange:e.productPageSizeChange,currentPageChange:e.productCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.productFilterDataChange,"active-item-change":e.activeItemChange,cascaderChange:e.cascaderChange}},[a("el-table-column",{attrs:{property:"sn",label:"编号"}}),a("el-table-column",{attrs:{property:"name",label:"名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"dialog-column"},[a("img",{staticClass:"productImg",attrs:{src:t.row.image||e.DefaultImg}}),a("div",[e._v(e._s(t.row.fullName))])])]}}])}),a("el-table-column",{attrs:{property:"barCode",label:"条码"}}),a("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),a("el-table-column",{attrs:{property:"brandName",label:"品牌"}}),a("el-table-column",{attrs:{property:"supplier.name",label:"供应商"}})],1),a("el-dialog",{staticClass:"agent-dialog-checkbox",attrs:{title:"选择供应商",visible:e.showSupplierSelector,"append-to-body":""},on:{"update:visible":function(t){e.showSupplierSelector=t}}},[a("div",{staticClass:"dialog-top"},[a("el-input",{attrs:{size:"small",placeholder:"请输入供应商"},model:{value:e.supplierSearchValue,callback:function(t){e.supplierSearchValue=t},expression:"supplierSearchValue"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.supplierSearch},slot:"append"})],1)],1),a("el-checkbox-group",{model:{value:e.supplierArr,callback:function(t){e.supplierArr=t},expression:"supplierArr"}},e._l(e.supplierList,(function(t){return a("el-checkbox",{key:t.index,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showSupplierSelector=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmSuppliers}},[e._v("确 定")])],1)],1),a("el-dialog",{staticClass:"agent-dialog-checkbox",attrs:{title:"选择品牌",visible:e.showBrandSelector,"append-to-body":""},on:{"update:visible":function(t){e.showBrandSelector=t}}},[a("div",{staticClass:"dialog-top"},[a("el-input",{attrs:{size:"small",placeholder:"请输入品牌"},model:{value:e.brandSearchValue,callback:function(t){e.brandSearchValue=t},expression:"brandSearchValue"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.brandSearch},slot:"append"})],1)],1),a("el-checkbox-group",{model:{value:e.brandArr,callback:function(t){e.brandArr=t},expression:"brandArr"}},e._l(e.brandList,(function(t){return a("el-checkbox",{key:t.index,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showBrandSelector=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmBrands}},[e._v("确 定")])],1)],1),a("el-dialog",{staticClass:"agent-dialog-checkbox",attrs:{title:"选择分类",visible:e.showClassSelector,"append-to-body":""},on:{"update:visible":function(t){e.showClassSelector=t}}},[a("el-tree",{ref:"tree",attrs:{props:e.defaultProps,"node-key":"id","highlight-current":e.highlightCurrent,data:e.dataTree,"show-checkbox":""},on:{"check-change":e.handleCheckChange}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showClassSelector=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmClasses}},[e._v("确 定")])],1)],1)],1)}),A=[],_=(a("4de4"),a("caad"),a("c975"),a("2532"),a("af3f")),$={queryBrandList:"/admin/shopBrand/brandSeries.jhtml",queryCategoryList:"/admin/json/ShopProduct_category/list.jhtml",querySupplierList:"/admin/cooperationInfo/cooperationInfos.jhtml"},O=a("11e9"),B=a("f3ac"),N=a.n(B),z={name:"ProductAgentWay",props:{value:{type:Array,default:function(){return[]}},productAgentWay:{type:String,default:function(){return""}},baseInfo:{type:Object,default:function(){return{shop:{name:""}}}}},data:function(){return{highlightCurrent:!0,defaultProps:{children:"children",label:"label"},dataTree:[],categoryDatas:[],productCategoryId:"",DefaultImg:N.a,brandList:[],brandSearchValue:"",supplierList:[],supplierSearchValue:"",products:[],shopBrands:[],supplierTableData:[],productCategories:[],showProductSelector:!1,showBrandSelector:!1,showSupplierSelector:!1,showClassSelector:!1,brandArr:[],supplierArr:[],classList:[],classArr:[],productTableData:[],selectedProducts:[],productPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},productFilters:[{type:"cascader",label:"分类",name:"category",filterable:!1,value:[],options:[]},{type:"select",label:"品牌",name:"brand",value:"",options:[]},{type:"select",label:"供应商",name:"supplier",value:"",options:[]},{type:"input",placeholder:"请输入编号/商品名/条码",name:"searchbar",value:""}]}},components:{BizDialogSelector:_["a"]},methods:Object(r["a"])(Object(r["a"])({},Object(g["c"])(["getUser"])),{},{loadNode:function(){var e=this;m["a"].get("/admin/json/ShopProduct_category/list.jhtml",{pageNumber:1,pageSize:1e3}).then((function(t){e.dataTree=[],t.ProductCategoryManage.map((function(t){e.dataTree.push({label:t.name,id:t.id,children:t.childrenProductCategoryDataList.map((function(e){return{label:e.name,id:e.id}}))})})),e.$refs.tree.setCheckedKeys(e.value.map((function(e){return e.id}))),console.log(e.dataTree)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},handleCheckChange:function(e,t,a){var o=this;console.log(e,t,a),console.log(this.$refs.tree.getCheckedNodes()),this.$nextTick((function(){o.classArr=o.$refs.tree.getCheckedNodes().map((function(e){return e.id}))}))},productPageSizeChange:function(e){this.productPagination.pageSize=e,this.getProductTable()},productCurrentPageChange:function(e){this.productPagination.currentPage=e,this.getProductTable()},confirmedProduct:function(e){var t=this,a={ids:e};m["a"].post(f["a"].PromotionContent_queryProductByIds,a).then((function(e){t.products=e.content.filter((function(e){return e})),t.selectedProducts=t.products.map((function(e){return e.id})),t.handleInput(t.products)})).catch((function(e){console.log("ERR_GET_PRODUCT_BY_IDS: ",e)}))},productFilterDataChange:function(e){this.productPagination.currentPage=1,this.productFilters=e,this.getProductTable()},delProduct:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.products.length;a++)t.products[a].id===e&&(t.products.splice(a,1),t.handleInput(t.products));t.selectedProducts=[],t.products.map((function(e){t.selectedProducts.push(e.id)}))})).catch((function(){}))},delBrand:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.shopBrands.length;a++)t.shopBrands[a].id===e&&(t.shopBrands.splice(a,1),t.handleInput(t.shopBrands),t.brandSearchValue="");t.brandArr=[],t.shopBrands.map((function(e){t.brandArr.push(e.id)}))})).catch((function(){}))},delSupplier:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.supplierTableData.length;a++)t.supplierTableData[a].id===e&&(t.supplierTableData.splice(a,1),t.handleInput(t.supplierTableData),t.supplierSearchValue="");t.supplierArr=[],t.supplierTableData.map((function(e){t.supplierArr.push(e.id)}))})).catch((function(){}))},delClass:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.productCategories.length;a++)t.productCategories[a].id===e&&(t.productCategories.splice(a,1),t.handleInput(t.productCategories));t.classArr=[],t.productCategories.map((function(e){t.classArr.push(e.id)}))})).catch((function(){}))},brandSearch:function(){this.getBrandList()},supplierSearch:function(){this.getSupplierList()},confirmBrands:function(){var e=this;this.showBrandSelector=!1;var t={searchProperty:"name",searchValue:"",pageNumber:1,pageSize:1e3};m["a"].get($.queryBrandList,t).then((function(t){e.brandList=t.Brand,e.shopBrands=e.brandList.filter((function(t){return e.brandArr.includes(t.id)})),e.handleInput(e.shopBrands)})).catch()},confirmSuppliers:function(){var e=this;this.showSupplierSelector=!1;var t={cooperationType:"0",searchValue:"",pageNumber:1,pageSize:1e3};m["a"].get($.querySupplierList,t).then((function(t){e.supplierList=t.dataList,e.supplierTableData=e.supplierList.filter((function(t){return e.supplierArr.includes(t.id)})),e.handleInput(e.supplierTableData)})).catch()},confirmClasses:function(){var e=this;this.showClassSelector=!1,this.productCategories=[],this.$refs.tree.getCheckedNodes().map((function(t){-1!==e.classArr.indexOf(t.id)&&e.productCategories.push({id:t.id,name:t.label})})),this.handleInput(this.productCategories)},getProductTable:function(){var e=this,t={productType:"normal",pageSize:this.productPagination.pageSize,pageNumber:this.productPagination.currentPage,searchValue:this.productFilters[3].value,brandId:this.getSelectedBrandId(),supplierId:this.productFilters[2].value,productCategoryId:this.productCategoryId};m["a"].get("admin/invoicingProduct/stockCenterProducts.jhtml",t).then((function(t){e.productPagination.total=Number(t.total),e.productTableData=t.dataList})).catch()},addProducts:function(){var e=this;this.selectedProducts=[],this.value.map((function(t){e.selectedProducts.push(t.id)})),this.queryFilters(),this.querySupplierList(),this.showProductSelector=!0},addBrands:function(){this.showBrandSelector=!this.showBrandSelector,this.getBrandList()},addSuppliers:function(){this.showSupplierSelector=!this.showSupplierSelector,this.getSupplierList()},getBrandList:function(){var e=this,t={searchProperty:"name",searchValue:this.brandSearchValue,pageNumber:1,pageSize:1e3};m["a"].get($.queryBrandList,t).then((function(t){e.brandList=t.Brand})).catch()},getSupplierList:function(){var e=this,t={cooperationType:"0",pageNumber:1,pageSize:1e3,searchValue:this.supplierSearchValue};m["a"].get($.querySupplierList,t).then((function(t){e.supplierList=t.dataList})).catch()},queryFilters:function(){var e=this,t={shopId:window.top.SHOP_ID||""};O["a"].queryFilters(t,(function(t){e.categoryDatas=t.categoryDatas,e.setCategoryFilters(),e.setBrandFilters()}),(function(a){""!==a.errorMessage&&e.$message.error(a.errorMessage),console.log("获取过滤器失败",t)}))},querySupplierList:function(){var e=this,t={shopId:window.top.SHOP_ID||"",cooperationType:"0",state:""};m["a"].get(f["g"].invoicing.supplierMgmt.shopSupplierList,t).then((function(t){e.productFilters[2].options=[{label:"全部",value:""}].concat(t.dataList.map((function(e){return{label:e.name,value:e.id}})))})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},cascaderChange:function(e){this.productCategoryId=e[e.length-1],e.length>1&&""===this.productCategoryId&&(this.productCategoryId=e[e.length-2]),this.getProductTable()},activeItemChange:function(e){var t=this,a={shopId:this.getUser().shop.id,parentId:e.toString()};m["a"].get("/admin/shopProduct/productCategorys.jhtml",a).then((function(a){var o;t.setCategoryFilters(),t.productFilters[0].options.forEach((function(t){t.value===e[0]&&(o=t.children)})),a.dateList.forEach((function(e){o.push({value:e.id,label:e.name})}))})).catch((function(){}))},setCategoryFilters:function(){var e=[{value:"",label:"全部"}];this.categoryDatas.forEach((function(t){e.push({value:t.id,label:t.name,children:[{label:"全部",value:""}]})})),this.productFilters[0].options=e},setBrandFilters:function(){var e=this,t={searchProperty:"name",searchValue:"",pageNumber:1,pageSize:1e3};m["a"].get($.queryBrandList,t).then((function(t){e.productFilters[1].options=t.Brand.map((function(e){return{value:e.id,label:e.name}})),e.productFilters[1].options.splice(0,0,{value:"",label:"全部"})})).catch()},getSelectedBrandId:function(){return this.productFilters[1].value},handleInput:function(e){this.$emit("input",e)}}),watch:{value:{handler:function(e,t){switch(this.productAgentWay){case"Store":case"0":this.products=[],this.shopBrands=[],this.supplierTableData=[],this.productCategories=[];break;case"4":this.supplierTableData=e,this.shopBrands=[],this.products=[],this.productCategories=[];break;case"Product":case"3":this.products=e,this.shopBrands=[],this.supplierTableData=[],this.productCategories=[];break;case"ShopBrand":case"2":this.products=[],this.shopBrands=e,this.productCategories=[],this.supplierTableData=[];break;case"ProductCategory":case"1":this.products=[],this.shopBrands=[],this.supplierTableData=[],this.productCategories=e;break;default:break}},deep:!0},showProductSelector:function(e,t){e&&(this.productPagination.currentPage=1,this.getProductTable())},showClassSelector:function(e,t){e&&this.loadNode()},showBrandSelector:function(e,t){e&&"2"===this.productAgentWay&&(this.brandArr=this.value.map((function(e){return e.id})))},showSupplierSelector:function(e,t){e&&"4"===this.productAgentWay&&(this.supplierArr=this.value.map((function(e){return e.id})))}},mounted:function(){}},T=z,D=(a("066a"),Object(C["a"])(T,x,A,!1,null,null,null)),j=D.exports,F=a("5b54"),L={name:"agentProductInfo",props:{itemId:{type:Object,default:function(){return{id:""}}},grade:{type:String,default:function(){return""}}},data:function(){return{errAdmit:"",selectedItems:[],tableData:[],selections:[],categoryDatas:[],showForm:!1,rules:{productAgentWay:[{required:!0,message:"请选择代理商品范围",trigger:"blur"}]},form:this.setOriginFormData(),baseInfo:{shop:{name:""}},formModel:{name:"",grade:"0"},loading:!1,showProductAgentWay:!1,productCategoryId:"",operations:[{label:"选择商品",name:"selectProduct",type:"primary"},{label:"删除",name:"delete",type:"",disabled:!0}],operationsPw:[{label:"保存",name:"save",type:"primary"}],operationsEdit:[{label:"保存",name:"saveEdit",type:"primary"},{label:"取消",name:"cancle",type:"primary"}],filters:[{type:"cascader",label:"分类",name:"category",filterable:!1,value:[],options:[]},{type:"select",label:"品牌",name:"brand",value:"",options:[]},{type:"select",label:"供应商",name:"supplier",value:"",options:[]},{type:"select",placeholder:"请选择价格等级",label:"价格等级",value:"",options:[{label:"全部",value:""},{label:"一级",value:"0"},{label:"二级",value:"1"},{label:"三级",value:"2"}]},{type:"input",label:"",placeholder:"请输入商品名称/条码",name:"searchValue",value:""}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},methods:Object(r["a"])(Object(r["a"])({},Object(g["c"])(["getUser"])),{},{handleOperate:function(e){this[e]()},operatePw:function(e){this[e]()},setOriginFormData:function(){return{productAgentWay:"",grade:"0"}},handleSelectionChange:function(e){this.operations[1].disabled=!0,this.selections=e,e.length>0&&(this.operations[1].disabled=!1)},clear:function(){this.form=this.setOriginFormData(),this.$refs.form.resetFields()},cancle:function(){this.showForm=!1},getGrade:function(e){switch(e.grade){case"0":return"一级";case"1":return"二级";case"2":return"三级";default:break}},queryFilters:function(){var e=this,t={shopId:window.top.SHOP_ID||""};O["a"].queryFilters(t,(function(t){e.categoryDatas=t.categoryDatas,e.setCategoryFilters(),e.setBrandFilters()}),(function(a){""!==a.errorMessage&&e.$message.error(a.errorMessage),console.log("获取过滤器失败",t)}))},querySupplierList:function(){var e=this;this.loading=!0;var t={shopId:window.top.SHOP_ID||"",cooperationType:"0",state:""};m["a"].get(f["g"].invoicing.supplierMgmt.shopSupplierList,t).then((function(t){e.filters[2].options=[{label:"全部",value:""}].concat(t.dataList.map((function(e){return{label:e.name,value:e.id}})))})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},cascaderChange:function(e){this.productCategoryId=e[e.length-1],e.length>1&&""===this.productCategoryId&&(this.productCategoryId=e[e.length-2]),this.refresh()},activeItemChange:function(e){var t=this,a={shopId:this.getUser().shop.id,parentId:e.toString()};m["a"].get("/admin/shopProduct/productCategorys.jhtml",a).then((function(a){var o;t.setCategoryFilters(),t.filters[0].options.forEach((function(t){t.value===e[0]&&(o=t.children)})),a.dateList.forEach((function(e){o.push({value:e.id,label:e.name})}))})).catch((function(){}))},setCategoryFilters:function(){var e=[{value:"",label:"全部"}];this.categoryDatas.forEach((function(t){e.push({value:t.id,label:t.name,children:[{label:"全部",value:""}]})})),this.filters[0].options=e},setBrandFilters:function(){var e=this,t={searchProperty:"name",searchValue:"",pageNumber:1,pageSize:1e3};m["a"].get($.queryBrandList,t).then((function(t){e.filters[1].options=t.Brand.map((function(e){return{value:e.id,label:e.name}})),e.filters[1].options.splice(0,0,{value:"",label:"全部"})})).catch()},getSelectedBrandId:function(){return this.filters[1].value},rowClick:function(e){console.log(e),this.showForm=!0,this.formModel.name=e.name,this.formModel.id=e.id,this.formModel.grade=e.grade},refresh:function(){var e=this,t={cooperationId:this.itemId.id,brandId:this.getSelectedBrandId(),supplierId:this.filters[2].value,productCategoryId:this.productCategoryId,grade:this.filters[3].value,searchValue:this.filters[4].value,pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage};m["a"].get("/admin/invoicingProduct/productCooperations.jhtml",t).then((function(t){e.tableData=t.data.products,e.pagination.total=Number(t.total)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},saveEdit:function(){var e=this,t={id:this.itemId.id,grade:this.formModel.grade,productAgentWay:"3",product:this.formModel.id};m["a"].put("/admin/invoicingProduct/productCooperation.jhtml",t).then((function(t){e.refresh(),e.$message.success("操作成功")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},deleteLine:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var a={id:t.itemId.id,productAgentWay:"3",products:[e.id]};m["a"].delete("/admin/invoicingProduct/productCooperation.jhtml",a).then((function(e){t.$message.success("删除成功"),t.refresh()})).catch((function(e){console.log(e),console.log("code错误"),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},delete:function(){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=[];e.selections.forEach((function(e){t.push(e.id)}));var a={id:e.itemId.id,productAgentWay:"3",products:t};m["a"].delete("/admin/invoicingProduct/productCooperation.jhtml",a).then((function(t){e.refresh(),e.$message.success("操作成功")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}))},selectProduct:function(){console.log(this.grade),this.form.grade=this.grade,this.selectedItems=[],this.form.productAgentWay="0",this.showProductAgentWay=!0},save:function(){var e=this;this.form.productAgentWay&&"0"!==this.form.productAgentWay&&this.selectedItems&&0===this.selectedItems.length?this.$message.warning("请选择代理商品范围"):(this.errAdmit="",this.$refs.form.validate((function(t){if(!t)return!1;e.update()})))},update:function(){var e=this;delete this.form.productCategories,delete this.form.products,delete this.form.shopBrands,delete this.form.suppliers,this.$set(this.form,"id",this.itemId.id);var t=Object.assign(this.form,this.getSelectedItems(this.form),{});m["a"].post("/admin/invoicingProduct/productCooperations.jhtml",t).then((function(t){e.$message.success({message:"操作成功"}),e.refresh(),e.showProductAgentWay=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},getBaseInfo:function(){var e=this;F["a"].queryBaseInfo({},(function(t){e.baseInfo=t}),(function(e){console.log("ERR_GET_BASE_INFO: ",e)}))},setSelectedItems:function(e){switch(e.productAgentWay){case"0":this.selectedItems=[];break;case"3":this.selectedItems=e.products||[];break;case"2":this.selectedItems=e.shopBrands;break;case"1":this.selectedItems=e.productCategories;break;default:this.selectedItems=[];break}},getSelectedItems:function(e){switch(e.productAgentWay){case"0":return{};case"4":return{suppliers:this.selectedItems};case"3":return{products:this.selectedItems};case"2":return{shopBrands:this.selectedItems};case"1":return{productCategories:this.selectedItems};default:return{}}},clearSearchValue:function(){this.filters[0].value="",this.filters[1].value="",this.filters[2].value=""},handleFilterDataChange:function(e){this.filters=e,this.pagination.currentPage=1,this.refresh()},handlePageSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentPageChange:function(e){this.pagination.currentPage=e,this.refresh()}}),mounted:function(){this.getBaseInfo(),this.querySupplierList(),this.itemId.id&&this.refresh(),this.queryFilters()},watch:{itemId:function(e,t){e.id&&(this.queryFilters(),this.querySupplierList(),this.refresh())}},components:{BizGrid:l["a"],BizFlexTable:c["c"],BizSaveButton:h["a"],productAgentWay:j}},q=L,W=(a("c456"),Object(C["a"])(q,P,k,!1,null,null,null)),E=W.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"agent-mgmt__platform-info"},[a("div",{attrs:{slot:"top"},slot:"top"},[a("biz-filter",{attrs:{filters:e.filters},on:{filterDataChange:e.filterDataChange}})],1),a("biz-list",{key:Math.random(),ref:"table",attrs:{tableData:e.tableData,height:"100%"}},[a("el-table-column",{attrs:{prop:"name",label:"门店名称","min-width":"100"}}),a("el-table-column",{attrs:{prop:"address",label:"地址","min-width":"100"}}),a("el-table-column",{attrs:{prop:"phone",label:"电话","min-width":"100"}}),a("el-table-column",{attrs:{prop:"date",label:"操作",type:"index","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("div",{staticClass:"biz-customcol"},["0"===t.row.opeateState?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.addHandeler(t.row)}}},[e._v("添加")]):e._e(),"1"===t.row.opeateState?a("el-button",{attrs:{type:"text",size:"mini",disabled:!0}},[e._v("已添加")]):e._e()],1)])}}])})],1),a("div",{attrs:{slot:"bottom"},slot:"bottom"},[a("biz-pagination",{attrs:{pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)],1)},K=[],R=a("7558"),H=a("5c40"),U=a("8c35"),G={name:"AgentPlatformInfo",components:{BizGrid:l["a"],BizList:R["a"],BizPagination:H["a"],BizFilter:U["a"]},data:function(){return{loading:!1,tableData:[],filters:[{type:"input",placeholder:"请输入门店名称",name:"searchbar",value:""}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},props:{},methods:Object(r["a"])(Object(r["a"])({},Object(g["c"])(["getUser"])),{},{filterDataChange:function(e){this.filters=e,this.getList()},clearSearchValue:function(){this.filters[0].value=""},getList:function(){var e=this;this.loading=!0;var t={cooperationType:"1",shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,searchValue:this.filters[0].value};m["a"].get(f["g"].invoicing.supplierMgmt.storesByName,t).then((function(t){e.loading=!1,e.tableData=t.dataList,e.pagination.total=Number(t.total)})).catch((function(t){e.loading=!1,t.errorMessage&&console.log(t.errorMessage)}))},addHandeler:function(e){var t=this;this.loading=!0;var a={sourceShopId:e.id,name:e.name,address:e.address,phone:e.phone,shopId:window.top.SHOP_ID||"",cooperationType:"1"};m["a"].post(f["g"].invoicing.supplierMgmt.shopSupplier,a).then((function(e){t.loading=!1,t.$message.success("添加成功"),t.getList(),t.$emit("operationSuccess",e.id)})).catch((function(e){t.loading=!1,t.$message({message:e.errorMessage,type:"warning"})})).finally((function(e){t.loading=!1}))},handleSizeChange:function(e){this.pagination.pageSize=e,this.getList()},handleCurrentChange:function(e){console.log(e),this.pagination.currentPage=e,this.getList()}}),watch:{},created:function(){}},Y=G,X=(a("40dd"),Object(C["a"])(Y,V,K,!1,null,null,null)),J=X.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"agent-mgmt__unplatform-info"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入地址"},model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1),a("el-form-item",{attrs:{label:"联系人",prop:"contact"}},[a("el-input",{attrs:{placeholder:"请输入联系人"},model:{value:e.formModel.contact,callback:function(t){e.$set(e.formModel,"contact",t)},expression:"formModel.contact"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.formModel.phone,callback:function(t){e.$set(e.formModel,"phone",t)},expression:"formModel.phone"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.formModel.email,callback:function(t){e.$set(e.formModel,"email",t)},expression:"formModel.email"}})],1),a("el-form-item",{attrs:{label:"启用",prop:"state"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#ff7300","inactive-color":"#d9d9d9"},model:{value:e.formModel.state,callback:function(t){e.$set(e.formModel,"state",t)},expression:"formModel.state"}})],1)],1)],1)},Z=[],ee={operations:[{label:"保存",name:"save",type:"primary"}]},te=function(){return{id:"",name:"",shopId:"",address:"",contact:"",phone:"",email:"",state:"1",remark:"",sourceShopId:""}},ae={data:{loading:!1,formModel:te()},events:{handleOperate:function(e){this[e]()}},methods:{getDefaultModel:function(){return te()},restForm:function(){this.formModel=this.getDefaultModel()},getSaveParams:function(){return{id:this.formModel.id,name:this.formModel.name,address:this.formModel.address,phone:this.formModel.phone,contact:this.formModel.contact,email:this.formModel.email,state:this.formModel.state,remark:this.formModel.remark,shopId:window.top.SHOP_ID||"",cooperationType:"1",sourceShopId:this.formModel.sourceShopId}},save:function(){var e=this;console.log(this.getSaveParams()),this.$refs.form.validate((function(t,a){if(!t)return!1;e.loading=!0;var o=function(t){e.$message.success("保存成功"),e.formModel.id||(e.formModel.id=t.id),e.$emit("operationSuccess",e.formModel.id)},n=function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)},r=function(t){e.loading=!1};e.formModel.id?m["a"].put(f["g"].invoicing.supplierMgmt.shopSupplier,e.getSaveParams()).then(o).catch(n).finally(r):m["a"].post(f["g"].invoicing.supplierMgmt.shopSupplier,e.getSaveParams()).then(o).catch(n).finally(r)}))}}},oe={name:"AgentBaseInfo",components:{BizSaveButton:h["a"],BizGrid:l["a"]},data:function(){return Object(r["a"])(Object(r["a"])(Object(r["a"])({},ee),ae.data),{},{rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],phone:[{required:!0,message:"电话不能少于5位",trigger:"blur",min:5},{pattern:/^[-0-9]*$/,message:"请输入数字",trigger:"blur"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}}},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(g["c"])(["getUser"])),ae.methods),ae.events),watch:{},created:function(){}},ne=oe,re=(a("cea6"),Object(C["a"])(ne,Q,Z,!1,null,null,null)),ie=re.exports,se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"expandTable",staticClass:"expand-table",staticStyle:{width:"100%","min-height":"100%"},attrs:{size:"small","tooltip-effect":"dark","row-key":"id",height:"auto",border:e.showBorder,data:e.data,"show-header":e.showHeader,rowClassName:e.setClassName,"cell-class-name":e.cellClassName,"expand-row-keys":e.expandedRowKeys},on:{"expand-change":e.expandChangeHandler,"row-click":e.rowClickHandler,handleAgent:e.handleAgent,handleAdmin:e.handleAdmin}},[e.isSearch?a("el-table-column",{attrs:{type:"expand",label:e.maxLevel,width:"100","class-name":"1"===e.hasChild?"cell"+e.layer:"cell0"+e.layer},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.children.length>0?a("expand-table",{staticClass:"expand-table-child",attrs:{height:"auto",hasChild:t.row.hasChild,layer:e.layer+1,data:t.row.children,"show-header":!1,"show-border":!1,"expand-row-keys":e.expandedRowKeys},on:{delete:e.handleDeleteClick,handleAgent:e.handleAgent,handleAdmin:e.handleAdmin,"expand-change":e.expandChangeHandler,"row-click":e.rowClickHandler}}):e._e()]}}],null,!1,3659357802)}):e._e(),a("el-table-column",{attrs:{label:"门店名称",prop:"name","class-name":"first-name"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),a("el-table-column",{attrs:{label:"地址",prop:"address"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(""!==t.row.address?t.row.address:"--"))]}}])}),a("el-table-column",{attrs:{label:"电话",prop:"phone"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(""!==t.row.phone?t.row.phone:"--"))]}}])}),a("el-table-column",{attrs:{prop:"tag",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"!==t.row.grade&&e.hasAuthAdd?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleAgent(a,t.row)}}},[e._v("添加代理商")]):e._e(),e.hasAuthAdmin?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleAdmin(a,t.row)}}},[e._v("管理员设置")]):e._e(),e.hasAuthDel?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDeleteClick(a,t.row)}}},[e._v("删除")]):e._e()]}}])})],1)},le=[],ce=(a("cb29"),a("a15b"),a("ac1f"),a("1276"),{name:"ExpandTable",filters:{},props:{showHeader:{type:Boolean,default:!0},isSearch:{type:Boolean,default:!0},hasChild:{type:String,default:"1"},data:{type:Array,default:function(){return[]}},height:{type:String,default:"100%"},loading:{type:Boolean,default:!1},showBorder:{type:Boolean,default:!0},layer:{type:Number,default:0},expandedRowKeys:{type:Array,default:function(){return[]}}},data:function(){return{maxLevel:"1",currentLevel:1,className:""}},components:{},computed:Object(r["a"])(Object(r["a"])({},Object(g["c"])("Authority",["currentAuth"])),{},{hasAuthAdmin:function(){return this.currentAuth.includes("admin:agent.usermanage")},hasAuthDel:function(){return this.currentAuth.includes("admin:agent.delete")},hasAuthAdd:function(){return this.currentAuth.includes("admin:agent.add")}}),watch:{},mounted:function(){var e=document.documentElement.clientHeight||window.innerHeight,t=String(e-205);document.querySelectorAll(".el-table__body-wrapper")[0].style.height=t+"px",document.querySelectorAll(".el-table__body-wrapper")[0].style.overflowX="hidden",document.querySelectorAll(".el-table__body-wrapper")[0].style.overflowY="auto"},updated:function(){this.doLayout()},methods:{setClassName:function(e){var t=e.row;e.index;return t.hasChild>0?"expand":"noexpand"},cellClassName:function(e){var t=e.row;e.column,e.rowIndex,e.columnIndex;return"row"+t.id},doLayout:function(){document.querySelectorAll(".expand-table-child .el-table__body-wrapper").forEach((function(e){e.style.height="auto"})),document.querySelectorAll(".el-table__expand-icon").forEach((function(e){e.children[0].className="iconfont biz-icon-i-web-zk1"}))},formatTreeLayer:function(e,t){var a=[];return t&&(a.push(new Array(t).fill("|").join(" ")),a.push("--")),a.push(e),a.join("")},expandChangeHandler:function(e,t){this.doLayout(),this.className&&this.className.split(".")[1]!=="row"+e.id&&(document.querySelector(this.className).children[0].children[0].style.color="#666666"),this.className=".row"+e.id,document.querySelector(this.className).children[0].children[0].style.color="#ff7300";var a=[];console.log("this.currentLevel"+this.currentLevel),console.log("row.grade"+this.currentLevel),t&&t.length>0?this.currentLevel=Number(e.grade)+1:this.currentLevel=Number(e.grade);for(var o=0;o<=this.currentLevel;o++)a.push(o+1);this.maxLevel=a.join(" "),console.log(this.$refs.expandTable),this.$emit("expand-change",e,t)},rowClickHandler:function(e){this.$emit("row-click",e)},handleDeleteClick:function(e,t){this.$emit("delete",e,t)},handleAgent:function(e,t){this.$emit("handleAgent",e,t)},handleAdmin:function(e,t){this.$emit("handleAdmin",e,t)}}}),de=ce,ue=(a("a2b5"),Object(C["a"])(de,se,le,!1,null,null,null)),pe=ue.exports,he={stepkey:"",t:"",percentage:0,disabled:!1,count:0,total:0,tagCatrgoryId:"",importResult:[],importLoading:!1,successCount:0,failCount:0,itemId:{id:""},parentId:"",parentName:"",grade:"",selections:[],open:!1,openPlatform:!1},fe={loading:!1,tableData:[],isSearch:!0,currentRow:{},tabName:"1",pagination:{pageSize:1e3,pageSizes:[1e3],currentPage:1,total:9},tabSection:"baseinfo",operations:[{label:"新增",name:"add",type:"primary",auth:["admin:agent.add"]},{label:"刷新",name:"refresh",type:""},{label:"模板下载",name:"download",type:""}],filters:[{type:"input",label:"",placeholder:"请输入代理商名称",name:"searchValue",value:""}]},me={expandChange:function(e){this.currentRow=e,this.query(e)},getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",cooperationType:"1",searchValue:this.filters[0].value,state:""}},download:function(){window.open("/upload/mode/V服爱车_代理商导入模板.xlsx")},clearTimeOut:function(){window.clearTimeout(this.t)},restProcess:function(){this.total=0,this.count=0,this.stepkey="",this.percentage=0},handleImport:function(){var e=this,t="/admin/cooperationInfo/agent/importProgress.jhtml";m["a"].get(t,{}).then((function(t){t.data.total||(e.total=0,e.count=0,e.stepkey="",e.percentage=0),t.data.total&&(e.total=Number(t.data.total||0),e.count=Number(t.data.count||0),e.stepkey=t.data.remark,e.percentage=Number(t.data.rate),e.$refs.importFile.title=t.data.title),t.data&&t.data.rate&&"100"===t.data.rate?(e.clearTimeOut(),e.$refs.importFile.showCurrentInfo=!1,e.$refs.importFile.title="导入完成",e.$refs.importFile.uploadingVisible=!0,t.data&&t.data.results&&t.data.results.length>0&&(e.importResult=t.data.results,e.$refs.importFile.uploadingVisible=!1,e.$refs.importFile.importingVisible=!0,e.getList())):t.data&&t.data.rate&&"100"!==t.data.rate&&(e.t&&e.clearTimeOut(),e.t=setTimeout(e.handleImport,2e3),e.$refs.importFile.uploadingVisible=!0,e.$refs.importFile.showCurrentInfo=!0,e.disabled=!0)})).catch((function(e){console.log(e),console.log("code错误")}))},query:function(){var e=this;this.loading=!0,m["a"].get("/admin/cooperationInfo/cooperationInfo/list.jhtml",this.getQueryParams()).then((function(t){e.loading=!1,e.tableData=t.dataList;var a,o=Object(i["a"])(e.tableData);try{for(o.s();!(a=o.n()).done;){var n=a.value;if(n.children.length>0){n.hasChild="1";var r,s=Object(i["a"])(n.children);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(l.parentName=n.name,l.children.length>0){l.hasChild="1";var c,d=Object(i["a"])(l.children);try{for(d.s();!(c=d.n()).done;){var u=c.value;u.parentName=l.name}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){s.e(p)}finally{s.f()}}}}catch(p){o.e(p)}finally{o.f()}e.pagination.total=Number(t.total)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},queryKpi:function(){var e=this,t={shopId:window.top.SHOP_ID||"",cooperationType:"1"};m["a"].get("/admin/cooperationInfo/queryCooperationInfoKpi.jhtml",t).then((function(t){e.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:"维护代理商数据。已有代理商".concat(t.data.count,"个"),duration:3e3})})).catch((function(t){e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t)})).finally((function(t){e.loading=!1}))},refresh:function(){this.query()},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,m["a"].delete(f["g"].invoicing.supplierMgmt.shopSupplier,{ids:e}).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")},add:function(){this.itemId={id:""},this.tabName="1",this.$refs.platform.clearSearchValue(),this.$refs.platform.getList(),this.$refs.unplatform.restForm(),this.openPlatform=!0}},ge={handleOperationSuccess:function(e){this.itemId={id:String(e)},this.query()},handleOperate:function(e){this[e]()},handleFilterDataChange:function(){this.query()},handleRowClick:function(e,t,a){this.itemId={id:String(e.id)},this.parentId=e.parentId,this.parentName=e.parentName,this.grade=e.grade,this.tabSection="baseinfo",this.open=!0},handleDeleteClick:function(e,t){e.stopPropagation(),this.deleteItem([t.id])},handleAdmin:function(e,t){this.$router.push({path:this.$route.fullPath+"/admin-setting",query:{cooperationId:t.id}})},handleAgent:function(e,t){this.itemId={id:""},this.parentId=t.id,this.parentName=t.name,this.grade=t.grade,this.tabName="baseinfo",this.open=!0}},be={name:"AgentMgmt",components:{BizHeader:c["d"],BizGrid:l["a"],BizPopupTabs:d["a"],AgentBaseInfo:M,AgentProductInfo:E,AgentPlatformInfo:J,AgentUnplatformInfo:ie,ExpandTable:pe,ImportFile:s["b"],BizPagination:c["f"]},props:{},data:function(){return Object(r["a"])(Object(r["a"])({},he),fe)},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(g["c"])(["getUser"])),me),ge),created:function(){this.query(),this.queryKpi()}},ye=be,ve=(a("ff9b"),Object(C["a"])(ye,o,n,!1,null,null,null));t["default"]=ve.exports},f3ac:function(e,t,a){e.exports=a.p+"static/img/pic_default_none_100.6603f4ac.png"},f7f1:function(e,t,a){},ff9b:function(e,t,a){"use strict";var o=a("b834"),n=a.n(o);n.a}}]);