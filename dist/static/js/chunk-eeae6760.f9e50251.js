(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eeae6760"],{2497:function(t,s,e){"use strict";var a=e("4360"),o=e("a18c");s["a"]=function(t,s){return function(e){var i=e.data;"100"===i.resultCode?t(i):"709"===i.resultCode?(a["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",a["a"].getters.currentUser),o["a"].push("/login")):s(i)}}},"37b55":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"system-setting-mgmt"},[e("div",{staticClass:"email-setting"},[e("div",{staticClass:"header-button",attrs:{slot:"top"},slot:"top"},[e("biz-header",{attrs:{operations:t.operations},on:{operate:t.operate}})],1),e("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,size:"small"}},[e("el-form-item",{attrs:{label:"发件人邮箱：",prop:"smtpFromMail"}},[e("el-input",{staticClass:"input-nomal-width",attrs:{placeholder:"请输入发件人邮箱"},model:{value:t.form.smtpFromMail,callback:function(s){t.$set(t.form,"smtpFromMail",s)},expression:"form.smtpFromMail"}})],1),e("el-form-item",{attrs:{label:"SMTP服务器地址：",prop:"smtpHost"}},[e("el-input",{staticClass:"input-nomal-width",attrs:{placeholder:"请输入SMTP服务器地址"},model:{value:t.form.smtpHost,callback:function(s){t.$set(t.form,"smtpHost",s)},expression:"form.smtpHost"}})],1),e("el-form-item",{attrs:{label:"SMTP服务器端口：",prop:"smtpPort"}},[e("el-input",{staticClass:"input-nomal-width",attrs:{placeholder:"请输入SMTP服务器端口"},model:{value:t.form.smtpPort,callback:function(s){t.$set(t.form,"smtpPort",s)},expression:"form.smtpPort"}})],1),e("el-form-item",{attrs:{label:"SMTP用户名：",prop:"smtpUsername"}},[e("el-input",{staticClass:"input-nomal-width",attrs:{placeholder:"请输入SMTP用户名"},model:{value:t.form.smtpUsername,callback:function(s){t.$set(t.form,"smtpUsername",s)},expression:"form.smtpUsername"}})],1),e("el-form-item",{attrs:{label:"SMTP密码：",prop:"smtpPassword"}},[e("el-input",{staticClass:"input-nomal-width",attrs:{placeholder:"请输入SMTP密码"},model:{value:t.form.smtpPassword,callback:function(s){t.$set(t.form,"smtpPassword",s)},expression:"form.smtpPassword"}})],1),e("el-form-item",{attrs:{label:"邮件测试："}},[!1===t.isEmailTest?e("el-button",{attrs:{type:"primary"},on:{click:t.openEmailTest}},[t._v("邮件测试")]):t._e(),!0===t.isEmailTest?e("el-button",{attrs:{type:"primary"},on:{click:t.closeEmailTest}},[t._v("关闭邮件测试")]):t._e()],1)],1),!0===t.isEmailTest?e("el-form",{ref:"form4EmailTest",attrs:{rules:t.rules4EmailTest,model:t.form,size:"small"}},[e("el-form-item",{attrs:{label:"收件人邮箱：",prop:"toMail"}},[e("el-input",{staticClass:"input-nomal-width",attrs:{placeholder:"请输入收件人邮箱",type:"email"},model:{value:t.form4EmailTest.toMail,callback:function(s){t.$set(t.form4EmailTest,"toMail",s)},expression:"form4EmailTest.toMail"}}),e("el-button",{attrs:{type:"primary"},on:{click:t.sendEmail}},[t._v("发送邮件")])],1)],1):t._e()],1)])},o=[],i=(e("4d63"),e("ac1f"),e("25f0"),e("04d3")),r=e("3974"),m=e("f36f"),l={name:"EmailSetting",data:function(){var t=this,s=function(s,e,a){if(""===t.form4EmailTest.toMail)a(new Error("请输入收件人邮箱"));else{var o=new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$");o.test(t.form4EmailTest.toMail)?a():a(new Error("请输入有效的邮箱"))}};return{operations:[{label:"保存",name:"save",type:"primary"}],loading:!1,isEmailTest:!1,form:{smtpFromMail:"",smtpHost:"",smtpPort:"",smtpUsername:"",smtpPassword:""},rules:{smtpFromMail:[{required:!0,message:"请输入发件人邮箱",trigger:"focus"}],smtpHost:[{required:!0,message:"请输入SMTP服务器地址",trigger:"focus"}],smtpPort:[{required:!0,message:"请输入SMTP服务器端口",trigger:"focus"}],smtpUsername:[{required:!0,message:"请输入SMTP用户名",trigger:"focus"}]},form4EmailTest:{toMail:""},rules4EmailTest:{toMail:[{required:!0,validator:s,trigger:"focus"}]}}},components:{BizHeader:i["d"],BizGrid:m["a"]},props:{},watch:{},created:function(){this.refresh()},computed:{},methods:{operate:function(t){this[t]()},save:function(){var t=this;this.$refs.form.validate((function(s){s&&t.update()}))},refresh:function(){var t=this,s={name:"emailSetting"};r["a"].query(s,(function(s){t.form.smtpFromMail=void 0!==s.settingList?s.settingList.smtpFromMail:"",t.form.smtpHost=void 0!==s.settingList?s.settingList.smtpHost:"",t.form.smtpPort=void 0!==s.settingList?s.settingList.smtpPort:"",t.form.smtpUsername=void 0!==s.settingList?s.settingList.smtpUsername:"",t.form.smtpPassword=void 0!==s.settingList?s.settingList.smtpPassword:""}),(function(t){console.log(t)}))},update:function(){var t=this,s={smtpFromMail:this.form.smtpFromMail,smtpHost:this.form.smtpHost,smtpPort:this.form.smtpPort,smtpUsername:this.form.smtpUsername,smtpPassword:this.form.smtpPassword};r["a"].update(s,(function(s){t.$message({title:"成功",message:"更新成功",type:"success"}),t.$emit("refreshNotification")}),(function(s){t.$message({title:"警告",message:s.errorMessage,type:"warning"})}))},clearFormData:function(){this.form.smtpFromMail="",this.form.smtpHost="",this.form.smtpPort="",this.form.smtpUsername="",this.form.smtpPassword="",this.isEmailTest=!1,this.form4EmailTest.toMail=""},openEmailTest:function(){this.isEmailTest=!0},closeEmailTest:function(){this.isEmailTest=!1},sendEmail:function(){var t=this;this.$refs.form.validate((function(s){s&&t.$refs.form4EmailTest.validate((function(s){s&&t.emailTest()}))}))},emailTest:function(){var t=this,s={smtpFromMail:this.form.smtpFromMail,smtpHost:this.form.smtpHost,smtpPort:this.form.smtpPort,smtpUsername:this.form.smtpUsername,toMail:this.form4EmailTest.toMail};r["a"].emailTest(s,(function(s){t.$message({title:"成功",message:"邮件测试成功",type:"success"})}),(function(s){t.$message({title:"警告",message:s.errorMessage,type:"warning"})}))}}},n=l,p=(e("791f"),e("2877")),c=Object(p["a"])(n,a,o,!1,null,null,null);s["default"]=c.exports},3974:function(t,s,e){"use strict";var a=e("2497"),o=e("bc3a"),i=e.n(o),r=e("c596");s["a"]={query:function(t,s,e){i.a.get(r["g"].systemSetting.querySystemSetting,{params:t}).then(Object(a["a"])(s,e)).catch((function(t){console.error(t)}))},update:function(t,s,e){i.a.put(r["g"].systemSetting.updateSystemSetting,t).then(Object(a["a"])(s,e)).catch((function(t){console.error(t)}))},emailTest:function(t,s,e){i.a.post(r["g"].systemSetting.emailTest,t).then(Object(a["a"])(s,e)).catch((function(t){console.error(t)}))}}},"791f":function(t,s,e){"use strict";var a=e("bca3"),o=e.n(a);o.a},bca3:function(t,s,e){}}]);