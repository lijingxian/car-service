(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b638f50"],{"0943":function(e,t,a){"use strict";var i=a("1fac"),n=a.n(i);n.a},"1fac":function(e,t,a){},"697f":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),a("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?a("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},n=[],s=(a("99af"),a("4160"),a("c975"),a("a434"),a("a9e3"),a("159b"),a("04d3")),r={name:"BizDialogSelector",components:{BizFlexTable:s["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var a=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(a,1),this.innerSelection.splice(a,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a>=0&&t.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},o=r,l=(a("0943"),a("2877")),c=Object(l["a"])(o,i,n,!1,null,null,null);t["a"]=c.exports},8234:function(e,t,a){},adc9:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"single-store-analysis"},[i("div",{staticClass:"operator"},[e.filters.length>0?i("div",{staticClass:"filter-portrait"},[e.filters.length>0?i("biz-filter",{attrs:{filters:e.filters},on:{filterDataChange:e.filterDataChange}}):e._e()],1):e._e()]),i("div",{staticClass:"member-info"},[i("div",{staticClass:"header"},[i("span",[e._v("店铺信息")]),i("span",[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.memberSelected}},[e._v("切换")])],1)]),i("div",{staticClass:"container"},[i("div",{staticClass:"header-img"},[e.shopInfo.head?i("img",{attrs:{src:e.shopInfo.head,alt:""}}):i("img",{attrs:{src:e.DefaultAvatar}})]),i("div",{staticClass:"info-con"},[i("div",{staticClass:"base-info",attrs:{title:e.shopInfo.name}},[e._v("店铺名称："+e._s(e.shopInfo.name))]),i("div",{staticClass:"base-info"},[e._v("所属城市："+e._s(e.shopInfo.city))]),i("div",{staticClass:"base-info"},[e._v("联系方式："+e._s(e.shopInfo.phone))]),i("div",{staticClass:"base-info",attrs:{title:e.shopInfo.brands}},[e._v(" 经营品牌： "),e._l(e.shopInfo.brands,(function(t,a){return i("span",{key:a},[e._v(" "+e._s(t)+" "),a<e.shopInfo.brands.length-1?i("i",[e._v(e._s(e.separator))]):e._e()])}))],2),i("div",{staticClass:"base-info"},[e._v(" 店铺特色： "),e._l(e.shopInfo.tags,(function(t,a){return i("span",{key:a},[e._v(" "+e._s(t)+" "),a<e.shopInfo.tags.length-1?i("i",[e._v(e._s(e.separator))]):e._e()])}))],2),i("div",{staticClass:"base-info",attrs:{title:e.shopInfo.address}},[e._v("地址："+e._s(e.shopInfo.address))]),i("div",{staticClass:"dec-info"},[e._v(e._s(e.shopInfo.summarize))])]),i("div",{staticClass:"header-img-qr"},[e.shopInfo.qrCodePath?i("img",{staticStyle:{width:"auto",height:"auto","max-width":"100px"},attrs:{src:e.shopInfo.qrCodePath,alt:""}}):i("img",{attrs:{src:e.DefaultAvatar}})])])]),i("div",{staticClass:"graph-container"},[i("div",{staticClass:"left-graph"},[e._m(0),i("biz-chart",{staticStyle:{"padding-bottom":"40px"},attrs:{chartData:e.radarChartData,showSearch:!1,chartHeight:e.chartHeight}})],1),i("div",{staticClass:"between-graph"},[e._m(1),i("biz-chart",{attrs:{chartData:e.timesGraphData,axisLabelRotate:e.labelRotate,showSearch:!1,chartHeight:e.chartHeight}})],1),i("div",{staticClass:"right-graph"},[e._m(2),i("biz-chart",{attrs:{chartData:e.amountGraphData,axisLabelRotate:e.labelRotate,showSearch:!1,chartHeight:e.chartHeight}})],1)]),i("div",{staticClass:"graph-container"},[i("div",{staticClass:"left-graph"},[i("div",{staticClass:"header"},[i("span",[e._v("文章类型偏好")]),i("span",{staticClass:"font"},[e._v("文章数："+e._s(e.readTotalCount))])]),i("biz-chart",{attrs:{chartData:e.articlePreferenceGraphData,showSearch:!1,chartHeight:e.chartHeight}})],1),i("div",{staticClass:"between-graph"},[i("div",{staticClass:"header"},[i("span",[e._v("商品类型分布")]),i("span",{staticClass:"font"},[e._v("商品量："+e._s(e.buyTotalCount))])]),i("biz-chart",{attrs:{chartData:e.productPreferenceGraphData,showSearch:!1,chartHeight:e.chartHeight}})],1),i("div",{staticClass:"right-graph"},[i("div",{staticClass:"header"},[i("span",[e._v("店铺满意度分布")]),i("span",{staticClass:"font"},[e._v("评价人数："+e._s(e.loginTotalCount))])]),i("biz-chart",{attrs:{chartData:e.loginGraphData,showSearch:!1,chartHeight:e.chartHeight}})],1)]),i("biz-dialog-selector",{staticClass:"notice-dialog-selector",attrs:{title:"选择店铺",visibility:e.showDialog,appendToBody:!0,selectionMode:"single",isClear:!1,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.handleConfirmed}},[i("el-table-column",{attrs:{prop:"logo",label:"店铺logo"},scopedSlots:e._u([{key:"default",fn:function(e){return[e.row.logo?i("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.logo}}):i("img",{attrs:{src:a("932d")}})]}}])}),i("el-table-column",{attrs:{prop:"name",label:"店铺名称"}})],1)],1)},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("span",[e._v("店铺能力")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("span",[e._v("月订单额趋势")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("span",[e._v("月订单量趋势")])])}],s=(a("99af"),a("d81d"),a("a9e3"),a("ade3")),r=a("b85c"),o=a("5530"),l=a("932d"),c=a.n(l),h=a("8c35"),u=a("ce0c"),d=a("1ab1"),g=a("2f62"),f=a("562e"),p=a("af3f"),m={name:"SingleStoreAnalysis",data:function(){return{date:"",chartHeight:"100%",labelRotate:45,DefaultAvatar:c.a,shopInfo:[],showDialog:!1,timesGraphData:{},amountGraphData:{},articlePreferenceGraphData:{legendVisible:!1,type:"pie",data:{columns:["type","value"],rows:[]},settings:{radius:["20%","60%"],offsetY:"50%"}},radarChartData:{},productPreferenceGraphData:{legendVisible:!1,type:"pie",data:{columns:["type","value"],rows:[]},settings:{radius:["20%","60%"],offsetY:"50%"}},loginGraphData:{legendVisible:!1,type:"pie",data:{columns:["type","value"],rows:[]},settings:{radius:["20%","60%"],offsetY:"50%"}},dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},filters:[{type:"input",value:"",name:"search",placeholder:"请输入店铺名称"}],dialogLoading:!0,dialogTableData:[],memberMobileData:[],beginDate:u["a"].getMonthStartDate(),endDate:u["a"].getMonthEndDate(),curTagName:"",memberId:"",readTotalCount:0,buyTotalCount:0,loginTotalCount:0,separator:"、"}},props:{},watch:{},components:{BizFilter:h["a"],BizChart:f["a"],BizDialogSelector:p["a"]},computed:{},methods:Object(o["a"])(Object(o["a"])({},Object(g["c"])(["getUser"])),{},{refresh:function(e){this.getMemberInfo(e),this.getTimesGraphData(e),this.getAmountGraphData(e),this.getLoginGraphData(e),this.getArticlePreferenceGraphData(e),this.getProductPreferenceGraphData(e),this.getRadarGraphData(e)},queryMembers:function(){var e=this;this.dialogLoading=!0;var t={};d["a"].get("/admin/admin/manageShops.jhtml",t).then((function(t){e.dialogTableData=t.dataList,e.dialogPagination.total=t.dataList.length,e.dialogLoading=!1})).catch((function(t){"店铺不存在"!==t.errorMessage&&e.$message.warning(t.errorMessage),e.dialogLoading=!1}))},getMemberInfo:function(e){var t=this,a={shopId:window.top.SHOP_ID||e||""};d["a"].get("/admin/ecommerce/kpi/summary/single/store.jhtml",a).then((function(e){t.shopInfo=e.shop})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},searchByName:function(){var e=this,t={searchValue:this.filters[0].value};d["a"].get("/admin/store/queryStoreByName.jhtml",t).then((function(t){e.memberMobileData=t.store,e.refresh(e.memberMobileData.id)})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)}))},getArticlePreferenceGraphData:function(e){var t=this;this.readTotalCount=0;var a={shopId:window.top.SHOP_ID||e||""};d["a"].get("/admin/ecommerce/kpi/graph/single/storeArticlePreference.jhtml",a).then((function(e){var a,i=Object(r["a"])(e.indicators);try{for(i.s();!(a=i.n()).done;){var n=a.value;t.readTotalCount+=Number(n.value)}}catch(s){i.e(s)}finally{i.f()}t.articlePreferenceGraphData.data.rows=e.indicators.map((function(e){return{type:e.lable,value:e.value}}))})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},getProductPreferenceGraphData:function(e){var t=this;this.buyTotalCount=0;var a={shopId:window.top.SHOP_ID||e||""};d["a"].get("/admin/ecommerce/kpi/graph/single/storeProducePreference.jhtml",a).then((function(e){var a,i=Object(r["a"])(e.indicators);try{for(i.s();!(a=i.n()).done;){var n=a.value;t.buyTotalCount+=Number(n.value)}}catch(s){i.e(s)}finally{i.f()}t.productPreferenceGraphData.data.rows=e.indicators.map((function(e){return{type:e.lable,value:e.value}}))})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},getLoginGraphData:function(e){var t=this;this.loginTotalCount=0;var a={shopId:window.top.SHOP_ID||e||""};d["a"].get("/admin/ecommerce/kpi/graph/single/storeReviewPreference.jhtml",a).then((function(e){var a,i=Object(r["a"])(e.indicators);try{for(i.s();!(a=i.n()).done;){var n=a.value;t.loginTotalCount+=Number(n.value)}}catch(s){i.e(s)}finally{i.f()}t.loginGraphData.data.rows=e.indicators.map((function(e){return{type:e.lable,value:e.value}}))})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},getRadarGraphData:function(e){var t=this,a={shopId:window.top.SHOP_ID||e||""};d["a"].get("/admin/ecommerce/kpi/graph/single/storeAbility.jhtml",a).then((function(e){t.radarChartData=t.radarFormat(e)})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},radarFormat:function(e){for(var t=[],a=[],i=[],n=0;n<e.indicators.length;n++)i.push(e.indicators[n].lable),t.push(Object(s["a"])({"店铺能力":"店铺能力"},e.indicators[n].lable,e.indicators[n].value));a.push(Object.assign.apply(Object,t)),console.log(Object.assign.apply(Object,t));var r={type:"radarShop",data:{columns:["店铺能力"].concat(i),rows:a,data:e.indicators},settings:{}};return r},getTimesGraphData:function(e){var t=this,a={shopId:window.top.SHOP_ID||e||""};d["a"].get("/admin/ecommerce/kpi/graph/single/storeOrderAmount.jhtml",a).then((function(e){t.timesGraphData=t.dataTimesFormat(e)})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},dataTimesFormat:function(e){for(var t=[],a=0;a<e.indicators.length;a++)t.push({"日期":e.indicators[a].xValue,"订单额":e.indicators[a].yValue});var i={legendVisible:!1,type:"histogram",data:{columns:["日期","订单额"],rows:t},settings:{}};return i},getAmountGraphData:function(e){var t=this,a={shopId:window.top.SHOP_ID||e||""};d["a"].get("/admin/ecommerce/kpi/graph/single/storeOrderCount.jhtml",a).then((function(e){t.amountGraphData=t.dataAmountFormat(e)})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},dataAmountFormat:function(e){for(var t=[],a=0;a<e.indicators.length;a++)t.push({"日期":e.indicators[a].xValue,"订单量":e.indicators[a].yValue});var i={legendVisible:!1,type:"histogram",data:{columns:["日期","订单量"],rows:t},settings:{}};return i},memberSelected:function(){this.showDialog=!0,this.curTagName="",this.queryMembers()},filterDataChange:function(e){this.filters=e,this.searchByName()},handleConfirmed:function(e,t){this.showDialog=!1,this.refresh(t[0].id)}}),created:function(){},mounted:function(){this.refresh()}},b=m,v=(a("f605"),a("2877")),y=Object(v["a"])(b,i,n,!1,null,null,null);t["default"]=y.exports},af3f:function(e,t,a){"use strict";var i=a("697f");t["a"]=i["a"]},f605:function(e,t,a){"use strict";var i=a("8234"),n=a.n(i);n.a}}]);