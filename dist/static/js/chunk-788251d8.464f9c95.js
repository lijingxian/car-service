(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-788251d8","chunk-22dd6a1d"],{"036c":function(e,t,a){},"0413":function(e,t,a){"use strict";var i=a("1b99"),o=a.n(i);o.a},"0943":function(e,t,a){"use strict";var i=a("1fac"),o=a.n(i);o.a},1148:function(e,t,a){"use strict";var i=a("a691"),o=a("1d80");e.exports="".repeat||function(e){var t=String(o(this)),a="",n=i(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(a+=t);return a}},"11e9":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getCommodityList:function(e,t,a){n.a.get(r["g"].commodity.getCommodityList,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){n.a.delete(r["g"].commodity.delete,{data:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},query:function(e,t,a){n.a.get(r["g"].commodity.query,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},soldoutAndPutaway:function(e,t,a){n.a.post(r["g"].commodity.soldoutAndPutaway,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},cloneProduct:function(e,t,a){n.a.post(r["g"].commodity.cloneProduct,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryPlatformCategoryTree:function(e,t,a){n.a.get(r["g"].commodity.queryPlatformCategoryTree,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryPlatformImportInfo:function(e,t,a){n.a.get(r["g"].commodity.queryPlatformImportInfo,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},importPlatformProduct:function(e,t,a){n.a.post(r["g"].commodity.importPlatformProduct,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},audit:function(e,t,a){n.a.post(r["g"].commodity.audit,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},auditTarget:function(e,t,a){n.a.post(r["g"].commodity.auditTarget,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},recallProduct:function(e,t,a){n.a.get(r["g"].commodity.recallProduct,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryFilters:function(e,t,a){n.a.get(r["g"].commodity.queryFilters,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},1431:function(e,t,a){"use strict";var i=a("f24b"),o=a.n(i);o.a},"1b99":function(e,t,a){},"1f2f":function(e,t,a){"use strict";var i=a("40e4"),o=a.n(i);o.a},"1fac":function(e,t,a){},"207f":function(e,t,a){"use strict";var i=a("704b"),o=a.n(i);o.a},2299:function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getImageGroups:function(e,t,a){n.a.get(r["g"].commodity.getImageGroups,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateImageGroups:function(e,t,a){n.a.put(r["g"].commodity.updateImageGroups,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductVrMediaBath:function(e,t,a){n.a.put(r["g"].commodity.updateProductVrMediaBath,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},getImageGroups_pm:function(e,t,a){n.a.get(r["g"].commodity.getImageGroups_pm,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateImageGroups_pm:function(e,t,a){n.a.put(r["g"].commodity.updateImageGroups_pm,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductVrMediaBath_pm:function(e,t,a){n.a.put(r["g"].commodity.updateProductVrMediaBath_pm,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},"245a":function(e,t,a){},2497:function(e,t,a){"use strict";var i=a("4360"),o=a("a18c");t["a"]=function(e,t){return function(a){var n=a.data;"100"===n.resultCode?e(n):"709"===n.resultCode?(i["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",i["a"].getters.currentUser),o["a"].push("/login")):t(n)}}},2807:function(e,t,a){},"2df8":function(e,t,a){"use strict";var i=a("378a"),o=a.n(i);o.a},"33cc":function(e,t,a){"use strict";var i=a("564e"),o=a.n(i);o.a},"378a":function(e,t,a){},"392e":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={queryProductBasicInfo:function(e,t,a){n.a.get(r["g"].commodity.queryProductBasicInfo,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductBasicInfo:function(e,t,a){n.a.put(r["g"].commodity.updateProductBasicInfo,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},creatProductBasicInfo:function(e,t,a){n.a.post(r["g"].commodity.creatProductBasicInfo,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},creatBenefitsBasicInfo:function(e,t,a){n.a.post("/admin/shopProduct/benefitsProduct/basicInfo.jhtml",e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductDetail:function(e,t,a){n.a.get(r["g"].commodity.queryProductDetail,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductDetail:function(e,t,a){n.a.put(r["g"].commodity.queryProductDetail,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductDetail_pm:function(e,t,a){n.a.get(r["g"].commodity.queryProductDetail_pm,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductDetail_pm:function(e,t,a){n.a.put(r["g"].commodity.updateProductDetail_pm,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},"3d7f":function(e,t,a){"use strict";var i=a("c751"),o=a.n(i);o.a},"408a":function(e,t,a){var i=a("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=i(e))throw TypeError("Incorrect invocation");return+e}},"40e4":function(e,t,a){},"443b":function(e,t,a){"use strict";a("4de4");var i=a("c596"),o=a("1ab1"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":"",visible:e.visible,title:"自定义列","custom-class":"biz-columns",width:"500px"},on:{close:e.onClose}},[a("div",{staticClass:"columns-wrap"},[a("biz-flex-table",{ref:"table",attrs:{checkable:!1,tableData:e.tableData},on:{"selection-change":e.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.getSelectable}}),a("el-table-column",{attrs:{label:"信息",prop:"name"}}),a("el-table-column",{attrs:{prop:"tag",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.$index;return[a("el-button",{attrs:{icon:"el-icon-sort-up",type:"text",disabled:0===i},on:{click:function(t){return e.onUp(i)}}}),a("el-button",{attrs:{icon:"el-icon-sort-down",type:"text",disabled:i===e.tableData.length-1},on:{click:function(t){return e.onBottom(i)}}})]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)])},r=[],s=(a("7db0"),a("a434"),a("b85c")),c=a("04d3"),l={name:"biz-columns",components:{BizFlexTable:c["c"]},props:{visible:Boolean,tableId:String},data:function(){return{id:"",tableName:"",selections:[],tableData:[]}},computed:{},watch:{visible:function(e){e?this.makeRowDisplayable():this.saveSelection()},tableId:function(){this.getTableColumns()}},mounted:function(){this.getTableColumns()},methods:{getTableColumns:function(){var e=this;o["a"].get(i["g"].user.columns,{tableId:this.tableId}).then((function(t){e.tableData=t.data.columnDatas,e.id=t.data.id,e.tableName=t.data.tableName}))},getSelectable:function(e){return e.isEditable},selectionChangeHandler:function(e){this.selections=e},saveSelection:function(){var e,t=this,a=Object(s["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var i=e.value;i.displayable=!1}}catch(c){a.e(c)}finally{a.f()}var o,n=Object(s["a"])(this.selections);try{var r=function(){var e=o.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(n.s();!(o=n.n()).done;)r()}catch(c){n.e(c)}finally{n.f()}},onUp:function(e){this.tableData[e]=this.tableData.splice(e-1,1,this.tableData[e])[0]},onBottom:function(e){this.tableData[e]=this.tableData.splice(e+1,1,this.tableData[e])[0]},onClose:function(){this.$emit("update:visible",!1)},update:function(){var e,t=this,a=Object(s["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var n=e.value;n.displayable=!1}}catch(u){a.e(u)}finally{a.f()}var r,c=Object(s["a"])(this.selections);try{var l=function(){var e=r.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(c.s();!(r=c.n()).done;)l()}catch(u){c.e(u)}finally{c.f()}var d={columnDatas:this.tableData,id:this.id,tableId:this.tableId,tableName:this.tableName};console.log(d),o["a"].put(i["g"].user.columns,d).then((function(e){t.$emit("update"),t.$emit("update:visible",!1)}))},makeRowDisplayable:function(){var e=this;setTimeout((function(){var t,a=Object(s["a"])(e.tableData);try{for(a.s();!(t=a.n()).done;){var i=t.value;e.$refs.table.$refs.table.toggleRowSelection(i,i.displayable)}}catch(o){a.e(o)}finally{a.f()}}),20)}}},d=l,u=(a("ec6b"),a("2877")),p=Object(u["a"])(d,n,r,!1,null,null,null),h=p.exports,m=h;t["a"]={components:{BizColumnOperation:c["a"],BizColumns:m},data:function(){return{columnsSettingVisible:!1,columns:[]}},created:function(){this.getTableId(),this.getColumns()},methods:{onCustomColumns:function(){this.columnsSettingVisible=!0},getColumns:function(){var e=this;console.log(12),o["a"].get(i["A"].columns,{tableId:this.tableId}).then((function(t){e.columns=[],setTimeout((function(){e.columns=t.data.columnDatas.filter((function(e){return e.displayable})),e.$refs.table&&setTimeout((function(){e.$refs.table.doLayout()}),50)}),20)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getTableId:function(){}}}},"44e0":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getParameterGroups:function(e,t,a){n.a.get(r["g"].commodity.getParameterGroups,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateParameterGroups:function(e,t,a){n.a.put(r["g"].commodity.updateParameterGroups,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},"498a":function(e,t,a){"use strict";var i=a("23e7"),o=a("58a8").trim,n=a("c8d2");i({target:"String",proto:!0,forced:n("trim")},{trim:function(){return o(this)}})},"4b00":function(e,t,a){"use strict";var i=a("6dd6"),o=a.n(i);o.a},"4b5f":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getSpecificationGroups:function(e,t,a){console.log("[---- dachao ----] [API-商品规格-get] getSpecificationGroups() params=",e),n.a.get(r["g"].commodity.getSpecificationGroups,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateSpecificationGroups:function(e,t,a){console.log("[---- dachao ----] [API-商品规格-put] updateSpecificationGroups() params=",e),n.a.put(r["g"].commodity.updateSpecificationGroups,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},"4f61":function(e,t,a){},5118:function(e,t,a){(function(e){var i="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,o=Function.prototype.apply;function n(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new n(o.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new n(o.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},a("6017"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,a("c8ba"))},"551a":function(e,t,a){"use strict";var i=a("d8bc"),o=a.n(i);o.a},"564e":function(e,t,a){},"5b8e":function(e,t,a){"use strict";var i=a("9678"),o=a.n(i);o.a},6017:function(e,t,a){(function(e,t){(function(e,a){"use strict";if(!e.setImmediate){var i,o=1,n={},r=!1,s=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?h():m()?f():e.MessageChannel?g():s&&"onreadystatechange"in s.createElement("script")?b():v(),c.setImmediate=l,c.clearImmediate=d}function l(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),a=0;a<t.length;a++)t[a]=arguments[a+1];var r={callback:e,args:t};return n[o]=r,i(o),o++}function d(e){delete n[e]}function u(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(a,i);break}}function p(e){if(r)setTimeout(p,0,e);else{var t=n[e];if(t){r=!0;try{u(t)}finally{d(e),r=!1}}}}function h(){i=function(e){t.nextTick((function(){p(e)}))}}function m(){if(e.postMessage&&!e.importScripts){var t=!0,a=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=a,t}}function f(){var t="setImmediate$"+Math.random()+"$",a=function(a){a.source===e&&"string"===typeof a.data&&0===a.data.indexOf(t)&&p(+a.data.slice(t.length))};e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),i=function(a){e.postMessage(t+a,"*")}}function g(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;p(t)},i=function(t){e.port2.postMessage(t)}}function b(){var e=s.documentElement;i=function(t){var a=s.createElement("script");a.onreadystatechange=function(){p(t),a.onreadystatechange=null,e.removeChild(a),a=null},e.appendChild(a)}}function v(){i=function(e){setTimeout(p,0,e)}}})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,a("c8ba"),a("4362"))},"697f":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),a("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?a("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},o=[],n=(a("99af"),a("4160"),a("c975"),a("a434"),a("a9e3"),a("159b"),a("04d3")),r={name:"BizDialogSelector",components:{BizFlexTable:n["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var a=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(a,1),this.innerSelection.splice(a,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a>=0&&t.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},s=r,c=(a("0943"),a("2877")),l=Object(c["a"])(s,i,o,!1,null,null,null);t["a"]=l.exports},"6caf":function(e,t,a){"use strict";var i=a("abc3"),o=a.n(i);o.a},"6dd6":function(e,t,a){},"704b":function(e,t,a){},7132:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},o=[],n={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},r=n,s=(a("5b8e"),a("2877")),c=Object(s["a"])(r,i,o,!1,null,null,null),l=c.exports,d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},u=[],p=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:l},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),h=p,m=(a("d4c2"),Object(s["a"])(h,d,u,!1,null,null,null)),f=m.exports;a.d(t,"a",(function(){return f}))},7668:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"promotion-participation-way"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"Product"===e.participationWay||"3"===e.participationWay,expression:"participationWay === 'Product'||participationWay === '3'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:e.addProducts}},[e._v("添加商品")]),a("el-table",{ref:"productTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.products,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"fullName",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"price",label:"价格"}}),a("el-table-column",{attrs:{prop:"stock",label:"库存"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delProduct(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"ShopBrand"===e.participationWay||"2"===e.participationWay,expression:"participationWay === 'ShopBrand'||participationWay === '2'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:e.addBrands}},[e._v("添加品牌")]),a("el-table",{ref:"brandTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.shopBrands,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name",label:"品牌名称"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delBrand(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"ProductCategory"===e.participationWay||"1"===e.participationWay,expression:"participationWay === 'ProductCategory'||participationWay === '1'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showClassSelector=!e.showClassSelector}}},[e._v("添加分类")]),a("el-table",{ref:"cateTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.productCategories,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name",label:"分类名称"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delClass(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("biz-dialog-selector",{attrs:{title:"选择商品",visibility:e.showProductSelector,tableData:e.productTableData,pagination:e.productPagination,filters:e.productFilters,selectionKeys:e.selectedProducts,max:5},on:{"update:visibility":function(t){e.showProductSelector=t},pageSizeChange:e.productPageSizeChange,currentPageChange:e.productCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.productFilterDataChange}},[a("el-table-column",{attrs:{property:"sn",label:"编号"}}),a("el-table-column",{attrs:{property:"name",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"dialog-column"},[a("img",{staticClass:"productImg",attrs:{src:t.row.image||e.DefaultImg}}),a("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.fullName))])])]}}])}),a("el-table-column",{attrs:{property:"price",label:"销售价"}}),a("el-table-column",{attrs:{property:"stock",label:"库存"}}),a("el-table-column",{attrs:{property:"categoryType",label:"分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("0"===t.row.categoryType?"整车":"1"===t.row.categoryType?"车品":"2"===t.row.categoryType?"服务":"无")+" ")]}}])})],1),a("el-dialog",{staticClass:"promotion-dialog-checkbox",attrs:{title:"选择品牌",visible:e.showBrandSelector,"append-to-body":""},on:{"update:visible":function(t){e.showBrandSelector=t}}},[a("div",{staticClass:"dialog-top"},[a("el-input",{attrs:{size:"small",placeholder:"请输入品牌"},model:{value:e.brandSearchValue,callback:function(t){e.brandSearchValue=t},expression:"brandSearchValue"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.brandSearch},slot:"append"})],1)],1),a("el-checkbox-group",{model:{value:e.brandArr,callback:function(t){e.brandArr=t},expression:"brandArr"}},e._l(e.brandList,(function(t){return a("el-checkbox",{key:t.index,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showBrandSelector=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmBrands}},[e._v("确 定")])],1)],1),a("el-dialog",{staticClass:"promotion-dialog-checkbox",attrs:{title:"选择分类",visible:e.showClassSelector,"append-to-body":""},on:{"update:visible":function(t){e.showClassSelector=t}}},[a("el-tree",{ref:"tree",attrs:{props:e.defaultProps,"node-key":"id","highlight-current":e.highlightCurrent,data:e.dataTree,"show-checkbox":""},on:{"check-change":e.handleCheckChange}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showClassSelector=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmClasses}},[e._v("确 定")])],1)],1)],1)},o=[],n=(a("4de4"),a("caad"),a("c975"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("d3b7"),a("2532"),a("af3f")),r=a("2497"),s=a("bc3a"),c=a.n(s),l=a("c596"),d={queryGiftList:function(e,t,a){c.a.get(l["g"].activityMgmt.PromotionContent_queryGift,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductList:function(e,t,a){c.a.get(l["g"].activityMgmt.PromotionContent_queryProduct,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},queryBaseInfo:function(e,t,a){c.a.get(l["g"].activityMgmt.PromotionBaseInfo_query,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))}},u=a("1ab1"),p={queryBrandList:"/admin/shopBrand/brandSeries.jhtml",queryCategoryList:"/admin/json/ShopProduct_category/list.jhtml"},h=a("f3ac"),m=a.n(h),f={name:"PromotionParticipationWay",props:{value:{type:Array,default:function(){return[]}},participationWay:{type:String,default:function(){return""}},baseInfo:{type:Object,default:function(){return{shop:{name:""}}}}},data:function(){return{highlightCurrent:!0,defaultProps:{children:"children",label:"label"},dataTree:[],DefaultImg:m.a,brandList:[],brandSearchValue:"",products:[],shopBrands:[],productCategories:[],showProductSelector:!1,showBrandSelector:!1,showClassSelector:!1,brandArr:[],classList:[],classArr:[],productTableData:[],selectedProducts:[],productPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},productFilters:[{type:"input",placeholder:"请输入编号/商品名",name:"searchbar",value:""}]}},components:{BizDialogSelector:n["a"]},methods:{loadNode:function(){var e=this;u["a"].get("/admin/json/ShopProduct_category/list.jhtml",{pageNumber:1,pageSize:1e3}).then((function(t){e.dataTree=[],t.ProductCategoryManage.map((function(t){e.dataTree.push({label:t.name,id:t.id,children:t.childrenProductCategoryDataList.map((function(e){return{label:e.name,id:e.id}}))})})),e.$refs.tree.setCheckedKeys(e.value.map((function(e){return e.id}))),console.log(e.dataTree)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},handleCheckChange:function(e,t,a){var i=this;console.log(e,t,a),console.log(this.$refs.tree.getCheckedNodes()),this.$nextTick((function(){i.classArr=i.$refs.tree.getCheckedNodes().map((function(e){return e.id}))}))},productPageSizeChange:function(e){this.productPagination.pageSize=e,this.getProductTable()},productCurrentPageChange:function(e){this.productPagination.currentPage=e,this.getProductTable()},confirmedProduct:function(e){var t=this,a={ids:e};u["a"].post(l["a"].PromotionContent_queryProductByIds,a).then((function(e){t.products=e.content.filter((function(e){return e})),t.selectedProducts=t.products.map((function(e){return e.id})),t.handleInput(t.products)})).catch((function(e){console.log("ERR_GET_PRODUCT_BY_IDS: ",e)}))},productFilterDataChange:function(e){this.productPagination.currentPage=1,this.productFilters=e,this.getProductTable()},delProduct:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.products.length;a++)t.products[a].id===e&&(t.products.splice(a,1),t.handleInput(t.products));t.selectedProducts=[],t.products.map((function(e){t.selectedProducts.push(e.id)}))})).catch((function(){}))},delBrand:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.shopBrands.length;a++)t.shopBrands[a].id===e&&(t.shopBrands.splice(a,1),t.handleInput(t.shopBrands),t.brandSearchValue="");t.brandArr=[],t.shopBrands.map((function(e){t.brandArr.push(e.id)}))})).catch((function(){}))},delClass:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.productCategories.length;a++)t.productCategories[a].id===e&&(t.productCategories.splice(a,1),t.handleInput(t.productCategories));t.classArr=[],t.productCategories.map((function(e){t.classArr.push(e.id)}))})).catch((function(){}))},brandSearch:function(){this.getBrandList()},confirmBrands:function(){var e=this;this.showBrandSelector=!1;var t={searchProperty:"name",searchValue:"",pageNumber:1,pageSize:1e3};u["a"].get(p.queryBrandList,t).then((function(t){e.brandList=t.Brand,e.shopBrands=e.brandList.filter((function(t){return e.brandArr.includes(t.id)})),e.handleInput(e.shopBrands)})).catch()},confirmClasses:function(){var e=this;this.showClassSelector=!1,this.productCategories=[],this.$refs.tree.getCheckedNodes().map((function(t){-1!==e.classArr.indexOf(t.id)&&e.productCategories.push({id:t.id,name:t.label})})),this.handleInput(this.productCategories)},getProductTable:function(){var e=this,t={productType:"normal",pageSize:this.productPagination.pageSize,pageNumber:this.productPagination.currentPage,searchValue:this.productFilters[0].value};d.queryProductList(t,(function(t){e.productPagination.total=Number(t.total),e.productTableData=t.content}),(function(e){console.log("ERR_GET_PRODUCT_TABLE: ",e)}))},addProducts:function(){var e=this;this.selectedProducts=[],this.value.map((function(t){e.selectedProducts.push(t.id)})),this.showProductSelector=!0},addBrands:function(){this.showBrandSelector=!this.showBrandSelector,this.getBrandList()},getBrandList:function(){var e=this,t={searchProperty:"name",searchValue:this.brandSearchValue,pageNumber:1,pageSize:1e3};u["a"].get(p.queryBrandList,t).then((function(t){e.brandList=t.Brand})).catch()},handleInput:function(e){this.$emit("input",e)}},watch:{value:{handler:function(e,t){switch(this.participationWay){case"Store":case"0":this.products=[],this.shopBrands=[],this.productCategories=[];break;case"Product":case"3":this.products=e,this.shopBrands=[],this.productCategories=[];break;case"ShopBrand":case"2":this.products=[],this.shopBrands=e,this.productCategories=[];break;case"ProductCategory":case"1":this.products=[],this.shopBrands=[],this.productCategories=e;break;default:break}},deep:!0},showProductSelector:function(e,t){e&&(this.productPagination.currentPage=1,this.getProductTable())},showClassSelector:function(e,t){e&&this.loadNode()},showBrandSelector:function(e,t){e&&"2"===this.participationWay&&(this.brandArr=this.value.map((function(e){return e.id})))}},mounted:function(){}},g=f,b=(a("b537"),a("2877")),v=Object(b["a"])(g,i,o,!1,null,null,null);t["a"]=v.exports},7777:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"store-vehicle-picker"},[a("biz-dialog-selector",{attrs:{slot:"float",title:"选择竞品",selectionMode:"single",visibility:e.showDialog,loading:e.dialogLoading,tableData:e.tableData,pagination:e.dialogPagination,keyField:"id",selectionKeys:e.selectionKeys,filters:e.dialogFilters,isClear:!1},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,"active-item-change":e.activeItemChange,cascaderChange:e.cascaderChange},slot:"float"},[a("el-table-column",{attrs:{prop:"brandName",label:"品牌"}}),a("el-table-column",{attrs:{prop:"seriesName",label:"系列"}}),a("el-table-column",{attrs:{prop:"type",label:"车型"}})],1)],1)},o=[],n=(a("4160"),a("d81d"),a("b0c0"),a("d3b7"),a("25f0"),a("159b"),a("b85c")),r=a("5530"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[a("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tags:e.tags,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange}},[e._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?a("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],1)},c=[],l=(a("99af"),a("c975"),a("a434"),a("a9e3"),a("04d3")),d={name:"BizDialogSelector",components:{BizFlexTable:l["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],innerSelection:[]}},methods:{generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]);else{var a=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(a,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){this.innerSelectionKeys.length>0?this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection):this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a>=0&&t.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},rowClick:function(e,t,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},u=d,p=(a("daa4"),a("2877")),h=Object(p["a"])(u,s,c,!1,null,null,null),m=h.exports,f=a("c596"),g=a("e4c3"),b=a("1ab1"),v=a("2f62"),y={name:"StoreVehiclePicker",components:{BizDialogSelector:m},model:{prop:"value",event:"input"},props:{value:{type:Array},all:{type:Boolean,default:function(){return!1}}},data:function(){return{showDialog:!1,dialogLoading:!1,selectionKeys:[],tableData:[],brandId:"",seriesId:"",brandsData:[],seriesData:[],dialogPagination:{pageSize:50,currentPage:1,pageSizes:[50,100],total:0},dialogFilters:[{type:"select",label:"店铺名称",name:"shopName",value:"",options:[],class:"hidden"},{type:"cascader",label:"品牌系列",filterable:!1,name:"brandSeries",value:[],options:[]},{type:"input",label:"",placeholder:"请输入商品名称",name:"searchValue",value:""}]}},computed:Object(r["a"])(Object(r["a"])({},Object(v["c"])(["getUser"])),{},{textComputed:function(){return"已选择 "+this.value.length+" 辆车"}}),created:function(){this.queryShopList()},methods:{getBrand:function(){var e=this;b["a"].get("/admin/baseData/carType.jhtml",{shopId:window.top.SHOP_ID||""}).then((function(t){e.brandsData=t.brands,e.setBrandFilters()})).catch((function(e){console.log(e),console.log("code错误")}))},setBrandFilters:function(){var e=[{value:"",label:"全部"}];this.brandsData.forEach((function(t){e.push({value:t.id,label:t.name,children:[]})})),this.dialogFilters[1].options=e},activeItemChange:function(e){var t=this,a={shopId:this.getUser.shop.id,brandId:e.toString()};b["a"].get("/admin/baseData/carType/getSeries.jhtml",a).then((function(a){t.seriesData=a.serieses;var i=[];t.dialogFilters[1].options.forEach((function(t){t.value===e[0]&&(t.children=[],i=t.children,a.serieses.forEach((function(e){i.push({value:e.id,label:e.name})})))}))})).catch((function(e){t.$message.warning(e.errorMessage)}))},cascaderChange:function(e){this.brandId=e[e.length-2],this.seriesId=e[e.length-1],""===this.seriesId?this.queryVehicles(this.getDialogQueryParams()):this.querySeriesFilters()},queryShopList:function(){var e=this;b["a"].get(f["o"].mainPage.shopList,{shopId:window.top.SHOP_ID||"",sourceType:""}).then((function(t){var a=t.shops;a.map((function(e){e.value=e.id,e.label=e.name})),a.unshift({value:"",label:"全部"}),e.dialogFilters[0].value=window.top.SHOP_ID||e.getUser.shop.id,e.$set(e.dialogFilters[0],"options",a)})).catch((function(e){console.log(e),console.log("code错误")}))},queryVehicles:function(e){var t=this;this.dialogLoading=!0,g["a"].queryVehicles("/admin/baseData/carType/list.jhtml",e,(function(e){t.tableData=e.carTypeList,t.$set(t.dialogPagination,"total",parseInt(e.total)),t.dialogLoading=!1}),(function(e){console.log(e),console.log("code错误"),t.dialogLoading=!1}))},querySeriesFilters:function(){var e=this;b["a"].get("/admin/baseData/baseData.jhtml",{type:"2",brandId:this.brandId,seriesId:this.seriesId,pageNumber:this.dialogPagination.currentPage,pageSize:this.dialogPagination.pageSize}).then((function(t){e.tableData=t.dataList,t.dataList.forEach((function(t){var a,i=Object(n["a"])(e.brandsData);try{for(i.s();!(a=i.n()).done;){var o=a.value;o.id===e.brandId&&(t.brandName=o.name)}}catch(l){i.e(l)}finally{i.f()}var r,s=Object(n["a"])(e.seriesData);try{for(s.s();!(r=s.n()).done;){var c=r.value;c.id===e.seriesId&&(t.seriesName=c.name)}}catch(l){s.e(l)}finally{s.f()}t.type=t.name})),e.$set(e.dialogPagination,"total",parseInt(t.total))})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)}))},clickHandler:function(e){this.showDialog=!0},confirmedHandler:function(e,t){this.showDialog=!1,this.selectionKeys=e,console.log("selectionKeys==="+e),console.log("selections=="+t[0].plateNumber),this.$emit("on-confirm",e,t[0])},getDialogQueryParams:function(){return{pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[2].value,shopId:this.dialogFilters[0].value||""}},openedHandler:function(){this.dialogPagination.currentPage=1,this.dialogFilters[2].value="",this.dialogFilters[1].value=[],this.dialogFilters[0].value=window.top.SHOP_ID||this.getUser.shop.id,this.getBrand(),this.queryVehicles(this.getDialogQueryParams())},dialogFilterDataChange:function(e){this.$set(this.dialogPagination,"currentPage",1),""===this.seriesId?this.queryVehicles(this.getDialogQueryParams()):this.querySeriesFilters()},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),""===this.seriesId?this.queryVehicles(this.getDialogQueryParams()):this.querySeriesFilters()},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),""===this.seriesId?this.queryVehicles(this.getDialogQueryParams()):this.querySeriesFilters()}}},I=y,w=Object(p["a"])(I,i,o,!1,null,null,null);t["a"]=w.exports},"7cde":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"commodity-mgmt"},[a("div",{staticClass:"toggle-btn",on:{click:e.isShow}},[e._v(" "+e._s(e.toggleRecommendTxt)+" "),a("div",{staticClass:"iconfont biz-icon-i-web-zd1",class:{"rotate-180":e.showRecommend}})]),a("biz-flex-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,pagination:e.pagination},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"selection-change":e.handleSelectionChange,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"sort-change":e.handleSortChange,"active-item-change":e.activeItemChange,"cascader-change":e.cascaderChange}},[a("el-table-column",{attrs:{prop:"shop.name",label:"商品","min-width":"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"product-info-content"},[t.row.image&&" "!==t.row.image?a("img",{attrs:{src:t.row.image,onerror:e.errorImg}}):a("img",{attrs:{src:"/resources/admin/images/default/product-default-100.png"}}),a("div",{staticClass:"wrapper"},[a("div",{staticClass:"titleClass",attrs:{title:t.row.name}},[e._v(e._s(t.row.sn))]),a("div",{staticClass:"overflow"},[e._v(e._s(t.row.name))]),a("div",{staticClass:"overflow"},[e._v(e._s(t.row.fullName&&-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:""))])])])])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"分类","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.categoryName)+" ")])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"销售价","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" ￥"+e._s(e.toPrice(t.row.price))+" ")])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"剩余库存/库存总数","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.availableStock)+"/"),a("span",{style:{color:e.stateColor(t.row)}},[e._v(e._s(t.row.stock))])])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"店铺","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.shop.name)+" ")])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"销量","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.sales)+" ")])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"状态","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(e.getStatus(t.row))+" ")])])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("biz-column-operation",{attrs:{row:t.row}},[e.canOffsale(t.row)&&e.hasAuthOff?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.soldout(t.row.id)}}},[e._v("下架")]):e._e(),e.canOnsale(t.row)&&e.hasAuthOn?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.putaway(t.row.id)}}},[e._v("上架")]):e._e(),e.canEdited(t.row)&&e.hasAuthDel?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.deleteRecommend(t.row.id)}}},[e._v("删除")]):e._e(),e.canSubmited(t.row)&&e.hasAuthEdit?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.auditTarget(t.row)}}},[e._v("提交")]):e._e(),e.canPassed(t.row)&&e.hasAuthEdit?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.audit(t.row,"1")}}},[e._v("通过")]):e._e(),e.canCancel(t.row)&&e.hasAuthEdit?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.audit(t.row,"0")}}},[e._v("取消")]):e._e(),e.canRevocationed(t.row)&&e.hasAuthEdit?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.recallProduct(t.row.id)}}},[e._v("撤回")]):e._e()],1)]}}])})],1),a("Commodity-popup",{attrs:{slot:"float",open:e.open,id:e.addId,isEdit:e.isEdit,baseInfo:e.rowBaseInfo,categoryName:e.categoryName,specName:e.specName,categoryType:e.categoryType},on:{close:function(t){e.open=!1,e.addId=""},operationSuccess:e.refresh,createdProductSuccess:e.createdProductSuccess},slot:"float"}),a("biz-popup-tabs",{attrs:{open:e.openimport},on:{close:function(t){e.openimport=!1}},model:{value:e.importtabName,callback:function(t){e.importtabName=t},expression:"importtabName"}},[a("el-tab-pane",{attrs:{label:"导入商品",name:"baseinfo"}},[a("ImportProduct",{ref:"openimport",attrs:{open:e.openimport,refreshSign:e.refreshSign},on:{operationSuccess:e.refresh,openPoup:e.openPoup,closePoup:e.closePoup}})],1)],1),a("biz-popup-tabs",{attrs:{open:e.createVehicle},on:{close:function(t){e.createVehicle=!1}},model:{value:e.createVehicleTabName,callback:function(t){e.createVehicleTabName=t},expression:"createVehicleTabName"}},[a("el-tab-pane",{attrs:{label:"创建整车",name:"createVehicle"}},[a("CreateVehicle",{attrs:{open:e.createVehicle},on:{operationSuccess:e.refresh}})],1)],1),a("biz-columns",{attrs:{visible:e.columnsSettingVisible,tableId:e.tableId},on:{"update:visible":function(t){e.columnsSettingVisible=t},update:e.getColumns}})],1)},o=[],n=(a("c740"),a("4160"),a("caad"),a("c975"),a("a15b"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("b680"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("2532"),a("5319"),a("1276"),a("159b"),a("b85c")),r=a("5530"),s=a("04d3"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"lead-base-info-i-product"},[a("div",{staticClass:"importFile",attrs:{slot:"top"},slot:"top"},[a("import-file",{directives:[{name:"show",rawName:"v-show",value:"文件导入"===e.showType,expression:"showType === '文件导入'"}],ref:"importFile",staticStyle:{"margin-left":"10px"},attrs:{tableData:e.importResult,importLoading:e.importLoading,total:e.total,disabled:e.disabled,count:e.count,percentage:e.percentage,stepkey:e.stepkey,action:"/admin/shopProduct/importProduct.jhtml",name:"uFile"},on:{clearTimeOut:e.clearTimeOut,restProcess:e.restProcess,"handle-import":e.handleImport}},[a("el-table-column",{attrs:{label:"编号",prop:"line",width:"50"}}),a("el-table-column",{attrs:{label:"消息",prop:"result"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"文件导入"===e.showType,expression:"showType === '文件导入'"}],staticClass:"downloadButton"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.downloadTemplate}},[e._v("模板下载")])],1),a("biz-save-button",{directives:[{name:"show",rawName:"v-show",value:"平台导入"===e.showType,expression:"showType === '平台导入'"}],attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"})],1),a("el-form",{ref:"form",attrs:{rules:e.rules,size:"small"}},[a("div",{staticClass:"radio"},[a("el-radio-group",{on:{change:e.handleShowTypeChange},model:{value:e.showType,callback:function(t){e.showType=t},expression:"showType"}},[a("el-radio",{attrs:{label:"文件导入"}},[e._v("从本地文件导入")]),a("el-radio",{attrs:{label:"平台导入"}},[e._v("从平台导入")])],1)],1),a("div",[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"平台导入"===e.showType,expression:"showType === '平台导入'"}]},[[a("div",{staticClass:"category-select"},[a("el-form",{attrs:{"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"分类：",prop:"topProductCategoryId"}},[a("el-select",{attrs:{placeholder:"请选择分类"},on:{change:e.topCategoryChange},model:{value:e.topProductCategoryId,callback:function(t){e.topProductCategoryId=t},expression:"topProductCategoryId"}},e._l(e.topCategoryOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{directives:[{name:"show",rawName:"v-show",value:0!==e.subCategoryOptions.length,expression:"subCategoryOptions.length !== 0"}],attrs:{placeholder:"请选择二级分类"},on:{change:e.subCategoryChange},model:{value:e.subProductCategoryId,callback:function(t){e.subProductCategoryId=t},expression:"subProductCategoryId"}},e._l(e.subCategoryOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e.show?a("el-form-item",{attrs:{label:"品牌："}},[a("el-select",{attrs:{placeholder:"请选择品牌",filterable:""},on:{change:e.getSeriesName},model:{value:e.brandId,callback:function(t){e.brandId=t},expression:"brandId"}},e._l(e.brandOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e.show?a("el-form-item",{attrs:{label:"系列："}},[a("el-checkbox-group",{model:{value:e.seriesId,callback:function(t){e.seriesId=t},expression:"seriesId"}},[a("div",{staticClass:"checkbox-group"},e._l(e.seriesOptions,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id},on:{change:e.conditionChange}},[a("div",{staticClass:"checkbox-group-item"},[e._v(" "+e._s(t.name)+" ")])])})),1)])],1):e._e(),e.show?a("el-form-item",{attrs:{label:"销售状态："}},[a("el-checkbox-group",{on:{change:e.conditionChange},model:{value:e.saleStates,callback:function(t){e.saleStates=t},expression:"saleStates"}},[a("div",{staticClass:"checkbox-group"},[a("el-checkbox",{attrs:{label:"1"}},[a("div",{staticClass:"checkbox-group-item"},[e._v(" 在售 ")])]),a("el-checkbox",{attrs:{label:"0"}},[a("div",{staticClass:"checkbox-group-item"},[e._v(" 停售 ")])])],1)])],1):e._e(),a("el-form-item",{attrs:{label:e.show?"车型":"商品"}},[a("biz-list",{ref:"table",attrs:{height:e.heightList,tableData:e.modeList},on:{handleSelectionChange:e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),a("el-table-column",{attrs:{prop:"name",label:"名称"}})],1)],1)],1)],1)]],2)],1)])],1)},l=[],d=(a("99af"),a("8330")),u=a("f36f"),p=a("ccf0"),h=a("11e9"),m=a("1ab1"),f=a("5118"),g={name:"CommodityMgmtBaseInfo",data:function(){return{heightList:"300",multipleSelection:[],modeList:[],operations:[{label:"导入",name:"save",type:"primary",disabled:!0,auth:["admin:product.edit"]}],rules:{topProductCategoryId:[{required:!0,message:"请选择分类",trigger:"blur"}]},allCategory:[],topCategoryOptions:[],subCategoryOptions:[],brandOptions:[],seriesOptions:[],showType:"文件导入",topProductCategoryId:"",subProductCategoryId:"",categoryType:"",brandId:"",seriesId:[],saleStates:[],importLoading:!1,importResult:[],disabled:!1,show:!1,total:0,count:0,t:"",percentage:0,stepkey:"",loading:!1}},props:{open:{type:Boolean,default:!1}},watch:{open:function(e){e?this.query():(this.allCategory=[],this.topProductCategoryId="",this.subProductCategoryId="",this.topCategoryOptions=[],this.subCategoryOptions=[],this.brandId="",this.brandOptions=[],this.seriesId=[],this.seriesOptions=[],this.importResult=[],this.successCount=0,this.failCount=0,this.modeList=[],this.show=!1,this.showType="文件导入")}},components:{BizGrid:u["a"],BizSaveButton:d["a"],ImportFile:p["b"],BizList:s["e"]},created:function(){this.handleImport()},computed:{},methods:{operate:function(e){this[e]()},downloadTemplate:function(){window.open("/upload/mode/V服爱车_商品导入模板.xlsx")},handleSelectionChange:function(e){this.multipleSelection=e},conditionChange:function(){var e=this,t=[];if(this.multipleSelection.map((function(e){t.push(e.id)})),console.log(123),0!==this.seriesId.length||"car"!==this.categoryType){var a={productCategoryId:""===this.subProductCategoryId?this.topProductCategoryId:this.subProductCategoryId,brandIds:this.brandId,seriesIds:this.seriesId.join("&seriesIds="),saleStates:this.saleStates.join("&saleStates=")},i=[];for(var o in a)i.push("".concat(o,"=").concat(a[o]));m["a"].get("/admin/shopProduct/queryPlatformImportInfo/v2.jhtml?"+i.join("&")).then((function(t){e.modeList=t.data})).catch((function(e){console.log(e),console.log("code错误")}))}else this.modeList=[]},handleShowTypeChange:function(e){this.operations[0].disabled="平台导入"!==e},clearTimeOut:function(){window.clearTimeout(this.t)},restProcess:function(){this.total=0,this.count=0,this.stepkey="",this.percentage=0,this.$emit("closePoup")},handleImport:function(){var e=this,t="/admin/shopProduct/importProgress.jhtml";m["a"].get(t,{}).then((function(t){t.data.total||(e.total=0,e.count=0,e.stepkey="",e.percentage=0),t.data.total&&(e.total=Number(t.data.total||0),e.count=Number(t.data.count||0),e.stepkey=t.data.remark,e.percentage=Number(t.data.rate),e.$refs.importFile.title=t.data.title),t.data&&t.data.rate&&"100"===t.data.rate?(e.clearTimeOut(),e.$refs.importFile.showCurrentInfo=!1,e.$refs.importFile.title="导入完成",t.data&&t.data.results&&t.data.results.length>0&&(e.importResult=t.data.results,e.$refs.importFile.uploadingVisible=!1,e.$refs.importFile.importingVisible=!0),e.disabled=!1):t.data&&t.data.rate&&"100"!==t.data.rate?(e.t&&e.clearTimeOut(),e.t=Object(f["setTimeout"])(e.handleImport,2e3),e.$refs.importFile.uploadingVisible=!0,e.$refs.importFile.showCurrentInfo=!0,e.disabled=!0):e.$refs.importFile.uploadingVisible=!1})).catch((function(e){console.log(e),console.log("code错误")}))},handleImportCar:function(){var e=this,t="/admin/shopProduct/importProgress.jhtml";m["a"].get(t,{type:"12"}).then((function(t){t.data.total||(e.total=0,e.count=0,e.stepkey="",e.percentage=0),t.data.total&&(e.total=Number(t.data.total||0),e.count=Number(t.data.count||0),e.stepkey=t.data.remark,e.percentage=Number(t.data.rate),e.$refs.importFile.title=t.data.title),t.data&&t.data.rate&&"100"===t.data.rate?(e.clearTimeOut(),e.$refs.importFile.showCurrentInfo=!1,e.$refs.importFile.title="导入完成",t.data&&t.data.results&&t.data.results.length>0&&(e.importResult=t.data.results,e.$refs.importFile.uploadingVisible=!1,e.$refs.importFile.importingVisible=!0),e.disabled=!1):t.data&&t.data.rate&&"100"!==t.data.rate?(e.t&&e.clearTimeOut(),e.t=Object(f["setTimeout"])(e.handleImportCar,2e3),e.$refs.importFile.uploadingVisible=!0,e.$refs.importFile.showCurrentInfo=!0,e.disabled=!0):(e.$refs.importFile.uploadingVisible=!1,e.$emit("openPoup"))})).catch((function(e){console.log(e),console.log("code错误")}))},getUploadProductFileParam:function(e){return{shopId:window.top.SHOP_ID||"",filePath:e}},query:function(){this.queryPlatformCategoryTree()},queryPlatformCategoryTree:function(){var e=this;this.allCategory=[],this.topProductCategoryId="",this.subProductCategoryId="",this.topCategoryOptions=[],this.subCategoryOptions=[],this.brandId="",this.brandOptions=[],this.seriesId=[],this.seriesOptions=[];var t={};h["a"].queryPlatformCategoryTree(t,(function(t){e.allCategory=t.platformCategoryTree,e.setTopCategoryOptions(),e.setSubCategoryOptions()}),(function(e){console.log(e)}))},setTopCategoryOptions:function(){var e=[];this.allCategory.forEach((function(t){t.topCategory&&e.push(t)})),this.topCategoryOptions=e},setSubCategoryOptions:function(){var e=this,t=[];""!==this.topProductCategoryId&&this.allCategory.forEach((function(a){a.parentId===e.topProductCategoryId&&t.push(a)})),this.subCategoryOptions=t},topCategoryChange:function(){this.setSubCategoryOptions(),this.subProductCategoryId="",this.getBrandName()},subCategoryChange:function(){this.getBrandName()},getBrandName:function(){var e=this;this.brandId="",this.brandOptions=[],this.seriesId=[],this.seriesOptions=[];var t={productCategoryId:""===this.subProductCategoryId?this.topProductCategoryId:this.subProductCategoryId};h["a"].queryPlatformImportInfo(t,(function(t){var a="";e.topCategoryOptions.map((function(t){t.id===e.topProductCategoryId&&(a=t.type)})),e.modeList=[],e.categoryType=a,"car"===a?(e.show=!0,e.brandOptions=t.data):(e.show=!1,e.conditionChange())}),(function(e){console.log(e)}))},getSeriesName:function(){var e=this;this.seriesId=[],this.seriesOptions=[],this.modeList=[];var t={productCategoryId:""===this.subProductCategoryId?this.topProductCategoryId:this.subProductCategoryId,brandIds:this.brandId};h["a"].queryPlatformImportInfo(t,(function(t){e.seriesOptions=t.data}),(function(e){console.log(e)}))},save:function(){var e=this,t=[];this.multipleSelection.map((function(e){t.push(e.id)}));var a={shopId:window.top.SHOP_ID||"",productCategoryId:""===this.subProductCategoryId?this.topProductCategoryId:this.subProductCategoryId,productIds:t};0!==t.length?(this.operations[0].disabled=!0,this.$emit("closePoup"),Object(f["setTimeout"])((function(){e.handleImportCar()}),200),m["a"].post("/admin/shopProduct/importPlatformProduct/v2.jhtml",a).then((function(t){e.$message({type:"success",message:"导入成功!"}),e.loading=!1,e.operations[0].disabled=!1,e.$emit("operationSuccess")})).catch((function(t){e.loading=!1,e.$refs.importFile.uploadingVisible=!1,e.operations[0].disabled=!1,console.log(t)}))):this.$message.warning("请选择待导入的车型或者商品")}}},b=g,v=(a("4b00"),a("2877")),y=Object(v["a"])(b,c,l,!1,null,null,null),I=y.exports,w=a("2f62"),C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"baseinfo"}},[a("BaseInfo",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,baseInfo:e.baseInfo,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess,createdProductSuccess:e.createdProductSuccess}})],1),e.id&&"0"===e.categoryType?a("el-tab-pane",{attrs:{label:"车辆识别码",name:"code"}},[a("vin-code",{attrs:{open:e.open,itemId:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection}})],1):e._e(),e.id&&"7"===e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"优惠券信息",name:"specification"}},[a("coupon-product",{attrs:{id:e.id,baseInfo:e.baseInfo}})],1):e._e(),e.id?a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("Detail",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection,categoryName:e.categoryName,baseInfo:e.baseInfo},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"参数",name:"parameter"}},[a("Parameter",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,baseInfo:e.baseInfo,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id?a("el-tab-pane",{attrs:{label:"图片",name:"pictureInfo"}},[a("PictureInfo",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,baseInfo:e.baseInfo,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"规格",name:"specification"}},[a("specification",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection,specName:e.specName,categoryName:e.categoryName},on:{operationSuccess:e.operationSuccess,close:e.close}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"VR",name:"vr"}},[a("vr-info",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,baseInfo:e.baseInfo,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType&&"整车"===e.categoryName?a("el-tab-pane",{attrs:{label:"商品亮点",name:"highLights"}},[a("high-lights",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection,categoryName:e.categoryName,baseInfo:e.baseInfo},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType&&"整车"===e.categoryName?a("el-tab-pane",{attrs:{label:"商品竞品",name:"competingProducts"}},[a("CompetingProducts",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection,categoryName:e.categoryName,baseInfo:e.baseInfo},on:{operationSuccess:e.operationSuccess}})],1):e._e()],1)},S=[],D=a("7132"),P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"add-product-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("div",{ref:"form",staticClass:"form-one"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"productDataForm",attrs:{"label-width":"150px",size:"small",model:e.productDataModel,rules:e.productDataRules,disabled:!e.isEdit,"inline-message":!0}},[a("el-form-item",{attrs:{label:"商品分类：",required:!0}},[a("el-cascader",{attrs:{options:e.categoryOptions,"change-on-select":"","show-all-levels":!1,disabled:!1===e.isCreated},on:{change:e.categoryChange},model:{value:e.productDataModel.categoryId,callback:function(t){e.$set(e.productDataModel,"categoryId",t)},expression:"productDataModel.categoryId"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!0===e.isCreated,expression:"isCreated === true"}],staticClass:"tooltip"},[e._v("商品创建后分类不可修改")])],1),a("product-category-select",{attrs:{initializing:e.initializing,refreshSign:e.refreshSign,brandId:e.productDataModel.brandId,categoryId:e.productDataModel.categoryId[e.productDataModel.categoryId.length-1],seriesId:e.productDataModel.seriesId,name:e.productDataModel.name},on:{"update:brandId":function(t){return e.$set(e.productDataModel,"brandId",t)},"update:brand-id":function(t){return e.$set(e.productDataModel,"brandId",t)},"update:seriesId":function(t){return e.$set(e.productDataModel,"seriesId",t)},"update:series-id":function(t){return e.$set(e.productDataModel,"seriesId",t)},"update:name":function(t){return e.$set(e.productDataModel,"name",t)}}}),a("el-form-item",{attrs:{label:"类型："}},[a("el-select",{attrs:{disabled:!1===e.isCreated,placeholder:"请选择商品类型"},on:{change:e.productTypeChange},model:{value:e.productDataModel.productType,callback:function(t){e.$set(e.productDataModel,"productType",t)},expression:"productDataModel.productType"}},e._l(e.productTypes,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:!0===e.isCreated,expression:"isCreated === true"}],staticClass:"tooltip"},[e._v("商品创建后类型不可修改")])],1),a("el-form-item",{attrs:{label:"编号："}},[a("el-input",{attrs:{placeholder:e.productDataModel.id?"请输入编号":"创建成功后自动生成",readonly:!0,disabled:!0},model:{value:e.productDataModel.sn,callback:function(t){e.$set(e.productDataModel,"sn",t)},expression:"productDataModel.sn"}})],1),a("el-form-item",{attrs:{label:"商品条码：",prop:"barCode"}},[a("el-input",{attrs:{placeholder:"请输入条码"},model:{value:e.productDataModel.barCode,callback:function(t){e.$set(e.productDataModel,"barCode",t)},expression:"productDataModel.barCode"}})],1),a("el-form-item",[a("span",{directives:[{name:"popover",rawName:"v-popover:codePop",arg:"codePop"}],attrs:{slot:"label"},slot:"label"},[e._v(" 关键词 "),a("i",{staticClass:"iconfont el-icon-question",staticStyle:{color:"#ff7300"}}),a("el-popover",{ref:"codePop",attrs:{placement:"left",width:"300",trigger:"hover"}},[a("div",[e._v("填写关键词后，客户可以根据关键词搜索到此商品。使用符合用户习惯的关键词可以有效提高商品被搜索到的概率。")])])],1),a("div",{staticClass:"item-content"},[a("div",{staticClass:"tag-list"},[a("div",{staticClass:"tag-group"},e._l(e.tagGroup,(function(t,i){return a("el-tag",{key:i,attrs:{closable:"",size:"mini"},on:{close:function(t){return e.removeTag(i)}}},[e._v(e._s(t)+" ")])})),1),a("div",{staticClass:"toggle-btn",on:{click:function(t){e.showRecommend=!e.showRecommend}}},[a("div",{staticClass:"iconfont biz-icon-i-web-zd1",class:{"rotate-180":e.showRecommend}}),e._v(" "+e._s(e.toggleRecommendTxt)+" ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showRecommend,expression:"showRecommend"}],staticClass:"recommend-group"},[e._l(e.recommendTagGroup,(function(t,i){return a("el-tag",{key:i,attrs:{type:"info",size:"mini"},on:{click:function(a){return e.addRecommendTag(t)}}},[e._v(" "+e._s(t)+" ")])})),e.recommendTagGroup&&!e.recommendTagGroup.length?a("span",{staticStyle:{color:"#bbbbbb"}},[e._v("暂无推荐")]):e._e()],2)]),a("div",{staticClass:"add-tag"},[a("el-input",{attrs:{maxlength:18,placeholder:"请输入自定义关键词"},model:{value:e.newTagName,callback:function(t){e.newTagName=t},expression:"newTagName"}}),a("el-button",{attrs:{type:"primary"},on:{click:e.addNewTag}},[e._v("添加")])],1)])]),e.showPriceRadio?a("el-form-item",{attrs:{label:"销售价："}},[a("el-radio",{attrs:{label:"false"},model:{value:e.productDataModel.isPriceNegotiable,callback:function(t){e.$set(e.productDataModel,"isPriceNegotiable",t)},expression:"productDataModel.isPriceNegotiable"}},[e._v("一口价")]),a("el-radio",{attrs:{label:"true"},model:{value:e.productDataModel.isPriceNegotiable,callback:function(t){e.$set(e.productDataModel,"isPriceNegotiable",t)},expression:"productDataModel.isPriceNegotiable"}},[e._v("价格面议")])],1):e._e(),e.isNeedToShowPrice?a("el-form-item",{attrs:{label:e.priceLabel,prop:"price"}},[a("el-input",{attrs:{placeholder:"请输入一口价"},model:{value:e.productDataModel.price,callback:function(t){e.$set(e.productDataModel,"price",t)},expression:"productDataModel.price"}})],1):e._e(),"true"===e.productDataModel.isPriceNegotiable?a("el-form-item",{attrs:{label:"价格提示语",prop:"priceDesp"}},[a("el-input",{attrs:{placeholder:"请输入价格提示语"},model:{value:e.productDataModel.priceDesp,callback:function(t){e.$set(e.productDataModel,"priceDesp",t)},expression:"productDataModel.priceDesp"}})],1):e._e(),a("el-form-item",{attrs:{label:"市场指导价：",prop:"marketPrice"}},[a("el-input",{attrs:{placeholder:"请输入市场指导价"},model:{value:e.productDataModel.marketPrice,callback:function(t){e.$set(e.productDataModel,"marketPrice",t)},expression:"productDataModel.marketPrice"}})],1),a("el-form-item",{attrs:{label:"成本价：",prop:"cost"}},[a("el-input",{attrs:{placeholder:"请输入成本价"},model:{value:e.productDataModel.cost,callback:function(t){e.$set(e.productDataModel,"cost",t)},expression:"productDataModel.cost"}})],1),a("el-form-item",{attrs:{label:"商品缩略图：",prop:"image"}},[a("BizAvatarUploaderNew",{model:{value:e.productDataModel.image,callback:function(t){e.$set(e.productDataModel,"image",t)},expression:"productDataModel.image"}})],1),a("el-form-item",{attrs:{label:"库存：",prop:"stock"}},[a("el-input",{attrs:{placeholder:"请输入..."},model:{value:e.productDataModel.stock,callback:function(t){e.$set(e.productDataModel,"stock",t)},expression:"productDataModel.stock"}})],1),a("el-form-item",{attrs:{label:"销量："}},[a("el-input",{attrs:{placeholder:"请输入销量",readonly:!0,disabled:!0},model:{value:e.productDataModel.sales,callback:function(t){e.$set(e.productDataModel,"sales",t)},expression:"productDataModel.sales"}})],1),e.isNeedToShowBeanPercent()&&"false"===e.productDataModel.isPriceNegotiable?a("el-form-item",{attrs:{prop:"beanPercent"}},[a("span",{directives:[{name:"popover",rawName:"v-popover:code1",arg:"code1"}],attrs:{slot:"label"},slot:"label"},[e._v(" V豆折扣上限(%)： "),a("i",{staticClass:"iconfont el-icon-question",staticStyle:{color:"#ff7300"}}),a("el-popover",{ref:"code1",attrs:{placement:"left",width:"300",trigger:"hover"}},[a("div",[e._v("购买时可以抵扣价格的比例，默认按会员卡制式中的设置比例抵扣，如本商品需特殊化可填写其对应的抵扣比例值。")])])],1),a("el-input",{attrs:{placeholder:"按会员奖励设置比例"},model:{value:e.productDataModel.beanPercent,callback:function(t){e.$set(e.productDataModel,"beanPercent",t)},expression:"productDataModel.beanPercent"}})],1):e._e(),"false"===e.productDataModel.isPriceNegotiable?a("el-form-item",{attrs:{prop:"giftPercent"}},[a("span",{directives:[{name:"popover",rawName:"v-popover:code2",arg:"code2"}],attrs:{slot:"label"},slot:"label"},[e._v(" V豆赠送上限(%)： "),a("i",{staticClass:"iconfont el-icon-question",staticStyle:{color:"#ff7300"}}),a("el-popover",{ref:"code2",attrs:{placement:"left",width:"300",trigger:"hover"}},[a("div",[e._v("购买时可以赠送等同价格比例的V豆，默认按会员卡制式中的设置赠送抵扣，如本商品需特殊化可填写其对应的赠送比例值。")])])],1),a("el-input",{attrs:{placeholder:"请输入..."},model:{value:e.productDataModel.giftPercent,callback:function(t){e.$set(e.productDataModel,"giftPercent",t)},expression:"productDataModel.giftPercent"}})],1):e._e(),e.isNeedToShowPaymentMethod&&"false"===e.productDataModel.isPriceNegotiable?a("el-form-item",{attrs:{label:"支付方式：",prop:"paymentMethodIds"}},[a("el-checkbox-group",{model:{value:e.productDataModel.paymentMethodIds,callback:function(t){e.$set(e.productDataModel,"paymentMethodIds",t)},expression:"productDataModel.paymentMethodIds"}},e._l(e.payOptions,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1):e._e(),"7"!==e.productDataModel.productType&&"false"===e.productDataModel.isPriceNegotiable?a("el-form-item",{attrs:{label:"配送方式：",prop:"shippingMethodIds"}},[a("el-checkbox-group",{staticClass:"shipping-method",on:{change:function(t){return e.isShowWeight()}},model:{value:e.shippingMethodIds,callback:function(t){e.shippingMethodIds=t},expression:"shippingMethodIds"}},e._l(e.shippingMethods,(function(t){return a("el-checkbox",{key:t.shopShippingMethod.id,attrs:{label:t.shopShippingMethod.id,disabled:e.isCarOrService&&"到店服务"!==t.shopShippingMethod.name}},[e._v(" "+e._s(t.shopShippingMethod.name))])})),1)],1):e._e(),e.showWeight?a("el-form-item",{attrs:{label:"商品重量：",prop:"weight"}},[a("el-input",{attrs:{placeholder:"默认0"},model:{value:e.productDataModel.weight,callback:function(t){e.$set(e.productDataModel,"weight",t)},expression:"productDataModel.weight"}},[a("template",{slot:"append"},[e._v("KG")])],2)],1):e._e(),e.showWeight?e._e():a("el-form-item",{attrs:{label:"商品重量：",prop:""}},[a("el-input",{attrs:{placeholder:"默认0"},model:{value:e.productDataModel.weight,callback:function(t){e.$set(e.productDataModel,"weight",t)},expression:"productDataModel.weight"}},[a("template",{slot:"append"},[e._v("KG")])],2)],1),a("el-form-item",[a("span",{directives:[{name:"popover",rawName:"v-popover:code3",arg:"code3"}],attrs:{slot:"label"},slot:"label"},[e._v(" 口碑： "),a("i",{staticClass:"iconfont el-icon-question",staticStyle:{color:"#ff7300"}}),a("el-popover",{ref:"code3",attrs:{placement:"left",width:"300",trigger:"hover"}},[a("div",[e._v("口碑词汇将在商品详细页评价处显示，建议使用用户感受类的词汇。")])])],1),e._l(e.productDataModel.reputations,(function(t){return a("el-tag",{key:t,attrs:{size:"small",closable:"","disable-transitions":!0,type:"warning"},on:{close:function(a){return e.handleClose(t)}}},[e._v(e._s(t))])})),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"请输入1-6字口碑词汇"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+添加")])],2),a("el-form-item",[a("span",{directives:[{name:"popover",rawName:"v-popover:code4",arg:"code4"}],attrs:{slot:"label"},slot:"label"},[e._v(" 营销标签 "),a("i",{staticClass:"iconfont el-icon-question",staticStyle:{color:"#ff7300"}}),a("el-popover",{ref:"code4",attrs:{placement:"left",width:"300",trigger:"hover"}},[a("div",[e._v("营销标签将在商品列表页展示，建议用商品参与的促销优惠等词汇。")])])],1),a("div",{staticClass:"item-content"},[a("div",{staticClass:"tag-list"},[a("div",{staticClass:"tag-group"},e._l(e.tags,(function(t,i){return a("el-tag",{key:i,attrs:{closable:"",size:"mini"},on:{close:function(a){return e.removeMarketTag(t.id)}}},[e._v(" "+e._s(t.name))])})),1),a("div",{staticClass:"toggle-btn",on:{click:function(t){e.showMarketRecommend=!e.showMarketRecommend}}},[a("div",{staticClass:"iconfont biz-icon-i-web-zd1",class:{"rotate-180":e.showMarketRecommend}}),e._v(" "+e._s(e.toggleMarketRecommendTxt)+" ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMarketRecommend,expression:"showMarketRecommend"}],staticClass:"recommend-group"},[e._l(e.recommendMarketTags.slice(0,10),(function(t){return a("el-tag",{key:t.id,attrs:{type:"info",size:"mini"},on:{click:function(a){return e.addRecommendMarketTag(t)}}},[e._v(e._s(t.name))])})),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.recommendMarketTags&&e.recommendMarketTags.length>10,expression:"recommendMarketTags&&recommendMarketTags.length > 10"}],staticStyle:{"background-color":"white",border:"none"},attrs:{type:"info",size:"mini"},on:{click:function(t){e.dialogVisibility=!0}}},[e._v(" 更多 "),a("i",{staticClass:"el-icon-d-arrow-right"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.recommendMarketTags&&!e.recommendMarketTags.length,expression:"recommendMarketTags&&!recommendMarketTags.length"}],staticStyle:{color:"#bbbbbb"}},[e._v("暂无推荐")])],2)]),a("div",{staticClass:"add-tag"},[a("el-input",{attrs:{maxlength:18,placeholder:"请输入自定义标签"},model:{value:e.newMarketTagName,callback:function(t){e.newMarketTagName=t},expression:"newMarketTagName"}}),a("el-button",{attrs:{type:"primary"},on:{click:e.addRecommendMarketTagByButton}},[e._v("添加")])],1)])]),a("el-form-item",{attrs:{label:"设置："}},[a("el-checkbox-group",{model:{value:e.checkedSet,callback:function(t){e.checkedSet=t},expression:"checkedSet"}},[a("el-checkbox",{attrs:{label:"是否置顶"}}),"false"===e.productDataModel.isPriceNegotiable?a("el-checkbox",{attrs:{label:"是否订金支付"}}):e._e()],1)],1)],1),e.isSubscriptionChecked()?a("el-form",{ref:"subscriptionForm",staticStyle:{width:"70%"},attrs:{"label-width":"150px ",size:"small",model:e.productDataModel,rules:e.subscriptionRules}},[a("el-form-item",{attrs:{label:"订金金额：",prop:"subscription"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入不大于销售价的数字"},model:{value:e.productDataModel.subscription,callback:function(t){e.$set(e.productDataModel,"subscription",t)},expression:"productDataModel.subscription"}})],1),a("el-form-item",{attrs:{label:"订金可退："}},[a("el-radio-group",{model:{value:e.productDataModel.isSubscriptionReturn,callback:function(t){e.$set(e.productDataModel,"isSubscriptionReturn",t)},expression:"productDataModel.isSubscriptionReturn"}},[a("el-radio",{attrs:{label:"true"}},[e._v("是")]),a("el-radio",{attrs:{label:"false"}},[e._v("否")])],1)],1)],1):e._e()],1),a("marketing-tag-dialog",{attrs:{visibility:e.dialogVisibility,tags:e.tags,recommendMarketTags:e.recommendMarketTags},on:{"update:visibility":function(t){e.dialogVisibility=t},"selected-tag":e.selectedTag}}),a("el-dialog",{attrs:{visible:e.previewDialogOpen,"append-to-body":"",open:e.previewDialogOpen,width:"420px"},on:{close:function(t){e.previewDialogOpen=!1}}},[a("iframe",{attrs:{src:"resources/admin/ecStatic/index.html?#/vshop/goods/"+e.productDataModel.id+"?shopId="+e.baseInfo.shopId,frameborder:"0",scrolling:"no",width:"375px",height:"567px"}})])],1)},k=[],M=(a("4de4"),a("fb6a"),a("6062"),a("3ca3"),a("498a"),a("ddb0"),a("96cf"),a("1da1")),x=a("2909"),T=a("392e"),V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-category-select"},[a("el-form",{attrs:{"label-width":"150px",size:"small"}},[a("el-form-item",{attrs:{label:"品牌："}},[a("el-select",{staticStyle:{width:"80%"},attrs:{value:e.brandId,placeholder:"请输入品牌"},on:{change:e.brandChange}},e._l(e.brandOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"系列："}},[a("el-select",{staticStyle:{width:"80%"},attrs:{value:e.seriesId,placeholder:"请输入系列"},on:{change:e.seriesChange}},e._l(e.seriesOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"名称：",required:!0}},[a("el-autocomplete",{attrs:{value:e.name,"fetch-suggestions":e.querySearchAsync,placeholder:"请输入名称"},on:{input:e.onInputName,select:e.selectName}})],1)],1)],1)},_=[],$=a("c596"),L={name:"ProductCategorySelect",data:function(){return{brandOptions:[],seriesOptions:[],restaurants:[]}},props:{initializing:{type:Boolean,default:!1},categoryId:{type:String,default:""},brandId:{type:String,default:""},seriesId:{type:String,default:""},name:{type:String,default:""}},computed:{},created:function(){},watch:{categoryId:function(e){e&&this.getBrands(),this.initializing||this.$emit("update:brandId","")},brandId:function(e){if(!e)return this.seriesOptions=[],void this.$emit("update:seriesId","");this.initializing||this.$emit("update:seriesId",""),this.getSeries()},seriesId:function(e){if(!e)return this.restaurants=[],void this.$emit("update:name","");this.initializing||this.$emit("update:name",""),this.getName()}},mounted:function(){},methods:{querySearchAsync:function(e,t){var a=this.restaurants,i=e?a.filter(this.createStateFilter(e)):a;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t(i)}),300*Math.random())},createStateFilter:function(e){return function(e){return!0}},getBrands:function(){var e=this;if(""!==this.categoryId){var t={categoryId:this.categoryId};m["a"].get($["g"].commodity.getBrands,t).then((function(t){e.brandOptions=t.brands}))}},getSeries:function(){var e=this;if(""!==this.brandId){var t={shopBrandId:this.brandId};m["a"].get($["g"].commodity.getSeries,t).then((function(t){e.seriesOptions=t.series}))}},getName:function(){var e=this;if(""!==this.seriesId){var t={shopBrandId:this.brandId,shopSeriesId:this.seriesId};m["a"].get($["g"].commodity.getName,t).then((function(t){e.restaurants=t.Type.map((function(e){return{value:e,id:e}}))}))}},categoryChange:function(e){this.$emit("update:categoryId",e)},brandChange:function(e){this.$emit("update:brandId",e)},seriesChange:function(e){this.$emit("update:seriesId",e)},onInputName:function(e){this.$emit("update:name",e)},selectName:function(e){this.$emit("update:name",e.value)}}},O=L,B=(a("843b"),Object(v["a"])(O,V,_,!1,null,null,null)),N=B.exports,z=a("c17f"),E=a("cc55"),j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"base-marketing-tag",attrs:{title:"选择标签",visible:e.dialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",{staticClass:"recommend-group"},e._l(e.recommendMarketTags,(function(t){return a("el-tag",{key:t.id,attrs:{type:"info",size:"mini"},on:{click:function(a){return e.addRecommendMarketTag(t)}}},[e._v(e._s(t.name))])})),1),a("div",{staticClass:"tag-group"},e._l(e.totalTags,(function(t){return a("el-tag",{key:t.id,attrs:{closable:"",size:"mini"},on:{close:function(a){return e.removeMarketTag(t.id)}}},[e._v(e._s(t.name))])})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)])},R=[],F={name:"BaseMarketingTag",components:{},props:{visibility:{require:!0,type:Boolean},tags:{require:!0,type:Array,default:function(){return[]}},recommendMarketTags:{require:!0,type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!1,tagsCopy:[],addTags:[]}},computed:{totalTags:function(){return this.tagsCopy.concat(this.addTags)}},watch:{visibility:function(e){this.dialogVisible=e,e&&(this.tagsCopy=this.tags.slice(0))}},created:function(){},methods:{addRecommendMarketTag:function(e){var t,a=Object(n["a"])(this.totalTags);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.name===e.name)return void this.$message.warning("该标签已存在，请重新选择")}}catch(o){a.e(o)}finally{a.f()}this.addTags.push(e)},removeMarketTag:function(e){var t=this.addTags.findIndex((function(t){return t.id===e}));-1!==t&&this.addTags.splice(t,1),t=this.tagsCopy.findIndex((function(t){return t.id===e})),-1!==t&&this.tagsCopy.splice(t,1)},close:function(){this.$emit("update:visibility",!1)},confirmed:function(){this.$emit("update:visibility",!1),this.$emit("selected-tag",this.totalTags)}}},q=F,A=(a("a513"),Object(v["a"])(q,j,R,!1,null,null,null)),G=A.exports,U=function e(t){var a,i=[],o=Object(n["a"])(t);try{for(o.s();!(a=o.n()).done;){var r=a.value,s={value:r.id,label:r.name};if(r.childrenProductCategoryDataList&&r.childrenProductCategoryDataList.length>0&&(s.children=e(r.childrenProductCategoryDataList)),r.children&&r.children.length>0){s.hasOwnProperty("children")||(s.children=[]);var c,l=K(r.childrenProductCategoryDataList),d=Object(n["a"])(l);try{for(d.s();!(c=d.n()).done;){var u=c.value;s.children.push(u)}}catch(p){d.e(p)}finally{d.f()}}i.push(s)}}catch(p){o.e(p)}finally{o.f()}return i},K=function(e){var t,a=[],i=Object(n["a"])(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;a.push({label:o.name,value:o.id})}}catch(r){i.e(r)}finally{i.f()}return a},H={name:"CommodityMgmtBaseInfo",data:function(){var e=this,t=function(t,a,i){e.productDataModel.categoryId&&e.productDataModel.categoryId.length>0?i():i(new Error("请选择分类"))},a=function(t,a,i){e.productDataModel.price&&Number(e.productDataModel.price)>=0?i():i(new Error("销售价必须为数字值"))},i=function(t,a,i){e.productDataModel.marketPrice,Number(e.productDataModel.marketPrice)>=0?i():i(new Error("市场指导价必须为数字值"))},o=function(t,a,i){e.productDataModel.cost,Number(e.productDataModel.cost)>=0?i():i(new Error("成本价必须为数字值"))},n=function(t,a,i){e.productDataModel.beanPercent,Number(e.productDataModel.beanPercent)>=0?(Number(e.productDataModel.beanPercent)>100&&i(new Error("V豆折扣上限(%)不能超过100")),i()):i(new Error("V豆折扣上限(%)必须为数字值"))},r=function(t,a,i){""===e.productDataModel.giftPercent&&(e.productDataModel.giftPercent=0),Number(e.productDataModel.giftPercent)>=0?(Number(e.productDataModel.giftPercent)>100&&i(new Error("V豆赠送上限(%)不能超过100")),i()):i(new Error("V豆赠送上限(%)必须为数字值"))},s=function(t,a,i){""===e.productDataModel.weight&&(e.productDataModel.weight=0),Number(e.productDataModel.weight)>=0?e.productDataModel.weight&&-1!==e.productDataModel.weight.indexOf(".")&&e.productDataModel.weight.split(".")[1].length>2?i(new Error("只允许输入到小数后两位")):i():i(new Error("重量必须为数字值"))},c=function(t,a,i){"undefined"!==typeof e.productDataModel.image?(console.log(e.productDataModel.image)," "!==e.productDataModel.image?i():i(new Error("缩略图必须上传"))):i(new Error("缩略图必须上传"))},l=function(t,a,i){console.log(e.productDataModel.stock),""!==e.productDataModel.stock&&Number(e.productDataModel.stock)>=0&&-1===e.productDataModel.stock.indexOf(".")?i():i(new Error("库存必须为整数值"))},d=function(t,a,i){""!==e.productDataModel.subscription&&Number(e.productDataModel.subscription)>0?(Number(e.productDataModel.subscription)>=Number(e.productDataModel.price)&&i(new Error("请输入不大于销售价的数字")),i()):i(new Error("订金金额必须为大于0数值"))},u=function(t,a,i){"2"===e.productDataModel.productType||"7"===e.productDataModel.productType||e.productDataModel.paymentMethodIds&&e.productDataModel.paymentMethodIds.length>0?i():i(new Error("请至少选择一种支付方式"))},p=function(t,a,i){"7"===e.productDataModel.productType||e.shippingMethodIds.length>0?i():(e.$message.warning("请至少选择一种配送方式"),i(new Error("请至少选择一种配送方式")))};return{dialogVisibility:!1,showWeight:!0,newMarketTagName:"",tags:[],recommendMarketTags:[],showMarketRecommend:!1,tagGroup:[],showRecommend:!1,previewDialogOpen:!1,recommendTagGroup:[],recommendMarketTagId:"",newTagName:"",operations:[{label:"保存",name:"save",type:"primary",disabled:!1,auth:["admin:product.edit"]},{label:"预览",name:"preview",type:"primary",class:"hidden"}],productDataRules:{categoryId:[{required:!0,trigger:"blur",validator:t}],price:[{required:!0,trigger:"blur",validator:a}],priceDesp:[{required:!0,trigger:"blur",message:"请输入价格提示语（15字以内）",max:15}],marketPrice:[{required:!1,trigger:"blur",validator:i}],cost:[{required:!1,trigger:"blur",validator:o}],beanPercent:[{required:!1,trigger:"blur",validator:n}],giftPercent:[{required:!1,trigger:"blur",validator:r}],weight:[{required:!0,trigger:"blur",validator:s}],image:[{required:!1,trigger:"blur",validator:c}],barCode:[{required:!1,trigger:"blur"}],stock:[{required:!0,trigger:"blur",validator:l}],paymentMethodIds:[{required:!0,trigger:"blur",validator:u}],shippingMethodIds:[{required:!0,trigger:"blur",validator:p}]},subscriptionRules:{subscription:[{required:!0,trigger:"blur",validator:d}]},isCreated:"true",defaultImg:"/resources/admin/images/default/product-default.png",productDataModel:this.getDefaultProductDataModel(),categoryOptions:[],productCategoryManage:[],productTypes:[],payOptions:[],shippingMethods:[],shippingMethodIds:[],setOptions:["是否置顶","是否订金支付"],checkedSet:[],inputVisible:!1,inputValue:"",loading:!1,refreshSign:!0,initializing:!1}},components:{MarketingTagDialog:G,BizGrid:u["a"],BizSaveButton:d["a"],ProductCategorySelect:N,BizAvatarUploaderNew:z["b"]},props:{id:{type:String,default:""},tabSelection:{type:String},baseInfo:{type:Object},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{open:function(e){this.$refs.productDataForm.clearValidate(),e?""!==this.id?(this.operations[1].class="show",this.isCreated=!1):(this.operations[1].class="hidden",this.isCreated=!0,this.refresh()):(this.isCreated=!0,this.productTypes=[],this.payOptions=[],this.shippingMethods=[],this.checkedSet=[],this.recommendTagGroup=[])},id:function(e,t){var a=this;e?(this.$refs.form.scrollTop=0,!0===this.open&&"baseinfo"===this.tabSelection&&(this.getProductCategoryList(this.baseInfo.shopId),this.$nextTick((function(){a.refresh()})))):this.productDataModel=this.getDefaultProductDataModel()}},created:function(){this.getDefaultImg(),this.getProductCategoryList()},computed:{toggleRecommendTxt:function(){var e=this.showRecommend;return e?"收起推荐":"展开推荐"},toggleMarketRecommendTxt:function(){var e=this.showMarketRecommend;return e?"收起推荐":"展开推荐"},isNeedToShowPrice:function(){return("0"===this.productDataModel.productType||"1"===this.productDataModel.productType||"7"===this.productDataModel.productType)&&"false"===this.productDataModel.isPriceNegotiable},isNeedToShowPaymentMethod:function(){return"2"!==this.productDataModel.productType&&"7"!==this.productDataModel.productType},isNeedToShowTestDrive:function(){var e=this,t=!1;return this.productCategoryManage.map((function(a){console.log(a.name),a.id===e.productDataModel.categoryId[e.productDataModel.categoryId.length-1]&&"car"===a.type?t=!0:a.childrenProductCategoryDataList&&a.childrenProductCategoryDataList.map((function(a){a.id===e.productDataModel.categoryId[e.productDataModel.categoryId.length-1]&&"car"===a.type&&(t=!0)}))})),t},isCarOrService:function(){var e=this,t=!1;return this.productCategoryManage.map((function(a){console.log(a.name),a.id!==e.productDataModel.categoryId[e.productDataModel.categoryId.length-1]||"car"!==a.type&&"carService"!==a.type?a.childrenProductCategoryDataList&&a.childrenProductCategoryDataList.map((function(a){a.id!==e.productDataModel.categoryId[e.productDataModel.categoryId.length-1]||"car"!==a.type&&"carService"!==a.type||(t=!0)})):t=!0})),t},priceLabel:function(){return"0"===this.productDataModel.productType?"一口价：":"销售价："},showPriceRadio:function(){return"0"===this.productDataModel.productType}},methods:{operate:function(e){this[e]()},isShowWeight:function(){var e=this;this.showWeight=!1,this.shippingMethods.map((function(t){!e.shippingMethodIds.includes(t.shopShippingMethod.id)||"物流配送"!==t.shopShippingMethod.name&&"快递配送"!==t.shopShippingMethod.name&&"零担物流"!==t.shopShippingMethod.name||(e.showWeight=!0)}))},preview:function(){this.previewDialogOpen=!0},addRecommendTag:function(e){this.tagGroup.includes(e)?this.$message.warning("该标签已存在，请重新添加"):this.tagGroup=Object(x["a"])(new Set(this.tagGroup.concat(e)))},addNewTag:function(){var e=String(this.newTagName).trim();e&&(this.tagGroup.includes(e)?this.$message.warning("该标签已存在，请重新添加"):this.tagGroup=Object(x["a"])(new Set(this.tagGroup.concat(e))),this.newTagName="")},removeTag:function(e){this.tagGroup=this.tagGroup.slice(0,e).concat(this.tagGroup.slice(e+1)),console.log("tagGroup: ",e,this.tagGroup)},getRecommendTag:function(){var e=this,t="/admin/common/keywords.jhtml",a=this.productDataModel.name,i={content:a};m["a"].get(t,i).then((function(t){e.recommendTagGroup=Object(x["a"])(new Set(t.keywords))})).catch((function(e){console.log("ERR_GET_RECOMMEND_TAGS: ",e)}))},categoryChange:function(e){console.log(this.productDataModel.categoryId)},getDefaultImg:function(){var e=this,t={type:"displaySetting"};m["a"].get("/admin/settings/settings.jhtml",t).then((function(t){t.settingList.defaultThumbnailProductImage&&(e.defaultImg=t.settingList.defaultThumbnailProductImage)})).catch((function(t){console.log(t),console.log("code错误"),e.$message.warning(t.errorMessage)}))},handleClose:function(e){this.productDataModel.reputations.splice(this.productDataModel.reputations.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){if(this.inputValue.length>6)return this.$message.warning("请输入1-6字口碑词汇"),!1;this.inputVisible=!1,this.inputValue&&(this.productDataModel.reputations.push(this.inputValue),this.inputValue="")},getDefaultProductDataModel:function(){return{shopId:window.top.SHOP_ID||"",id:"",sn:"",categoryId:[],brandId:"",seriesId:"",name:"",typeName:"",image:this.defaultImg,price:"",isPriceNegotiable:"false",cost:"",marketPrice:"",sales:"",stock:"0",isSupportTestDrive:"0",isList:"false",isTop:"false",priceDesp:"价格区间",isSubscription:"false",subscription:"",isSubscriptionReturn:"true",reputations:[],paymentMethodIds:[],productType:"0",bean:"",beanPercent:"",giftPercent:"",weight:"0",wholesalePrice:""}},getSaveProductDataModel:function(){var e=this,t=[];if("2"===this.productDataModel.productType){var a,i=Object(n["a"])(this.payOptions);try{for(i.s();!(a=i.n()).done;){var o=a.value;t.push(o.id)}}catch(p){i.e(p)}finally{i.f()}}else{var r,s=Object(n["a"])(this.productDataModel.paymentMethodIds);try{for(s.s();!(r=s.n()).done;){var c=r.value;t.push(c)}}catch(p){s.e(p)}finally{s.f()}}this.productCategoryManage.map((function(t){console.log(t.name),t.id!==e.productDataModel.categoryId[e.productDataModel.categoryId.length-1]||"car"!==t.type&&"carService"!==t.type?t.childrenProductCategoryDataList&&t.childrenProductCategoryDataList.map((function(t){t.id!==e.productDataModel.categoryId[e.productDataModel.categoryId.length-1]||"car"!==t.type&&"carService"!==t.type||e.shippingMethods.map((function(t){"到店服务"===t.shopShippingMethod.name&&(e.shippingMethodIds=[t.shopShippingMethod.id])}))})):e.shippingMethods.map((function(t){"到店服务"===t.shopShippingMethod.name&&(e.shippingMethodIds=[t.shopShippingMethod.id])}))})),console.log(this.shippingMethodIds);var l,d=Object(n["a"])(this.shippingMethods);try{for(d.s();!(l=d.n()).done;){var u=l.value;u.productValid="0",-1!==this.shippingMethodIds.indexOf(u.shopShippingMethod.id)&&(u.productValid="1")}}catch(p){d.e(p)}finally{d.f()}return{shopId:this.productDataModel.shopId,id:this.productDataModel.id,sn:this.productDataModel.sn,categoryId:this.productDataModel.categoryId[this.productDataModel.categoryId.length-1],brandId:this.productDataModel.brandId,seriesId:this.productDataModel.seriesId,name:this.productDataModel.name,image:this.productDataModel.image,price:this.productDataModel.price||"0",priceDesp:this.productDataModel.priceDesp,cost:this.productDataModel.cost,marketPrice:this.productDataModel.marketPrice,sales:this.productDataModel.sales,stock:this.productDataModel.stock,isPriceNegotiable:this.productDataModel.isPriceNegotiable,isList:String(this.isListChecked()),isTop:String(this.isTopChecked()),isSubscription:String(this.isSubscriptionChecked()),subscription:this.productDataModel.subscription,isSubscriptionReturn:this.productDataModel.isSubscriptionReturn,reputations:this.productDataModel.reputations,paymentMethodIds:t,shippingMethods:this.shippingMethods,productType:this.productDataModel.productType,bean:this.productDataModel.bean,beanPercent:this.productDataModel.beanPercent,giftPercent:this.productDataModel.giftPercent,weight:this.productDataModel.weight,keyword:this.tagGroup,tags:this.tags,barCode:this.productDataModel.barCode,vin:this.productDataModel.vin,wholesalePrice:this.productDataModel.wholesalePrice}},handleUploadSuccess:function(e){console.log(e),this.productDataModel.image=e},isListChecked:function(){var e,t=Object(n["a"])(this.checkedSet);try{for(t.s();!(e=t.n()).done;){var a=e.value;if("是否列出"===a)return!0}}catch(i){t.e(i)}finally{t.f()}return!1},isTopChecked:function(){var e,t=Object(n["a"])(this.checkedSet);try{for(t.s();!(e=t.n()).done;){var a=e.value;if("是否置顶"===a)return!0}}catch(i){t.e(i)}finally{t.f()}return!1},isSubscriptionChecked:function(){var e,t=Object(n["a"])(this.checkedSet);try{for(t.s();!(e=t.n()).done;){var a=e.value;if("是否订金支付"===a)return!0}}catch(i){t.e(i)}finally{t.f()}return!1},isNeedToShowBeanPercent:function(){return"0"===this.productDataModel.productType||"7"===this.productDataModel.productType},getParentCategory:function(e,t){var a=this;this.productDataModel.categoryId=[],e.forEach((function(e,i){if(e.value===t)return a.productDataModel.categoryId.unshift(e.value),!1;e.children&&e.children.forEach((function(i){if(i.value===t)return a.productDataModel.categoryId.unshift(i.value),a.productDataModel.categoryId.unshift(e.value),console.log(a.productDataModel.categoryId),!1;i.children&&i.children.forEach((function(o){if(o.value===t)return a.productDataModel.categoryId.unshift(o.value),a.productDataModel.categoryId.unshift(i.value),a.productDataModel.categoryId.unshift(e.value),!1;o.children&&o.children.forEach((function(n){if(n.value===t)return a.productDataModel.categoryId.unshift(n.value),a.productDataModel.categoryId.unshift(o.value),a.productDataModel.categoryId.unshift(i.value),a.productDataModel.categoryId.unshift(e.value),!1}))}))}))}))},refresh:function(){var e=this;this.initializing=!0,this.loading=!0;var t={id:this.id,shopId:window.top.SHOP_ID||""};this.getRecommendMarketTags(),T["a"].queryProductBasicInfo(t,(function(t){e.tagGroup=t.productBasicInfoData?t.productBasicInfoData.keyword:[],t.productBasicInfoData?e.tags=t.productBasicInfoData.tags||[]:e.tags=[],e.tagGroup&&e.tagGroup.length?e.showRecommend=!1:e.showRecommend=!0,e.tags&&e.tags.length>0?e.showMarketRecommend=!1:e.showMarketRecommend=!0,e.productTypes=t.productTypes,e.payOptions=t.paymentMethods,e.shippingMethods=t.shippingMethods,e.shippingMethodIds=[];var a,i=Object(n["a"])(e.shippingMethods);try{for(i.s();!(a=i.n()).done;){var o=a.value;"1"===o.productValid&&e.shippingMethodIds.push(o.shopShippingMethod.id)}}catch(d){i.e(d)}finally{i.f()}if(e.refreshSign=!e.refreshSign,e.id)e.productDataModel=e.convert2ProductDataModel(t.productBasicInfoData),e.getParentCategory(e.categoryOptions,e.productDataModel.categoryId[0]),e.getRecommendTag();else{e.productDataModel.image=e.defaultImg;var r,s=Object(n["a"])(e.payOptions);try{for(s.s();!(r=s.n()).done;){var c=r.value;e.productDataModel.paymentMethodIds.push(c.id)}}catch(d){s.e(d)}finally{s.f()}}var l=[];t.productBasicInfoData&&("true"===t.productBasicInfoData.isList&&l.push("是否列出"),"true"===t.productBasicInfoData.isTop&&l.push("是否置顶"),"true"===t.productBasicInfoData.isSubscription&&l.push("是否订金支付")),e.checkedSet=l,e.$nextTick((function(){e.initializing=!1,e.loading=!1,e.isShowWeight()}))}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品基本信息失败",e.id)}))},getRecommendMarketTags:function(){var e=this,t={isIncludeParent:"1",isIncludeTag:"1",shopId:window.top.SHOP_ID||"",categoryType:"商品/商品营销"};m["a"].get("/admin/tag/storeTagcategories.jhtml",t).then((function(t){e.recommendMarketTags=t.content[0].tags||[],e.recommendMarketTagId=t.content[0].id}))},addRecommendMarketTag:function(e){if(this.recommendMarketTagId){e=e.id?e:{name:this.newMarketTagName,id:"temp"+Math.random().toString(36).substr(-10)};var t,a=Object(n["a"])(this.tags);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.name===e.name)return void this.$message.warning("该标签已存在，请重新添加")}}catch(o){a.e(o)}finally{a.f()}this.tags.push(e),this.newMarketTagName=""}else this.$message.warning("请新建营销标签")},addRecommendMarketTagByButton:function(e){if(""!==this.newMarketTagName){e=e.id?e:{name:this.newMarketTagName,id:"temp"+Math.random().toString(36).substr(-10)};var t,a=Object(n["a"])(this.tags);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.name===e.name)return void this.$message.warning("该标签已存在，请重新添加")}}catch(o){a.e(o)}finally{a.f()}this.tags.push(e),this.newMarketTagName=""}else this.$message.warning("请输入自定义标签")},removeMarketTag:function(e){for(var t=0;t<this.tags.length;t++){var a=this.tags[t];if(a.id===e)break}this.tags=this.tags.slice(0,t).concat(this.tags.slice(t+1))},saveRecommendMarketTags:function(){var e,t=this.tags.filter((function(e){return-1!==e.id.indexOf("temp")})),a=[],i=Object(n["a"])(t);try{for(i.s();!(e=i.n()).done;){var o=e.value,r={name:o.name,type:"0",description:"",hierarchy:"1",shopId:window.top.SHOP_ID||"",tagCategory:{id:this.recommendMarketTagId}};a.push(m["a"].post($["g"].shopRate.TagGroupTags_tag,r))}}catch(s){i.e(s)}finally{i.f()}return Promise.all(a)},selectedTag:function(e){this.tags=e},convert2ProductDataModel:function(e){return{shopId:e.shopId,id:e.id,sn:e.sn,categoryId:[e.categoryId],brandId:e.brandId,seriesId:e.seriesId,name:e.name,image:e.image,price:e.price,priceDesp:e.priceDesp,cost:e.cost,marketPrice:e.marketPrice,sales:e.sales,stock:e.stock,isList:e.isList,isTop:e.isTop,isSubscription:e.isSubscription,subscription:e.subscription,isSubscriptionReturn:e.isSubscriptionReturn||"true",reputations:e.reputations,paymentMethodIds:e.paymentMethodIds,productType:e.productType,bean:e.bean,beanPercent:e.beanPercent,giftPercent:e.giftPercent,isPriceNegotiable:e.isPriceNegotiable,weight:e.weight||0,barCode:e.barCode,vin:e.vin,wholesalePrice:e.wholesalePrice}},save:function(){var e=this;return Object(M["a"])(regeneratorRuntime.mark((function t(){var a,i,o,r,s,c,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.productDataModel.name){t.next=3;break}return e.$message.warning("商品名称不能为空"),t.abrupt("return");case 3:if(""!==e.productDataModel.categoryId[0]){t.next=6;break}return e.$message.warning("商品分类不能为空"),t.abrupt("return");case 6:return t.next=8,e.saveRecommendMarketTags();case 8:a=t.sent,i=e.tags.filter((function(e){return-1!==e.id.indexOf("temp")})),o=Object(n["a"])(i);try{for(o.s();!(r=o.n()).done;){s=r.value,c=Object(n["a"])(a);try{for(c.s();!(l=c.n()).done;)d=l.value,d.data.name===s.name&&(s.id=d.data.id.toString())}catch(u){c.e(u)}finally{c.f()}}}catch(u){o.e(u)}finally{o.f()}e.$refs.productDataForm.validate((function(t){if(!t)return!1;e.isSubscriptionChecked()?e.$refs.subscriptionForm.validate((function(t){if(!t)return!1;e.isCreated?e.createProduct():e.updateProduct()})):e.isCreated?e.createProduct():e.updateProduct()}));case 13:case"end":return t.stop()}}),t)})))()},createProduct:function(){var e=this,t=this.getSaveProductDataModel(),a="7"===this.productDataModel.productType?"creatBenefitsBasicInfo":"creatProductBasicInfo";T["a"][a](t,(function(t){e.$message.success("添加商品基本信息成功"),e.id=t.id,e.isCreated=!1,e.refresh(),e.$emit("operationSuccess"),e.$emit("createdProductSuccess",t.id,e.productDataModel.productType)}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("添加商品基本信息失败",e.id)}))},updateProduct:function(){var e=this,t=this.getSaveProductDataModel();T["a"].updateProductBasicInfo(t,(function(t){e.refresh(),e.$message.success("更新商品基本信息成功"),e.$emit("operationSuccess")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("更新商品基本信息失败",e.id)}))},productTypeChange:function(e){if("7"===e)this.shippingMethodIds=[],this.productDataModel.paymentMethodIds=[];else{var t,a=Object(n["a"])(this.payOptions);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.productDataModel.paymentMethodIds.push(i.id)}}catch(c){a.e(c)}finally{a.f()}var o,r=Object(n["a"])(this.shippingMethods);try{for(r.s();!(o=r.n()).done;){var s=o.value;this.shippingMethodIds.push(s.shopShippingMethod.id)}}catch(c){r.e(c)}finally{r.f()}}"1"!==e&&(this.productDataModel.isPriceNegotiable="false")},getProductCategoryList:function(e){var t=this,a={shopId:e||window.top.SHOP_ID||"",pageNumber:1,pageSize:1e3};E["a"].getProductCategoryList(a,(function(e){t.productCategoryManage=e.ProductCategoryManage,t.categoryOptions=U(e.ProductCategoryManage),t.loading=!1}),(function(e){console.log(e),t.$message.warning(e.errorMessage),t.loading=!1}))}}},W=H,Q=(a("207f"),Object(v["a"])(W,P,k,!1,null,null,null)),J=Q.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"propetry-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px",size:"small",disabled:!e.isEdit}},[a("el-form-item",{attrs:{label:"商品介绍"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"450px"},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1),a("el-form-item",{attrs:{label:"购买须知"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"450px"},model:{value:e.form.notice,callback:function(t){e.$set(e.form,"notice",t)},expression:"form.notice"}})],1),a("el-form-item",{attrs:{label:"产品售后"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"450px"},model:{value:e.form.afterSale,callback:function(t){e.$set(e.form,"afterSale",t)},expression:"form.afterSale"}})],1),a("el-form-item",{attrs:{label:"语音播报介绍","label-width":"100px"}}),a("div",{staticClass:"y-editor"},[a("el-input",{attrs:{type:"textarea",maxlength:"200",autosize:{minRows:5,maxRows:8},width:"418px"},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1)],1),a("store-vehicle-picker",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"vehiclePicker",on:{"on-confirm":e.handleConfirm}}),a("el-dialog",{attrs:{visible:e.previewDialogOpen,"append-to-body":"",open:e.previewDialogOpen,width:"420px"},on:{close:function(t){e.previewDialogOpen=!1}}},[a("iframe",{attrs:{src:"resources/admin/ecStatic/index.html?#/vshop/goods/"+e.id+"?shopId="+e.baseInfo.shopId,frameborder:"0",scrolling:"no",width:"375px",height:"567px"}})])],1)},Z=[],X=(a("9911"),a("40ae")),ee=a("7777"),te={name:"CommodityMgmtBaseInfo",data:function(){var e=this;return{isCreated:!1,dialogVisible:!1,isCompeting:!1,previewDialogOpen:!1,checked:!1,radioValue:"1",checkedValue:[],options:[],fileList:[],name:"",title:"添加商品亮点",isEditCompetitor:!1,competingId:"",editId:"",lightPoints:[],competitorList:[],rules:{name:[{required:!0,trigger:"blur",validator:function(t,a,i){e.name?i():i(new Error("请选择竞品"))}}],options:[{required:!0,trigger:"blur",validator:function(t,a,i){e.tag.name?i():e.isCompeting?i(new Error("请输入关键词")):i(new Error("请输入亮点标签"))}}],checkpass:[{required:!0,trigger:"blur",validator:function(t,a,i){e.checkedValue.length&&e.checkedValue.length>0?i():e.isCompeting?i(new Error("请选择对比资源")):i(new Error("请选择亮点资源"))}}]},resources:["音频","视频","超链接","文本","图片"],operations:[{label:"保存",name:"update",type:"primary",auth:["admin:product.edit"]},{label:"预览",name:"preview",type:"primary",class:"show"}],tag:{id:"",productId:"",name:"",audio:"",video:"",audios:[],videos:[],text:"",link:"",picture:[],type:"0"},form:{introduction:"",notice:"",afterSale:"",memo:"",files:"",fileList:[]}}},props:{id:{type:String},categoryName:{type:String},tabSelection:{type:String},baseInfo:{type:Object},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"detail"===e&&""!==this.id&&(this.refresh(),this.tagList(),this.getCompetitorList())},open:function(e){e||(this.form.introduction="",this.form.notice="",this.form.afterSale="",this.form.memo="")}},components:{BizSaveButton:d["a"],BizGrid:u["a"],BizEditor:X["a"],StoreVehiclePicker:ee["a"]},created:function(){},computed:{},methods:{checkVideo:function(e){this.$message.warning(e)},preview:function(){this.previewDialogOpen=!0},checkedValueChange:function(){console.log("checkedValueChange"),this.checkedValue.includes("音频")||this.$set(this.tag,"audios",[]),this.checkedValue.includes("文本")||this.$set(this.tag,"text",""),this.checkedValue.includes("图片")||this.$set(this.tag,"picture",[])},defaultModel:function(){return{id:"",productId:"",name:"",audio:"",video:"",audios:[],videos:[],text:"",link:"",picture:[],type:"0"}},operate:function(e){this[e]()},addLigntPoiont:function(){this.isEditCompetitor=!1,this.title="添加商品亮点",this.isCompeting=!1,this.tag=this.defaultModel(),this.options=[],this.fileList=[],this.checkedValue=[],this.dialogVisible=!0},onSubmit:function(){console.log("submit!")},selectCar:function(){console.log("showDialog true"),this.$refs.vehiclePicker.showDialog=!0},handleConfirm:function(e,t){console.log("showDialog false"),this.$refs.vehiclePicker.showDialog=!1,this.name=t.seriesName+t.type,this.competingId=t.id,this.$refs.form.clearValidate()},editHandler:function(e){var t=this;this.isEditCompetitor=!1,this.isCompeting=!1,this.title="编辑商品亮点",m["a"].get("/admin/productLabel/productLabel.jhtml",{id:e.id}).then((function(e){t.checkedValue=[],t.dialogVisible=!0,t.tag=Object.assign(t.defaultModel(),e.data),t.options=[{content:t.tag.name}],e.data.audio&&(t.tag.audios=[e.data.audio],t.fileList=[{name:e.data.audio,url:e.data.audio}]),e.data.video&&(t.tag.videos=[e.data.video]),e.data.link&&t.checkedValue.push("超链接"),e.data.picture.length>0&&t.checkedValue.push("图片"),e.data.text&&t.checkedValue.push("文本"),e.data.video&&t.checkedValue.push("视频"),e.data.audio&&t.checkedValue.push("音频")})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},deleteHandler:function(e){var t=this;m["a"].delete("/admin/productLabel/productLabel.jhtml",{ids:[e.id]}).then((function(e){t.$message.success("删除成功"),t.tagList(),t.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},editCompetitor:function(e){var t=this;this.isEditCompetitor=!0,this.isCompeting=!0,this.title="添加竞品关键词",m["a"].get("/admin/productCompeting/productCompeting.jhtml",{id:e.id}).then((function(e){t.dialogVisible=!0,t.name=e.data.name,t.competingId=e.data.competingId,t.editId=e.data.id,t.tag=t.defaultModel(),t.tag.productId=e.data.id,t.tag.type="1",t.options=[],t.fileList=[],t.checkedValue=[]})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},deleteCompetitor:function(e){var t=this;m["a"].delete("/admin/productCompeting/productCompeting.jhtml",{ids:[e.id]}).then((function(e){t.$message.success("删除成功"),t.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},confirmByDialog:function(){var e=this;console.log("confurm"),this.tag.audios.length>0?this.tag.audio=this.tag.audios[0]:this.tag.audio="",this.tag.video.length>0?this.tag.video=this.tag.videos[0]:this.tag.video="";var t=this;this.tag.productId||(this.tag.productId=this.id),this.$refs.formPass.validate((function(a,i){a&&(e.isEditCompetitor?e.isCompeting&&(e.updateCompetitor(),e.createTag()):e.isCompeting?e.createCompetitor():e.options.length>0?e.options.forEach((function(a){e.tag.id?e.updateTag(a.content):setTimeout((function(){t.createTag(a.content)}),500)})):e.tag.id?e.updateTag(""):e.createTag(""))}))},createTag:function(e){var t=this;m["a"].post("/admin/productLabel/productLabel.jhtml",this.tag).then((function(e){t.$message.success("保存成功"),t.tagList(),t.getCompetitorList(),t.dialogVisible=!1,"1"===t.radioValue&&t.createProblem()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},updateTag:function(e){var t=this;m["a"].put("/admin/productLabel/productLabel.jhtml",this.tag).then((function(e){t.$message.success("保存成功"),t.tagList(),t.getCompetitorList(),"1"===t.radioValue&&t.createProblem()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},getCompetitorList:function(){var e=this;console.log(this.options),m["a"].get("/admin/productCompeting/productCompetings.jhtml",{productId:this.id,pageNumber:1,pageSize:100}).then((function(t){e.competitorList=t.dataList})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},addCompetitor:function(){this.isEditCompetitor=!1,this.title="添加商品竞品",this.isCompeting=!0,this.tag=this.defaultModel(),this.options=[],this.fileList=[],this.checkedValue=[],this.competingId="",this.name="",this.dialogVisible=!0},createCompetitor:function(){var e=this,t={productId:this.id,competingId:this.competingId,name:this.name,competingType:"1"};m["a"].post("/admin/productCompeting/productCompeting.jhtml",t).then((function(t){e.tag.productId=t.id,e.tag.type="1";var a=e;e.options.length>0?e.options.forEach((function(e){setTimeout((function(){a.createTag(e.content)}),500)})):e.createTag("")})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},updateCompetitor:function(){var e=this,t={productId:this.id,id:this.editId,competingId:this.competingId,name:this.name,competingType:"1"};m["a"].put("/admin/productCompeting/productCompeting.jhtml",t).then((function(t){e.$message.success("保存成功"),e.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},tagList:function(){var e=this;console.log(this.options),m["a"].get("/admin/productLabel/productLabels.jhtml",{id:this.id,type:"0"}).then((function(t){e.lightPoints=t.dataList})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},createProblem:function(){var e=this,t="1002",a="";1===this.checkedValue.length&&this.checkedValue.includes("音频")?a=this.tag.audios.join(","):1===this.checkedValue.length&&this.checkedValue.includes("文本")?(t="0",a=this.tag.text+","+this.tag.picture.join(",")):1===this.checkedValue.length&&this.checkedValue.includes("图片")?(t="3",a=this.tag.picture.join(",")):this.checkedValue.length>1&&(t="1",a=this.tag.text+"<img src="+this.tag.picture.join(",")+"/><audio src="+this.tag.audios.join(",")+"/>");var i={name:this.tag.name,matchMode:"0",question:"解释一下"+this.tag.name,similarQuestion:["说说"+this.tag.name,"讲讲"+this.tag.name,"说一说"+this.tag.name,"聊聊"+this.tag.name,"谈谈"+this.tag.name,"说一下"+this.tag.name,"讲一下"+this.tag.name],type:t,answer:a};m["a"].post($["f"].smartReception.knowledgeStock,i).then((function(e){console.log("添加成功")})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),"问题已存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},createProblemLd:function(){var e=this,t="0",a=this.lightPoints.map((function(e){return e.name})),i=a.join(","),o={name:this.baseInfo.name,matchMode:"0",question:this.baseInfo.name.replace(/\s*/g,"")+"怎么样",similarQuestion:[this.baseInfo.name.replace(/\s*/g,"")+"有什么优势"],type:t,answer:i};m["a"].post($["f"].smartReception.knowledgeStock,o).then((function(e){console.log("添加成功")})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),"问题已存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},refresh:function(){var e=this,t={id:this.id};this.isCreated=!0,T["a"].queryProductDetail(t,(function(t){e.form.introduction=t.introduction,e.form.notice=t.notice,e.form.afterSale=t.afterSale,e.form.memo=t.memo,e.$nextTick((function(){e.isCreated=!1}))}),(function(e){console.log(e)}))},update:function(){var e=this,t={id:this.id,introduction:this.form.introduction,notice:this.form.notice,afterSale:this.form.afterSale,memo:this.form.memo};T["a"].updateProductDetail(t,(function(t){e.$message.success("操作成功"),e.checked&&e.createProblemLd()}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log(t)}))}}},ae=te,ie=(a("a5a5"),Object(v["a"])(ae,Y,Z,!1,null,null,null)),oe=ie.exports,ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"propetry-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px",size:"small",disabled:!e.isEdit}},["整车"===e.categoryName?a("div",{staticStyle:{padding:"0px 5px"}},[a("el-form-item",{attrs:{label:"商品亮点"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addLigntPoiont}},[e._v("添加")]),a("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("同步至问答")])],1),a("div",[a("el-table",{attrs:{size:"small",data:e.lightPoints}},[a("el-table-column",{attrs:{label:"亮点标签",prop:"name"}}),a("el-table-column",{attrs:{label:"资源",prop:"shop.name"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.text?a("i",{staticClass:"biz-icon-i-web-wb iconfont"}):e._e(),t.row.audio?a("i",{staticClass:"biz-icon-i-web-yp iconfont"}):e._e(),t.row.picture.length>0?a("i",{staticClass:"biz-icon-i-web-tp iconfont"}):e._e()]}}],null,!1,922737709)}),a("el-table-column",{attrs:{label:"操作",prop:"bean"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-edit iconfont",on:{click:function(a){return a.stopPropagation(),e.editHandler(t.row)}}}),a("i",{staticClass:"el-icon-delete iconfont",on:{click:function(a){return a.stopPropagation(),e.deleteHandler(t.row)}}})]}}],null,!1,713312532)})],1)],1)],1):e._e()]),a("el-dialog",{attrs:{visible:e.dialogVisible,title:e.title,"append-to-body":"","custom-class":"addLignt"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"formPass",attrs:{"label-width":"140px",size:"small",model:e.tag,rules:e.rules}},[e.isCompeting?a("el-form-item",{attrs:{label:"选择竞品",prop:"name"}},[a("el-input",{attrs:{placeholder:"请选择车辆",disabled:e.isEditCompetitor},on:{focus:e.selectCar},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1):e._e(),a("el-form-item",{staticClass:"isRequired",attrs:{label:e.isCompeting?"关键词":"亮点标签",prop:"options"}},[a("el-input",{model:{value:e.tag.name,callback:function(t){e.$set(e.tag,"name",t)},expression:"tag.name"}})],1),a("el-form-item",{staticClass:"isRequired",attrs:{label:e.isCompeting?"对比资源":"亮点资源",prop:"checkpass"}},[a("el-checkbox-group",{on:{change:e.checkedValueChange},model:{value:e.checkedValue,callback:function(t){e.checkedValue=t},expression:"checkedValue"}},[a("el-checkbox",{attrs:{label:"音频"}}),a("biz-file-uploader",{directives:[{name:"show",rawName:"v-show",value:e.checkedValue.includes("音频"),expression:"checkedValue.includes('音频')"}],attrs:{data:{type:2},fileList:e.fileList},model:{value:e.tag.audios,callback:function(t){e.$set(e.tag,"audios",t)},expression:"tag.audios"}}),a("el-checkbox",{attrs:{label:"文本"}}),a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.checkedValue.includes("文本"),expression:"checkedValue.includes('文本')"}],model:{value:e.tag.text,callback:function(t){e.$set(e.tag,"text",t)},expression:"tag.text"}}),a("el-checkbox",{attrs:{label:"图片"}}),a("img-uploader",{directives:[{name:"show",rawName:"v-show",value:e.checkedValue.includes("图片"),expression:"checkedValue.includes('图片')"}],model:{value:e.tag.picture,callback:function(t){e.$set(e.tag,"picture",t)},expression:"tag.picture"}})],1)],1),a("el-form-item",{staticClass:"isRequired",attrs:{label:"同步至问答",prop:"options1"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[a("el-radio",{attrs:{label:"0"}},[e._v("否")]),a("el-radio",{attrs:{label:"1"}},[e._v("是")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmByDialog}},[e._v("确 定")])],1)],1),a("store-vehicle-picker",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"vehiclePicker",on:{"on-confirm":e.handleConfirm}}),a("el-dialog",{attrs:{visible:e.previewDialogOpen,"append-to-body":"",open:e.previewDialogOpen},on:{close:function(t){e.previewDialogOpen=!1}}},[a("iframe",{attrs:{src:"resources/admin/ecStatic/index.html?#/vshop/goods/"+e.id+"?shopId="+e.baseInfo.shopId,frameborder:"0",scrolling:"no",width:"375px",height:"567px"}})])],1)},re=[],se=a("2119"),ce={name:"CommodityMgmtHighLights",data:function(){var e=this;return{isCreated:!1,dialogVisible:!1,isCompeting:!1,previewDialogOpen:!1,checked:!1,radioValue:"1",checkedValue:[],options:[],fileList:[],name:"",title:"添加商品亮点",isEditCompetitor:!1,competingId:"",editId:"",lightPoints:[],competitorList:[],rules:{name:[{required:!0,trigger:"blur",validator:function(t,a,i){e.name?i():i(new Error("请选择竞品"))}}],options:[{required:!0,trigger:"blur",validator:function(t,a,i){e.tag.name?i():e.isCompeting?i(new Error("请输入关键词")):i(new Error("请输入亮点标签"))}}],checkpass:[{required:!0,trigger:"blur",validator:function(t,a,i){e.checkedValue.length&&e.checkedValue.length>0?i():e.isCompeting?i(new Error("请选择对比资源")):i(new Error("请选择亮点资源"))}}]},resources:["音频","视频","超链接","文本","图片"],operations:[{label:"保存",name:"update",type:"primary",auth:["admin:product.edit"]}],tag:{id:"",productId:"",name:"",audio:"",video:"",audios:[],videos:[],text:"",link:"",picture:[],type:"0"},form:{introduction:"",notice:"",afterSale:"",memo:"",files:"",fileList:[]}}},props:{id:{type:String},categoryName:{type:String},tabSelection:{type:String},baseInfo:{type:Object},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"highLights"===e&&""!==this.id&&(this.refresh(),this.tagList(),this.getCompetitorList())},open:function(e){e||(this.form.introduction="",this.form.notice="",this.form.afterSale="",this.form.memo="")}},components:{BizSaveButton:d["a"],BizGrid:u["a"],BizFileUploader:z["d"],ImgUploader:se["a"],StoreVehiclePicker:ee["a"]},created:function(){},computed:{},methods:{checkVideo:function(e){this.$message.warning(e)},preview:function(){this.previewDialogOpen=!0},checkedValueChange:function(){console.log("checkedValueChange"),this.checkedValue.includes("音频")||this.$set(this.tag,"audios",[]),this.checkedValue.includes("文本")||this.$set(this.tag,"text",""),this.checkedValue.includes("图片")||this.$set(this.tag,"picture",[])},defaultModel:function(){return{id:"",productId:"",name:"",audio:"",video:"",audios:[],videos:[],text:"",link:"",picture:[],type:"0"}},operate:function(e){this[e]()},addLigntPoiont:function(){this.isEditCompetitor=!1,this.title="添加商品亮点",this.isCompeting=!1,this.tag=this.defaultModel(),this.options=[],this.fileList=[],this.checkedValue=[],this.dialogVisible=!0},onSubmit:function(){console.log("submit!")},selectCar:function(){console.log("showDialog true"),this.$refs.vehiclePicker.showDialog=!0},handleConfirm:function(e,t){console.log("showDialog false"),this.$refs.vehiclePicker.showDialog=!1,this.name=t.seriesName+t.type,this.competingId=t.id,this.$refs.form.clearValidate()},editHandler:function(e){var t=this;this.isEditCompetitor=!1,this.isCompeting=!1,this.title="编辑商品亮点",m["a"].get("/admin/productLabel/productLabel.jhtml",{id:e.id}).then((function(e){t.checkedValue=[],t.dialogVisible=!0,t.tag=Object.assign(t.defaultModel(),e.data),t.options=[{content:t.tag.name}],e.data.audio&&(t.tag.audios=[e.data.audio],t.fileList=[{name:e.data.audio,url:e.data.audio}]),e.data.video&&(t.tag.videos=[e.data.video]),e.data.link&&t.checkedValue.push("超链接"),e.data.picture.length>0&&t.checkedValue.push("图片"),e.data.text&&t.checkedValue.push("文本"),e.data.video&&t.checkedValue.push("视频"),e.data.audio&&t.checkedValue.push("音频")})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},deleteHandler:function(e){var t=this;m["a"].delete("/admin/productLabel/productLabel.jhtml",{ids:[e.id]}).then((function(e){t.$message.success("删除成功"),t.tagList(),t.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},editCompetitor:function(e){var t=this;this.isEditCompetitor=!0,this.isCompeting=!0,this.title="添加竞品关键词",m["a"].get("/admin/productCompeting/productCompeting.jhtml",{id:e.id}).then((function(e){t.dialogVisible=!0,t.name=e.data.name,t.competingId=e.data.competingId,t.editId=e.data.id,t.tag=t.defaultModel(),t.tag.productId=e.data.id,t.tag.type="1",t.options=[],t.fileList=[],t.checkedValue=[]})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},deleteCompetitor:function(e){var t=this;m["a"].delete("/admin/productCompeting/productCompeting.jhtml",{ids:[e.id]}).then((function(e){t.$message.success("删除成功"),t.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},confirmByDialog:function(){var e=this;console.log("confurm"),this.tag.audios.length>0?this.tag.audio=this.tag.audios[0]:this.tag.audio="",this.tag.video.length>0?this.tag.video=this.tag.videos[0]:this.tag.video="";var t=this;this.tag.productId||(this.tag.productId=this.id),this.$refs.formPass.validate((function(a,i){a&&(e.isEditCompetitor?e.isCompeting&&(e.updateCompetitor(),e.createTag()):e.isCompeting?e.createCompetitor():e.options.length>0?e.options.forEach((function(a){e.tag.id?e.updateTag(a.content):setTimeout((function(){t.createTag(a.content)}),500)})):e.tag.id?e.updateTag(""):e.createTag(""))}))},createTag:function(e){var t=this;m["a"].post("/admin/productLabel/productLabel.jhtml",this.tag).then((function(e){t.$message.success("保存成功"),t.tagList(),t.getCompetitorList(),t.dialogVisible=!1,"1"===t.radioValue&&t.createProblem()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},updateTag:function(e){var t=this;m["a"].put("/admin/productLabel/productLabel.jhtml",this.tag).then((function(e){t.$message.success("保存成功"),t.tagList(),t.getCompetitorList(),"1"===t.radioValue&&t.createProblem()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},getCompetitorList:function(){var e=this;console.log(this.options),m["a"].get("/admin/productCompeting/productCompetings.jhtml",{productId:this.id,pageNumber:1,pageSize:100}).then((function(t){e.competitorList=t.dataList})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},addCompetitor:function(){this.isEditCompetitor=!1,this.title="添加商品竞品",this.isCompeting=!0,this.tag=this.defaultModel(),this.options=[],this.fileList=[],this.checkedValue=[],this.competingId="",this.name="",this.dialogVisible=!0},createCompetitor:function(){var e=this,t={productId:this.id,competingId:this.competingId,name:this.name,competingType:"1"};m["a"].post("/admin/productCompeting/productCompeting.jhtml",t).then((function(t){e.tag.productId=t.id,e.tag.type="1";var a=e;e.options.length>0?e.options.forEach((function(e){setTimeout((function(){a.createTag(e.content)}),500)})):e.createTag("")})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},updateCompetitor:function(){var e=this,t={productId:this.id,id:this.editId,competingId:this.competingId,name:this.name,competingType:"1"};m["a"].put("/admin/productCompeting/productCompeting.jhtml",t).then((function(t){e.$message.success("保存成功"),e.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},tagList:function(){var e=this;console.log(this.options),m["a"].get("/admin/productLabel/productLabels.jhtml",{id:this.id,type:"0"}).then((function(t){e.lightPoints=t.dataList})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},createProblem:function(){var e=this,t="1002",a="";1===this.checkedValue.length&&this.checkedValue.includes("音频")?a=this.tag.audios.join(","):1===this.checkedValue.length&&this.checkedValue.includes("文本")?(t="0",a=this.tag.text+","+this.tag.picture.join(",")):1===this.checkedValue.length&&this.checkedValue.includes("图片")?(t="3",a=this.tag.picture.join(",")):this.checkedValue.length>1&&(t="1",a=this.tag.text+"<img src="+this.tag.picture.join(",")+"/><audio src="+this.tag.audios.join(",")+"/>");var i={name:this.tag.name,matchMode:"0",question:"解释一下"+this.tag.name,similarQuestion:["说说"+this.tag.name,"讲讲"+this.tag.name,"说一说"+this.tag.name,"聊聊"+this.tag.name,"谈谈"+this.tag.name,"说一下"+this.tag.name,"讲一下"+this.tag.name],type:t,answer:a};m["a"].post($["f"].smartReception.knowledgeStock,i).then((function(e){console.log("添加成功")})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),"问题已存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},createProblemLd:function(){var e=this,t="0",a=this.lightPoints.map((function(e){return e.name})),i=a.join(","),o={name:this.baseInfo.name,matchMode:"0",question:this.baseInfo.name.replace(/\s*/g,"")+"怎么样",similarQuestion:[this.baseInfo.name.replace(/\s*/g,"")+"有什么优势"],type:t,answer:i};m["a"].post($["f"].smartReception.knowledgeStock,o).then((function(e){console.log("添加成功")})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),"问题已存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},refresh:function(){var e=this,t={id:this.id};this.isCreated=!0,T["a"].queryProductDetail(t,(function(t){e.form.introduction=t.introduction,e.form.notice=t.notice,e.form.afterSale=t.afterSale,e.form.memo=t.memo,e.$nextTick((function(){e.isCreated=!1}))}),(function(e){console.log(e)}))},update:function(){this.checked&&this.createProblemLd()}}},le=ce,de=(a("1f2f"),Object(v["a"])(le,ne,re,!1,null,null,null)),ue=de.exports,pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"propetry-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px",size:"small",disabled:!e.isEdit}},[a("el-form-item",{attrs:{label:"商品竞品"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addCompetitor}},[e._v("添加")])],1),e._l(e.competitorList,(function(t){return a("div",{key:t.id,staticStyle:{padding:"10px 0px","font-size":"14px"}},[a("div",[a("span",{staticStyle:{"vertical-align":"sub"}},[e._v(e._s(t.name))]),a("div",{staticStyle:{float:"right","margin-bottom":"10px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editCompetitor(t)}}},[e._v("添加关键词")]),a("i",{staticClass:"el-icon-delete iconfont",on:{click:function(a){return a.stopPropagation(),e.deleteCompetitor(t)}}})],1)]),a("div",[a("el-table",{attrs:{size:"small",data:t.labels}},[a("el-table-column",{attrs:{label:"亮点标签",prop:"name"}}),a("el-table-column",{attrs:{label:"资源",prop:"shop.name"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.text?a("i",{staticClass:"biz-icon-i-web-wb iconfont"}):e._e(),t.row.audio?a("i",{staticClass:"biz-icon-i-web-yp iconfont"}):e._e(),t.row.picture.length>0?a("i",{staticClass:"biz-icon-i-web-tp iconfont"}):e._e()]}}],null,!0)}),a("el-table-column",{attrs:{label:"操作",prop:"bean"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-edit iconfont",on:{click:function(a){return a.stopPropagation(),e.editHandler(t.row)}}}),a("i",{staticClass:"el-icon-delete iconfont",on:{click:function(a){return a.stopPropagation(),e.deleteHandler(t.row)}}})]}}],null,!0)})],1)],1)])}))],2),a("el-dialog",{attrs:{visible:e.dialogVisible,title:e.title,"append-to-body":"","custom-class":"addLignt"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"formPass",attrs:{"label-width":"140px",size:"small",model:e.tag,rules:e.rules}},[e.isCompeting?a("el-form-item",{attrs:{label:"选择竞品",prop:"name"}},[a("el-input",{attrs:{placeholder:"请选择车辆",disabled:e.isEditCompetitor},on:{focus:e.selectCar},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1):e._e(),a("el-form-item",{staticClass:"isRequired",attrs:{label:e.isCompeting?"关键词":"亮点标签",prop:"options"}},[a("el-input",{model:{value:e.tag.name,callback:function(t){e.$set(e.tag,"name",t)},expression:"tag.name"}})],1),a("el-form-item",{staticClass:"isRequired",attrs:{label:e.isCompeting?"对比资源":"亮点资源",prop:"checkpass"}},[a("el-checkbox-group",{on:{change:e.checkedValueChange},model:{value:e.checkedValue,callback:function(t){e.checkedValue=t},expression:"checkedValue"}},[a("el-checkbox",{attrs:{label:"音频"}}),a("biz-file-uploader",{directives:[{name:"show",rawName:"v-show",value:e.checkedValue.includes("音频"),expression:"checkedValue.includes('音频')"}],attrs:{data:{type:2},fileList:e.fileList},model:{value:e.tag.audios,callback:function(t){e.$set(e.tag,"audios",t)},expression:"tag.audios"}}),a("el-checkbox",{attrs:{label:"文本"}}),a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.checkedValue.includes("文本"),expression:"checkedValue.includes('文本')"}],model:{value:e.tag.text,callback:function(t){e.$set(e.tag,"text",t)},expression:"tag.text"}}),a("el-checkbox",{attrs:{label:"图片"}}),a("img-uploader",{directives:[{name:"show",rawName:"v-show",value:e.checkedValue.includes("图片"),expression:"checkedValue.includes('图片')"}],model:{value:e.tag.picture,callback:function(t){e.$set(e.tag,"picture",t)},expression:"tag.picture"}})],1)],1),a("el-form-item",{staticClass:"isRequired",attrs:{label:"同步至问答",prop:"options1"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[a("el-radio",{attrs:{label:"0"}},[e._v("否")]),a("el-radio",{attrs:{label:"1"}},[e._v("是")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmByDialog}},[e._v("确 定")])],1)],1),a("store-vehicle-picker",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"vehiclePicker",on:{"on-confirm":e.handleConfirm}}),a("el-dialog",{attrs:{visible:e.previewDialogOpen,"append-to-body":"",open:e.previewDialogOpen},on:{close:function(t){e.previewDialogOpen=!1}}},[a("iframe",{attrs:{src:"resources/admin/ecStatic/index.html?#/vshop/goods/"+e.id+"?shopId="+e.baseInfo.shopId,frameborder:"0",scrolling:"no",width:"375px",height:"567px"}})])],1)},he=[],me={name:"CommodityMgmtBaseInfo",data:function(){var e=this;return{isCreated:!1,dialogVisible:!1,isCompeting:!1,previewDialogOpen:!1,checked:!1,radioValue:"1",checkedValue:[],options:[],fileList:[],name:"",title:"添加商品亮点",isEditCompetitor:!1,competingId:"",editId:"",lightPoints:[],competitorList:[],rules:{name:[{required:!0,trigger:"blur",validator:function(t,a,i){e.name?i():i(new Error("请选择竞品"))}}],options:[{required:!0,trigger:"blur",validator:function(t,a,i){e.tag.name?i():e.isCompeting?i(new Error("请输入关键词")):i(new Error("请输入亮点标签"))}}],checkpass:[{required:!0,trigger:"blur",validator:function(t,a,i){e.checkedValue.length&&e.checkedValue.length>0?i():e.isCompeting?i(new Error("请选择对比资源")):i(new Error("请选择亮点资源"))}}]},resources:["音频","视频","超链接","文本","图片"],operations:[],tag:{id:"",productId:"",name:"",audio:"",video:"",audios:[],videos:[],text:"",link:"",picture:[],type:"0"},form:{introduction:"",notice:"",afterSale:"",memo:"",files:"",fileList:[]}}},props:{id:{type:String},categoryName:{type:String},tabSelection:{type:String},baseInfo:{type:Object},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"competingProducts"===e&&""!==this.id&&(this.refresh(),this.tagList(),this.getCompetitorList())},open:function(e){e||(this.form.introduction="",this.form.notice="",this.form.afterSale="",this.form.memo="")}},components:{BizSaveButton:d["a"],BizGrid:u["a"],BizFileUploader:z["d"],ImgUploader:se["a"],StoreVehiclePicker:ee["a"]},created:function(){},computed:{},methods:{checkVideo:function(e){this.$message.warning(e)},preview:function(){this.previewDialogOpen=!0},checkedValueChange:function(){console.log("checkedValueChange"),this.checkedValue.includes("音频")||this.$set(this.tag,"audios",[]),this.checkedValue.includes("文本")||this.$set(this.tag,"text",""),this.checkedValue.includes("图片")||this.$set(this.tag,"picture",[])},defaultModel:function(){return{id:"",productId:"",name:"",audio:"",video:"",audios:[],videos:[],text:"",link:"",picture:[],type:"0"}},operate:function(e){this[e]()},addLigntPoiont:function(){this.isEditCompetitor=!1,this.title="添加商品亮点",this.isCompeting=!1,this.tag=this.defaultModel(),this.options=[],this.fileList=[],this.checkedValue=[],this.dialogVisible=!0},onSubmit:function(){console.log("submit!")},selectCar:function(){console.log("showDialog true"),this.$refs.vehiclePicker.showDialog=!0},handleConfirm:function(e,t){console.log("showDialog false"),this.$refs.vehiclePicker.showDialog=!1,this.name=t.seriesName+t.type,this.competingId=t.id,this.$refs.form.clearValidate()},editHandler:function(e){var t=this;this.isEditCompetitor=!1,this.isCompeting=!1,this.title="编辑商品亮点",m["a"].get("/admin/productLabel/productLabel.jhtml",{id:e.id}).then((function(e){t.checkedValue=[],t.dialogVisible=!0,t.tag=Object.assign(t.defaultModel(),e.data),t.options=[{content:t.tag.name}],e.data.audio&&(t.tag.audios=[e.data.audio],t.fileList=[{name:e.data.audio,url:e.data.audio}]),e.data.video&&(t.tag.videos=[e.data.video]),e.data.link&&t.checkedValue.push("超链接"),e.data.picture.length>0&&t.checkedValue.push("图片"),e.data.text&&t.checkedValue.push("文本"),e.data.video&&t.checkedValue.push("视频"),e.data.audio&&t.checkedValue.push("音频")})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},deleteHandler:function(e){var t=this;m["a"].delete("/admin/productLabel/productLabel.jhtml",{ids:[e.id]}).then((function(e){t.$message.success("删除成功"),t.tagList(),t.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},editCompetitor:function(e){var t=this;this.isEditCompetitor=!0,this.isCompeting=!0,this.title="添加竞品关键词",m["a"].get("/admin/productCompeting/productCompeting.jhtml",{id:e.id}).then((function(e){t.dialogVisible=!0,t.name=e.data.name,t.competingId=e.data.competingId,t.editId=e.data.id,t.tag=t.defaultModel(),t.tag.productId=e.data.id,t.tag.type="1",t.options=[],t.fileList=[],t.checkedValue=[]})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},deleteCompetitor:function(e){var t=this;m["a"].delete("/admin/productCompeting/productCompeting.jhtml",{ids:[e.id]}).then((function(e){t.$message.success("删除成功"),t.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},confirmByDialog:function(){var e=this;console.log("confurm"),this.tag.audios.length>0?this.tag.audio=this.tag.audios[0]:this.tag.audio="",this.tag.video.length>0?this.tag.video=this.tag.videos[0]:this.tag.video="";var t=this;this.tag.productId||(this.tag.productId=this.id),this.$refs.formPass.validate((function(a,i){a&&(e.isEditCompetitor?e.isCompeting&&(e.updateCompetitor(),e.createTag()):e.isCompeting?e.createCompetitor():e.options.length>0?e.options.forEach((function(a){e.tag.id?e.updateTag(a.content):setTimeout((function(){t.createTag(a.content)}),500)})):e.tag.id?e.updateTag(""):e.createTag(""))}))},createTag:function(e){var t=this;m["a"].post("/admin/productLabel/productLabel.jhtml",this.tag).then((function(e){t.$message.success("保存成功"),t.tagList(),t.getCompetitorList(),t.dialogVisible=!1,"1"===t.radioValue&&t.createProblem()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},updateTag:function(e){var t=this;m["a"].put("/admin/productLabel/productLabel.jhtml",this.tag).then((function(e){t.$message.success("保存成功"),t.tagList(),t.getCompetitorList(),"1"===t.radioValue&&t.createProblem()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){t.loading=!1}))},getCompetitorList:function(){var e=this;console.log(this.options),m["a"].get("/admin/productCompeting/productCompetings.jhtml",{productId:this.id,pageNumber:1,pageSize:100}).then((function(t){e.competitorList=t.dataList})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},addCompetitor:function(){this.isEditCompetitor=!1,this.title="添加商品竞品",this.isCompeting=!0,this.tag=this.defaultModel(),this.options=[],this.fileList=[],this.checkedValue=[],this.competingId="",this.name="",this.dialogVisible=!0},createCompetitor:function(){var e=this,t={productId:this.id,competingId:this.competingId,name:this.name,competingType:"1"};m["a"].post("/admin/productCompeting/productCompeting.jhtml",t).then((function(t){e.tag.productId=t.id,e.tag.type="1";var a=e;e.options.length>0?e.options.forEach((function(e){setTimeout((function(){a.createTag(e.content)}),500)})):e.createTag("")})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},updateCompetitor:function(){var e=this,t={productId:this.id,id:this.editId,competingId:this.competingId,name:this.name,competingType:"1"};m["a"].put("/admin/productCompeting/productCompeting.jhtml",t).then((function(t){e.$message.success("保存成功"),e.getCompetitorList()})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},tagList:function(){var e=this;console.log(this.options),m["a"].get("/admin/productLabel/productLabels.jhtml",{id:this.id,type:"0"}).then((function(t){e.lightPoints=t.dataList})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},createProblem:function(){var e=this,t="1002",a="";1===this.checkedValue.length&&this.checkedValue.includes("音频")?a=this.tag.audios.join(","):1===this.checkedValue.length&&this.checkedValue.includes("文本")?(t="0",a=this.tag.text+","+this.tag.picture.join(",")):1===this.checkedValue.length&&this.checkedValue.includes("图片")?(t="3",a=this.tag.picture.join(",")):this.checkedValue.length>1&&(t="1",a=this.tag.text+"<img src="+this.tag.picture.join(",")+"/><audio src="+this.tag.audios.join(",")+"/>");var i={name:this.tag.name,matchMode:"0",question:"解释一下"+this.tag.name,similarQuestion:["说说"+this.tag.name,"讲讲"+this.tag.name,"说一说"+this.tag.name,"聊聊"+this.tag.name,"谈谈"+this.tag.name,"说一下"+this.tag.name,"讲一下"+this.tag.name],type:t,answer:a};m["a"].post($["f"].smartReception.knowledgeStock,i).then((function(e){console.log("添加成功")})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),"问题已存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},createProblemLd:function(){var e=this,t="0",a=this.lightPoints.map((function(e){return e.name})),i=a.join(","),o={name:this.baseInfo.name,matchMode:"0",question:this.baseInfo.name.replace(/\s*/g,"")+"怎么样",similarQuestion:[this.baseInfo.name.replace(/\s*/g,"")+"有什么优势"],type:t,answer:i};m["a"].post($["f"].smartReception.knowledgeStock,o).then((function(e){console.log("添加成功")})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),"问题已存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},refresh:function(){var e=this,t={id:this.id};this.isCreated=!0,T["a"].queryProductDetail(t,(function(t){e.form.introduction=t.introduction,e.form.notice=t.notice,e.form.afterSale=t.afterSale,e.form.memo=t.memo,e.$nextTick((function(){e.isCreated=!1}))}),(function(e){console.log(e)}))},update:function(){var e=this,t={id:this.id,introduction:this.form.introduction,notice:this.form.notice,afterSale:this.form.afterSale,memo:this.form.memo};T["a"].updateProductDetail(t,(function(t){e.$message.success("操作成功"),e.checked&&e.createProblemLd()}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log(t)}))}}},fe=me,ge=(a("551a"),Object(v["a"])(fe,pe,he,!1,null,null,null)),be=ge.exports,ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"commodity-mgmt-picture-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{size:"small","label-position":"top","label-width":"110px",disabled:!e.isEdit}},[a("el-form-item",{attrs:{label:"所有图片限制200K以下,建议尺寸3:2"}}),a("el-form-item",{attrs:{label:"轮播主图管理"}},[a("ProductAvatarPictureCardUploader",{class:{disabled:e.uploadDisabled},attrs:{imageList:e.carouselImages,productId:e.id,isMainPicture:!0},on:{"upload-success":e.handleCarouselUpload,"remove-success":e.handleCarouselRemove}})],1),a("el-form-item",{attrs:{label:"试驾视频 (请上传视频文件)"}},[a("ProductVrFileUploader",{attrs:{open:e.open,fileList:e.testDriverList,productId:e.id,isTestDrive:!0},on:{"upload-success":e.handleTestDriveUpload,"remove-success":e.handleTestDriveRemove}})],1),a("el-form-item",{attrs:{label:"内饰图片管理"}},[a("ProductAvatarPictureCardUploader",{attrs:{imageList:e.interiorsImages,productId:e.id},on:{"upload-success":e.handleInteriorsUpload,"remove-success":e.handleInteriorsRemove}})],1),a("el-form-item",{attrs:{label:"空间图片管理"}},[a("ProductAvatarPictureCardUploader",{attrs:{imageList:e.spaceImages,productId:e.id},on:{"upload-success":e.handleSpaceUpload,"remove-success":e.handleSpaceRemove}})],1),a("el-form-item",{attrs:{label:"图解资源管理"}},[a("ProductAvatarPictureCardUploader",{attrs:{imageList:e.diagramImages,productId:e.id},on:{"upload-success":e.handleDiagramUpload,"remove-success":e.handleDiagramRemove}})],1),a("el-form-item",{attrs:{label:"车身图片管理"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.fullScreenName,callback:function(t){e.fullScreenName=t},expression:"fullScreenName"}})],1),a("el-col",{attrs:{span:11}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.addFullScreen(t)}}},[e._v("添加颜色")])],1)],1),e._l(e.fullScreenList,(function(t){return a("el-form-item",{key:t.name},[a("el-tag",{attrs:{closable:!e.hasFullScreenImages(t),"disable-transitions":!1,type:"info",size:"warning"},on:{close:function(a){return e.handleCloseFullScreen(t)}}},[e._v(" "+e._s(t.name)+" ")]),a("ProductAvatarPictureCardUploader",{attrs:{imageList:t.fullScreenImages,parentElementName:t.name},on:{"upload-success":e.handleFullScreenUpload,"remove-success":e.handleFullScreenRemove}})],1)})),a("el-form-item",{attrs:{label:"360图片管理"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.appearanceName,callback:function(t){e.appearanceName=t},expression:"appearanceName"}})],1),a("el-col",{attrs:{span:11}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.addAppearance(t)}}},[e._v("添加颜色")])],1)],1),e._l(e.appearanceList,(function(t){return a("el-form-item",{key:t.name},[a("el-tag",{attrs:{closable:!e.hasAppearanceImages(t),"disable-transitions":!1,type:"info",size:"warning"},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t.name)+" ")]),a("ProductAvatarPictureCardUploader",{attrs:{imageList:t.appearanceImages,parentElementName:t.name},on:{"upload-success":e.handleAppearanceUpload,"remove-success":e.handleAppearanceRemove}})],1)}))],2),a("el-dialog",{attrs:{visible:e.previewDialogOpen,"append-to-body":"",open:e.previewDialogOpen,width:"420px"},on:{close:function(t){e.previewDialogOpen=!1}}},[a("iframe",{attrs:{src:"resources/admin/ecStatic/index.html?#/vshop/goods/"+e.id+"?shopId="+e.baseInfo.shopId,frameborder:"0",scrolling:"no",width:"375px",height:"567px"}})])],1)},ye=[],Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-vr-file-uploader"},[a("el-upload",{attrs:{accept:"application/zip,video/*",name:e.uploadName,action:e.uploadAction,data:e.uploadData,"file-list":e.fileList,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.beforeAvatarUpload}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hasFile(),expression:"hasFile()"}],attrs:{size:"small",type:"primary",disabled:!e.preview,loading:e.loading},on:{click:function(t){return t.stopPropagation(),e.handlePreview(t)}}},[e._v("预览")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hasFile(),expression:"hasFile()"}],attrs:{size:"small",type:"primary",disabled:e.preview},on:{click:function(t){return t.stopPropagation(),e.handlePreview(t)}}},[e._v("取消预览")]),a("iframe",{directives:[{name:"show",rawName:"v-show",value:!e.preview,expression:"!preview"}],ref:"vrFrame",staticClass:"vrframe",attrs:{src:e.url,frameborder:"0"}})],1)},we=[],Ce=(a("baa5"),a("bc3a")),Se=a.n(Ce),De={name:"ProductVrFileUploader",data:function(){return{preview:!0,loading:!1,url:""}},props:{isTestDrive:{type:Boolean,default:!1},productId:String,open:{type:Boolean,default:!1},fileList:{type:Array,default:function(){return[]}}},watch:{open:function(e){e||(this.url="",this.preview=!0)}},computed:{uploadAction:function(){return this.isTestDrive?"/admin/file/uploads.jhtml":"/admin/shopProduct/productVrZip.jhtml"},uploadName:function(){return this.isTestDrive?"file":"uploadFile0"},uploadData:function(){return this.isTestDrive?{type:"2"}:{productId:this.productId}}},methods:{handlePreview:function(){var e=this;if(this.isTestDrive)!0===this.preview?(this.url=this.getFilePath(),setTimeout((function(){e.preview=!1}),800)):(this.url="",this.preview=!0);else if(!0===this.preview){var t=this.getFilePath();this.loading=!0,Se.a.get(t).then((function(t){e.loading=!1,e.url=e.getFilePath(),e.$refs.vrFrame.contentWindow.location.reload(!0),setTimeout((function(){e.preview=!1}),800),console.log("url请求成功")})).catch((function(t){e.loading=!1,404===t.response.status?e.$message.warning("文件解析,十分钟后可预览"):console.log("url请求失败:",t.response)}))}else this.url="",this.loading=!1,this.preview=!0},handleRemove:function(e,t){this.$emit("remove-success",e,t),this.url="",this.preview=!0},handleSuccess:function(e,t,a){this.$emit("upload-success",e,t,a),this.url="",this.preview=!0},beforeAvatarUpload:function(e){if(this.isTestDrive){var t=/^video\/(.*)$/.test(e.type);return t||this.$message.error("请选择符合视频格式的文件上传!"),t}var a="application/zip"===e.type;if(!a){var i=e.name.substring(e.name.lastIndexOf(".")).toLowerCase();if(".zip"!==i)return this.$message.error("请选择zip格式的VR资源包!"),a}var o=e.size/1024/1024<=200;return o||this.$message.error("请上传小于200M的文件!"),o},handleError:function(e,t,a){e?this.$message.warning(e):this.$message.warning("发生错误")},hasFile:function(){return 0!==this.fileList.length},getFilePath:function(){if(0!==this.fileList.length){var e=this.fileList[0].url.indexOf("/upload/");if(-1===e)return console.log("文件路径错误",this.fileList[0].url),"";var t=location.protocol+"//"+location.host,a=this.fileList[0].url.substr(e),i=t+a;return this.isTestDrive||(i+="/index.html"),console.log("src",i),i}return""}}},Pe=De,ke=(a("1431"),Object(v["a"])(Pe,Ie,we,!1,null,null,null)),Me=ke.exports,xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-avatar-picture-card-uploader"},[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{accept:"image/*","list-type":"picture-card","file-list":e.imageList,name:"uploadFile0","on-success":e.handleSuccess,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.beforeAvatarUpload,action:e.uploadAction,data:e.uploadData,multiple:""}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("el-dialog",{staticClass:"avatar-preview-dialog",attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"review"},[a("img",{attrs:{src:e.imgUrl,alt:""}})])])],1)},Te=[],Ve={name:"ProductAvatarPictureCardUploader",data:function(){return{imgUrl:{type:String,default:""},dialogVisible:!1}},props:{parentElementName:String,shopId:window.top.SHOP_ID||"",productId:String,isMainPicture:{type:Boolean,default:function(){return!1}},imageList:{type:Array,default:function(){return[]}}},computed:{uploadAction:function(){return this.isMainPicture?"/admin/shopProduct/productImagesFile.jhtml":"/admin/vrMedia/uploadVrImage.jhtml"},uploadData:function(){return console.log("uploadData"),{shopId:window.top.SHOP_ID||"",productId:this.productId,type:"0"}}},methods:{handleRemove:function(e,t){this.$emit("remove-success",e)},handlePreview:function(e){this.imgUrl=e.url,this.dialogVisible=!0},handleSuccess:function(e,t,a){this.$emit("upload-success",e,t,this.parentElementName)},beforeAvatarUpload:function(e){var t=/^image\/(.*)$/.test(e.type);if(!t)return this.$message.error("请选择符合图片格式的文件上传!"),!1;var a=e.size/1024<=200;return a?!this.isMainPicture||(this.$refs.upload.$refs["upload-inner"].fileList.length<=5||(this.$message.error("轮播主图最多可添加5个"),!1)):(this.$message.error("上传图片大小不能超过 200K!"),!1)}}},_e=Ve,$e=(a("6caf"),Object(v["a"])(_e,xe,Te,!1,null,null,null)),Le=$e.exports,Oe=a("2299"),Be={name:"CommodityMgmtPictureInfo",components:{BizSaveButton:d["a"],BizGrid:u["a"],ProductVrFileUploader:Me,ProductAvatarPictureCardUploader:Le},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"},{label:"预览",name:"preview",type:"primary"}],previewDialogOpen:!1,appearanceName:"",fullScreenName:"",image:"",wideImage:"",VrMediaData:[],productImageDatas:[],sourceType:"0",defaultType:"",url:"",carouselImages:[],vrFileList:[],testDriverList:[],interiorsImages:[],spaceImages:[],diagramImages:[],fullScreenList:[],appearanceList:[]}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},baseInfo:{type:Object},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"pictureInfo"===e&&""!==this.id&&this.query()},open:function(e){e||(this.image="",this.wideImage="",this.VrMediaData=[],this.productImageDatas=[],this.carouselImages=[],this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.fullScreenList=[],this.appearanceList=[])}},created:function(){},computed:{uploadDisabled:function(){return this.productImageDatas.length>=5}},methods:{operate:function(e){this[e]()},preview:function(){this.previewDialogOpen=!0},sourceTypeChange:function(e){e!==this.defaultType&&("0"===e?this.vrFileList=[]:this.url="")},addAppearance:function(){var e=this;if(this.appearanceName){var t=this.appearanceList.findIndex((function(t){return t.name===e.appearanceName}));if(-1===t){var a={name:this.appearanceName,appearanceImages:[]};this.appearanceList.push(a)}this.appearanceName=""}},addFullScreen:function(){var e=this;if(this.fullScreenName){var t=this.fullScreenList.findIndex((function(t){return t.name===e.fullScreenName}));if(-1===t){var a={name:this.fullScreenName,fullScreenImages:[]};this.fullScreenList.push(a)}this.fullScreenName=""}},updateCarouselImages:function(){for(var e=[],t=0;t<this.productImageDatas.length;t++)e.push({name:this.productImageDatas[t].title,url:this.productImageDatas[t].source});this.carouselImages=e},updateVrData:function(){var e=this;this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.fullScreenImages=[],this.appearanceList=[],this.fullScreenList=[],this.vrFileList=[],this.testDriverList=[];for(var t=function(t){var a={url:e.VrMediaData[t].filePath,color:e.VrMediaData[t].color,mediaType:e.VrMediaData[t].mediaType};if("vr"===e.VrMediaData[t].mediaType)e.vrFileList.push({name:e.VrMediaData[t].filePath,url:e.VrMediaData[t].filePath});else if("testdrive"===e.VrMediaData[t].mediaType)e.testDriverList.push({name:e.VrMediaData[t].filePath,url:e.VrMediaData[t].filePath});else if("interiors"===e.VrMediaData[t].mediaType)e.interiorsImages.push(a);else if("space"===e.VrMediaData[t].mediaType)e.spaceImages.push(a);else if("diagram"===e.VrMediaData[t].mediaType)e.diagramImages.push(a);else if("facade"===e.VrMediaData[t].mediaType){if(e.VrMediaData[t].color){var i=e.fullScreenList.findIndex((function(a){return a.name===e.VrMediaData[t].color}));if(-1===i){var o={name:e.VrMediaData[t].color,fullScreenImages:[]};o.fullScreenImages.push(a),e.fullScreenList.push(o)}else e.fullScreenList[i].fullScreenImages.push(a)}}else if("appearance"===e.VrMediaData[t].mediaType&&e.VrMediaData[t].color){var n=e.appearanceList.findIndex((function(a){return a.name===e.VrMediaData[t].color}));if(-1===n){var r={name:e.VrMediaData[t].color,appearanceImages:[]};r.appearanceImages.push(a),e.appearanceList.push(r)}else e.appearanceList[n].appearanceImages.push(a)}},a=0;a<this.VrMediaData.length;a++)t(a)},handleCarouselUpload:function(e,t){"100"===e.resultCode&&this.productImageDatas.push({large:e.map[0].large,medium:e.map[0].medium,order:"",source:e.map[0].source,thumbnail:e.map[0].thumbnail,title:t.name})},handleCarouselRemove:function(e){var t=this.productImageDatas.findIndex((function(t){return t.source===e.url}));-1===t?(t=this.productImageDatas.findIndex((function(t){return t.source===e.response.map[0].source})),-1!==t&&this.productImageDatas.splice(t,1)):this.productImageDatas.splice(t,1)},getImage:function(e){return{color:"",fileName:this.getFileName(e),filePath:"",id:"",large:"",mediaType:e,medium:"",sortSn:"",thumbnail:"",sourceType:this.sourceType,title:this.getTitle(e),zipKey:""}},getFileName:function(e){return"interiors"===e?"inside":"space"===e?"size":"diagram"===e?"pictureInfo":"appearance"===e||"facade"===e?"car":"testdrive"===e?"drive":"vr"===e?"vr":""},getTitle:function(e){return"interiors"===e?"内饰":"space"===e?"空间":"diagram"===e?"图解":"appearance"===e?"360":"facade"===e?"外观":"testdrive"===e?"试驾":"vr"===e?"VR":""},handleVRUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("vr");i.filePath=e.path,this.AddVrData(i);var o=[];o.push({name:e.path,url:e.path}),console.log(o),this.vrFileList=o}},handleVRRemove:function(e,t){this.vrFileList=[];var a=this.VrMediaData.findIndex((function(t){return"vr"===t.mediaType&&t.filePath===e.url}));-1===a?(a=this.VrMediaData.findIndex((function(t){return"vr"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==a&&this.VrMediaData.splice(a,1)):this.VrMediaData.splice(a,1)},handleTestDriveUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("testdrive");i.filePath=e.fis[0].url,this.AddVrData(i);var o=[];o.push({name:e.fis[0].name,url:e.fis[0].url}),this.testDriverList=o}},handleTestDriveRemove:function(e,t){this.testDriverList=[];var a=this.VrMediaData.findIndex((function(t){return"testdrive"===t.mediaType&&t.filePath===e.url}));-1===a?(a=this.VrMediaData.findIndex((function(t){return"testdrive"===t.mediaType&&t.filePath===e.response.urls[0]})),-1!==a&&this.VrMediaData.splice(a,1)):this.VrMediaData.splice(a,1)},handleInteriorsUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("interiors");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleInteriorsRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"interiors"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"interiors"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleSpaceUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("space");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleSpaceRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"space"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"space"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleFullScreenUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("facade");i.color=a,i.filePath=e.map[0].large,i.large=e.map[0].large,i.medium=e.map[0].medium,i.thumbnail=e.map[0].thumbnail,i.fileName=e.map[0].fileName,i.source=e.map[0].source,this.AddVrData(i)}},handleFullScreenRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"facade"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"facade"===t.mediaType&&t.filePath===e.response.map[0].large})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleDiagramUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("diagram");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleDiagramRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"diagram"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"diagram"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleAppearanceUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("appearance");i.color=a,i.filePath=e.map[0].large,i.large=e.map[0].large,i.medium=e.map[0].medium,i.thumbnail=e.map[0].thumbnail,i.fileName=e.map[0].fileName,i.source=e.map[0].source,this.AddVrData(i)}},handleAppearanceRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.filePath===e.response.map[0].large})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},AddVrData:function(e){if("vr"===e.mediaType||"testdrive"===e.mediaType){var t=this.VrMediaData.findIndex((function(t){return t.mediaType===e.mediaType}));-1!==t?this.VrMediaData[t]=e:this.VrMediaData.push(e)}else this.VrMediaData.push(e)},DelVrData:function(e){var t=this.VrMediaData.findIndex((function(t){return t.filePath===e.url}));-1!==t&&this.VrMediaData.splice(t,1)},query:function(){var e=this,t={id:this.id};Oe["a"].getImageGroups(t,(function(t){e.image=t.image,e.wideImage=t.wideImage,e.VrMediaData=t.VrMediaData,e.productImageDatas=t.productImageDatas,e.updateCarouselImages(),e.updateVrData(),e.VrMediaData.map((function(t){"vr"===t.mediaType&&(e.sourceType=t.sourceType,e.defaultType=t.sourceType,e.url=t.filePath)})),console.log("获取商品图片成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品图片失败",e.id)}))},save:function(){var e=this,t={id:this.id,shopId:window.top.SHOP_ID||"",image:this.image,wideImage:this.wideImage,productImageDatas:this.productImageDatas};Oe["a"].updateImageGroups(t,(function(t){e.$message.success("更新商品图片成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("更新商品轮播主图失败",e.id)}))},saveVR:function(e){var t=this;"1"===this.sourceType&&(this.VrMediaData=[],this.VrMediaData.push({color:"",fileName:"vr",filePath:this.url,id:"",large:"",mediaType:"vr",medium:"",sortSn:"",thumbnail:"",sourceType:this.sourceType,title:"vr",zipKey:""}));var a={productId:this.id,shopId:window.top.SHOP_ID||"",datas:this.VrMediaData};Oe["a"].updateProductVrMediaBath(a,(function(e){t.$message.success("更新商品图片成功")}),(function(a){""!==a.errorMessage&&t.$message.warning(a.errorMessage),!0===e&&t.query(),console.log("更新商品VR资源失败",t.id)}))},handleClose:function(e){this.appearanceList=this.appearanceList.filter((function(t){return t.name!==e.name}))},handleCloseFullScreen:function(e){this.fullScreenList=this.fullScreenList.filter((function(t){return t.name!==e.name}))},hasFullScreenImages:function(e){var t=this.VrMediaData.findIndex((function(t){return"fullScreen"===t.mediaType&&t.color===e.name}));return-1!==t},hasAppearanceImages:function(e){var t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.color===e.name}));return-1!==t}}},Ne=Be,ze=(a("2df8"),Object(v["a"])(Ne,ve,ye,!1,null,null,null)),Ee=ze.exports,je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"commodity-mgmt-picture-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{size:"small","label-position":"top","label-width":"110px",disabled:!e.isEdit}},[a("el-form-item",{attrs:{label:"VR资源管理"}},[a("el-radio-group",{on:{change:e.sourceTypeChange},model:{value:e.sourceType,callback:function(t){e.sourceType=t},expression:"sourceType"}},[a("el-radio",{attrs:{label:"0"}},[e._v("本地资源包")]),a("el-radio",{attrs:{label:"1"}},[e._v("第三方资源地址")])],1),a("ProductVrFileUploader",{directives:[{name:"show",rawName:"v-show",value:"0"===e.sourceType,expression:"sourceType==='0'"}],attrs:{open:e.open,fileList:e.vrFileList,productId:e.id,isTestDrive:!1},on:{"upload-success":e.handleVRUpload,"remove-success":e.handleVRRemove}}),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"1"===e.sourceType,expression:"sourceType==='1'"}],attrs:{type:"textarea",autosize:{minRows:5,maxRows:8}},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})],1)],1)],1)},Re=[],Fe={name:"CommodityMgmtVrInfo",components:{BizSaveButton:d["a"],BizGrid:u["a"],ProductVrFileUploader:Me},data:function(){return{operations:[{label:"保存",name:"saveVR",type:"primary"}],previewDialogOpen:!1,appearanceName:"",fullScreenName:"",image:"",wideImage:"",VrMediaData:[],productImageDatas:[],sourceType:"0",defaultType:"",url:"",carouselImages:[],vrFileList:[],testDriverList:[],interiorsImages:[],spaceImages:[],diagramImages:[],fullScreenList:[],appearanceList:[]}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},baseInfo:{type:Object},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"vr"===e&&""!==this.id&&this.query()},open:function(e){e||(this.image="",this.wideImage="",this.VrMediaData=[],this.productImageDatas=[],this.carouselImages=[],this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.fullScreenList=[],this.appearanceList=[])}},created:function(){},computed:{uploadDisabled:function(){return this.productImageDatas.length>=5}},methods:{operate:function(e){this[e]()},preview:function(){this.previewDialogOpen=!0},sourceTypeChange:function(e){e!==this.defaultType&&("0"===e?this.vrFileList=[]:this.url="")},addAppearance:function(){var e=this;if(this.appearanceName){var t=this.appearanceList.findIndex((function(t){return t.name===e.appearanceName}));if(-1===t){var a={name:this.appearanceName,appearanceImages:[]};this.appearanceList.push(a)}this.appearanceName=""}},addFullScreen:function(){var e=this;if(this.fullScreenName){var t=this.fullScreenList.findIndex((function(t){return t.name===e.fullScreenName}));if(-1===t){var a={name:this.fullScreenName,fullScreenImages:[]};this.fullScreenList.push(a)}this.fullScreenName=""}},updateCarouselImages:function(){for(var e=[],t=0;t<this.productImageDatas.length;t++)e.push({name:this.productImageDatas[t].title,url:this.productImageDatas[t].source});this.carouselImages=e},updateVrData:function(){var e=this;this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.fullScreenImages=[],this.appearanceList=[],this.fullScreenList=[],this.vrFileList=[],this.testDriverList=[];for(var t=function(t){var a={url:e.VrMediaData[t].filePath,color:e.VrMediaData[t].color,mediaType:e.VrMediaData[t].mediaType};if("vr"===e.VrMediaData[t].mediaType)e.vrFileList.push({name:e.VrMediaData[t].filePath,url:e.VrMediaData[t].filePath});else if("testdrive"===e.VrMediaData[t].mediaType)e.testDriverList.push({name:e.VrMediaData[t].filePath,url:e.VrMediaData[t].filePath});else if("interiors"===e.VrMediaData[t].mediaType)e.interiorsImages.push(a);else if("space"===e.VrMediaData[t].mediaType)e.spaceImages.push(a);else if("diagram"===e.VrMediaData[t].mediaType)e.diagramImages.push(a);else if("facade"===e.VrMediaData[t].mediaType){if(e.VrMediaData[t].color){var i=e.fullScreenList.findIndex((function(a){return a.name===e.VrMediaData[t].color}));if(-1===i){var o={name:e.VrMediaData[t].color,fullScreenImages:[]};o.fullScreenImages.push(a),e.fullScreenList.push(o)}else e.fullScreenList[i].fullScreenImages.push(a)}}else if("appearance"===e.VrMediaData[t].mediaType&&e.VrMediaData[t].color){var n=e.appearanceList.findIndex((function(a){return a.name===e.VrMediaData[t].color}));if(-1===n){var r={name:e.VrMediaData[t].color,appearanceImages:[]};r.appearanceImages.push(a),e.appearanceList.push(r)}else e.appearanceList[n].appearanceImages.push(a)}},a=0;a<this.VrMediaData.length;a++)t(a)},handleCarouselUpload:function(e,t){"100"===e.resultCode&&this.productImageDatas.push({large:e.map[0].large,medium:e.map[0].medium,order:"",source:e.map[0].source,thumbnail:e.map[0].thumbnail,title:t.name})},handleCarouselRemove:function(e){var t=this.productImageDatas.findIndex((function(t){return t.source===e.url}));-1===t?(t=this.productImageDatas.findIndex((function(t){return t.source===e.response.map[0].source})),-1!==t&&this.productImageDatas.splice(t,1)):this.productImageDatas.splice(t,1)},getImage:function(e){return{color:"",fileName:this.getFileName(e),filePath:"",id:"",large:"",mediaType:e,medium:"",sortSn:"",thumbnail:"",sourceType:this.sourceType,title:this.getTitle(e),zipKey:""}},getFileName:function(e){return"interiors"===e?"inside":"space"===e?"size":"diagram"===e?"pictureInfo":"appearance"===e||"facade"===e?"car":"testdrive"===e?"drive":"vr"===e?"vr":""},getTitle:function(e){return"interiors"===e?"内饰":"space"===e?"空间":"diagram"===e?"图解":"appearance"===e?"360":"facade"===e?"外观":"testdrive"===e?"试驾":"vr"===e?"VR":""},handleVRUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("vr");i.filePath=e.path,this.AddVrData(i);var o=[];o.push({name:e.path,url:e.path}),console.log(o),this.vrFileList=o}},handleVRRemove:function(e,t){this.vrFileList=[];var a=this.VrMediaData.findIndex((function(t){return"vr"===t.mediaType&&t.filePath===e.url}));-1===a?(a=this.VrMediaData.findIndex((function(t){return"vr"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==a&&this.VrMediaData.splice(a,1)):this.VrMediaData.splice(a,1)},handleTestDriveUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("testdrive");i.filePath=e.fis[0].url,this.AddVrData(i);var o=[];o.push({name:e.fis[0].name,url:e.fis[0].url}),this.testDriverList=o}},handleTestDriveRemove:function(e,t){this.testDriverList=[];var a=this.VrMediaData.findIndex((function(t){return"testdrive"===t.mediaType&&t.filePath===e.url}));-1===a?(a=this.VrMediaData.findIndex((function(t){return"testdrive"===t.mediaType&&t.filePath===e.response.urls[0]})),-1!==a&&this.VrMediaData.splice(a,1)):this.VrMediaData.splice(a,1)},handleInteriorsUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("interiors");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleInteriorsRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"interiors"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"interiors"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleSpaceUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("space");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleSpaceRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"space"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"space"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleFullScreenUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("facade");i.color=a,i.filePath=e.map[0].large,i.large=e.map[0].large,i.medium=e.map[0].medium,i.thumbnail=e.map[0].thumbnail,i.fileName=e.map[0].fileName,i.source=e.map[0].source,this.AddVrData(i)}},handleFullScreenRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"facade"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"facade"===t.mediaType&&t.filePath===e.response.map[0].large})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleDiagramUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("diagram");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleDiagramRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"diagram"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"diagram"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleAppearanceUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("appearance");i.color=a,i.filePath=e.map[0].large,i.large=e.map[0].large,i.medium=e.map[0].medium,i.thumbnail=e.map[0].thumbnail,i.fileName=e.map[0].fileName,i.source=e.map[0].source,this.AddVrData(i)}},handleAppearanceRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.filePath===e.response.map[0].large})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},AddVrData:function(e){if("vr"===e.mediaType||"testdrive"===e.mediaType){var t=this.VrMediaData.findIndex((function(t){return t.mediaType===e.mediaType}));-1!==t?this.VrMediaData[t]=e:this.VrMediaData.push(e)}else this.VrMediaData.push(e)},DelVrData:function(e){var t=this.VrMediaData.findIndex((function(t){return t.filePath===e.url}));-1!==t&&this.VrMediaData.splice(t,1)},query:function(){var e=this,t={id:this.id};Oe["a"].getImageGroups(t,(function(t){e.image=t.image,e.wideImage=t.wideImage,e.VrMediaData=t.VrMediaData,e.productImageDatas=t.productImageDatas,e.updateCarouselImages(),e.updateVrData(),e.VrMediaData.map((function(t){"vr"===t.mediaType&&(e.sourceType=t.sourceType,e.defaultType=t.sourceType,e.url=t.filePath)})),console.log("获取商品图片成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品图片失败",e.id)}))},save:function(){var e=this,t={id:this.id,shopId:window.top.SHOP_ID||"",image:this.image,wideImage:this.wideImage,productImageDatas:this.productImageDatas};Oe["a"].updateImageGroups(t,(function(t){e.saveVR(!0)}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),e.saveVR(!1),console.log("更新商品轮播主图失败",e.id)}))},saveVR:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];"1"===this.sourceType&&(this.VrMediaData=[],this.VrMediaData.push({color:"",fileName:"vr",filePath:this.url,id:"",large:"",mediaType:"vr",medium:"",sortSn:"",thumbnail:"",sourceType:this.sourceType,title:"vr",zipKey:""}));var a={productId:this.id,shopId:window.top.SHOP_ID||"",datas:this.VrMediaData};Oe["a"].updateProductVrMediaBath(a,(function(t){e.$message.success("VR更新成功")}),(function(a){""!==a.errorMessage&&e.$message.warning(a.errorMessage),!0===t&&e.query(),console.log("更新商品VR资源失败",e.id)}))},handleClose:function(e){this.appearanceList=this.appearanceList.filter((function(t){return t.name!==e.name}))},handleCloseFullScreen:function(e){this.fullScreenList=this.fullScreenList.filter((function(t){return t.name!==e.name}))},hasFullScreenImages:function(e){var t=this.VrMediaData.findIndex((function(t){return"fullScreen"===t.mediaType&&t.color===e.name}));return-1!==t},hasAppearanceImages:function(e){var t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.color===e.name}));return-1!==t}}},qe=Fe,Ae=(a("33cc"),Object(v["a"])(qe,je,Re,!1,null,null,null)),Ge=Ae.exports,Ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"commodity-mgmt-parameter"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{size:"small","label-width":"120px",disabled:!e.isEdit}},e._l(e.parameterGroups,(function(t){return a("div",{key:t.id},[a("el-form-item",{staticStyle:{"font-weight":"bold"},attrs:{label:t.name+"："}}),e._l(t.parameters,(function(t){return a("el-form-item",{key:t.id,attrs:{label:t.name+"：",value:t.id}},["1"===t.type?a("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"parameter.value"}},e._l(e.configureOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.value}})})),1):"2"===t.type?a("el-select",{staticStyle:{width:"80%"},attrs:{filterable:"","allow-create":"",clearable:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"parameter.value"}},e._l(e.assembleOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.value}})})),1):a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入参数"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"parameter.value"}})],1)}))],2)})),0),a("el-dialog",{attrs:{visible:e.previewDialogOpen,"append-to-body":"",open:e.previewDialogOpen,width:"420px"},on:{close:function(t){e.previewDialogOpen=!1}}},[a("iframe",{attrs:{src:"resources/admin/ecStatic/index.html?#/vshop/goods/"+e.id+"?shopId="+e.baseInfo.shopId,frameborder:"0",scrolling:"no",width:"375px",height:"567px"}})])],1)},Ke=[],He=a("44e0"),We={name:"CommodityMgmtParameter",components:{BizSaveButton:d["a"],BizGrid:u["a"]},data:function(){return{operations:[{label:"保存",name:"save",type:"primary",auth:["admin:product.edit"]},{label:"预览",name:"preview",type:"primary"}],configureOptions:[{id:"0",name:"-",value:"-"},{id:"1",name:"●",value:"●"},{id:"2",name:"○",value:"○"}],assembleOptions:[{id:"0",name:"主-/副-",value:"主-/副-"},{id:"1",name:"主-/副●",value:"主-/副●"},{id:"2",name:"主-/副○",value:"主-/副○"},{id:"3",name:"主●/副-",value:"主●/副-"},{id:"4",name:"主●/副●",value:"主●/副●"},{id:"5",name:"主●/副○",value:"主●/副○"},{id:"6",name:"主○/副-",value:"主○/副-"},{id:"7",name:"主○/副●",value:"主○/副●"},{id:"8",name:"主○/副○",value:"主○/副○"},{id:"9",name:"前-/后-",value:"前-/后-"},{id:"10",name:"前-/后●",value:"前-/后●"},{id:"11",name:"前-/后○",value:"前-/后○"},{id:"12",name:"前●/后-",value:"前●/后-"},{id:"13",name:"前●/后●",value:"前●/后●"},{id:"14",name:"前●/后○",value:"前●/后○"},{id:"15",name:"前○/后-",value:"前○/后-"},{id:"16",name:"前○/后●",value:"前○/后●"},{id:"17",name:"前○/后○",value:"前○/后○"},{id:"18",name:"自动-",value:"自动-"},{id:"19",name:"自动●",value:"自动●"},{id:"20",name:"自动○",value:"自动○"},{id:"21",name:"手动-",value:"手动-"},{id:"22",name:"手动●",value:"手动●"},{id:"23",name:"手动○",value:"手动○"}],parameterGroups:[],previewDialogOpen:!1}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},baseInfo:{type:Object},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"parameter"===e&&""!==this.id&&this.query()},open:function(e){e||(this.parameterGroups=[])}},created:function(){},computed:{},methods:{operate:function(e){this[e]()},preview:function(){this.previewDialogOpen=!0},query:function(){var e=this,t={id:this.id};He["a"].getParameterGroups(t,(function(t){e.parameterGroups=t.parameterGroups,console.log("获取商品参数成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品参数失败",e.id)}))},save:function(){var e=this,t={id:this.id,parameterGroups:this.parameterGroups};He["a"].updateParameterGroups(t,(function(t){e.query(),e.$message.success("更新商品参数成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("更新商品参数失败",e.id)}))}}},Qe=We,Je=(a("85aa"),Object(v["a"])(Qe,Ue,Ke,!1,null,null,null)),Ye=Je.exports,Ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"category-mgmt__specification"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}):e._e(),a("el-form",{attrs:{size:"small",disabled:!e.isEdit}},[a("label",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"}},[e._v("请选择商品规格：")]),a("div",{staticStyle:{margin:"15px"}}),a("el-form-item",[a("el-checkbox-group",{staticStyle:{"margin-left":"10px"},on:{change:e.handleCheckedChange},model:{value:e.checkedIds,callback:function(t){e.checkedIds=t},expression:"checkedIds"}},e._l(e.allSpecificationList,(function(t){return a("el-checkbox",{key:t.name,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.commodityList}},[e._l(e.allSpecificationList,(function(t){return t.checked?a("el-table-column",{key:t.id,attrs:{label:t.name},scopedSlots:e._u([{key:"default",fn:function(i){return e._l(i.row.specificationValueData,(function(i){return a("div",{key:i.id,attrs:{label:i.name}},[a("el-select",{directives:[{name:"show",rawName:"v-show",value:t.id===i.specificationId,expression:"specification.id === valueItem.specificationId"}],attrs:{placeholder:"请选择"},model:{value:i.id,callback:function(t){e.$set(i,"id",t)},expression:"valueItem.id"}},e._l(t.options,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)}))}}],null,!0)}):e._e()})),e.showEditOperationColumn?a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e.isEdit?[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.rowDeleteClickHandler(t.row)}}},[e._v("删除")])]:void 0}}],null,!0)}):e._e()],2),e.isEdit?a("biz-save-button",{attrs:{operations:e.editOperations},on:{operate:e.operateHandler}}):e._e(),a("el-dialog",{attrs:{visible:e.dialogVisiable,title:"规格同步","append-to-body":"","custom-class":"spec-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[a("div",{staticClass:"dialog-div"},[a("div",{staticStyle:{padding:"0px 20px 10px 20px"}},[e._v("您可将当前规格商品的数据同步给其他规格，同步后其他规格的数据与当前一致。同步前请仔细核对需要同步的规格和数据！")]),a("el-form",{ref:"formPass",attrs:{"label-width":"110px",size:"small",model:e.formSpec,"inline-message":!0}},[a("el-form-item",{attrs:{label:"当前规格：",prop:"currentSpec"}},[a("span",{staticClass:"form-static"},[e._v(e._s(e.formSpec.currentSpec))])]),a("el-form-item",{staticClass:"isRequired",attrs:{label:"同步规格：",prop:"spec"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminateSpec},on:{change:e.handleCheckAllSpec},model:{value:e.allSpec,callback:function(t){e.allSpec=t},expression:"allSpec"}},[e._v("全选")]),a("el-checkbox-group",{staticStyle:{display:"grid"},on:{change:e.handleSpeChange},model:{value:e.specs,callback:function(t){e.specs=t},expression:"specs"}},e._l(e.specList,(function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{staticClass:"isRequired",attrs:{label:"同步数据：",prop:"item"}},[a("div",{staticStyle:{display:"flex",border:"1px solid rgb(245, 245, 245)","margin-top":"10px"}},[a("div",{staticStyle:{"padding-right":"10px","padding-left":"10px","border-right":"1px solid rgb(245, 245, 245)","min-width":"100px"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminateCategoryBase},on:{change:e.handleCheckAllCategoryBase},model:{value:e.categoryBase,callback:function(t){e.categoryBase=t},expression:"categoryBase"}},[e._v("基本信息")])],1),a("div",{staticStyle:{"padding-left":"10px"}},[a("el-checkbox-group",{on:{change:e.handleBaseChange},model:{value:e.itemsBase,callback:function(t){e.itemsBase=t},expression:"itemsBase"}},e._l(e.itemBaseList,(function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)]),a("div",{staticStyle:{display:"flex",border:"1px solid rgb(245, 245, 245)"}},[a("div",{staticStyle:{"padding-right":"10px","padding-left":"10px","border-right":"1px solid rgb(245, 245, 245)","min-width":"100px"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminateCategoryParm},on:{change:e.handleCheckAllCategoryParm},model:{value:e.categoryParm,callback:function(t){e.categoryParm=t},expression:"categoryParm"}},[e._v("参数")])],1),a("div",{staticStyle:{"padding-left":"10px"}},[a("el-checkbox-group",{on:{change:e.handleParmChange},model:{value:e.itemsParm,callback:function(t){e.itemsParm=t},expression:"itemsParm"}},e._l(e.itemParmList,(function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)]),a("div",{staticStyle:{display:"flex",border:"1px solid rgb(245, 245, 245)"}},[a("div",{staticStyle:{"padding-right":"10px","padding-left":"10px","border-right":"1px solid rgb(245, 245, 245)","min-width":"100px"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminateCategoryDetail},on:{change:e.handleCheckAllCategoryDetail},model:{value:e.categoryDetail,callback:function(t){e.categoryDetail=t},expression:"categoryDetail"}},[e._v("详情")])],1),a("div",{staticStyle:{"padding-left":"10px"}},[a("el-checkbox-group",{on:{change:e.handleDetailChange},model:{value:e.itemsDetail,callback:function(t){e.itemsDetail=t},expression:"itemsDetail"}},e._l(e.itemDetailList,(function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)]),a("div",{staticStyle:{display:"flex",border:"1px solid rgb(245, 245, 245)"}},[a("div",{staticStyle:{"padding-right":"10px","padding-left":"10px","border-right":"1px solid rgb(245, 245, 245)","min-width":"100px"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminateCategoryPicture},on:{change:e.handleCheckAllCategoryPicture},model:{value:e.categoryPicture,callback:function(t){e.categoryPicture=t},expression:"categoryPicture"}},[e._v("图片")])],1),a("div",{staticStyle:{"padding-left":"10px"}},[a("el-checkbox-group",{on:{change:e.handlePictureChange},model:{value:e.itemsPicture,callback:function(t){e.itemsPicture=t},expression:"itemsPicture"}},e._l(e.itemPictureList,(function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)])])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisiable=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmByDialog}},[e._v("确 定")])],1)])],1)},Xe=[],et=a("4b5f"),tt={name:"Specification",components:{BizSaveButton:d["a"],BizGrid:u["a"]},data:function(){return{showEditOperationColumn:!1,operations:[{label:"规格同步",name:"specSync",type:"",disabled:!1},{label:"增加规格商品",name:"addSpecificationCommodityOperation",type:"primary",disabled:!0}],editOperations:[{label:"确定",name:"saveSpecificationEditOperation",type:"primary",auth:["admin:product.edit"]},{label:"取消",name:"cancelSpecificationEditOperation",type:"primary",auth:["admin:product.edit"]}],checkedIds:[],allSpecificationList:[],commodityList:[],formSpec:{currentSpec:""},dialogVisiable:!1,isIndeterminateSpec:!1,isIndeterminateCategoryBase:!1,isIndeterminateCategoryParm:!1,isIndeterminateCategoryDetail:!1,isIndeterminateCategoryPicture:!1,specList:[],allSpec:!0,categoryBase:!0,categoryParm:!0,categoryDetail:!0,categoryPicture:!0,specs:[],itemsBase:[],itemsParm:[],itemsDetail:[],itemsPicture:[],itemBaseList:[{value:"0",label:"名称"},{value:"1",label:"品牌"},{value:"2",label:"系列"},{value:"3",label:"销售价"},{value:"4",label:"指导价"},{value:"5",label:"支付方式"},{value:"6",label:"配送方式"},{value:"7",label:"关键词"},{value:"8",label:"营销标签"},{value:"9",label:"缩略图"}],itemParmList:[],itemDetailList:[{value:"10",label:"商品介绍"},{value:"11",label:"购买须知"},{value:"12",label:"产品售后"},{value:"13",label:"语音播报介绍"},{value:"14",label:"商品亮点"},{value:"15",label:"商品竞品"}],itemPictureList:[{value:"16",label:"轮播主图"},{value:"17",label:"VR资源"},{value:"18",label:"视频"},{value:"19",label:"内饰图片"},{value:"20",label:"空间图片"},{value:"21",label:"图解资源"},{value:"22",label:"车身图片"},{value:"23",label:"360图片"}]}},computed:{},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}},specName:{type:String},categoryName:{type:String}},watch:{tabSelection:function(e){"specification"===e&&""!==this.id&&this.query()},open:function(e){e||(this.checkedIds=[],this.allSpecificationList=[],this.commodityList=[],this.showEditOperationColumn=!1)}},created:function(){},methods:{refresh:function(){this.query()},handleCheckAllSpec:function(e){this.specs=e?this.specList.map((function(e){return e.id})):[],this.isIndeterminateSpec=!1},handleSpeChange:function(e){var t=e.length;this.allSpec=t===this.specList.length,this.isIndeterminateSpec=t>0&&t<this.specList.length},specSync:function(){var e=this;this.specList=[],this.formSpec.currentSpec=this.specName;var t,a=Object(n["a"])(this.commodityList);try{var i=function(){var a=t.value,i="";a.specificationValueData.forEach((function(e,t){a.specificationValueData.length-1>t?i+=e.name+",":i+=e.name})),e.specList.push({name:i,id:a.productId})};for(a.s();!(t=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}"整车"===this.categoryName?this.itemDetailList=[{value:"10",label:"商品介绍"},{value:"11",label:"购买须知"},{value:"12",label:"产品售后"},{value:"13",label:"语音播报介绍"},{value:"14",label:"商品亮点"},{value:"15",label:"商品竞品"}]:this.itemDetailList=[{value:"10",label:"商品介绍"},{value:"11",label:"购买须知"},{value:"12",label:"产品售后"},{value:"13",label:"语音播报介绍"}],this.specs=this.specList?this.specList.map((function(e){return e.id})):[],this.itemsBase=this.itemBaseList?this.itemBaseList.map((function(e){return e.value})):[],this.itemsParm=this.itemParmList?this.itemParmList.map((function(e){return e.value})):[],this.itemsDetail=this.itemDetailList?this.itemDetailList.map((function(e){return e.value})):[],this.itemsPicture=this.itemPictureList?this.itemPictureList.map((function(e){return e.value})):[],this.categoryBase=!0,this.categoryParm=!0,this.categoryDetail=!0,this.categoryPicture=!0,this.dialogVisiable=!0},handleCheckAllCategoryBase:function(e){this.itemsBase=e?this.itemBaseList.map((function(e){return e.value})):[],this.isIndeterminateCategoryBase=!1},handleBaseChange:function(e){var t=e.length;this.categoryBase=t===this.itemBaseList.length,this.isIndeterminateCategoryBase=t>0&&t<this.itemBaseList.length},handleCheckAllCategoryParm:function(e){this.itemsParm=e?this.itemParmList.map((function(e){return e.value})):[],this.isIndeterminateCategoryParm=!1},handleParmChange:function(e){var t=e.length;this.categoryParm=t===this.itemParmList.length,this.isIndeterminateCategoryParm=t>0&&t<this.itemParmList.length},handleCheckAllCategoryDetail:function(e){this.itemsDetail=e?this.itemDetailList.map((function(e){return e.value})):[],this.isIndeterminateCategoryDetail=!1},handleDetailChange:function(e){var t=e.length;this.categoryDetail=t===this.itemDetailList.length,this.isIndeterminateCategoryDetail=t>0&&t<this.itemDetailList.length},handleCheckAllCategoryPicture:function(e){this.itemsPicture=e?this.itemPictureList.map((function(e){return e.value})):[],this.isIndeterminateCategoryPicture=!1},handlePictureChange:function(e){var t=e.length;this.categoryPicture=t===this.itemPictureList.length,this.isIndeterminateCategoryPicture=t>0&&t<this.itemPictureList.length},confirmByDialog:function(){var e=this,t=!0;if(0===this.specs.length&&(this.$message.warning("请选择同步规格"),t=!1),0===this.itemsBase.length&&!1===this.categoryParm&&0===this.itemsDetail.length&&0===this.itemsPicture.length&&(this.$message.warning("请选择同步数据"),t=!1),!t)return!1;var a=[];(!0===this.categoryBase||this.itemsBase.length>0)&&(this.categoryBase="0",a.push({category:this.categoryBase,items:this.itemsBase})),(!0===this.categoryParm||this.itemsParm.length>0)&&(this.categoryParm="1",a.push({category:this.categoryParm,items:this.itemsParm})),(!0===this.categoryDetail||this.itemsDetail.length>0)&&(this.categoryDetail="2",a.push({category:this.categoryDetail,items:this.itemsDetail})),(!0===this.categoryPicture||this.itemsPicture.length>0)&&(this.categoryPicture="3",a.push({category:this.categoryPicture,items:this.itemsPicture}));for(var i=0,o=a;i<o.length;i++){var n=o[i];"0"===n.category?this.categoryBase=!0:"1"===n.category?this.categoryParm=!0:"2"===n.category?this.categoryDetail=!0:"3"===n.category&&(this.categoryPicture=!0)}var r={id:this.id,ids:this.specs,items:a};m["a"].put("/admin/shopProduct/specificationsSynchronization.jhtml",r).then((function(t){e.dialogVisiable=!1,e.$message.success("规格同步成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)}))},query:function(){var e=this,t={shopId:window.top.SHOP_ID||"",id:this.id};et["a"].getSpecificationGroups(t,(function(t){e.allSpecificationList=e.getAllSpecificationList(t.categorySpecifications),e.allSpecificationList.length>0?e.operations[1].disabled=!1:e.operations[1].disabled=!0,e.commodityList=e.getCommodityList(t.allProductSpecifications),0===t.allProductSpecifications[0].specificationValueDatas.length?e.operations[0].disabled=!0:e.operations[0].disabled=!1,e.checkedIds=e.sortCheckedIds(),e.handleCheckedChange(e.checkedIds)}),(function(t){e.$message.warning(t.errorMessage)}))},getAllSpecificationList:function(e){var t=this,a=[];return e.forEach((function(e,i){a.push({id:e.id,name:e.name,type:e.type,sort:e.sort,options:t.getSpecificationValueOptions(e.specificationValueData),checked:!1})})),a},getSpecificationValueOptions:function(e){var t=[];return e.forEach((function(e,a){t.push({id:e.id,name:e.name,sort:e.sort,image:e.image,specificationId:e.specificationId})})),t},getCommodityList:function(e){var t=this,a=[];return e.forEach((function(e,i){a.push({productId:e.productData.id,specificationValueData:t.getCommoditySpecificationValueData(e.specificationValueDatas)})})),a},getCommoditySpecificationValueData:function(e){var t=this,a=[];return e.forEach((function(e,i){t.addCheckedIds(e.specificationId),a.push({id:e.id,name:e.name,sort:e.sort,image:e.image,specificationId:e.specificationId})})),a},addCheckedIds:function(e){var t=this.checkedIds.findIndex((function(t){return t===e}));-1===t&&this.checkedIds.push(e)},sortCheckedIds:function(){var e=this,t=[];return this.allSpecificationList.forEach((function(a,i){var o=e.checkedIds.findIndex((function(e){return e===a.id}));-1!==o&&t.push(e.checkedIds[o])})),t},update:function(){var e=this,t=this.getAllProductSpecificationsParams();this.hasProductWithSameSpecification(t)?this.$message.warning("不能创建相同的商品规格"):et["a"].updateSpecificationGroups(t,(function(t){e.$message.success("更新商品规格成功"),e.query(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},hasProductWithSameSpecification:function(e){var t=this,a=!1;return e.forEach((function(i,o){!0!==a&&e.forEach((function(e,o){!0!==a&&i.productData.id!==e.productData.id&&t.isSameSpecificationValueDatas(i.specificationValueDatas,e.specificationValueDatas)&&(a=!0)}))})),a},isSameSpecificationValueDatas:function(e,t){var a=!0;return e.forEach((function(e,i){var o=t.findIndex((function(t){return t.id===e.id}));-1===o&&(a=!1)})),a},getAllProductSpecificationsParams:function(){var e=this,t=[];return this.commodityList.forEach((function(a,i){t.push({productData:e.getProductDataParams(a.productId),specificationValueDatas:e.getSpecificationValueDatasaParams(a.specificationValueData)})})),t},getProductDataParams:function(e){return{id:e,parameterGroups:[],productImages:[],productImageDatas:[],reviews:[],specificationGroups:[]}},getSpecificationValueDatasaParams:function(e){var t=this,a=[];return e.forEach((function(e,i){var o=t.checkedIds.findIndex((function(t){return t===e.specificationId}));-1!==o&&a.push({id:e.id,name:e.name,image:e.image,sort:e.sort,specificationId:e.specificationId})})),a},operateHandler:function(e){this[e]()},rowDeleteClickHandler:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];a.push(e.productId);var i={ids:a};t.commodityList.splice(t.commodityList.indexOf(e),1),h["a"].delete(i,(function(a){t.$message({type:"success",message:"删除成功!"}),t.$emit("operationSuccess"),e.productId===t.id?t.$emit("close"):t.query()}),(function(e){console.log(e)}))})).catch((function(){}))},addSpecificationCommodityOperation:function(){if(!this.showEditOperationColumn)return this.$message.warning("请选择商品规格"),!1;var e={productId:"",specificationValueData:this.getNewSpecificationValueList()};this.commodityList.push(e)},getNewSpecificationValueList:function(){var e=this,t=[];return this.checkedIds.forEach((function(a,i){var o=e.allSpecificationList.findIndex((function(e){return e.id===a}));-1!==o&&t.push({id:"",name:"",image:"",sort:"",specificationId:e.allSpecificationList[o].id})})),t},handleCheckedChange:function(e){var t=this;this.allSpecificationList.forEach((function(a,i){var o=e.findIndex((function(e){return e===a.id}));if(-1!==o)return t.allSpecificationList[i].checked=!0,t.AddNewColumn2Commodity(t.allSpecificationList[i]),!0;t.allSpecificationList[i].checked=!1})),this.showEditOperationColumn=this.hasCheckedSpecification()},hasCheckedSpecification:function(){var e=!1;return this.allSpecificationList.forEach((function(t,a){t.checked&&(e=!0)})),e},AddNewColumn2Commodity:function(e){this.commodityList.forEach((function(t,a){var i=t.specificationValueData.findIndex((function(t){return t.specificationId===e.id}));-1===i&&t.specificationValueData.push({id:"",name:"",image:"",sort:"",specificationId:e.id})}))},saveSpecificationEditOperation:function(){this.update()},cancelSpecificationEditOperation:function(){this.checkedIds=[],this.commodityList=[],this.showEditOperationColumn=!1,this.refresh()}}},at=tt,it=(a("b822"),Object(v["a"])(at,Ze,Xe,!1,null,null,null)),ot=it.exports,nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"coupon-product"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"label-width":"130px",size:"small",model:e.coupon,rules:e.couponRules}},[a("el-form-item",{attrs:{label:"优惠券名称：",prop:"name"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入名称"},model:{value:e.coupon.name,callback:function(t){e.$set(e.coupon,"name",t)},expression:"coupon.name"}})],1),a("el-form-item",{attrs:{label:"面值：",prop:"amount"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入面值"},model:{value:e.coupon.amount,callback:function(t){e.$set(e.coupon,"amount",t)},expression:"coupon.amount"}})],1),a("el-form-item",{attrs:{label:"优惠券数量：",prop:"quantity"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.coupon.quantity,callback:function(t){e.$set(e.coupon,"quantity",t)},expression:"coupon.quantity"}},[a("template",{slot:"append"},[e._v("张")])],2)],1),a("el-form-item",{attrs:{label:"使用门槛："}},[a("el-radio",{attrs:{label:"false"},model:{value:e.coupon.hasMinimumPrice,callback:function(t){e.$set(e.coupon,"hasMinimumPrice",t)},expression:"coupon.hasMinimumPrice"}},[e._v("不限制")]),a("el-radio",{attrs:{label:"true"},model:{value:e.coupon.hasMinimumPrice,callback:function(t){e.$set(e.coupon,"hasMinimumPrice",t)},expression:"coupon.hasMinimumPrice"}},[e._v("限制")])],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"true"===e.coupon.hasMinimumPrice,expression:"coupon.hasMinimumPrice==='true'"}],attrs:{label:"门槛标准：",prop:"minimumPrice"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.coupon.minimumPrice,callback:function(t){e.$set(e.coupon,"minimumPrice",t)},expression:"coupon.minimumPrice"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{attrs:{label:"有效期截止",prop:"endDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择结束时间"},model:{value:e.coupon.endDate,callback:function(t){e.$set(e.coupon,"endDate",t)},expression:"coupon.endDate"}})],1),a("el-form-item",{attrs:{label:"允许参与商品",prop:"participationWay"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.coupon.participationWay,callback:function(t){e.$set(e.coupon,"participationWay",t)},expression:"coupon.participationWay"}},[e._v("全部")]),a("el-radio",{attrs:{label:"3"},model:{value:e.coupon.participationWay,callback:function(t){e.$set(e.coupon,"participationWay",t)},expression:"coupon.participationWay"}},[e._v("按商品")]),a("el-radio",{attrs:{label:"2"},model:{value:e.coupon.participationWay,callback:function(t){e.$set(e.coupon,"participationWay",t)},expression:"coupon.participationWay"}},[e._v("按品牌")]),a("el-radio",{attrs:{label:"1"},model:{value:e.coupon.participationWay,callback:function(t){e.$set(e.coupon,"participationWay",t)},expression:"coupon.participationWay"}},[e._v("按分类")]),a("participation-way",{attrs:{baseInfo:e.baseInfo,participationWay:e.coupon.participationWay},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)],1)],1)},rt=[],st=a("7668"),ct={name:"CouponProduct",components:{BizGrid:u["a"],BizSaveButton:d["a"],ParticipationWay:st["a"]},props:{id:{type:String,default:""}},data:function(){return{baseInfo:{},minimumPriceError:"",loading:!1,operations:[{label:"保存",name:"save",type:"primary",auth:["admin:product.edit"]}],selectedItems:[],coupon:{name:"",amount:"",hasMinimumPrice:"false",minimumPrice:"",quantity:"1",endDate:"",participationWay:"0"},couponRules:{name:[{required:!0,message:"请输入优惠券名称",trigger:"change"}],amount:[{required:!0,message:"请输入面值",trigger:"change"},{pattern:/^[0-9]+([.]{1}[0-9]{1,2})?$/,message:"请输入数值，保留小数点后两位",trigger:"change"}],quantity:[{required:!0,message:"请输入优惠券数量",trigger:"change"},{pattern:/^\+?[1-9][0-9]*$/,message:"请输入正整数",trigger:"change"}],minimumPrice:[{required:!0,trigger:"change",validator:this.minimumPriceValidator}],endDate:[{required:!0,message:"请选择结束时间",trigger:"change"}]}}},computed:{handledSelectedItems:function(){switch(this.coupon.participationWay){case"0":return{};case"3":return{products:this.selectedItems};case"2":return{shopBrands:this.selectedItems};case"1":return{productCategories:this.selectedItems};default:return{}}},handledBaseInfo:function(){return Object.assign({brands:[]},this.baseInfo)}},watch:{},created:function(){this.getBaseInfo()},methods:{operate:function(e){this[e]()},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.update()}))},update:function(){var e=this,t={id:this.id,coupon:{name:this.coupon.name,amount:this.coupon.amount,quantity:this.coupon.quantity,endDate:this.coupon.endDate,participationWay:this.coupon.participationWay,minimumPrice:"true"===this.coupon.hasMinimumPrice?this.coupon.minimumPrice:""}};Object.assign(t.coupon,this.handledSelectedItems),m["a"].post($["g"].productmgmt.CouponProduct,t).then((function(t){e.$message.success("更新优惠券信息成功")})).catch((function(t){e.$message.warning(t.errorMessage)}))},getCouponInfo:function(){var e=this,t={id:this.id};m["a"].get($["g"].productmgmt.CouponProduct,t).then((function(t){t=t.data.coupon,e.setSelectedItems(t),e.coupon.name=t.name,e.coupon.amount=t.amount,e.coupon.endDate=t.endDate,e.coupon.quantity=t.quantity,e.coupon.participationWay=t.participationWay,e.coupon.minimumPrice=t.minimumPrice||"",e.coupon.minimumPrice?e.coupon.hasMinimumPrice="true":e.coupon.hasMinimumPrice="false"}))},setSelectedItems:function(e){switch(e.participationWay){case"0":this.selectedItems=[];break;case"3":this.selectedItems=e.products;break;case"2":this.selectedItems=e.shopBrands;break;case"1":this.selectedItems=e.productCategories;break;default:this.selectedItems=[];break}},getBaseInfo:function(){var e=this,t={id:this.id,shopId:window.top.SHOP_ID||""};T["a"].queryProductBasicInfo(t,(function(t){e.baseInfo=t,e.baseInfo.productCategories=t.productCategoryTree,e.getCouponInfo()}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品基本信息失败",e.id)}))},minimumPriceValidator:function(e,t,a){"true"===this.coupon.hasMinimumPrice&&(t||(console.log(t),a(new Error("请输入门槛标准"))),/^[0-9]+([.]{1}[0-9]{1,2})?$/.test(t)||(this.minimumPriceError="请输入数值，保留小数点后两位",a(new Error("请输入数值，保留小数点后两位")))),a()}}},lt=ct,dt=(a("ef4a"),Object(v["a"])(lt,nt,rt,!1,null,null,null)),ut=dt.exports,pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vin-code"},[a("biz-flex-table",{directives:[{name:"show",rawName:"v-show",value:!e.showForm,expression:"!showForm"}],attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,pagination:e.pagination},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"selection-change":e.handleSelectionChange,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{"min-width":"100",prop:"number",label:"车辆识别码（VIN码）"}}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.del(t.row.id)}}},[e._v("删除")])]}}])})],1),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"车辆识别码",prop:"number"}},[a("el-input",{model:{value:e.formModel.number,callback:function(t){e.$set(e.formModel,"number",t)},expression:"formModel.number"}})],1)],1),a("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.formOperations},on:{operate:e.handleOperate}})],1)],1)},ht=[],mt={name:"RecordsList",data:function(){return{timer:null,formModel:{number:"",id:"",productId:""},isSetting:!1,open:!1,showForm:!1,tabName:"first",operations:[{label:"添加",name:"add",type:"primary",auth:["admin:product.edit"]},{label:"删除",name:"del",disabled:!0,auth:["admin:product.edit"]},{label:"刷新",name:"refresh",type:"",auth:["admin:product.edit"]}],formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"save",type:"primary"}],filters:[{type:"input",label:"",placeholder:"车辆识别码（VIN码）",value:""}],rules:{number:[{required:!0,message:"请输入车辆识别码",trigger:"blur"}]},pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},tableData:[],multiSelected:[]}},props:{itemId:{type:String},row:{type:Object,default:function(){return{}}}},methods:{operate:function(e){this[e]()},handleOperate:function(e){this[e]()},add:function(){this.formModel.number="",this.formModel.id="",this.showForm=!0},cancelForm:function(){this.showForm=!1},save:function(){var e=this;this.formModel.productId=this.itemId,this.$refs.form.validate((function(t){t&&(e.formModel.id&&m["a"].put("/admin/product/vinManage/vinCode.jhtml",e.formModel).then((function(t){e.$message.success("更新成功"),e.showForm=!1,e.refresh()})).catch((function(t){console.log(t),e.$message.warning(t.errorMessage)})),!e.formModel.id&&m["a"].post("/admin/product/vinManage/vinCode.jhtml",e.formModel).then((function(t){e.$message.success("保存成功"),e.showForm=!1,e.refresh()})).catch((function(t){console.log(t),e.$message.warning(t.errorMessage)})))}))},del:function(e){var t=this,a=e?Array(e):this.multiSelected;0!==a.length?this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e={ids:a,shopId:window.top.SHOP_ID};m["a"].delete("/admin/product/vinManage/vinCode.jhtml",e).then((function(e){t.$message.success("删除成功"),t.refresh()})).catch((function(e){console.log(e),console.log("code错误")}))})):this.$message.warning("未选择删除条目")},filterDataChange:function(e){console.log("> ",e),this.filters=e,this.pagination.currentPage=1,this.refresh()},handleSelectionChange:function(e){var t=this;this.multiSelected=[],e.length>0?this.operations[1].disabled=!1:this.operations[1].disabled=!0,e.map((function(e){t.multiSelected=t.multiSelected.concat(e.id)}))},rowClick:function(e){this.formModel.number=e.number,this.formModel.id=e.id,this.showForm=!0},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},close:function(){this.open=!1},refresh:function(){var e=this;console.log("filters: ",this.filters),this.showForm=!1;var t={productId:this.itemId,searchValue:this.filters[0].value,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};m["a"].get("/admin/product/vinManage/vinCodes.jhtml",t).then((function(t){e.tableData=t.dataList,e.pagination.total=Number(t.total)})).catch((function(t){console.log(t),e.$message.warning(t.errorMessage)}))},showMessage:function(e,t){this.$message({showClose:!0,message:e,type:t})}},computed:Object(r["a"])({},Object(w["c"])(["getUser"])),created:function(){this.refresh()},watch:{itemId:function(e,t){this.refresh()}},components:{BizFlexTable:s["c"],BizSaveButton:d["a"]}},ft=mt,gt=(a("f0df7"),Object(v["a"])(ft,pt,ht,!1,null,null,null)),bt=gt.exports,vt={name:"TerminalClassPopup",components:{BizPopupTabs:D["a"],BaseInfo:J,Detail:oe,PictureInfo:Ee,Parameter:Ye,Specification:ot,CouponProduct:ut,VinCode:bt,VrInfo:Ge,HighLights:ue,CompetingProducts:be},props:{baseInfo:{type:Object,default:function(){return{shop:{name:""}}}},open:{type:Boolean},categoryName:{type:String},isEdit:{type:Boolean},id:{type:String,default:""},categoryType:{type:String,default:""},specName:{type:String,default:""}},data:function(){return{tabSelection:"baseinfo"}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)},createdProductSuccess:function(e,t){this.$emit("createdProductSuccess",e,t)}},watch:{open:function(e){e||(this.tabSelection="baseinfo")}}},yt=vt,It=Object(v["a"])(yt,C,S,!1,null,null,null),wt=It.exports,Ct=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"create-vehicle"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,"label-width":"100px",model:e.form,size:"small"}},[a("el-form-item",{attrs:{label:"品牌：",prop:"brandId"}},[a("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},on:{change:e.getVehicleSeries},model:{value:e.form.brandId,callback:function(t){e.$set(e.form,"brandId",t)},expression:"form.brandId"}},e._l(e.brandOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"系列："}},[a("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},on:{change:e.getVehicleNames},model:{value:e.form.seriesId,callback:function(t){e.$set(e.form,"seriesId",t)},expression:"form.seriesId"}},e._l(e.seriesOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"名称："}},[a("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},model:{value:e.form.nameId,callback:function(t){e.$set(e.form,"nameId",t)},expression:"form.nameId"}},e._l(e.nameOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1)},St=[],Dt=a("a2a7"),Pt={name:"CreatVehicle",components:{BizSaveButton:d["a"],BizGrid:u["a"]},data:function(){return{loading:!1,operations:[{label:"保存",name:"save",type:"primary",auth:["admin:product.edit"]}],rules:{brandId:[{required:!0,message:"请选择品牌",trigger:["blur","change"]}]},brandOptions:[],seriesOptions:[],nameOptions:[],form:{brandId:"",seriesId:"",nameId:""}}},props:{open:{type:Boolean}},watch:{open:function(e){e?this.getVehicleBrands():(this.brandOptions=[],this.seriesOptions=[],this.nameOptions=[],this.form.brandId="",this.form.seriesId="",this.form.nameId="")}},created:function(){},computed:{},methods:{operate:function(e){this[e]()},getVehicleBrands:function(){var e=this;this.form.brandId="",this.form.seriesId="",this.form.nameId="";var t={shopId:window.top.SHOP_ID||""};Dt["a"].getVehicleBrands(t,(function(t){e.brandOptions=t.brands}),(function(a){""!==a.errorMessage&&e.$message.warning(a.errorMessage),console.log("获取品牌失败:",t)}))},getVehicleSeries:function(){var e=this;if(this.form.seriesId="",this.form.nameId="",""===this.form.brandId)return this.seriesOptions=[],void(this.nameOptions=[]);var t={shopBrandId:this.form.brandId};Dt["a"].getVehicleSeries(t,(function(t){e.seriesOptions=t.series}),(function(a){""!==a.errorMessage&&e.$message.warning(a.errorMessage),console.log("获取系列失败:",t)}))},getVehicleNames:function(){var e=this;if(this.form.nameId="",""!==this.form.seriesId){var t={brandId:this.form.brandId,seriesId:this.form.seriesId};Dt["a"].getVehicleNames(t,(function(t){e.nameOptions=t.CarTypes}),(function(a){""!==a.errorMessage&&e.$message.warning(a.errorMessage),console.log("获取名称失败:",t)}))}else this.nameOptions=[]},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.loading=!0;var a={shopId:window.top.SHOP_ID||"",brandId:e.form.brandId,seriesId:e.form.seriesId,type:e.form.nameId};Dt["a"].createVehicle(a,(function(t){e.loading=!1,e.$emit("operationSuccess"),e.$message.success("创建整车成功")}),(function(t){e.loading=!1,""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("创建整车失败")}))}))}}},kt=Pt,Mt=(a("8a08"),Object(v["a"])(kt,Ct,St,!1,null,null,null)),xt=Mt.exports,Tt=a("443b"),Vt={name:"CommodityMgmt",data:function(){return{tableId:"3",productCategoryId:"",categoryName:"",rowBaseInfo:{},loading:!1,defaultImg:"/resources/admin/images/default/product-default.png",errorImg:'this.src="/resources/admin/images/default/product-default.png"',importtabName:"baseinfo",createVehicleTabName:"createVehicle",refreshSign:!0,multipleSelection:[],editShopIds:[],addId:"",categoryType:"",open:!1,isEdit:!0,openimport:!1,createVehicle:!1,showRecommend:!1,operations:[{label:"添加",name:"add",type:"primary",auth:["admin:product.add"]},{disabled:!0,label:"删除",name:"del",type:"",auth:["admin:product.delete"]},{disabled:!0,label:"批量上架",name:"putaway",type:"",auth:["admin:product.on"]},{disabled:!0,label:"批量下架",name:"soldout",type:"",auth:["admin:product.off"]},{label:"刷新",name:"refresh",type:""},{disabled:!0,label:"克隆",name:"clone",type:"",auth:["admin:product.copy"]},{label:"创建整车",name:"creat",type:"",class:"hidden"},{label:"导入",name:"lead",type:"",auth:["admin:product.import"]}],filters:[{type:"cascader",label:"分类",name:"category",filterable:!1,value:[],class:"hidden",options:[]},{type:"select",label:"品牌",value:"",class:"hidden",options:[]},{type:"select",label:"状态",value:"",class:"hidden",options:[]},{type:"select",label:"店铺",value:"",class:"hidden",options:[]},{type:"select",label:"类型",value:"",class:"hidden",options:[{label:"全部",value:""},{label:"普通商品",value:"0"},{label:"有价优惠券商品",value:"7"}]},{type:"input",label:"",placeholder:"请输入编号/名称",value:""}],tableData:[],categoryDatas:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},sortInfo:{},specName:""}},components:{CommodityPopup:wt,BizFlexTable:s["c"],ImportProduct:I,BizPopupTabs:D["a"],CreateVehicle:xt},created:function(){this.getUser(),this.refresh(),this.queryFilters(),this.getEditableStores(),this.getDefalutImg();var e="维护店铺商品，编辑商品基本信息、详情、商品图片以及商品规格、属性等";this.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:e,duration:3e3})},mounted:function(){this.filters[0].value=[""]},computed:Object(r["a"])(Object(r["a"])({},Object(w["c"])("Authority",["currentAuth"])),{},{hasAuthDel:function(){return this.currentAuth.includes("admin:product.delete")},hasAuthOn:function(){return this.currentAuth.includes("admin:product.on")},hasAuthOff:function(){return this.currentAuth.includes("admin:product.off")},hasAuthEdit:function(){return this.currentAuth.includes("admin:product.edit")},toggleRecommendTxt:function(){var e=this.showRecommend;return e?"收起":"筛选"}}),mixins:[Tt["a"]],methods:Object(r["a"])(Object(r["a"])({},Object(w["c"])(["getUser"])),{},{getWidth:function(e){switch(e.id){case"1":return"400";case"4":return"120";case"5":return"150";default:return""}},getSortable:function(e){switch(e.id){case"4":return"custom";case"5":return"custom";case"6":return"custom";default:return!1}},getProp:function(e){switch(e.id){case"4":return"price";case"5":return"stock";case"6":return"sales";default:return""}},isShow:function(){this.showRecommend?(this.filters[0].class="hidden",this.filters[1].class="hidden",this.filters[2].class="hidden",this.filters[3].class="hidden",this.filters[4].class="hidden"):(this.filters[0].class="show",this.filters[1].class="show",this.filters[2].class="show",this.filters[3].class="show",this.filters[4].class="show"),this.showRecommend=!this.showRecommend},canSubmited:function(e){return!!e.unionConfig&&(!!e.unionConfig.auditConfig&&"1"===e.unionConfig.auditConfig.deliverable)},canPassed:function(e){return!!e.unionConfig&&(!!e.unionConfig.auditConfig&&"1"===e.unionConfig.auditConfig.passable)},canCancel:function(e){return!!e.unionConfig&&(!!e.unionConfig.auditConfig&&"1"===e.unionConfig.auditConfig.cancelable)},canOnsale:function(e){return!!e.unionConfig&&(!!e.unionConfig.auditConfig&&"1"===e.unionConfig.auditConfig.onsaleable)},canOffsale:function(e){return!!e.unionConfig&&(!!e.unionConfig.auditConfig&&"1"===e.unionConfig.auditConfig.offsaleable)},canRevocationed:function(e){return!!e.unionConfig&&(!!e.unionConfig.auditConfig&&"1"===e.unionConfig.auditConfig.revocable)},canEdited:function(e){return!!e.unionConfig&&"1"===e.unionConfig.editable},operate:function(e){this[e]()},refresh:function(){this.getList()},createdProductSuccess:function(e,t){this.addId=e,this.rowBaseInfo.productType=t},rowClick:function(e){this.refreshSign=!this.refreshSign,this.addId=e.id,this.categoryName=e.categoryName,this.categoryType=e.categoryType,this.specName=-1!==e.fullName.indexOf("[")?e.fullName.split("[")[1].split("]")[0]:"","0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel?this.isEdit=!1:this.isEdit=!0,this.rowBaseInfo=e,this.open=!0,console.log(this.specName)},stateColor:function(e){return e.stock>5?"#333333":"#f56c6c"},toPrice:function(e){return e=parseFloat(e).toFixed(2).toString().split("."),e[0]=e[0].replace(new RegExp("(\\d)(?=(\\d{3})+$)","ig"),"$1,"),e.join(".")},getEditableStores:function(){var e=this;m["a"].get($["j"].editableStores,{resourceType:"2"}).then((function(t){e.editShopIds=[],t.dataList.map((function(t){e.editShopIds.push(t.id)}))})).catch((function(e){console.log(e),console.log("code错误")}))},getDefalutImg:function(){var e=this;m["a"].get("/admin/settings/settings.jhtml",{type:"displaySetting"}).then((function(t){t.settingList.defaultThumbnailProductImage&&t.settingList.defaultThumbnailProductImage&&(e.defaultImg=t.settingList.defaultThumbnailProductImage)})).catch((function(e){console.log(e),console.log("code错误")}))},getList:function(){var e=this,t={productCategoryId:this.productCategoryId,brandId:this.getSelectedBrandId(),state:this.getSelectedState(),searchShopId:this.getSelectedShopId(),productType:this.filters[4].value,searchValue:this.filters[5].value,shopId:window.top.SHOP_ID,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,orderProperty:this.sortInfo.column,orderDirection:this.sortInfo.sort};!0!==this.open&&!0!==this.openimport&&!0!==this.createVehicle&&(this.loading=!0),h["a"].getCommodityList(t,(function(t){e.tableData=t.content,e.pagination.total=Number(t.total),e.loading=!1}),(function(t){console.log(t),e.loading=!1,e.$message.warning(t.errorMessage)}))},filterDataChange:function(e){this.pagination.currentPage=1,this.refresh()},lead:function(){this.$refs.openimport.handleImportCar()},openPoup:function(){this.openimport=!0},closePoup:function(){this.openimport=!1},creat:function(){this.createVehicle=!0},add:function(){this.addId="",this.isEdit=!0,this.open=!0},cascaderChange:function(e){0===e.length?(this.productCategoryId="",this.filters[0].value=[""]):(this.productCategoryId=e[e.length-1],e.length>1&&""===this.productCategoryId&&(this.productCategoryId=e[e.length-2])),this.refresh()},activeItemChange:function(e){var t=this,a={shopId:this.getUser().shop.id,parentId:e.toString()};m["a"].get("/admin/shopProduct/productCategorys.jhtml",a).then((function(a){var i;t.setCategoryFilters(),t.filters[0].options.forEach((function(t){t.value===e[0]&&(i=t.children)})),a.dateList.forEach((function(e){i.push({value:e.id,label:e.name})}))})).catch((function(){}))},handleSelectionChange:function(e){this.operations.map((function(e){"del"!==e.name&&"putaway"!==e.name&&"soldout"!==e.name&&"clone"!==e.name||(e.disabled=!0)})),(e.length>0||"shop"!==this.getUser().roleLevel)&&this.operations.map((function(e){"del"!==e.name&&"putaway"!==e.name&&"soldout"!==e.name&&"clone"!==e.name||(e.disabled=!1)})),this.multipleSelection=e},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},deleteRecommend:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];a.push(e);var i={ids:a};h["a"].delete(i,(function(e){t.$message({type:"success",message:"删除成功!"}),t.refresh()}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))})).catch((function(){}))},soldout:function(e){var t=this;this.$confirm("是否确认下架?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];if(e)a.push(e);else{var i,o=Object(n["a"])(t.multipleSelection);try{for(o.s();!(i=o.n()).done;){var r=i.value;a.push(r.id)}}catch(c){o.e(c)}finally{o.f()}}var s={ids:a,state:"false"};h["a"].soldoutAndPutaway(s,(function(e){t.$message({type:"success",message:"下架成功!"}),t.refresh()}),(function(e){console.log(e),t.$message.warning(e.errorMessage)}))})).catch((function(){}))},putaway:function(e){var t=this;this.$confirm("是否确认上架?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];if(e)a.push(e);else{var i,o=Object(n["a"])(t.multipleSelection);try{for(o.s();!(i=o.n()).done;){var r=i.value;a.push(r.id)}}catch(c){o.e(c)}finally{o.f()}}var s={ids:a,state:"true"};h["a"].soldoutAndPutaway(s,(function(e){t.$message({type:"success",message:"上架成功!"}),t.refresh()}),(function(e){console.log(e),t.$message.warning(e.errorMessage)}))})).catch((function(){}))},del:function(){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t,a=[],i=Object(n["a"])(e.multipleSelection);try{for(i.s();!(t=i.n()).done;){var o=t.value;a.push(o.id)}}catch(s){i.e(s)}finally{i.f()}var r={ids:a};h["a"].delete(r,(function(t){e.$message({type:"success",message:"删除成功!"}),e.refresh()}),(function(t){e.$message.warning(t.errorMessage),console.log(t)}))})).catch((function(){}))},audit:function(e,t){var a=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={eventId:e.id,type:"2",unionStore:e.unionStore,mainStore:e.mainStore,state:t};h["a"].audit(i,(function(e){a.$message({type:"success",message:"操作成功!"}),a.refresh()}),(function(e){a.$message.warning(e.errorMessage),console.log(e)}))})).catch((function(){}))},auditTarget:function(e){var t=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={eventId:e.id,type:"2",unionStore:e.unionStore,mainStore:e.mainStore};h["a"].auditTarget(a,(function(e){t.$message({type:"success",message:"操作成功!"}),t.refresh()}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))})).catch((function(){}))},recallProduct:function(e){var t=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={id:e};h["a"].recallProduct(a,(function(e){t.$message({type:"success",message:"操作成功!"}),t.refresh()}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))})).catch((function(){}))},clone:function(){var e,t=this,a=[],i=Object(n["a"])(this.multipleSelection);try{for(i.s();!(e=i.n()).done;){var o=e.value;a.push(o.id)}}catch(s){i.e(s)}finally{i.f()}var r={ids:a};h["a"].cloneProduct(r,(function(e){t.$message({type:"success",message:"克隆成功!"}),t.refresh()}),(function(e){console.log(e),t.$message.error(e.errorMessage)}))},getStatus:function(e){switch(e.state){case"0":return"已创建";case"1":return"已提交";case"2":return"已上架";case"3":return"已下架";default:break}return""},filterChange:function(e){this.$refs.table.doLayout()},queryFilters:function(){var e=this,t={shopId:window.top.SHOP_ID||""};h["a"].queryFilters(t,(function(t){e.categoryDatas=t.categoryDatas,e.setCategoryFilters(),e.setBrandFilters(t.brandDatas),e.setStateFilters(t.states),e.setStoreFilters(t.storeDatas)}),(function(a){""!==a.errorMessage&&e.$message.error(a.errorMessage),console.log("获取过滤器失败",t)}))},handleSortChange:function(e){console.log("column",e),this.sortInfo={column:e.prop,sort:e.order?"ascending"===e.order?"asc":"desc":void 0},this.getList()},setCategoryFilters:function(){var e=[{value:"",label:"全部"}];this.categoryDatas.forEach((function(t){e.push({value:t.id,label:t.name,children:[{label:"全部",value:""}]})})),this.filters[0].options=e},setBrandFilters:function(e){this.filters[1].options=e.map((function(e){return{value:e.id,label:e.name}})),this.filters[1].options.splice(0,0,{value:"",label:"全部"})},setStateFilters:function(e){this.filters[2].options=e.map((function(e){return{value:e.id,label:e.name}})),this.filters[2].options.splice(0,0,{value:"",label:"全部"})},setStoreFilters:function(e){this.filters[3].options=e.map((function(e){return{value:e.id,label:e.name}})),this.filters[3].options.splice(0,0,{value:"",label:"全部"})},getSelectedBrandId:function(){return this.filters[1].value},getSelectedState:function(){var e=this;if(0===this.filters[2].options.length)return"";var t=this.filters[2].options.findIndex((function(t){return t.value===e.filters[2].value}));return t<=0?"":String(t-1)},getSelectedShopId:function(){return this.filters[3].value}})},_t=Vt,$t=(a("3d7f"),Object(v["a"])(_t,i,o,!1,null,null,null));t["default"]=$t.exports},"843b":function(e,t,a){"use strict";var i=a("e827"),o=a.n(i);o.a},"85aa":function(e,t,a){"use strict";var i=a("036c"),o=a.n(i);o.a},"8a08":function(e,t,a){"use strict";var i=a("4f61"),o=a.n(i);o.a},"8a77":function(e,t,a){},9678:function(e,t,a){},"9b77":function(e,t,a){},a2a7:function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getVehicleBrands:function(e,t,a){n.a.get(r["g"].commodity.getVehicleBrands,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},getVehicleSeries:function(e,t,a){n.a.get(r["g"].commodity.getSeries,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},getVehicleNames:function(e,t,a){n.a.get(r["g"].commodity.getVehicleNames,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},createVehicle:function(e,t,a){n.a.post(r["g"].commodity.createVehicle,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},a513:function(e,t,a){"use strict";var i=a("245a"),o=a.n(i);o.a},a5a5:function(e,t,a){"use strict";var i=a("a6a4"),o=a.n(i);o.a},a6a4:function(e,t,a){},abc3:function(e,t,a){},af3f:function(e,t,a){"use strict";var i=a("697f");t["a"]=i["a"]},b537:function(e,t,a){"use strict";var i=a("db02"),o=a.n(i);o.a},b547:function(e,t,a){},b680:function(e,t,a){"use strict";var i=a("23e7"),o=a("a691"),n=a("408a"),r=a("1148"),s=a("d039"),c=1..toFixed,l=Math.floor,d=function(e,t,a){return 0===t?a:t%2===1?d(e,t-1,a*e):d(e*e,t/2,a)},u=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},p=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){c.call({})}));i({target:"Number",proto:!0,forced:p},{toFixed:function(e){var t,a,i,s,c=n(this),p=o(e),h=[0,0,0,0,0,0],m="",f="0",g=function(e,t){var a=-1,i=t;while(++a<6)i+=e*h[a],h[a]=i%1e7,i=l(i/1e7)},b=function(e){var t=6,a=0;while(--t>=0)a+=h[t],h[t]=l(a/e),a=a%e*1e7},v=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==h[e]){var a=String(h[e]);t=""===t?a:t+r.call("0",7-a.length)+a}return t};if(p<0||p>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(m="-",c=-c),c>1e-21)if(t=u(c*d(2,69,1))-69,a=t<0?c*d(2,-t,1):c/d(2,t,1),a*=4503599627370496,t=52-t,t>0){g(0,a),i=p;while(i>=7)g(1e7,0),i-=7;g(d(10,i,1),0),i=t-1;while(i>=23)b(1<<23),i-=23;b(1<<i),g(1,1),b(2),f=v()}else g(0,a),g(1<<-t,0),f=v()+r.call("0",p);return p>0?(s=f.length,f=m+(s<=p?"0."+r.call("0",p-s)+f:f.slice(0,s-p)+"."+f.slice(s-p))):f=m+f,f}})},b822:function(e,t,a){"use strict";var i=a("cbc8"),o=a.n(i);o.a},c751:function(e,t,a){},c8d2:function(e,t,a){var i=a("d039"),o=a("5899"),n="​᠎";e.exports=function(e){return i((function(){return!!o[e]()||n[e]()!=n||o[e].name!==e}))}},cbc8:function(e,t,a){},cc55:function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getProductCategoryList:function(e,t,a){n.a.get(r["g"].commodity.getProductCategoryList,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},deleteProductCategory:function(e,t,a){n.a.delete(r["g"].commodity.deleteProductCategory,{data:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},getInputProductCategoryList:function(e,t,a){console.log("[---- dachao ----] [API-从平台导入-get] getInputProductCategoryList() params=",e),n.a.get(r["g"].commodity.getInputProductCategoryList,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},saveInputProductCategoryList:function(e,t,a){console.log("[---- dachao ----] [API-从平台导入-post] saveInputProductCategoryList() params=",e),n.a.post(r["g"].commodity.saveInputProductCategoryList,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},ccf0:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-import-file"},[a("el-upload",{attrs:{"show-file-list":!1,"on-success":e.handleSuccess,"on-error":e.handleError,"on-progress":e.handleProgress,"before-upload":e.handleBeforeUpload,data:e.data,name:e.name,action:e.action,accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}},[e.disabled?a("el-button",{attrs:{size:"mini",type:"",loading:e.loading},on:{click:function(t){return t.stopPropagation(),e.handleImport(t)}}},[e.$slots.content||e.content?a("div",{staticClass:"biz-card__header"},[e._t("content",[e._v(e._s(e.content))])],2):e._e()]):e._e(),e.disabled?e._e():a("el-button",{attrs:{size:"mini",type:"",loading:e.loading}},[e.$slots.content||e.content?a("div",{staticClass:"biz-card__header"},[e._t("content",[e._v(e._s(e.content))])],2):e._e()])],1),a("el-dialog",{staticClass:"biz-import-file__uploading-dialog",attrs:{title:e.title,visible:e.uploadingVisible,"append-to-body":""},on:{"update:visible":function(t){e.uploadingVisible=t},close:e.clearTimeOut}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showInfo,expression:"showInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("成功导入："+e._s(e.count)+"条")]),a("span",{staticClass:"error"},[e._v("共计："+e._s(e.total)+"条")])]),a("el-progress",{staticClass:"biz-import-file__uploading-dialog__progress",attrs:{"stroke-width":12,percentage:e.percentage}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showCurrentInfo,expression:"showCurrentInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("正在导入："+e._s(e.stepkey))])])],1),a("el-dialog",{staticClass:"biz-import-file__importing-dialog",attrs:{title:"导入结果",visible:e.importingVisible,"append-to-body":""},on:{"update:visible":function(t){e.importingVisible=t}}},[a("div",{staticClass:"importing-dialog__content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.importLoading,expression:"importLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{size:"small",stripe:"",border:"",height:400,data:e.tableData,"tooltip-effect":"dark","element-loading-text":"导入中，请稍后"}},[e._t("default")],2)],1)])],1)},o=[],n=(a("c975"),a("baa5"),a("b0c0"),a("a9e3"),{name:"ImportFile",props:{showInfo:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}},showProcess:{type:Boolean,default:function(){return!1}},content:{type:String,default:function(){return"导入"}},data:{type:Object,default:function(){return{type:"3"}}},name:{type:String,default:function(){return"file"}},action:{type:String,default:function(){return"/admin/file/uploads.jhtml"}},tableData:{type:Array,required:!0},total:{type:Number,default:function(){return 0}},count:{type:Number,default:function(){return 0}},percentage:{type:Number,default:function(){return 0}},stepkey:{type:String,default:function(){return""}},importLoading:{type:Boolean,default:function(){return!1}}},data:function(){return{loading:!1,t:"",title:"导入中",showCurrentInfo:!0,uploadingVisible:!1,importingVisible:!1}},methods:{handleBeforeUpload:function(e){if(this.clearTimeOut(),-1===e.name.indexOf("."))return this.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)"),!1;var t=e.name.lastIndexOf("."),a=e.name.substring(t+1);if(!/(?:xls|xlsx)$/i.test(a))return this.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)"),!1;this.textEl&&(this.textEl.style.left=0)},handleProgress:function(e,t,a){console.log("导入中"),this.uploadingVisible=!0,this.$emit("restProcess");var i=this;setTimeout((function(){i.handleImport()}),2e3)},handleSuccess:function(e,t,a){var i=this;console.log("导入完成"),"100"===e.resultCode?setTimeout((function(){if(e.fis){var t=e.fis[0].url;t?i.doImport(t,e):i.$message.warning("请确认上传文件为Excel扩展类型(.xls/.xlsx)")}}),600):(console.log("失败1"),this.$message.warning("发生错误"),this.uploadingVisible=!1)},handleError:function(e,t,a){console.log("失败"),e?this.$message.warning(e):(this.uploadingVisible=!1,this.$message.warning("发生错误"))},clearTimeOut:function(){this.$emit("clearTimeOut")},handleImport:function(e){this.uploadingVisible=!0,this.$emit("handle-import",e)},doImport:function(e,t){var a=this;setTimeout((function(){a.importingVisible=!0}),0),this.$emit("on-import",e,t)}}}),r=n,s=(a("0413"),a("2877")),c=Object(s["a"])(r,i,o,!1,null,null,null),l=c.exports,d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-import-file"},[a("el-dialog",{staticClass:"biz-import-file__uploading-dialog",attrs:{title:e.title,visible:e.uploadingVisible,"append-to-body":""},on:{"update:visible":function(t){e.uploadingVisible=t},close:e.clearTimeOut}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showInfo,expression:"showInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("成功导出："+e._s(e.count)+"条")]),a("span",{staticClass:"error"},[e._v("共计："+e._s(e.total)+"条")])]),a("el-progress",{staticClass:"biz-import-file__uploading-dialog__progress",attrs:{"stroke-width":12,percentage:e.percentage}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showCurrentInfo,expression:"showCurrentInfo"}],staticClass:"info"},[a("span",{staticClass:"success"},[e._v("正在导出："+e._s(e.stepkey))])])],1)],1)},u=[],p={name:"ImportFile",props:{showInfo:{type:Boolean,default:function(){return!0}},total:{type:Number,default:function(){return 0}},count:{type:Number,default:function(){return 0}},percentage:{type:Number,default:function(){return 0}},stepkey:{type:String,default:function(){return""}}},data:function(){return{loading:!1,t:"",title:"导出中",showCurrentInfo:!0,uploadingVisible:!1}},methods:{clearTimeOut:function(){this.$emit("clearTimeOut")}}},h=p,m=(a("e7d9"),Object(s["a"])(h,d,u,!1,null,null,null)),f=m.exports;a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return f}))},cf81:function(e,t,a){},d4c2:function(e,t,a){"use strict";var i=a("e725"),o=a.n(i);o.a},d8bc:function(e,t,a){},daa4:function(e,t,a){"use strict";var i=a("2807"),o=a.n(i);o.a},db02:function(e,t,a){},e4c3:function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={queryPeople:function(e,t,a){n.a.get(r["g"].vehicleMgmt.Component_queryPeople,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryVehicles:function(e,t,a,o){n.a.get(e,{params:t}).then(Object(i["a"])(a,o)).catch((function(e){console.error(e)}))}}},e725:function(e,t,a){},e7d9:function(e,t,a){"use strict";var i=a("9b77"),o=a.n(i);o.a},e827:function(e,t,a){},ec6b:function(e,t,a){"use strict";var i=a("b547"),o=a.n(i);o.a},ef4a:function(e,t,a){"use strict";var i=a("8a77"),o=a.n(i);o.a},f0df7:function(e,t,a){"use strict";var i=a("cf81"),o=a.n(i);o.a},f24b:function(e,t,a){},f3ac:function(e,t,a){e.exports=a.p+"static/img/pic_default_none_100.6603f4ac.png"}}]);