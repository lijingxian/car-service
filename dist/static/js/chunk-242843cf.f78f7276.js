(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-242843cf"],{"04b8":function(e,t,a){"use strict";t["a"]={isUnifiedSocialCreditCode:function(e){var t=/^[0-9A-Z]{18}$/;return t.test(e)},isMobile:function(e){var t=/^1(3|4|5|7|8|9)\d{9}$/;return t.test(e)},isNaturalNum:function(e){var t=/^(0|[1-9][0-9]*)$/;return t.test(e)},isIdCard:function(e){var t=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/;return t.test(e)},isPlateNum:function(e){var t=/([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}(([0-9]{5}[DF])|([DF]([A-HJ-NP-Z0-9])[0-9]{4})))|([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳]{1})/;return t.test(e)},isPostNum:function(e){var t=/^[0-9]{6}$/;return t.test(e)},isMail:function(e){var t=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/;return t.test(e)},isNum:function(e){var t=/^\d+$/;return t.test(e)}}},1367:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"merchants-mgmt-psn-qua"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small",disabled:"1"===e.form.state||"3"===this.state,"inline-message":!0}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入姓名",minlength:"1",maxlength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"身份证号",prop:"idCartCode"}},[a("el-input",{attrs:{placeholder:"请输入身份证号"},model:{value:e.form.idCartCode,callback:function(t){e.$set(e.form,"idCartCode",t)},expression:"form.idCartCode"}})],1),a("el-form-item",{attrs:{label:"手持身份证",required:!0,error:""===e.form.personImg?"请上传所需照片":""}},[a("BizAvatarUploaderNew",{model:{value:e.form.personImg,callback:function(t){e.$set(e.form,"personImg",t)},expression:"form.personImg"}})],1),a("el-form-item",{attrs:{label:"身份证正面",required:!0,error:""===e.form.idCartImgFront?"请上传所需照片":""}},[a("BizAvatarUploaderNew",{model:{value:e.form.idCartImgFront,callback:function(t){e.$set(e.form,"idCartImgFront",t)},expression:"form.idCartImgFront"}})],1),a("el-form-item",{attrs:{label:"身份证反面",required:!0,error:""===e.form.idCartImgBack?"请上传所需照片":""}},[a("BizAvatarUploaderNew",{model:{value:e.form.idCartImgBack,callback:function(t){e.$set(e.form,"idCartImgBack",t)},expression:"form.idCartImgBack"}})],1),a("el-form-item",{attrs:{label:"所在区域",prop:"areaId"}},[a("biz-area-select",{attrs:{areaId:e.form.areaId},on:{areaChanged:e.areaChanged}})],1),a("el-form-item",{attrs:{label:"详细街道地址",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入详细地址",type:"textarea"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),a("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),a("el-form-item",{attrs:{label:"店铺名称",prop:"shopName"}},[a("el-input",{attrs:{placeholder:"请输入您想申请的店铺名称"},model:{value:e.form.shopName,callback:function(t){e.$set(e.form,"shopName",t)},expression:"form.shopName"}})],1),a("el-form-item",{attrs:{label:"主营业务",prop:"majorBusiness"}},[a("el-input",{attrs:{placeholder:"请输入您的主营业务",type:"textarea"},model:{value:e.form.majorBusiness,callback:function(t){e.$set(e.form,"majorBusiness",t)},expression:"form.majorBusiness"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{disabled:""},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[a("el-option",{attrs:{label:"未审核",value:"0"}}),a("el-option",{attrs:{label:"通过",value:"1"}}),a("el-option",{attrs:{label:"未通过",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),a("el-dialog",{attrs:{slot:"float",title:"审核未通过邮件","append-to-body":"",visible:e.auditFailedDialog,"custom-class":"qualificationDialog"},on:{"update:visible":function(t){e.auditFailedDialog=t}},slot:"float"},[a("el-form",{attrs:{"label-width":"90px",size:"small"}},[a("el-form-item",{attrs:{label:"收件人地址"}},[a("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),a("el-form-item",{attrs:{label:"邮件标题"}},[a("el-input",{model:{value:e.auditFailedEmali.subject,callback:function(t){e.$set(e.auditFailedEmali,"subject",t)},expression:"auditFailedEmali.subject"}})],1),a("el-form-item",{attrs:{label:"邮件内容"}},[a("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.auditFailedEmali.content,callback:function(t){e.$set(e.auditFailedEmali,"content",t)},expression:"auditFailedEmali.content"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.auditFailedDialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendAuditFailedEmail}},[e._v("发送")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisiblePass,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisiblePass=t}}},[a("span",[e._v(e._s(e.form.mobile)+"已被注册，请确认是否通过")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisiblePass=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onPassed}},[e._v("确 定")])],1)])],1)},s=[],o=(a("b0c0"),a("d3b7"),a("96cf"),a("1da1")),n=a("f36f"),r=a("8330"),l=a("ce2e"),c=a("2497"),m=a("bc3a"),d=a.n(m),u=a("c596"),f={get:function(e,t,a){d.a.get(u["g"].merchantsMgmt.selectPsnQua,{params:e}).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))},save:function(e,t,a){d.a.get(u["g"].merchantsMgmt.updatePsnQua,{params:e}).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))},create:function(e,t,a){d.a.get(u["g"].merchantsMgmt.createPsnQua,{params:e}).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))},passed:function(e,t,a){d.a.get(u["g"].merchantsMgmt.passedPsnQua,{params:e}).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))},abandoned:function(e,t,a){d.a.get(u["g"].merchantsMgmt.abandonedPsnQua,{params:e}).then(Object(c["a"])(t,a)).catch((function(e){console.error(e)}))}},p=a("5773"),b=a("c17f"),h=a("40ae"),g=a("1ab1"),v={name:"MerchantsMgmtPsnQua",components:{BizSaveButton:r["a"],BizAreaSelect:l["a"],BizGrid:n["a"],BizAvatarUploaderNew:b["b"],BizEditor:h["a"]},data:function(){var e=function(e,t,a){var i=/^1\d{10}$/;i.test(t)?a():a(new Error("请输入正确的手机号码"))},t=function(e,t,a){var i=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;i.test(t)?a():a(new Error("请输入正确的身份证"))};return{auditFailedDialog:!1,loading:!1,isCreated:!1,dialogVisiblePass:!1,updateId:"",email:"",userId:"",form:{name:"",idCartCode:"",personImg:"",idCartImgFront:"",idCartImgBack:"",areaId:"",address:"",mobile:"",shopName:"",majorBusiness:"",state:"0",remark:"",fileData:{type:"0"}},operations:[{disabled:!1,label:"废弃",name:"onAbandoned",type:"danger"},{disabled:!1,label:"审核未通过邮件",name:"auditFailed",type:"primary"},{disabled:!1,label:"通过",name:"pass",type:"primary"},{disabled:!1,label:"保存",name:"save",type:"primary"}],auditFailedEmali:{subject:"V服爱车信息审核反馈通知(重要)",content:""},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],idCartCode:[{required:!0,message:"请输入身份证号码",trigger:"blur"},{validator:t,trigger:"blur"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:e,trigger:"blur"}],areaId:[{required:!0,message:"请选择",trigger:"blur"}],address:[{required:!0,message:"请输入街道地址",trigger:"blur"}],shopName:[{required:!0,message:"请输入店铺名称",trigger:"blur"}],majorBusiness:[{required:!0,message:"请输入主营业务",trigger:"blur"}]}}},props:{id:{type:String,default:""},open:{type:Boolean,default:!1},state:{type:String,default:""}},watch:{id:function(e){""===e||this.getEmailContent()},open:function(e){e&&this.refresh()}},methods:{auditFailed:function(){this.getEmailContent(),this.auditFailedDialog=!0},sendAuditFailedEmail:function(){var e=this,t={id:this.id,toMail:this.email,subject:this.auditFailedEmali.subject,content:this.auditFailedEmali.content};this.loading=!0,p["a"].sendEmail(t,(function(t){e.$message({message:"邮件发送成功！",type:"success"}),e.loading=!1}),(function(t){e.loading=!1,console.log(t)})),this.qualificationsDialog=!1},handlePersonImgSuccess:function(e){this.form.personImg=e},handleIdCartImgFrontSuccess:function(e){this.form.idCartImgFront=e},handleIdCartImgBackSuccess:function(e){this.form.idCartImgBack=e},areaChanged:function(e){this.form.areaId=e},getEmailContent:function(){this.auditFailedEmali.content='亲爱的用户，您好：<br/><br/>经我方工作人员核实，您所提交的相关信息暂未通过平台审核，还需要对以下内容进行修正：<br/><br/>以下为样例：<br/><br/>1. 手持身份证信息不清楚<br/>2. 营业执照复印件没有加盖公章<br/>3. 请点击以下网址更新您的相关材料（该链接48小时内有效，若页面空白请复制该链接到浏览器地址栏打开）：<br/><a href="'+window.location.origin+"/?companyId=&investmentId="+this.id+"&personalId="+this.updateId+'#/merchants/qua">'+window.location.origin+"/?companyId=&investmentId="+this.id+"&personalId="+this.updateId+"#/merchants/qua</a><br/><br/>祝您 万事如意<br/><br/>V服爱车团队"},pass:function(){var e=this;""!==this.form.personImg&&""!==this.form.idCartImgFront&&""!==this.form.idCartImgBack&&this.$refs.form.validate((function(t){if(!t)return!1;g["a"].post("/admin/admin/checkMobile.jhtml",{mobile:e.form.mobile}).then((function(t){t.userId?(e.userId=t.userId,e.dialogVisiblePass=!0):(e.userId="",e.onPassed())})).catch((function(t){e.loading=!1,t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))},onPassed:function(){var e=this,t={id:this.updateId,investmentId:this.id,name:this.form.name,idCartCode:this.form.idCartCode,personImg:this.form.personImg,idCartImgFront:this.form.idCartImgFront,idCartImgBack:this.form.idCartImgBack,areaId:this.form.areaId,address:this.form.address,mobile:this.form.mobile,shopName:this.form.shopName,majorBusiness:this.form.majorBusiness,remark:this.form.remark,state:"1"};this.loading=!0,f.save(t,function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,e.$message.success("操作成功"),t.next=4,e.refresh();case 4:e.$emit("created",e.form.mobile),e.dialogVisiblePass=!1;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.loading=!1,e.$notify({title:"操作失败",message:t.errorMessage,type:"warning"}),e.dialogVisiblePass=!1}))},onAbandoned:function(){var e=this;this.$confirm("此操作将废弃该申请, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};e.loading=!0,f.abandoned(t,(function(t){e.$message.success("操作成功"),e.$emit("onAbandoned")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage),console.log(t)}))})).catch((function(){}))},operate:function(e){this[e]()},save:function(){var e=this;""!==this.form.personImg&&""!==this.form.idCartImgFront&&""!==this.form.idCartImgBack&&this.$refs.form.validate((function(t){if(!t)return!1;e.submit()}))},submit:function(){this.isCreated?this.create():this.update()},create:function(){var e=this,t={investmentId:this.id,name:this.form.name,idCartCode:this.form.idCartCode,personImg:this.form.personImg,idCartImgFront:this.form.idCartImgFront,idCartImgBack:this.form.idCartImgBack,areaId:this.form.areaId,address:this.form.address,mobile:this.form.mobile,shopName:this.form.shopName,majorBusiness:this.form.majorBusiness,remark:this.form.remark,state:this.form.state};this.loading=!0,f.create(t,(function(t){e.isCreated=!1,e.loading=!1,e.$message.success("操作成功"),e.refresh()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},update:function(){var e=this,t={id:this.updateId,investmentId:this.id,name:this.form.name,idCartCode:this.form.idCartCode,personImg:this.form.personImg,idCartImgFront:this.form.idCartImgFront,idCartImgBack:this.form.idCartImgBack,areaId:this.form.areaId,address:this.form.address,mobile:this.form.mobile,shopName:this.form.shopName,majorBusiness:this.form.majorBusiness,remark:this.form.remark,state:this.form.state};this.loading=!0,f.save(t,function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,e.$message.success("操作成功"),t.next=4,e.refresh();case 4:"1"===e.form.state&&e.$emit("updateState");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.loading=!1,e.$notify({title:"更新失败",message:t.errorMessage,type:"warning"})}))},refresh:function(){var e=this,t={investmentId:this.id};this.loading=!0,this.$refs.form.$el.scrollTop=0,f.get(t,(function(t){e.form.name=t.content.name||"",e.form.mobile=t.content.mobile||"",e.form.idCartCode=t.content.idCartCode||"",e.form.personImg=t.content.personImg||"",e.form.idCartImgFront=t.content.idCartImgFront||"",e.form.idCartImgBack=t.content.idCartImgBack||"",e.form.areaId=t.content.areaId||"",e.form.address=t.content.address||"",e.form.shopName=t.content.shopName||"",e.form.majorBusiness=t.content.majorBusiness||"",e.form.remark=t.content.remark||"",e.form.state=t.content.state||"0",e.updateId=t.content.id||"",e.email=t.content.email||"",e.operations[1].disabled=!1,e.operations[0].disabled=!1,e.operations[2].disabled=!0,e.operations[3].disabled=!1,e.state&&"3"===e.state&&(e.operations[0].disabled=!0,e.operations[1].disabled=!0,e.operations[2].disabled=!0,e.operations[3].disabled=!0),t.content.state&&"1"===t.content.state&&(e.operations[1].disabled=!0),t.content.name&&(e.operations[2].disabled=!1),t.content.id?e.isCreated=!1:e.isCreated=!0,e.loading=!1}),(function(t){e.loading=!1,console.log(t),"900"===t.resultCode&&(e.isCreated=!0,e.form.name="",e.form.mobile="",e.form.idCartCode="",e.form.personImg="",e.form.idCartImgFront="",e.form.idCartImgBack="",e.form.address="",e.form.shopName="",e.form.majorBusiness="",e.form.remark="",e.form.state="0")}))}}},I=v,C=(a("b5d6"),a("2877")),y=Object(C["a"])(I,i,s,!1,null,null,null);t["a"]=y.exports},"1a8e":function(e,t,a){},"1af4":function(e,t,a){},"21ba":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"merchants-mgmt"},[a("biz-flex-table",{attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,pagination:e.pagination},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"selection-change":e.handleSelectionChange,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{width:"200",prop:"name",label:"姓名"}}),a("el-table-column",{attrs:{prop:"mobile",label:"电话"}}),a("el-table-column",{attrs:{prop:"email",label:"电子邮箱"}}),a("el-table-column",{attrs:{prop:"areaName",label:"所在区域"}}),a("el-table-column",{attrs:{prop:"investmentState",formatter:e.getStatus,label:"状态"}})],1),a("biz-popup-tabs",{attrs:{open:e.open},on:{close:function(t){e.open=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:"申请单基本信息",name:"first"}},[a("merchants-mgmt-base-info",{ref:"baseInfo",attrs:{id:e.currentRowId,state:e.state,open:e.open,email:e.currentRowEmail},on:{onAbandoned:e.onAbandoned,created:e.updated,createdSuccess:e.createdSuccess}})],1),e.show?a("el-tab-pane",{attrs:{label:"个人资质信息",name:"second"}},[a("merchants-mgmt-psn-qua",{attrs:{id:e.currentRowId,state:e.state,open:e.open,email:e.currentRowEmail},on:{updateState:e.updateBaseInfo,onAbandoned:e.onAbandoned,created:e.updatedPerson}})],1):e._e(),e.show?a("el-tab-pane",{attrs:{label:"企业资质信息",name:"third"}},[a("merchants-mgmt-com-qua",{attrs:{id:e.currentRowId,mobile:e.mobile,state:e.state,open:e.open,email:e.currentRowEmail},on:{updateState:e.updateBaseInfo,onAbandoned:e.onAbandoned,created:e.updated}})],1):e._e()],1)],1)},s=[],o=(a("a9e3"),a("d3b7"),a("25f0"),a("7132")),n=a("440d"),r=a("1367"),l=a("2671"),c=a("04d3"),m=a("f3d6"),d={name:"MerchantsMgmt",data:function(){return{tabName:"first",tags:[],open:!1,show:!1,dialogVisible:!1,activeName:"second",currentRowId:"",currentRowEmail:"",mobile:"",state:"",operations:[{label:"添加",name:"add",type:"primary"},{label:"刷新",name:"refresh",type:""}],filters:[{type:"year",label:"选择年份：",value:(new Date).getFullYear().toString()},{type:"select",label:"状态",name:"add",value:"",options:[{value:"",label:"全部"},{value:"0",label:"未处理"},{value:"1",label:"审核中"},{value:"2",label:"通过"},{value:"3",label:"废弃"},{value:"4",label:"提交中"}]},{type:"input",label:"",placeholder:"请输入姓名/电话",name:"searchValue",value:""}],tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9},investmentState:"",multipleSelection:[]}},components:{BizPopupTabs:o["a"],MerchantsMgmtBaseInfo:n["a"],MerchantsMgmtPsnQua:r["a"],MerchantsMgmtComQua:l["a"],BizFlexTable:c["c"]},computed:{},watch:{},created:function(){this.refresh(),this.getKpi()},methods:{updateBaseInfo:function(){this.$refs.baseInfo.refresh()},operate:function(e){this[e]()},onAbandoned:function(){this.refresh(),this.open=!1},getKpi:function(){var e=this,t={pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};m["a"].getList(t,(function(t){var a="招商加盟申请"+t.total+"个，待处理申请"+t.untreatedCount+"个，审核中申请"+t.processingCount+"个，今日新增申请"+t.nowCount+"个";e.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:a,duration:3e3})}),(function(e){console.log(e)}))},refresh:function(){var e=this,t={pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,searchValue:this.filters[2].value,year:this.filters[0].value,investmentState:this.filters[1].value};m["a"].getList(t,(function(t){e.pagination.total=Number(t.total),e.tableData=t.content}),(function(e){console.log(e)}))},filterDataChange:function(e){this.refresh()},handleSelectionChange:function(e){this.multipleSelection=e},rowClick:function(e){this.state=e.investmentState,"0"!==e.investmentState&&(this.show=!0),this.$nextTick((function(){this.tabName="first","1"===e.investmentState&&(this.tabName="second"),this.currentRowId=e.id,this.currentRowEmail=e.email,this.open=!0}))},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},getStatus:function(e){switch(e.investmentState){case"0":return"未处理";case"1":return"审核中";case"2":return"通过";case"3":return"废弃";case"4":return"提交中";default:break}return""},createdSuccess:function(e){this.currentRowId=e,this.refresh()},updated:function(){this.refresh()},updatedPerson:function(e){this.tabName="third",this.mobile=e,this.refresh()},add:function(){this.currentRowId="",this.show=!1,this.tabName="first",this.open=!0}}},u=d,f=(a("e167"),a("2877")),p=Object(f["a"])(u,i,s,!1,null,null,null);t["default"]=p.exports},2497:function(e,t,a){"use strict";var i=a("4360"),s=a("a18c");t["a"]=function(e,t){return function(a){var o=a.data;"100"===o.resultCode?e(o):"709"===o.resultCode?(i["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",i["a"].getters.currentUser),s["a"].push("/login")):t(o)}}},2671:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"merchants-mgmt-com-qua"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small",disabled:"1"===e.form.state||"3"===this.state,"inline-message":!0}},[a("el-form-item",{attrs:{label:"企业名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入企业名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"统一社会信用代码",prop:"bussinessLicenseCode"}},[a("el-input",{attrs:{placeholder:"请输入18位社会信用代码"},model:{value:e.form.bussinessLicenseCode,callback:function(t){e.$set(e.form,"bussinessLicenseCode",t)},expression:"form.bussinessLicenseCode"}})],1),a("el-form-item",{attrs:{label:"营业执照所在地",prop:"address"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入详细地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),a("el-form-item",{attrs:{label:"营业期限"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",clearable:e.clearable,placeholder:"请选择营业期限","value-format":"yyyy-MM-dd"},model:{value:e.form.bussinessLicenseDue,callback:function(t){e.$set(e.form,"bussinessLicenseDue",t)},expression:"form.bussinessLicenseDue"}})],1),a("el-form-item",{attrs:{label:"注册资本",prop:"registeredCapital"}},[a("el-input-number",{attrs:{placeholder:"请输入注册资本",min:0},model:{value:e.form.registeredCapital,callback:function(t){e.$set(e.form,"registeredCapital",t)},expression:"form.registeredCapital"}})],1),a("el-form-item",{attrs:{label:"营业执照副本扫描件(加盖公章)",required:!0,error:""===e.form.bussinessLicenseImg?"请上传所需照片":""}},[a("BizAvatarUploaderNew",{model:{value:e.form.bussinessLicenseImg,callback:function(t){e.$set(e.form,"bussinessLicenseImg",t)},expression:"form.bussinessLicenseImg"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{disabled:""},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[a("el-option",{attrs:{label:"未审核",value:"0"}}),a("el-option",{attrs:{label:"通过",value:"1"}}),a("el-option",{attrs:{label:"未通过",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),a("el-dialog",{attrs:{slot:"float",title:"审核未通过邮件","append-to-body":"",visible:e.auditFailedDialog,"custom-class":"qualificationDialog"},on:{"update:visible":function(t){e.auditFailedDialog=t}},slot:"float"},[a("el-form",{attrs:{"label-width":"90px",size:"small"}},[a("el-form-item",{attrs:{label:"收件人地址"}},[a("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),a("el-form-item",{attrs:{label:"邮件标题"}},[a("el-input",{model:{value:e.auditFailedEmali.subject,callback:function(t){e.$set(e.auditFailedEmali,"subject",t)},expression:"auditFailedEmali.subject"}})],1),a("el-form-item",{attrs:{label:"邮件内容"}},[a("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.auditFailedEmali.content,callback:function(t){e.$set(e.auditFailedEmali,"content",t)},expression:"auditFailedEmali.content"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.auditFailedDialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendAuditFailedEmail}},[e._v("发送")])],1)],1),a("el-dialog",{attrs:{title:"认证通过邮件","append-to-body":"",visible:e.certificationPassedDialog,"custom-class":"qualificationDialog"},on:{"update:visible":function(t){e.certificationPassedDialog=t}}},[a("el-form",{attrs:{model:e.certificationPassedForm,"label-width":"90px",size:"small"}},[e.passMailCount&&"0"!==e.passMailCount?a("el-form-item",{attrs:{label:"已发送邮件次数"}},[e._v(" "+e._s(e.passMailCount)+"次 ")]):e._e(),a("el-form-item",{attrs:{label:"收件人地址"}},[a("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),a("el-form-item",{attrs:{label:"邮件标题"}},[a("el-input",{model:{value:e.certificationPassedForm.subject,callback:function(t){e.$set(e.certificationPassedForm,"subject",t)},expression:"certificationPassedForm.subject"}})],1),a("el-form-item",{attrs:{label:"邮件内容"}},[a("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.certificationPassedForm.content,callback:function(t){e.$set(e.certificationPassedForm,"content",t)},expression:"certificationPassedForm.content"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.certificationPassedDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendCertificationPassedEmail}},[e._v("发送")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisiblePass,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisiblePass=t}}},[a("span",[e._v(e._s(e.form.mobile)+"手机号已注册，确定添加此手机号为管理员请点击获取验证码，验证成功后自动添加")]),a("div",{staticClass:"valid-div"},[a("el-input",{attrs:{placeholder:"请输入验证码",size:"mini"},model:{value:e.validImg,callback:function(t){e.validImg=t},expression:"validImg"}}),a("img",{attrs:{src:e.imgSrc,alt:""},on:{click:e.getVerificationImg}})],1),a("div",{staticClass:"code-div"},[a("el-input",{attrs:{placeholder:"请输入手机验证码",size:"mini"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],attrs:{type:"primary",size:"mini"},on:{click:e.getVerification}},[e._v("获取验证码")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],attrs:{type:"primary",disabled:"",size:"mini"}},[e._v(e._s(e.count)+"秒后重新获取")])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisiblePass=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"提示",visible:e.dialogAdminVisible,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogAdminVisible=t},close:e.close}},[a("span",[e._v("该用户是其他店铺管理员，确认成为本店铺管理员")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogAdminVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.complete}},[e._v("确 定")])],1)])],1)},s=[],o=(a("b0c0"),a("a9e3"),a("96cf"),a("1da1")),n=a("f36f"),r=a("8330"),l=a("2497"),c=a("bc3a"),m=a.n(c),d=a("c596"),u={get:function(e,t,a){m.a.get(d["g"].merchantsMgmt.selectComQua,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))},save:function(e,t,a){m.a.get(d["g"].merchantsMgmt.updateComQua,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))},create:function(e,t,a){m.a.get(d["g"].merchantsMgmt.createComQua,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))},passed:function(e,t,a){m.a.get(d["g"].merchantsMgmt.passedComQua,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))},abandoned:function(e,t,a){m.a.get(d["g"].merchantsMgmt.abandonedComQua,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))}},f=a("5773"),p=a("04b8"),b=a("40ae"),h=a("c17f"),g=a("4e29"),v=a("1ab1"),I={name:"MerchantsMgmtComQua",components:{BizSaveButton:r["a"],BizGrid:n["a"],BizAvatarUploaderNew:h["b"],BizEditor:b["a"]},data:function(){var e=function(e,t,a){p["a"].isUnifiedSocialCreditCode(t)?a():a(new Error("请输入正确的统一社会信用代码"))},t=function(e,t,a){isNaN(t)?a(new Error("请输入数字值")):t<0?a(new Error("必须输入正数")):a()};return{auditFailedDialog:!1,isCreated:!1,clearable:!1,dialogVisiblePass:!1,dialogAdminVisible:!1,show:!0,count:"",code:"",imgSrc:"",validImg:"",validCode:"",timer:null,isManageThisStore:"",updateId:"",email:"",memberId:"",passMailCount:"",certificationPassedDialog:!1,certificationPassedForm:{subject:"V服爱车账号开通通知(重要)",content:""},form:{fileData:{type:"0"},name:"",mobile:"",bussinessLicenseCode:"",bussinessLicenseImg:"",address:"",bussinessLicenseDue:"",registeredCapital:"",state:"0",remark:""},operations:[{disabled:!1,label:"废弃",name:"onAbandoned",type:"danger"},{disabled:!1,label:"审核未通过邮件",name:"auditFailed",type:"primary"},{disabled:!1,label:"通过",name:"onPassed",type:"primary"},{label:"完成",name:"complete",type:"primary",disabled:!0},{disabled:!1,label:"保存",name:"save",type:"primary"}],auditFailedEmali:{subject:"V服爱车信息审核反馈通知(重要)",content:""},rules:{name:[{required:!0,message:"请输入企业名称",trigger:"blur"}],bussinessLicenseCode:[{required:!0,message:"请输入统一社会信用代码",trigger:"blur"},{validator:e,trigger:"blur"}],address:[{required:!0,message:"请输入营业执照所在地",trigger:"blur"}],registeredCapital:[{required:!0,message:"请输入注册资本",trigger:"blur"},{validator:t,trigger:"blur"}]}}},props:{id:{type:String,default:""},open:{type:Boolean,default:!1},state:{type:String,default:""},mobile:{type:String,default:""}},watch:{id:function(e){""===e||this.getEmailContent()},open:function(e){e&&this.refresh()}},created:function(){this.getVerificationImg()},methods:{auditFailed:function(){this.getEmailContent(),this.auditFailedDialog=!0},close:function(){this.isManageThisStore=""},getCode:function(){var e=this,t=60;this.timer||(this.count=t,this.show=!1,this.timer=setInterval((function(){e.count>0&&e.count<=t?e.count--:(e.show=!0,clearInterval(e.timer),e.timer=null)}),1e3))},getVerificationImg:function(){var e=this;this.uid=g["a"].getUuid("xxxxxxxxxxxxxxxx");var t={uid:this.uid,clientType:"2",methodName:"QueryCaptcha"},a="/rest/member/captcha.jhtml?req="+encodeURIComponent(JSON.stringify(t));v["a"].get(a).then((function(t){e.imgSrc="data:image/png;base64,"+t.captchaImage,e.uid=t.uid})).catch((function(e){}))},getVerification:function(){var e=this,t={uid:this.uid,captcha:this.validImg,clientType:"2",methodName:"SendValidateCode",phoneNumber:this.form.mobile,type:"7"},a="/rest/member/sendValidateCode.jhtml";m.a.post(a,t).then((function(t){"100"===t.data.resultCode?(e.validCode=t.data.validateCode,e.show=!0,e.getCode()):e.$message({message:t.data.errorMessage,type:"warning"})})).catch((function(e){console.log(e)}))},confirm:function(){return""===this.validImg?(this.$message.warning("请输入验证码"),!1):""===this.code?(this.$message.warning("请输入手机验证码"),!1):this.code!==this.validCode?(this.$message.warning("请输入正确的验证码"),!1):void this.complete()},complete:function(){var e=this;this.dialogAdminVisible=!1,this.dialogVisiblePass=!1,f["a"].passed({id:this.id,memberId:this.memberId,isManageThisStore:this.isManageThisStore},(function(t){e.loading=!1,e.username=t.username,e.password=t.password,e.getEmailContent(),e.openCertificationPassedEmail(),e.$emit("created")}),(function(t){e.loading=!1,e.isManageThisStore="",t.memberId?(e.memberId=t.memberId,e.dialogVisiblePass=!0):"1070"===t.resultCode?(e.dialogAdminVisible=!0,e.isManageThisStore="1"):t.errorMessage&&e.$message.warning(t.errorMessage)}))},openCertificationPassedEmail:function(){this.certificationPassedDialog=!0},sendCertificationPassedEmail:function(){var e=this,t={id:this.id,toMail:this.email,subject:this.certificationPassedForm.subject,content:this.certificationPassedForm.content};this.loading=!0,f["a"].sendEmail(t,(function(t){e.passMailCount=Number(e.passMailCount)+1,e.$message({message:"认证通过邮件发送成功！",type:"success"}),e.loading=!1}),(function(t){e.loading=!1,console.log(t)})),this.qualificationsDialog=!1},sendAuditFailedEmail:function(){var e=this,t={id:this.id,toMail:this.email,subject:this.auditFailedEmali.subject,content:this.auditFailedEmali.content};this.loading=!0,f["a"].sendEmail(t,(function(t){e.$message({message:"邮件发送成功！",type:"success"}),e.loading=!1}),(function(t){e.loading=!1,console.log(t)})),this.qualificationsDialog=!1},getEmailContent:function(){this.auditFailedEmali.content='亲爱的用户，您好：<br/><br/>经我方工作人员核实，您所提交的相关信息暂未通过平台审核，还需要对以下内容进行修正：<br/><br/>以下为样例：<br/><br/>1. 手持身份证信息不清楚<br/>2. 营业执照复印件没有加盖公章<br/>3. 请点击以下网址更新您的相关材料（该链接48小时内有效，若页面空白请复制该链接到浏览器地址栏打开）：<br/><a href="'+window.location.origin+"/?personalId=&investmentId="+this.id+"&companyId="+this.updateId+'#/merchants/qua">'+window.location.origin+"/?personalId=&investmentId="+this.id+"&companyId="+this.updateId+"#/merchants/qua</a><br/><br/>祝您 万事如意<br/><br/>V服爱车团队",this.certificationPassedForm.content="亲爱的用户，您好：<br/><br/>我们很高兴的通知您，您所提交的相关信息已通过平台的审核，现已为您开通平台使用账号。<br/>1. V服爱车平台地址<br/>"+window.location.origin+"<br/>2. 输入平台为您分配的账号，开始您的V服之旅<br/>用户名："+this.username+"<br/>密码："+this.password+"<br/>3. 如您在使用过程中遇到任何问题，或要反馈您的宝贵意见和建议，请拔打400电话：400-6556-119。<br/><br/>祝您 万事如意<br/><br/>V服爱车团队"},onPassed:function(){var e=this;this.$refs.form.validate((function(t,a){if(t){var i={id:e.updateId,investmentId:e.id,name:e.form.name,bussinessLicenseCode:e.form.bussinessLicenseCode,address:e.form.address,bussinessLicenseImg:e.form.bussinessLicenseImg,bussinessLicenseDue:e.form.bussinessLicenseDue,registeredCapital:e.form.registeredCapital,remark:e.form.remark,state:"1"};e.loading=!0,u.save(i,function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:1500}),t.next=4,e.refresh();case 4:e.$emit("created");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.loading=!1,e.$notify({title:"更新失败",message:t.errorMessage,type:"warning"})}))}}))},onAbandoned:function(){var e=this;this.$confirm("此操作将废弃该申请, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};e.loading=!0,u.abandoned(t,(function(t){e.$message.success("操作成功"),e.$emit("onAbandoned")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))})).catch((function(){}))},operate:function(e){this[e]()},areaChanged:function(e){this.areaId=e},handleBussinessLicenseImgSuccess:function(e){this.form.bussinessLicenseImg=e},save:function(){var e=this;""!==this.form.bussinessLicenseImg&&this.$refs.form.validate((function(t){if(!t)return!1;e.submit()}))},submit:function(){var e=this;this.$refs.form.validate((function(t,a){t&&(e.isCreated?e.create():e.update())}))},create:function(){var e=this,t={investmentId:this.id,name:this.form.name,bussinessLicenseCode:this.form.bussinessLicenseCode,address:this.form.address,bussinessLicenseImg:this.form.bussinessLicenseImg,bussinessLicenseDue:this.form.bussinessLicenseDue,registeredCapital:this.form.registeredCapital,remark:this.form.remark,state:this.form.state};this.loading=!0,u.create(t,(function(t){e.loading=!1,e.isCreated=!1,e.$message.success("操作成功"),e.refresh()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},update:function(){var e=this,t={id:this.updateId,investmentId:this.id,name:this.form.name,bussinessLicenseCode:this.form.bussinessLicenseCode,address:this.form.address,bussinessLicenseImg:this.form.bussinessLicenseImg,bussinessLicenseDue:this.form.bussinessLicenseDue,registeredCapital:this.form.registeredCapital,remark:this.form.remark,state:this.form.state};this.loading=!0,u.save(t,function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,e.$message.success("操作成功"),t.next=4,e.refresh();case 4:"1"===e.form.state&&e.$emit("updateState");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.loading=!1,e.$notify({title:"更新失败",message:t.errorMessage,type:"warning"})}))},refresh:function(){var e=this;this.$refs.form.clearValidate();var t={investmentId:this.id};this.loading=!0,u.get(t,(function(t){e.$refs.form.$el.scrollTop=0,e.form.name=t.content.name||"",e.form.mobile=t.content.personalMobile||"",e.form.bussinessLicenseCode=t.content.bussinessLicenseCode||"",e.form.bussinessLicenseImg=t.content.bussinessLicenseImg||"",e.form.bussinessLicenseDue=t.content.bussinessLicenseDue||"",e.form.registeredCapital=t.content.registeredCapital||"",e.form.address=t.content.address||"",e.form.remark=t.content.remark||"",e.form.state=t.content.state||"0",e.passMailCount=t.content.passMailCount||"",e.updateId=t.content.id||"",e.loading=!1,t.content.id?e.isCreated=!1:e.isCreated=!0,e.email=t.content.email,e.operations[3].disabled=!0,e.operations[1].disabled=!1,e.operations[0].disabled=!1,e.operations[2].disabled=!1,e.operations[4].disabled=!1,"1"===t.content.totalPassButton&&(e.operations[3].disabled=!1),e.state&&"3"===e.state&&(e.operations[0].disabled=!0,e.operations[1].disabled=!0,e.operations[2].disabled=!0,e.operations[3].disabled=!0,e.operations[4].disabled=!0),t.content.state&&"1"===t.content.state&&(e.operations[1].disabled=!0)}),(function(t){e.loading=!1,"900"!==t.resultCode&&"886"!==t.resultCode||(e.isCreated=!0,e.form.name="",e.form.bussinessLicenseCode="",e.form.address="",e.form.bussinessLicenseImg="",e.form.registeredCapital="",e.form.remark="",e.form.state="0")}))}}},C=I,y=(a("924e"),a("2877")),w=Object(y["a"])(C,i,s,!1,null,null,null);t["a"]=w.exports},"440d":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"merchants-mgmt-base-info"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small",disabled:("1"===e.form.state||"3"===this.state)&&!!e.id,"inline-message":!0}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入姓名",minlength:"1",maxlength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),a("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[a("el-input",{attrs:{placeholder:"请输入您的电子邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("el-form-item",{attrs:{label:"QQ号"}},[a("el-input",{attrs:{placeholder:"请输入您的QQ号"},model:{value:e.form.qq,callback:function(t){e.$set(e.form,"qq",t)},expression:"form.qq"}})],1),a("el-form-item",{attrs:{label:"微信号"}},[a("el-input",{attrs:{placeholder:"请输入您的微信号"},model:{value:e.form.wchat,callback:function(t){e.$set(e.form,"wchat",t)},expression:"form.wchat"}})],1),a("el-form-item",{attrs:{label:"所在区域",prop:"areaId"}},[a("biz-area-select",{attrs:{areaId:e.form.areaId},on:{areaChanged:e.areaChanged}})],1),a("el-form-item",{attrs:{label:"申请时间"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.createDate,callback:function(t){e.$set(e.form,"createDate",t)},expression:"form.createDate"}})],1),a("el-form-item",{attrs:{label:"合作意向"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入合作意向"},model:{value:e.form.cooperationIntention,callback:function(t){e.$set(e.form,"cooperationIntention",t)},expression:"form.cooperationIntention"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{placeholder:"请选择状态",disabled:""},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[a("el-option",{attrs:{label:"未审核",value:"0"}}),a("el-option",{attrs:{label:"通过",value:"1"}}),a("el-option",{attrs:{label:"未通过",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"备注信息"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"所属运营商"}},[a("el-select",{attrs:{placeholder:"请选择运营商"},model:{value:e.form.companyId,callback:function(t){e.$set(e.form,"companyId",t)},expression:"form.companyId"}},e._l(e.companies,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("div",{staticClass:"help"},[e._v(" *通过电话联系，确认申请信息有效，则“发送资质邮件”，然后点击“通过”；若为虚假消息，则“废弃”该条申请信息。 ")])],1),a("div",{attrs:{slot:"float"},slot:"float"},[a("el-dialog",{attrs:{title:"发送资质邮件","append-to-body":"",visible:e.qualificationsDialog,"custom-class":"qualification-Dialog"},on:{"update:visible":function(t){e.qualificationsDialog=t}}},[a("el-form",{attrs:{model:e.qualificationsForm,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"收件人地址"}},[a("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("el-form-item",{attrs:{label:"邮件标题"}},[a("el-input",{model:{value:e.qualificationsForm.subject,callback:function(t){e.$set(e.qualificationsForm,"subject",t)},expression:"qualificationsForm.subject"}})],1),a("el-form-item",{attrs:{label:"邮件内容"}},[a("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.qualificationsForm.content,callback:function(t){e.$set(e.qualificationsForm,"content",t)},expression:"qualificationsForm.content"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.qualificationsDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendQualificationsEmail}},[e._v("发送")])],1)],1),a("el-dialog",{attrs:{title:"认证通过邮件","append-to-body":"",visible:e.certificationPassedDialog,"custom-class":"qualification-Dialog"},on:{"update:visible":function(t){e.certificationPassedDialog=t}}},[a("el-form",{attrs:{model:e.certificationPassedForm}},[e.passMailCount&&"0"!==e.passMailCount?a("el-form-item",{attrs:{label:"已发送邮件次数"}},[e._v(" "+e._s(e.passMailCount)+"次 ")]):e._e(),a("el-form-item",{attrs:{label:"收件人地址"}},[a("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("el-form-item",{attrs:{label:"邮件标题"}},[a("el-input",{model:{value:e.certificationPassedForm.subject,callback:function(t){e.$set(e.certificationPassedForm,"subject",t)},expression:"certificationPassedForm.subject"}})],1),a("el-form-item",{attrs:{label:"邮件内容"}},[a("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.certificationPassedForm.content,callback:function(t){e.$set(e.certificationPassedForm,"content",t)},expression:"certificationPassedForm.content"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.certificationPassedDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendCertificationPassedEmail}},[e._v("发送")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisiblePass,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisiblePass=t}}},[a("span",[e._v(e._s(e.form.mobile)+"已被注册，请确认是否通过")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisiblePass=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.pass}},[e._v("确 定")])],1)])],1)],1)},s=[],o=(a("b0c0"),a("a9e3"),a("d3b7"),a("f36f")),n=a("8330"),r=a("ce2e"),l=a("40ae"),c=a("5773"),m=a("1ab1"),d={name:"MerchantsMgmtBaseInfo",components:{BizSaveButton:n["a"],BizAreaSelect:r["a"],BizGrid:o["a"],BizEditor:l["a"]},data:function(){var e=function(e,t,a){var i=/^1\d{10}$/;i.test(t)?a():a(new Error("请输入正确的手机号码"))};return{username:"",password:"",passMailCount:"",loading:!1,hasKaou:!1,dialogVisible:!1,dialogVisiblePass:!1,kaouCompanyId:"",qualificationsDialog:!1,qualificationsForm:{subject:"V服爱车商务合作申请反馈通知(重要)",content:""},certificationPassedDialog:!1,certificationPassedForm:{subject:"V服爱车账号开通通知(重要)",content:""},companies:[],userId:"",form:{areaId:"1568",name:"",mobile:"",email:"",createDate:"",cooperationIntention:"",state:"0",remark:"",companyId:"",qq:"",wchat:""},operations:[{disabled:!1,label:"废弃",name:"abandoned",type:"danger"},{disabled:!1,label:"发送资质邮件",name:"openQualificationsEmail",type:"primary"},{disabled:!1,label:"通过",name:"onPassed",type:"primary"},{disabled:!1,label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:e,trigger:"blur"}],email:[{type:"email",required:!0,message:"请输入正确的邮箱地址",trigger:"blur"}],areaId:[{required:!0,message:"请选择",trigger:"blur"}]}}},props:{id:{type:String,default:""},open:{type:Boolean,default:!1},state:{type:String,default:""}},watch:{id:function(e){""===e?(this.$refs.form.$el.scrollTop=0,this.form.name="",this.form.mobile="",this.form.investmentState="0",this.form.email="",this.form.createDate="",this.form.state="0",this.form.cooperationIntention="",this.form.remark="",this.form.companyId=this.companies[0].id,this.form.areaId="1568",this.form.qq="",this.form.wchat="",this.operations[0].disabled=!0,this.operations[1].disabled=!0,this.operations[2].disabled=!0,this.operations[3].disabled=!1):this.getEmailContent()},open:function(e){e&&(this.refresh(),this.$refs.form.clearValidate(),""===this.id&&(this.operations[0].disabled=!0,this.operations[1].disabled=!0,this.operations[2].disabled=!0,this.operations[3].disabled=!1))}},created:function(){this.getCompanies()},computed:{},methods:{operate:function(e){this[e]()},areaChanged:function(e){console.log(e),this.form.areaId=e},save:function(){var e=this;this.$refs.form.validate((function(t){e.submit()}))},submit:function(){var e=this;this.$refs.form.validate((function(t,a){t&&(""===e.id?e.create():e.update())}))},checkMobile:function(e){var t=this;m["a"].post("/admin/admin/checkMobile.jhtml",{mobile:e}).then((function(e){e.userId?(t.userId=e.userId,t.dialogVisible=!0):(t.userId="",t.submit())})).catch((function(e){t.loading=!1,e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))},create:function(){var e=this,t={name:this.form.name,mobile:this.form.mobile,email:this.form.email,cooperationIntention:this.form.cooperationIntention,remark:this.form.remark,companyId:this.form.companyId,state:this.form.state,areaId:this.form.areaId,qq:this.form.qq,wchat:this.form.wchat,memberId:this.userId};this.loading=!0,c["a"].create(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("createdSuccess",t.id),e.refresh(t.id)}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},update:function(){var e=this,t={id:this.id,name:this.form.name,mobile:this.form.mobile,email:this.form.email,cooperationIntention:this.form.cooperationIntention,remark:this.form.remark,companyId:this.form.companyId,state:this.form.state,areaId:this.form.areaId,qq:this.form.qq,wchat:this.form.wchat,memberId:this.userId};this.loading=!0,c["a"].save(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("created"),e.refresh()}),(function(t){e.loading=!1,e.$notify({title:"更新失败",message:t.errorMessage,type:"warning"})}))},refresh:function(e){var t=this,a={id:this.id||e||""};this.loading=!0,c["a"].get(a,(function(e){t.loading=!1,t.form.name=e.content.name,t.form.mobile=e.content.mobile,t.form.investmentState=e.content.investmentState,t.form.email=e.content.email,t.form.createDate=e.content.createDate,t.form.areaId=e.content.areaId,t.form.state=e.content.state,t.form.cooperationIntention=e.content.cooperationIntention,t.form.remark=e.content.remark,t.username=e.content.username,t.password=e.content.password,t.form.qq=e.content.qq,t.form.wchat=e.content.wchat,t.passMailCount=e.content.passMailCount,e.content.companyId&&""!==e.content.companyId?t.form.companyId=e.content.companyId:t.form.companyId=t.companies[0].id,t.operations[1].disabled=!0,t.operations[0].disabled=!1,t.operations[2].disabled=!1,t.operations[3].disabled=!1,"1"===t.form.state&&(t.operations[1].disabled=!1),t.state&&"3"===t.state&&t.id&&(t.operations[0].disabled=!0,t.operations[1].disabled=!0,t.operations[2].disabled=!0,t.operations[3].disabled=!0)}),(function(e){t.loading=!1,console.log(e)}))},onPassed:function(){var e=this;this.$refs.form.validate((function(t){t&&e.pass()}))},pass:function(){var e=this,t={id:this.id,name:this.form.name,mobile:this.form.mobile,email:this.form.email,cooperationIntention:this.form.cooperationIntention,remark:this.form.remark,companyId:this.form.companyId,state:"1",areaId:this.form.areaId,memberId:this.userId};this.loading=!0,c["a"].save(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("created"),e.refresh()}),(function(t){e.loading=!1,e.$notify({title:"操作失败",message:t.errorMessage,type:"warning"})}))},abandoned:function(){var e=this;this.$confirm("此操作将废弃该申请, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.onAbandoned()})).catch((function(){}))},onAbandoned:function(){var e=this,t={id:this.id};this.loading=!0,c["a"].abandoned(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("onAbandoned")}),(function(t){e.loading=!1,console.log(t)}))},getEmailContent:function(){this.qualificationsForm.content='亲爱的用户，您好：<br/><br/>我们收到了您提交的合作申请。感谢您对V服爱车平台的关注与信任，为了更好的体验平台的功能与服务，请您依照以下的步骤进行：<br/><br/>1. 请点击以下网址（该链接48小时内有效，若页面空白请复制该链接到浏览器地址栏打开）：<br/><a href="'+window.location.origin+"/?personalId=&companyId=&investmentId="+this.id+'#/merchants/qua">'+window.location.origin+"/?personalId=&companyId=&investmentId="+this.id+"#/merchants/qua</a><br/>2.提交相关资质证明信息<br/>3.审核通过后会为您开通相应的权限<br/><br/>烦请注意，本封邮件是由系统发送，请您不要回复。如果回复本信，我们无法给您回信。如果您还有其它的问题，请在网页上点击“联系客服中心”，并输入您要反映的问题或意见，或回复carowl@carowl.cn。我们会尽快与您联系。<br/><br/>祝您 万事如意<br/><br/>V服爱车团队",this.certificationPassedForm.content="亲爱的用户，您好：<br/><br/>我们很高兴的通知您，您所提交的相关信息已通过平台的审核，现已为您开通平台使用账号。<br/>1. V服爱车平台地址<br/>"+window.location.origin+"<br/>2. 输入平台为您分配的账号，开始您的V服之旅<br/>用户名："+this.username+"<br/>密码："+this.password+"<br/>3. 如您在使用过程中遇到任何问题，或要反馈您的宝贵意见和建议，请拔打400电话：400-6556-119。<br/><br/>祝您 万事如意<br/><br/>V服爱车团队"},openQualificationsEmail:function(){this.qualificationsDialog=!0},sendQualificationsEmail:function(){var e=this,t={id:this.id,toMail:this.form.email,subject:this.qualificationsForm.subject,content:this.qualificationsForm.content};this.loading=!0,c["a"].sendEmail(t,(function(t){e.loading=!1,"100"===t.resultCode&&e.$message({message:"资质邮件发送成功！",type:"success"})}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})),this.qualificationsDialog=!1},openCertificationPassedEmail:function(){this.certificationPassedDialog=!0},sendCertificationPassedEmail:function(){var e=this,t={id:this.id,toMail:this.form.email,subject:this.certificationPassedForm.subject,content:this.certificationPassedForm.content};this.loading=!0,c["a"].sendEmail(t,(function(t){e.passMailCount=Number(e.passMailCount)+1,e.$message({message:"认证通过邮件发送成功！",type:"success"}),e.loading=!1}),(function(t){e.loading=!1,console.log(t)})),this.qualificationsDialog=!1},getCompanies:function(){var e=this;c["a"].getCompanies((function(t){var a=[];for(var i in t.content)a.push({id:i,name:t.content[i]});e.companies=a}),(function(e){console.log(e)}))}}},u=d,f=(a("5e8e"),a("2877")),p=Object(f["a"])(u,i,s,!1,null,null,null);t["a"]=p.exports},5773:function(e,t,a){"use strict";var i=a("2497"),s=a("bc3a"),o=a.n(s),n=a("c596");t["a"]={get:function(e,t,a){o.a.get(n["g"].merchantsMgmt.select,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},create:function(e,t,a){o.a.get(n["g"].merchantsMgmt.create,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},save:function(e,t,a){o.a.get(n["g"].merchantsMgmt.edit,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},passed:function(e,t,a){o.a.post(n["g"].merchantsMgmt.passed,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},abandoned:function(e,t,a){o.a.get(n["g"].merchantsMgmt.failed,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},sendEmail:function(e,t,a){o.a.post(n["g"].merchantsMgmt.sendMail,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},getCompanies:function(e,t){o.a.get(n["g"].merchantsMgmt.companyList).then(Object(i["a"])(e,t)).catch((function(e){console.error(e)}))}}},"5b8e":function(e,t,a){"use strict";var i=a("9678"),s=a.n(i);s.a},"5e8e":function(e,t,a){"use strict";var i=a("62e0"),s=a.n(i);s.a},"62e0":function(e,t,a){},7132:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},s=[],o={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},n=o,r=(a("5b8e"),a("2877")),l=Object(r["a"])(n,i,s,!1,null,null,null),c=l.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},d=[],u=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),f=u,p=(a("d4c2"),Object(r["a"])(f,m,d,!1,null,null,null)),b=p.exports;a.d(t,"a",(function(){return b}))},"924e":function(e,t,a){"use strict";var i=a("f223"),s=a.n(i);s.a},9678:function(e,t,a){},b5d6:function(e,t,a){"use strict";var i=a("1af4"),s=a.n(i);s.a},d4c2:function(e,t,a){"use strict";var i=a("e725"),s=a.n(i);s.a},e167:function(e,t,a){"use strict";var i=a("1a8e"),s=a.n(i);s.a},e725:function(e,t,a){},f223:function(e,t,a){},f3d6:function(e,t,a){"use strict";var i=a("2497"),s=a("bc3a"),o=a.n(s),n=a("c596");t["a"]={getList:function(e,t,a){o.a.get(n["g"].merchantsMgmt.list,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(){console.log("delete")},getStatistics:function(e,t,a){o.a.get(n["g"].merchantsMgmt.statistics,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}}}]);