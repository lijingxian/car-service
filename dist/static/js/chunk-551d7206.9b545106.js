(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-551d7206"],{5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var o=n("1d80"),a=n("5899"),i="["+a+"]",r=RegExp("^"+i+i+"*"),l=RegExp(i+i+"*$"),s=function(e){return function(t){var n=String(o(t));return 1&e&&(n=n.replace(r,"")),2&e&&(n=n.replace(l,"")),n}};e.exports={start:s(1),end:s(2),trim:s(3)}},"5b8e":function(e,t,n){"use strict";var o=n("9678"),a=n.n(o);a.a},"605e7":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"settlement-account-mgmt"},[n("biz-flex-table",{ref:"table",attrs:{operations:e.operations,tableData:e.tableData,loading:e.loading,pagination:e.pagination},on:{operate:e.handleOperate,"size-change":e.handlePageSizeChange,"current-change":e.handleCurrentPageChange,"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[n("el-table-column",{attrs:{label:"账户名称",prop:"name"}}),n("el-table-column",{attrs:{label:"编号",prop:"accountNum"}}),n("el-table-column",{attrs:{label:"当前余额",prop:"currentAmount"}}),n("el-table-column",{attrs:{label:"是否默认",prop:"isDefault"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("1"===t.row.isDefault?"√":"X"))]}}])}),n("el-table-column",{attrs:{prop:"tag",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return e.handleDeleteClick(n,t.row)}}},[e._v("删除")])]}}])})],1),n("div",{attrs:{slot:"float"},slot:"float"},[n("right-popup",{attrs:{open:e.open,itemId:e.itemId},on:{close:function(t){e.open=!1},operationSuccess:e.handleOperationSuccess}})],1)],1)},a=[],i=(n("4160"),n("a9e3"),n("d3b7"),n("159b"),n("5530")),r=n("04d3"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[n("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[n("settlement-account-base-info",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1)],1)},s=[],c=n("7132"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"settlement-account-mgmt__base-info"},[n("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),n("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[n("el-form-item",{attrs:{label:"账户名称",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入账户名称"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),n("el-form-item",{attrs:{label:"开户银行/金融机构",prop:"accountBank"}},[n("el-input",{attrs:{placeholder:"请输入开户银行/金融机构"},model:{value:e.formModel.accountBank,callback:function(t){e.$set(e.formModel,"accountBank",t)},expression:"formModel.accountBank"}})],1),n("el-form-item",{attrs:{label:"账户编号",prop:"accountNum"}},[n("el-input",{attrs:{placeholder:"请输入账户编号"},model:{value:e.formModel.accountNum,callback:function(t){e.$set(e.formModel,"accountNum",t)},expression:"formModel.accountNum"}})],1),n("el-form-item",{attrs:{label:"当前余额",prop:"currentAmount"}},[n("el-input",{attrs:{disabled:!!e.itemId.id},model:{value:e.formModel.currentAmount,callback:function(t){e.$set(e.formModel,"currentAmount",t)},expression:"formModel.currentAmount"}})],1),n("el-form-item",{attrs:{label:"是否默认",prop:"isDefault"}},[n("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#ff7300","inactive-color":"#d9d9d9",disabled:e.disabled},model:{value:e.formModel.isDefault,callback:function(t){e.$set(e.formModel,"isDefault",t)},expression:"formModel.isDefault"}})],1)],1)],1)},d=[],f=(n("b0c0"),n("f36f")),m=n("8330"),p=n("c596"),h=n("1ab1"),g=n("2f62"),b={disabled:!1,operations:[{label:"保存",name:"save",type:"primary"}]},v=function(){return{name:"",shopId:"",accountBank:"",accountNum:"",isDefault:"0",currentAmount:"",initialAmount:""}},M={data:{loading:!1,formModel:v()},events:{handleOperate:function(e){this[e]()}},methods:{initModel:function(e){e?this.formModel=Object.assign(this.getDefaultModel(),e):this.resetModel(),this.$refs.form.resetFields()},query:function(){var e=this;this.loading=!0,h["a"].get(p["g"].invoicing.settlementAccountMgmt.shopAccount,{shopId:window.top.SHOP_ID||"",id:this.itemId.id}).then((function(t){e.initModel(t.data),"1"===t.data.isDefault&&(e.disabled=!0)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return v()},getSaveParams:function(){return{id:this.formModel.id,name:this.formModel.name,accountBank:this.formModel.accountBank,accountNum:this.formModel.accountNum,currentAmount:this.formModel.currentAmount,isDefault:this.formModel.isDefault,initialAmount:this.formModel.initialAmount,remark:this.formModel.remark,shopId:this.formModel.shopId||window.top.SHOP_ID||""}},save:function(){var e=this;this.$refs.form.validate((function(t,n){if(!t)return!1;e.loading=!0;var o=function(t){e.$message.success("保存成功"),e.formModel.id||(e.formModel.id=t.id),e.$emit("operationSuccess",e.formModel.id)},a=function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)},i=function(t){e.loading=!1};e.formModel.id?h["a"].put(p["g"].invoicing.settlementAccountMgmt.shopAccount,e.getSaveParams()).then(o).catch(a).finally(i):h["a"].post(p["g"].invoicing.settlementAccountMgmt.shopAccount,e.getSaveParams()).then(o).catch(a).finally(i)}))}}},S={name:"SettlementAccountBaseInfo",components:{BizSaveButton:m["a"],BizGrid:f["a"]},data:function(){var e=this,t=function(t,n,o){""===e.formModel.currentAmount||"0.00"===e.formModel.currentAmount||Number(e.formModel.currentAmount)?o():o(new Error("当前余额必须为数字值"))};return Object(i["a"])(Object(i["a"])(Object(i["a"])({},b),M.data),{},{rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],currentAmount:[{required:!1,trigger:"blur",validator:t}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}}},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(g["c"])(["getUser"])),M.methods),M.events),watch:{itemId:function(e,t){this.disabled=!1,e.id?this.query():this.initModel()}},created:function(){this.itemId.id&&this.query()}},I=S,y=(n("689a"),n("2877")),A=Object(y["a"])(I,u,d,!1,null,null,null),w=A.exports,O={name:"SettlementAccountPopup",components:{BizPopupTabs:c["a"],SettlementAccountBaseInfo:w},props:{open:{type:Boolean},itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{tabSelection:"0",alertId:{id:""},showFailure:!0,showSign:!0}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)}}},N=O,k=Object(y["a"])(N,l,s,!1,null,null,null),_=k.exports,$={itemId:{id:""},selections:[],open:!1},x={loading:!1,tableData:[],operations:[{label:"新增",name:"add",type:"primary"},{label:"删除",name:"delete",type:"",disabled:!0},{label:"刷新",name:"refresh",type:""}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}},z={getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage}},query:function(){var e=this;this.loading=!0,h["a"].get(p["g"].invoicing.settlementAccountMgmt.shopAccountList,this.getQueryParams()).then((function(t){e.tableData=t.dataList,e.pagination.total=Number(t.total)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},refresh:function(){this.query()},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,h["a"].delete(p["g"].invoicing.settlementAccountMgmt.shopAccount,{ids:e}).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")},add:function(){this.open=!0,this.itemId={id:""}}},P={handleOperationSuccess:function(e){this.itemId.id=String(e),this.query()},handleOperate:function(e){this[e]()},handlePageSizeChange:function(e){this.pagination.pageSize=e,this.pagination.currentPage=1,this.query()},handleCurrentPageChange:function(e){this.pagination.currentPage=e,this.query()},handleSelectionChange:function(e){this.selections=e,this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1)},handleRowClick:function(e,t,n){this.itemId={id:String(e.id)},this.open=!0},handleDeleteClick:function(e,t){e.stopPropagation(),this.deleteItem([t.id])}},B={name:"SettlementAccountMgmt",components:{BizFlexTable:r["c"],RightPopup:_},props:{},data:function(){return Object(i["a"])(Object(i["a"])({},$),x)},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(g["c"])(["getUser"])),z),P),created:function(){this.query()}},j=B,C=Object(y["a"])(j,o,a,!1,null,null,null);t["default"]=C.exports},"689a":function(e,t,n){"use strict";var o=n("b13b"),a=n.n(o);a.a},7132:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"biz-fade-t"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[n("transition",{attrs:{name:"biz-fade-t-right"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},a=[],i={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},r=i,l=(n("5b8e"),n("2877")),s=Object(l["a"])(r,o,a,!1,null,null,null),c=s.exports,u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"biz-popup-tabs"},[n("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[n("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},d=[],f=(n("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),m=f,p=(n("d4c2"),Object(l["a"])(m,u,d,!1,null,null,null)),h=p.exports;n.d(t,"a",(function(){return h}))},9678:function(e,t,n){},a9e3:function(e,t,n){"use strict";var o=n("83ab"),a=n("da84"),i=n("94ca"),r=n("6eeb"),l=n("5135"),s=n("c6b6"),c=n("7156"),u=n("c04e"),d=n("d039"),f=n("7c73"),m=n("241c").f,p=n("06cf").f,h=n("9bf2").f,g=n("58a8").trim,b="Number",v=a[b],M=v.prototype,S=s(f(M))==b,I=function(e){var t,n,o,a,i,r,l,s,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:o=2,a=49;break;case 79:case 111:o=8,a=55;break;default:return+c}for(i=c.slice(2),r=i.length,l=0;l<r;l++)if(s=i.charCodeAt(l),s<48||s>a)return NaN;return parseInt(i,o)}return+c};if(i(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var y,A=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof A&&(S?d((function(){M.valueOf.call(n)})):s(n)!=b)?c(new v(I(t)),n,A):I(t)},w=o?m(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),O=0;w.length>O;O++)l(v,y=w[O])&&!l(A,y)&&h(A,y,p(v,y));A.prototype=M,M.constructor=A,r(a,b,A)}},b13b:function(e,t,n){},d4c2:function(e,t,n){"use strict";var o=n("e725"),a=n.n(o);a.a},e725:function(e,t,n){}}]);