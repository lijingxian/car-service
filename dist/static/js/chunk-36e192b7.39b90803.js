(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36e192b7"],{"0943":function(t,e,a){"use strict";var i=a("1fac"),n=a.n(i);n.a},1148:function(t,e,a){"use strict";var i=a("a691"),n=a("1d80");t.exports="".repeat||function(t){var e=String(n(this)),a="",o=i(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(a+=e);return a}},"1fac":function(t,e,a){},"225d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.tableShow,expression:"tableShow"}],ref:"template"},[t._t("default",[a("span",[t._v("编写你自己的打印区域组件，然后slot插入到vue-easy-print")])],{getChineseNumber:t.getChineseNumber})],2),t.buttonShow?a("button",{class:t.buttonClass,attrs:{type:"button"},on:{click:t.print}},[a("span",[t._v("开始打印")])]):t._e()])},n=[],o=(a("a9e3"),a("d3b7"),a("ac1f"),a("25f0"),a("466d"),a("5319"),a("1276"),{name:"vue-easy-print",components:{},props:{spaceRow:{type:Boolean,default:!1},tableData:{type:Object,default:function(){}},tableShow:{type:Boolean,default:!1},buttonShow:{type:Boolean,default:!1},buttonClass:{type:String,default:"el-button el-button--default"},onePageRow:{type:Number,default:5},beforeCopy:Function,beforePrint:Function},data:function(){return{}},mounted:function(){this.init()},methods:{init:function(){var t=this,e=document.getElementById("easyPrintIframe");e?this.getStyle():(e=document.createElement("iframe"),e.id="easyPrintIframe",e.style.position="fixed",e.style.width="0",e.style.height="0",e.style.top="-100px",window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)&&(e.src='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";<\/script></head><body></body>")'),e.onload=function(){t.getStyle()},document.body.appendChild(e))},print:function(){"function"===typeof this.beforeCopy&&this.beforeCopy();var t=document.getElementById("easyPrintIframe");t.contentDocument.body.innerHTML=this.$refs.template.innerHTML,"function"===typeof this.beforePrint&&this.beforePrint(),setTimeout((function(){t.contentWindow.print()}),100)},getStyle:function(){for(var t=document.getElementById("easyPrintIframe"),e="",a=document.querySelectorAll("style"),i=0;i<a.length;i++)e+=a[i].outerHTML;t.contentDocument.head.innerHTML=e;for(var n=document.querySelectorAll("link"),o=0;o<n.length;o++){var s=document.createElement("link");s.setAttribute("rel","stylesheet"),n[o].type?s.setAttribute("type",n[o].type):s.setAttribute("type","text/css"),s.setAttribute("href",n[o].href),s.setAttribute("media","all"),t.contentDocument.head.appendChild(s)}},getChineseNumber:function(t){var e,a,i,n,o,s,r,l,c,u,d,p,h,f,g=99999999999.99,m="零",b="壹",v="贰",y="叁",w="肆",S="伍",C="陆",D="柒",_="捌",I="玖",x="拾",P="佰",A="仟",k="万",N="亿",z="",T="元",O="角",L="分",M="整";if(void 0===t)return"";if(t=t.toString(),""==t)return"";if(null!=t.match(/[^,.\d]/))return"";if(null==t.match(/^((\d{1,3}(,\d{3})*(.((\d{3},)*\d{1,3}))?)|(\d+(.\d+)?))$/))return"";if(t=t.replace(/,/g,""),t=t.replace(/^0+/,""),Number(t)>g)return alert("您输入的金额太大，请重新输入!"),"";if(n=t.split("."),n.length>1?(e=n[0],a=n[1],a=a.substr(0,2)):(e=n[0],a=""),o=new Array(m,b,v,y,w,S,C,D,_,I),s=new Array("",x,P,A),r=new Array("",k,N),l=new Array(O,L),i="",Number(e)>0){for(c=0,u=0;u<e.length;u++)d=e.length-u-1,p=e.substr(u,1),h=d/4,f=d%4,"0"==p?c++:(c>0&&(i+=o[0]),c=0,i+=o[Number(p)]+s[f]),0==f&&c<4&&(i+=r[h]);i+=T}if(""!=a)for(u=0;u<a.length;u++)p=a.substr(u,1),"0"!=p&&(i+=o[Number(p)]+l[u]);return""==i&&(i=m+T),""==a&&(i+=M),i=z+i,i}}}),s=o,r=a("2877"),l=Object(r["a"])(s,i,n,!1,null,null,null),c=l.exports;e["a"]=c},2992:function(t,e,a){"use strict";var i=a("d437"),n=a.n(i);n.a},"408a":function(t,e,a){var i=a("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=i(t))throw TypeError("Incorrect invocation");return+t}},"443b":function(t,e,a){"use strict";a("4de4");var i=a("c596"),n=a("1ab1"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":"",visible:t.visible,title:"自定义列","custom-class":"biz-columns",width:"500px"},on:{close:t.onClose}},[a("div",{staticClass:"columns-wrap"},[a("biz-flex-table",{ref:"table",attrs:{checkable:!1,tableData:t.tableData},on:{"selection-change":t.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:t.getSelectable}}),a("el-table-column",{attrs:{label:"信息",prop:"name"}}),a("el-table-column",{attrs:{prop:"tag",label:"排序"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.$index;return[a("el-button",{attrs:{icon:"el-icon-sort-up",type:"text",disabled:0===i},on:{click:function(e){return t.onUp(i)}}}),a("el-button",{attrs:{icon:"el-icon-sort-down",type:"text",disabled:i===t.tableData.length-1},on:{click:function(e){return t.onBottom(i)}}})]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.onClose}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.update}},[t._v("确 定")])],1)])},s=[],r=(a("7db0"),a("a434"),a("b85c")),l=a("04d3"),c={name:"biz-columns",components:{BizFlexTable:l["c"]},props:{visible:Boolean,tableId:String},data:function(){return{id:"",tableName:"",selections:[],tableData:[]}},computed:{},watch:{visible:function(t){t?this.makeRowDisplayable():this.saveSelection()},tableId:function(){this.getTableColumns()}},mounted:function(){this.getTableColumns()},methods:{getTableColumns:function(){var t=this;n["a"].get(i["g"].user.columns,{tableId:this.tableId}).then((function(e){t.tableData=e.data.columnDatas,t.id=e.data.id,t.tableName=e.data.tableName}))},getSelectable:function(t){return t.isEditable},selectionChangeHandler:function(t){this.selections=t},saveSelection:function(){var t,e=this,a=Object(r["a"])(this.tableData);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.displayable=!1}}catch(l){a.e(l)}finally{a.f()}var n,o=Object(r["a"])(this.selections);try{var s=function(){var t=n.value;e.tableData.find((function(e){return e.id===t.id})).displayable=!0};for(o.s();!(n=o.n()).done;)s()}catch(l){o.e(l)}finally{o.f()}},onUp:function(t){this.tableData[t]=this.tableData.splice(t-1,1,this.tableData[t])[0]},onBottom:function(t){this.tableData[t]=this.tableData.splice(t+1,1,this.tableData[t])[0]},onClose:function(){this.$emit("update:visible",!1)},update:function(){var t,e=this,a=Object(r["a"])(this.tableData);try{for(a.s();!(t=a.n()).done;){var o=t.value;o.displayable=!1}}catch(d){a.e(d)}finally{a.f()}var s,l=Object(r["a"])(this.selections);try{var c=function(){var t=s.value;e.tableData.find((function(e){return e.id===t.id})).displayable=!0};for(l.s();!(s=l.n()).done;)c()}catch(d){l.e(d)}finally{l.f()}var u={columnDatas:this.tableData,id:this.id,tableId:this.tableId,tableName:this.tableName};console.log(u),n["a"].put(i["g"].user.columns,u).then((function(t){e.$emit("update"),e.$emit("update:visible",!1)}))},makeRowDisplayable:function(){var t=this;setTimeout((function(){var e,a=Object(r["a"])(t.tableData);try{for(a.s();!(e=a.n()).done;){var i=e.value;t.$refs.table.$refs.table.toggleRowSelection(i,i.displayable)}}catch(n){a.e(n)}finally{a.f()}}),20)}}},u=c,d=(a("ec6b"),a("2877")),p=Object(d["a"])(u,o,s,!1,null,null,null),h=p.exports,f=h;e["a"]={components:{BizColumnOperation:l["a"],BizColumns:f},data:function(){return{columnsSettingVisible:!1,columns:[]}},created:function(){this.getTableId(),this.getColumns()},methods:{onCustomColumns:function(){this.columnsSettingVisible=!0},getColumns:function(){var t=this;console.log(12),n["a"].get(i["A"].columns,{tableId:this.tableId}).then((function(e){t.columns=[],setTimeout((function(){t.columns=e.data.columnDatas.filter((function(t){return t.displayable})),t.$refs.table&&setTimeout((function(){t.$refs.table.doLayout()}),50)}),20)})).catch((function(t){t.errorMessage&&console.log(t.errorMessage)}))},getTableId:function(){}}}},"471a":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"purchase-apply-mgmt"},[a("div",{staticClass:"toggle-btn",on:{click:t.isShow}},[t._v(" "+t._s(t.toggleRecommendTxt)+" "),a("div",{staticClass:"iconfont biz-icon-i-web-zd1",class:{"rotate-180":t.showRecommend}})]),a("biz-flex-table",{ref:"table",staticClass:"purchase-apply-mgmt-tabel",attrs:{operations:t.operations,filters:t.filters,tableData:t.tableData,pagination:t.pagination,showSummary:!0},on:{operate:t.operate,"filter-data-change":t.filterDataChange,"selection-change":t.handleSelectionChange,"row-click":t.rowClick,"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},[a("el-table-column",{attrs:{label:"订单","min-width":"180px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[t._v(t._s(e.row.sn))]),a("div",{staticClass:"overflow"},[t._v("创建日期："+t._s(e.row.createDate))]),a("div",{staticClass:"overflow"},[t._v("状态："+t._s(t.getStatus(e.row)))])])]}}])}),a("el-table-column",{attrs:{label:"申请人","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[t._v(" "+t._s(e.row.applierName)+" ")])])]}}])}),a("el-table-column",{attrs:{label:"供应商","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[t._v(" "+t._s(e.row.relatePartnerName)+" ")])])]}}])}),a("el-table-column",{attrs:{label:"金额","min-width":"120px",prop:"amount"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[t._v(" 不含税： ")]),a("div",{staticClass:"overflow"},[t._v(" 税额： ")]),a("div",{staticClass:"overflow"},[t._v(" 含税："+t._s(e.row.totalFee)+" ")])])]}}])}),a("el-table-column",{attrs:{label:"商品信息","min-width":"220px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[a("div",{staticStyle:{width:"100%"}},t._l(e.row.itemDatas.length>0?[e.row.itemDatas[0]]:[],(function(i){return a("div",{key:i.sn,staticClass:"product-info-content"},[i.thumbnail&&" "!==i.thumbnail?a("img",{attrs:{src:i.thumbnail,onerror:t.errorImg}}):a("img",{attrs:{src:"/resources/admin/images/default/product-default-100.png"}}),a("div",{staticClass:"wrapper"},[a("div",{staticClass:"titleClass",attrs:{title:i.name}},[t._v(t._s(i.name))]),a("div",{staticClass:"overflow"},[t._v(t._s(i.product?i.product.barCode:""))]),a("div",{staticClass:"overflow"},[t._v("单价(不含税)：")]),a("div",{staticClass:"overflow"},[t._v("单价(含税)："+t._s(i.price))])]),a("div",{staticClass:"amount"},[t._v(t._s(i.amount)+t._s(e.row.itemDatas.length>1?"...":""))])])})),0)])]}}])}),a("el-table-column",{attrs:{prop:"date",label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("biz-column-operation",{attrs:{row:e.row}},[t.hasAuthExamine&&("1"===e.row.state&&"1"===e.row.audit||"2"===e.row.state&&"1"===e.row.audit)?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.toPass(e.row,"1")}}},[t._v("审核")]):t._e(),"0"===e.row.state?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.statusChange(e.row,"0")}}},[t._v("提交")]):t._e(),"1"===e.row.state&&"1"===e.row.isApplier?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.statusChange(e.row,"3")}}},[t._v("撤回")]):t._e(),"0"===e.row.state&&t.hasAuthDel?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.deleteApply(a,e.row)}}},[t._v("删除")]):t._e(),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.printApply(e.row)}}},[t._v("凭证")])],1)]}}])})],1),a("biz-popup-tabs",{attrs:{open:t.openAdd},on:{close:function(e){t.openAdd=!1}},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:"添加申请单",name:"addinfo"}},[t.step1?a("base-info",{ref:"step1Info",attrs:{backForm:t.backForm},on:{step1Confirm:t.step1Confirm}}):t._e(),t.step2?a("product-info",{attrs:{formData:t.formData},on:{step2Confirm:t.step2Confirm,operationSuccess:t.operationSuccess}}):t._e()],1)],1),a("biz-popup-tabs",{attrs:{open:t.open},on:{close:function(e){t.open=!1}},model:{value:t.tabNameInfo,callback:function(e){t.tabNameInfo=e},expression:"tabNameInfo"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[a("apply-info",{ref:"info",attrs:{itemId:t.itemId,isPend:t.isPend}})],1)],1),a("el-dialog",{attrs:{visible:t.dialogTableVisible,center:"",width:"800px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.print}},[t._v("打印")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.exportInvoice}},[t._v("导出")])],1)])],1),a("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[a("div",{staticClass:"d-p-wrap"},[a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("div",{staticClass:"p-title"},[t._v(t._s(t.title))])]),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[t._v("打印日期："+t._s(t.formatDate((new Date).getTime())))])])],1),a("el-row",{staticClass:"row-top",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("编号："+t._s(t.form.sn))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("创建时间："+t._s(t.form.createDate))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("供应商："+t._s(t.form.relatePartnerName))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("总金额(元)："+t._s(t.form.totalFee))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("申请人："+t._s(t.form.applierName))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("状态："+t._s(t.form.state))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("备注："+t._s(t.form.remark))])])],1),a("el-table",{staticClass:"table-class",attrs:{data:t.gridData,"show-summary":""}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),a("el-table-column",{attrs:{property:"productName",label:"商品名称","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.fullName))]}}])}),a("el-table-column",{attrs:{property:"product.barCode",label:"条码"}}),a("el-table-column",{attrs:{property:"amount",label:"采购数量"}}),a("el-table-column",{attrs:{property:"price",label:"金额(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(e.row.price))]}}])}),a("el-table-column",{attrs:{property:"totalFee",label:"小计"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(e.row.totalFee))]}}])})],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{float:"right","padding-right":"100px"}},[t._v("客户签字：")])])],1)],1)])],1),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(e){t.showPassOrder=e}}},[a("div",[a("div",{staticClass:"reson-container"},[a("span",[t._v("审核结果：")]),a("el-radio",{attrs:{label:"1",size:"mini"},model:{value:t.auditState,callback:function(e){t.auditState=e},expression:"auditState"}},[t._v("通过")]),a("el-radio",{attrs:{label:"2",size:"mini"},model:{value:t.auditState,callback:function(e){t.auditState=e},expression:"auditState"}},[t._v("驳回")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"2"===t.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[a("span",[t._v("驳回理由：")]),a("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:t.curSelectCloseReason,callback:function(e){t.curSelectCloseReason=e},expression:"curSelectCloseReason"}},t._l(t.reasonList,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}})],1)]),a("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.showPassOrder=!1}}},[t._v("取消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.statusChange(t.row,t.auditState)}}},[t._v("确定")])],1)])],1)},n=[],o=(a("99af"),a("4160"),a("caad"),a("d81d"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("2532"),a("3ca3"),a("466d"),a("1276"),a("159b"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),s=a("5530"),r=a("7132"),l=a("04d3"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"apply-base-info"},[a("div",{attrs:{slot:"top"},slot:"top"},[a("div",{staticClass:"header-step"},[a("div",{staticClass:"step-1"},[a("span",[t._v("①")]),a("span",[t._v("填写基本信息")]),a("span",[t._v(">")])]),a("div",{staticClass:"step-2"},[a("span",[t._v("②")]),a("span",[t._v("选择商品")])])])]),a("biz-save-button",{attrs:{slot:"bottom",operations:t.operations},on:{operate:t.operate},slot:"bottom"}),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px",size:"small","inline-message":!0}},[a("el-form-item",{attrs:{label:"供应商",prop:"relatePartnerName"}},[a("el-input",{attrs:{placeholder:"请选择供应商"},on:{focus:function(e){t.showDialog=!0}},model:{value:t.form.relatePartnerName,callback:function(e){t.$set(t.form,"relatePartnerName",e)},expression:"form.relatePartnerName"}})],1),a("el-form-item",{attrs:{label:"送达仓库",prop:"depot"}},[a("el-card",{attrs:{placeholder:"请选择送达仓库"},nativeOn:{click:function(e){return t.depotButtonClick(e)}}},[a("div",{staticClass:"top",staticStyle:{"font-weight":"bold"}},[a("span",[t._v(t._s(t.form.depot.name))])]),a("div",{staticClass:"content"},[a("span",{staticStyle:{"margin-right":"15px"}},[t._v(t._s(t.form.depot.contactor))]),a("span",[t._v(t._s(t.form.depot.phone))])]),a("div",{staticClass:"bottom"},[a("span",[t._v(t._s(t.form.depot.address))])])])],1)],1),a("biz-dialog-selector",{staticClass:"supplierDialog",attrs:{title:"选择供应商",visibility:t.showDialog,appendToBody:!0,tableData:t.dialogTableData,pagination:t.dialogPagination,selectionMode:"single",isClear:!1,filters:t.dialogFilters},on:{"update:visibility":function(e){t.showDialog=e},open:t.opened,confirmed:t.handleConfirmed,filterDataChange:t.dialogFilterDataChange,pageSizeChange:t.dialogPageSizeChange,currentPageChange:t.dialogCurrentPageChange}},[a("el-table-column",{attrs:{label:"供应商名称",width:"200px",prop:"name"}}),a("el-table-column",{attrs:{prop:"address",label:"地址"}}),a("el-table-column",{attrs:{prop:"phone",label:"电话"}})],1),a("biz-dialog-selector",{staticClass:"depotDialog",attrs:{title:"选择仓库",visibility:t.showDepotDialog,appendToBody:!0,tableData:t.dialogDepotTableData,pagination:t.dialogDepotPagination,selectionMode:"single",isClear:!1,filters:t.dialogDepotFilters},on:{"update:visibility":function(e){t.showDepotDialog=e},open:t.openedDepot,confirmed:t.handleDepotConfirmed,filterDataChange:t.dialogDepotFilterDataChange,pageSizeChange:t.dialogDepotPageSizeChange,currentPageChange:t.dialogDepotCurrentPageChange}},[a("el-table-column",{attrs:{label:"名称",prop:"name"}}),a("el-table-column",{attrs:{label:"联系人",prop:"contactor"}}),a("el-table-column",{attrs:{prop:"address",label:"地址"}}),a("el-table-column",{attrs:{prop:"phone",label:"电话"}})],1)],1)},u=[],d=a("b85c"),p=a("f36f"),h=a("8330"),f=a("af3f"),g=a("2f62"),m=a("1ab1"),b=a("c596"),v=function(){return{relatePartnerId:"",relatePartnerName:"",relatePartnerType:"",totalFee:"",billType:"",sn:"",applierId:"",applierName:"",relateBill:"",relateBillType:"",discountRate:"0",discontFee:"",auditLevel:"",state:"",id:"",createDate:"",shopId:"",shop:{},depot:{id:"",name:"",address:"",phone:"",contactor:""}}},y={name:"baseInfo",props:{itemId:{type:String},backForm:{type:Object}},components:{BizGrid:p["a"],BizSaveButton:h["a"],BizDialogSelector:f["a"]},data:function(){var t=this;return{loading:!1,showDialog:!1,showDepotDialog:!1,dialogVisible:!1,form:v(),totalFee:0,itemDatas:[],operations:[{label:"确定",name:"save",type:"primary",auth:["admin:purchaseApplication.edit"]}],dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入供应商名称",name:"searchValue",value:""}],dialogDepotTableData:[],dialogDepotPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogDepotFilters:[{type:"input",label:"",placeholder:"请输入仓库名称",name:"searchValue",value:""}],rules:{relatePartnerName:[{required:!0,message:"请选择供应商",trigger:["blur","change"]}],depot:[{required:!0,trigger:["blur","change"],validator:function(e,a,i){""!==t.form.depot.name?i():i(new Error("请选择送达仓库"))}}]}}},computed:{},created:function(){},watch:{},methods:Object(s["a"])(Object(s["a"])({},Object(g["c"])(["getUser"])),{},{operate:function(t){this[t]()},getDefaultModel:function(){return v()},save:function(){var t=this;this.$refs.form.validate((function(e,a){if(!e)return!1;t.$emit("step1Confirm",t.form)}))},opened:function(){this.dialogTableData=[],this.getSupplier()},getSupplier:function(){var t=this;this.loading=!0;var e={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||"",cooperationType:"0",state:"1"};m["a"].get(b["g"].invoicing.supplierMgmt.shopSupplierList,e).then((function(e){t.loading=!1,t.dialogTableData=e.dataList,t.dialogPagination.total=Number(e.total)})).catch((function(e){t.loading=!1,e.errorMessage&&console.log(e.errorMessage)}))},depotButtonClick:function(){this.openedDepot()},openedDepot:function(){this.dialogDepotTableData=[],this.getDepotList(),this.showDepotDialog=!0},getDepotListParams:function(){return{shopId:window.top.SHOP_ID||"",state:"1",pageSize:this.dialogDepotPagination.pageSize,pageNumber:this.dialogDepotPagination.currentPage,name:this.dialogDepotFilters[0].value}},getDepotList:function(){var t=this;m["a"].get(b["g"].invoicing.storeHouseMgmt.shopDepotList,this.getDepotListParams()).then((function(e){t.dialogDepotTableData=e.dataList;var a,i=Object(d["a"])(e.dataList);try{for(i.s();!(a=i.n()).done;){var n=a.value;"1"===n.isDefault&&(t.form.depot.id=n.id,t.form.depot.name=n.name,t.form.depot.address=n.address,t.form.depot.phone=n.phone,t.form.depot.contactor=n.contactor)}}catch(o){i.e(o)}finally{i.f()}t.dialogDepotPagination.total=Number(e.total)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},dialogPageSizeChange:function(t){this.dialogPagination.pageSize=t,this.getSupplier()},dialogCurrentPageChange:function(t){this.dialogPagination.currentPage=t,this.getSupplier()},dialogFilterDataChange:function(t){this.dialogFilters=t,this.dialogPagination.currentPage=1,this.getSupplier()},dialogDepotPageSizeChange:function(t){this.dialogPagination.pageSize=t,this.getSupplier()},dialogDepotCurrentPageChange:function(t){this.dialogPagination.currentPage=t,this.getDepotList()},dialogDepotFilterDataChange:function(t){this.dialogFilters=t,this.dialogPagination.currentPage=1,this.getDepotList()},handleConfirmed:function(t,e){this.form.relatePartnerName=e[0].name,this.form.relatePartnerId=e[0].id},handleDepotConfirmed:function(t,e){this.form.depot.id=e[0].id,this.form.depot.name=e[0].name,this.form.depot.address=e[0].address,this.form.depot.phone=e[0].phone,this.form.depot.contactor=e[0].contactor,this.$refs.form.clearValidate("depot")},query:function(){this.form=this.backForm}})},w=y,S=(a("def8"),a("2877")),C=Object(S["a"])(w,c,u,!1,null,null,null),D=C.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"product-info-apply"},[a("div",{attrs:{slot:"bottom"},slot:"bottom"},[a("div",{staticClass:"subTotal"},[a("div",{staticStyle:{"margin-right":"100px","margin-top":"5px"}},[t._v(" 合计: "),a("span",{staticClass:"price"},[t._v("￥"+t._s(t.totalFee?t.totalFee:"0.00"))])]),a("biz-save-button",{attrs:{operations:t.operations},on:{operate:t.operate}})],1)]),a("div",{attrs:{slot:"top"},slot:"top"},[a("div",{staticClass:"header-step"},[a("div",{staticClass:"step-1",on:{click:t.returnStepOne}},[a("span",[t._v("①")]),a("span",[t._v("填写基本信息")]),a("span",[t._v(">")])]),a("div",{staticClass:"step-2"},[a("span",[t._v("②")]),a("span",[t._v("选择商品")])])]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addProduct}},[t._v("添加商品")])],1),a("biz-list",{key:Math.random(),ref:"table",attrs:{tableData:t.tableData,height:"100%"}},[a("el-table-column",{attrs:{prop:"productName",label:"商品","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"justify-content":"space-between",width:"100%"}},[a("div",{staticStyle:{width:"100%","margin-right":"30px"}},[a("div",{staticClass:"product-info"},[e.row.image?a("img",{attrs:{src:e.row.image}}):a("img",{attrs:{src:"/resources/admin/images/default/product-default-100.png"}}),a("div",{staticClass:"wrapper"},[a("div",{staticClass:"titleClass",attrs:{title:e.row.productName}},[t._v(t._s(e.row.productName))]),a("div",{staticClass:"info-bottom"},[a("div",{staticStyle:{color:"red"}},[t._v("￥"+t._s(e.row.price))])])])])])])]}}])}),a("el-table-column",{attrs:{prop:"barCode",label:"条码"}}),a("el-table-column",{attrs:{prop:"amount",label:"数量","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",{staticClass:"biz-customcol"},[a("el-input-number",{attrs:{size:"mini",min:1},on:{change:function(a){return t.amountChange(e.row.amount)}},model:{value:e.row.amount,callback:function(a){t.$set(e.row,"amount",a)},expression:"scope.row.amount"}})],1)])}}])}),a("el-table-column",{attrs:{prop:"date",label:"操作",type:"index","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",{staticClass:"biz-customcol"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.deleteHandeler(e)}}},[t._v("删除")])],1)])}}])})],1),a("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"选择商品",visibility:t.showDialog,tableData:t.giftList,pagination:t.dialogPagination,filters:t.dialogFilters,selectionKeys:t.selectedGiftIds},on:{"update:visibility":function(e){t.showDialog=e},pageSizeChange:t.dialogPageSizeChange,currentPageChange:t.dialogCurrentPageChange,confirmed:t.confirmedProduct,filterDataChange:t.dialogFilterDataChange,selectionChange:t.selectionChange,"active-item-change":t.activeItemChange,cascaderChange:t.cascaderChange}},[a("el-table-column",{attrs:{property:"fullName",label:"商品名称",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"dialog-column"},[a("img",{staticClass:"productImg",attrs:{src:e.row.image||t.DefaultImg,onerror:t.errorImg}}),a("div",{staticClass:"biz-two-row"},[a("div",{staticClass:"titleClass",staticStyle:{"margin-left":"10px"},attrs:{title:e.row.fullName}},[t._v(t._s(e.row.fullName))]),a("div",{staticStyle:{"margin-left":"10px"}},[t._v("编号："+t._s(e.row.sn))])])])]}}])}),a("el-table-column",{attrs:{property:"barCode",label:"条码"}}),a("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),a("el-table-column",{attrs:{property:"brandName",label:"品牌"}}),a("el-table-column",{attrs:{property:"price",label:"价格"}}),a("el-table-column",{attrs:{label:"在库库存"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{width:"120px"}},[t._v(t._s(e.row.realStock))])]}}])})],1)],1)},I=[],x=(a("c975"),a("a434"),a("b680"),a("25f0"),a("7558")),P=a("f3ac"),A=a.n(P),k={name:"ProductInfo",props:{formData:{type:Object}},data:function(){return{dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},errorImg:'this.src="/resources/admin/images/default/product-default.png"',selectedGiftList:[],selectedGiftIds:[],selectionList:[],showDialog:!1,DefaultImg:A.a,productCategoryId:"",dialogFilters:[{type:"cascader",label:"分类",name:"category",filterable:!1,value:[],options:[]},{type:"select",label:"品牌",value:"",options:[]},{type:"input",placeholder:"请输入编号/商品名/条码",name:"searchbar",value:""}],giftList:[],loading:!1,open:!1,totalFee:"",height:"585",tableData:[],selections:[],categoryDatas:[],itemDatas:[],dialogTableVisible:!1,title:"",operations:[{label:"确定申请",name:"save",type:"primary",auth:["admin:purchaseApplication.edit"]}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:x["a"],BizGrid:p["a"],BizSaveButton:h["a"],BizDialogSelector:f["a"]},watch:{},mounted:function(){var t=document.documentElement.clientHeight||window.innerHeight;this.height=String(t-175)},methods:Object(s["a"])(Object(s["a"])({},Object(g["c"])(["getUser"])),{},{returnStepOne:function(){this.$emit("step2Confirm",this.formData)},addProduct:function(){this.queryFilters(),this.getGiftList(),this.selectedGiftIds.splice(0,this.selectedGiftIds.length),this.selectedGiftList.splice(0,this.selectedGiftList.length),this.showDialog=!0},dialogPageSizeChange:function(t){this.dialogPagination.pageSize=t,this.getGiftList()},dialogCurrentPageChange:function(t){this.dialogPagination.currentPage=t,this.getGiftList()},dialogFilterDataChange:function(t){this.dialogFilters=t,this.dialogPagination.currentPage=1,this.giftList=[],this.getGiftList()},getGiftList:function(){var t=this,e={productCategoryId:this.productCategoryId,brandId:this.getSelectedBrandId(),supplierId:this.formData.relatePartnerId,searchValue:this.dialogFilters[2].value,shopId:window.top.SHOP_ID||"",pageNumber:this.dialogPagination.currentPage,pageSize:this.dialogPagination.pageSize};m["a"].get("/admin/purchaseOrder/supplierProducts.jhtml",e).then((function(e){t.giftList=e.dataList,t.dialogPagination.total=Number(e.total)})).catch((function(t){t.errorMessage&&console.log(t.errorMessage)}))},selectionChange:function(t){var e=this;t.forEach((function(t){-1===e.selectionList.indexOf(t)&&e.selectionList.push(t)}))},confirmedProduct:function(t){var e=this;this.selectedGiftIds=t.concat(),this.selectedGiftList=[],this.selectionList.map((function(t){-1!==e.selectedGiftIds.indexOf(t.id)&&(e.$set(t,"amount",1),e.$set(t,"productName",t.fullName),e.selectedGiftList.push(t))}));this.selectedGiftList.map((function(t){Number(t.amount)*Number(t.price)})),this.selectedGiftList.forEach((function(t){e.handleSelect(t)}))},operate:function(t){this[t]()},handleSelect:function(t){var e=!1;if(t.productId=t.id,t.id="",this.totalFee=(Number(this.totalFee)+Number(t.amount)*Number(t.price)).toFixed(2),0!==this.tableData.length){for(var a=0;a<this.tableData.length;a++)if(this.tableData[a].productId===t.productId){this.tableData[a].amount=(Number(this.tableData[a].amount)+1).toString(),e=!0;break}e||this.tableData.push(t)}else this.tableData.push(t)},deleteHandeler:function(t){this.tableData.splice(t.$index,1),this.totalFee=(Number(this.totalFee)-Number(t.row.price)*Number(t.row.amount)).toFixed(2)},save:function(){var t=this;this.itemDatas=this.tableData.map((function(t){return{productId:t.productId?t.productId:t.id,amount:t.amount||"",price:t.price||"",image:t.image||"",productName:t.fullName,specId:t.specId||"",specValue:t.specValue||"",totalFee:t.amount*t.price||"",categoryId:t.categoryId,categoryName:t.categoryName}}));var e=!1;if(this.tableData.forEach((function(a){-1!==String(a.amount).indexOf(".")&&(t.$message.warning("数量不能为小数"),e=!0)})),e)return!1;var a={shopId:window.top.SHOP_ID||"",relatePartnerId:this.formData.relatePartnerId,depot:{id:this.formData.depot.id},itemDatas:this.itemDatas};m["a"].post(b["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,a).then((function(e){t.$message.success("创建成功"),t.$emit("operationSuccess"),t.loading=!1})).catch((function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},amountChange:function(t){var e=0;this.tableData.map((function(t){e+=Number(t.amount)*Number(t.price)})),this.totalFee=e?e.toFixed(2):""},queryFilters:function(){var t=this,e={shopId:window.top.SHOP_ID||""};m["a"].get("/admin/shopProduct/filter.jhtml",e).then((function(e){t.categoryDatas=e.categoryDatas,t.setCategoryFilters(),t.setBrandFilters(e.brandDatas)})).catch((function(){}))},setCategoryFilters:function(){var t=[{value:"",label:"全部"}];this.categoryDatas.forEach((function(e){t.push({value:e.id,label:e.name,children:[{label:"全部",value:""}]})})),this.dialogFilters[0].options=t},setBrandFilters:function(t){this.dialogFilters[1].options=t.map((function(t){return{value:t.id,label:t.name}})),this.dialogFilters[1].options.splice(0,0,{value:"",label:"全部"})},getSelectedBrandId:function(){return this.dialogFilters[1].value},activeItemChange:function(t){var e=this,a={shopId:this.getUser().shop.id,parentId:t.toString()};m["a"].get("/admin/shopProduct/productCategorys.jhtml",a).then((function(a){var i;e.setCategoryFilters(),e.dialogFilters[0].options.forEach((function(e){e.value===t[0]&&(i=e.children)})),a.dateList.forEach((function(t){i.push({value:t.id,label:t.name})}))})).catch((function(){}))},cascaderChange:function(t){this.productCategoryId=t[t.length-1],t.length>1&&""===this.productCategoryId&&(this.productCategoryId=t[t.length-2]),this.getGiftList()}})},N=k,z=(a("74bf"),Object(S["a"])(N,_,I,!1,null,null,null)),T=z.exports,O=a("a9f4"),L=a("225d"),M=a("bc3a"),R=a.n(M),E=a("443b"),F={name:"PurchaseApplyMgmtList",data:function(){return{tabName:"addinfo",tabNameInfo:"info",curSelectCloseReason:"申报的商品与实际需要采购的商品不符",reasonList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}],itemId:"",remarks:"",title:"",showRecommend:!1,isEdit:!0,isPend:!1,returnId:"",auditState:"1",form:{},formData:{},backForm:{},row:{},loading:!1,open:!1,openAdd:!1,dialogTableVisible:!1,step1:!0,step2:!1,showCloseOrder:!1,showPassOrder:!1,selections:[],operations:[{label:"添加",name:"add",type:"primary",class:"show",auth:["admin:purchaseApplication.add"]},{label:"删除",name:"delete",type:"",disabled:!0,auth:["admin:purchaseApplication.delete"]},{label:"刷新",name:"refresh",type:""},{label:"导出",name:"export",type:"",auth:["admin:purchaseApplication.export"]}],filters:[{type:"select",label:"供应商",name:"supplier",value:[],class:"hidden",filterable:!0,multiple:!0,collapseTags:!0,options:[]},{type:"select",label:"申请人",name:"people",value:"",class:"hidden",options:[]},{type:"select",label:"申请状态",name:"state",value:"",class:"hidden",options:[]},{type:"daterange",label:"创建日期",name:"publishDate",class:"hidden",value:[]},{type:"input",label:"",placeholder:"请输入采购申请单编号/条码",name:"searchValue",value:""}],tableData:[],gridData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9}}},components:{BizPopupTabs:r["a"],BizFlexTable:l["c"],BaseInfo:D,vueEasyPrint:L["a"],ProductInfo:T,ApplyInfo:O["a"]},created:function(){this.getList(),this.queryKpi(),this.querySupplier(),this.queryFilters()},watch:{},mixins:[E["a"]],computed:Object(s["a"])(Object(s["a"])({},Object(g["c"])("Authority",["currentAuth"])),{},{hasAuthExamine:function(){return this.currentAuth.includes("admin:purchaseApplication.examine")},hasAuthDel:function(){return this.currentAuth.includes("admin:purchaseApplication.delete")},toggleRecommendTxt:function(){var t=this.showRecommend;return t?"收起":"筛选"}}),mounted:function(){this.getIsEdit()},methods:Object(s["a"])(Object(s["a"])({},Object(g["c"])(["getUser"])),{},{operate:function(t){this[t]()},isShow:function(){this.showRecommend?(this.filters[0].class="hidden",this.filters[1].class="hidden",this.filters[2].class="hidden",this.filters[3].class="hidden",document.getElementsByClassName("biz-table-filter")[0].style.marginTop=""):(this.filters[0].class="show",this.filters[1].class="show",this.filters[2].class="show",this.filters[3].class="show",document.getElementsByClassName("biz-table-filter")[0].style.marginTop="30px"),this.showRecommend=!this.showRecommend},getIsEdit:function(){var t=this;m["a"].get("/admin/invoicing/config/setting.jhtml",{shopId:this.getUser().shop.id}).then((function(e){"0"===e.purchaseApply?t.operations[0].class="hidden":t.operations[0].class="show"})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){}))},step1Confirm:function(t){this.step1=!1,this.step2=!0,this.formData=t},step2Confirm:function(t){var e=this;this.step1=!0,this.step2=!1,this.backForm=t,this.$nextTick((function(){e.$refs.step1Info.query()}))},refresh:function(){this.getList()},operationSuccess:function(){this.openAdd=!1,this.refresh()},formatDate:function(t){var e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1,n=e.getDate(),o=a+"-"+(i<10?"0"+i:i)+"-"+(n<10?"0"+n:n);return o},reject:function(t,e){this.remarks="",this.row=t,this.showCloseOrder=!0},toPass:function(t,e){this.remarks="",this.row=t,this.showPassOrder=!0},statusChange:function(t,e){var a=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.loading=!0;var i={shopId:window.top.SHOP_ID||"",id:t.id,actionType:e,details:"2"===e?a.curSelectCloseReason:"",remarks:a.remarks};m["a"].post("/admin/invoicing/purchase/shopPurchaseApplyState.jhtml",i).then((function(t){a.$message.success("操作成功！"),a.showPassOrder=!1,a.loading=!1,a.refresh()})).catch((function(t){a.loading=!1,t.errorMessage&&a.$message.warning(t.errorMessage)})).finally((function(){}))}))},deleteApply:function(t,e){t.stopPropagation(),this.deleteItem([e.id])},deleteItem:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,m["a"].delete(b["g"].invoicing.purchaseApplyMgmt.shopPurchaseApply,{ids:t}).then((function(t){e.$message.success("删除成功"),e.refresh()})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}))},delete:function(){if(this.selections&&this.selections.length>0){var t=[];this.selections.forEach((function(e){t.push(e.id)})),this.deleteItem(t)}else this.$message("请选择一条数据")},printApply:function(t){var e=this,a={id:t.id};m["a"].get(b["g"].invoicing.purchaseApplyMgmt.print,a).then((function(t){e.dialogTableVisible=!0,e.title=e.getUser().shop.name+"采购申请单",e.form=t.data,"0"===e.form.state?e.form.state="已创建":"1"===e.form.state?e.form.state="已提交":"2"===e.form.state?e.form.state="审核中":"3"===e.form.state?e.form.state="已通过":"4"===e.form.state?e.form.state="已驳回":e.form.state="",e.gridData=t.data.itemDatas,e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t)})).finally((function(t){e.loading=!1}))},print:function(){this.$refs.easyPrint.print()},exportInvoice:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,i,n,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={id:t.form.id,type:"0"},e.prev=1,e.next=4,R.a.post("/admin/invoicing/purchase/voucher/purchaseApply/export.jhtml",a,{responseType:"blob"});case 4:return i=e.sent,console.log("response => ",i),n=new Blob([i.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(i.headers["content-disposition"])),o=decodeURI(i.headers["content-disposition"].split("filename=")[1]),s=document.createElement("a"),s.download=o.match(/"(\S*)"/)[1],s.style.display="none",s.href=URL.createObjectURL(n),document.body.appendChild(s),s.click(),URL.revokeObjectURL(s.href),document.body.removeChild(s),e.abrupt("return");case 20:throw e.prev=20,e.t0=e["catch"](1),new Error(e.t0);case 23:case"end":return e.stop()}}),e,null,[[1,20]])})))()},export:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,i,n,o,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=[],t.selections&&t.selections.length>0&&t.selections.forEach((function(t){a.push(t.id)})),i={ids:a,pageable:{pageSize:t.pagination.pageSize,pageNumber:t.pagination.currentPage,searchValue:t.filters[4].value},shopId:window.top.SHOP_ID||"",supplierIds:t.filters[0].value,applierId:t.filters[1].value,applyState:t.filters[2].value,beginTime:t.filters[3].value[0]?t.filters[3].value[0]+" 00:00:00":"",endTime:t.filters[3].value[1]?t.filters[3].value[1]+" 23:59:59":""},e.prev=3,e.next=6,R.a.post(b["g"].invoicing.purchaseApplyMgmt.export,i,{responseType:"blob"});case 6:return n=e.sent,console.log("response => ",n),o=new Blob([n.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(n.headers["content-disposition"])),s=decodeURI(n.headers["content-disposition"].split("filename=")[1]),r=document.createElement("a"),r.download=s.match(/"(\S*)"/)[1],r.style.display="none",r.href=URL.createObjectURL(o),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r),e.abrupt("return");case 22:throw e.prev=22,e.t0=e["catch"](3),new Error(e.t0);case 25:case"end":return e.stop()}}),e,null,[[3,22]])})))()},add:function(){var t=this;this.tabName="addinfo",this.itemId="",this.step1=!0,this.step2=!1,this.openAdd=!0,this.$nextTick((function(){t.$refs.step1Info.getDepotList()}))},rowClick:function(t,e,a){var i=this;this.tabNameInfo="info",this.open=!0,this.$nextTick((function(){i.itemId=t.id})),this.isPend=!1},getList:function(){var t=this,e={shopId:window.top.SHOP_ID||"",pageable:{pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,searchValue:this.filters[4].value},supplierIds:this.filters[0].value,applierId:this.filters[1].value,applyState:this.filters[2].value,beginTime:this.filters[3].value[0]?this.filters[3].value[0]+" 00:00:00":"",endTime:this.filters[3].value[1]?this.filters[3].value[1]+" 23:59:59":""};this.loading=!0,m["a"].post(b["g"].invoicing.purchaseApplyMgmt.shopPurchaseApplyList,e).then((function(e){console.log(e),t.tableData=e.dataList,t.pagination.total=Number(e.total),t.loading=!1})).catch((function(e){t.$message.warning(e.errorMessage),console.log("ERR_REFRESH: ",e)})).finally((function(e){t.loading=!1}))},queryKpi:function(){var t=this,e={shopId:window.top.SHOP_ID||""};m["a"].get("/admin/invoicing/purchase/queryShopPurchaseKpi.jhtml",e).then((function(e){t.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:"今日新增".concat(e.data.dayNewAdd,"条，待审核").concat(e.data.waitAuditing,"条"),duration:3e3})})).catch((function(e){t.$message.warning(e.errorMessage),console.log("ERR_REFRESH: ",e)})).finally((function(e){t.loading=!1}))},queryFilters:function(){var t=this,e={shopId:window.top.SHOP_ID||""};m["a"].get(b["g"].invoicing.purchaseApplyMgmt.queryInfos,e).then((function(e){t.filters[1].options=[{label:"全部",value:""}].concat(e.applierList.map((function(t){return{label:t.name,value:t.id}}))),t.filters[2].options=[{label:"全部",value:""}].concat(e.stateList.map((function(t){return{label:t.name,value:t.id}})))})).catch((function(e){t.$message.warning(e.errorMessage),console.log("ERR_REFRESH: ",e)})).finally((function(t){}))},querySupplier:function(){var t=this,e={shopId:window.top.SHOP_ID||"",cooperationType:"0",state:""};m["a"].get(b["g"].invoicing.supplierMgmt.shopSupplierList,e).then((function(e){t.filters[0].options=[{label:"全部",value:""}].concat(e.dataList.map((function(t){return{label:t.name,value:t.id}})))})).catch((function(e){t.loading=!1,e.errorMessage&&console.log(e.errorMessage)}))},getStatus:function(t){switch(t.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"已驳回";default:return"--"}},handleSelectionChange:function(t){this.selections=t,this.operations.map((function(t){"delete"===t.name&&(t.disabled=!0)})),t.length>0&&this.operations.map((function(t){"delete"===t.name&&(t.disabled=!1)}))},filterDataChange:function(t){this.filters=t,this.pagination.currentPage=1,this.refresh()},handleSizeChange:function(t){this.pagination.pageSize=t,this.refresh()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.refresh()}})},B=F,j=(a("7ae2"),Object(S["a"])(B,i,n,!1,null,null,null));e["default"]=j.exports},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var i=a("1d80"),n=a("5899"),o="["+n+"]",s=RegExp("^"+o+o+"*"),r=RegExp(o+o+"*$"),l=function(t){return function(e){var a=String(i(e));return 1&t&&(a=a.replace(s,"")),2&t&&(a=a.replace(r,"")),a}};t.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(t,e,a){"use strict";var i=a("9678"),n=a.n(i);n.a},"655f":function(t,e,a){},"697f":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:t.title,visible:t.dialogVisible,"append-to-body":t.appendToBody},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close,open:t.open}},[t._t("top"),a("biz-flex-table",{ref:"table",attrs:{showTable:t.showTable,operations:t.operations,filters:t.filters,tags:t.tags,rowKeys:t.rowKeys,pagination:t.pagination,tableData:t.tableData,rowClassName:t.rowClassName,loading:t.loading,memberIds:t.memberIds,checkable:t.checkable,isDepotOutNew:t.isDepotOutNew,checkedTable:t.checkedTable},on:{operate:t.operate,"row-click":t.rowClick,"filter-data-change":t.filterDataChange,"select-all":t.handleSelectAll,select:t.handleSelectionChange,"size-change":t.pageSizeChange,"current-change":t.currentPageChange,"cascader-change":t.cascaderChange,"active-item-change":t.activeItemChange,"sort-change":t.handleSortChange}},[t._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.isClear?a("el-button",{attrs:{size:"small"},on:{click:t.clear}},[t._v("清除")]):t._e(),a("el-button",{attrs:{size:"small"},on:{click:t.close}},[t._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirmed}},[t._v("确定")])],1)],2)},n=[],o=(a("99af"),a("4160"),a("c975"),a("a434"),a("a9e3"),a("159b"),a("04d3")),s={name:"BizDialogSelector",components:{BizFlexTable:o["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(t){return t.id},generateSelectionKeys:function(t,e){if(t.indexOf(e)>=0)this.innerSelectionKeys.push(e[this.keyField]),this.innerSelection.push(e);else{var a=this.innerSelectionKeys.indexOf(e[this.keyField]);this.innerSelectionKeys.splice(a,1),this.innerSelection.splice(a,1)}},open:function(t){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(t){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var t=this;this.tableData.forEach((function(e){t.$refs.table.toggleRowSelection(e,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var t=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(e){t.innerSelectionKeys.indexOf(e[t.keyField])>=0?(t.$refs.table.toggleRowSelection(e,!0),"single"===t.selectionMode&&(t.$refs.table.$refs.table.setCurrentRow(e),t.innerSelection=[e])):t.$refs.table.toggleRowSelection(e,!1)}))},operate:function(t){this.$emit("operate",t)},filterDataChange:function(t){this.$emit("filterDataChange",t)},handleSelectAll:function(t){var e=this;0===t.length?this.tableData.forEach((function(t){var a=e.innerSelectionKeys.indexOf(t[e.keyField]);a>=0&&e.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(t){var a=e.innerSelectionKeys.indexOf(t[e.keyField]);a<0&&e.innerSelectionKeys.push(t[e.keyField])})),this.$emit("selectionChange",t)},handleSelectionChange:function(t,e){this.generateSelectionKeys(t,e),this.$emit("selectionChange",t)},pageSizeChange:function(t){this.$emit("pageSizeChange",t)},currentPageChange:function(t){this.$emit("currentPageChange",t)},cascaderChange:function(t){this.$emit("cascaderChange",t)},activeItemChange:function(t){this.$emit("active-item-change",t)},handleSortChange:function(t){this.$emit("sort-change",t)},rowClick:function(t,e,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[t[this.keyField]],this.innerSelection=[t])}},watch:{visibility:function(t,e){this.dialogVisible=t,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},r=s,l=(a("0943"),a("2877")),c=Object(l["a"])(r,i,n,!1,null,null,null);e["a"]=c.exports},7132:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(e){return e.target!==e.currentTarget?null:t.close(e)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"popup-content",style:t.contentStyle},[t._t("default")],2)])],1)])},n=[],o={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},s=o,r=(a("5b8e"),a("2877")),l=Object(r["a"])(s,i,n,!1,null,null,null),c=l.exports,u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:t.open,contentStyle:t.contentStyle},on:{close:t.close}},[a("el-tabs",{attrs:{type:"border-card",value:t.value},on:{"tab-click":t.tabClick}},[t._t("default")],2)],1)],1)},d=[],p=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var t=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("close")}))},tabClick:function(t){this.$emit("input",t.name)}}}),h=p,f=(a("d4c2"),Object(r["a"])(h,u,d,!1,null,null,null)),g=f.exports;a.d(e,"a",(function(){return g}))},7214:function(t,e,a){},"722d":function(t,e,a){},7339:function(t,e,a){"use strict";var i=a("f604"),n=a.n(i);n.a},"74bf":function(t,e,a){"use strict";var i=a("722d"),n=a.n(i);n.a},"7ae2":function(t,e,a){"use strict";var i=a("655f"),n=a.n(i);n.a},9678:function(t,e,a){},a9e3:function(t,e,a){"use strict";var i=a("83ab"),n=a("da84"),o=a("94ca"),s=a("6eeb"),r=a("5135"),l=a("c6b6"),c=a("7156"),u=a("c04e"),d=a("d039"),p=a("7c73"),h=a("241c").f,f=a("06cf").f,g=a("9bf2").f,m=a("58a8").trim,b="Number",v=n[b],y=v.prototype,w=l(p(y))==b,S=function(t){var e,a,i,n,o,s,r,l,c=u(t,!1);if("string"==typeof c&&c.length>2)if(c=m(c),e=c.charCodeAt(0),43===e||45===e){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+c}for(o=c.slice(2),s=o.length,r=0;r<s;r++)if(l=o.charCodeAt(r),l<48||l>n)return NaN;return parseInt(o,i)}return+c};if(o(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var C,D=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof D&&(w?d((function(){y.valueOf.call(a)})):l(a)!=b)?c(new v(S(e)),a,D):S(e)},_=i?h(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;_.length>I;I++)r(v,C=_[I])&&!r(D,C)&&g(D,C,f(v,C));D.prototype=y,y.constructor=D,s(n,b,D)}},a9f4:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"apply-info"},[a("div",{staticClass:"apply-info-div"},[a("div",{staticClass:"apply-info-content"},[a("div",{staticClass:"apply-top-content"},[a("div",{staticClass:"apply-follow-up",on:{click:function(e){return t.onOrderSchedules(t.orderData.id)}}},[a("span",[t._v("申请单跟踪")]),a("div",{staticClass:"apply-state"},[a("span",[t._v(t._s(t.getOrderState))]),a("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]),a("div",{staticClass:"receiver-info"},[a("span",[t._v(t._s(t.orderData.depot?t.orderData.depot.contactor:""))]),a("span",[t._v(t._s(t.orderData.depot?t.orderData.depot.phone:""))]),a("p",[a("i",{staticClass:"el-icon-location-outline",staticStyle:{"margin-right":"5px"}}),t._v(" "+t._s(t.orderData.depot?t.orderData.depot.address:"")+" ")])])]),a("div",{staticClass:"apply-info-new"},[a("div",{staticClass:"shop-name",on:{click:t.goSupplier}},[a("img",{attrs:{src:t.iconShop}}),a("span",{staticStyle:{fontSize:"14px"}},[t._v(t._s(t.orderData.relatePartnerName))])]),t._l(t.orderData.itemDatas,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"good-info"},[a("div",{staticClass:"goods-img"},[a("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:e.thumbnail&&e.thumbnail.indexOf("/")>=0?e.thumbnail:t.defaultImg},on:{error:function(e){return t.imgError(i)}}})]),a("div",{staticClass:"good-right"},[a("div",{staticClass:"good-name"},[a("span",{staticStyle:{flex:"1"}},[t._v(" "+t._s(e.specValue)+" ")])]),a("div",{staticStyle:{"margin-bottom":"10px"}},[e.product.barCode?a("span",{staticStyle:{"font-size":"14px","margin-right":"10px"}},[t._v(t._s(e.product.barCode))]):t._e()]),a("div",{staticClass:"good-price"},[a("span",[t._v("￥"+t._s(e.price))]),a("span",[t._v("X"+t._s(e.amount))])])])])])}))],2),a("div",{staticClass:"price-info-content"},[a("div",{staticClass:"total-price"},[a("span",[t._v("合计")]),a("span",{staticStyle:{color:"red"}},[t._v("￥"+t._s(t.orderData.totalFee))])])]),a("div",{staticClass:"pay-type"},[a("span",[t._v("单据编号: "+t._s(t.orderData.sn))]),a("span",[t._v("创建时间: "+t._s(t.orderData.createDate))]),a("span",[t._v("申请人: "+t._s(t.orderData.applierName))])])])]),t.isPend?a("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},[t.hasAuthExamine&&("1"===t.orderData.state&&"1"===t.orderData.audit||"2"===t.orderData.state&&"1"===t.orderData.audit)?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.toPass(t.orderData,"1")}}},[t._v("审核")]):t._e(),"0"===t.orderData.state?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.statusChange(t.orderData,"0")}}},[t._v("提交")]):t._e(),"1"===t.orderData.state&&"1"===t.orderData.isApplier?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.statusChange(t.orderData,"3")}}},[t._v("撤回")]):t._e()],1):t._e(),a("el-dialog",{attrs:{visible:t.dialogVisiable,center:"",width:"800px","min-height":"400px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(e){t.dialogVisiable=e}}},[a("apply-follow",{ref:"invoice"})],1),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(e){t.showPassOrder=e}}},[a("div",[a("div",{staticClass:"reson-container"},[a("span",[t._v("审核结果：")]),a("el-radio",{attrs:{label:"1",size:"mini"},model:{value:t.auditState,callback:function(e){t.auditState=e},expression:"auditState"}},[t._v("通过")]),a("el-radio",{attrs:{label:"2",size:"mini"},model:{value:t.auditState,callback:function(e){t.auditState=e},expression:"auditState"}},[t._v("驳回")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"2"===t.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[a("span",[t._v("驳回理由：")]),a("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:t.curSelectCloseReason,callback:function(e){t.curSelectCloseReason=e},expression:"curSelectCloseReason"}},t._l(t.reasonList,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}})],1)]),a("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.showPassOrder=!1}}},[t._v("取消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.statusChange(t.row,t.auditState)}}},[t._v("确定")])],1)])],1)},n=[],o=(a("caad"),a("d3b7"),a("2532"),a("5530")),s=a("f36f"),r=a("2f62"),l=a("1ab1"),c=a("c596"),u=a("e83a"),d=a.n(u),p=a("f606"),h=a.n(p),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-log-info"},[a("div",{staticStyle:{"text-align":"center","font-size":"15px","margin-bottom":"20px"}},[t._v("单据进度跟踪")]),a("el-steps",{attrs:{direction:"vertical",space:"auto"}},[a("el-step",{attrs:{title:"新申请",status:"1"===t.active?"finish":"wait "}},[a("div",{attrs:{slot:"description"},slot:"description"},t._l(t.orderData.schedules,(function(e,i){return"0"===e.state||"1"===e.state?a("div",{key:i,staticClass:"logInfo"},[a("p",{staticStyle:{"margin-right":"20px"}},[t._v(t._s("0"===e.state?"已创建":"已提交"))]),a("p",[t._v(t._s(e.time))])]):t._e()})),0)]),a("el-step",{attrs:{title:"审核",status:"2"===t.active?"finish":"wait "}},[a("div",{attrs:{slot:"description"},slot:"description"},[t._l(t.orderData.schedules,(function(e,i){return"2"===e.state||"3"===e.state?a("div",{key:i},[a("p",{staticStyle:{"margin-right":"20px"}},[t._v(t._s(e.adminName+"已通过"))]),a("p",[t._v("备注："+t._s(e.remarks))]),a("p",[t._v(t._s(e.time))])]):t._e()})),t._l(t.orderData.schedules,(function(e,i){return"4"===e.state?a("div",{key:i},[a("p",{staticStyle:{"margin-right":"20px"}},[t._v(t._s(e.adminName+"审核不通过"))]),a("p",[t._v("理由："+t._s(e.details))]),a("p",[t._v("备注："+t._s(e.remarks))]),a("p",[t._v(t._s(e.time))])]):t._e()}))],2)]),a("el-step",{attrs:{title:"审核通过/驳回",status:"3"===t.active?"finish":"wait "}},[a("div",{attrs:{slot:"description"},slot:"description"},["3"===t.orderData.state?a("div",[a("p",{staticStyle:{"margin-right":"20px"}},[t._v(t._s("审核通过"))])]):t._e(),"4"===t.orderData.state?a("div",[a("p",{staticStyle:{"margin-right":"20px"}},[t._v(t._s("审核驳回"))])]):t._e()])])],1)],1)},g=[],m={name:"NewsMgmt",props:{},data:function(){return{loading:!1,orderData:[],active:"",state:""}},components:{},watch:{},created:function(){},computed:{getOrderLogState:function(t){switch(this.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"审核通过";default:return""}}},methods:{operate:function(t){this[t]()},getList:function(t){var e=this,a={id:t};l["a"].get(c["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,a).then((function(t){e.orderData=t.data})).catch((function(){})).finally((function(){}))}}},b=m,v=(a("2992"),a("2877")),y=Object(v["a"])(b,f,g,!1,null,null,null),w=y.exports,S={name:"apply-info",data:function(){return{orderData:{},iconShop:h.a,defaultImg:d.a,dialogVisiable:!1,showPassOrder:!1,loading:!1,remarks:"",auditState:"1",row:{},curSelectCloseReason:"申报的商品与实际需要采购的商品不符",reasonList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}]}},props:{itemId:{type:String,default:""},isPend:{type:Boolean,default:!1}},watch:{itemId:function(t){this.getOrderInfo()}},components:{BizGrid:s["a"],ApplyFollow:w},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(r["c"])(["getUser"])),Object(r["c"])("Authority",["currentAuth"])),{},{hasAuthExamine:function(){return this.currentAuth.includes("admin:purchaseApplication.examine")},getOrderState:function(){switch(this.orderData.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"已驳回";default:return""}}}),methods:{goSupplier:function(){},showToast:function(t){this.$createToast({time:1e3,txt:t,type:"warn"}).show()},toPass:function(t,e){this.remarks="",this.row=t,this.showPassOrder=!0},onOrderSchedules:function(t){var e=this;this.dialogVisiable=!0,this.$nextTick((function(){e.$refs.invoice.getList(t)}))},getOrderInfo:function(){var t=this,e={id:this.itemId};l["a"].get(c["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,e).then((function(e){t.orderData=e.data})).catch((function(){})).finally((function(){}))},statusChange:function(t,e){var a=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.loading=!0;var i={shopId:window.top.SHOP_ID||"",id:t.id,actionType:e,details:"2"===e?a.curSelectCloseReason:"",remarks:a.remarks};l["a"].post("/admin/invoicing/purchase/shopPurchaseApplyState.jhtml",i).then((function(t){a.$message.success("操作成功！"),a.loading=!1,a.showPassOrder=!1,a.$emit("operationSuccess")})).catch((function(t){a.loading=!1,t.errorMessage&&a.$message.warning(t.errorMessage)})).finally((function(){}))}))}},created:function(){}},C=S,D=(a("7339"),Object(v["a"])(C,i,n,!1,null,null,null));e["a"]=D.exports},af3f:function(t,e,a){"use strict";var i=a("697f");e["a"]=i["a"]},b547:function(t,e,a){},b680:function(t,e,a){"use strict";var i=a("23e7"),n=a("a691"),o=a("408a"),s=a("1148"),r=a("d039"),l=1..toFixed,c=Math.floor,u=function(t,e,a){return 0===e?a:e%2===1?u(t,e-1,a*t):u(t*t,e/2,a)},d=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},p=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r((function(){l.call({})}));i({target:"Number",proto:!0,forced:p},{toFixed:function(t){var e,a,i,r,l=o(this),p=n(t),h=[0,0,0,0,0,0],f="",g="0",m=function(t,e){var a=-1,i=e;while(++a<6)i+=t*h[a],h[a]=i%1e7,i=c(i/1e7)},b=function(t){var e=6,a=0;while(--e>=0)a+=h[e],h[e]=c(a/t),a=a%t*1e7},v=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==h[t]){var a=String(h[t]);e=""===e?a:e+s.call("0",7-a.length)+a}return e};if(p<0||p>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(f="-",l=-l),l>1e-21)if(e=d(l*u(2,69,1))-69,a=e<0?l*u(2,-e,1):l/u(2,e,1),a*=4503599627370496,e=52-e,e>0){m(0,a),i=p;while(i>=7)m(1e7,0),i-=7;m(u(10,i,1),0),i=e-1;while(i>=23)b(1<<23),i-=23;b(1<<i),m(1,1),b(2),g=v()}else m(0,a),m(1<<-e,0),g=v()+s.call("0",p);return p>0?(r=g.length,g=f+(r<=p?"0."+s.call("0",p-r)+g:g.slice(0,r-p)+"."+g.slice(r-p))):g=f+g,g}})},d437:function(t,e,a){},d4c2:function(t,e,a){"use strict";var i=a("e725"),n=a.n(i);n.a},def8:function(t,e,a){"use strict";var i=a("7214"),n=a.n(i);n.a},e725:function(t,e,a){},e83a:function(t,e,a){t.exports=a.p+"static/img/pic_default_none.8bd264ad.png"},ec6b:function(t,e,a){"use strict";var i=a("b547"),n=a.n(i);n.a},f3ac:function(t,e,a){t.exports=a.p+"static/img/pic_default_none_100.6603f4ac.png"},f604:function(t,e,a){},f606:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFGmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMTEtMTRUMTU6MDE6MjIrMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTA4LTAzVDE5OjEzOjI1KzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTA4LTAzVDE5OjEzOjI1KzA4OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmQ0NWIyMzUyLWJhMzItNDM5NS1iZTliLTgxMTVhNjk1ODBhNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpkNDViMjM1Mi1iYTMyLTQzOTUtYmU5Yi04MTE1YTY5NTgwYTUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkNDViMjM1Mi1iYTMyLTQzOTUtYmU5Yi04MTE1YTY5NTgwYTUiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ0NWIyMzUyLWJhMzItNDM5NS1iZTliLTgxMTVhNjk1ODBhNSIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xNFQxNTowMToyMiswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+kgXFvQAAApVJREFUWIXNl09IVFEYxX/vda+roT9C6EYKkqB/kiEYhLRJB6qNbVrYqhbmYMteUIySrnqLFiEOLmoRumnTpo0pBEVQIARG0cLAqNBpUzIW6L1qi3f905s7zzfDG+zAW3x8Z945zH333vM5xITykEAa6ABagEPAXtP+BXwGpoDnwLj0UXHe68QQrgMyQF9cswYDwLD0yVdsQHncrUC4yIj06S/LgPI4AfSYJwnkgJz0eb+tAeVxDphISDiMdukzWdKA8jgKfKiS+DqOSZ+P64UbavZWWbxIY8OA+eCSWvMo9BgtwCyB2WrzNrbofQMNrZVJfX2LHjpdqlsvffLCFBkrpRZoaEUPOrBYpngKxB2FaOtGvxqxMTJAv2NOuGUbQ3SNQt1J9P3jZaqb36ezcOYmum93KUqNS3C82nHkErzIViQOoMcHwRVRlLRLcLbbsarR755u1inzlKqx1NHoEAQXix0h9yK7BoC+5djre6G6rRt2Rf4DLQJoLNn+8wNxexYen4X9p2BVQ+E7orkz6C8VAqHmTlicg8LcZq1+w/khmJ+OMtDoKI8loMbargVxfRb2HIBVBU8uQ/413PgGOPCoLeBdfQkrGkbMx5r5BK6EhS/oBwejdtBytIGtSBF/K8bnLrvAQhzm+nonzF1wgZnYb04eMy5BjNopTLkEGW6nMBF5FAOIa8+gMQ0rars9HYIDM+PohxejSDVC+ijlMYAt+6WAwxcqv4yya1E7YkD6qMjrWHSNQlNXmcohTI+hx67YOvXSJ78RyRJKwHGxkZTDmXCY6qeinPQ380c4Ew5VWbxI4x8DJq22V1G8fWsiLjJgTEwCTQTDRFLIAU3hmQD+19EsZGLnhtOQEdt4vs+0f1LheP4XcCzJ/0nFX0oAAAAASUVORK5CYII="}}]);