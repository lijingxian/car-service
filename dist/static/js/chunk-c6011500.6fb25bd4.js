(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c6011500"],{"3e18":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"key-word-template"},[a("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,loading:e.loading,pagination:e.pagination},on:{operate:e.handleOperate,"size-change":e.handlePageSizeChange,"current-change":e.handleCurrentPageChange,"selection-change":e.handleSelectionChange,"filter-data-change":e.handleFilterDataChange,"row-click":e.handleRowClick}},[a("template",{slot:"operation"},[a("import-file",{ref:"importFile",staticStyle:{"margin-left":"10px"},attrs:{tableData:e.importResult,importLoading:e.importLoading,total:e.total,disabled:e.disabled,count:e.count,percentage:e.percentage,stepkey:e.stepkey,action:"/admin/keyword/importKeyword.jhtml",name:"uFile"},on:{clearTimeOut:e.clearTimeOut,restProcess:e.restProcess,"handle-import":e.handleImport}},[a("el-table-column",{attrs:{label:"编号",prop:"line",width:"50"}}),a("el-table-column",{attrs:{label:"消息",prop:"result"}})],1)],1),a("el-table-column",{attrs:{label:"关键词包",prop:"name"}}),a("el-table-column",{attrs:{label:"关键词举例"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.keywords,(function(a,n){return[e._v(" "+e._s(a.name)+" "),n<t.row.keywords.length-1?[e._v(e._s(e.separator))]:e._e()]}))]}}])}),a("el-table-column",{attrs:{label:"关键词个数"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.keywords?[e._v(e._s(e.getKeyWordNumber(t.row.keywords)))]:void 0}}],null,!0)}),a("el-table-column",{attrs:{prop:"tag",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.handleDeleteClick(a,t.row)}}},[e._v("删除")])]}}])})],2),a("div",{attrs:{slot:"float"},slot:"float"},[a("right-popup",{attrs:{open:e.open,itemId:e.itemId},on:{close:function(t){e.open=!1},operationSuccess:e.handleOperationSuccess}})],1)],1)},i=[],o=(a("4160"),a("a9e3"),a("d3b7"),a("159b"),a("5530")),r=a("04d3"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("base-info",{attrs:{itemId:e.itemId},on:{operationSuccess:e.operationSuccess}})],1)],1)},l=[],c=a("7132"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"key-word-template__base-info"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"关键词包",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{staticClass:"isRequired",attrs:{label:"关键词"}}),a("el-table",{staticStyle:{width:"95%","margin-left":"30px"},attrs:{data:e.formModel.keywords,size:"small"}},[a("el-table-column",{attrs:{label:"关键词",prop:"name"}}),a("el-table-column",{attrs:{label:"推荐出价",prop:"price"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticStyle:{display:"flex"}},[a("span",[e._v("￥")]),a("div",{staticClass:"biz-customcol",staticStyle:{"max-width":"70px"}},[a("el-input",{attrs:{size:"mini"},model:{value:t.row.price,callback:function(a){e.$set(t.row,"price",a)},expression:"scope.row.price"}})],1)])}}])}),a("el-table-column",{attrs:{label:"命中率",prop:"hitRate"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"biz-customcol",staticStyle:{"max-width":"70px"}},[a("el-input",{attrs:{size:"mini"},model:{value:t.row.hitRate,callback:function(a){e.$set(t.row,"hitRate",a)},expression:"scope.row.hitRate"}})],1),a("span",[e._v("%")])])}}])}),a("el-table-column",{attrs:{prop:"title",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"biz-customcol"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.rowDeleteClickHandler(t)}}},[e._v("删除")])],1)]}}])})],1),a("div",{staticClass:"add-tag"},[a("el-input",{attrs:{maxlength:18,placeholder:"请输入自定义关键词"},model:{value:e.newTagName,callback:function(t){e.newTagName=t},expression:"newTagName"}}),a("el-button",{attrs:{type:"primary"},on:{click:e.addNewTag}},[e._v("添加")])],1)],1)],1)},u=[],f=(a("99af"),a("a434"),a("b0c0"),a("6062"),a("3ca3"),a("498a"),a("ddb0"),a("2909")),p=a("b85c"),m=a("f36f"),h=a("8330"),g=a("1ab1"),b=a("2f62"),w={newTagName:"",tableData:[],operations:[{label:"保存",name:"save",type:"primary"}]},y=function(){return{name:"",store:"",hierarchy:"",id:"",keywords:[]}},v={data:{loading:!1,formModel:y()},events:{handleOperate:function(e){this[e]()}},methods:{initModel:function(e){e?this.formModel=Object.assign(this.getDefaultModel(),e):this.resetModel(),this.$refs.form.resetFields()},query:function(){var e=this;this.loading=!0,g["a"].get("/admin/keyword/keyword.jhtml",{store:this.getUser().shop.id||window.top.SHOP_ID,id:this.itemId.id}).then((function(t){e.initModel(t.data)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return y()},getSaveParams:function(){var e="";return e="platform"===this.getUser().roleLevel?"0":"1",{id:this.formModel.id,name:this.formModel.name,hierarchy:e,keywords:this.formModel.keywords,store:this.getUser().shop.id||window.top.SHOP_ID}},save:function(){var e=this;this.$refs.form.validate((function(t,a){if(!t)return!1;var n=!0,i=!0,o=!0,r=!0,s=!0;e.loading=!0;var l=String(e.formModel.name).trim();if(l?i=!0:(e.$message.warning("请输入关键词包!"),e.loading=!1,i=!1),!(e.formModel.keywords.length>0))return e.$message.warning("请添加关键词!"),e.loading=!1,!1;if(e.formModel.keywords.forEach((function(t){t.price?/^[0-9]+\.?[0-9]*$/.test(t.price)?/^\d+\.?\d{0,2}$/.test(t.price)||(e.$message.warning("出价小数点后最多两位小数"),e.loading=!1,o=!1):(e.$message.warning("推荐出价格式错误!"),e.loading=!1,n=!1):(e.$message.warning("请输入出价"),e.loading=!1,r=!1),t.hitRate?/^[0-9]+\.?[0-9]*$/.test(t.hitRate)?Number(t.hitRate)>=100||Number(t.hitRate)<=0?(e.$message.warning("命中率范围为0.01-99.99!"),e.loading=!1,s=!1):/^\d+\.?\d{0,2}$/.test(t.hitRate)||(e.$message.warning("命中率小数点后最多两位小数"),e.loading=!1,s=!1):(e.$message.warning("命中率格式错误!"),e.loading=!1,s=!1):(e.$message.warning("请输入命中率"),e.loading=!1,s=!1)})),!(n&&i&&o&&r&&s))return!1;var c=function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")},d=function(t){e.loading=!1,console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)},u=function(t){e.loading=!1};e.formModel.id?g["a"].put("/admin/keyword/keyword.jhtml",e.getSaveParams()).then(c).catch(d).finally(u):g["a"].post("/admin/keyword/keyword.jhtml",e.getSaveParams()).then(c).catch(d).finally(u)}))},rowDeleteClickHandler:function(e){this.formModel.keywords.splice(e.$index,1)},addNewTag:function(){var e=String(this.newTagName).trim();if(!e)return this.$message.warning("请输入自定义关键词"),!1;var t,a=Object(p["a"])(this.formModel.keywords);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.name===e)return this.$message.warning("该关键词已存在，请重新添加"),!1}}catch(i){a.e(i)}finally{a.f()}this.formModel.keywords=Object(f["a"])(new Set(this.formModel.keywords.concat({id:"",category:"",name:e,price:"1.00",hitRate:"60"}))),this.newTagName=""}}},k={name:"KeyWordBaseInfo",components:{BizSaveButton:h["a"],BizGrid:m["a"]},data:function(){return Object(o["a"])(Object(o["a"])(Object(o["a"])({},w),v.data),{},{rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(b["c"])(["getUser"])),v.methods),v.events),watch:{itemId:function(e,t){e.id?this.query():this.initModel()}},created:function(){this.itemId.id&&this.query()}},S=k,I=(a("bf8f"),a("2877")),O=Object(I["a"])(S,d,u,!1,null,null,null),$=O.exports,x={name:"KeyWordPopup",components:{BizPopupTabs:c["a"],BaseInfo:$},props:{open:{type:Boolean},itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{tabSelection:"0",alertId:{id:""},showFailure:!0,showSign:!0}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)}}},M=x,_=Object(I["a"])(M,s,l,!1,null,null,null),N=_.exports,C=a("ccf0"),j={itemId:{id:""},selections:[],separator:",",open:!1},T={loading:!1,tableData:[],importResult:[],importLoading:!1,disabled:!1,total:0,count:0,t:"",percentage:0,stepkey:"",operations:[{label:"添加",name:"add",type:"primary"},{label:"删除",name:"delete",type:"",disabled:!0},{label:"刷新",name:"refresh",type:""},{label:"模板下载",name:"downloadTemplate",type:""}],filters:[{type:"input",label:"",placeholder:"请输入关键词包名称",name:"searchValue",value:""}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}},P={getQueryParams:function(){return{store:this.getUser().shop.id||window.top.SHOP_ID,pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,searchValue:this.filters[0].value}},downloadTemplate:function(){window.open("/upload/mode/V服爱车_关键词导入版.xlsx")},clearTimeOut:function(){window.clearTimeout(this.t)},restProcess:function(){this.total=0,this.count=0,this.stepkey="",this.percentage=0},handleImport:function(){var e=this,t="/admin/keyword/importProgress.jhtml";g["a"].get(t,{}).then((function(t){t.data.total||(e.total=0,e.count=0,e.stepkey="",e.percentage=0),t.data.total&&(e.total=Number(t.data.total||0),e.count=Number(t.data.count||0),e.stepkey=t.data.remark,e.percentage=Number(t.data.rate),e.$refs.importFile.title=t.data.title),t.data&&t.data.rate&&"100"===t.data.rate?(e.clearTimeOut(),e.$refs.importFile.showCurrentInfo=!1,e.$refs.importFile.title="导入完成",e.refresh(),t.data&&t.data.results&&t.data.results.length>0&&(e.importResult=t.data.results,e.$refs.importFile.uploadingVisible=!1,e.$refs.importFile.importingVisible=!0),e.disabled=!1):t.data&&t.data.rate&&"100"!==t.data.rate&&(e.t&&e.clearTimeOut(),e.t=setTimeout(e.handleImport,2e3),e.$refs.importFile.uploadingVisible=!0,e.$refs.importFile.showCurrentInfo=!0,e.disabled=!0)})).catch((function(e){console.log(e),console.log("code错误")}))},getKeyWordNumber:function(e){return e.length},query:function(){var e=this;this.loading=!0,g["a"].get("/admin/keyword/keywords.jhtml",this.getQueryParams()).then((function(t){e.tableData=t.dataList,e.pagination.total=Number(t.total)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},refresh:function(){this.query()},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,g["a"].delete("/admin/keyword/keyword.jhtml",{ids:e}).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")},add:function(){this.open=!0,this.itemId={id:""}}},z={handleOperationSuccess:function(){this.open=!1,this.query()},handleOperate:function(e){this[e]()},handlePageSizeChange:function(e){this.pagination.pageSize=e,this.pagination.currentPage=1,this.query()},handleCurrentPageChange:function(e){this.pagination.currentPage=e,this.query()},handleSelectionChange:function(e){this.selections=e,this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1)},handleFilterDataChange:function(){this.query()},handleRowClick:function(e,t,a){this.itemId={id:String(e.id)},this.open=!0},handleDeleteClick:function(e,t){e.stopPropagation(),this.deleteItem([t.id])}},R={name:"KeyWordTemplate",components:{BizFlexTable:r["c"],RightPopup:N,ImportFile:C["b"]},props:{},data:function(){return Object(o["a"])(Object(o["a"])({},j),T)},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(b["c"])(["getUser"])),P),z),created:function(){this.query()}},F=R,E=Object(I["a"])(F,n,i,!1,null,null,null);t["default"]=E.exports},"498a":function(e,t,a){"use strict";var n=a("23e7"),i=a("58a8").trim,o=a("c8d2");n({target:"String",proto:!0,forced:o("trim")},{trim:function(){return i(this)}})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var n=a("1d80"),i=a("5899"),o="["+i+"]",r=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),l=function(e){return function(t){var a=String(n(t));return 1&e&&(a=a.replace(r,"")),2&e&&(a=a.replace(s,"")),a}};e.exports={start:l(1),end:l(2),trim:l(3)}},"7e65":function(e,t,a){},a9e3:function(e,t,a){"use strict";var n=a("83ab"),i=a("da84"),o=a("94ca"),r=a("6eeb"),s=a("5135"),l=a("c6b6"),c=a("7156"),d=a("c04e"),u=a("d039"),f=a("7c73"),p=a("241c").f,m=a("06cf").f,h=a("9bf2").f,g=a("58a8").trim,b="Number",w=i[b],y=w.prototype,v=l(f(y))==b,k=function(e){var t,a,n,i,o,r,s,l,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(o=c.slice(2),r=o.length,s=0;s<r;s++)if(l=o.charCodeAt(s),l<48||l>i)return NaN;return parseInt(o,n)}return+c};if(o(b,!w(" 0o1")||!w("0b1")||w("+0x1"))){for(var S,I=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof I&&(v?u((function(){y.valueOf.call(a)})):l(a)!=b)?c(new w(k(t)),a,I):k(t)},O=n?p(w):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),$=0;O.length>$;$++)s(w,S=O[$])&&!s(I,S)&&h(I,S,m(w,S));I.prototype=y,y.constructor=I,r(i,b,I)}},baa5:function(e,t,a){var n=a("23e7"),i=a("e58c");n({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},bf8f:function(e,t,a){"use strict";var n=a("7e65"),i=a.n(n);i.a},c8d2:function(e,t,a){var n=a("d039"),i=a("5899"),o="​᠎";e.exports=function(e){return n((function(){return!!i[e]()||o[e]()!=o||i[e].name!==e}))}},e58c:function(e,t,a){"use strict";var n=a("fc6a"),i=a("a691"),o=a("50c4"),r=a("a640"),s=a("ae40"),l=Math.min,c=[].lastIndexOf,d=!!c&&1/[1].lastIndexOf(1,-0)<0,u=r("lastIndexOf"),f=s("indexOf",{ACCESSORS:!0,1:0}),p=d||!u||!f;e.exports=p?function(e){if(d)return c.apply(this,arguments)||0;var t=n(this),a=o(t.length),r=a-1;for(arguments.length>1&&(r=l(r,i(arguments[1]))),r<0&&(r=a+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:c}}]);