(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65d2a3fe"],{"0943":function(e,t,n){"use strict";var i=n("1fac"),a=n.n(i);a.a},"1fac":function(e,t,n){},3159:function(e,t,n){},"38d5":function(e,t,n){"use strict";var i=n("865a"),a=n.n(i);a.a},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var i=n("1d80"),a=n("5899"),o="["+a+"]",r=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),l=function(e){return function(t){var n=String(i(t));return 1&e&&(n=n.replace(r,"")),2&e&&(n=n.replace(s,"")),n}};e.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(e,t,n){"use strict";var i=n("9678"),a=n.n(i);a.a},"697f":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),n("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?n("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),n("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},a=[],o=(n("99af"),n("4160"),n("c975"),n("a434"),n("a9e3"),n("159b"),n("04d3")),r={name:"BizDialogSelector",components:{BizFlexTable:o["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var n=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(n,1),this.innerSelection.splice(n,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var n=t.innerSelectionKeys.indexOf(e[t.keyField]);n>=0&&t.innerSelectionKeys.splice(n,1)})):this.tableData.forEach((function(e){var n=t.innerSelectionKeys.indexOf(e[t.keyField]);n<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,n){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},s=r,l=(n("0943"),n("2877")),c=Object(l["a"])(s,i,a,!1,null,null,null);t["a"]=c.exports},7132:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"biz-fade-t"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[n("transition",{attrs:{name:"biz-fade-t-right"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},a=[],o={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},r=o,s=(n("5b8e"),n("2877")),l=Object(s["a"])(r,i,a,!1,null,null,null),c=l.exports,u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"biz-popup-tabs"},[n("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[n("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},f=[],d=(n("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),p=d,h=(n("d4c2"),Object(s["a"])(p,u,f,!1,null,null,null)),g=h.exports;n.d(t,"a",(function(){return g}))},"865a":function(e,t,n){},9678:function(e,t,n){},a9e3:function(e,t,n){"use strict";var i=n("83ab"),a=n("da84"),o=n("94ca"),r=n("6eeb"),s=n("5135"),l=n("c6b6"),c=n("7156"),u=n("c04e"),f=n("d039"),d=n("7c73"),p=n("241c").f,h=n("06cf").f,g=n("9bf2").f,m=n("58a8").trim,b="Number",y=a[b],v=y.prototype,S=l(d(v))==b,w=function(e){var t,n,i,a,o,r,s,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=m(c),t=c.charCodeAt(0),43===t||45===t){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+c}for(o=c.slice(2),r=o.length,s=0;s<r;s++)if(l=o.charCodeAt(s),l<48||l>a)return NaN;return parseInt(o,i)}return+c};if(o(b,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var C,k=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof k&&(S?f((function(){v.valueOf.call(n)})):l(n)!=b)?c(new y(w(t)),n,k):w(t)},M=i?p(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;M.length>N;N++)s(y,C=M[N])&&!s(k,C)&&g(k,C,h(y,C));k.prototype=v,v.constructor=k,r(a,b,k)}},af3f:function(e,t,n){"use strict";var i=n("697f");t["a"]=i["a"]},bffc6:function(e,t,n){"use strict";var i=n("3159"),a=n.n(i);a.a},d4c2:function(e,t,n){"use strict";var i=n("e725"),a=n.n(i);a.a},d88e:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("biz-grid",{staticClass:"map-mgmt"},[n("div",{attrs:{slot:"top"},slot:"top"},[n("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}})],1),n("div",{staticStyle:{position:"relative",height:"80%"}},[n("img",{staticClass:"map-img",attrs:{src:e.path},on:{click:e.ptsetting}}),""===e.path?n("div",{style:e.styleObject}):e._e()]),n("div",{attrs:{slot:"float"},slot:"float"},[n("biz-popup-tabs",{attrs:{open:e.open},on:{close:function(t){e.open=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[n("el-tab-pane",{attrs:{label:"点位设置",name:"info"}},[n("PtSetting",{attrs:{itemId:e.mapId},on:{created:e.refresh}})],1)],1)],1)])},a=[],o=(n("a9e3"),n("d3b7"),n("7132")),r=n("f36f"),s=n("04d3"),l=n("1ab1"),c=n("c596"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"pt-setting"},[n("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}}),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"small"},on:{"selection-change":e.handleSelectionChange,"row-click":e.rowClick}},[n("el-table-column",{attrs:{label:"点位",prop:"name"}}),n("el-table-column",{attrs:{label:"坐标点",prop:"points"},scopedSlots:e._u([{key:"default",fn:function(t){return n("div",{},[n("div",[e._v(e._s(t.row.position?t.row.position.split(":")[0].substring(1):""))])])}}])}),n("el-table-column",{attrs:{label:"描述",prop:"refName"},scopedSlots:e._u([{key:"default",fn:function(t){return n("div",{},[n("div",{staticClass:"biz-customcol"},[e._v(e._s("1"===t.row.mark?"商品点位":"2"===t.row.mark?"接待点位":""))]),n("div",{staticClass:"biz-customcol"},[e._v(e._s(t.row.refName))])])}}])})],1),n("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"},{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[n("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules}},[n("el-form-item",{attrs:{label:"点位",prop:"name"}},[n("el-input",{attrs:{disabled:""},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),n("el-form-item",{attrs:{label:"位置",prop:"location"}},[n("el-input",{attrs:{disabled:""},model:{value:e.location,callback:function(t){e.location=t},expression:"location"}})],1),n("el-form-item",{attrs:{label:"类型",prop:"location"}},[n("el-select",{attrs:{placeholder:"请选择类型"},on:{change:e.markChange},model:{value:e.formModel.mark,callback:function(t){e.$set(e.formModel,"mark",t)},expression:"formModel.mark"}},[n("el-option",{attrs:{label:"无",value:"0"}}),n("el-option",{attrs:{label:"商品点位",value:"1"}}),n("el-option",{attrs:{label:"接待点位",value:"2"}})],1)],1),"1"===e.formModel.mark?n("el-form-item",{attrs:{label:"关联商品",prop:"refName"}},[n("el-input",{on:{focus:e.addProduct},model:{value:e.formModel.refName,callback:function(t){e.$set(e.formModel,"refName",t)},expression:"formModel.refName"}})],1):e._e()],1),n("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.formOperations},on:{operate:e.handleOperate}})],1),n("biz-dialog-selector",{attrs:{loading:e.dialogLoading,visibility:e.showDialog,tableData:e.productList,pagination:e.pagination,filters:e.productFilters,selectionMode:"single",selectionKeys:e.selectedItemKeys},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.handleSizeChange,currentPageChange:e.handleCurrentChange,confirmed:e.confirm,filterDataChange:e.filterDataChange}},[n("el-table-column",{attrs:{property:"sn",label:"编号"}}),n("el-table-column",{attrs:{property:"name",label:"名称"}}),n("el-table-column",{attrs:{property:"price",label:"价格"}})],1)],1)},f=[],d=(n("4160"),n("b0c0"),n("ac1f"),n("1276"),n("159b"),n("8330")),p=n("af3f"),h={name:"MemberBaseInfo",props:{itemId:{type:String,default:function(){return""}}},components:{BizHeader:s["d"],BizGrid:r["a"],BizSaveButton:d["a"],BizDialogSelector:p["a"]},data:function(){return{rules:{},loading:!1,formLoading:!1,showForm:!1,showDialog:!1,dialogLoading:!1,totalBean:"",location:"",formModel:{id:"",name:"",refId:"",mapId:"",type:"",position:"",mark:""},operations:[],formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"save",type:"primary"}],selections:[],tableData:[],productList:[],selectedItemKeys:[],points:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},productFilters:[{type:"input",placeholder:"请输入商品名",name:"searchbar",value:""}]}},created:function(){},mounted:function(){},watch:{itemId:function(e,t){e&&this.query()}},methods:{showNotify:function(e,t){this.$notify({showClose:!0,message:e,type:t})},query:function(){var e=this;this.loading=!0,this.showForm=!1;var t={mapId:this.itemId,type:"0"};l["a"].get(c["g"].customerService.smartReception.queryRobotMapSetting,t).then((function(t){e.tableData=t.data,e.pagination.total=Number(t.total)})).catch((function(t){e.loading=!1,t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},handleOperate:function(e){this[e]()},handleSelectionChange:function(e){this.selections=e},save:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.formModel.id?e.update():e.create())}))},add:function(){this.showForm=!0},markChange:function(e){"1"!==e&&(this.formModel.refId="",this.formModel.refName="")},rowClick:function(e){this.formModel.id=e.id,this.formModel.mapId=this.itemId,this.formModel.name=e.name,this.formModel.refId=e.refId,this.formModel.refName=e.refName,this.formModel.type=e.type,this.formModel.mark=e.mark,this.formModel.position=e.position,this.location=e.position?e.position.split(":")[0].substring(1):"",this.showForm=!0},update:function(){var e=this;this.loading=!0,l["a"].put(c["g"].customerService.smartReception.robotMapSetting,this.formModel).then((function(t){e.$message.success("更新成功"),e.query()})).catch((function(t){e.loading=!1,t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},create:function(){var e=this;this.loading=!0,l["a"].post(c["g"].customerService.smartReception.robotMapSetting,this.formModel).then((function(t){e.$message.success("保存成功"),e.query()})).catch((function(t){e.loading=!1,t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,l["a"].delete(c["g"].customerService.smartReception.robotMapSetting,{ids:e}).then((function(e){t.tableData=e.data,t.loading=!0})).catch((function(e){t.loading=!1,e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))}))},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")},cancelForm:function(){this.showForm=!1},addProduct:function(){this.queryProductList(),this.showDialog=!0},confirm:function(e,t){this.formModel.refId=t[0].id,this.formModel.refName=t[0].fullName},filterDataChange:function(e){this.queryProductList()},handleSizeChange:function(e){this.pagination.pageSize=e,this.queryProductList()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.queryProductList()},queryProductList:function(){var e=this,t={searchValue:this.productFilters[0].value,type:"0",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};this.dialogLoading=!0,l["a"].get(c["g"].contentMgmt.publicity.editArticle.queryProductList,t).then((function(t){e.dialogLoading=!1,e.productList=t.content,e.pagination.total=Number(t.total)})).catch((function(t){e.dialogLoading=!1,e.$message.warning(t.errorMessage||"操作错误")}))},showStorePicker:function(e){this.showDialog=!0}}},g=h,m=(n("bffc6"),n("2877")),b=Object(m["a"])(g,u,f,!1,null,null,null),y=b.exports,v=n("f260"),S=n.n(v),w={name:"MapMgmt",data:function(){return{tabName:"info",itemId:"",mapId:"",defaultTab:"0",loading:!1,open:!1,selections:[],tableData:[],path:"",pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9},operations:[{label:"点位设置",name:"ptsetting",type:"primary"}],filters:[]}},components:{BizPopupTabs:o["a"],BizGrid:r["a"],PtSetting:y,BizHeader:s["d"]},computed:{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+S.a+") 50% 50% / 300px no-repeat"}}},created:function(){this.getList()},mounted:function(){},watch:{$route:function(e,t){this.getList()}},methods:{handleOperate:function(e){this[e]()},refresh:function(){this.getList()},operationSuccess:function(){this.getList()},ptsetting:function(){this.open=!0},getList:function(){var e=this;this.loading=!0,l["a"].get(c["f"].smartReception.robotMapList,{shopId:window.top.SHOP_ID||""}).then((function(t){e.tableData=t.data,e.pagination.total=Number(t.total),e.mapId=t.data.length>0?t.data[0].id:"",e.path=t.data.length>0?t.data[0].path:""})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()}}},C=w,k=(n("38d5"),Object(m["a"])(C,i,a,!1,null,null,null));t["default"]=k.exports},e725:function(e,t,n){}}]);