(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b361d55"],{"007d5":function(e,t,a){"use strict";var i=a("379e"),o=a.n(i);o.a},"0943":function(e,t,a){"use strict";var i=a("1fac"),o=a.n(i);o.a},1148:function(e,t,a){"use strict";var i=a("a691"),o=a("1d80");e.exports="".repeat||function(e){var t=String(o(this)),a="",n=i(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(a+=t);return a}},"11e9":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getCommodityList:function(e,t,a){n.a.get(r["g"].commodity.getCommodityList,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){n.a.delete(r["g"].commodity.delete,{data:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},query:function(e,t,a){n.a.get(r["g"].commodity.query,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},soldoutAndPutaway:function(e,t,a){n.a.post(r["g"].commodity.soldoutAndPutaway,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},cloneProduct:function(e,t,a){n.a.post(r["g"].commodity.cloneProduct,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryPlatformCategoryTree:function(e,t,a){n.a.get(r["g"].commodity.queryPlatformCategoryTree,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryPlatformImportInfo:function(e,t,a){n.a.get(r["g"].commodity.queryPlatformImportInfo,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},importPlatformProduct:function(e,t,a){n.a.post(r["g"].commodity.importPlatformProduct,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},audit:function(e,t,a){n.a.post(r["g"].commodity.audit,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},auditTarget:function(e,t,a){n.a.post(r["g"].commodity.auditTarget,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},recallProduct:function(e,t,a){n.a.get(r["g"].commodity.recallProduct,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryFilters:function(e,t,a){n.a.get(r["g"].commodity.queryFilters,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},1551:function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getAttributeGroups:function(e,t,a){n.a.get(r["g"].commodity.getAttributeGroups,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateAttributeGroups:function(e,t,a){n.a.put(r["g"].commodity.updateAttributeGroups,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},"1c8c":function(e,t,a){},"1fac":function(e,t,a){},2299:function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getImageGroups:function(e,t,a){n.a.get(r["g"].commodity.getImageGroups,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateImageGroups:function(e,t,a){n.a.put(r["g"].commodity.updateImageGroups,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductVrMediaBath:function(e,t,a){n.a.put(r["g"].commodity.updateProductVrMediaBath,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},getImageGroups_pm:function(e,t,a){n.a.get(r["g"].commodity.getImageGroups_pm,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateImageGroups_pm:function(e,t,a){n.a.put(r["g"].commodity.updateImageGroups_pm,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductVrMediaBath_pm:function(e,t,a){n.a.put(r["g"].commodity.updateProductVrMediaBath_pm,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},2497:function(e,t,a){"use strict";var i=a("4360"),o=a("a18c");t["a"]=function(e,t){return function(a){var n=a.data;"100"===n.resultCode?e(n):"709"===n.resultCode?(i["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",i["a"].getters.currentUser),o["a"].push("/login")):t(n)}}},"2acf":function(e,t,a){"use strict";var i=a("ea80"),o=a.n(i);o.a},3367:function(e,t,a){"use strict";var i=a("a6a3"),o=a.n(i);o.a},"379e":function(e,t,a){},"392e":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={queryProductBasicInfo:function(e,t,a){n.a.get(r["g"].commodity.queryProductBasicInfo,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductBasicInfo:function(e,t,a){n.a.put(r["g"].commodity.updateProductBasicInfo,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},creatProductBasicInfo:function(e,t,a){n.a.post(r["g"].commodity.creatProductBasicInfo,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},creatBenefitsBasicInfo:function(e,t,a){n.a.post("/admin/shopProduct/benefitsProduct/basicInfo.jhtml",e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductDetail:function(e,t,a){n.a.get(r["g"].commodity.queryProductDetail,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductDetail:function(e,t,a){n.a.put(r["g"].commodity.queryProductDetail,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductDetail_pm:function(e,t,a){n.a.get(r["g"].commodity.queryProductDetail_pm,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateProductDetail_pm:function(e,t,a){n.a.put(r["g"].commodity.updateProductDetail_pm,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},"408a":function(e,t,a){var i=a("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=i(e))throw TypeError("Incorrect invocation");return+e}},"443b":function(e,t,a){"use strict";a("4de4");var i=a("c596"),o=a("1ab1"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":"",visible:e.visible,title:"自定义列","custom-class":"biz-columns",width:"500px"},on:{close:e.onClose}},[a("div",{staticClass:"columns-wrap"},[a("biz-flex-table",{ref:"table",attrs:{checkable:!1,tableData:e.tableData},on:{"selection-change":e.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.getSelectable}}),a("el-table-column",{attrs:{label:"信息",prop:"name"}}),a("el-table-column",{attrs:{prop:"tag",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.$index;return[a("el-button",{attrs:{icon:"el-icon-sort-up",type:"text",disabled:0===i},on:{click:function(t){return e.onUp(i)}}}),a("el-button",{attrs:{icon:"el-icon-sort-down",type:"text",disabled:i===e.tableData.length-1},on:{click:function(t){return e.onBottom(i)}}})]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)])},r=[],s=(a("7db0"),a("a434"),a("b85c")),c=a("04d3"),l={name:"biz-columns",components:{BizFlexTable:c["c"]},props:{visible:Boolean,tableId:String},data:function(){return{id:"",tableName:"",selections:[],tableData:[]}},computed:{},watch:{visible:function(e){e?this.makeRowDisplayable():this.saveSelection()},tableId:function(){this.getTableColumns()}},mounted:function(){this.getTableColumns()},methods:{getTableColumns:function(){var e=this;o["a"].get(i["g"].user.columns,{tableId:this.tableId}).then((function(t){e.tableData=t.data.columnDatas,e.id=t.data.id,e.tableName=t.data.tableName}))},getSelectable:function(e){return e.isEditable},selectionChangeHandler:function(e){this.selections=e},saveSelection:function(){var e,t=this,a=Object(s["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var i=e.value;i.displayable=!1}}catch(c){a.e(c)}finally{a.f()}var o,n=Object(s["a"])(this.selections);try{var r=function(){var e=o.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(n.s();!(o=n.n()).done;)r()}catch(c){n.e(c)}finally{n.f()}},onUp:function(e){this.tableData[e]=this.tableData.splice(e-1,1,this.tableData[e])[0]},onBottom:function(e){this.tableData[e]=this.tableData.splice(e+1,1,this.tableData[e])[0]},onClose:function(){this.$emit("update:visible",!1)},update:function(){var e,t=this,a=Object(s["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var n=e.value;n.displayable=!1}}catch(d){a.e(d)}finally{a.f()}var r,c=Object(s["a"])(this.selections);try{var l=function(){var e=r.value;t.tableData.find((function(t){return t.id===e.id})).displayable=!0};for(c.s();!(r=c.n()).done;)l()}catch(d){c.e(d)}finally{c.f()}var u={columnDatas:this.tableData,id:this.id,tableId:this.tableId,tableName:this.tableName};console.log(u),o["a"].put(i["g"].user.columns,u).then((function(e){t.$emit("update"),t.$emit("update:visible",!1)}))},makeRowDisplayable:function(){var e=this;setTimeout((function(){var t,a=Object(s["a"])(e.tableData);try{for(a.s();!(t=a.n()).done;){var i=t.value;e.$refs.table.$refs.table.toggleRowSelection(i,i.displayable)}}catch(o){a.e(o)}finally{a.f()}}),20)}}},u=l,d=(a("ec6b"),a("2877")),p=Object(d["a"])(u,n,r,!1,null,null,null),f=p.exports,h=f;t["a"]={components:{BizColumnOperation:c["a"],BizColumns:h},data:function(){return{columnsSettingVisible:!1,columns:[]}},created:function(){this.getTableId(),this.getColumns()},methods:{onCustomColumns:function(){this.columnsSettingVisible=!0},getColumns:function(){var e=this;console.log(12),o["a"].get(i["A"].columns,{tableId:this.tableId}).then((function(t){e.columns=[],setTimeout((function(){e.columns=t.data.columnDatas.filter((function(e){return e.displayable})),e.$refs.table&&setTimeout((function(){e.$refs.table.doLayout()}),50)}),20)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getTableId:function(){}}}},"44e0":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getParameterGroups:function(e,t,a){n.a.get(r["g"].commodity.getParameterGroups,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateParameterGroups:function(e,t,a){n.a.put(r["g"].commodity.updateParameterGroups,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},"4b5f":function(e,t,a){"use strict";var i=a("2497"),o=a("bc3a"),n=a.n(o),r=a("c596");t["a"]={getSpecificationGroups:function(e,t,a){console.log("[---- dachao ----] [API-商品规格-get] getSpecificationGroups() params=",e),n.a.get(r["g"].commodity.getSpecificationGroups,{params:e}).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))},updateSpecificationGroups:function(e,t,a){console.log("[---- dachao ----] [API-商品规格-put] updateSpecificationGroups() params=",e),n.a.put(r["g"].commodity.updateSpecificationGroups,e).then(Object(i["a"])(t,a)).catch((function(e){console.error(e)}))}}},5682:function(e,t,a){"use strict";var i=a("f588"),o=a.n(i);o.a},"5b8e":function(e,t,a){"use strict";var i=a("9678"),o=a.n(i);o.a},"697f":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),a("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?a("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},o=[],n=(a("99af"),a("4160"),a("c975"),a("a434"),a("a9e3"),a("159b"),a("04d3")),r={name:"BizDialogSelector",components:{BizFlexTable:n["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var a=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(a,1),this.innerSelection.splice(a,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a>=0&&t.innerSelectionKeys.splice(a,1)})):this.tableData.forEach((function(e){var a=t.innerSelectionKeys.indexOf(e[t.keyField]);a<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,a){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},s=r,c=(a("0943"),a("2877")),l=Object(c["a"])(s,i,o,!1,null,null,null);t["a"]=l.exports},"6da8":function(e,t,a){},"6e29":function(e,t,a){"use strict";var i=a("8396"),o=a.n(i);o.a},7132:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},o=[],n={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},r=n,s=(a("5b8e"),a("2877")),c=Object(s["a"])(r,i,o,!1,null,null,null),l=c.exports,u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[a("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},d=[],p=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:l},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),f=p,h=(a("d4c2"),Object(s["a"])(f,u,d,!1,null,null,null)),m=h.exports;a.d(t,"a",(function(){return m}))},"74f0":function(e,t,a){},7668:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"promotion-participation-way"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"Product"===e.participationWay||"3"===e.participationWay,expression:"participationWay === 'Product'||participationWay === '3'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:e.addProducts}},[e._v("添加商品")]),a("el-table",{ref:"productTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.products,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"fullName",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"price",label:"价格"}}),a("el-table-column",{attrs:{prop:"stock",label:"库存"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delProduct(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"ShopBrand"===e.participationWay||"2"===e.participationWay,expression:"participationWay === 'ShopBrand'||participationWay === '2'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:e.addBrands}},[e._v("添加品牌")]),a("el-table",{ref:"brandTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.shopBrands,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name",label:"品牌名称"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delBrand(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"ProductCategory"===e.participationWay||"1"===e.participationWay,expression:"participationWay === 'ProductCategory'||participationWay === '1'"}]},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showClassSelector=!e.showClassSelector}}},[e._v("添加分类")]),a("el-table",{ref:"cateTable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.productCategories,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name",label:"分类名称"}}),a("el-table-column",{attrs:{prop:"option",label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.delClass(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("biz-dialog-selector",{attrs:{title:"选择商品",visibility:e.showProductSelector,tableData:e.productTableData,pagination:e.productPagination,filters:e.productFilters,selectionKeys:e.selectedProducts,max:5},on:{"update:visibility":function(t){e.showProductSelector=t},pageSizeChange:e.productPageSizeChange,currentPageChange:e.productCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.productFilterDataChange}},[a("el-table-column",{attrs:{property:"sn",label:"编号"}}),a("el-table-column",{attrs:{property:"name",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"dialog-column"},[a("img",{staticClass:"productImg",attrs:{src:t.row.image||e.DefaultImg}}),a("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.fullName))])])]}}])}),a("el-table-column",{attrs:{property:"price",label:"销售价"}}),a("el-table-column",{attrs:{property:"stock",label:"库存"}}),a("el-table-column",{attrs:{property:"categoryType",label:"分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("0"===t.row.categoryType?"整车":"1"===t.row.categoryType?"车品":"2"===t.row.categoryType?"服务":"无")+" ")]}}])})],1),a("el-dialog",{staticClass:"promotion-dialog-checkbox",attrs:{title:"选择品牌",visible:e.showBrandSelector,"append-to-body":""},on:{"update:visible":function(t){e.showBrandSelector=t}}},[a("div",{staticClass:"dialog-top"},[a("el-input",{attrs:{size:"small",placeholder:"请输入品牌"},model:{value:e.brandSearchValue,callback:function(t){e.brandSearchValue=t},expression:"brandSearchValue"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.brandSearch},slot:"append"})],1)],1),a("el-checkbox-group",{model:{value:e.brandArr,callback:function(t){e.brandArr=t},expression:"brandArr"}},e._l(e.brandList,(function(t){return a("el-checkbox",{key:t.index,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showBrandSelector=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmBrands}},[e._v("确 定")])],1)],1),a("el-dialog",{staticClass:"promotion-dialog-checkbox",attrs:{title:"选择分类",visible:e.showClassSelector,"append-to-body":""},on:{"update:visible":function(t){e.showClassSelector=t}}},[a("el-tree",{ref:"tree",attrs:{props:e.defaultProps,"node-key":"id","highlight-current":e.highlightCurrent,data:e.dataTree,"show-checkbox":""},on:{"check-change":e.handleCheckChange}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showClassSelector=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmClasses}},[e._v("确 定")])],1)],1)],1)},o=[],n=(a("4de4"),a("caad"),a("c975"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("d3b7"),a("2532"),a("af3f")),r=a("2497"),s=a("bc3a"),c=a.n(s),l=a("c596"),u={queryGiftList:function(e,t,a){c.a.get(l["g"].activityMgmt.PromotionContent_queryGift,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},queryProductList:function(e,t,a){c.a.get(l["g"].activityMgmt.PromotionContent_queryProduct,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))},queryBaseInfo:function(e,t,a){c.a.get(l["g"].activityMgmt.PromotionBaseInfo_query,{params:e}).then(Object(r["a"])(t,a)).catch((function(e){console.error(e)}))}},d=a("1ab1"),p={queryBrandList:"/admin/shopBrand/brandSeries.jhtml",queryCategoryList:"/admin/json/ShopProduct_category/list.jhtml"},f=a("f3ac"),h=a.n(f),m={name:"PromotionParticipationWay",props:{value:{type:Array,default:function(){return[]}},participationWay:{type:String,default:function(){return""}},baseInfo:{type:Object,default:function(){return{shop:{name:""}}}}},data:function(){return{highlightCurrent:!0,defaultProps:{children:"children",label:"label"},dataTree:[],DefaultImg:h.a,brandList:[],brandSearchValue:"",products:[],shopBrands:[],productCategories:[],showProductSelector:!1,showBrandSelector:!1,showClassSelector:!1,brandArr:[],classList:[],classArr:[],productTableData:[],selectedProducts:[],productPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},productFilters:[{type:"input",placeholder:"请输入编号/商品名",name:"searchbar",value:""}]}},components:{BizDialogSelector:n["a"]},methods:{loadNode:function(){var e=this;d["a"].get("/admin/json/ShopProduct_category/list.jhtml",{pageNumber:1,pageSize:1e3}).then((function(t){e.dataTree=[],t.ProductCategoryManage.map((function(t){e.dataTree.push({label:t.name,id:t.id,children:t.childrenProductCategoryDataList.map((function(e){return{label:e.name,id:e.id}}))})})),e.$refs.tree.setCheckedKeys(e.value.map((function(e){return e.id}))),console.log(e.dataTree)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},handleCheckChange:function(e,t,a){var i=this;console.log(e,t,a),console.log(this.$refs.tree.getCheckedNodes()),this.$nextTick((function(){i.classArr=i.$refs.tree.getCheckedNodes().map((function(e){return e.id}))}))},productPageSizeChange:function(e){this.productPagination.pageSize=e,this.getProductTable()},productCurrentPageChange:function(e){this.productPagination.currentPage=e,this.getProductTable()},confirmedProduct:function(e){var t=this,a={ids:e};d["a"].post(l["a"].PromotionContent_queryProductByIds,a).then((function(e){t.products=e.content.filter((function(e){return e})),t.selectedProducts=t.products.map((function(e){return e.id})),t.handleInput(t.products)})).catch((function(e){console.log("ERR_GET_PRODUCT_BY_IDS: ",e)}))},productFilterDataChange:function(e){this.productPagination.currentPage=1,this.productFilters=e,this.getProductTable()},delProduct:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.products.length;a++)t.products[a].id===e&&(t.products.splice(a,1),t.handleInput(t.products));t.selectedProducts=[],t.products.map((function(e){t.selectedProducts.push(e.id)}))})).catch((function(){}))},delBrand:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.shopBrands.length;a++)t.shopBrands[a].id===e&&(t.shopBrands.splice(a,1),t.handleInput(t.shopBrands),t.brandSearchValue="");t.brandArr=[],t.shopBrands.map((function(e){t.brandArr.push(e.id)}))})).catch((function(){}))},delClass:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var a=0;a<t.productCategories.length;a++)t.productCategories[a].id===e&&(t.productCategories.splice(a,1),t.handleInput(t.productCategories));t.classArr=[],t.productCategories.map((function(e){t.classArr.push(e.id)}))})).catch((function(){}))},brandSearch:function(){this.getBrandList()},confirmBrands:function(){var e=this;this.showBrandSelector=!1;var t={searchProperty:"name",searchValue:"",pageNumber:1,pageSize:1e3};d["a"].get(p.queryBrandList,t).then((function(t){e.brandList=t.Brand,e.shopBrands=e.brandList.filter((function(t){return e.brandArr.includes(t.id)})),e.handleInput(e.shopBrands)})).catch()},confirmClasses:function(){var e=this;this.showClassSelector=!1,this.productCategories=[],this.$refs.tree.getCheckedNodes().map((function(t){-1!==e.classArr.indexOf(t.id)&&e.productCategories.push({id:t.id,name:t.label})})),this.handleInput(this.productCategories)},getProductTable:function(){var e=this,t={productType:"normal",pageSize:this.productPagination.pageSize,pageNumber:this.productPagination.currentPage,searchValue:this.productFilters[0].value};u.queryProductList(t,(function(t){e.productPagination.total=Number(t.total),e.productTableData=t.content}),(function(e){console.log("ERR_GET_PRODUCT_TABLE: ",e)}))},addProducts:function(){var e=this;this.selectedProducts=[],this.value.map((function(t){e.selectedProducts.push(t.id)})),this.showProductSelector=!0},addBrands:function(){this.showBrandSelector=!this.showBrandSelector,this.getBrandList()},getBrandList:function(){var e=this,t={searchProperty:"name",searchValue:this.brandSearchValue,pageNumber:1,pageSize:1e3};d["a"].get(p.queryBrandList,t).then((function(t){e.brandList=t.Brand})).catch()},handleInput:function(e){this.$emit("input",e)}},watch:{value:{handler:function(e,t){switch(this.participationWay){case"Store":case"0":this.products=[],this.shopBrands=[],this.productCategories=[];break;case"Product":case"3":this.products=e,this.shopBrands=[],this.productCategories=[];break;case"ShopBrand":case"2":this.products=[],this.shopBrands=e,this.productCategories=[];break;case"ProductCategory":case"1":this.products=[],this.shopBrands=[],this.productCategories=e;break;default:break}},deep:!0},showProductSelector:function(e,t){e&&(this.productPagination.currentPage=1,this.getProductTable())},showClassSelector:function(e,t){e&&this.loadNode()},showBrandSelector:function(e,t){e&&"2"===this.participationWay&&(this.brandArr=this.value.map((function(e){return e.id})))}},mounted:function(){}},g=m,b=(a("b537"),a("2877")),v=Object(b["a"])(g,i,o,!1,null,null,null);t["a"]=v.exports},"7bc6":function(e,t,a){"use strict";var i=a("1c8c"),o=a.n(i);o.a},8396:function(e,t,a){},"86f5":function(e,t,a){},9678:function(e,t,a){},a5b9:function(e,t,a){"use strict";var i=a("86f5"),o=a.n(i);o.a},a6a3:function(e,t,a){},af3f:function(e,t,a){"use strict";var i=a("697f");t["a"]=i["a"]},b36a:function(e,t,a){"use strict";var i=a("6da8"),o=a.n(i);o.a},b537:function(e,t,a){"use strict";var i=a("db02"),o=a.n(i);o.a},b547:function(e,t,a){},b680:function(e,t,a){"use strict";var i=a("23e7"),o=a("a691"),n=a("408a"),r=a("1148"),s=a("d039"),c=1..toFixed,l=Math.floor,u=function(e,t,a){return 0===t?a:t%2===1?u(e,t-1,a*e):u(e*e,t/2,a)},d=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},p=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){c.call({})}));i({target:"Number",proto:!0,forced:p},{toFixed:function(e){var t,a,i,s,c=n(this),p=o(e),f=[0,0,0,0,0,0],h="",m="0",g=function(e,t){var a=-1,i=t;while(++a<6)i+=e*f[a],f[a]=i%1e7,i=l(i/1e7)},b=function(e){var t=6,a=0;while(--t>=0)a+=f[t],f[t]=l(a/e),a=a%e*1e7},v=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==f[e]){var a=String(f[e]);t=""===t?a:t+r.call("0",7-a.length)+a}return t};if(p<0||p>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(h="-",c=-c),c>1e-21)if(t=d(c*u(2,69,1))-69,a=t<0?c*u(2,-t,1):c/u(2,t,1),a*=4503599627370496,t=52-t,t>0){g(0,a),i=p;while(i>=7)g(1e7,0),i-=7;g(u(10,i,1),0),i=t-1;while(i>=23)b(1<<23),i-=23;b(1<<i),g(1,1),b(2),m=v()}else g(0,a),g(1<<-t,0),m=v()+r.call("0",p);return p>0?(s=m.length,m=h+(s<=p?"0."+r.call("0",p-s)+m:m.slice(0,s-p)+"."+m.slice(s-p))):m=h+m,m}})},be8b:function(e,t,a){"use strict";var i=a("dafd"),o=a.n(i);o.a},d4c2:function(e,t,a){"use strict";var i=a("e725"),o=a.n(i);o.a},dafd:function(e,t,a){},db02:function(e,t,a){},e1d7:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"financial-mgmt"},[a("biz-flex-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,pagination:e.pagination},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"selection-change":e.handleSelectionChange,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"sort-change":e.handleSortChange}},[a("el-table-column",{attrs:{label:"金融方案","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v("方案名称："+e._s(t.row.name))]),a("div",{staticClass:"overflow"},[e._v("金融机构："+e._s(t.row.financialInstitutionName))]),a("div",{staticClass:"overflow"},[e._v("金融分类："+e._s(t.row.categoryName))])])]}}])}),a("el-table-column",{attrs:{label:"方案来源","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(t.row.planSource))])])]}}])}),a("el-table-column",{attrs:{label:"销售价","min-width":"60px",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(t.row.price))])])]}}])}),a("el-table-column",{attrs:{label:"状态","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(e.getStatus(t.row)))])])]}}])}),a("el-table-column",{attrs:{label:"所属店铺","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(e._s(t.row.shop.name))])])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("biz-column-operation",{attrs:{row:t.row}},[e.canOffsale(t.row)?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.soldout(t.row.id)}}},[e._v("下架")]):e._e(),e.canOnsale(t.row)?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.putaway(t.row.id)}}},[e._v("上架")]):e._e(),e.canEdited(t.row)?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.deleteRecommend(t.row.id)}}},[e._v("删除")]):e._e()],1)]}}])})],1),a("Financial-popup",{attrs:{slot:"float",open:e.open,id:e.addId,isEdit:e.isEdit,baseInfo:e.rowBaseInfo},on:{close:function(t){e.open=!1,e.addId=""},operationSuccess:e.refresh,createdProductSuccess:e.createdProductSuccess},slot:"float"})],1)},o=[],n=(a("4160"),a("a15b"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("b680"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("1276"),a("159b"),a("b85c")),r=a("5530"),s=a("04d3"),c=a("11e9"),l=a("2f62"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"baseinfo"}},[a("BaseInfo",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess,createdProductSuccess:e.createdProductSuccess}})],1),e.id&&"7"===e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"优惠券信息",name:"specification"}},[a("coupon-product",{attrs:{id:e.id,baseInfo:e.baseInfo}})],1):e._e(),e.id?a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("Detail",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"参数",name:"parameter"}},[a("Parameter",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id?a("el-tab-pane",{attrs:{label:"图片",name:"pictureInfo"}},[a("PictureInfo",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"属性",name:"attribute"}},[a("Attribute",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"规格",name:"specification"}},[a("specification",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess,close:e.close}})],1):e._e(),e.id&&"7"!==e.baseInfo.productType?a("el-tab-pane",{attrs:{label:"适用商品",name:"applicableProduct"}},[a("ApplicableProduct",{attrs:{open:e.open,id:e.id,isEdit:e.isEdit,tabSelection:e.tabSelection},on:{operationSuccess:e.operationSuccess,close:e.close}})],1):e._e()],1)},d=[],p=a("7132"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"financial-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"productDataForm",attrs:{"label-width":"130px",size:"small",model:e.productDataModel,rules:e.productDataRules,disabled:!e.isEdit,"inline-message":!0}},[a("el-form-item",{attrs:{label:"方案名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入方案名称"},model:{value:e.productDataModel.name,callback:function(t){e.$set(e.productDataModel,"name",t)},expression:"productDataModel.name"}})],1),a("el-form-item",{attrs:{label:"金融机构",prop:"financialInstitution"}},[a("el-select",{attrs:{placeholder:"请选择金融机构"},model:{value:e.productDataModel.financialInstitution,callback:function(t){e.$set(e.productDataModel,"financialInstitution",t)},expression:"productDataModel.financialInstitution"}},e._l(e.financials,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"金融分类",prop:"categoryId"}},[a("el-select",{attrs:{placeholder:"请选择金融分类"},model:{value:e.productDataModel.categoryId,callback:function(t){e.$set(e.productDataModel,"categoryId",t)},expression:"productDataModel.categoryId"}},e._l(e.categorys,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"编号"}},[a("el-input",{attrs:{placeholder:e.productDataModel.id?"请输入编号":"创建成功后自动生成",readonly:!0,disabled:!0},model:{value:e.productDataModel.sn,callback:function(t){e.$set(e.productDataModel,"sn",t)},expression:"productDataModel.sn"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{disabled:!1===e.isCreated,placeholder:"请选择商品类型"},on:{change:e.productTypeChange},model:{value:e.productDataModel.productType,callback:function(t){e.$set(e.productDataModel,"productType",t)},expression:"productDataModel.productType"}},e._l(e.productTypes,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"分期方式",prop:"method"}},[a("el-radio-group",{model:{value:e.productDataModel.method,callback:function(t){e.$set(e.productDataModel,"method",t)},expression:"productDataModel.method"}},[a("el-radio",{attrs:{label:"0",disabled:""}},[e._v("线上分期")]),a("el-radio",{attrs:{label:"1"}},[e._v("预约分期")])],1)],1),a("el-form-item",{attrs:{label:"利息计算方式",prop:"interestRate"}},[a("el-radio-group",{model:{value:e.productDataModel.interestRate,callback:function(t){e.$set(e.productDataModel,"interestRate",t)},expression:"productDataModel.interestRate"}},[a("el-radio",{attrs:{label:"0"}},[e._v("费率")]),a("el-radio",{attrs:{label:"1"}},[e._v("利率")])],1)],1),a("el-form-item",{attrs:{label:"额度下限",prop:"lowerLimit"}},[a("el-input",{model:{value:e.productDataModel.lowerLimit,callback:function(t){e.$set(e.productDataModel,"lowerLimit",t)},expression:"productDataModel.lowerLimit"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{attrs:{label:"额度上限",prop:"upperLimit"}},[a("el-input",{model:{value:e.productDataModel.upperLimit,callback:function(t){e.$set(e.productDataModel,"upperLimit",t)},expression:"productDataModel.upperLimit"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{attrs:{label:"服务费",prop:"serviceCharge"}},[a("el-input",{model:{value:e.productDataModel.serviceCharge,callback:function(t){e.$set(e.productDataModel,"serviceCharge",t)},expression:"productDataModel.serviceCharge"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{attrs:{label:"融资附加",prop:"financings"}},[a("el-checkbox-group",{model:{value:e.productDataModel.financings,callback:function(t){e.$set(e.productDataModel,"financings",t)},expression:"productDataModel.financings"}},e._l(e.financingGroup,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),e.isNeedToShowPrice?a("el-form-item",{attrs:{label:e.priceLabel,prop:"price"}},[a("el-input",{attrs:{placeholder:"请输入一口价"},model:{value:e.productDataModel.price,callback:function(t){e.$set(e.productDataModel,"price",t)},expression:"productDataModel.price"}})],1):e._e(),a("el-form-item",{attrs:{label:"市场指导价：",prop:"marketPrice"}},[a("el-input",{attrs:{placeholder:"请输入市场指导价"},model:{value:e.productDataModel.marketPrice,callback:function(t){e.$set(e.productDataModel,"marketPrice",t)},expression:"productDataModel.marketPrice"}})],1),a("el-form-item",{attrs:{label:"成本价：",prop:"cost"}},[a("el-input",{attrs:{placeholder:"请输入成本价"},model:{value:e.productDataModel.cost,callback:function(t){e.$set(e.productDataModel,"cost",t)},expression:"productDataModel.cost"}})],1),a("el-form-item",{attrs:{label:"商品缩略图：",prop:"image"}},[a("BizAvatarUploaderNew",{model:{value:e.productDataModel.image,callback:function(t){e.$set(e.productDataModel,"image",t)},expression:"productDataModel.image"}})],1),a("el-form-item",{attrs:{label:"库存：",prop:"stock"}},[a("el-input",{attrs:{placeholder:"请输入..."},model:{value:e.productDataModel.stock,callback:function(t){e.$set(e.productDataModel,"stock",t)},expression:"productDataModel.stock"}})],1),e.isNeedToShowBeanPercent()&&"false"===e.productDataModel.isPriceNegotiable?a("el-form-item",{attrs:{label:"V豆折扣上限(%)：",prop:"beanPercent"}},[a("el-input",{attrs:{placeholder:"按会员奖励设置比例"},model:{value:e.productDataModel.beanPercent,callback:function(t){e.$set(e.productDataModel,"beanPercent",t)},expression:"productDataModel.beanPercent"}})],1):e._e(),"false"===e.productDataModel.isPriceNegotiable?a("el-form-item",{attrs:{label:"V豆赠送上限(%)：",prop:"giftPercent"}},[a("el-input",{attrs:{placeholder:"请输入..."},model:{value:e.productDataModel.giftPercent,callback:function(t){e.$set(e.productDataModel,"giftPercent",t)},expression:"productDataModel.giftPercent"}})],1):e._e(),e.isNeedToShowPaymentMethod&&"false"===e.productDataModel.isPriceNegotiable?a("el-form-item",{attrs:{label:"支付方式：",prop:"paymentMethodIds"}},[a("el-checkbox-group",{model:{value:e.productDataModel.paymentMethodIds,callback:function(t){e.$set(e.productDataModel,"paymentMethodIds",t)},expression:"productDataModel.paymentMethodIds"}},e._l(e.payOptions,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"7"!==e.productDataModel.productType&&"false"===e.productDataModel.isPriceNegotiable,expression:"productDataModel.productType!=='7'&&productDataModel.isPriceNegotiable==='false'"}],attrs:{label:"配送方式：",prop:"shippingMethodIds"}},[a("el-checkbox-group",{staticClass:"shipping-method",model:{value:e.shippingMethodIds,callback:function(t){e.shippingMethodIds=t},expression:"shippingMethodIds"}},e._l(e.shippingMethods,(function(t){return a("el-checkbox",{key:t.shopShippingMethod.id,attrs:{label:t.shopShippingMethod.id}},[e._v(e._s(t.shopShippingMethod.name))])})),1)],1),a("el-form-item",{attrs:{label:"口碑："}},[e._l(e.productDataModel.reputations,(function(t){return a("el-tag",{key:t,attrs:{size:"small",closable:"","disable-transitions":!0,type:"warning"},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"请输入1-6字口碑词汇"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+添加")])],2),a("el-form-item",{attrs:{label:"设置："}},[a("el-checkbox-group",{model:{value:e.checkedSet,callback:function(t){e.checkedSet=t},expression:"checkedSet"}},[a("el-checkbox",{attrs:{label:"是否置顶"}}),"false"===e.productDataModel.isPriceNegotiable?a("el-checkbox",{attrs:{label:"是否订金支付"}}):e._e()],1)],1)],1),e.isSubscriptionChecked()?a("el-form",{ref:"subscriptionForm",attrs:{"label-width":"120px ",size:"small",model:e.productDataModel,rules:e.subscriptionRules}},[a("el-form-item",{attrs:{label:"订金金额：",prop:"subscription"}},[a("el-input",{attrs:{placeholder:"请输入不大于销售价的数字"},model:{value:e.productDataModel.subscription,callback:function(t){e.$set(e.productDataModel,"subscription",t)},expression:"productDataModel.subscription"}})],1),a("el-form-item",{attrs:{label:"订金可退："}},[a("el-radio-group",{model:{value:e.productDataModel.isSubscriptionReturn,callback:function(t){e.$set(e.productDataModel,"isSubscriptionReturn",t)},expression:"productDataModel.isSubscriptionReturn"}},[a("el-radio",{attrs:{label:"true"}},[e._v("是")]),a("el-radio",{attrs:{label:"false"}},[e._v("否")])],1)],1)],1):e._e()],1)},h=[],m=(a("c975"),a("f36f")),g=a("8330"),b=a("c17f"),v=a("1ab1"),y={name:"FinancialMgmtBaseInfo",data:function(){var e=this,t=function(t,a,i){e.productDataModel.categoryId?i():i(new Error("请选择金融分类"))},a=function(t,a,i){e.productDataModel.marketPrice,Number(e.productDataModel.marketPrice)>=0?i():i(new Error("市场指导价必须为数字值"))},i=function(t,a,i){e.productDataModel.cost,Number(e.productDataModel.cost)>=0?i():i(new Error("成本价必须为数字值"))},o=function(t,a,i){Number(e.productDataModel.lowerLimit)>=0?i():i(new Error("额度下限必须为数字值"))},n=function(t,a,i){Number(e.productDataModel.upperLimit)>=0?i():i(new Error("额度上限必须为数字值"))},r=function(t,a,i){Number(e.productDataModel.serviceCharge)>=0?i():i(new Error("服务费必须为数字值"))},s=function(t,a,i){Number(e.productDataModel.price)>=0?i():i(new Error("一口价必须为数字值"))},c=function(t,a,i){e.productDataModel.beanPercent,Number(e.productDataModel.beanPercent)>=0?(Number(e.productDataModel.beanPercent)>100&&i(new Error("V豆折扣上限(%)不能超过100")),i()):i(new Error("V豆折扣上限(%)必须为数字值"))},l=function(t,a,i){""===e.productDataModel.giftPercent&&(e.productDataModel.giftPercent=0),Number(e.productDataModel.giftPercent)>=0?(Number(e.productDataModel.giftPercent)>100&&i(new Error("V豆赠送上限(%)不能超过100")),i()):i(new Error("V豆赠送上限(%)必须为数字值"))},u=function(t,a,i){""===e.productDataModel.weight&&(e.productDataModel.weight=0),Number(e.productDataModel.weight)>=0?e.productDataModel.weight&&-1!==e.productDataModel.weight.indexOf(".")&&e.productDataModel.weight.split(".")[1].length>2?i(new Error("只允许输入到小数后两位")):i():i(new Error("重量必须为数字值"))},d=function(t,a,i){"undefined"!==typeof e.productDataModel.image?(console.log(e.productDataModel.image)," "!==e.productDataModel.image?i():i(new Error("缩略图必须上传"))):i(new Error("缩略图必须上传"))},p=function(t,a,i){console.log(e.productDataModel.stock),""!==e.productDataModel.stock&&Number(e.productDataModel.stock)>=0&&-1===e.productDataModel.stock.indexOf(".")?i():i(new Error("库存必须为整数值"))},f=function(t,a,i){""!==e.productDataModel.subscription&&Number(e.productDataModel.subscription)>0?(Number(e.productDataModel.subscription)>=Number(e.productDataModel.price)&&i(new Error("请输入不大于销售价的数字")),i()):i(new Error("订金金额必须为大于0数值"))},h=function(t,a,i){"2"===e.productDataModel.productType||"7"===e.productDataModel.productType||e.productDataModel.paymentMethodIds.length>0?i():i(new Error("请至少选择一种支付方式"))},m=function(t,a,i){"7"===e.productDataModel.productType||e.shippingMethodIds.length>0?i():i(new Error("请至少选择一种配送方式"))};return{operations:[{label:"保存",name:"save",type:"primary",disabled:!1}],productDataRules:{categoryId:[{required:!0,trigger:"blur",validator:t}],name:[{required:!0,trigger:"blur",message:"请输入方案名称"}],financialInstitution:[{required:!0,trigger:"blur",message:"请选择金融机构"}],financings:[{required:!0,trigger:"blur",message:"请选择融资附加"}],marketPrice:[{required:!1,trigger:"blur",validator:a}],cost:[{required:!1,trigger:"blur",validator:i}],price:[{required:!1,trigger:"blur",validator:s}],beanPercent:[{required:!1,trigger:"blur",validator:c}],giftPercent:[{required:!1,trigger:"blur",validator:l}],weight:[{required:!0,trigger:"blur",validator:u}],image:[{required:!1,trigger:"blur",validator:d}],stock:[{required:!0,trigger:"blur",validator:p}],paymentMethodIds:[{required:!0,trigger:"blur",validator:h}],shippingMethodIds:[{required:!0,trigger:"blur",validator:m}],method:[{required:!0,trigger:"blur",message:"请选择分期方式"}],interestRate:[{required:!0,trigger:"blur",message:"请选择利息计算方式"}],lowerLimit:[{required:!0,trigger:"blur",validator:o}],upperLimit:[{required:!0,trigger:"blur",validator:n}],serviceCharge:[{required:!0,trigger:"blur",validator:r}]},subscriptionRules:{subscription:[{required:!0,trigger:"blur",validator:f}]},isCreated:"true",defaultImg:"/resources/admin/images/default/product-default.png",productDataModel:this.getDefaultProductDataModel(),categoryOptions:[],productTypes:[],financials:[],categorys:[],payOptions:[],shippingMethods:[],shippingMethodIds:[],setOptions:["是否置顶","是否订金支付"],financingGroup:[{id:"0",name:"购置税"},{id:"1",name:"车船税"},{id:"2",name:"交强险"},{id:"3",name:"商业保险"},{id:"4",name:"上牌费"},{id:"5",name:"服务费"}],checkedSet:[],inputVisible:!1,inputValue:"",loading:!1,refreshSign:!0,initializing:!1}},components:{BizGrid:m["a"],BizSaveButton:g["a"],BizAvatarUploaderNew:b["b"]},props:{id:{type:String,default:""},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{open:function(e){e?""!==this.id?this.isCreated=!1:(this.isCreated=!0,this.refresh()):(this.isCreated=!0,this.categorys=[],this.productTypes=[],this.payOptions=[],this.shippingMethods=[],this.checkedSet=[])},id:function(e,t){e?!0===this.open&&"baseinfo"===this.tabSelection&&this.refresh():this.productDataModel=this.getDefaultProductDataModel()}},created:function(){this.getDefaultImg()},computed:{isNeedToShowPrice:function(){return("0"===this.productDataModel.productType||"1"===this.productDataModel.productType||"7"===this.productDataModel.productType)&&"false"===this.productDataModel.isPriceNegotiable},isNeedToShowPaymentMethod:function(){return"2"!==this.productDataModel.productType&&"7"!==this.productDataModel.productType},isNeedToShowTestDrive:function(){var e=this,t=!1;return this.categoryOptions.map((function(a){console.log(a.name),a.id===e.productDataModel.categoryId&&"car"===a.type&&(t=!0)})),t},priceLabel:function(){return"0"===this.productDataModel.productType?"一口价：":"销售价："},showPriceRadio:function(){return"0"===this.productDataModel.productType}},methods:{operate:function(e){this[e]()},getDefaultImg:function(){var e=this,t={type:"displaySetting"};v["a"].get("/admin/settings/settings.jhtml",t).then((function(t){t.settingList.defaultThumbnailProductImage&&(e.defaultImg=t.settingList.defaultThumbnailProductImage)})).catch((function(t){console.log(t),console.log("code错误"),e.$message.warning(t.errorMessage)}))},handleClose:function(e){this.productDataModel.reputations.splice(this.productDataModel.reputations.indexOf(e),1)},categorySelectChange:function(e,t,a,i){this.productDataModel.categoryId=e,this.productDataModel.brandId=t,this.productDataModel.seriesId=a,this.productDataModel.name=i},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){if(this.inputValue.length>6)return this.$message.warning("请输入1-6字口碑词汇"),!1;this.inputVisible=!1,this.inputValue&&(this.productDataModel.reputations.push(this.inputValue),this.inputValue="")},getDefaultProductDataModel:function(){return{shopId:window.top.SHOP_ID||"",id:"",sn:"",categoryId:"",brandId:"",seriesId:"",name:"",typeName:"",image:this.defaultImg,price:"",isPriceNegotiable:"false",cost:"",marketPrice:"",sales:"",stock:"0",isSupportTestDrive:"0",isList:"false",isTop:"false",isSubscription:"false",subscription:"",isSubscriptionReturn:"true",reputations:[],paymentMethodIds:[],productType:"0",bean:"",beanPercent:"",giftPercent:"",weight:"0",financialInstitution:"",method:"1",interestRate:"0",upperLimit:"",lowerLimit:"",serviceCharge:"",financings:["0"]}},getSaveProductDataModel:function(){var e=[];if("2"===this.productDataModel.productType){var t,a=Object(n["a"])(this.payOptions);try{for(a.s();!(t=a.n()).done;){var i=t.value;e.push(i.id)}}catch(d){a.e(d)}finally{a.f()}}else{var o,r=Object(n["a"])(this.productDataModel.paymentMethodIds);try{for(r.s();!(o=r.n()).done;){var s=o.value;e.push(s)}}catch(d){r.e(d)}finally{r.f()}}var c,l=Object(n["a"])(this.shippingMethods);try{for(l.s();!(c=l.n()).done;){var u=c.value;u.productValid="0",-1!==this.shippingMethodIds.indexOf(u.shopShippingMethod.id)&&(u.productValid="1")}}catch(d){l.e(d)}finally{l.f()}return{shopId:this.productDataModel.shopId,id:this.productDataModel.id,sn:this.productDataModel.sn,categoryId:this.productDataModel.categoryId,brandId:this.productDataModel.brandId,seriesId:this.productDataModel.seriesId,name:this.productDataModel.name,image:this.productDataModel.image,price:this.productDataModel.price||"0",cost:this.productDataModel.cost,marketPrice:this.productDataModel.marketPrice,sales:this.productDataModel.sales,stock:this.productDataModel.stock,isSupportTestDrive:this.productDataModel.isSupportTestDrive,isPriceNegotiable:this.productDataModel.isPriceNegotiable,isList:String(this.isListChecked()),isTop:String(this.isTopChecked()),isSubscription:String(this.isSubscriptionChecked()),subscription:this.productDataModel.subscription,isSubscriptionReturn:this.productDataModel.isSubscriptionReturn,reputations:this.productDataModel.reputations,paymentMethodIds:e,shippingMethods:this.shippingMethods,productType:this.productDataModel.productType,bean:this.productDataModel.bean,beanPercent:this.productDataModel.beanPercent,giftPercent:this.productDataModel.giftPercent,weight:this.productDataModel.weight||"",keyword:this.productDataModel.keyword||[],tags:this.productDataModel.tags||[],wholesalePrice:this.productDataModel.wholesalePrice||"",financialInstitution:this.productDataModel.financialInstitution,method:this.productDataModel.method,interestRate:this.productDataModel.interestRate,upperLimit:this.productDataModel.upperLimit,lowerLimit:this.productDataModel.lowerLimit,serviceCharge:this.productDataModel.serviceCharge,financings:this.productDataModel.financings}},handleUploadSuccess:function(e){console.log(e),this.productDataModel.image=e},isListChecked:function(){var e,t=Object(n["a"])(this.checkedSet);try{for(t.s();!(e=t.n()).done;){var a=e.value;if("是否列出"===a)return!0}}catch(i){t.e(i)}finally{t.f()}return!1},isTopChecked:function(){var e,t=Object(n["a"])(this.checkedSet);try{for(t.s();!(e=t.n()).done;){var a=e.value;if("是否置顶"===a)return!0}}catch(i){t.e(i)}finally{t.f()}return!1},isSubscriptionChecked:function(){var e,t=Object(n["a"])(this.checkedSet);try{for(t.s();!(e=t.n()).done;){var a=e.value;if("是否订金支付"===a)return!0}}catch(i){t.e(i)}finally{t.f()}return!1},isNeedToShowBeanPercent:function(){return"0"===this.productDataModel.productType||"7"===this.productDataModel.productType},refresh:function(){var e=this;this.initializing=!0;var t={id:this.id,shopId:window.top.SHOP_ID||""};v["a"].get("/admin/financialProductPlanController/financialProductPlanBasicInfo.jhtml",t).then((function(t){t.productCategoryTree.map((function(t){"finance"===t.type&&e.categorys.push(t)})),e.financials=t.financialInstitutionDatas,e.productTypes=t.productTypes,e.payOptions=t.paymentMethods,e.shippingMethods=t.shippingMethods,e.shippingMethodIds=[];var a,i=Object(n["a"])(e.shippingMethods);try{for(i.s();!(a=i.n()).done;){var o=a.value;"1"===o.productValid&&e.shippingMethodIds.push(o.shopShippingMethod.id)}}catch(u){i.e(u)}finally{i.f()}if(e.refreshSign=!e.refreshSign,e.id)e.productDataModel=e.convert2ProductDataModel(t.inancialProductPlanData);else{e.productDataModel.image=e.defaultImg;var r,s=Object(n["a"])(e.payOptions);try{for(s.s();!(r=s.n()).done;){var c=r.value;e.productDataModel.paymentMethodIds.push(c.id)}}catch(u){s.e(u)}finally{s.f()}}var l=[];t.productBasicInfoData&&("true"===t.productBasicInfoData.isList&&l.push("是否列出"),"true"===t.productBasicInfoData.isTop&&l.push("是否置顶"),"true"===t.productBasicInfoData.isSubscription&&l.push("是否订金支付")),e.checkedSet=l,e.$nextTick((function(){e.initializing=!1}))})).catch((function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},convert2ProductDataModel:function(e){return{shopId:e.shopId,id:e.id,sn:e.sn,categoryId:e.categoryId,brandId:e.brandId,seriesId:e.seriesId,name:e.name,image:e.image,price:e.price,cost:e.cost,marketPrice:e.marketPrice,sales:e.sales,stock:e.stock,isSupportTestDrive:e.isSupportTestDrive,isList:e.isList,isTop:e.isTop,isSubscription:e.isSubscription,subscription:e.subscription,isSubscriptionReturn:e.isSubscriptionReturn||"true",reputations:e.reputations,paymentMethodIds:e.paymentMethodIds,productType:e.productType,bean:e.bean,beanPercent:e.beanPercent,giftPercent:e.giftPercent,isPriceNegotiable:e.isPriceNegotiable,weight:e.weight||0,financialInstitution:e.financialInstitution,method:e.method,interestRate:e.interestRate,upperLimit:e.upperLimit,lowerLimit:e.lowerLimit,serviceCharge:e.serviceCharge,financings:e.financings}},save:function(){var e=this;this.$refs.productDataForm.validate((function(t){if(!t)return!1;e.isSubscriptionChecked()?e.$refs.subscriptionForm.validate((function(t){if(!t)return!1;e.isCreated?e.createProduct():e.updateProduct()})):e.isCreated?e.createProduct():e.updateProduct()}))},createProduct:function(){var e=this,t=this.getSaveProductDataModel();v["a"].post("/admin/financialProductPlanController/financialProductPlanBasicInfo.jhtml",t).then((function(t){e.$message.success("添加成功"),e.id=t.id,e.isCreated=!1,e.refresh(),e.$emit("operationSuccess"),e.$emit("createdProductSuccess",t.id,e.productDataModel.productType)})).catch((function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},updateProduct:function(){var e=this,t=this.getSaveProductDataModel();v["a"].put("/admin/financialProductPlanController/financialProductPlanBasicInfo.jhtml",t).then((function(t){e.refresh(),e.$message.success("更新成功"),e.$emit("operationSuccess")})).catch((function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},productTypeChange:function(e){if("7"===e)this.shippingMethodIds=[],this.productDataModel.paymentMethodIds=[];else{var t,a=Object(n["a"])(this.payOptions);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.productDataModel.paymentMethodIds.push(i.id)}}catch(c){a.e(c)}finally{a.f()}var o,r=Object(n["a"])(this.shippingMethods);try{for(r.s();!(o=r.n()).done;){var s=o.value;this.shippingMethodIds.push(s.shopShippingMethod.id)}}catch(c){r.e(c)}finally{r.f()}}"1"!==e&&(this.productDataModel.isPriceNegotiable="false")}}},D=y,S=(a("be8b"),a("2877")),I=Object(S["a"])(D,f,h,!1,null,null,null),w=I.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"propetry-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"106px",size:"small",disabled:!e.isEdit,"inline-message":!0}},[a("el-form-item",{attrs:{label:"商品介绍"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"430px"},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1),a("el-form-item",{attrs:{label:"购买须知"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"430px"},model:{value:e.form.notice,callback:function(t){e.$set(e.form,"notice",t)},expression:"form.notice"}})],1),a("el-form-item",{attrs:{label:"产品售后"}}),a("div",{staticClass:"h-editor"},[a("biz-editor",{attrs:{height:"400px",width:"430px"},model:{value:e.form.afterSale,callback:function(t){e.$set(e.form,"afterSale",t)},expression:"form.afterSale"}})],1),a("el-form-item",{attrs:{label:"语音播报介绍","label-width":"135px"}}),a("div",{staticClass:"y-editor"},[a("el-input",{attrs:{type:"textarea",maxlength:"200",autosize:{minRows:5,maxRows:8}},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1)],1)],1)},M=[],C=a("40ae"),k=a("392e"),x={name:"CommodityMgmtBaseInfo",data:function(){return{isCreated:!1,operations:[{label:"保存",name:"update",type:"primary"}],form:{introduction:"",notice:"",afterSale:"",memo:""}}},props:{id:{type:String},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"detail"===e&&""!==this.id&&this.refresh()},open:function(e){e||(this.form.introduction="",this.form.notice="",this.form.afterSale="",this.form.memo="")}},components:{BizSaveButton:g["a"],BizGrid:m["a"],BizEditor:C["a"]},created:function(){},computed:{},methods:{checkVideo:function(e){this.$message.warning(e)},operate:function(e){this[e]()},onSubmit:function(){console.log("submit!")},refresh:function(){var e=this,t={id:this.id};this.isCreated=!0,k["a"].queryProductDetail(t,(function(t){e.form.introduction=t.introduction,e.form.notice=t.notice,e.form.afterSale=t.afterSale,e.form.memo=t.memo,e.$nextTick((function(){e.isCreated=!1}))}),(function(e){console.log(e)}))},update:function(){var e=this,t={id:this.id,introduction:this.form.introduction,notice:this.form.notice,afterSale:this.form.afterSale,memo:this.form.memo};k["a"].updateProductDetail(t,(function(t){e.$message.success("操作成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log(t)}))}}},_=x,$=(a("f813"),Object(S["a"])(_,P,M,!1,null,null,null)),T=$.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"commodity-mgmt-picture-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{size:"small","label-position":"top","label-width":"110px",disabled:!e.isEdit,"inline-message":!0}},[a("el-form-item",{attrs:{label:"所有图片限制200K以下,建议尺寸3:2"}}),a("el-form-item",{attrs:{label:"轮播主图管理"}},[a("ProductAvatarPictureCardUploader",{class:{disabled:e.uploadDisabled},attrs:{imageList:e.carouselImages,productId:e.id,isMainPicture:!0},on:{"upload-success":e.handleCarouselUpload,"remove-success":e.handleCarouselRemove}})],1)],1)],1)},O=[],L=(a("4de4"),a("c740"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-avatar-picture-card-uploader"},[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{accept:"image/*","list-type":"picture-card","file-list":e.imageList,name:"uploadFile0","on-success":e.handleSuccess,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.beforeAvatarUpload,action:e.uploadAction,data:e.uploadData,multiple:""}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("el-dialog",{staticClass:"avatar-preview-dialog",attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"review"},[a("img",{attrs:{src:e.imgUrl,alt:""}})])])],1)}),V=[],z={name:"ProductAvatarPictureCardUploader",data:function(){return{imgUrl:{type:String,default:""},dialogVisible:!1}},props:{parentElementName:String,shopId:window.top.SHOP_ID||"",productId:String,isMainPicture:{type:Boolean,default:function(){return!1}},imageList:{type:Array,default:function(){return[]}}},computed:{uploadAction:function(){return this.isMainPicture?"/admin/shopProduct/productImagesFile.jhtml":"/admin/vrMedia/uploadVrImage.jhtml"},uploadData:function(){return console.log("uploadData"),{shopId:window.top.SHOP_ID||"",productId:this.productId,type:"0"}}},methods:{handleRemove:function(e,t){this.$emit("remove-success",e)},handlePreview:function(e){this.imgUrl=e.url,this.dialogVisible=!0},handleSuccess:function(e,t,a){this.$emit("upload-success",e,t,this.parentElementName)},beforeAvatarUpload:function(e){var t=/^image\/(.*)$/.test(e.type);if(!t)return this.$message.error("请选择符合图片格式的文件上传!"),!1;var a=e.size/1024<=200;return a?!this.isMainPicture||(this.$refs.upload.$refs["upload-inner"].fileList.length<=5||(this.$message.error("轮播主图最多可添加5个"),!1)):(this.$message.error("上传图片大小不能超过 200K!"),!1)}}},E=z,N=(a("6e29"),Object(S["a"])(E,L,V,!1,null,null,null)),j=N.exports,q=a("2299"),A={name:"CommodityMgmtPictureInfo",components:{BizSaveButton:g["a"],BizGrid:m["a"],ProductAvatarPictureCardUploader:j},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"}],appearanceName:"",image:"",wideImage:"",VrMediaData:[],productImageDatas:[],carouselImages:[],vrFileList:[],testDriverList:[],interiorsImages:[],spaceImages:[],diagramImages:[],appearanceList:[]}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"pictureInfo"===e&&""!==this.id&&this.query()},open:function(e){e||(this.image="",this.wideImage="",this.VrMediaData=[],this.productImageDatas=[],this.carouselImages=[],this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.appearanceList=[])}},created:function(){},computed:{uploadDisabled:function(){return this.productImageDatas.length>=5}},methods:{operate:function(e){this[e]()},addAppearance:function(){var e=this;if(this.appearanceName){var t=this.appearanceList.findIndex((function(t){return t.name===e.appearanceName}));if(-1===t){var a={name:this.appearanceName,appearanceImages:[]};this.appearanceList.push(a)}this.appearanceName=""}},updateCarouselImages:function(){for(var e=[],t=0;t<this.productImageDatas.length;t++)e.push({name:this.productImageDatas[t].title,url:this.productImageDatas[t].source});this.carouselImages=e},updateVrData:function(){var e=this;this.interiorsImages=[],this.spaceImages=[],this.diagramImages=[],this.appearanceList=[],this.vrFileList=[],this.testDriverList=[];for(var t=function(t){var a={url:e.VrMediaData[t].filePath,color:e.VrMediaData[t].color,mediaType:e.VrMediaData[t].mediaType};if("vr"===e.VrMediaData[t].mediaType)e.vrFileList.push({name:e.VrMediaData[t].filePath,url:e.VrMediaData[t].filePath});else if("testdrive"===e.VrMediaData[t].mediaType)e.testDriverList.push({name:e.VrMediaData[t].filePath,url:e.VrMediaData[t].filePath});else if("interiors"===e.VrMediaData[t].mediaType)e.interiorsImages.push(a);else if("space"===e.VrMediaData[t].mediaType)e.spaceImages.push(a);else if("diagram"===e.VrMediaData[t].mediaType)e.diagramImages.push(a);else if("appearance"===e.VrMediaData[t].mediaType&&e.VrMediaData[t].color){var i=e.appearanceList.findIndex((function(a){return a.name===e.VrMediaData[t].color}));if(-1===i){var o={name:e.VrMediaData[t].color,appearanceImages:[]};o.appearanceImages.push(a),e.appearanceList.push(o)}else e.appearanceList[i].appearanceImages.push(a)}},a=0;a<this.VrMediaData.length;a++)t(a)},handleCarouselUpload:function(e,t){"100"===e.resultCode&&this.productImageDatas.push({large:e.map[0].large,medium:e.map[0].medium,order:"",source:e.map[0].source,thumbnail:e.map[0].thumbnail,title:t.name})},handleCarouselRemove:function(e){var t=this.productImageDatas.findIndex((function(t){return t.source===e.url}));-1===t?(t=this.productImageDatas.findIndex((function(t){return t.source===e.response.map[0].source})),-1!==t&&this.productImageDatas.splice(t,1)):this.productImageDatas.splice(t,1)},getImage:function(e){return{color:"",fileName:this.getFileName(e),filePath:"",id:"",large:"",mediaType:e,medium:"",sortSn:"",thumbnail:"",title:this.getTitle(e),zipKey:""}},getFileName:function(e){return"interiors"===e?"inside":"space"===e?"size":"diagram"===e?"pictureInfo":"appearance"===e?"car":"testdrive"===e?"drive":"vr"===e?"vr":""},getTitle:function(e){return"interiors"===e?"内饰":"space"===e?"空间":"diagram"===e?"图解":"appearance"===e?"外观":"testdrive"===e?"试驾":"vr"===e?"VR":""},handleVRUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("vr");i.filePath=e.path,this.AddVrData(i);var o=[];o.push({name:e.path,url:e.path}),this.vrFileList=o}},handleVRRemove:function(e,t){this.vrFileList=[];var a=this.VrMediaData.findIndex((function(t){return"vr"===t.mediaType&&t.filePath===e.url}));-1===a?(a=this.VrMediaData.findIndex((function(t){return"vr"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==a&&this.VrMediaData.splice(a,1)):this.VrMediaData.splice(a,1)},handleTestDriveUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("testdrive");i.filePath=e.urls[0],this.AddVrData(i);var o=[];o.push({name:e.urls[0],url:e.urls[0]}),this.testDriverList=o}},handleTestDriveRemove:function(e,t){this.testDriverList=[];var a=this.VrMediaData.findIndex((function(t){return"testdrive"===t.mediaType&&t.filePath===e.url}));-1===a?(a=this.VrMediaData.findIndex((function(t){return"testdrive"===t.mediaType&&t.filePath===e.response.urls[0]})),-1!==a&&this.VrMediaData.splice(a,1)):this.VrMediaData.splice(a,1)},handleInteriorsUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("interiors");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleInteriorsRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"interiors"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"interiors"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleSpaceUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("space");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleSpaceRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"space"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"space"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleDiagramUpload:function(e,t){if("100"===e.resultCode){var a=this.getImage("diagram");a.filePath=e.map[0].source,a.large=e.map[0].large,a.medium=e.map[0].medium,a.thumbnail=e.map[0].thumbnail,this.AddVrData(a)}},handleDiagramRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"diagram"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"diagram"===t.mediaType&&t.filePath===e.response.map[0].source})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},handleAppearanceUpload:function(e,t,a){if("100"===e.resultCode){var i=this.getImage("appearance");i.color=a,i.filePath=e.map[0].large,i.large=e.map[0].large,i.medium=e.map[0].medium,i.thumbnail=e.map[0].thumbnail,i.fileName=e.map[0].fileName,i.source=e.map[0].source,this.AddVrData(i)}},handleAppearanceRemove:function(e){var t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.filePath===e.url}));-1===t?(t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.filePath===e.response.map[0].large})),-1!==t&&this.VrMediaData.splice(t,1)):this.VrMediaData.splice(t,1)},AddVrData:function(e){if("vr"===e.mediaType||"testdrive"===e.mediaType){var t=this.VrMediaData.findIndex((function(t){return t.mediaType===e.mediaType}));-1!==t?this.VrMediaData[t]=e:this.VrMediaData.push(e)}else this.VrMediaData.push(e)},DelVrData:function(e){var t=this.VrMediaData.findIndex((function(t){return t.filePath===e.url}));-1!==t&&this.VrMediaData.splice(t,1)},query:function(){var e=this,t={id:this.id};q["a"].getImageGroups(t,(function(t){e.image=t.image,e.wideImage=t.wideImage,e.VrMediaData=t.VrMediaData,e.productImageDatas=t.productImageDatas,e.updateCarouselImages(),e.updateVrData(),console.log("获取商品图片成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品图片失败",e.id)}))},save:function(){var e=this,t={id:this.id,shopId:window.top.SHOP_ID||"",image:this.image,wideImage:this.wideImage,productImageDatas:this.productImageDatas};q["a"].updateImageGroups(t,(function(t){e.saveVR(!0)}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),e.saveVR(!1),console.log("更新商品轮播主图失败",e.id)}))},saveVR:function(e){var t=this,a={productId:this.id,shopId:window.top.SHOP_ID||"",datas:this.VrMediaData};q["a"].updateProductVrMediaBath(a,(function(e){t.query(),t.$message.success("更新商品图片成功")}),(function(a){""!==a.errorMessage&&t.$message.warning(a.errorMessage),!0===e&&t.query(),console.log("更新商品VR资源失败",t.id)}))},handleClose:function(e){this.appearanceList=this.appearanceList.filter((function(t){return t.name!==e.name}))},hasAppearanceImages:function(e){var t=this.VrMediaData.findIndex((function(t){return"appearance"===t.mediaType&&t.color===e.name}));return-1!==t}}},G=A,F=(a("2acf"),Object(S["a"])(G,B,O,!1,null,null,null)),R=F.exports,W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"commodity-mgmt-parameter"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{size:"small","label-width":"120px",disabled:!e.isEdit,"inline-message":!0}},e._l(e.parameterGroups,(function(t){return a("div",{key:t.id},[a("el-form-item",{staticStyle:{"font-weight":"bold"},attrs:{label:t.name+"："}}),e._l(t.parameters,(function(t){return a("el-form-item",{key:t.id,attrs:{label:t.name+"：",value:t.id}},["1"===t.type?a("el-select",{staticStyle:{width:"80%"},attrs:{clearable:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"parameter.value"}},e._l(e.configureOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.value}})})),1):"2"===t.type?a("el-select",{staticStyle:{width:"80%"},attrs:{filterable:"","allow-create":"",clearable:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"parameter.value"}},e._l(e.assembleOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.value}})})),1):a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入参数"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"parameter.value"}})],1)}))],2)})),0)],1)},U=[],K=a("44e0"),H={name:"CommodityMgmtParameter",components:{BizSaveButton:g["a"],BizGrid:m["a"]},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"}],configureOptions:[{id:"0",name:"-",value:"-"},{id:"1",name:"●",value:"●"},{id:"2",name:"○",value:"○"}],assembleOptions:[{id:"0",name:"主-/副-",value:"主-/副-"},{id:"1",name:"主-/副●",value:"主-/副●"},{id:"2",name:"主-/副○",value:"主-/副○"},{id:"3",name:"主●/副-",value:"主●/副-"},{id:"4",name:"主●/副●",value:"主●/副●"},{id:"5",name:"主●/副○",value:"主●/副○"},{id:"6",name:"主○/副-",value:"主○/副-"},{id:"7",name:"主○/副●",value:"主○/副●"},{id:"8",name:"主○/副○",value:"主○/副○"},{id:"9",name:"前-/后-",value:"前-/后-"},{id:"10",name:"前-/后●",value:"前-/后●"},{id:"11",name:"前-/后○",value:"前-/后○"},{id:"12",name:"前●/后-",value:"前●/后-"},{id:"13",name:"前●/后●",value:"前●/后●"},{id:"14",name:"前●/后○",value:"前●/后○"},{id:"15",name:"前○/后-",value:"前○/后-"},{id:"16",name:"前○/后●",value:"前○/后●"},{id:"17",name:"前○/后○",value:"前○/后○"},{id:"18",name:"自动-",value:"自动-"},{id:"19",name:"自动●",value:"自动●"},{id:"20",name:"自动○",value:"自动○"},{id:"21",name:"手动-",value:"手动-"},{id:"22",name:"手动●",value:"手动●"},{id:"23",name:"手动○",value:"手动○"}],parameterGroups:[]}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"parameter"===e&&""!==this.id&&this.query()},open:function(e){e||(this.parameterGroups=[])}},created:function(){},computed:{},methods:{operate:function(e){this[e]()},query:function(){var e=this,t={id:this.id};K["a"].getParameterGroups(t,(function(t){e.parameterGroups=t.parameterGroups,console.log("获取商品参数成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品参数失败",e.id)}))},save:function(){var e=this,t={id:this.id,parameterGroups:this.parameterGroups};K["a"].updateParameterGroups(t,(function(t){e.query(),e.$message.success("更新商品参数成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("更新商品参数失败",e.id)}))}}},J=H,Y=(a("5682"),Object(S["a"])(J,W,U,!1,null,null,null)),Q=Y.exports,X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"commodity-mgmt-attribute"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.attributeDatas,size:"small"},on:{"selection-change":e.handleSelectChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),a("el-table-column",{attrs:{label:"属性分类",prop:"attributeCategory"}}),a("el-table-column",{attrs:{label:"属性名称",prop:"name"}}),a("el-table-column",{attrs:{label:"是否必输",prop:"isNecessary"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":"1","active-color":"#87d068","inactive-value":"0","inactive-color":"#d9d9d9"},model:{value:t.row.isNecessary,callback:function(a){e.$set(t.row,"isNecessary",a)},expression:"scope.row.isNecessary"}})]}}])})],1)],1)},Z=[],ee=a("1551"),te=a("f260"),ae=a.n(te),ie={name:"CommodityMgmtAttribute",components:{BizSaveButton:g["a"],BizGrid:m["a"]},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"}],attributeDatas:[],selection:[]}},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"attribute"===e&&""!==this.id&&this.query()},open:function(e){e||(this.attributeDatas=[])}},created:function(){},computed:{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+ae.a+") 50% 50% / 300px no-repeat"}}},methods:{operate:function(e){this[e]()},query:function(){var e=this,t={id:this.id};ee["a"].getAttributeGroups(t,(function(t){e.attributeDatas=t.attributeDatas,e.$nextTick((function(){var e=this;t.attributeDatas.forEach((function(t){"1"===t.isCheck&&e.$refs.table.toggleRowSelection(t,!0)}))}))}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品属性失败",e.id)}))},save:function(){var e=this;this.attributeDatas.forEach((function(t,a){t.isCheck="0",e.selection.forEach((function(e,a){t.id===e.id&&(t.isCheck="1")}))}));var t={id:this.id,attributeDatas:this.attributeDatas};ee["a"].updateAttributeGroups(t,(function(t){e.query(),e.$message.success("更新商品属性成功")}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("更新商品属性失败",e.id)}))},handleSelectChange:function(e){this.selection=e}}},oe=ie,ne=(a("007d5"),Object(S["a"])(oe,X,Z,!1,null,null,null)),re=ne.exports,se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"category-mgmt__specification"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}):e._e(),a("el-form",{attrs:{size:"small",disabled:!e.isEdit,"inline-message":!0}},[a("label",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"}},[e._v("请选择商品规格：")]),a("div",{staticStyle:{margin:"15px"}}),a("el-form-item",[a("el-checkbox-group",{staticStyle:{"margin-left":"10px"},on:{change:e.handleCheckedChange},model:{value:e.checkedIds,callback:function(t){e.checkedIds=t},expression:"checkedIds"}},e._l(e.allSpecificationList,(function(t){return a("el-checkbox",{key:t.name,attrs:{label:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.commodityList}},[e._l(e.allSpecificationList,(function(t){return t.checked?a("el-table-column",{key:t.id,attrs:{label:t.name},scopedSlots:e._u([{key:"default",fn:function(i){return e._l(i.row.specificationValueData,(function(i){return a("div",{key:i.id,attrs:{label:i.name}},[a("el-select",{directives:[{name:"show",rawName:"v-show",value:t.id===i.specificationId,expression:"specification.id === valueItem.specificationId"}],attrs:{placeholder:"请选择"},model:{value:i.id,callback:function(t){e.$set(i,"id",t)},expression:"valueItem.id"}},e._l(t.options,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)}))}}],null,!0)}):e._e()})),e.showEditOperationColumn?a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e.isEdit?[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.rowDeleteClickHandler(t.row)}}},[e._v(" 删除 ")])]:void 0}}],null,!0)}):e._e()],2),e.isEdit?a("biz-save-button",{attrs:{operations:e.editOperations},on:{operate:e.operateHandler}}):e._e()],1)},ce=[],le=a("4b5f"),ue={name:"Specification",components:{BizSaveButton:g["a"],BizGrid:m["a"]},data:function(){return{showEditOperationColumn:!1,operations:[{label:"增加规格商品",name:"addSpecificationCommodityOperation",type:"primary",disabled:!0}],editOperations:[{label:"确定",name:"saveSpecificationEditOperation",type:"primary"},{label:"取消",name:"cancelSpecificationEditOperation",type:"primary"}],checkedIds:[],allSpecificationList:[],commodityList:[]}},computed:{},props:{id:{type:String,required:!0},tabSelection:{type:String},open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}}},watch:{tabSelection:function(e){"specification"===e&&""!==this.id&&this.query()},open:function(e){e||(this.checkedIds=[],this.allSpecificationList=[],this.commodityList=[],this.showEditOperationColumn=!1)}},created:function(){},methods:{refresh:function(){this.query()},query:function(){var e=this,t={shopId:window.top.SHOP_ID||"",id:this.id};le["a"].getSpecificationGroups(t,(function(t){e.allSpecificationList=e.getAllSpecificationList(t.categorySpecifications),e.allSpecificationList.length>0?e.operations[0].disabled=!1:e.operations[0].disabled=!0,e.commodityList=e.getCommodityList(t.allProductSpecifications),e.checkedIds=e.sortCheckedIds(),e.handleCheckedChange(e.checkedIds)}),(function(t){e.$message.warning(t.errorMessage)}))},getAllSpecificationList:function(e){var t=this,a=[];return e.forEach((function(e,i){a.push({id:e.id,name:e.name,type:e.type,sort:e.sort,options:t.getSpecificationValueOptions(e.specificationValueData),checked:!1})})),a},getSpecificationValueOptions:function(e){var t=[];return e.forEach((function(e,a){t.push({id:e.id,name:e.name,sort:e.sort,image:e.image,specificationId:e.specificationId})})),t},getCommodityList:function(e){var t=this,a=[];return e.forEach((function(e,i){a.push({productId:e.productData.id,specificationValueData:t.getCommoditySpecificationValueData(e.specificationValueDatas)})})),a},getCommoditySpecificationValueData:function(e){var t=this,a=[];return e.forEach((function(e,i){t.addCheckedIds(e.specificationId),a.push({id:e.id,name:e.name,sort:e.sort,image:e.image,specificationId:e.specificationId})})),a},addCheckedIds:function(e){var t=this.checkedIds.findIndex((function(t){return t===e}));-1===t&&this.checkedIds.push(e)},sortCheckedIds:function(){var e=this,t=[];return this.allSpecificationList.forEach((function(a,i){var o=e.checkedIds.findIndex((function(e){return e===a.id}));-1!==o&&t.push(e.checkedIds[o])})),t},update:function(){var e=this,t=this.getAllProductSpecificationsParams();this.hasProductWithSameSpecification(t)?this.$message.warning("不能创建相同的商品规格"):le["a"].updateSpecificationGroups(t,(function(t){e.$message.success("更新商品规格成功"),e.query(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},hasProductWithSameSpecification:function(e){var t=this,a=!1;return e.forEach((function(i,o){!0!==a&&e.forEach((function(e,o){!0!==a&&i.productData.id!==e.productData.id&&t.isSameSpecificationValueDatas(i.specificationValueDatas,e.specificationValueDatas)&&(a=!0)}))})),a},isSameSpecificationValueDatas:function(e,t){var a=!0;return e.forEach((function(e,i){var o=t.findIndex((function(t){return t.id===e.id}));-1===o&&(a=!1)})),a},getAllProductSpecificationsParams:function(){var e=this,t=[];return this.commodityList.forEach((function(a,i){t.push({productData:e.getProductDataParams(a.productId),specificationValueDatas:e.getSpecificationValueDatasaParams(a.specificationValueData)})})),t},getProductDataParams:function(e){return{id:e,parameterGroups:[],productImages:[],productImageDatas:[],reviews:[],specificationGroups:[]}},getSpecificationValueDatasaParams:function(e){var t=this,a=[];return e.forEach((function(e,i){var o=t.checkedIds.findIndex((function(t){return t===e.specificationId}));-1!==o&&a.push({id:e.id,name:e.name,image:e.image,sort:e.sort,specificationId:e.specificationId})})),a},operateHandler:function(e){this[e]()},rowDeleteClickHandler:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];a.push(e.productId);var i={ids:a};t.commodityList.splice(t.commodityList.indexOf(e),1),c["a"].delete(i,(function(a){t.$message({type:"success",message:"删除成功!"}),t.$emit("operationSuccess"),e.productId===t.id?t.$emit("close"):t.query()}),(function(e){console.log(e)}))})).catch((function(){}))},addSpecificationCommodityOperation:function(){if(!this.showEditOperationColumn)return this.$message.warning("请选择商品规格"),!1;var e={productId:"",specificationValueData:this.getNewSpecificationValueList()};this.commodityList.push(e)},getNewSpecificationValueList:function(){var e=this,t=[];return this.checkedIds.forEach((function(a,i){var o=e.allSpecificationList.findIndex((function(e){return e.id===a}));-1!==o&&t.push({id:"",name:"",image:"",sort:"",specificationId:e.allSpecificationList[o].id})})),t},handleCheckedChange:function(e){var t=this;this.allSpecificationList.forEach((function(a,i){var o=e.findIndex((function(e){return e===a.id}));if(-1!==o)return t.allSpecificationList[i].checked=!0,t.AddNewColumn2Commodity(t.allSpecificationList[i]),!0;t.allSpecificationList[i].checked=!1})),this.showEditOperationColumn=this.hasCheckedSpecification()},hasCheckedSpecification:function(){var e=!1;return this.allSpecificationList.forEach((function(t,a){t.checked&&(e=!0)})),e},AddNewColumn2Commodity:function(e){this.commodityList.forEach((function(t,a){var i=t.specificationValueData.findIndex((function(t){return t.specificationId===e.id}));-1===i&&t.specificationValueData.push({id:"",name:"",image:"",sort:"",specificationId:e.id})}))},saveSpecificationEditOperation:function(){this.update()},cancelSpecificationEditOperation:function(){this.checkedIds=[],this.commodityList=[],this.showEditOperationColumn=!1,this.refresh()}}},de=ue,pe=(a("7bc6"),Object(S["a"])(de,se,ce,!1,null,null,null)),fe=pe.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"coupon-product"},[a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"label-width":"130px",size:"small",model:e.coupon,rules:e.couponRules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"优惠券名称：",prop:"name"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入名称"},model:{value:e.coupon.name,callback:function(t){e.$set(e.coupon,"name",t)},expression:"coupon.name"}})],1),a("el-form-item",{attrs:{label:"面值：",prop:"amount"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入面值"},model:{value:e.coupon.amount,callback:function(t){e.$set(e.coupon,"amount",t)},expression:"coupon.amount"}})],1),a("el-form-item",{attrs:{label:"优惠券数量：",prop:"quantity"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.coupon.quantity,callback:function(t){e.$set(e.coupon,"quantity",t)},expression:"coupon.quantity"}},[a("template",{slot:"append"},[e._v("张")])],2)],1),a("el-form-item",{attrs:{label:"使用门槛："}},[a("el-radio",{attrs:{label:"false"},model:{value:e.coupon.hasMinimumPrice,callback:function(t){e.$set(e.coupon,"hasMinimumPrice",t)},expression:"coupon.hasMinimumPrice"}},[e._v("不限制")]),a("el-radio",{attrs:{label:"true"},model:{value:e.coupon.hasMinimumPrice,callback:function(t){e.$set(e.coupon,"hasMinimumPrice",t)},expression:"coupon.hasMinimumPrice"}},[e._v("限制")])],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"true"===e.coupon.hasMinimumPrice,expression:"coupon.hasMinimumPrice==='true'"}],attrs:{label:"门槛标准：",prop:"minimumPrice"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.coupon.minimumPrice,callback:function(t){e.$set(e.coupon,"minimumPrice",t)},expression:"coupon.minimumPrice"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{attrs:{label:"有效期截止",prop:"endDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择结束时间"},model:{value:e.coupon.endDate,callback:function(t){e.$set(e.coupon,"endDate",t)},expression:"coupon.endDate"}})],1),a("el-form-item",{attrs:{label:"允许参与商品",prop:"participationWay"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.coupon.participationWay,callback:function(t){e.$set(e.coupon,"participationWay",t)},expression:"coupon.participationWay"}},[e._v("全部")]),a("el-radio",{attrs:{label:"3"},model:{value:e.coupon.participationWay,callback:function(t){e.$set(e.coupon,"participationWay",t)},expression:"coupon.participationWay"}},[e._v("按商品")]),a("el-radio",{attrs:{label:"2"},model:{value:e.coupon.participationWay,callback:function(t){e.$set(e.coupon,"participationWay",t)},expression:"coupon.participationWay"}},[e._v("按品牌")]),a("el-radio",{attrs:{label:"1"},model:{value:e.coupon.participationWay,callback:function(t){e.$set(e.coupon,"participationWay",t)},expression:"coupon.participationWay"}},[e._v("按分类")]),a("participation-way",{attrs:{baseInfo:e.baseInfo,participationWay:e.coupon.participationWay},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)],1)],1)},me=[],ge=a("c596"),be=a("7668"),ve={name:"CouponProduct",components:{BizGrid:m["a"],BizSaveButton:g["a"],ParticipationWay:be["a"]},props:{id:{type:String,default:""}},data:function(){return{baseInfo:{},minimumPriceError:"",loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],selectedItems:[],coupon:{name:"",amount:"",hasMinimumPrice:"false",minimumPrice:"",quantity:"1",endDate:"",participationWay:"0"},couponRules:{name:[{required:!0,message:"请输入优惠券名称",trigger:"change"}],amount:[{required:!0,message:"请输入面值",trigger:"change"},{pattern:/^[0-9]+([.]{1}[0-9]{1,2})?$/,message:"请输入数值，保留小数点后两位",trigger:"change"}],quantity:[{required:!0,message:"请输入优惠券数量",trigger:"change"},{pattern:/^\+?[1-9][0-9]*$/,message:"请输入正整数",trigger:"change"}],minimumPrice:[{required:!0,trigger:"change",validator:this.minimumPriceValidator}],endDate:[{required:!0,message:"请选择结束时间",trigger:"change"}]}}},computed:{handledSelectedItems:function(){switch(this.coupon.participationWay){case"0":return{};case"3":return{products:this.selectedItems};case"2":return{shopBrands:this.selectedItems};case"1":return{productCategories:this.selectedItems};default:return{}}},handledBaseInfo:function(){return Object.assign({brands:[]},this.baseInfo)}},watch:{},created:function(){this.getBaseInfo()},methods:{operate:function(e){this[e]()},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.update()}))},update:function(){var e=this,t={id:this.id,coupon:{name:this.coupon.name,amount:this.coupon.amount,quantity:this.coupon.quantity,endDate:this.coupon.endDate,participationWay:this.coupon.participationWay,minimumPrice:"true"===this.coupon.hasMinimumPrice?this.coupon.minimumPrice:""}};Object.assign(t.coupon,this.handledSelectedItems),v["a"].post(ge["g"].productmgmt.CouponProduct,t).then((function(t){e.$message.success("更新优惠券信息成功")})).catch((function(t){e.$message.warning(t.errorMessage)}))},getCouponInfo:function(){var e=this,t={id:this.id};v["a"].get(ge["g"].productmgmt.CouponProduct,t).then((function(t){t=t.data.coupon,e.setSelectedItems(t),e.coupon.name=t.name,e.coupon.amount=t.amount,e.coupon.endDate=t.endDate,e.coupon.quantity=t.quantity,e.coupon.participationWay=t.participationWay,e.coupon.minimumPrice=t.minimumPrice||"",e.coupon.minimumPrice?e.coupon.hasMinimumPrice="true":e.coupon.hasMinimumPrice="false"}))},setSelectedItems:function(e){switch(e.participationWay){case"0":this.selectedItems=[];break;case"3":this.selectedItems=e.products;break;case"2":this.selectedItems=e.shopBrands;break;case"1":this.selectedItems=e.productCategories;break;default:this.selectedItems=[];break}},getBaseInfo:function(){var e=this,t={id:this.id,shopId:window.top.SHOP_ID||""};k["a"].queryProductBasicInfo(t,(function(t){e.baseInfo=t,e.baseInfo.productCategories=t.productCategoryTree,e.getCouponInfo()}),(function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage),console.log("获取商品基本信息失败",e.id)}))},minimumPriceValidator:function(e,t,a){"true"===this.coupon.hasMinimumPrice&&(t||(console.log(t),a(new Error("请输入门槛标准"))),/^[0-9]+([.]{1}[0-9]{1,2})?$/.test(t)||(this.minimumPriceError="请输入数值，保留小数点后两位",a(new Error("请输入数值，保留小数点后两位")))),a()}}},ye=ve,De=(a("3367"),Object(S["a"])(ye,he,me,!1,null,null,null)),Se=De.exports,Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"applicable-product"},[a("biz-flex-table",{ref:"table",staticClass:"class-mgmt-tabel",attrs:{loading:e.loading,operations:e.operations,tableData:e.tableData},on:{operate:e.operateHandler}},[a("el-table-column",{attrs:{prop:"fullName",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"categoryName",label:"分类"}}),a("el-table-column",{attrs:{prop:"brandName",label:"品牌"}}),a("el-table-column",{attrs:{prop:"seriesName",label:"系列"}}),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.deleteHandler(a,t)}}},[e._v("删除")])]}}])})],1),a("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"选择商品",visibility:e.showDialog,tableData:e.giftList,pagination:e.dialogPagination,filters:e.dialogFilters,selectionKeys:e.selectedGiftIds,checkTable:e.checkTable},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.dialogFilterDataChange,selectionChange:e.selectionChange}},[a("el-table-column",{attrs:{property:"fullName",label:"商品名称",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"dialog-column"},[a("img",{staticClass:"productImg",attrs:{src:t.row.image||e.DefaultImg,onerror:e.errorImg}}),a("div",{staticClass:"biz-two-row"},[a("div",{staticClass:"titleClass",staticStyle:{"margin-left":"10px"},attrs:{title:t.row.fullName}},[e._v(e._s(t.row.fullName))]),a("div",{staticStyle:{"margin-left":"10px"}},[e._v("编号："+e._s(t.row.sn))])])])]}}])}),a("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),a("el-table-column",{attrs:{property:"brandName",label:"品牌"}}),a("el-table-column",{attrs:{property:"price",label:"价格"}}),a("el-table-column",{attrs:{label:"库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.realStock))])]}}])})],1)],1)},we=[],Pe=(a("99af"),a("af3f")),Me=a("f3ac"),Ce=a.n(Me),ke={name:"ApplicableProduct",data:function(){return{dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},selectedGiftList:[],selectedGiftIds:[],isApplicableSelected:!1,showDialog:!1,DefaultImg:Ce.a,errorImg:'this.src="/resources/admin/images/default/product-default.png"',dialogFilters:[{type:"input",placeholder:"请输入编号或商品名",name:"searchbar",value:""}],giftList:[],loading:!1,tableData:[],checkTable:[],selections:[],selectionList:[],addProduct:!1,operations:[{label:"添加",name:"add",type:"primary"},{label:"保存",name:"save",type:"primary"}]}},props:{id:{type:String,default:""},tabSelection:{type:String}},components:{BizGrid:m["a"],BizFlexTable:s["c"],BizDialogSelector:Pe["a"]},computed:Object(r["a"])({},Object(l["c"])(["getUser"])),watch:{id:function(e,t){e&&this.refresh()}},methods:{add:function(){this.getGiftList(),this.checkTable=this.tableData,this.selectedGiftIds.splice(0,this.selectedGiftIds.length),this.selectedGiftList.splice(0,this.selectedGiftList.length),this.showDialog=!0},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.getGiftList()},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.getGiftList()},dialogFilterDataChange:function(e){this.dialogFilters=e,this.dialogPagination.currentPage=1,this.getGiftList()},getGiftList:function(){var e=this,t={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||""};v["a"].get(ge["g"].commodity.getCommodityList,t).then((function(t){e.giftList=t.content,e.dialogPagination.total=Number(t.total)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},selectionChange:function(e){var t=this;e.forEach((function(e){-1===t.selectionList.indexOf(e)&&t.selectionList.push(e)}))},confirmedProduct:function(e){var t=this;this.selectedGiftIds=e.concat(),this.selectedGiftList=[],this.selectionList.map((function(e){-1!==t.selectedGiftIds.indexOf(e.id)&&t.selectedGiftList.push(e)})),this.selectedGiftList.forEach((function(e){t.handleSelect(e)}))},handleSelect:function(e){var t=!1;if(e.productId=e.id,0!==this.tableData.length){for(var a=0;a<this.tableData.length;a++)if(this.tableData[a].productId===e.productId){t=!0;break}t||this.tableData.push(e)}else this.tableData.push(e)},refresh:function(){this.getList()},operateHandler:function(e){this[e]()},deleteHandler:function(e,t){e.stopPropagation(),this.deleteItem(t)},deleteItem:function(e){var t=this;""===e.row.id?this.tableData.splice(e.$index,1):this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,v["a"].delete("/admin/productShippingFinancialController/delectProductShippingFinancial.jhtml",{financialPlanId:t.id,productIds:[e.row.id]}).then((function(e){t.loading=!1,t.$message.success("删除成功"),t.getList()})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},getList:function(){var e=this,t={id:this.id,shopId:window.top.SHOP_ID||""};v["a"].get("/admin/productShippingFinancialController/queryFinancialShippingProduct.jhtml",t).then((function(t){e.tableData=t.products})).catch((function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},save:function(){var e=this,t=[];this.tableData.map((function(e){t.push(e.id)}));var a={financialPlanId:this.id,productIds:t};v["a"].post("/admin/productShippingFinancialController/saveProductShippingFinancial.jhtml",a).then((function(t){e.$message.success("保存成功"),e.getList()})).catch((function(t){e.$message.warning(t.errorMessage)}))}},created:function(){this.getList()}},xe=ke,_e=(a("b36a"),Object(S["a"])(xe,Ie,we,!1,null,null,null)),$e=_e.exports,Te={name:"TerminalClassPopup",components:{BizPopupTabs:p["a"],BaseInfo:w,Detail:T,PictureInfo:R,Parameter:Q,Attribute:re,Specification:fe,CouponProduct:Se,ApplicableProduct:$e},props:{baseInfo:{type:Object,default:function(){return{shop:{name:""}}}},open:{type:Boolean},isEdit:{type:Boolean},id:{type:String,default:""}},data:function(){return{tabSelection:"baseinfo"}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)},createdProductSuccess:function(e,t){this.$emit("createdProductSuccess",e,t)}},watch:{open:function(e){e||(this.tabSelection="baseinfo")}}},Be=Te,Oe=Object(S["a"])(Be,u,d,!1,null,null,null),Le=Oe.exports,Ve=a("443b"),ze={name:"FinancialMgmt",data:function(){return{productCategoryId:"",rowBaseInfo:{},loading:!1,defaultImg:"/resources/admin/images/default/product-default.png",errorImg:'this.src="/resources/admin/images/default/product-default.png"',importtabName:"baseinfo",createVehicleTabName:"createVehicle",refreshSign:!0,multipleSelection:[],editShopIds:[],addId:"",open:!1,isEdit:!0,openimport:!1,createVehicle:!1,operations:[{label:"添加",name:"add",type:"primary"},{disabled:!0,label:"删除",name:"deleteList",type:""},{disabled:!0,label:"批量上架",name:"putaway",type:""},{disabled:!0,label:"批量下架",name:"soldout",type:""},{label:"刷新",name:"refresh",type:""},{disabled:!0,label:"克隆",name:"clone",type:""}],filters:[{type:"select",label:"分类",name:"category",value:[],options:[]},{type:"select",label:"金融机构",value:"",options:[]},{type:"select",label:"方案来源",value:"",options:[{value:"",label:"全部"},{value:"录入",label:"录入"},{value:"接收",label:"接收"}]},{type:"select",label:"状态",value:"",options:[{value:"",label:"全部"},{value:"0",label:"已创建"},{value:"1",label:"已提交"},{value:"2",label:"已上架"},{value:"3",label:"已下架"}]},{type:"select",label:"店铺",value:"",options:[]},{type:"input",label:"",placeholder:"请输入编号/名称",value:""}],tableData:[],categoryDatas:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},sortInfo:{}}},components:{BizFlexTable:s["c"],FinancialPopup:Le},mixins:[Ve["a"]],created:function(){this.getUser(),this.refresh(),this.getKpi(),this.queryFinancialFilters(),this.queryFilters(),this.getEditableStores(),this.queryShopList()},mounted:function(){},methods:Object(r["a"])(Object(r["a"])({},Object(l["c"])(["getUser"])),{},{canOnsale:function(e){return!!e.unionConfig&&(!!e.unionConfig.auditConfig&&"1"===e.unionConfig.auditConfig.onsaleable)},canOffsale:function(e){return!!e.unionConfig&&(!!e.unionConfig.auditConfig&&"1"===e.unionConfig.auditConfig.offsaleable)},canEdited:function(e){return!!e.unionConfig&&"1"===e.unionConfig.editable},operate:function(e){this[e]()},refresh:function(){this.getList()},getKpi:function(){var e=this;v["a"].get("/admin/financialProductPlanController/queryFinancialProductPlanCount.jhtml",{shopId:window.top.SHOP_ID||""}).then((function(t){e.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:"已创建金融方案".concat(t.createdCount,"个"),duration:3e3})})).catch((function(t){e.$message.warning(t.errorMessage||"操作出现错误")}))},createdProductSuccess:function(e,t){this.addId=e,this.rowBaseInfo.productType=t},rowClick:function(e){this.refreshSign=!this.refreshSign,this.addId=e.id,"0"===e.unionConfig.editable&&"shop"===this.getUser().roleLevel?this.isEdit=!1:this.isEdit=!0,this.open=!0,this.rowBaseInfo=e},toPrice:function(e){return e=parseFloat(e).toFixed(2).toString().split("."),e[0]=e[0].replace(new RegExp("(\\d)(?=(\\d{3})+$)","ig"),"$1,"),e.join(".")},getEditableStores:function(){var e=this;v["a"].get(ge["j"].editableStores,{resourceType:"2"}).then((function(t){e.editShopIds=[],t.dataList.map((function(t){e.editShopIds.push(t.id)}))})).catch((function(e){console.log(e),console.log("code错误")}))},getList:function(){var e=this,t={productCategoryId:this.filters[0].value,state:this.filters[3].value,searchShopId:this.filters[4].value,searchValue:this.filters[5].value,shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,financialInstitutionId:this.filters[1].value,source:this.filters[2].value};this.loading=!0,v["a"].get("/admin/financialProductPlanController/financialProductPlanList.jhtml",t).then((function(t){e.tableData=t.content,e.pagination.total=Number(t.total),e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage)}))},filterDataChange:function(e){this.pagination.currentPage=1,this.refresh()},add:function(){this.addId="",this.isEdit=!0,this.open=!0},handleSelectionChange:function(e){this.operations[1].disabled=!0,this.operations[3].disabled=!0,this.operations[2].disabled=!0,this.operations[5].disabled=!0,(e.length>0||"shop"!==this.getUser().roleLevel)&&(this.operations[1].disabled=!1,this.operations[3].disabled=!1,this.operations[2].disabled=!1,this.operations[5].disabled=!1),this.multipleSelection=e},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},deleteRecommend:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];a.push(e);var i={ids:a};v["a"].delete("/admin/shopProduct/shopProductItem.jhtml",i).then((function(e){t.$message.success("删除成功"),t.refresh()})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},soldout:function(e){var t=this;this.$confirm("是否确认下架?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];if(e)a.push(e);else{var i,o=Object(n["a"])(t.multipleSelection);try{for(o.s();!(i=o.n()).done;){var r=i.value;a.push(r.id)}}catch(l){o.e(l)}finally{o.f()}}var s={ids:a,state:"false"};c["a"].soldoutAndPutaway(s,(function(e){t.$message({type:"success",message:"下架成功!"}),t.refresh()}),(function(e){console.log(e),t.$message.warning(e.errorMessage)}))})).catch((function(){}))},putaway:function(e){var t=this;this.$confirm("是否确认上架?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];if(e)a.push(e);else{var i,o=Object(n["a"])(t.multipleSelection);try{for(o.s();!(i=o.n()).done;){var r=i.value;a.push(r.id)}}catch(l){o.e(l)}finally{o.f()}}var s={ids:a,state:"true"};c["a"].soldoutAndPutaway(s,(function(e){t.$message({type:"success",message:"上架成功!"}),t.refresh()}),(function(e){console.log(e),t.$message.warning(e.errorMessage)}))})).catch((function(){}))},deleteList:function(){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t,a=[],i=Object(n["a"])(e.multipleSelection);try{for(i.s();!(t=i.n()).done;){var o=t.value;a.push(o.id)}}catch(s){i.e(s)}finally{i.f()}var r={ids:a};v["a"].delete("admin/shopProduct/shopProductItem.jhtml",r).then((function(t){e.$message.success("删除成功"),e.refresh()})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}))},clone:function(){var e,t=this,a=[],i=Object(n["a"])(this.multipleSelection);try{for(i.s();!(e=i.n()).done;){var o=e.value;a.push(o.id)}}catch(s){i.e(s)}finally{i.f()}var r={ids:a};v["a"].post("/admin/financialProductPlanController/cloneProduct.jhtml",r).then((function(e){t.$message({type:"success",message:"克隆成功!"}),t.refresh()})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){}))},getStatus:function(e){switch(e.state){case"0":return"已创建";case"1":return"已提交";case"2":return"已上架";case"3":return"已下架";default:break}return""},filterChange:function(e){this.$refs.table.doLayout()},queryFilters:function(){var e=this;v["a"].get("/admin/financialProductCategory/queryFinancialProductCategoryList.jhtml",{shopId:window.top.SHOP_ID||""}).then((function(t){t.content.forEach((function(t){"finance"===t.type&&e.filters[0].options.push({value:t.id,label:t.name})})),e.filters[0].options.splice(0,0,{value:"",label:"全部"})})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage),e.loading=!1})).finally((function(){e.loading=!1}))},handleSortChange:function(e){console.log("column",e),this.sortInfo={column:e.prop,sort:e.order?"ascending"===e.order?"asc":"desc":void 0},this.getList()},queryFinancialFilters:function(){var e=this;v["a"].get("/admin/financialInstitution/queryFinancialInstitutionList.jhtml",{shopId:window.top.SHOP_ID||""}).then((function(t){t.content.forEach((function(t){"0"===t.type&&e.filters[1].options.push({value:t.id,label:t.name})})),e.filters[1].options.splice(0,0,{value:"",label:"全部"})})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){}))},queryShopList:function(){var e=this;v["a"].get(ge["o"].mainPage.shopList,{shopId:window.top.SHOP_ID||"",sourceType:"4"}).then((function(t){var a=t.shops;a.map((function(e){e.value=e.id,e.label=e.name})),a.unshift({value:"",label:"全部"}),e.$set(e.filters[4],"options",a)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)}))}})},Ee=ze,Ne=(a("a5b9"),Object(S["a"])(Ee,i,o,!1,null,null,null));t["default"]=Ne.exports},e725:function(e,t,a){},ea80:function(e,t,a){},ec6b:function(e,t,a){"use strict";var i=a("b547"),o=a.n(i);o.a},f3ac:function(e,t,a){e.exports=a.p+"static/img/pic_default_none_100.6603f4ac.png"},f588:function(e,t,a){},f813:function(e,t,a){"use strict";var i=a("74f0"),o=a.n(i);o.a}}]);