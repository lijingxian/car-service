(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c6b2efcc"],{"13a8":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"expandTable",staticClass:"expand-table",staticStyle:{width:"100%","min-height":"100%"},attrs:{size:"small","tooltip-effect":"dark","row-key":"id",height:t.height,border:t.showBorder,data:t.data,"show-header":t.showHeader,"expand-row-keys":t.expandedRowKeys,rowClassName:t.setClassName,"cell-class-name":t.cellClassName},on:{"expand-change":t.expandChangeHandler,"row-click":t.rowClickHandler,"selection-change":t.handleSelectionChange,deleteCategory:t.deleteCategory,moveUp:t.moveUp,moveDown:t.moveDown}},[a("el-table-column",{attrs:{type:"expand",label:t.maxLevel,width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.childrenProductCategoryDataList.length>0?a("expand-table",{staticClass:"expand-table-child",attrs:{height:"auto",layer:t.layer+1,data:e.row.childrenProductCategoryDataList,"show-header":!1,"show-border":!1,"expand-row-keys":t.expandedRowKeys},on:{deleteCategory:t.deleteCategory,"expand-change":t.expandChangeHandler,"row-click":t.rowClickHandler,"selection-change":t.handleSelectionChange,moveUp:t.moveUp,moveDown:t.moveDown}}):t._e()]}}])}),a("el-table-column",{attrs:{label:"产品分类","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[t._v("分类名称："+t._s(e.row.name))]),a("div",{staticClass:"overflow"},[t._v("分类类型："+t._s(t.typeFormatter(e.row)))])])]}}])}),a("el-table-column",{attrs:{prop:"childrenProductCategoryDataList",label:"参数"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.parameterGroupDataList,(function(a,i){return[t._v(" "+t._s(a.name)+" "),i<e.row.parameterGroupDataList.length-1?[t._v(t._s(t.separator))]:t._e()]}))]}}])}),a("el-table-column",{attrs:{prop:"childrenProductCategoryDataList",label:"属性"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.attributeDataList,(function(a,i){return[t._v(" "+t._s(a.name)+" "),i<e.row.attributeDataList.length-1?[t._v(t._s(t.separator))]:t._e()]}))]}}])}),a("el-table-column",{attrs:{prop:"childrenProductCategoryDataList",label:"规格"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.specificationDataList,(function(a,i){return[t._v(" "+t._s(a.name)+" "),i<e.row.specificationDataList.length-1?[t._v(t._s(t.separator))]:t._e()]}))]}}])}),a("el-table-column",{attrs:{width:"160",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("biz-column-operation",{attrs:{row:e.row}},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){a.stopPropagation(),e.row.id!==t.data[0].id&&t.moveUp(e.row)}}},[t._v("上移")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){a.stopPropagation(),e.row.id!==t.data[t.data.length-1].id&&t.moveDown(e.row)}}},[t._v("下移 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.deleteCategory(e.row)}}},[t._v("删除")])],1)]}}])})],1)},r=[],n=(a("cb29"),a("4160"),a("a15b"),a("a9e3"),a("ac1f"),a("1276"),a("159b"),a("5530")),o=a("2f62"),s=a("443b"),l={name:"ExpandTable",filters:{formatToMark:function(t){return isNaN(t)?t:Number(t)?"√":"X"}},props:{showHeader:{type:Boolean,default:!0},hasChild:{type:String,default:"1"},data:{type:Array,default:function(){return[]}},height:{type:String,default:"100%"},loading:{type:Boolean,default:!1},showBorder:{type:Boolean,default:!1},layer:{type:Number,default:0},expandedRowKeys:{type:Array,default:function(){return[]}}},data:function(){return{maxLevel:"1",separator:"、",className:"",selections:[],selectionsChild:[]}},components:{},computed:Object(n["a"])({},Object(o["c"])("Authority",["currentAuth"])),mixins:[s["a"]],watch:{},mounted:function(){var t=document.documentElement.clientHeight||window.innerHeight,e=String(t-185);document.querySelectorAll(".el-table__body-wrapper")[0].style.height=e+"px",document.querySelectorAll(".el-table__body-wrapper")[0].style.overflowX="hidden",document.querySelectorAll(".el-table__body-wrapper")[0].style.overflowY="auto"},updated:function(){this.doLayout()},methods:{typeFormatter:function(t){switch(t.type){case"finance":return"金融";case"carInsurance":return"车险";case"extensionInsurance":return"延保";case"travelInsurance":return"旅行";case"propertyInsurance":return"财产";case"healthInsurance":return"健康";case"lifeInsurance":return"人寿";default:break}},setClassName:function(t){var e=t.row;t.index;return e.childrenProductCategoryDataList&&e.childrenProductCategoryDataList.length>0?"expand":"noexpand"},cellClassName:function(t){var e=t.row;t.column,t.rowIndex,t.columnIndex;return"row"+e.id},showUp:function(t){return!this.data[0]||t.id!==this.data[0].id},showDown:function(t){return!this.data[0]||t.id!==this.data[this.data.length-1].id},doLayout:function(){document.querySelectorAll(".expand-table-child .el-table__body-wrapper").forEach((function(t){t.style.height="auto"})),document.querySelectorAll(".el-table__expand-icon").forEach((function(t){t.children[0].className="iconfont biz-icon-i-web-zk1"}))},formatTreeLayer:function(t,e){var a=[];return e&&(a.push(new Array(e).fill("|").join(" ")),a.push("--")),a.push(t),a.join("")},expandChangeHandler:function(t,e){this.doLayout();var a=[];if(t.treeLevel>0){for(var i=0;i<=t.treeLevel;i++)a.push(i+1);this.maxLevel=a.join(" ")}this.className&&this.className.split(".")[1]!=="row"+t.id&&(document.querySelector(this.className).children[0].children[0].style.color="#666666"),this.className=".row"+t.id,document.querySelector(this.className).children[0].children[0].style.color="#ff7300",e&&0===e.length&&(this.maxLevel="1"),console.log(this.$refs.expandTable),this.$emit("expand-change",t)},rowClickHandler:function(t){this.$emit("row-click",t)},deleteFunction:function(t){this.$emit("delete",t)},handleSelectionChange:function(t){this.selections=t,this.$emit("selection-change",t)},deleteCategory:function(t){this.$emit("deleteCategory",t)},moveUp:function(t){this.$emit("moveUp",t)},moveDown:function(t){this.$emit("moveDown",t)}}},c=l,u=(a("b400"),a("2877")),d=Object(u["a"])(c,i,r,!1,null,null,null);e["a"]=d.exports},1498:function(t,e,a){"use strict";var i=a("9e84"),r=a.n(i);r.a},2497:function(t,e,a){"use strict";var i=a("4360"),r=a("a18c");e["a"]=function(t,e){return function(a){var n=a.data;"100"===n.resultCode?t(n):"709"===n.resultCode?(i["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",i["a"].getters.currentUser),r["a"].push("/login")):e(n)}}},"25eb":function(t,e,a){var i=a("23e7"),r=a("c20d");i({target:"Number",stat:!0,forced:Number.parseInt!=r},{parseInt:r})},"2a09":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-popup-tabs",{attrs:{open:t.open,value:t.tabName},on:{close:t.close}},[a("el-tab-pane",{attrs:{label:"分类",name:"Category"}},[a("category-setting",{attrs:{open:t.open,isEdit:t.isEdit,itemId:t.itemId},on:{operationSuccess:t.operationSuccess,createdCategorySuccess:t.createdCategorySuccess}})],1),t.itemId?a("el-tab-pane",{attrs:{label:"参数",name:"Parameter"}},[a("parameter-setting",{attrs:{itemId:t.itemId,isEdit:t.isEdit},on:{operationSuccess:t.operationSuccess}})],1):t._e(),t.itemId?a("el-tab-pane",{attrs:{label:"属性",name:"Attribute"}},[a("attribute-setting",{attrs:{itemId:t.itemId,itemType:t.itemType,isEdit:t.isEdit},on:{operationSuccess:t.operationSuccess}})],1):t._e(),t.itemId?a("el-tab-pane",{attrs:{label:"规格",name:"Specification"}},[a("specification-setting",{attrs:{itemId:t.itemId,itemType:t.itemType,isEdit:t.isEdit},on:{operationSuccess:t.operationSuccess}})],1):t._e(),t.itemId?a("el-tab-pane",{attrs:{label:"计算",name:"Compute"}},[a("compute-setting",{attrs:{itemId:t.itemId,itemType:t.itemType,isEdit:t.isEdit},on:{operationSuccess:t.operationSuccess}})],1):t._e()],1)},r=[],n=a("7132"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"category-mgmt__category-setting"},[a("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operateHandler},slot:"top"}),a("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:t.productCategory,rules:t.rules}},[a("el-form-item",{attrs:{label:"分类名称:",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入1-20字分类名称"},model:{value:t.productCategory.name,callback:function(e){t.$set(t.productCategory,"name",e)},expression:"productCategory.name"}})],1),a("el-form-item",{attrs:{label:"上级分类:",prop:"parentId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择上级分类",disabled:t.hasChild()},on:{change:t.changeParentId},model:{value:t.productCategory.parentId,callback:function(e){t.$set(t.productCategory,"parentId",e)},expression:"productCategory.parentId"}},t._l(t.productCategoryList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(!0===e.topCategory?e.name:""))]),a("span",{staticStyle:{float:"right"}},[t._v(t._s(!1===e.topCategory?e.name:""))])])})),1)],1),a("el-form-item",{attrs:{label:"类型:",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型",disabled:t.hasParent()},on:{change:t.typeChange},model:{value:t.productCategory.type,callback:function(e){t.$set(t.productCategory,"type",e)},expression:"productCategory.type"}},t._l(t.typeList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"logo：",prop:"logo"}},[a("BizAvatarUploaderNew",{model:{value:t.productCategory.logo,callback:function(e){t.$set(t.productCategory,"logo",e)},expression:"productCategory.logo"}})],1)],1)],1)},s=[],l=(a("c740"),a("4160"),a("b0c0"),a("d3b7"),a("159b"),a("b85c")),c=a("5530"),u=a("f36f"),d=a("8330"),p=a("c17f"),f=a("1ab1"),m=a("2f62"),h={agriculturalPurchasing:"/resources/admin/images/productCategory/agriculturalPurchasing.jpg",car:"/resources/admin/images/productCategory/car.jpg",carProduct:"/resources/admin/images/productCategory/carProduct.jpg",carService:"/resources/admin/images/productCategory/carService.jpg",departmentMarket:"/resources/admin/images/productCategory/departmentMarket.jpg",eatGoodFood:"/resources/admin/images/productCategory/eatGoodFood.jpg",flowerBirdEntertainment:"/resources/admin/images/productCategory/flowerBirdEntertainment.jpg",footwearBags:"/resources/admin/images/productCategory/footwearBags.jpg",homeApplianceOffice:"/resources/admin/images/productCategory/homeApplianceOffice.jpg",homeTextile:"/resources/admin/images/productCategory/homeTextile.jpg",jewelryAccessories:"/resources/admin/images/productCategory/jewelryAccessories.jpg",lifeService:"/resources/admin/images/productCategory/lifeService.jpg",moreService:"/resources/admin/images/productCategory/moreService.jpg",motherBabySupplies:"/resources/admin/images/productCategory/motherBabySupplies.jpg",outdoorSport:"/resources/admin/images/productCategory/outdoorSport.jpg",phoneDigital:"/resources/admin/images/productCategory/phoneDigital.jpg",skinMakeup:"/resources/admin/images/productCategory/skinMakeup.jpg",womenWear:"/resources/admin/images/productCategory/womenWear.jpg"},g={name:"CategorySetting",components:{BizAvatarUploaderNew:p["b"],BizSaveButton:d["a"],BizGrid:u["a"]},data:function(){return{operations:[{label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],parentId:[{required:!0,message:"请选择上级分类",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"blur"}]},productCategory:this.getDefaultProductCategory(),brands:[],productCategoryList:[],allCategoryList:[],typeList:[],options:[]}},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!1}},open:{type:Boolean}},created:function(){this.getCategory()},methods:Object(c["a"])(Object(c["a"])({},Object(m["c"])(["getUser"])),{},{getCategory:function(){var t=this,e={id:this.itemId,shopId:this.getUser().shop.id||window.top.SHOP_ID||""};f["a"].get("/admin/financialProductCategory/financialCategoryQuery.jhtml",e).then((function(e){t.allCategoryList=e.productCategoryTree,t.productCategoryList=t.getTopCategoryList(e.productCategoryTree),t.typeList=e.productCategoryType;var a=e.productCategory;a.parentId=""===e.productCategory.parentId?"-1":e.productCategory.parentId,a.logo||(a.logo=h[a.type]),t.productCategory=a})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},query:function(){var t=this,e={id:this.itemId};f["a"].get("/admin/financialProductCategory/queryFinancialProductCategory.jhtml",e).then((function(e){var a=e.productCategory;a.parentId=""===e.productCategory.parentId?"-1":e.productCategory.parentId,a.logo||(a.logo=h[a.type]),t.productCategory=a})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},typeChange:function(t){this.productCategory.logo=h[t]},getDefaultProductCategory:function(){return{id:"",name:"",type:"",parentId:"",topCategory:""}},getDefaultTopCategory:function(){return{id:"-1",name:"顶级分类",type:"",parentId:"-1",topCategory:!0}},getTopCategoryList:function(t){var e=[];e.push(this.getDefaultTopCategory());var a,i=Object(l["a"])(t);try{for(i.s();!(a=i.n()).done;){var r=a.value;!0===r.topCategory&&e.push(r)}}catch(n){i.e(n)}finally{i.f()}return e},operateHandler:function(t){this[t]()},save:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;var a=t.getSaveParams();if(t.hasSameNameProductCategory(a))return t.$message.warning("分类名称已存在"),!1;t.productCategory.id?f["a"].put("/admin/financialProductCategory/updateFinancialProductCategory.jhtml",a).then((function(e){t.$message.success("更新分类成功"),t.$emit("operationSuccess"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1})):f["a"].post("/admin/financialProductCategory/createFinancialProductCategory.jhtml",a).then((function(e){t.$message.success("添加分类成功"),t.$emit("operationSuccess"),t.$emit("createdCategorySuccess",e.id)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},getSaveParams:function(){return{id:this.productCategory.id,name:this.productCategory.name,type:this.productCategory.type,logo:this.productCategory.logo,parentId:this.productCategory.parentId}},hasSameNameProductCategory:function(t){var e=this.allCategoryList.findIndex((function(e){return e.name===t.name}));return-1!==e&&this.allCategoryList[e].id!==t.id},changeParentId:function(t){var e=this;this.allCategoryList.forEach((function(a){a.id===t&&(e.productCategory.type=a.type)}))},hasChild:function(){var t=this;if(""===this.productCategory.id||"-1"===this.productCategory.id)return!1;var e=this.allCategoryList.findIndex((function(e){return e.parentId===t.productCategory.id}));return-1!==e},hasParent:function(){return"-1"!==this.productCategory.parentId&&""!==this.productCategory.parentId}}),computed:{},watch:{itemId:function(t){t?this.query():this.productCategory=this.getDefaultProductCategory()},open:function(t){t||(this.productCategory=this.getDefaultProductCategory(),this.getCategory(),this.productCategoryList=[],this.typeList=[],this.allCategoryList=[])}}},b=g,v=(a("9931"),a("2877")),D=Object(v["a"])(b,o,s,!1,null,null,null),y=D.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"category-mgmt__parameter-setting"},[t.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operateHandler},slot:"top"}):t._e(),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.parameterDataList,size:"small"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"name",label:"参数分类","min-width":"100"}}),a("el-table-column",{attrs:{prop:"sort",label:"排序","min-width":"50"}}),a("el-table-column",{attrs:{prop:"parameters",label:"参数"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.parameters,(function(a,i){return[t._v(" "+t._s(a.name)+" "),i<e.row.parameters.length-1?[t._v(t._s(t.separator))]:t._e()]}))]}}])}),a("el-table-column",{attrs:{prop:"title",label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.rowDeleteClickHandler(e.row)}}},[t._v(" 删除 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.rowEditClickHandler(e.row)}}},[t._v(" 编辑 ")])]}}])})],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showParameterDataEditor,expression:"showParameterDataEditor"}],ref:"parameterDataForm",attrs:{size:"small","label-width":"110px",model:t.parameterData,rules:t.parameterDataFormRules,"inline-message":!0}},[a("el-form-item",{attrs:{prop:"name",label:"名称:"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:t.parameterData.name,callback:function(e){t.$set(t.parameterData,"name",e)},expression:"parameterData.name"}})],1),a("el-form-item",{attrs:{label:"排序:"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入排序"},model:{value:t.parameterData.sort,callback:function(e){t.$set(t.parameterData,"sort",e)},expression:"parameterData.sort"}})],1),a("el-form-item",{attrs:{prop:"parameters",label:"参数"}},[t._l(t.parameterData.parameters,(function(e){return a("el-tag",{key:e.id,staticStyle:{"margin-right":"5px"},attrs:{size:"small",closable:"","disable-transitions":!0,type:"warning"},on:{close:function(a){return t.handleTagClose(e)}},nativeOn:{click:function(a){return t.handleTagClick(e)}}},[t._v(" "+t._s(e.name)+" ")])})),a("el-button",{attrs:{icon:"el-icon-plus",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.handleAddParameterInfo(e)}}})],2)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showParameterInfoEditor,expression:"showParameterInfoEditor"}],ref:"parameterInfoForm",attrs:{size:"small","label-width":"110px",model:t.parameterInfo,rules:t.parameterInfoFormRules,"inline-message":!0}},[a("el-form-item",{attrs:{prop:"name",label:"参数名称: "}},[a("el-input",{attrs:{placeholder:"请输入参数名称"},model:{value:t.parameterInfo.name,callback:function(e){t.$set(t.parameterInfo,"name",e)},expression:"parameterInfo.name "}})],1),a("el-form-item",{attrs:{prop:"type",label:"类型: "}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择型"},model:{value:t.parameterInfo.type,callback:function(e){t.$set(t.parameterInfo,"type",e)},expression:"parameterInfo.type "}},t._l(t.parameterInfoTypeList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1)},C=[],I=(a("4de4"),a("a9e3"),a("8316")),S={name:"ParameterSetting",components:{BizSaveButton:d["a"],BizGrid:u["a"]},data:function(){return{operations:[{label:"添加",name:"add",type:"primary"},{label:"保存",name:"save",type:"primary"}],parameterDataFormRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]},parameterInfoFormRules:{name:[{required:!0,message:"请输入参数名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:["blur","change"]}]},showParameterDataEditor:!1,showParameterInfoEditor:!1,parameterInfoTypeList:[],parameterDataList:[],parameterData:this.getDefaultParameterData(),parameterInfo:this.getDefaultParameterInfo(),separator:"、"}},computed:{},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},created:function(){this.query()},methods:{handleSelectionChange:function(t){this.operations[1].disabled=!0,t.length>0&&(this.operations[1].disabled=!1)},getDefaultParameterData:function(){return{id:"",name:"",sort:"",parameters:[],productCategoryId:""}},getDefaultParameterInfo:function(){return{id:"",name:"",type:""}},operateHandler:function(t){this[t]()},rowEditClickHandler:function(t){var e=this;!1===this.showParameterDataEditor&&(this.showParameterDataEditor=!0),this.parameterData.id!==t.id&&(this.parameterData=this.changeParameterData(t),this.hideParameterInfoEditor()),this.$nextTick((function(){e.$refs.parameterDataForm.$el["0"].focus()}))},changeParameterData:function(t){return{id:t.id,name:t.name,sort:t.sort,parameters:t.parameters,productCategoryId:t.productCategoryId}},add:function(){var t=this;!1===this.showParameterDataEditor&&(this.showParameterDataEditor=!0),this.hideParameterInfoEditor(),this.parameterData=this.getDefaultParameterData(),this.$nextTick((function(){t.$refs.parameterDataForm.$el["0"].focus()}))},hideParameterDataEditor:function(){!0===this.showParameterDataEditor&&(this.showParameterDataEditor=!1,this.parameterData=this.getDefaultParameterData(),this.hideParameterInfoEditor())},hideParameterInfoEditor:function(){!0===this.showParameterInfoEditor&&(this.showParameterInfoEditor=!1,this.parameterInfo=this.getDefaultParameterInfo())},save:function(){!0===this.showParameterInfoEditor?this.handlerParameterInfo():!0===this.showParameterDataEditor&&this.handlerParameterData()},handlerParameterData:function(){var t=this;this.$refs.parameterDataForm.validate((function(e){if(!e)return!1;var a=t.getParameterData();if(t.hasSameNameParameterData(a))return t.$message.warning("参数分类名称已存在"),!1;a.id?(console.log("parameterData变更"),t.updateParameterData(a)):(console.log("parameterData添加"),t.saveParameterData(a))}))},handlerParameterInfo:function(){var t=this;this.$refs.parameterDataForm.validate((function(e){if(!e)return!1;t.$refs.parameterInfoForm.validate((function(e){if(!e)return!1;var a=t.getParameterInfo(),i=t.getParameterData(),r=i.parameters.findIndex((function(t){return t.id===a.id}));return t.hasSameNameParameterData(i)?(t.$message.warning("参数分类名称已存在"),!1):t.hasSameNameParameterInfo(a,i.parameters)?(t.$message.warning("参数名称已存在"),!1):(-1===r?(console.log("ParameterInfo添加"),i.parameters.push(a)):(console.log("ParameterInfo变更"),i.parameters[r]=a),void(i.id?t.updateParameterData(i):t.saveParameterData(i)))}))}))},handleTagClose:function(t){var e=this,a=this.parameterDataList.findIndex((function(t){return t.id===e.parameterData.id}));if(-1!==a){var i={id:this.parameterDataList[a].id,name:this.parameterDataList[a].name,sort:this.parameterDataList[a].sort,parameters:this.parameterDataList[a].parameters,productCategoryId:this.parameterDataList[a].productCategoryId};i.parameters=i.parameters.filter((function(e){return e.id!==t.id})),this.hideParameterInfoEditor(),this.updateParameterData(i)}else console.log("关闭Tag所属的参数在参数列中不存在")},handleTagClick:function(t){!1===this.showParameterInfoEditor&&(this.showParameterInfoEditor=!0),this.parameterInfo.id=t.id,this.parameterInfo.name=t.name,this.parameterInfo.type=t.type},handleAddParameterInfo:function(){!1===this.showParameterInfoEditor&&(this.showParameterInfoEditor=!0),this.parameterInfo=this.getDefaultParameterInfo()},updateParameterData:function(t){var e=this;console.log("变更前parameterData",this.parameterData),console.log("参数parameterData",t),I["a"].updateCategoryParameter(t,(function(t){console.log("更新参数分类成功",t.id),e.$message.success("更新参数分类成功"),e.$emit("operationSuccess"),e.hideParameterInfoEditor(),e.query()}),(function(t){console.log("更新参数分类失败"),e.$message.warning(t.errorMessage)}))},saveParameterData:function(t){var e=this;console.log("保存前parameterData",this.parameterData),console.log("参数parameterData",t),""===t.productCategoryId&&(t.productCategoryId=this.itemId),I["a"].saveCategoryParameter(t,(function(t){console.log("添加参数分类成功",t.id),e.$message.success("添加参数分类成功"),e.parameterData=e.getDefaultParameterData(),e.$emit("operationSuccess"),e.parameterData.id=t.id,e.query(),e.$nextTick((function(){this.hideParameterDataEditor()}))}),(function(t){console.log("添加参数分类失败"),e.$message.warning(t.errorMessage)}))},query:function(){var t=this;console.log("查询分类的参数",this.itemId);var e={id:Number(this.itemId),shopId:window.top.SHOP_ID||""};I["a"].getCategoryParameter(e,(function(e){console.log("查询分类的参数成功",e),t.parameterDataList=e.parameterGroups,t.parameterInfoTypeList=e.allParameterType,!0===t.showParameterDataEditor&&(t.parameterData=t.getParameterDataFromList(t.parameterData.id))}),(function(e){console.log("查询分类的参数失败",t.itemId),console.log(e),t.$message.warning(e.errorMessage)}))},getParameterDataFromList:function(t){var e=this.parameterDataList.findIndex((function(e){return e.id===t}));return-1!==e?{id:this.parameterDataList[e].id,name:this.parameterDataList[e].name,sort:this.parameterDataList[e].sort,parameters:this.parameterDataList[e].parameters,productCategoryId:this.parameterDataList[e].productCategoryId}:(console.log("新添加的参数在分类中没有找到",this.parameterData.id),this.getDefaultParameterData())},rowDeleteClickHandler:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];a.push(t.id);var i={ids:a};I["a"].deleteCategoryParameter(i,(function(t){e.$message({type:"success",message:"删除成功!"}),e.$emit("operationSuccess"),e.hideParameterDataEditor(),e.query()}),(function(t){console.log("删除失败",t),e.$message.warning(t.errorMessage)}))})).catch((function(){}))},getParameterData:function(){return{id:this.parameterData.id,name:this.parameterData.name,sort:this.parameterData.sort,parameters:this.parameterData.parameters,productCategoryId:this.parameterData.productCategoryId}},getParameterInfo:function(){return{id:this.parameterInfo.id,name:this.parameterInfo.name,type:this.parameterInfo.type}},hasSameNameParameterData:function(t){var e=this.parameterDataList.findIndex((function(e){return e.name===t.name}));return-1!==e&&this.parameterDataList[e].id!==t.id},hasSameNameParameterInfo:function(t,e){var a=e.findIndex((function(e){return e.name===t.name}));return-1!==a&&e[a].id!==t.id}},watch:{itemId:function(t){console.log("ParameterSetting::watch() Val:",t),this.hideParameterDataEditor(),this.parameterInfoTypeList=[],this.parameterDataList=[],this.query()}}},x=S,P=(a("eae2"),Object(v["a"])(x,w,C,!1,null,null,null)),_=P.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"category-mgmt__attribute-setting"},[t.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operateHandler},slot:"top"}):t._e(),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.attributeDataList,size:"small"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{label:"属性名称",prop:"attributeData.name","min-width":"80"}}),a("el-table-column",{attrs:{label:"属性类型",prop:"attributeData.attributeType","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",[t._v(" "+t._s("0"===e.row.attributeData.attributeType?"文本":"1"===e.row.attributeData.attributeType?"数值":"2"===e.row.attributeData.attributeType?"列表":"3"===e.row.attributeData.attributeType?"单选":"4"===e.row.attributeData.attributeType?"多选":"5"===e.row.attributeData.attributeType?"日期":"图片")+" ")])])}}])}),a("el-table-column",{attrs:{label:"属性分类",prop:"attributeData.attributeCategory","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",[t._v(t._s("0"===e.row.attributeData.attributeCategory?"其他":"1"===e.row.attributeData.attributeCategory?"会员信息":"2"===e.row.attributeData.attributeCategory?"车辆信息":"驾驶证"))])])}}])}),a("el-table-column",{attrs:{label:"属性含义",prop:"attributeData.attributeMeaning","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",[t._v(" "+t._s("0"===e.row.attributeData.attributeMeaning?"其他":"1"===e.row.attributeData.attributeMeaning?"会员姓名":"2"===e.row.attributeData.attributeMeaning?"会员电话":"3"===e.row.attributeData.attributeMeaning?"会员性别":"4"===e.row.attributeData.attributeMeaning?"会员出生日期":"5"===e.row.attributeData.attributeMeaning?"身份证号":"6"===e.row.attributeData.attributeMeaning?"身份证正面照片":"7"===e.row.attributeData.attributeMeaning?"身份证反面照片":"8"===e.row.attributeData.attributeMeaning?"车辆":"9"===e.row.attributeData.attributeMeaning?"车辆价格":"10"===e.row.attributeData.attributeMeaning?"车牌号":"11"===e.row.attributeData.attributeMeaning?"车辆品牌":"12"===e.row.attributeData.attributeMeaning?"车辆车系":"13"===e.row.attributeData.attributeMeaning?"车辆车型":"14"===e.row.attributeData.attributeMeaning?"车辆识别代码":"15"===e.row.attributeData.attributeMeaning?"车辆发动机号":"16"===e.row.attributeData.attributeMeaning?"车辆注册日期":"17"===e.row.attributeData.attributeMeaning?"驾驶证号":"18"===e.row.attributeData.attributeMeaning?"初次领证日期":"19"===e.row.attributeData.attributeMeaning?"有效起始日期":"20"===e.row.attributeData.attributeMeaning?"有效期限":"驾驶证照片")+" ")])])}}])}),a("el-table-column",{attrs:{label:"排序",prop:"attributeData.sort","min-width":"80"}}),a("el-table-column",{attrs:{label:"属性值",prop:"attributeData.options","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.attributeData.options,(function(a,i){return[t._v(" "+t._s(a)+" "),i<e.row.attributeData.options.length-1?[t._v(t._s(t.separator))]:t._e()]}))]}}])}),a("el-table-column",{attrs:{prop:"title",label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.rowDeleteClickHandler(e.row)}}},[t._v("删除")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.rowEditClickHandler(e.row)}}},[t._v("编辑")])]}}])})],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showAttributeDataEditor,expression:"showAttributeDataEditor"}],ref:"attributeDataForm",attrs:{size:"small","label-width":"110px",model:t.attributeData,rules:t.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"属性名称: ",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入属性名称"},model:{value:t.attributeData.name,callback:function(e){t.$set(t.attributeData,"name",e)},expression:"attributeData.name"}})],1),a("el-form-item",{attrs:{label:"属性类型: ",prop:"attributeType"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.attributeChange},model:{value:t.attributeData.attributeType,callback:function(e){t.$set(t.attributeData,"attributeType",e)},expression:"attributeData.attributeType"}},t._l(t.typeList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"属性分类: ",prop:"attributeCategory"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.attributeCategoryChange},model:{value:t.attributeData.attributeCategory,callback:function(e){t.$set(t.attributeData,"attributeCategory",e)},expression:"attributeData.attributeCategory"}},t._l(t.categoryList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"属性含义: ",prop:"attributeMeaning"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.attributeMeaning},model:{value:t.attributeData.attributeMeaning,callback:function(e){t.$set(t.attributeData,"attributeMeaning",e)},expression:"attributeData.attributeMeaning"}},t._l(t.meanList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"排序: ",prop:"sort"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入排序"},model:{value:t.attributeData.sort,callback:function(e){t.$set(t.attributeData,"sort",e)},expression:"attributeData.sort"}})],1),a("el-form-item",{attrs:{label:"属性值: ",prop:"options"}},[t._l(t.attributeData.options,(function(e,i){return a("el-tag",{key:i,staticStyle:{"margin-right":"5px"},attrs:{size:"small",closable:"","disable-transitions":!0,type:"warning"},on:{close:function(e){return t.handleTagClose(i)}}},[t._v(t._s(e))])})),a("el-button",{attrs:{icon:"el-icon-plus",size:"small"},on:{click:function(e){return e.stopPropagation(),t.handleAddAttributeValue(e)}}})],2)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showAttributeValueEditor,expression:"showAttributeValueEditor"}],ref:"attributeValueForm",attrs:{size:"small","label-width":"110px",model:t.attributeValueData,rules:t.rules}},[a("el-form-item",{attrs:{label:"属性值名称: ",prop:"valueName"}},[a("el-input",{attrs:{placeholder:"请输入属性值名称"},model:{value:t.attributeValueData.valueName,callback:function(e){t.$set(t.attributeValueData,"valueName",e)},expression:"attributeValueData.valueName"}}),a("el-button",{attrs:{type:"primary"},on:{click:t.addNewTag}},[t._v("添加")])],1)],1)],1)},V=[],$=(a("99af"),a("caad"),a("c975"),a("d81d"),a("fb6a"),a("a434"),a("6062"),a("2532"),a("3ca3"),a("498a"),a("ddb0"),a("2909")),M=a("f562"),E={name:"AttributeSetting",components:{BizSaveButton:d["a"],BizGrid:u["a"]},data:function(){return{operations:[{label:"添加",name:"addAttributeOperate",type:"primary"},{label:"保存",name:"saveAttributeOperate",type:"primary"}],rules:{name:[{required:!0,message:"请输入属性名称",trigger:"blur"}],attributeMeaning:[{required:!0,trigger:"blur",message:"请输入属性含义"}],attributeType:[{required:!0,message:"请输入属性类型",trigger:"blur"}],attributeCategory:[{required:!0,message:"请输入属性分类",trigger:"blur"}]},showAttributeDataEditor:!1,showAttributeValueEditor:!1,attributeDataList:[],typeList:[],categoryList:[],meanList:[],attributeData:this.getDefaultAttributeData(),attributeValueData:this.getDefaultAttributeValueData(),separator:"、"}},computed:{},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},itemType:{type:String}},created:function(){this.query(),this.getFilters()},methods:{getFilters:function(){this.typeList=[{label:"文本",value:"0"},{label:"数值",value:"1"},{label:"列表",value:"2"},{label:"单选",value:"3"},{label:"多选",value:"4"},{label:"日期",value:"5"},{label:"图片",value:"6"}],this.meanList=[{label:"其他",value:"0"},{label:"会员姓名",value:"1"},{label:"会员电话",value:"2"},{label:"会员性别",value:"3"},{label:"会员出生日期",value:"4"},{label:"身份证号",value:"5"},{label:"身份证正面照片",value:"6"},{label:"身份证反面照片",value:"7"},{label:"车辆",value:"8"},{label:"车辆价格",value:"9"},{label:"车牌号",value:"10"},{label:"车辆品牌",value:"11"},{label:"车辆车系",value:"12"},{label:"车辆车型",value:"13"},{label:"车辆识别代码",value:"14"},{label:"车辆发动机号",value:"15"},{label:"车辆注册日期",value:"16"},{label:"驾驶证号",value:"17"},{label:"初次领证日期",value:"18"},{label:"有效起始日期",value:"19"},{label:"有效期限",value:"20"},{label:"驾驶证照片",value:"21"}],"0"===this.itemType?this.categoryList=[{label:"其他",value:"0"},{label:"会员信息",value:"1"},{label:"车辆信息",value:"2"},{label:"驾驶证",value:"3"}]:this.categoryList=[{label:"其他",value:"0"},{label:"会员信息",value:"1"},{label:"车辆信息",value:"2"}]},addNewTag:function(){var t=String(this.attributeValueData.valueName).trim();t&&(this.attributeData.options.includes(t)?this.$message.warning("该标签已存在，请重新添加"):this.attributeData.options=Object($["a"])(new Set(this.attributeData.options.concat(t))),this.attributeValueData.valueName="")},attributeChange:function(){this.$refs.attributeData.clearValidate("attributeType")},attributeMeaning:function(){this.$refs.attributeData.clearValidate("attributeMeaning")},attributeCategoryChange:function(t){"0"===t?(this.meanList=[{label:"其他",value:"0"}],this.attributeData.attributeMeaning="0"):"1"===t?(this.meanList=[{label:"会员姓名",value:"1"},{label:"会员电话",value:"2"},{label:"会员性别",value:"3"},{label:"会员出生日期",value:"4"},{label:"身份证号",value:"5"},{label:"身份证正面照片",value:"6"},{label:"身份证反面照片",value:"7"}],this.attributeData.attributeMeaning="1"):"2"===t?(this.meanList=[{label:"车辆",value:"8"},{label:"车辆价格",value:"9"},{label:"车牌号",value:"10"},{label:"车辆品牌",value:"11"},{label:"车辆车系",value:"12"},{label:"车辆车型",value:"13"},{label:"车辆识别代码",value:"14"},{label:"车辆发动机号",value:"15"},{label:"车辆注册日期",value:"16"}],this.attributeData.attributeMeaning="8"):(this.meanList=[{label:"驾驶证号",value:"17"},{label:"初次领证日期",value:"18"},{label:"有效起始日期",value:"19"},{label:"有效期限",value:"20"},{label:"驾驶证照片",value:"21"}],this.attributeData.attributeMeaning="16")},query:function(){this.attributeDataList=this.getAttributeDataList()},update:function(){var t=this;M["a"].updateProductAttribute(this.getAttributeUpdateParams(),(function(e){t.$message.success("更新属性成功"),t.query(),t.showAttributeDataEditor=!1,t.$emit("operationSuccess")}),(function(e){t.$message.warning(e.errorMessage)}))},save:function(){var t=this;M["a"].saveProductAttribute(this.getAttributeSaveParams(),(function(e){t.$message.success("添加属性成功"),t.query(),t.showAttributeDataEditor=!1,t.$emit("operationSuccess")}),(function(e){t.$message.warning(e.errorMessage)}))},handleSelectionChange:function(t){this.operations[1].disabled=!0,t.length>0&&(this.operations[1].disabled=!1)},getAttributeDataList:function(){var t=this,e=[],a={shopId:window.top.SHOP_ID||"",id:this.itemId};return M["a"].getProductAttributeList(a,(function(a){a.attribute.forEach((function(t,a){e.push({attributeData:{id:t.id,name:t.name,attributeType:t.attributeType,attributeMeaning:t.attributeMeaning,attributeCategory:t.attributeCategory,sort:t.sort,options:t.options}})})),t.attributeData=t.getAttributeData(e)}),(function(e){console.log(e),console.log("code错误"),t.$message.warning(e.errorMessage)})),e},getAttributeData:function(t){var e=this,a=t.findIndex((function(t){return t.attributeData.id===e.attributeData.id}));return-1!==a?{id:t[a].attributeData.id,name:t[a].attributeData.name,sort:t[a].attributeData.sort,attributeType:t[a].attributeType,attributeMeaning:t[a].attributeMeaning,attributeCategory:t[a].attributeCategory,options:t[a].attributeData.options}:this.getDefaultAttributeData()},operateHandler:function(t){this[t]()},rowEditClickHandler:function(t){this.attributeData=Object.assign({},t.attributeData),this.showAttributeDataEditor=!0,this.hideAttributeValueEditor()},rowDeleteClickHandler:function(t){this.deleteAttribute([t.attributeData.id])},saveAttributeOperate:function(){this.showAttributeValueEditor?this.saveByAttributeValueForm():this.saveByAttributeDataForm()},saveByAttributeValueForm:function(){var t=this;this.$refs.attributeDataForm.validate((function(e,a){if(!e)return!1;t.$refs.attributeValueForm.validate((function(e,a){if(!e)return!1;if(t.attributeValueData.valueName.trim()){if(t.hasSameNameAttributeData(t.attributeData))return t.$message.warning("属性名称已存在"),!1;if(t.hasSameNameAttributeValue(t.attributeValueData,t.attributeData))return t.$message.warning("属性值名称已存在"),!1;t.attributeData.options.indexOf(t.attributeValueData.oldValueName)<0?t.attributeData.options.push(t.attributeValueData.valueName):t.attributeData.options=t.attributeData.options.map((function(e){return e===t.attributeValueData.oldValueName?t.attributeValueData.valueName:e}))}t.hideAttributeValueEditor(),t.saveByAttributeDataForm()}))}))},saveByAttributeDataForm:function(){var t=this;this.$refs.attributeDataForm.validate((function(e,a){return!!e&&(t.hasSameNameAttributeData(t.attributeData)?(t.$message.warning("属性名称已存在"),!1):void(t.attributeData.id?(t.update(),t.resetAttributeValueData()):(t.save(),t.resetAttributeValueData())))}))},deleteAttribute:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){M["a"].deleteProductAttribute(e.getAttributeDeleteParams(t),(function(t){e.$message.success("删除成功"),e.$emit("operationSuccess"),e.query()}),(function(t){e.$message.warning(t.errorMessage)})),t.indexOf(e.attributeData.id)>=0&&e.resetAttributeData(),e.resetAttributeValueData(),e.hideAttributeValueEditor()}))},addAttributeOperate:function(){this.resetAttributeData(),this.resetAttributeValueData(),this.showAttributeDataEditor=!0,this.hideAttributeValueEditor()},handleAddAttributeValue:function(){this.resetAttributeValueData(),this.showAttributeValueEditor=!0},handleTagClose:function(t){this.attributeData.options=this.attributeData.options.slice(0,t).concat(this.attributeData.options.slice(t+1))},resetAttributeData:function(){this.attributeData=this.getDefaultAttributeData()},resetAttributeValueData:function(){this.attributeValueData=this.getDefaultAttributeValueData()},hideAttributeDataEditor:function(){!0===this.showAttributeDataEditor&&(this.showAttributeDataEditor=!1,this.attributeData=this.getDefaultAttributeData(),this.hideAttributeValueEditor())},hideAttributeValueEditor:function(){!0===this.showAttributeValueEditor&&(this.showAttributeValueEditor=!1,this.attributeValueData=this.getDefaultAttributeValueData())},deleteAttrbuteValue:function(t){var e=this;console.log(this.attributeData),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=e.attributeDataList.findIndex((function(t){return t.attributeData.id===e.attributeData.id}));if(-1!==a){var i={id:e.attributeDataList[a].attributeData.id,name:e.attributeDataList[a].attributeData.name,attributeType:e.attributeDataList[a].attributeData.attributeType,attributeMeaning:e.attributeDataList[a].attributeData.attributeMeaning,attributeCategory:e.attributeDataList[a].attributeData.attributeCategory,sort:e.attributeDataList[a].attributeData.sort,options:e.attributeDataList[a].attributeData.options},r=[];i.options.forEach((function(e,a){t.indexOf(e)>=0&&r.push(a)})),r.reverse().forEach((function(t,e){i.options.splice(t,1)})),e.attributeData=i,e.hideAttributeValueEditor(),e.update()}else console.log("关闭Tag所属的属性在属性列中不存在")}))},getAttributeUpdateParams:function(){return{productCategoryId:this.itemId,id:this.attributeData.id,options:this.attributeData.options,attributeType:this.attributeData.attributeType,attributeMeaning:this.attributeData.attributeMeaning,attributeCategory:this.attributeData.attributeCategory,name:this.attributeData.name,sort:this.attributeData.sort}},getAttributeSaveParams:function(){return{productCategoryId:this.itemId,options:this.attributeData.options,name:this.attributeData.name,attributeType:this.attributeData.attributeType,attributeMeaning:this.attributeData.attributeMeaning,attributeCategory:this.attributeData.attributeCategory,sort:this.attributeData.sort}},getAttributeDeleteParams:function(t){return{productCategoryId:this.itemId,ids:t}},getDefaultAttributeValueData:function(){return{oldValueName:"",valueName:""}},getDefaultAttributeData:function(){return{id:"",name:"",sort:"",attributeType:"0",attributeMeaning:"0",attributeCategory:"0",options:[]}},hasSameNameAttributeData:function(t){var e=this.attributeDataList.findIndex((function(e){return e.attributeData.name===t.name}));return-1!==e&&this.attributeDataList[e].attributeData.id!==t.id},hasSameNameAttributeValue:function(t,e){var a=e.options.findIndex((function(e){return e===t.valueName}));return-1!==a&&e.options[a]!==t.oldValueName}},watch:{itemId:function(t){this.hideAttributeDataEditor(),this.attributeData={},this.attributeValueData={},this.query()}}},N=E,A=(a("1498"),Object(v["a"])(N,L,V,!1,null,null,null)),k=A.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"category-mgmt__specification-setting"},[t.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operateHandler},slot:"top"}):t._e(),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.specificationDataList,size:"small"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{label:"规格名称",prop:"specificationData.name","min-width":"80"}}),a("el-table-column",{attrs:{label:"规格含义",prop:"specificationData.specificationMeaning","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},["0"===t.itemType?a("div",[t._v(t._s("1"===e.row.specificationData.specificationMeaning?"首付":"2"===e.row.specificationData.specificationMeaning?"分期期数":"费率/利率"))]):t._e(),"1"===t.itemType?a("div",[t._v(" "+t._s("0"===e.row.specificationData.specificationMeaning?"其他":"4"===e.row.specificationData.specificationMeaning?"交强险":"5"===e.row.specificationData.specificationMeaning?"车船使用税":"6"===e.row.specificationData.specificationMeaning?"第三者责任险":"7"===e.row.specificationData.specificationMeaning?"车辆损失险":"8"===e.row.specificationData.specificationMeaning?"全车盗抢险":"9"===e.row.specificationData.specificationMeaning?"玻璃单独破碎险":"10"===e.row.specificationData.specificationMeaning?"自燃损失险":"11"===e.row.specificationData.specificationMeaning?"不计免赔特约险":"12"===e.row.specificationData.specificationMeaning?"无过责任险":"13"===e.row.specificationData.specificationMeaning?"车上人员责任险":"14"===e.row.specificationData.specificationMeaning?"车身划痕险":"涉水险")+" ")]):t._e()])}}])}),a("el-table-column",{attrs:{label:"类型",prop:"specificationData.type","min-width":"80"}}),a("el-table-column",{attrs:{label:"排序",prop:"specificationData.sort","min-width":"80"}}),a("el-table-column",{attrs:{label:"规格值",prop:"specificationData.valueList","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.specificationData.valueList,(function(a,i){return[t._v(" "+t._s(a.name)+" "),i<e.row.specificationData.valueList.length-1?[t._v(t._s(t.separator))]:t._e()]}))]}}])}),a("el-table-column",{attrs:{prop:"title",label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.rowDeleteClickHandler(e.row)}}},[t._v("删除")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.rowEditClickHandler(e.row)}}},[t._v("编辑")])]}}])})],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showSpecificationDataEditor,expression:"showSpecificationDataEditor"}],ref:"specificationDataForm",attrs:{size:"small","label-width":"110px",model:t.specificationData,rules:t.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"规格名称: ",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入规格名称"},model:{value:t.specificationData.name,callback:function(e){t.$set(t.specificationData,"name",e)},expression:"specificationData.name"}})],1),a("el-form-item",{attrs:{label:"规格含义: ",prop:"specificationMeaning"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.specificationMeaning},model:{value:t.specificationData.specificationMeaning,callback:function(e){t.$set(t.specificationData,"specificationMeaning",e)},expression:"specificationData.specificationMeaning"}},t._l(t.meanList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"规格类型: ",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.specificationChange},model:{value:t.specificationData.type,callback:function(e){t.$set(t.specificationData,"type",e)},expression:"specificationData.type"}},t._l(t.typeList,(function(t){return a("el-option",{key:t.id,attrs:{label:t,value:t}})})),1)],1),a("el-form-item",{attrs:{label:"排序: ",prop:"sort"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入排序"},model:{value:t.specificationData.sort,callback:function(e){t.$set(t.specificationData,"sort",e)},expression:"specificationData.sort"}})],1),a("el-form-item",{attrs:{label:"规格值: ",prop:"valueList"}},[t._l(t.specificationData.valueList,(function(e,i){return a("el-tag",{key:i,staticStyle:{"margin-right":"5px"},attrs:{size:"small",closable:"","disable-transitions":!0,type:"warning"},on:{close:function(e){return t.handleTagClose(i)}}},[t._v(t._s(e.name))])})),a("el-button",{attrs:{icon:"el-icon-plus",size:"small"},on:{click:function(e){return e.stopPropagation(),t.handleAddSpecificationValue(e)}}})],2)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showSpecificationValueEditor,expression:"showSpecificationValueEditor"}],ref:"specificationValueForm",attrs:{size:"small","label-width":"110px",model:t.specificationValueData,rules:t.rulesValue,"inline-message":!0}},[a("el-form-item",{attrs:{label:"规格值:",prop:"valueName"}},[a("el-input",{attrs:{placeholder:"请输入规格值"},model:{value:t.specificationValueData.valueName,callback:function(e){t.$set(t.specificationValueData,"valueName",e)},expression:"specificationValueData.valueName"}}),a("el-button",{attrs:{type:"primary"},on:{click:t.addNewTag}},[t._v("添加")])],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showSpecificationValueImageEditor,expression:"showSpecificationValueImageEditor"}],ref:"specificationValueImageForm",attrs:{size:"small","label-width":"110px",model:t.specificationValueData,rules:t.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"规格值图片:",prop:"valueImage"}},[a("BizAvatarUploaderNew",{attrs:{title:"建议尺寸1:1"},model:{value:t.specificationValueData.valueImage,callback:function(e){t.$set(t.specificationValueData,"valueImage",e)},expression:"specificationValueData.valueImage"}})],1)],1)],1)},O=[],z=a("dd58"),B={name:"SpecificationSetting",components:{BizSaveButton:d["a"],BizGrid:u["a"],BizAvatarUploaderNew:p["b"]},data:function(){return{operations:[{label:"添加",name:"addSpecificationOperate",type:"primary"},{label:"保存",name:"saveSpecificationOperate",type:"primary"}],rules:{name:[{required:!0,message:"请输入规格名称",trigger:"blur"}],specificationMeaning:[{required:!0,trigger:"blur",message:"请输入规格含义"}],type:[{required:!0,message:"请输入规格类型",trigger:"blur"}]},rulesValue:{valueImage:[{required:!0,message:"请输入规格值图片",trigger:"blur"}]},showSpecificationDataEditor:!1,showSpecificationValueEditor:!1,showSpecificationValueImageEditor:!1,specificationDataList:[],specificationData:this.getDefaultSpecificationData(),specificationValueData:this.getDefaultSpecificationValueData(),typeList:[],meanList:[],separator:"、",newTagName:""}},computed:{},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},itemType:{type:String}},created:function(){this.query(),this.getMeanList()},methods:{addNewTag:function(){if("0"===this.itemType){if(!this.specificationData.specificationMeaning)return void this.$message.warning("请输入规格含义");if("0"===this.specificationData.specificationMeaning){if(!/^[1-9]\d*$/.test(this.specificationValueData.valueName))return void this.$message.warning("请输入正整数");if(Number(this.specificationValueData.valueName)>99||Number(this.specificationValueData.valueName)<=0)return void this.$message.warning("请输入0~99（包含99）之间的正整数")}else if("1"===this.specificationData.specificationMeaning){if(!/^[1-9]\d*$/.test(this.specificationValueData.valueName))return void this.$message.warning("请输入正整数");if(Number(this.specificationValueData.valueName)>66||Number(this.specificationValueData.valueName)<=0)return void this.$message.warning("请输入0~66（包含66）之间的正整数")}else if("2"===this.specificationData.specificationMeaning){if(!/^\d+\.?\d{0,1}$/.test(this.specificationValueData.valueName))return void this.$message.warning("请输入0~99（包含99）之间的数并且小数点后最多保留一位小数");if(Number(this.specificationValueData.valueName)>99||Number(this.specificationValueData.valueName)<=0)return void this.$message.warning("请输入0~99（包含99）之间的数")}}var t=String(this.specificationValueData.valueName).trim();t&&(-1===this.specificationData.valueList.findIndex((function(e){return e.name===t}))?this.specificationData.valueList.push({id:this.specificationValueData.valueID,image:this.specificationValueData.valueImage,name:this.specificationValueData.valueName}):this.$message.warning("该规格值名称已存在，请重新添加"),this.specificationValueData.valueName="")},specificationChange:function(){this.$refs.specificationDataForm.clearValidate("type")},specificationMeaning:function(){this.$refs.specificationDataForm.clearValidate("specificationMeaning")},query:function(){this.specificationDataList=this.getSpecificationDataList()},getMeanList:function(){"0"===this.itemType?this.meanList=[{label:"首付",value:"1"},{label:"分期期数",value:"2"},{label:"费率/利率",value:"3"}]:this.meanList=[{label:"其他",value:"0"},{label:"交强险",value:"4"},{label:"车船使用税",value:"5"},{label:"第三者责任险",value:"6"},{label:"车辆损失险",value:"7"},{label:"全车盗抢险",value:"8"},{label:"玻璃单独破碎险",value:"9"},{label:"自燃损失险",value:"10"},{label:"不计免赔特约险",value:"11"},{label:"无过责任险",value:"12"},{label:"车上人员责任险",value:"13"},{label:"车身划痕险",value:"14"},{label:"涉水险",value:"15"}]},update:function(){var t=this;z["a"].updateProductSpecification(this.getSpecificationUpdateParams(),(function(e){t.$message.success("更新规格成功"),t.query(),t.$emit("operationSuccess")}),(function(e){t.$message.warning(e.errorMessage)}))},save:function(){var t=this;z["a"].saveProductSpecification(this.getSpecificationSaveParams(),(function(e){t.$message.success("添加规格成功"),t.query(),t.$emit("operationSuccess")}),(function(e){t.$message.warning(e.errorMessage)}))},handleSelectionChange:function(t){this.operations[1].disabled=!0,t.length>0&&(this.operations[1].disabled=!1)},getSpecificationDataList:function(){var t=this,e=[],a={shopId:window.top.SHOP_ID||"",id:this.itemId};return z["a"].getProductSpecificationList(a,(function(a){a.specification.forEach((function(t,a){e.push({specificationData:{id:t.id,name:t.name,sort:t.sort,specificationMeaning:t.specificationMeaning,valueList:t.specificationValueData,type:t.type}})})),t.typeList=a.types,t.specificationData=t.getSpecificationData(e)}),(function(e){t.$message.warning(e.errorMessage)})),e},getSpecificationData:function(t){var e=this,a=t.findIndex((function(t){return t.specificationData.id===e.specificationData.id}));return-1!==a?{id:t[a].specificationData.id,name:t[a].specificationData.name,sort:t[a].specificationData.sort,specificationMeaning:t[a].specificationData.specificationMeaning,valueList:t[a].specificationData.valueList,type:t[a].specificationData.type}:this.getDefaultSpecificationData()},operateHandler:function(t){this[t]()},rowEditClickHandler:function(t){this.specificationData=Object.assign({},t.specificationData),this.showSpecificationDataEditor=!0,this.showSpecificationValueEditor=!1,this.showSpecificationValueImageEditor=!1},rowDeleteClickHandler:function(t){this.deleteSpecification([t.specificationData.id])},saveSpecificationOperate:function(){this.showSpecificationValueImageEditor?this.saveBySpecificationValueImageForm():this.showSpecificationValueEditor?this.saveBySpecificationValueForm():this.showSpecificationDataEditor&&this.saveBySpecificationDataForm()},saveBySpecificationValueImageForm:function(){var t=this;this.$refs.specificationDataForm.validate((function(e,a){e&&t.$refs.specificationValueForm.validate((function(e,a){if(!e)return!1;t.specificationValueData.valueImage.trim()?t.saveBySpecificationValueForm():t.$refs.specificationValueImageForm.validate((function(t,e){if(!t)return!1}))}))}))},saveBySpecificationValueForm:function(){var t=this;this.$refs.specificationDataForm.validate((function(e,a){if(!e)return!1;t.$refs.specificationValueForm.validate((function(e,a){if(!e)return!1;if(t.specificationValueData.valueName.trim()){if("0"===t.itemType){if(!t.specificationData.specificationMeaning)return t.$message.warning("请输入规格含义"),!1;if("0"===t.specificationData.specificationMeaning){if(!/^[1-9]\d*$/.test(t.specificationValueData.valueName))return t.$message.warning("请输入正整数"),!1;if(Number(t.specificationValueData.valueName)>99||Number(t.specificationValueData.valueName)<=0)return t.$message.warning("请输入0~99（包含99）之间的正整数"),!1}else if("1"===t.specificationData.specificationMeaning){if(!/^[1-9]\d*$/.test(t.specificationValueData.valueName))return t.$message.warning("请输入正整数"),!1;if(Number(t.specificationValueData.valueName)>66||Number(t.specificationValueData.valueName)<=0)return t.$message.warning("请输入0~66（包含66）之间的正整数"),!1}else if("2"===t.specificationData.specificationMeaning){if(!/^\d+\.?\d{0,1}$/.test(t.specificationValueData.valueName))return t.$message.warning("请输入0~99（包含99）之间的数并且小数点后最多保留一位小数"),!1;if(Number(t.specificationValueData.valueName)>99||Number(t.specificationValueData.valueName)<=0)return t.$message.warning("请输入0~99（包含99）之间的数"),!1}}if(t.hasSameNameSpecificationData(t.specificationData))return t.$message.warning("规格名称已存在"),!1;if(t.hasSameNameSpecificationValue(t.specificationValueData,t.specificationData))return t.$message.warning("规格值名称已存在"),!1;var i=t.specificationData.valueList.findIndex((function(e){return e.id===t.specificationValueData.valueID}));-1===i?t.specificationData.valueList.push({id:t.specificationValueData.valueID,image:t.specificationValueData.valueImage,name:t.specificationValueData.valueName}):t.specificationData.valueList[i]={id:t.specificationValueData.valueID,image:t.specificationValueData.valueImage,name:t.specificationValueData.valueName}}t.saveBySpecificationDataForm(),t.showSpecificationValueEditor=!1,t.showSpecificationValueImageEditor=!1}))}))},saveBySpecificationDataForm:function(){var t=this;this.$refs.specificationDataForm.validate((function(e,a){return!!e&&(t.hasSameNameSpecificationData(t.specificationData)?(t.$message.warning("规格名称已存在"),!1):void(t.specificationData.id?(t.update(),t.resetSpecificationValueData()):(t.save(),t.resetSpecificationValueData())))}))},deleteSpecification:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){z["a"].deleteProductSpecification(e.getSpecificationDeleteParams(t),(function(t){e.$message.success("删除成功"),e.$emit("operationSuccess"),e.query()}),(function(t){e.$message.warning(t.errorMessage)})),t.indexOf(e.specificationData.id)>=0&&e.resetSpecificationData(),e.resetSpecificationValueData(),e.showSpecificationValueEditor=!1,e.showSpecificationValueImageEditor=!1}))},addSpecificationOperate:function(){this.resetSpecificationData(),this.resetSpecificationValueData(),this.showSpecificationDataEditor=!0,this.showSpecificationValueEditor=!1,this.showSpecificationValueImageEditor=!1},handleAddSpecificationValue:function(){this.resetSpecificationValueData(),this.showSpecificationValueEditor=!0,"图片"===this.specificationData.type?this.showSpecificationValueImageEditor=!0:this.showSpecificationValueImageEditor=!1},handleTagClose:function(t){this.specificationData.valueList=this.specificationData.valueList.slice(0,t).concat(this.specificationData.valueList.slice(t+1))},resetSpecificationData:function(){this.specificationData=this.getDefaultSpecificationData()},resetSpecificationValueData:function(){this.specificationValueData=this.getDefaultSpecificationValueData()},hideSpecificationDataEditor:function(){!0===this.showSpecificationDataEditor&&(this.showSpecificationDataEditor=!1,this.specificationData=this.getDefaultSpecificationData(),this.hideSpecificationValueEditor())},hideSpecificationValueEditor:function(){!0===this.showSpecificationValueEditor&&(this.showSpecificationValueEditor=!1,this.specificationValueData=this.getDefaultSpecificationValueData(),this.hideSpecificationValueImageEditor())},hideSpecificationValueImageEditor:function(){!0===this.showSpecificationValueImageEditor&&(this.showSpecificationValueImageEditor=!1,this.specificationValueData=this.getDefaultSpecificationValueData())},handleUploadSuccess:function(t){this.specificationValueData.valueImage=t},deleteSpecificationValue:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=e.specificationDataList.findIndex((function(t){return t.specificationData.id===e.specificationData.id}));if(-1!==a){var i={id:e.specificationDataList[a].specificationData.id,name:e.specificationDataList[a].specificationData.name,sort:e.specificationDataList[a].specificationData.sort,specificationMeaning:e.specificationDataList[a].specificationData.specificationMeaning,valueList:e.specificationDataList[a].specificationData.valueList,type:e.specificationDataList[a].specificationData.type},r=[];i.valueList.forEach((function(e,a){t.indexOf(e.name)>=0&&r.push(a)})),r.reverse().forEach((function(t,e){i.valueList.splice(t,1)})),e.specificationData=i,e.hideSpecificationValueEditor(),e.update()}else console.log("关闭Tag所属的属性在属性列中不存在")}))},getSpecificationUpdateParams:function(){return{productCategoryId:this.itemId,id:this.specificationData.id,name:this.specificationData.name,sort:this.specificationData.sort,specificationMeaning:this.specificationData.specificationMeaning,specificationValueData:this.specificationData.valueList,type:this.specificationData.type}},getSpecificationSaveParams:function(){return{productCategoryId:this.itemId,name:this.specificationData.name,sort:this.specificationData.sort,specificationMeaning:this.specificationData.specificationMeaning,specificationValueData:this.specificationData.valueList,type:this.specificationData.type}},getSpecificationDeleteParams:function(t){return{productCategoryId:this.itemId,ids:t}},getDefaultSpecificationValueData:function(){return{valueID:"",valueImage:"",valueName:""}},getDefaultSpecificationData:function(){return{id:"",name:"",sort:"",valueList:[],specificationMeaning:"",type:""}},hasSameNameSpecificationData:function(t){var e=this.specificationDataList.findIndex((function(e){return e.specificationData.name===t.name}));return-1!==e&&this.specificationDataList[e].specificationData.id!==t.id},hasSameNameSpecificationValue:function(t,e){var a=e.valueList.findIndex((function(e){return e.name===t.valueName}));return-1!==a&&e.valueList[a].id!==t.valueID}},watch:{itemId:function(t){this.hideSpecificationDataEditor(),this.specificationData={},this.specificationValueData={},this.query(),this.getMeanList()}}},j=B,F=(a("a019"),Object(v["a"])(j,T,O,!1,null,null,null)),q=F.exports,H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"compute-setting"},[t.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operateHandler},slot:"top"}):t._e(),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.computeList,fit:!0,size:"small"},on:{"row-click":t.rowClick}},[a("el-table-column",{attrs:{label:"计算项",prop:"fullName"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticStyle:{display:"flex"}},[a("div",[t._v(" "+t._s("0"===e.row.refId?"购置税":"1"===e.row.refId?"车船税":"2"===e.row.refId?"上牌费":"3"===e.row.refId?"交强险":"4"===e.row.refId?"第三者责任险":"5"===e.row.refId?"车辆损失险":"6"===e.row.refId?"全车盗抢险":"7"===e.row.refId?"玻璃单独破碎险":"8"===e.row.refId?"自燃损失险":"9"===e.row.refId?"不计免赔特约险":"10"===e.row.refId?"无过责任险":"11"===e.row.refId?"涉水险":"12"===e.row.refId?"车上人员责任险":"车身划痕险")+" ")]),e.row.refValueId?a("span",[t._v("/")]):t._e(),e.row.refValueId?a("div",[t._v(" "+t._s("0"===e.row.refValueId?"1.0L(含)以下":"1"===e.row.refValueId?"1.0-1.6L(含)":"2"===e.row.refValueId?"1.6-2.0L(含)":"3"===e.row.refValueId?"2.0-2.5L(含)":"4"===e.row.refValueId?"2.5-3.0L(含)":"5"===e.row.refValueId?"3.0-4.0L(含)":"6"===e.row.refValueId?"4.0L以上":"7"===e.row.refValueId?"家用6座以下":"8"===e.row.refValueId?"家用6座以上":"9"===e.row.refValueId?"5万":"10"===e.row.refValueId?"10万":"11"===e.row.refValueId?"20万":"12"===e.row.refValueId?"50万":"13"===e.row.refValueId?"100万":"14"===e.row.refValueId?"家用6座以下":"15"===e.row.refValueId?"家用6座以上":"16"===e.row.refValueId?"国产":"17"===e.row.refValueId?"进口":"18"===e.row.refValueId?"2000":"19"===e.row.refValueId?"5000":"20"===e.row.refValueId?"10000":"20000")+" ")]):t._e()])}}])}),a("el-table-column",{attrs:{label:"计算条件",prop:"condition","min-width":"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.condition?a("div",{staticStyle:{display:"flex"}},[t._v(" "+t._s(Number(e.row.lt).toFixed(2))+" "),e.row.lt?a("span",{staticStyle:{"padding-left":"5px","padding-right":"5px"}},[t._v("≤")]):t._e(),t._v(" "+t._s(e.row.condition)+" "),e.row.ge?a("span",{staticStyle:{"padding-left":"5px","padding-right":"5px"}},[t._v("<")]):t._e(),t._v(" "+t._s(Number(e.row.ge).toFixed(2))+" ")]):t._e()}}],null,!0)}),a("el-table-column",{attrs:{label:"计算公式",prop:"formula"}}),a("el-table-column",{attrs:{prop:"title",label:"操作",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.rowDeleteClickHandler(e.row)}}},[t._v("删除")])]}}])})],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showCompute,expression:"showCompute"}],ref:"form",attrs:{size:"small","label-width":"110px",model:t.form,rules:t.rules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"计算项: ",prop:"fullName"}},["0"===this.itemType?a("el-cascader",{attrs:{options:t.options},on:{change:t.handleChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):t._e(),"1"===this.itemType?a("el-cascader",{attrs:{options:t.optionsInsurance},on:{change:t.handleChange},model:{value:t.valueInsurance,callback:function(e){t.valueInsurance=e},expression:"valueInsurance"}}):t._e()],1),a("el-form-item",{attrs:{label:"计算条件: ",prop:"condition"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{disabled:"无"===t.form.condition},model:{value:t.form.lt,callback:function(e){t.$set(t.form,"lt",e)},expression:"form.lt"}}),a("span",{staticStyle:{"padding-left":"5px","padding-right":"5px"}},[t._v("≤")]),"0"===this.itemType?a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.conditionChange},model:{value:t.form.condition,callback:function(e){t.$set(t.form,"condition",e)},expression:"form.condition"}},[a("el-option",{attrs:{value:"无",label:"无"}}),a("el-option",{attrs:{value:"商品价格",label:"商品价格"}})],1):t._e(),"1"===this.itemType?a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.conditionChange},model:{value:t.form.condition,callback:function(e){t.$set(t.form,"condition",e)},expression:"form.condition"}},[a("el-option",{attrs:{value:"无",label:"无"}}),a("el-option",{attrs:{value:"车辆价格",label:"车辆价格"}}),a("el-option",{attrs:{value:"会员信息",label:"会员信息"}})],1):t._e(),a("span",{staticStyle:{"padding-left":"5px","padding-right":"5px"}},[t._v("<")]),a("el-input",{attrs:{disabled:"无"===t.form.condition},model:{value:t.form.ge,callback:function(e){t.$set(t.form,"ge",e)},expression:"form.ge"}})],1)]),a("el-form-item",{attrs:{label:"计算公式: ",prop:"formula"}},[a("el-input",{attrs:{placeholder:"请输入计算公式"},on:{focus:function(e){t.showDialog=!0}},model:{value:t.form.formula,callback:function(e){t.$set(t.form,"formula",e)},expression:"form.formula"}})],1)],1),a("el-dialog",{attrs:{visible:t.showDialog,title:"计算公式",width:"40%","append-to-body":""},on:{"update:visible":function(e){t.showDialog=e}}},[a("div",{staticClass:"valid-div"},[a("el-form",{ref:"formModel",attrs:{"label-width":"140px",size:"small",model:t.formModel,rules:t.rulesModel}},[a("el-form-item",{attrs:{label:"计算公式：",prop:"formula"}},[a("el-input",{attrs:{required:!0,placeholder:"请输入计算公式"},model:{value:t.formModel.formula,callback:function(e){t.$set(t.formModel,"formula",e)},expression:"formModel.formula"}})],1),"0"===this.itemType?a("el-form-item",{attrs:{label:"参数：",prop:"params"}},[a("el-checkbox-group",{model:{value:t.formModel.params,callback:function(e){t.$set(t.formModel,"params",e)},expression:"formModel.params"}},[a("el-checkbox",{attrs:{label:"商品价格"}}),a("el-checkbox",{attrs:{label:"第三方责任险"}}),a("el-checkbox",{attrs:{label:"车辆损失险"}})],1)],1):t._e(),"1"===this.itemType?a("el-form-item",{attrs:{label:"参数：",prop:"params"}},[a("span",[t._v("属性")]),a("el-checkbox-group",{model:{value:t.formModel.params,callback:function(e){t.$set(t.formModel,"params",e)},expression:"formModel.params"}},[a("el-checkbox",{attrs:{label:"车辆价格"}})],1)],1):t._e()],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.showDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.confirmByDialog}},[t._v("确 定")])],1)])],1)},U=[],G=void 0,R=function(t,e,a){Number(G.form.lt)>=0?a():a(new Error("计算条件上限必须为数字值"))},K=function(t,e,a){Number(G.form.ge)>=0?a():a(new Error("计算条件下限必须为数字值"))},X={name:"ComputeSetting",components:{BizSaveButton:d["a"],BizGrid:u["a"]},data:function(){return{operations:[{label:"添加",name:"add",type:"primary"},{label:"保存",name:"save",type:"primary"}],showDialog:!1,rulesModel:{},formModel:{formula:"",params:[]},rules:{lt:[{required:!1,trigger:"blur",validator:R}],ge:[{required:!1,trigger:"blur",validator:K}]},showCompute:!1,computeList:[],options:[{value:"0",label:"购置税"},{value:"1",label:"车船税",children:[{value:"0",label:"1.0L(含)以下"},{value:"1",label:"1.0-1.6L(含)"},{value:"2",label:"1.6-2.0L(含)"},{value:"3",label:"2.0-2.5L(含)"},{value:"4",label:"2.5-3.0L(含)"},{value:"5",label:"3.0-4.0L(含)"},{value:"6",label:"4.0L以上"}]},{value:"2",label:"上牌费"},{value:"3",label:"交强险",children:[{value:"7",label:"家用6座以下"},{value:"8",label:"家用6座以上"}]},{value:"4",label:"第三者责任险",children:[{value:"9",label:"5万"},{value:"10",label:"10万"},{value:"11",label:"20万"},{value:"12",label:"50万"},{value:"13",label:"100万"}]},{value:"5",label:"车辆损失险"},{value:"6",label:"全车盗抢险",children:[{value:"14",label:"家用6座以下"},{value:"15",label:"家用6座以上"}]},{value:"7",label:"玻璃单独破碎险",children:[{value:"16",label:"国产"},{value:"17",label:"进口"}]},{value:"8",label:"自燃损失险"},{value:"9",label:"不计免赔特约险"},{value:"10",label:"无过责任险"},{value:"11",label:"涉水险"},{value:"12",label:"车上人员责任险"},{value:"13",label:"车身划痕险",children:[{value:"18",label:"2000"},{value:"19",label:"5000"},{value:"20",label:"10000"},{value:"21",label:"20000"}]}],value:[],optionsInsurance:[{value:"3",label:"交强险",children:[{value:"7",label:"家用6座以下"},{value:"8",label:"家用6座以上"}]},{value:"4",label:"第三者责任险",children:[{value:"9",label:"5万"},{value:"10",label:"10万"},{value:"11",label:"20万"},{value:"12",label:"50万"},{value:"13",label:"100万"}]},{value:"5",label:"车辆损失险"},{value:"6",label:"全车盗抢险",children:[{value:"14",label:"家用6座以下"},{value:"15",label:"家用6座以上"}]},{value:"7",label:"玻璃单独破碎险",children:[{value:"16",label:"国产"},{value:"17",label:"进口"}]},{value:"13",label:"车身划痕险",children:[{value:"18",label:"2000"},{value:"19",label:"5000"},{value:"20",label:"10000"},{value:"21",label:"20000"}]}],valueInsurance:[],form:this.getDefaultForm(),typeList:[],separator:"、"}},computed:{},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},itemType:{type:String}},created:function(){this.query()},methods:{handleChange:function(){},confirmByDialog:function(){var t=this,e={formula:this.formModel.formula,params:this.formModel.params};f["a"].put("/admin/finance/productCategory/caculateItemChect.jhtml",e).then((function(e){if(t.formModel.params.length>0){for(var a=t.formModel.params[0],i=1;i<=t.formModel.params.length-1;i++)a=a+"+"+t.formModel.params[i];t.form.formula="("+a+")*"+t.formModel.formula}else t.form.formula=t.formModel.formula;t.showDialog=!1})).catch((function(e){""!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},getDefaultForm:function(){return{id:"",productCategoryId:"",lt:"",ge:"",formula:"",itemType:"",condition:"无",refId:"",refValueId:"",nameType:"",nameDetailType:"",fullName:""}},conditionChange:function(t){"无"===t&&(this.$set(this.form,"lt",""),this.$set(this.form,"ge",""))},add:function(){this.form=this.getDefaultForm(),this.value=[],this.valueInsurance=[],this.showCompute=!0},rowClick:function(t){this.form=Object.assign(this.getDefaultForm(),t),"0"===t.itemType?(console.log(t),t.refValueId?this.value=[t.refId,t.refValueId]:this.value=[t.refId]):this.valueInsurance=[t.refId,t.refValueId],this.showCompute=!0},getSaveParams:function(){return{id:this.form.id,productCategoryId:this.itemId,lt:this.form.lt,ge:this.form.ge,formula:this.form.formula,itemType:this.itemType,condition:"无"===this.form.condition?"":this.form.condition,refId:"0"===this.itemType?this.value[0]:this.valueInsurance[0],refValueId:"0"===this.itemType?this.value[1]:this.valueInsurance[1]||"",nameType:this.form.nameType,nameDetailType:this.form.nameDetailType,fullName:this.form.fullName}},createCompute:function(){var t=this;if(Number(this.form.lt)>Number(this.form.ge))this.$message.warning("计算条件范围错误");else{var e=this.getSaveParams();f["a"].post("/admin/finance/productCategory/caculateItem.jhtml",e).then((function(e){t.$message.success("添加成功"),t.form.id=e.id,t.query(),t.showCompute=!1})).catch((function(e){""!==e.errorMessage&&t.$message.warning(e.errorMessage)}))}},updateCompute:function(){var t=this,e=this.getSaveParams();Number(this.form.lt)>Number(this.form.ge)?this.$message.warning("计算条件范围错误"):f["a"].put("/admin/finance/productCategory/caculateItem.jhtml",e).then((function(e){t.$message.success("修改成功"),t.query(),t.showCompute=!1})).catch((function(e){""!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},save:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;t.form.id?t.updateCompute():t.createCompute()}))},query:function(){var t=this,e={id:this.itemId};f["a"].get("/admin/finance/productCategory/caculateItems.jhtml",e).then((function(e){t.computeList=e.content})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){}))},operateHandler:function(t){this[t]()},rowDeleteClickHandler:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];a.push(t.id);var i={ids:a};f["a"].delete("/admin/finance/productCategory/caculateItems.jhtml",i).then((function(t){e.$message.success("删除成功"),e.query()})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){}))}))}},watch:{itemId:function(t){this.form=this.getDefaultForm(),this.query()}}},Y=X,J=(a("8525"),Object(v["a"])(Y,H,U,!1,null,null,null)),Q=J.exports,W={name:"CategoryMgmtPopup",components:{BizPopupTabs:n["a"],CategorySetting:y,ParameterSetting:_,AttributeSetting:k,SpecificationSetting:q,ComputeSetting:Q},props:{open:{type:Boolean},isEdit:{type:Boolean,default:function(){return!0}},itemId:{type:String},tabName:{type:String},itemType:{type:String}},data:function(){return{}},methods:{close:function(t){this.$emit("close",t)},operationSuccess:function(t){this.$emit("operationSuccess",t)},createdCategorySuccess:function(t){this.$emit("createdCategorySuccess",t)}},watch:{itemId:function(t){console.log("CategoryMgmtPopup::watch() Val:",t)}}},Z=W,tt=Object(v["a"])(Z,i,r,!1,null,null,null);e["a"]=tt.exports},"443b":function(t,e,a){"use strict";a("4de4");var i=a("c596"),r=a("1ab1"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":"",visible:t.visible,title:"自定义列","custom-class":"biz-columns",width:"500px"},on:{close:t.onClose}},[a("div",{staticClass:"columns-wrap"},[a("biz-flex-table",{ref:"table",attrs:{checkable:!1,tableData:t.tableData},on:{"selection-change":t.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:t.getSelectable}}),a("el-table-column",{attrs:{label:"信息",prop:"name"}}),a("el-table-column",{attrs:{prop:"tag",label:"排序"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.$index;return[a("el-button",{attrs:{icon:"el-icon-sort-up",type:"text",disabled:0===i},on:{click:function(e){return t.onUp(i)}}}),a("el-button",{attrs:{icon:"el-icon-sort-down",type:"text",disabled:i===t.tableData.length-1},on:{click:function(e){return t.onBottom(i)}}})]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.onClose}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.update}},[t._v("确 定")])],1)])},o=[],s=(a("7db0"),a("a434"),a("b85c")),l=a("04d3"),c={name:"biz-columns",components:{BizFlexTable:l["c"]},props:{visible:Boolean,tableId:String},data:function(){return{id:"",tableName:"",selections:[],tableData:[]}},computed:{},watch:{visible:function(t){t?this.makeRowDisplayable():this.saveSelection()},tableId:function(){this.getTableColumns()}},mounted:function(){this.getTableColumns()},methods:{getTableColumns:function(){var t=this;r["a"].get(i["g"].user.columns,{tableId:this.tableId}).then((function(e){t.tableData=e.data.columnDatas,t.id=e.data.id,t.tableName=e.data.tableName}))},getSelectable:function(t){return t.isEditable},selectionChangeHandler:function(t){this.selections=t},saveSelection:function(){var t,e=this,a=Object(s["a"])(this.tableData);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.displayable=!1}}catch(l){a.e(l)}finally{a.f()}var r,n=Object(s["a"])(this.selections);try{var o=function(){var t=r.value;e.tableData.find((function(e){return e.id===t.id})).displayable=!0};for(n.s();!(r=n.n()).done;)o()}catch(l){n.e(l)}finally{n.f()}},onUp:function(t){this.tableData[t]=this.tableData.splice(t-1,1,this.tableData[t])[0]},onBottom:function(t){this.tableData[t]=this.tableData.splice(t+1,1,this.tableData[t])[0]},onClose:function(){this.$emit("update:visible",!1)},update:function(){var t,e=this,a=Object(s["a"])(this.tableData);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.displayable=!1}}catch(d){a.e(d)}finally{a.f()}var o,l=Object(s["a"])(this.selections);try{var c=function(){var t=o.value;e.tableData.find((function(e){return e.id===t.id})).displayable=!0};for(l.s();!(o=l.n()).done;)c()}catch(d){l.e(d)}finally{l.f()}var u={columnDatas:this.tableData,id:this.id,tableId:this.tableId,tableName:this.tableName};console.log(u),r["a"].put(i["g"].user.columns,u).then((function(t){e.$emit("update"),e.$emit("update:visible",!1)}))},makeRowDisplayable:function(){var t=this;setTimeout((function(){var e,a=Object(s["a"])(t.tableData);try{for(a.s();!(e=a.n()).done;){var i=e.value;t.$refs.table.$refs.table.toggleRowSelection(i,i.displayable)}}catch(r){a.e(r)}finally{a.f()}}),20)}}},u=c,d=(a("ec6b"),a("2877")),p=Object(d["a"])(u,n,o,!1,null,null,null),f=p.exports,m=f;e["a"]={components:{BizColumnOperation:l["a"],BizColumns:m},data:function(){return{columnsSettingVisible:!1,columns:[]}},created:function(){this.getTableId(),this.getColumns()},methods:{onCustomColumns:function(){this.columnsSettingVisible=!0},getColumns:function(){var t=this;console.log(12),r["a"].get(i["A"].columns,{tableId:this.tableId}).then((function(e){t.columns=[],setTimeout((function(){t.columns=e.data.columnDatas.filter((function(t){return t.displayable})),t.$refs.table&&setTimeout((function(){t.$refs.table.doLayout()}),50)}),20)})).catch((function(t){t.errorMessage&&console.log(t.errorMessage)}))},getTableId:function(){}}}},"498a":function(t,e,a){"use strict";var i=a("23e7"),r=a("58a8").trim,n=a("c8d2");i({target:"String",proto:!0,forced:n("trim")},{trim:function(){return r(this)}})},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var i=a("1d80"),r=a("5899"),n="["+r+"]",o=RegExp("^"+n+n+"*"),s=RegExp(n+n+"*$"),l=function(t){return function(e){var a=String(i(e));return 1&t&&(a=a.replace(o,"")),2&t&&(a=a.replace(s,"")),a}};t.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(t,e,a){"use strict";var i=a("9678"),r=a.n(i);r.a},"5da3":function(t,e,a){},7132:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"biz-fade-t"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(e){return e.target!==e.currentTarget?null:t.close(e)}}},[a("transition",{attrs:{name:"biz-fade-t-right"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"popup-content",style:t.contentStyle},[t._t("default")],2)])],1)])},r=[],n={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},o=n,s=(a("5b8e"),a("2877")),l=Object(s["a"])(o,i,r,!1,null,null,null),c=l.exports,u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"biz-popup-tabs"},[a("biz-popup",{attrs:{open:t.open,contentStyle:t.contentStyle},on:{close:t.close}},[a("el-tabs",{attrs:{type:"border-card",value:t.value},on:{"tab-click":t.tabClick}},[t._t("default")],2)],1)],1)},d=[],p=(a("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:c},methods:{close:function(){var t=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("close")}))},tabClick:function(t){this.$emit("input",t.name)}}}),f=p,m=(a("d4c2"),Object(s["a"])(f,u,d,!1,null,null,null)),h=m.exports;a.d(e,"a",(function(){return h}))},"81d5":function(t,e,a){"use strict";var i=a("7b0b"),r=a("23cb"),n=a("50c4");t.exports=function(t){var e=i(this),a=n(e.length),o=arguments.length,s=r(o>1?arguments[1]:void 0,a),l=o>2?arguments[2]:void 0,c=void 0===l?a:r(l,a);while(c>s)e[s++]=t;return e}},8316:function(t,e,a){"use strict";var i=a("2497"),r=a("bc3a"),n=a.n(r),o=a("c596");e["a"]={getCategoryParameter:function(t,e,a){n.a.get(o["g"].commodity.getCategoryParameter,{params:t}).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},deleteCategoryParameter:function(t,e,a){n.a.delete(o["g"].commodity.deleteCategoryParameter,{data:t}).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},saveCategoryParameter:function(t,e,a){n.a.post(o["g"].commodity.saveCategoryParameter,t).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},updateCategoryParameter:function(t,e,a){n.a.put(o["g"].commodity.updateCategoryParameter,t).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))}}},8525:function(t,e,a){"use strict";var i=a("fb0f"),r=a.n(i);r.a},"8d17":function(t,e,a){},9678:function(t,e,a){},9931:function(t,e,a){"use strict";var i=a("5da3"),r=a.n(i);r.a},"9e84":function(t,e,a){},a019:function(t,e,a){"use strict";var i=a("d347"),r=a.n(i);r.a},a9e3:function(t,e,a){"use strict";var i=a("83ab"),r=a("da84"),n=a("94ca"),o=a("6eeb"),s=a("5135"),l=a("c6b6"),c=a("7156"),u=a("c04e"),d=a("d039"),p=a("7c73"),f=a("241c").f,m=a("06cf").f,h=a("9bf2").f,g=a("58a8").trim,b="Number",v=r[b],D=v.prototype,y=l(p(D))==b,w=function(t){var e,a,i,r,n,o,s,l,c=u(t,!1);if("string"==typeof c&&c.length>2)if(c=g(c),e=c.charCodeAt(0),43===e||45===e){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+c}for(n=c.slice(2),o=n.length,s=0;s<o;s++)if(l=n.charCodeAt(s),l<48||l>r)return NaN;return parseInt(n,i)}return+c};if(n(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var C,I=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof I&&(y?d((function(){D.valueOf.call(a)})):l(a)!=b)?c(new v(w(e)),a,I):w(e)},S=i?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;S.length>x;x++)s(v,C=S[x])&&!s(I,C)&&h(I,C,m(v,C));I.prototype=D,D.constructor=I,o(r,b,I)}},b046:function(t,e,a){},b400:function(t,e,a){"use strict";var i=a("b046"),r=a.n(i);r.a},b547:function(t,e,a){},bf5b:function(t,e,a){"use strict";(function(t){a("c975"),a("d81d"),a("b0c0"),a("a9e3"),a("25eb"),a("d3b7");var i=a("5530"),r=a("b85c"),n=a("04d3"),o=a("2f62"),s=a("2a09"),l=a("1ab1"),c=a("13a8"),u=a("f36f");e["a"]={name:"CategoryMgmt",data:function(){return{expands:[],maxLevel:"1",loading:!1,categoryId:"",refreshSign:!0,open:!1,isEdit:!0,itemId:"",itemType:"",tabName:"Category",multipleSelection:[],sonSelections:[],editShopIds:[],inputPopupOpen:!1,operations:[{label:"添加",name:"add",type:"primary"},{label:"刷新",name:"refresh",type:""}],tableData:[],dataList:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9},separator:"、"}},computed:{handleTableData:function(){var t,e=[],a=Object(r["a"])(this.tableData);try{for(a.s();!(t=a.n()).done;){var i=t.value;e.push({id:i.id,name:i.name,childrenProductCategoryData:{id:i.id,name:"",sort:"null"===i.sort?"":i.sort,parameterGroupDataList:i.parameterGroupDataList,attributeDataList:i.attributeDataList,specificationDataList:i.specificationDataList}})}}catch(n){a.e(n)}finally{a.f()}return e}},components:{BizHeader:n["d"],CategoryMgmtPopup:s["a"],ExpandTable:c["a"],BizGrid:u["a"]},created:function(){this.getKpi(),this.refresh(),this.getEditableStores()},mounted:function(){},methods:Object(i["a"])(Object(i["a"])({},Object(o["c"])(["getUser"])),{},{rowKeys:function(t){return t.id},setClassName:function(t){var e=t.row;t.index;return e.childrenProductCategoryDataList.length>0?"expand":"noexpand"},expandChange:function(t,e){},operate:function(t){this[t]()},getChildren:function(t,e,a){var i=this,r=e.sort;t.map((function(n){n.id===e.id?("up"===a?(t[t.indexOf(e)].sort=t[t.indexOf(e)-1].sort,t[t.indexOf(e)-1].sort=r,i.dataList=[t[t.indexOf(e)],t[t.indexOf(e)-1]]):(t[t.indexOf(e)].sort=t[t.indexOf(e)+1].sort,t[t.indexOf(e)+1].sort=r,i.dataList=[t[t.indexOf(e)],t[t.indexOf(e)+1]]),i.sort()):n.childrenProductCategoryDataList&&i.getChildren(n.childrenProductCategoryDataList,e,a)}))},moveUp:function(t){var e=this;this.loading=!0;var a=t.sort;this.tableData.map((function(i){i.id===t.id?(e.tableData[e.tableData.indexOf(t)].sort=e.tableData[e.tableData.indexOf(t)-1].sort,e.tableData[e.tableData.indexOf(t)-1].sort=a,e.dataList=[e.tableData[e.tableData.indexOf(t)],e.tableData[e.tableData.indexOf(t)-1]],e.sort()):i.childrenProductCategoryDataList&&e.getChildren(i.childrenProductCategoryDataList,t,"up")}))},moveDown:function(t){var e=this;this.loading=!0;var a=t.sort;this.dataList=[],this.tableData.map((function(i){i.id===t.id?(e.tableData[e.tableData.indexOf(t)].sort=e.tableData[e.tableData.indexOf(t)+1].sort,e.tableData[e.tableData.indexOf(t)+1].sort=a,e.dataList=[e.tableData[e.tableData.indexOf(t)],e.tableData[e.tableData.indexOf(t)+1]],e.sort()):e.getChildren(i.childrenProductCategoryDataList,t,"down")}))},refresh:function(){this.getList()},sort:function(){var t=this;l["a"].put("/admin/product_category/categorySort.jhtml",this.dataList).then((function(e){t.getList(),t.loading=!1})).catch((function(e){t.loading=!1,t.$message.warning(e.errorMessage||"操作出现错误")}))},sonClassSelectionChange:function(t){this.sonSelections=t},getKpi:function(){var t=this;l["a"].get("/admin/financialProductCategory/financialCategoryCountQuery.jhtml",{shopId:window.top.SHOP_ID||""}).then((function(e){var a="已创建产品分类"+e.createdFinancialCategory+"个";t.$message({customClass:"motorists-club-activity__kpi",showClose:!0,message:a,duration:3e3})})).catch((function(e){t.$message.warning(e.errorMessage||"操作出现错误")}))},getEditableStores:function(){var e=this;l["a"].get(t.editableStores,{resourceType:"2"}).then((function(t){e.editShopIds=[],t.dataList.map((function(t){e.editShopIds.push(t.id)}))})).catch((function(t){console.log(t),console.log("code错误")}))},getList:function(){var t=this;this.loading=!0;var e={shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};l["a"].get("/admin/financialProductCategory/queryFinancialProductCategoryList.jhtml",e).then((function(e){t.tableData=e.content,t.loading=!1,t.$set(t.pagination,"total",Number.parseInt(e.total))})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage),t.loading=!1})).finally((function(){t.loading=!1}))},deleteCategory:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[];a.push(t.id);var i={ids:a};l["a"].delete("/admin/financialProductCategory/deleteFinancialProductCategory.jhtml",i).then((function(t){e.$message.success("删除成功"),e.getList()})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}))},add:function(){this.itemId="",this.tabName="Category",this.open=!0},handleSelectionChange:function(t){},rowClick:function(t){console.log("rowClick:",t.id),this.open=!0,this.itemId=t.id,this.itemType="finance"===t.type?"0":"1",this.tabName="Category"},handleSizeChange:function(t){this.pagination.pageSize=t,this.refresh()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.refresh()},typeFilterHandler:function(t,e){return e.type===t},statusFilterHandler:function(t,e){return e.state===t},handleAddParameter:function(t){console.log("CategoryMgmt::handleAddParameter() AddParameter:",t),this.tabName="Parameter",this.open=!0,this.itemId=t},handleAddAttribute:function(t){console.log("CategoryMgmt::handleAddAttribute() AddAttribute:",t),this.tabName="Attribute",this.open=!0,this.itemId=t},handleAddSpecification:function(t){console.log("CategoryMgmt::handleAddSpecification() AddSpecification:",t),this.tabName="Specification",this.open=!0,this.itemId=t},objectSpanMethod:function(t){var e=t.row,a=(t.column,t.rowIndex,t.columnIndex);if(1===a)return this.isHead(e.id,e.childrenProductCategoryData.id)?{rowspan:this.getRows(e.id),colspan:1}:{rowspan:0,colspan:0}},getRows:function(t){var e,a=Object(r["a"])(this.tableData);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(i.id===t)return i.childrenProductCategoryDataList.length+1}}catch(n){a.e(n)}finally{a.f()}},isHead:function(t,e){return t===e},operationSuccess:function(){this.refresh()},createdCategorySuccess:function(t){this.itemId=t},importFromPlatForm:function(){console.log("CategoryMgmt::importFromPlatForm()"),this.inputPopupOpen=!0}})}}).call(this,a("c8ba"))},c1bc:function(t,e,a){"use strict";var i=a("8d17"),r=a.n(i);r.a},c20d:function(t,e,a){var i=a("da84"),r=a("58a8").trim,n=a("5899"),o=i.parseInt,s=/^[+-]?0[Xx]/,l=8!==o(n+"08")||22!==o(n+"0x16");t.exports=l?function(t,e){var a=r(String(t));return o(a,e>>>0||(s.test(a)?16:10))}:o},c8d2:function(t,e,a){var i=a("d039"),r=a("5899"),n="​᠎";t.exports=function(t){return i((function(){return!!r[t]()||n[t]()!=n||r[t].name!==t}))}},c992:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("biz-grid",{staticClass:"category-mgmt"},[a("biz-header",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}),a("expand-table",{ref:"expandTable",attrs:{data:t.tableData,loading:t.loading},on:{"expand-change":t.expandChange,deleteCategory:t.deleteCategory,moveUp:t.moveUp,moveDown:t.moveDown,"row-click":t.rowClick,"selection-change":t.handleSelectionChange}}),a("category-mgmt-popup",{attrs:{slot:"float",open:t.open,isEdit:t.isEdit,itemId:t.itemId,itemType:t.itemType,tabName:t.tabName},on:{close:function(e){t.open=!1,t.itemId=""},operationSuccess:t.operationSuccess,createdCategorySuccess:t.createdCategorySuccess},slot:"float"})],1)},r=[],n=a("bf5b"),o=n["a"],s=(a("c1bc"),a("2877")),l=Object(s["a"])(o,i,r,!1,null,null,null);e["default"]=l.exports},cb29:function(t,e,a){var i=a("23e7"),r=a("81d5"),n=a("44d2");i({target:"Array",proto:!0},{fill:r}),n("fill")},d347:function(t,e,a){},d4c2:function(t,e,a){"use strict";var i=a("e725"),r=a.n(i);r.a},dd58:function(t,e,a){"use strict";var i=a("2497"),r=a("bc3a"),n=a.n(r),o=a("c596");e["a"]={getProductSpecificationList:function(t,e,a){console.log("[---- dachao ----] [API-规格编辑-get] getProductSpecificationList() params=",t),n.a.get(o["g"].commodity.getProductSpecificationList,{params:t}).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},saveProductSpecification:function(t,e,a){console.log("[---- dachao ----] [API-规格编辑-post] saveProductSpecification() params=",t),n.a.post(o["g"].commodity.saveProductSpecification,t).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},updateProductSpecification:function(t,e,a){console.log("[---- dachao ----] [API-规格编辑-put] updateProductSpecification() params=",t),n.a.put(o["g"].commodity.updateProductSpecification,t).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},deleteProductSpecification:function(t,e,a){console.log("[---- dachao ----] [API-规格编辑-delete] updateProductSpecification() params=",t),n.a.delete(o["g"].commodity.deleteProductSpecification,{data:t}).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))}}},e725:function(t,e,a){},eae2:function(t,e,a){"use strict";var i=a("f657"),r=a.n(i);r.a},ec6b:function(t,e,a){"use strict";var i=a("b547"),r=a.n(i);r.a},f562:function(t,e,a){"use strict";var i=a("2497"),r=a("bc3a"),n=a.n(r),o=a("c596");e["a"]={getProductAttributeList:function(t,e,a){console.log("[---- dachao ----] [API-属性编辑-get] getProductAttributeList() params=",t),n.a.get(o["g"].commodity.getProductAttributeList,{params:t}).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},saveProductAttribute:function(t,e,a){console.log("[---- dachao ----] [API-属性编辑-post] saveProductAttribute() params=",t),n.a.post(o["g"].commodity.saveProductAttribute,t).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},updateProductAttribute:function(t,e,a){console.log("[---- dachao ----] [API-属性编辑-put] updateProductAttribute() params=",t),n.a.put(o["g"].commodity.updateProductAttribute,t).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))},deleteProductAttribute:function(t,e,a){console.log("[---- dachao ----] [API-属性编辑-delete] deleteProductAttribute() params=",t),n.a.delete(o["g"].commodity.deleteProductAttribute,{data:t}).then(Object(i["a"])(e,a)).catch((function(t){console.error(t)}))}}},f657:function(t,e,a){},fb0f:function(t,e,a){}}]);