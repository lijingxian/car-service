(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7fc6231e"],{"0693":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"delivery-mgmt"},[a("biz-flex-table",{attrs:{operations:e.operations,loading:e.loading,tableData:e.tableData,pagination:e.pagination,filters:e.filters,checkable:!1},on:{"filter-data-change":e.filterDataChange,operate:e.operate,"selection-change":e.handleSelectionChange,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{prop:"shop.name",label:"发货单","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.sn)+" ")]),a("div",{staticClass:"overflow"},[e._v(" 发货时间："+e._s(t.row.shippingDate)+" ")])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"发货信息","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" 配送方式："+e._s(t.row.shippingMethod)+" ")]),a("div",{staticClass:"overflow"},[e._v(" "+e._s("undefined"===t.row.address?"-":t.row.address)+" ")])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"收件人信息","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v(" "+e._s(t.row.consignee+" "+t.row.phone)+" ")]),a("div",{staticClass:"overflow"},[e._v(" 物流公司："+e._s(t.row.logistics?t.row.logistics:"-")+" ")]),a("div",{staticClass:"overflow"},[e._v(" 运单号："+e._s(t.row.expressSn)+" ")])])]}}])}),a("el-table-column",{attrs:{prop:"shop.name",label:"关联订单","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.clickOrder(a,t.row)}}},[e._v(e._s(t.row.orderSn))])],1)])]}}])}),a("el-table-column",{attrs:{width:"110",prop:"date",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("div",{staticClass:"biz-customcol"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.certificate(t.row)}}},[e._v("凭证")])],1)])}}])})],1),a("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[e.openOrder||e.openPurchaseOrder?e._e():a("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[a("base-info",{attrs:{itemId:e.currentRowId},on:{update:function(t){e.isUpdate=!0}}})],1),e.openOrder?a("el-tab-pane",{attrs:{label:"订单信息",name:"first"}},[a("order-base-info",{attrs:{itemId:e.orderId},on:{update:function(t){e.isUpdate=!0}}})],1):e._e(),e.openPurchaseOrder?a("el-tab-pane",{attrs:{label:"订单信息",name:"order"}},[a("purchase-order-info",{ref:"orderinfo",attrs:{orderId:e.relateBillId},on:{closeTabByLogistics:e.closeTabByLogistics,closeTabByEvaluate:e.closeTabByEvaluate}})],1):e._e()],1),a("biz-popup-tabs",{attrs:{open:e.openLogistics},on:{close:function(t){e.openLogistics=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[e.sn?a("el-tab-pane",{attrs:{label:"物流追踪",name:"loginfo"}},[a("logistics-following",{ref:"logistics",attrs:{orderId:e.itemId,sn:e.sn}})],1):e._e()],1),a("biz-popup-tabs",{attrs:{open:e.openReview},on:{close:function(t){e.openReview=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:"评价",name:"reviewinfo"}},[a("my-evaluate",{ref:"reviewinfo",attrs:{orderId:e.itemId,editable:e.editable}})],1)],1),a("el-dialog",{attrs:{visible:e.dialogTableVisible,center:"",width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:18}},[a("div",{staticClass:"grid18"})]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),a("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[a("div",{staticClass:"d-p-wrap"},[a("el-row",{attrs:{gutter:10}},[a("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid18"})]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),a("el-row",{staticClass:"row-top",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("配送方式："+e._s(e.form.shippingMethodName))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shipping.sn))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.logisticCompany))])])],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.form.consignee))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.form.phone))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("地址："+e._s(e.shipping.address))])]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("买家留言："+e._s(e.form.memo))])])],1),a("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[a("el-table-column",{attrs:{property:"isTotal",width:"50",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?a("div",[e._v("合计")]):a("div",[e._v(e._s(t.$index+1))])]}}])}),a("el-table-column",{attrs:{property:"name",label:"商品名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),a("el-table-column",{attrs:{property:"address",label:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:""))]}}],null,!0)}),a("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),a("el-table-column",{attrs:{property:"quantity",label:"数量"}}),a("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("运费：￥"+e._s(e.form.freight))])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("优惠金额：￥"+e._s(e.form.couponDiscount))])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("调整金额：￥"+e._s(e.form.offsetAmount))])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("订单金额：￥"+e._s(e.form.originalAmount))])])],1),a("el-row",{staticClass:"row",attrs:{gutter:10}},[a("el-col",{attrs:{span:18}},[a("div",{staticClass:"grid18"})]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("仓库签字：")])])],1)],1)])],1)],1)},s=[],i=(a("99af"),a("d81d"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("3ca3"),a("466d"),a("1276"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),o=a("5530"),n=a("04d3"),l=a("7132"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"delivery-mgmt-base-info"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,disabled:"","label-width":"125px",size:"small","inline-message":!0}},[a("el-form-item",{attrs:{label:"编号",prop:"sn"}},[a("el-input",{attrs:{placeholder:"请输入编号"},model:{value:e.form.sn,callback:function(t){e.$set(e.form,"sn",t)},expression:"form.sn"}})],1),a("el-form-item",{attrs:{label:"订单号",prop:"orderSn"}},[a("el-input",{attrs:{placeholder:"请输入订单号"},model:{value:e.form.orderSn,callback:function(t){e.$set(e.form,"orderSn",t)},expression:"form.orderSn"}})],1),a("el-form-item",{attrs:{label:"物流公司",prop:"logistics"}},[a("el-input",{attrs:{placeholder:"请输入物流公司"},model:{value:e.form.logistics,callback:function(t){e.$set(e.form,"logistics",t)},expression:"form.logistics"}})],1),a("el-form-item",{attrs:{label:"运单号",prop:"expressSn"}},[a("el-input",{attrs:{placeholder:"请输入运单号"},model:{value:e.form.expressSn,callback:function(t){e.$set(e.form,"expressSn",t)},expression:"form.expressSn"}})],1),a("el-form-item",{attrs:{label:"物流费用",prop:"freight"}},[a("el-input",{attrs:{placeholder:"请输入物流费用"},model:{value:e.form.freight,callback:function(t){e.$set(e.form,"freight",t)},expression:"form.freight"}})],1),a("el-form-item",{attrs:{label:"收货人",prop:"consignee"}},[a("el-input",{attrs:{placeholder:"请输入收货人"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),a("el-form-item",{attrs:{label:"收货地址",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入收货地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("el-form-item",{attrs:{label:"发货日期",prop:"shippingDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",placeholder:"请选择日期"},model:{value:e.form.shippingDate,callback:function(t){e.$set(e.form,"shippingDate",t)},expression:"form.shippingDate"}})],1),a("el-form-item",{attrs:{label:"操作员",prop:"operator"}},[a("el-input",{attrs:{placeholder:"请输入操作员"},model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}})],1)],1)],1)},d=[],p=a("f36f"),u=a("c596"),m=a("1ab1"),h={name:"DeliveryBaseInfo",props:{itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请填写电信运营商名称",trigger:"blur"}]},form:this.resetForm()}},components:{BizGrid:p["a"]},methods:{operate:function(e){this[e]()},resetForm:function(){return{sn:"",orderSn:"",logistics:"",expressSn:"",freight:"",consignee:"",address:"",phone:"",shippingDate:"",operator:"",memo:""}},clear:function(){this.form=this.resetForm(),this.$refs.form.resetFields()},refresh:function(){var e=this;this.loading=!0;var t=this.itemId;m["a"].get(u["l"].delivery.baseInfo.query,t).then((function(t){e.loading=!1,e.form=Object.assign(e.resetForm(),t.content)})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),e.$message.warning(t.errorMessage)}))},showMessage:function(e,t){this.$notify({message:e,type:t,showClose:!0})}},mounted:function(){this.itemId.id&&this.refresh()},watch:{itemId:function(e,t){console.log(1111),this.clear(),""!==e.id&&this.refresh()}}},f=h,g=(a("6759"),a("2877")),v=Object(g["a"])(f,c,d,!1,null,null,null),b=v.exports,y=a("2f62"),w=a("934e"),x=a("276c"),I=a("2c2c"),C=a("fc46"),_=a("c466"),k=a("225d"),S=a("bc3a"),M=a.n(S),D={name:"DeliveryMgmt",data:function(){return{exportFile:!1,currentRowId:{id:""},relateBillId:"",orderId:{id:""},sn:"",dialogTableVisible:!1,openOrder:!1,editable:!0,openPurchaseOrder:!1,openLogistics:!1,openReview:!1,openInfo:!0,gridData:[],form:{},operations:[{label:"导出",name:"export",type:"",auth:["admin:shipping.export"]},{label:"刷新",name:"refresh",type:""}],filters:[{type:"daterange",label:"日期区间",value:[_["a"].lastMonthDate(),_["a"].nowDate()]},{type:"input",value:"",placeholder:"请输入编号/订单号/姓名/电话"}],loading:!1,title:"",itemId:"",orderProperty:"",tableData:[],shipping:{},logisticCompany:"",multiSelected:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},open:!1,isUpdate:!1,tabName:"first"}},components:{BizFlexTable:n["c"],BizPopupTabs:l["a"],BaseInfo:b,vueEasyPrint:k["a"],OrderBaseInfo:w["a"],PurchaseOrderInfo:x["a"],LogisticsFollowing:I["a"],MyEvaluate:C["a"]},methods:Object(o["a"])(Object(o["a"])({},Object(y["c"])(["getUser"])),{},{operate:function(e){this[e]()},print:function(){this.$refs.easyPrint.print()},close:function(){this.open=!1,this.openOrder=!1},clickOrder:function(e,t){var a=this;"purchaseOrder"===t.orderDType?(this.tabName="order",this.openPurchaseOrder=!0,this.openOrder=!1,this.relateBillId=t.orderId,this.$nextTick((function(){a.$refs.orderinfo.getOrderInfo()})),this.open=!0):(this.tabName="first",this.openOrder=!0,this.openPurchaseOrder=!1,this.orderId={id:t.orderId},this.open=!0)},closeTabByLogistics:function(e){var t=this;this.open=!1,this.tabName="loginfo",this.sn=e,this.openLogistics=!0,this.$nextTick((function(){t.$refs.logistics.getLogisticsInfo()}))},closeTabByEvaluate:function(e){var t=this;this.open=!1,this.editable=!1,this.tabName="reviewinfo",this.itemId=e,this.openReview=!0,this.$nextTick((function(){t.$refs.reviewinfo.getEvaluationInfo()}))},certificate:function(e){var t=this;if(this.logisticCompany=e.logistics,"purchaseOrder"===e.orderDType){var a={orderId:e.orderId,shopId:window.top.SHOP_ID||""};m["a"].get("/admin/purchaseOrderManage/voucher/shipping.jhtml",a).then((function(e){t.dialogTableVisible=!0,t.title=t.getUser().shop?t.getUser().shop.name+"发货单":"发货单",t.form=e.order,t.shipping=e.shipping,t.userCard=e.userCard,t.gridData=e.order.orderItems})).catch((function(e){t.loading=!1,console.log("ERR_REFRESH: ",e),t.$message.warning(e.errorMessage)}))}else{var r={orderId:e.orderId,shopId:window.top.SHOP_ID||""};m["a"].get(u["l"].delivery.queryShippingVoucher,r).then((function(e){t.dialogTableVisible=!0,t.title=t.getUser().shop?t.getUser().shop.name+"发货单":"发货单",t.form=e.order,t.shipping=e.shipping,t.userCard=e.userCard,t.gridData=e.order.orderItems})).catch((function(e){t.loading=!1,console.log("ERR_REFRESH: ",e),t.$message.warning(e.errorMessage)}))}},formatDate:function(e){var t=new Date(e),a=t.getFullYear(),r=t.getMonth()+1,s=t.getDate(),i=a+"-"+(r<10?"0"+r:r)+"-"+(s<10?"0"+s:s);return i},del:function(e){var t=this,a=e?Array(e):0===this.multiSelected.length?[]:this.multiSelected;0!==a.length?this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e={ids:a};t.loading=!0,m["a"].post(u["l"].delivery.delete,e).then((function(e){t.loading=!1,t.$message.success("操作成功"),t.refresh()})).catch((function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))})):this.$message.warning("未选择删除条目")},export:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={shopId:window.top.SHOP_ID||"",beginTime:e.filters[0].value[0]?e.filters[0].value[0]+" 00:00:00":"",endTime:e.filters[0].value[1]?e.filters[0].value[1]+" 23:59:59":"",searchValue:e.filters[1].value||"",ids:e.multiSelected},t.prev=1,t.next=4,M.a.post(u["l"].delivery.export,a,{responseType:"blob"});case 4:return r=t.sent,console.log("response => ",r),s=new Blob([r.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(r.headers["content-disposition"])),i=decodeURI(r.headers["content-disposition"].split("filename=")[1]),o=document.createElement("a"),o.download=i.match(/"(\S*)"/)[1],o.style.display="none",o.href=URL.createObjectURL(s),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o),t.abrupt("return");case 20:throw t.prev=20,t.t0=t["catch"](1),new Error(t.t0);case 23:case"end":return t.stop()}}),t,null,[[1,20]])})))()},filterDataChange:function(e){this.filters=e,this.pagination.currentPage=1,this.refresh()},handleSelectionChange:function(e){this.multiSelected=e.map((function(e){return e.id})),this.operations[2].disabled=!0,e.length>0&&(this.operations[2].disabled=!1)},rowClick:function(e){this.currentRowId={id:e.id},this.tabName="first",this.open=!0,this.openOrder=!1,this.openPurchaseOrder=!1},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},refresh:function(e){var t=this;this.loading=!0;var a={shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,orderDirection:e,orderProperty:this.orderProperty,searchValue:this.filters[1].value,beginTime:this.filters[0].value[0]||"",endTime:this.filters[0].value[1]||""};m["a"].get(u["l"].delivery.queryList,a).then((function(e){t.loading=!1,t.pagination.total=Number(e.total),t.tableData=e.content})).catch((function(e){t.loading=!1,console.log("ERR_REFRESH: ",e),t.$message.warning(e.errorMessage)}))},sortChange:function(e){this.orderProperty=e.column?e.column.property:"",this.refresh({ascending:"asc",descending:"desc"}[e.order])},showMessage:function(e,t){this.$message({message:e,type:t,showClose:!0})},queryInfo:function(){var e=this,t={type:"shipping"};m["a"].get(u["l"].delivery.queryInfo,t).then((function(t){e.showMessage("今日新增发货记录".concat(t.data.dayShippingCount,"条,本月累计发货记录").concat(t.data.monthShippingCount,"条"),"info")})).catch()}}),mounted:function(){this.queryInfo(),this.refresh()},computed:{},watch:{open:function(e,t){!e&&this.isUpdate&&(this.refresh(),this.isUpdate=!1)}}},$=D,T=(a("9780"),Object(g["a"])($,r,s,!1,null,null,null));t["default"]=T.exports},"0a05":function(e,t,a){},2119:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-avatar-uploader-multi"},[a("div",{staticClass:"el-upload-list el-upload-list--picture-card"},[e._l(e.value,(function(t){return a("div",{key:t.index,staticClass:"el-upload-list__item is-success",attrs:{tabindex:"0"}},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:t,alt:""}}),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(a){return e.handlePictureCardPreview(t)}}},[a("i",{staticClass:"el-icon-zoom-in"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.isShowDelete,expression:"isShowDelete"}],staticClass:"el-upload-list__item-delete",on:{click:function(a){return e.handleRemove(t)}}},[a("i",{staticClass:"el-icon-delete"})])])])})),e.showUploader?a("el-upload",{ref:"upload",class:e.disabled?"avatar-uploader-disabled":"avatar-uploader",style:e.avatarStyle,attrs:{multiple:"","show-file-list":!1,accept:"image/*",limit:Number(e.limit),"file-list":e.fileList,data:e.fileData,"on-success":e.handleSuccess,"on-exceed":e.handleExceed,name:"file",action:"/admin/file/uploads.jhtml",disabled:e.disabled}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon",style:e.plusStyle})]):e._e()],2),a("el-dialog",{attrs:{visible:e.dialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},s=[],i=(a("99af"),a("d81d"),a("a434"),a("ac1f"),a("1276"),{name:"ImgUploader",props:{value:{type:Array,default:function(){return[]}},imageForm:{type:Array,default:function(){return[]}},showUploader:{type:Boolean,default:function(){return!0}},size:{type:Object,default:function(){return{width:100,height:100}}},limit:{default:"9"},disabled:{type:Boolean,default:function(){return!1}},isShowDelete:{type:Boolean,default:function(){return!0}}},data:function(){return{fileData:{type:"0"},fileList:[],dialogVisible:!1,dialogImageUrl:""}},methods:{handleSuccess:function(e){var t=this.value.concat(e.fis[0].url);this.$emit("input",t)},handleExceed:function(e,t){this.$message.warning("只能上传".concat(this.limit,"张图片"))},handleRemove:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.removePic(e)}))},removePic:function(e){for(var t=this.value,a=0;a<t.length;a++)t[a]===e&&t.splice(a,1);this.$emit("input",t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e,this.dialogVisible=!0}},computed:{plusStyle:function(){return{"line-height":this.size.height+"px"}},avatarStyle:function(){return{height:this.size.height+"px",width:this.size.width+"px"}}},watch:{value:function(e,t){console.log("value: ",this.value),this.fileList=e.map((function(e){return{name:e.split("/")[e.split("/").length-1],url:e}}))}},components:{}}),o=i,n=(a("d74a"),a("2877")),l=Object(n["a"])(o,r,s,!1,null,null,null);t["a"]=l.exports},"21c5":function(e,t,a){},6213:function(e,t,a){},6759:function(e,t,a){"use strict";var r=a("ffa0"),s=a.n(r);s.a},"934e":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"store-value-mgmt-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"order",attrs:{rules:e.rules,model:e.order,disabled:"","label-width":"100px",size:"small","inline-message":!0}},[a("el-form-item",{attrs:{label:"订单编号",prop:"sn"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.sn,callback:function(t){e.$set(e.order,"sn",t)},expression:"order.sn"}})],1),a("el-form-item",{attrs:{label:"订单状态",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.order.type,callback:function(t){e.$set(e.order,"type",t)},expression:"order.type"}},[a("el-option",{attrs:{value:"0",label:"全部"}}),a("el-option",{attrs:{value:"1",label:"待商家确认"}}),a("el-option",{attrs:{value:"2",label:"商家已确认"}}),a("el-option",{attrs:{value:"3",label:"买家已付款"}}),a("el-option",{attrs:{value:"4",label:"订单已执行"}}),a("el-option",{attrs:{value:"5",label:"交易完成"}}),a("el-option",{attrs:{value:"6",label:"交易关闭"}}),a("el-option",{attrs:{value:"7",label:"已评价"}}),a("el-option",{attrs:{value:"8",label:"订单过期"}}),a("el-option",{attrs:{value:"9",label:"退款退货中"}}),a("el-option",{attrs:{value:"10",label:"退款退货完成"}})],1)],1),a("el-form-item",{attrs:{label:"订单金额",prop:"amount"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.amount,callback:function(t){e.$set(e.order,"amount",t)},expression:"order.amount"}})],1),a("el-form-item",{attrs:{label:"调整金额",prop:"offsetAmount"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.offsetAmount,callback:function(t){e.$set(e.order,"offsetAmount",t)},expression:"order.offsetAmount"}})],1),a("el-form-item",{attrs:{label:"实付金额",prop:"amountPaid"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.amountPaid,callback:function(t){e.$set(e.order,"amountPaid",t)},expression:"order.amountPaid"}})],1),a("el-collapse",{model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[a("el-collapse-item",{attrs:{name:"customerInfo"}},[a("template",{slot:"title"},[a("span",{staticClass:"collapse-title"},[e._v("客户信息")])]),a("el-form-item",{attrs:{label:"会员昵称"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.member.nickname,callback:function(t){e.$set(e.order.member,"nickname",t)},expression:"order.member.nickname"}})],1),a("el-form-item",{attrs:{label:"性别"}},[a("el-select",{attrs:{placeholder:""},model:{value:e.order.member.gender,callback:function(t){e.$set(e.order.member,"gender",t)},expression:"order.member.gender"}},[a("el-option",{attrs:{label:"男",value:"0"}}),a("el-option",{attrs:{label:"女",value:"1"}}),a("el-option",{attrs:{label:"保密",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"电话"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.member.mobile,callback:function(t){e.$set(e.order.member,"mobile",t)},expression:"order.member.mobile"}})],1),a("el-form-item",{attrs:{label:"车辆"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.car.plateNumber,callback:function(t){e.$set(e.order.car,"plateNumber",t)},expression:"order.car.plateNumber"}})],1)],2),a("el-collapse-item",{attrs:{name:"serviceInfo"}},[a("template",{slot:"title"},[a("span",{staticClass:"collapse-title"},[e._v("服务信息")])]),a("el-form-item",{attrs:{label:"顾问"}},[a("el-select",{attrs:{placeholder:""},model:{value:e.order.consultant.id,callback:function(t){e.$set(e.order.consultant,"id",t)},expression:"order.consultant.id"}},[a("el-option",{attrs:{label:e.order.consultant.userName,value:e.order.consultant.id}})],1)],1),a("el-form-item",{attrs:{label:"地区"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.areaName,callback:function(t){e.$set(e.order,"areaName",t)},expression:"order.areaName"}})],1),a("el-form-item",{attrs:{label:"服务地址"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.address,callback:function(t){e.$set(e.order,"address",t)},expression:"order.address"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{placeholder:"",type:"textarea"},model:{value:e.order.memo,callback:function(t){e.$set(e.order,"memo",t)},expression:"order.memo"}})],1)],2),a("el-collapse-item",{attrs:{name:"promotionInfo"}},[a("template",{slot:"title"},[a("span",{staticClass:"collapse-title"},[e._v("优惠信息")])]),a("el-form-item",{attrs:{label:"销售折扣"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.promotionDiscount,callback:function(t){e.$set(e.order,"promotionDiscount",t)},expression:"order.promotionDiscount"}})],1),a("el-form-item",{attrs:{label:"优惠券折扣"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.couponDiscount,callback:function(t){e.$set(e.order,"couponDiscount",t)},expression:"order.couponDiscount"}})],1),a("el-form-item",{attrs:{label:"V豆抵扣"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.beanDiscount,callback:function(t){e.$set(e.order,"beanDiscount",t)},expression:"order.beanDiscount"}})],1),a("el-form-item",{attrs:{label:"赠送积分"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.point,callback:function(t){e.$set(e.order,"point",t)},expression:"order.point"}})],1),a("el-form-item",{attrs:{label:"赠送V豆"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.giftBean,callback:function(t){e.$set(e.order,"giftBean",t)},expression:"order.giftBean"}})],1)],2),a("el-collapse-item",{attrs:{name:"paymentInfo"}},[a("template",{slot:"title"},[a("span",{staticClass:"collapse-title"},[e._v("付款信息")])]),a("el-form-item",{attrs:{label:"支付方式"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.paymentMethodName,callback:function(t){e.$set(e.order,"paymentMethodName",t)},expression:"order.paymentMethodName"}})],1),a("el-form-item",{attrs:{label:"付款方式"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.order.paymentTypeName,callback:function(t){e.$set(e.order,"paymentTypeName",t)},expression:"order.paymentTypeName"}})],1),"会员卡余额"===e.order.payments[0].paymentType?a("el-form-item",{attrs:{label:"会员卡",prop:"payments[0].memberCardId"}},[a("el-select",{attrs:{disabled:"",placeholder:"请选择会员卡"},model:{value:e.order.payments[0].memberCardId,callback:function(t){e.$set(e.order.payments[0],"memberCardId",t)},expression:"order.payments[0].memberCardId"}},e._l(e.listExistCard,(function(e,t){return a("el-option",{key:t,attrs:{label:e.template.name,value:e.id}})})),1)],1):e._e(),"刷卡"===e.order.payments[0].paymentType||"汇款"===e.order.payments[0].paymentType?a("el-form-item",{attrs:{label:"付款银行",prop:"payments[0].payBank"}},[a("el-input",{attrs:{placeholder:"请输入付款银行"},model:{value:e.order.payments[0].payBank,callback:function(t){e.$set(e.order.payments[0],"payBank",t)},expression:"order.payments[0].payBank"}})],1):e._e(),"刷卡"===e.order.payments[0].paymentType||"汇款"===e.order.payments[0].paymentType?a("el-form-item",{attrs:{label:"付款账号",prop:"payments[0].payAccount"}},[a("el-input",{attrs:{placeholder:"请输入付款账号"},model:{value:e.order.payments[0].payAccount,callback:function(t){e.$set(e.order.payments[0],"payAccount",t)},expression:"order.payments[0].payAccount"}})],1):e._e()],2),a("el-collapse-item",{attrs:{name:"logisticsInfo"}},[a("template",{slot:"title"},[a("span",{staticClass:"collapse-title"},[e._v("物流信息")])]),a("el-form-item",{attrs:{label:"配送方式"}},[a("el-select",{attrs:{placeholder:"请选择配送方式"},model:{value:e.shippingMethodId,callback:function(t){e.shippingMethodId=t},expression:"shippingMethodId"}},e._l(e.shippingMethods,(function(e){return a("el-option",{key:e.index,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.shippingMethodId,expression:"shippingMethodId"}],attrs:{label:"物流公司",prop:"shippings[0].logistics"}},[a("el-input",{attrs:{placeholder:"请选择物流公司"},model:{value:e.order.shippings[0].logistics,callback:function(t){e.$set(e.order.shippings[0],"logistics",t)},expression:"order.shippings[0].logistics"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.shippingMethodId,expression:"shippingMethodId"}],attrs:{label:"物流单号",prop:"shippings[0].expressSn"}},[a("el-input",{attrs:{placeholder:"请输入物流单号"},model:{value:e.order.shippings[0].expressSn,callback:function(t){e.$set(e.order.shippings[0],"expressSn",t)},expression:"order.shippings[0].expressSn"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.shippingMethodId,expression:"shippingMethodId"}],attrs:{label:"物流费用",prop:"shippings[0].freight"}},[a("el-input",{attrs:{placeholder:"请输入物流费用"},model:{value:e.order.shippings[0].freight,callback:function(t){e.$set(e.order.shippings[0],"freight",t)},expression:"order.shippings[0].freight"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.shippingMethodId,expression:"shippingMethodId"}],attrs:{label:"收货地址",prop:"shippings[0].address"}},[a("el-input",{attrs:{placeholder:"请输入收货地址"},model:{value:e.order.shippings[0].address,callback:function(t){e.$set(e.order.shippings[0],"address",t)},expression:"order.shippings[0].address"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.shippingMethodId,expression:"shippingMethodId"}],attrs:{label:"收货人",prop:"shippings[0].consignee"}},[a("el-input",{attrs:{placeholder:"请输入收货人"},model:{value:e.order.shippings[0].consignee,callback:function(t){e.$set(e.order.shippings[0],"consignee",t)},expression:"order.shippings[0].consignee"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.shippingMethodId,expression:"shippingMethodId"}],attrs:{label:"电话",prop:"shippings[0].phone"}},[a("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.order.shippings[0].phone,callback:function(t){e.$set(e.order.shippings[0],"phone",t)},expression:"order.shippings[0].phone"}})],1)],2),a("el-collapse-item",{attrs:{name:"invoiceInfo"}},[a("template",{slot:"title"},[a("span",{staticClass:"collapse-title"},[e._v("发票信息")])]),a("el-form-item",{attrs:{label:"是否需要发票",prop:"invoiceState"}},[a("el-select",{attrs:{disabled:!0},model:{value:e.order.invoiceState,callback:function(t){e.$set(e.order,"invoiceState",t)},expression:"order.invoiceState"}},[a("el-option",{attrs:{label:"否",value:e.order.invoiceState}}),a("el-option",{attrs:{label:"是",value:e.order.invoiceState}})],1)],1)],2),a("el-collapse-item",{attrs:{name:"otherInfo"}},[a("template",{slot:"title"},[a("span",{staticClass:"collapse-title"},[e._v("其他信息")])]),a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd"},model:{value:e.order.orderTime,callback:function(t){e.$set(e.order,"orderTime",t)},expression:"order.orderTime"}})],1),a("el-form-item",{attrs:{label:"执行时间"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd"},model:{value:e.order.deliveryTime,callback:function(t){e.$set(e.order,"deliveryTime",t)},expression:"order.deliveryTime"}})],1),a("el-form-item",{attrs:{label:"付款时间"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd"},model:{value:e.order.payments[0].paymentDate,callback:function(t){e.$set(e.order.payments[0],"paymentDate",t)},expression:"order.payments[0].paymentDate"}})],1),a("el-form-item",{attrs:{label:"完成时间"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd"},model:{value:e.order.orderTime,callback:function(t){e.$set(e.order,"orderTime",t)},expression:"order.orderTime"}})],1)],2)],1)],1)],1)},s=[],i=(a("99af"),a("d81d"),a("b0c0"),a("f36f")),o=a("8330"),n=a("e42c"),l=a("c596"),c=a("1ab1"),d={name:"StoreValueMgmtBaseInfo",props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{activeTabName:"",loading:!1,operations:[],rules:{},adminCurrentId:"",afterSales:[],listExistCard:[],consultants:[],adminCurrent:[],order:this.resetOrder(),shippingMethodId:"",shippingMethods:[]}},components:{BizGrid:i["a"],BizSaveButton:o["a"]},methods:{operate:function(e){this[e]()},resetOrder:function(){return{sn:"",type:"",userId:"",amount:"",offsetAmount:"",amountPaid:"",member:{},car:{},consultant:{},area:"",consignee:"",areaName:"",address:"",phone:"",memo:"",promotionDiscount:"",couponDiscount:"",beanDiscount:"",point:"",giftBean:"",paymentMethodName:"",paymentTypeName:"",payments:[{}],payAccount:"",shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",phone:"",zipCode:""}],invoiceState:"",invoiceType:"",invoiceTitle:"",taxNumber:"",orderTime:"",deliveryTime:"",paymentTime:"",completeTime:""}},resetForm:function(){return{order:{}}},clear:function(){this.activeTabName="",this.form=this.resetForm()},refresh:function(){var e=this;this.loading=!0;var t={orderId:this.itemId.id};c["a"].get(l["i"].store.baseInfo.query,t).then((function(t){e.loading=!1,e.adminCurrentId=t.adminCurrent.id,e.afterSales=t.afterSales,e.shippingMethods=t.shippingMethods,t.shippingMethods.map((function(a){t.order.shippingMethodName===a.name&&(e.shippingMethodId=a.id)})),e.order=Object.assign(e.resetOrder(),t.order),e.order.payments.length||(e.order.payments=[{}]),0===e.order.shippings.length&&(e.order.shippings=[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:e.order.areaName?e.order.areaName+e.order.address:e.order.address,consignee:e.order.consignee,phone:e.order.phone,zipCode:e.order.zipCode}]),e.adminCurrent=[{id:t.adminCurrent.id,name:t.adminCurrent.realName}],e.order.consultant.id?e.adminCurrent=[{id:e.order.consultant.id,name:e.order.consultant.realName}]:e.order.consultant={id:t.adminCurrent.id,userName:t.adminCurrent.realName},e.listExistCardTemplate()})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),e.$message.warning(t.errorMessage)}))},listAdminByRole:function(){var e=this,t="";t="car"===this.$route.params.orderType?["salesman"]:["afterSale","reception","testDriver"],n["a"].listAdminByRole({roleTypes:t},(function(t){e.loading=!1,e.flag=!1,console.log(e.form.consultant.id),t.dataList.map((function(t){t.id===e.adminCurrent[0].id&&(e.flag=!0)})),e.flag?e.consultants=t.dataList:e.consultants=t.dataList.concat(e.adminCurrent)}),(function(e){console.log(e)}))},save:function(){var e=this;this.$refs.form.validate((function(t){t&&e.submit()}))},submit:function(){this.itemId.id?this.update():this.create()},listExistCardTemplate:function(){var e=this;n["a"].listExistCardTemplate({userId:this.order.userId},(function(t){e.loading=!1,e.listExistCard=t.content}),(function(e){console.log(e)}))},create:function(){var e=this;this.loading=!0;var t=this.form;c["a"].post(l["i"].store.baseInfo.create,t).then((function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("update"),e.form=e.resetForm()})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},update:function(){var e=this;this.loading=!0;var t=Object.assign(this.form,this.itemId);c["a"].put(l["i"].store.baseInfo.update,t).then((function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("update"),e.refresh()})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},showMessage:function(e,t){this.$notify({message:e,type:t,showClose:!0})}},mounted:function(){this.itemId.id&&this.refresh()},watch:{itemId:function(e,t){this.clear(),""!==e.id&&this.refresh()}}},p=d,u=(a("d1ce"),a("2877")),m=Object(u["a"])(p,r,s,!1,null,null,null);t["a"]=m.exports},9780:function(e,t,a){"use strict";var r=a("6213"),s=a.n(r);s.a},"9b2e":function(e,t,a){"use strict";var r=a("0a05"),s=a.n(r);s.a},b4ab:function(e,t,a){},c466:function(e,t,a){"use strict";a("99af"),a("d3b7"),a("ac1f"),a("25f0"),a("5319");t["a"]={nowDate:function(){var e=new Date,t=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()+1<10?"0"+e.getDate():e.getDate();return e.getFullYear().toString()+"-"+t+"-"+a},getMonthDays:function(e){var t=new Date(Date.parse(e.replace(/-/g,"/"))),a=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth()+1,1),s=(r-a)/864e5;return s},halfYearAgo:function(e){var t="";return t=e?new Date(Date.parse(e.replace(/-/g,"/"))):new Date,console.log(t),t.setMonth(t.getMonth()-6),"".concat(t.getFullYear(),"-").concat(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getDate()<10?"0"+t.getDate():t.getDate())},lastMonthDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1<10?"0"+e.getMonth():e.getMonth(),r=e.getDate()+1<10?"0"+e.getDate():e.getDate();return"00"===a&&(a="12",t--),t.toString()+"-"+a+"-"+r},nextMonthDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,r=e.getDate(),s=parseInt(a)+1;13===s&&(t=parseInt(t)+1,s=1);var i=new Date(t,s,0);return i=i.getDate(),r>i&&(r=i),s<10&&(s="0"+s),t+"-"+s+"-"+r},lastYearDate:function(){var e=new Date,t=new Date(e.getFullYear()-1,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastTwoYearDate:function(){var e=new Date,t=new Date(e.getFullYear()+2,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastNYearDate:function(e,t){var a=new Date(e),r=new Date(a.getFullYear()+parseInt(t),a.getMonth(),a.getDate());return r.getFullYear()+"-"+this.convertToFullMode(r.getMonth()+1)+"-"+this.convertToFullMode(r.getDate())},dateConverter:function(e){return e instanceof Date?e.getFullYear()+"-"+this.convertToFullMode(e.getMonth()+1)+"-"+this.convertToFullMode(e.getDate()):e},timeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes())+":"+this.convertToFullMode(e.getSeconds()):e},shortTimeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes()):e},dateTimeConverter:function(e){return e instanceof Date?this.dateConverter(e)+" "+this.timeConverter(e):e},convertToFullMode:function(e){return e=e.toString(),1===e.length?"0"+e:e}}},d1ce:function(e,t,a){"use strict";var r=a("b4ab"),s=a.n(r);s.a},d74a:function(e,t,a){"use strict";var r=a("21c5"),s=a.n(r);s.a},fc46:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-evaluate"},[a("div",{staticClass:"evaluate-content"},[e.orderInfo&&e.reviews.length?a("div",e._l(e.orderInfo.orderItems,(function(t,r){return a("div",{key:r,staticClass:"my-evaluate-div"},[a("div",{staticClass:"order-info"},[a("div",{staticClass:"info"},[a("img",{attrs:{src:t.thumbnail?t.thumbnail:e.defaultImg},on:{error:e.errorHandle}}),a("div",{staticClass:"info-right"},[a("span",[e._v(e._s(t.name))]),a("span",[e._v("￥"+e._s(e.getAmount(t)))])])])]),e.editable&&t.product?a("div",{staticClass:"evaluate"},[a("div",{staticClass:"title",staticStyle:{"align-items":"center",float:"left"}},[a("span",{staticClass:"iconfont biz-icon-shangpin",staticStyle:{"font-size":"26px",padding:"0px 30px"}}),a("span",{staticStyle:{"padding-right":"30px","font-size":"14px"}},[e._v("商品评分")]),a("el-radio-group",{staticStyle:{height:"10px"},attrs:{horizontal:!0},model:{value:e.reviews[r].score,callback:function(t){e.$set(e.reviews[r],"score",t)},expression:"reviews[index].score"}},e._l(e.options,(function(e,t){return a("el-radio",{key:t,attrs:{label:e}})})),1)],1),a("el-input",{attrs:{type:"textarea",size:"mini",placeholder:"来分享您的使用感受吧...",maxlength:e.maxlength},model:{value:e.reviews[r].content,callback:function(t){e.$set(e.reviews[r],"content",t)},expression:"reviews[index].content"}}),a("img-uploader",{model:{value:e.reviews[r].images,callback:function(t){e.$set(e.reviews[r],"images",t)},expression:"reviews[index].images"}})],1):e._e(),!e.editable&&t.product?a("div",{staticClass:"evaluate-dis"},[a("div",{staticClass:"title",staticStyle:{"align-items":"center",float:"left"}},[a("span",{staticClass:"iconfont biz-icon-shangpin",staticStyle:{"font-size":"26px"}}),a("span",{staticStyle:{"padding-right":"30px","font-size":"14px"}},[e._v("商品评分")]),a("span",[e._v(e._s(e.reviews[r].score?e.已reviews[r].score:""))])]),a("div",{staticClass:"eva-content"},[a("p",{staticStyle:{"margin-bottom":"10px","margin-left":"20px"}},[e._v(e._s(e.reviews[r].content?e.reviews[r].content:"很遗憾，您没有留下任何评价。"))]),a("div",{staticClass:"img-group",staticStyle:{"margin-left":"20px"}},e._l(e.reviews[r].images,(function(t,s){return a("div",{key:s,staticClass:"img-eva"},[t?a("img",{attrs:{src:t},on:{click:function(t){return e.handleImagePreview(e.reviews[r].images,s)}}}):e._e()])})),0)])]):e._e()])})),0):e._e(),a("div",{staticClass:"shop-evaluate"},[a("div",{staticClass:"shop-title"},[a("img",{attrs:{src:e.iconShop}}),a("span",{staticStyle:{fontSize:"14px"}},[e._v("店铺评分")])]),a("div",{staticClass:"shop-item"},[a("span",{staticClass:"label"},[e._v("服务态度")]),a("el-rate",{staticClass:"rate",attrs:{disabled:!e.editable},model:{value:e.serValue,callback:function(t){e.serValue=t},expression:"serValue"}})],1),a("div",{staticClass:"shop-item"},[a("span",{staticClass:"label"},[e._v("服务速度")]),a("el-rate",{staticClass:"rate",attrs:{disabled:!e.editable},model:{value:e.speedValue,callback:function(t){e.speedValue=t},expression:"speedValue"}})],1),a("div",{staticClass:"shop-item"},[a("span",{staticClass:"label"},[e._v("专业技能")]),a("el-rate",{staticClass:"rate",attrs:{disabled:!e.editable},model:{value:e.proValue,callback:function(t){e.proValue=t},expression:"proValue"}})],1)])]),e.editable?a("div",{staticClass:"submit"},[a("span",{staticClass:"btn-submit",on:{click:e.submitEvaluate}},[e._v("提交评价")])]):e._e()])},s=[],i=(a("4160"),a("d81d"),a("a434"),a("a9e3"),a("b680"),a("d3b7"),a("25f0"),a("159b"),a("b85c")),o=a("5530"),n=a("2f62"),l=a("1ab1"),c=a("c596"),d=a("624d"),p=a.n(d),u=a("517a"),m=a.n(u),h=a("2119"),f=a("f606"),g=a.n(f),v={name:"my-evaluate",data:function(){return{iconShop:g.a,defaultImg:p.a,defaultFailImg:m.a,selected:"好评",options:["好评","中评","差评"],evaluateValue:"",maxlength:100,serValue:5,speedValue:5,proValue:5,reviews:[],info:null,initialIndex:0}},props:{orderId:{type:String,default:""},editable:{type:Boolean,default:function(){return!0}}},components:{ImgUploader:h["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])("Order",["orderInfo"])),Object(n["c"])(["getUser"])),watch:{orderId:function(e,t){this.getParams(),this.getOrderInfo()}},methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateOrderInfo"])),{},{showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},images:function(e){var t,a=[],r=Object(i["a"])(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;a.push(s)}}catch(o){r.e(o)}finally{r.f()}return a},handleImagePreview:function(e,t){var a=this;this.initialIndex=t;var r=[];e.map((function(e){r.push(e)}));var s={$props:{imgs:r,initialIndex:"initialIndex",loop:!1},$events:{change:function(e){a.initialIndex=e}}};this.$createImagePreview(Object(o["a"])({},s)).show()},getAmount:function(e){var t=Number(e.price)*Number(e.quantity);return t.toFixed(2)},submitEvaluate:function(){for(var e=this,t={serviceAttitude:this.serValue.toString(),serviceSpeed:this.speedValue.toString(),professional:this.proValue.toString(),methodName:"CreateProductReview",clientType:"2",shopId:this.getUser.shop.id,orderId:this.orderInfo.id,userId:this.getUser.id},a=this.orderInfo.orderItems,r=a.length,s=this.reviews,i=!1,o=0;o<r;o++){if(s[o]&&("好评"===s[o].score?(s[o].score="5",i=!0):"中评"===s[o].score?(s[o].score="3",i=!0):"差评"===s[o].score&&(s[o].score="1",i=!0)),!i&&a[o].product)return void this.$message.warning("请选择商品评分");a[o].product&&(s[o].images=this.images(s[o].images))}a.forEach((function(e,t){if(!e.product)return s.splice(t,1),!1})),i&&(t.reviews=this.reviews),l["a"].post(c["g"].hypermarketMgmt.review,t).then((function(t){e.$message.success("评价成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){}))},errorHandle:function(e){e.currentTarget.src=this.defaultFailImg},getOrderInfo:function(e){var t=this;this.open=!1;var a="";a=e||this.orderId;var r={clientType:this.clientType,methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:a};l["a"].get(c["g"].hypermarketMgmt.queryOrder,r).then((function(e){console.log("订单信息",e);var r,s,i=e.order.orderItems,o=i.length;for(t.reviews=[],s=0;s<o;s++)r={score:"",content:"",reviewOrderId:e.order.id,images:[]},i[s].product&&(r.productId=i[s].product.id),t.reviews.push(r);t.editable?t.updateOrderInfo(e.order):(t.info=e.order,t.getEvaluationInfo(a))})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){}))},getParams:function(){this.editable=!0},getEvaluationInfo:function(e){var t=this,a={clientType:this.clientType,methodName:"QueryOrderReview",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:e};l["a"].get(c["g"].hypermarketMgmt.reviews,a).then((function(e){if(console.log(e),t.serValue=parseInt(e.serviceAttitude),t.speedValue=parseInt(e.serviceSpeed),t.proValue=parseInt(e.professional),e.reviews.length!==t.reviews.length){var a={score:"",content:"",images:[]};e.reviews.unshift(a)}t.reviews=e.reviews;for(var r=t.reviews,s=r.length,i=0;i<s;i++)"5"===r[i].score?r[i].score="好评":"3"===r[i].score?r[i].score="中评":"1"===r[i].score&&(r[i].score="差评");t.updateOrderInfo(t.info)})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){}))}}),created:function(){}},b=v,y=(a("9b2e"),a("2877")),w=Object(y["a"])(b,r,s,!1,null,null,null);t["a"]=w.exports},ffa0:function(e,t,a){}}]);