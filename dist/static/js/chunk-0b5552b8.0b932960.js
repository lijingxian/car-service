(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b5552b8","chunk-4bb544e8","chunk-6e4c4195","chunk-67ff175b","chunk-32f84450"],{"007c":function(e,t,i){"use strict";var a=i("f1b1"),r=i.n(a);r.a},"0130":function(e,t,i){"use strict";var a=i("6ecb"),r=i.n(a);r.a},"016c":function(e,t,i){var a=function(){var e=new Date,t=4,i=3,r=2,o=1,s=t,n={setLogLevel:function(e){s=e==this.debug?o:e==this.info?r:e==this.warn?i:(this.error,t)},debug:function(t,i){o>=s&&console.debug("["+a.getDurationString(new Date-e,1e3)+"]","["+t+"]",i)},info:function(t,i){r>=s&&console.info("["+a.getDurationString(new Date-e,1e3)+"]","["+t+"]",i)},warn:function(t,r){i>=s&&console.warn("["+a.getDurationString(new Date-e,1e3)+"]","["+t+"]",r)},error:function(i,r){t>=s&&console.error("["+a.getDurationString(new Date-e,1e3)+"]","["+i+"]",r)}};return n}();a.getDurationString=function(e,t){function i(e,t){var i=""+e,a=i.split(".");while(a[0].length<t)a[0]="0"+a[0];return a.join(".")}var a=t||1,r=e/a,o=Math.floor(r/3600);r-=3600*o;var s=Math.floor(r/60);r-=60*s;var n=1e3*r;return r=Math.floor(r),n-=1e3*r,n=Math.floor(n),o+":"+i(s,2)+":"+i(r,2)+"."+i(n,3)},a.printRanges=function(e){var t=e.length;if(t>0){for(var i="",r=0;r<t;r++)r>0&&(i+=","),i+="["+a.getDurationString(e.start(r))+","+a.getDurationString(e.end(r))+"]";return i}return"(empty)"};var r=function(e){if(!(e instanceof ArrayBuffer))throw"Needs an array buffer";this.buffer=e,this.uint8=new Uint8Array(e),this.position=0};r.prototype.getPosition=function(){return this.position},r.prototype.getEndPosition=function(){return this.buffer.byteLength},r.prototype.getLength=function(){return this.buffer.byteLength},r.prototype.seek=function(e){var t=Math.max(0,Math.min(this.uint8.length,e));this.position=isNaN(t)||!isFinite(t)?0:t},r.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},r.prototype.readUint8=function(){var e;if(this.position+1<=this.uint8.length)return e=this.uint8[this.position],this.position++,e;throw"Not enough bytes in buffer"},r.prototype.readUint16=function(){var e,t,i;if(this.position+2<=this.uint8.length)return e=this.uint8[this.position],this.position++,t=this.uint8[this.position],this.position++,i=e<<8|t,i;throw"Not enough bytes in buffer"},r.prototype.readUint24=function(){var e;if(this.position+3<=this.uint8.length)return e=this.uint8[this.position]<<16,this.position++,e|=this.uint8[this.position]<<8,this.position++,e|=this.uint8[this.position],this.position++,e;throw"Not enough bytes in buffer"},r.prototype.readUint32=function(){var e;if(this.position+4<=this.uint8.length)return e=this.uint8[this.position]<<24,this.position++,e|=this.uint8[this.position]<<16,this.position++,e|=this.uint8[this.position]<<8,this.position++,e|=this.uint8[this.position],this.position++,e;throw"Not enough bytes in buffer"},r.prototype.readUint64=function(){var e;if(this.position+8<=this.uint8.length)return e=this.readUint32()<<32,e|=this.readUint32(),e;throw"Not enough bytes in buffer"},r.prototype.readString=function(e){if(this.position+e<=this.uint8.length){for(var t="",i=0;i<e;i++)t+=String.fromCharCode(this.readUint8());return t}throw"Not enough bytes in buffer"},r.prototype.readCString=function(){var e=[];while(1){var t=this.readUint8();if(0===t)break;e.push(t)}return String.fromCharCode.apply(null,e)},r.prototype.readInt8=function(){return this.readUint8()},r.prototype.readInt16=function(){return this.readUint16()},r.prototype.readInt32=function(){return this.readUint32()},r.prototype.readUint8Array=function(e){for(var t=[],i=0;i<e;i++)t[i]=this.readUint8();return t},r.prototype.readInt16Array=function(e){for(var t=[],i=0;i<e;i++)t[i]=this.readUint16();return t},r.prototype.readUint32Array=function(e){for(var t=[],i=0;i<e;i++)t[i]=this.readUint32();return t},r.prototype.readInt32Array=function(e){for(var t=[],i=0;i<e;i++)t[i]=this.readInt32();return t};var o=function(e,t,i){this._byteOffset=t||0,e instanceof ArrayBuffer?this.buffer=e:"object"==typeof e?(this.dataView=e,t&&(this._byteOffset+=t)):this.buffer=new ArrayBuffer(e||0),this.position=0,this.endianness=null==i?o.LITTLE_ENDIAN:i};o.prototype={},o.prototype.getPosition=function(){return this.position},o.prototype._realloc=function(e){if(this._dynamicSize){var t=this._byteOffset+this.position+e,i=this._buffer.byteLength;if(t<=i)t>this._byteLength&&(this._byteLength=t);else{i<1&&(i=1);while(t>i)i*=2;var a=new ArrayBuffer(i),r=new Uint8Array(this._buffer),o=new Uint8Array(a,0,r.length);o.set(r),this.buffer=a,this._byteLength=t}}},o.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var e=new ArrayBuffer(this._byteLength),t=new Uint8Array(e),i=new Uint8Array(this._buffer,0,t.length);t.set(i),this.buffer=e}},o.BIG_ENDIAN=!1,o.LITTLE_ENDIAN=!0,o.prototype._byteLength=0,Object.defineProperty(o.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(o.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(e){this._buffer=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(o.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(e){this._byteOffset=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(o.prototype,"dataView",{get:function(){return this._dataView},set:function(e){this._byteOffset=e.byteOffset,this._buffer=e.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+e.byteLength}}),o.prototype.seek=function(e){var t=Math.max(0,Math.min(this.byteLength,e));this.position=isNaN(t)||!isFinite(t)?0:t},o.prototype.isEof=function(){return this.position>=this._byteLength},o.prototype.mapUint8Array=function(e){this._realloc(1*e);var t=new Uint8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=1*e,t},o.prototype.readInt32Array=function(e,t){e=null==e?this.byteLength-this.position/4:e;var i=new Int32Array(e);return o.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),o.arrayToNative(i,null==t?this.endianness:t),this.position+=i.byteLength,i},o.prototype.readInt16Array=function(e,t){e=null==e?this.byteLength-this.position/2:e;var i=new Int16Array(e);return o.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),o.arrayToNative(i,null==t?this.endianness:t),this.position+=i.byteLength,i},o.prototype.readInt8Array=function(e){e=null==e?this.byteLength-this.position:e;var t=new Int8Array(e);return o.memcpy(t.buffer,0,this.buffer,this.byteOffset+this.position,e*t.BYTES_PER_ELEMENT),this.position+=t.byteLength,t},o.prototype.readUint32Array=function(e,t){e=null==e?this.byteLength-this.position/4:e;var i=new Uint32Array(e);return o.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),o.arrayToNative(i,null==t?this.endianness:t),this.position+=i.byteLength,i},o.prototype.readUint16Array=function(e,t){e=null==e?this.byteLength-this.position/2:e;var i=new Uint16Array(e);return o.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),o.arrayToNative(i,null==t?this.endianness:t),this.position+=i.byteLength,i},o.prototype.readUint8Array=function(e){e=null==e?this.byteLength-this.position:e;var t=new Uint8Array(e);return o.memcpy(t.buffer,0,this.buffer,this.byteOffset+this.position,e*t.BYTES_PER_ELEMENT),this.position+=t.byteLength,t},o.prototype.readFloat64Array=function(e,t){e=null==e?this.byteLength-this.position/8:e;var i=new Float64Array(e);return o.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),o.arrayToNative(i,null==t?this.endianness:t),this.position+=i.byteLength,i},o.prototype.readFloat32Array=function(e,t){e=null==e?this.byteLength-this.position/4:e;var i=new Float32Array(e);return o.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),o.arrayToNative(i,null==t?this.endianness:t),this.position+=i.byteLength,i},o.prototype.readInt32=function(e){var t=this._dataView.getInt32(this.position,null==e?this.endianness:e);return this.position+=4,t},o.prototype.readInt16=function(e){var t=this._dataView.getInt16(this.position,null==e?this.endianness:e);return this.position+=2,t},o.prototype.readInt8=function(){var e=this._dataView.getInt8(this.position);return this.position+=1,e},o.prototype.readUint32=function(e){var t=this._dataView.getUint32(this.position,null==e?this.endianness:e);return this.position+=4,t},o.prototype.readUint16=function(e){var t=this._dataView.getUint16(this.position,null==e?this.endianness:e);return this.position+=2,t},o.prototype.readUint8=function(){var e=this._dataView.getUint8(this.position);return this.position+=1,e},o.prototype.readFloat32=function(e){var t=this._dataView.getFloat32(this.position,null==e?this.endianness:e);return this.position+=4,t},o.prototype.readFloat64=function(e){var t=this._dataView.getFloat64(this.position,null==e?this.endianness:e);return this.position+=8,t},o.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,o.memcpy=function(e,t,i,a,r){var o=new Uint8Array(e,t,r),s=new Uint8Array(i,a,r);o.set(s)},o.arrayToNative=function(e,t){return t==this.endianness?e:this.flipArrayEndianness(e)},o.nativeToEndian=function(e,t){return this.endianness==t?e:this.flipArrayEndianness(e)},o.flipArrayEndianness=function(e){for(var t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i=0;i<e.byteLength;i+=e.BYTES_PER_ELEMENT)for(var a=i+e.BYTES_PER_ELEMENT-1,r=i;a>r;a--,r++){var o=t[r];t[r]=t[a],t[a]=o}return e},o.prototype.failurePosition=0,String.fromCharCodeUint8=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e[i];return String.fromCharCode.apply(null,t)},o.prototype.readString=function(e,t){return null==t||"ASCII"==t?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(null==e?this.byteLength-this.position:e)]):new TextDecoder(t).decode(this.mapUint8Array(e))},o.prototype.readCString=function(e){var t=this.byteLength-this.position,i=new Uint8Array(this._buffer,this._byteOffset+this.position),a=t;null!=e&&(a=Math.min(e,t));for(var r=0;r<a&&0!==i[r];r++);var o=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(r)]);return null!=e?this.position+=a-r:r!=t&&(this.position+=1),o};var s=Math.pow(2,32);o.prototype.readUint64=function(){return this.readUint32()*s+this.readUint32()},o.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},t.DataStream=o,o.prototype.save=function(e){var t=new Blob([this.buffer]),i=window.webkitURL||window.URL;if(!i||!i.createObjectURL)throw"DataStream.save: Can't create object URL.";var a=i.createObjectURL(t),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("download",e),r.click(),i.revokeObjectURL(a)},o.prototype._dynamicSize=!0,Object.defineProperty(o.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(e){e||this._trimAlloc(),this._dynamicSize=e}}),o.prototype.shift=function(e){var t=new ArrayBuffer(this._byteLength-e),i=new Uint8Array(t),a=new Uint8Array(this._buffer,e,i.length);i.set(a),this.buffer=t,this.position-=e},o.prototype.writeInt32Array=function(e,t){if(this._realloc(4*e.length),e instanceof Int32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)o.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt32Array(e.length,t);else for(var i=0;i<e.length;i++)this.writeInt32(e[i],t)},o.prototype.writeInt16Array=function(e,t){if(this._realloc(2*e.length),e instanceof Int16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)o.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt16Array(e.length,t);else for(var i=0;i<e.length;i++)this.writeInt16(e[i],t)},o.prototype.writeInt8Array=function(e){if(this._realloc(1*e.length),e instanceof Int8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)o.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt8Array(e.length);else for(var t=0;t<e.length;t++)this.writeInt8(e[t])},o.prototype.writeUint32Array=function(e,t){if(this._realloc(4*e.length),e instanceof Uint32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)o.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint32Array(e.length,t);else for(var i=0;i<e.length;i++)this.writeUint32(e[i],t)},o.prototype.writeUint16Array=function(e,t){if(this._realloc(2*e.length),e instanceof Uint16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)o.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint16Array(e.length,t);else for(var i=0;i<e.length;i++)this.writeUint16(e[i],t)},o.prototype.writeUint8Array=function(e){if(this._realloc(1*e.length),e instanceof Uint8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)o.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint8Array(e.length);else for(var t=0;t<e.length;t++)this.writeUint8(e[t])},o.prototype.writeFloat64Array=function(e,t){if(this._realloc(8*e.length),e instanceof Float64Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)o.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat64Array(e.length,t);else for(var i=0;i<e.length;i++)this.writeFloat64(e[i],t)},o.prototype.writeFloat32Array=function(e,t){if(this._realloc(4*e.length),e instanceof Float32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)o.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat32Array(e.length,t);else for(var i=0;i<e.length;i++)this.writeFloat32(e[i],t)},o.prototype.writeInt32=function(e,t){this._realloc(4),this._dataView.setInt32(this.position,e,null==t?this.endianness:t),this.position+=4},o.prototype.writeInt16=function(e,t){this._realloc(2),this._dataView.setInt16(this.position,e,null==t?this.endianness:t),this.position+=2},o.prototype.writeInt8=function(e){this._realloc(1),this._dataView.setInt8(this.position,e),this.position+=1},o.prototype.writeUint32=function(e,t){this._realloc(4),this._dataView.setUint32(this.position,e,null==t?this.endianness:t),this.position+=4},o.prototype.writeUint16=function(e,t){this._realloc(2),this._dataView.setUint16(this.position,e,null==t?this.endianness:t),this.position+=2},o.prototype.writeUint8=function(e){this._realloc(1),this._dataView.setUint8(this.position,e),this.position+=1},o.prototype.writeFloat32=function(e,t){this._realloc(4),this._dataView.setFloat32(this.position,e,null==t?this.endianness:t),this.position+=4},o.prototype.writeFloat64=function(e,t){this._realloc(8),this._dataView.setFloat64(this.position,e,null==t?this.endianness:t),this.position+=8},o.prototype.writeUCS2String=function(e,t,i){null==i&&(i=e.length);for(var a=0;a<e.length&&a<i;a++)this.writeUint16(e.charCodeAt(a),t);for(;a<i;a++)this.writeUint16(0)},o.prototype.writeString=function(e,t,i){var a=0;if(null==t||"ASCII"==t)if(null!=i){var r=Math.min(e.length,i);for(a=0;a<r;a++)this.writeUint8(e.charCodeAt(a));for(;a<i;a++)this.writeUint8(0)}else for(a=0;a<e.length;a++)this.writeUint8(e.charCodeAt(a));else this.writeUint8Array(new TextEncoder(t).encode(e.substring(0,i)))},o.prototype.writeCString=function(e,t){var i=0;if(null!=t){var a=Math.min(e.length,t);for(i=0;i<a;i++)this.writeUint8(e.charCodeAt(i));for(;i<t;i++)this.writeUint8(0)}else{for(i=0;i<e.length;i++)this.writeUint8(e.charCodeAt(i));this.writeUint8(0)}},o.prototype.writeStruct=function(e,t){for(var i=0;i<e.length;i+=2){var a=e[i+1];this.writeType(a,t[e[i]],t)}},o.prototype.writeType=function(e,t,i){var a;if("function"==typeof e)return e(this,t);if("object"==typeof e&&!(e instanceof Array))return e.set(this,t,i);var r=null,s="ASCII",n=this.position;switch("string"==typeof e&&/:/.test(e)&&(a=e.split(":"),e=a[0],r=parseInt(a[1])),"string"==typeof e&&/,/.test(e)&&(a=e.split(","),e=a[0],s=parseInt(a[1])),e){case"uint8":this.writeUint8(t);break;case"int8":this.writeInt8(t);break;case"uint16":this.writeUint16(t,this.endianness);break;case"int16":this.writeInt16(t,this.endianness);break;case"uint32":this.writeUint32(t,this.endianness);break;case"int32":this.writeInt32(t,this.endianness);break;case"float32":this.writeFloat32(t,this.endianness);break;case"float64":this.writeFloat64(t,this.endianness);break;case"uint16be":this.writeUint16(t,o.BIG_ENDIAN);break;case"int16be":this.writeInt16(t,o.BIG_ENDIAN);break;case"uint32be":this.writeUint32(t,o.BIG_ENDIAN);break;case"int32be":this.writeInt32(t,o.BIG_ENDIAN);break;case"float32be":this.writeFloat32(t,o.BIG_ENDIAN);break;case"float64be":this.writeFloat64(t,o.BIG_ENDIAN);break;case"uint16le":this.writeUint16(t,o.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(t,o.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(t,o.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(t,o.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(t,o.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(t,o.LITTLE_ENDIAN);break;case"cstring":this.writeCString(t,r);break;case"string":this.writeString(t,s,r);break;case"u16string":this.writeUCS2String(t,this.endianness,r);break;case"u16stringle":this.writeUCS2String(t,o.LITTLE_ENDIAN,r);break;case"u16stringbe":this.writeUCS2String(t,o.BIG_ENDIAN,r);break;default:if(3==e.length){for(var l=e[1],d=0;d<t.length;d++)this.writeType(l,t[d]);break}this.writeStruct(e,t);break}null!=r&&(this.position=n,this._realloc(r),this.position=n+r)},o.prototype.writeUint64=function(e){var t=Math.floor(e/s);this.writeUint32(t),this.writeUint32(4294967295&e)},o.prototype.writeUint24=function(e){this.writeUint8((16711680&e)>>16),this.writeUint8((65280&e)>>8),this.writeUint8(255&e)},o.prototype.adjustUint32=function(e,t){var i=this.position;this.seek(e),this.writeUint32(t),this.seek(i)},o.prototype.mapInt32Array=function(e,t){this._realloc(4*e);var i=new Int32Array(this._buffer,this.byteOffset+this.position,e);return o.arrayToNative(i,null==t?this.endianness:t),this.position+=4*e,i},o.prototype.mapInt16Array=function(e,t){this._realloc(2*e);var i=new Int16Array(this._buffer,this.byteOffset+this.position,e);return o.arrayToNative(i,null==t?this.endianness:t),this.position+=2*e,i},o.prototype.mapInt8Array=function(e){this._realloc(1*e);var t=new Int8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=1*e,t},o.prototype.mapUint32Array=function(e,t){this._realloc(4*e);var i=new Uint32Array(this._buffer,this.byteOffset+this.position,e);return o.arrayToNative(i,null==t?this.endianness:t),this.position+=4*e,i},o.prototype.mapUint16Array=function(e,t){this._realloc(2*e);var i=new Uint16Array(this._buffer,this.byteOffset+this.position,e);return o.arrayToNative(i,null==t?this.endianness:t),this.position+=2*e,i},o.prototype.mapFloat64Array=function(e,t){this._realloc(8*e);var i=new Float64Array(this._buffer,this.byteOffset+this.position,e);return o.arrayToNative(i,null==t?this.endianness:t),this.position+=8*e,i},o.prototype.mapFloat32Array=function(e,t){this._realloc(4*e);var i=new Float32Array(this._buffer,this.byteOffset+this.position,e);return o.arrayToNative(i,null==t?this.endianness:t),this.position+=4*e,i};var n=function(){this.buffers=[],this.bufferIndex=-1};n.prototype=new o(new ArrayBuffer,0,o.BIG_ENDIAN),n.prototype.initialized=function(){var e;return this.bufferIndex>-1||(this.buffers.length>0?(e=this.buffers[0],0===e.fileStart?(this.buffer=e,this.bufferIndex=0,a.debug("MultiBufferStream","Stream ready for parsing"),!0):(a.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1)):(a.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1))},ArrayBuffer.concat=function(e,t){a.debug("ArrayBuffer","Trying to create a new buffer of size: "+(e.byteLength+t.byteLength));var i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i.buffer},n.prototype.reduceBuffer=function(e,t,i){var a;return a=new Uint8Array(i),a.set(new Uint8Array(e,t,i)),a.buffer.fileStart=e.fileStart+t,a.buffer.usedBytes=0,a.buffer},n.prototype.insertBuffer=function(e){for(var t=!0,i=0;i<this.buffers.length;i++){var r=this.buffers[i];if(e.fileStart<=r.fileStart){if(e.fileStart===r.fileStart){if(e.byteLength>r.byteLength){this.buffers.splice(i,1),i--;continue}a.warn("MultiBufferStream","Buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+") already appended, ignoring")}else e.fileStart+e.byteLength<=r.fileStart||(e=this.reduceBuffer(e,0,r.fileStart-e.fileStart)),a.debug("MultiBufferStream","Appending new buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+")"),this.buffers.splice(i,0,e),0===i&&(this.buffer=e);t=!1;break}if(e.fileStart<r.fileStart+r.byteLength){var o=r.fileStart+r.byteLength-e.fileStart,s=e.byteLength-o;if(!(s>0)){t=!1;break}e=this.reduceBuffer(e,o,s)}}t&&(a.debug("MultiBufferStream","Appending new buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+")"),this.buffers.push(e),0===i&&(this.buffer=e))},n.prototype.logBufferLevel=function(e){var t,i,r,o,s,n=[],l="";for(r=0,o=0,t=0;t<this.buffers.length;t++)i=this.buffers[t],0===t?(s={},n.push(s),s.start=i.fileStart,s.end=i.fileStart+i.byteLength,l+="["+s.start+"-"):s.end===i.fileStart?s.end=i.fileStart+i.byteLength:(s={},s.start=i.fileStart,l+=n[n.length-1].end-1+"], ["+s.start+"-",s.end=i.fileStart+i.byteLength,n.push(s)),r+=i.usedBytes,o+=i.byteLength;n.length>0&&(l+=s.end-1+"]");var d=e?a.info:a.debug;0===this.buffers.length?d("MultiBufferStream","No more buffer in memory"):d("MultiBufferStream",this.buffers.length+" stored buffer(s) ("+r+"/"+o+" bytes): "+l)},n.prototype.cleanBuffers=function(){var e,t;for(e=0;e<this.buffers.length;e++)t=this.buffers[e],t.usedBytes===t.byteLength&&(a.debug("MultiBufferStream","Removing buffer #"+e),this.buffers.splice(e,1),e--)},n.prototype.mergeNextBuffer=function(){var e;if(this.bufferIndex+1<this.buffers.length){if(e=this.buffers[this.bufferIndex+1],e.fileStart===this.buffer.fileStart+this.buffer.byteLength){var t=this.buffer.byteLength,i=this.buffer.usedBytes,r=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,e),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=i,this.buffer.fileStart=r,a.debug("ISOFile","Concatenating buffer for box parsing (length: "+t+"->"+this.buffer.byteLength+")"),!0}return!1}return!1},n.prototype.findPosition=function(e,t,i){var r,o=null,s=-1;r=!0===e?0:this.bufferIndex;while(r<this.buffers.length){if(o=this.buffers[r],!(o.fileStart<=t))break;s=r,i&&(o.fileStart+o.byteLength<=t?o.usedBytes=o.byteLength:o.usedBytes=t-o.fileStart,this.logBufferLevel()),r++}return-1!==s?(o=this.buffers[s],o.fileStart+o.byteLength>=t?(a.debug("MultiBufferStream","Found position in existing buffer #"+s),s):-1):-1},n.prototype.findEndContiguousBuf=function(e){var t,i,a,r=void 0!==e?e:this.bufferIndex;if(i=this.buffers[r],this.buffers.length>r+1)for(t=r+1;t<this.buffers.length;t++){if(a=this.buffers[t],a.fileStart!==i.fileStart+i.byteLength)break;i=a}return i.fileStart+i.byteLength},n.prototype.getEndFilePositionAfter=function(e){var t=this.findPosition(!0,e,!1);return-1!==t?this.findEndContiguousBuf(t):e},n.prototype.addUsedBytes=function(e){this.buffer.usedBytes+=e,this.logBufferLevel()},n.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},n.prototype.seek=function(e,t,i){var r;return r=this.findPosition(t,e,i),-1!==r?(this.buffer=this.buffers[r],this.bufferIndex=r,this.position=e-this.buffer.fileStart,a.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(a.debug("MultiBufferStream","Position "+e+" not found in buffered data"),!1)},n.prototype.getPosition=function(){if(-1===this.bufferIndex||null===this.buffers[this.bufferIndex])throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},n.prototype.getLength=function(){return this.byteLength},n.prototype.getEndPosition=function(){if(-1===this.bufferIndex||null===this.buffers[this.bufferIndex])throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength};var l=function(){var e=3,t=4,i=5,r=6,o=[];o[e]="ES_Descriptor",o[t]="DecoderConfigDescriptor",o[i]="DecoderSpecificInfo",o[r]="SLConfigDescriptor";var s=this,n={};return this.parseOneDescriptor=function(e){var t,i,r,s=0;t=e.readUint8(),r=e.readUint8();while(128&r)s=(127&r)<<7,r=e.readUint8();return s+=127&r,a.debug("MPEG4DescriptorParser","Found "+(o[t]||"Descriptor "+t)+", size "+s+" at position "+e.getPosition()),i=o[t]?new n[o[t]](s):new n.Descriptor(s),i.parse(e),i},n.Descriptor=function(e,t){this.tag=e,this.size=t,this.descs=[]},n.Descriptor.prototype.parse=function(e){this.data=e.readUint8Array(this.size)},n.Descriptor.prototype.findDescriptor=function(e){for(var t=0;t<this.descs.length;t++)if(this.descs[t].tag==e)return this.descs[t];return null},n.Descriptor.prototype.parseRemainingDescriptors=function(e){var t=e.position;while(e.position<t+this.size){var i=s.parseOneDescriptor(e);this.descs.push(i)}},n.ES_Descriptor=function(t){n.Descriptor.call(this,e,t)},n.ES_Descriptor.prototype=new n.Descriptor,n.ES_Descriptor.prototype.parse=function(e){if(this.ES_ID=e.readUint16(),this.flags=e.readUint8(),this.size-=3,128&this.flags?(this.dependsOn_ES_ID=e.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,64&this.flags){var t=e.readUint8();this.URL=e.readString(t),this.size-=t+1}else this.URL=null;32&this.flags?(this.OCR_ES_ID=e.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(e)},n.ES_Descriptor.prototype.getOTI=function(e){var i=this.findDescriptor(t);return i?i.oti:0},n.ES_Descriptor.prototype.getAudioConfig=function(e){var a=this.findDescriptor(t);if(!a)return null;var r=a.findDescriptor(i);return r&&r.data?(248&r.data[0])>>3:null},n.DecoderConfigDescriptor=function(e){n.Descriptor.call(this,t,e)},n.DecoderConfigDescriptor.prototype=new n.Descriptor,n.DecoderConfigDescriptor.prototype.parse=function(e){this.oti=e.readUint8(),this.streamType=e.readUint8(),this.bufferSize=e.readUint24(),this.maxBitrate=e.readUint32(),this.avgBitrate=e.readUint32(),this.size-=13,this.parseRemainingDescriptors(e)},n.DecoderSpecificInfo=function(e){n.Descriptor.call(this,i,e)},n.DecoderSpecificInfo.prototype=new n.Descriptor,n.SLConfigDescriptor=function(e){n.Descriptor.call(this,r,e)},n.SLConfigDescriptor.prototype=new n.Descriptor,this},d={ERR_NOT_ENOUGH_DATA:0,OK:1,boxCodes:["mdat","idat","free","skip","avcC","hvcC","ftyp","styp","payl","vttC","rtp ","sdp ","btrt","frma","trpy","tpyl","totl","tpay","dmed","dimm","drep","nump","npck","maxr","tmin","tmax","dmax","pmax","payt","vmhd","smhd","hmhd","idat","meco","udta","strk","free","skip"],fullBoxCodes:["mvhd","tkhd","mdhd","hdlr","vmhd","smhd","hmhd","nmhd","url ","urn ","ctts","cslg","stco","co64","stsc","stss","stsz","stz2","stts","stsh","mehd","trex","mfhd","tfhd","trun","tfdt","esds","subs","txtC","sidx","emsg","prft","pssh","elst","dref","url ","urn ","sbgp","sgpd","cprt","iods","ssix","tfra","mfro","pdin","tsel","trep","leva","stri","stsg","schm","stvi","padb","stdp","sdtp","saio","saiz","meta","xml ","bxml","iloc","pitm","ipro","iinf","infe","iref","mere","kind","elng"],containerBoxCodes:[["moov",["trak","sidx"]],["trak"],["edts"],["mdia"],["minf"],["dinf"],["stbl",["sgpd"]],["mvex",["trex"]],["moof",["traf"]],["traf",["trun"]],["vttc"],["tref"],["iref"],["udta"],["mfra"],["meco"],["hnti"],["hinf"],["strk"],["strd"],["sinf"],["rinf"],["schi"],["trgr"],["udta",["kind"]],["iprp"]],sampleEntryCodes:[{prefix:"Visual",types:["mp4v","avc1","avc2","avc3","avc4","avcp","drac","encv","mjp2","mvc1","mvc2","resv","s263","svc1","vc-1","hvc1","hev1"]},{prefix:"Audio",types:["mp4a","ac-3","alac","dra1","dtsc","dtse",,"dtsh","dtsl","ec-3","enca","g719","g726","m4ae","mlpa","raw ","samr","sawb","sawp","sevc","sqcp","ssmv","twos",".mp3"]},{prefix:"Hint",types:["fdp ","m2ts","pm2t","prtp","rm2t","rrtp","rsrp","rtp ","sm2t","srtp"]},{prefix:"Metadata",types:["metx","mett","urim"]},{prefix:"Subtitle",types:["stpp","wvtt","sbtt","tx3g","stxt"]},{prefix:"System",types:["mp4s"]}],sampleGroupEntryCodes:["roll","prol","alst","rap ","tele","avss","avll","sync","tscl","tsas","stsa","scif","mvif","scnm","dtrt","vipr","tele","rash"],trackGroupTypes:["msrc"],initialize:function(){var e,t,i;for(d.FullBox.prototype=new d.Box,d.ContainerBox.prototype=new d.Box,d.SampleEntry.prototype=new d.FullBox,d.TrackGroupTypeBox.prototype=new d.FullBox,i=d.boxCodes.length,e=0;e<i;e++)d[d.boxCodes[e]+"Box"]=function(e){return function(t){d.Box.call(this,d.boxCodes[e],t)}}(e),d[d.boxCodes[e]+"Box"].prototype=new d.Box;for(i=d.fullBoxCodes.length,e=0;e<i;e++)d[d.fullBoxCodes[e]+"Box"]=function(e){return function(t){d.FullBox.call(this,d.fullBoxCodes[e],t)}}(e),d[d.fullBoxCodes[e]+"Box"].prototype=new d.FullBox;for(i=d.containerBoxCodes.length,e=0;e<i;e++)d[d.containerBoxCodes[e][0]+"Box"]=function(e,t){return function(i){if(d.ContainerBox.call(this,d.containerBoxCodes[e][0],i),t){this.subBoxNames=t;for(var a=t.length,r=0;r<a;r++)this[t[r]+"s"]=[]}}}(e,d.containerBoxCodes[e][1]),d[d.containerBoxCodes[e][0]+"Box"].prototype=new d.ContainerBox;for(i=d.sampleEntryCodes.length,t=0;t<i;t++){var a=d.sampleEntryCodes[t].prefix,r=d.sampleEntryCodes[t].types,o=r.length;for(d[a+"SampleEntry"]=function(e,t){d.SampleEntry.call(this,e,t)},d[a+"SampleEntry"].prototype=new d.SampleEntry,e=0;e<o;e++)d[r[e]+"SampleEntry"]=function(e,t){return function(i){d[d.sampleEntryCodes[e].prefix+"SampleEntry"].call(this,d.sampleEntryCodes[e].types[t],i)}}(t,e),d[r[e]+"SampleEntry"].prototype=new d[a+"SampleEntry"]}for(i=d.sampleGroupEntryCodes.length,e=0;e<i;e++)d[d.sampleGroupEntryCodes[e]+"SampleGroupEntry"]=function(e){return function(t){d.SampleGroupEntry.call(this,d.sampleGroupEntryCodes[e],t)}}(e),d[d.sampleGroupEntryCodes[e]+"SampleGroupEntry"].prototype=new d.SampleGroupEntry;for(i=d.trackGroupTypes.length,e=0;e<i;e++)d[d.trackGroupTypes[e]+"Box"]=function(e){return function(t){d.TrackGroupTypeBox.call(this,d.trackGroupTypes[e],t)}}(e),d[d.trackGroupTypes[e]+"Box"].prototype=new d.TrackGroupTypeBox},Box:function(e,t){this.type=e,this.size=t},FullBox:function(e,t){d.Box.call(this,e,t),this.flags=0,this.version=0},ContainerBox:function(e,t){d.Box.call(this,e,t),this.boxes=[]},SampleEntry:function(e,t,i,a){d.Box.call(this,e,t),this.hdr_size=i,this.start=a,this.boxes=[]},SampleGroupEntry:function(e){this.grouping_type=e},TrackGroupTypeBox:function(e,t){d.FullBox.call(this,e,t)}};d.initialize(),d.TKHD_FLAG_ENABLED=1,d.TKHD_FLAG_IN_MOVIE=2,d.TKHD_FLAG_IN_PREVIEW=4,d.TFHD_FLAG_BASE_DATA_OFFSET=1,d.TFHD_FLAG_SAMPLE_DESC=2,d.TFHD_FLAG_SAMPLE_DUR=8,d.TFHD_FLAG_SAMPLE_SIZE=16,d.TFHD_FLAG_SAMPLE_FLAGS=32,d.TFHD_FLAG_DUR_EMPTY=65536,d.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,d.TRUN_FLAGS_DATA_OFFSET=1,d.TRUN_FLAGS_FIRST_FLAG=4,d.TRUN_FLAGS_DURATION=256,d.TRUN_FLAGS_SIZE=512,d.TRUN_FLAGS_FLAGS=1024,d.TRUN_FLAGS_CTS_OFFSET=2048,t.BoxParser=d,d.SampleEntry.prototype.isVideo=function(){return!1},d.SampleEntry.prototype.isAudio=function(){return!1},d.SampleEntry.prototype.isSubtitle=function(){return!1},d.SampleEntry.prototype.isMetadata=function(){return!1},d.SampleEntry.prototype.isHint=function(){return!1},d.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},d.SampleEntry.prototype.getWidth=function(){return""},d.SampleEntry.prototype.getHeight=function(){return""},d.SampleEntry.prototype.getChannelCount=function(){return""},d.SampleEntry.prototype.getSampleRate=function(){return""},d.SampleEntry.prototype.getSampleSize=function(){return""},d.VisualSampleEntry.prototype.isVideo=function(){return!0},d.VisualSampleEntry.prototype.getWidth=function(){return this.width},d.VisualSampleEntry.prototype.getHeight=function(){return this.height},d.AudioSampleEntry.prototype.isAudio=function(){return!0},d.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},d.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},d.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},d.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},d.MetadataSampleEntry.prototype.isMetadata=function(){return!0},d.decimalToHex=function(e,t){var i=Number(e).toString(16);t="undefined"===typeof t||null===t?t=2:t;while(i.length<t)i="0"+i;return i},d.avc1SampleEntry.prototype.getCodec=function(){var e=d.SampleEntry.prototype.getCodec.call(this);return this.avcC?e+"."+d.decimalToHex(this.avcC.AVCProfileIndication)+d.decimalToHex(this.avcC.profile_compatibility)+d.decimalToHex(this.avcC.AVCLevelIndication):e},d.hvc1SampleEntry.prototype.getCodec=function(){var e,t=d.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(t+=".",this.hvcC.general_profile_space){case 0:t+="";break;case 1:t+="A";break;case 2:t+="B";break;case 3:t+="C";break}t+=this.hvcC.general_profile_idc,t+=".";var i=this.hvcC.general_profile_compatibility,a=0;for(e=0;e<32;e++){if(a|=1&i,31==e)break;a<<=1,i>>=1}t+=d.decimalToHex(a,0),t+=".",0===this.hvcC.general_tier_flag?t+="L":t+="H",t+=this.hvcC.general_level_idc;var r=!1,o="";for(e=5;e>=0;e--)(this.hvcC.general_constraint_indicator[e]||r)&&(o="."+d.decimalToHex(this.hvcC.general_constraint_indicator[e],0)+o,r=!0);t+=o}return t},d.mp4aSampleEntry.prototype.getCodec=function(){var e=d.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var t=this.esds.esd.getOTI(),i=this.esds.esd.getAudioConfig();return e+"."+d.decimalToHex(t)+(i?"."+i:"")}return e},d.stxtSampleEntry.prototype.getCodec=function(){var e=d.SampleEntry.prototype.getCodec.call(this);return this.mime_format?e+"."+this.mime_format:e},d.parseOneBox=function(e,t){var i,r,o=e.getPosition(),s=0;if(e.getEndPosition()-o<8)return a.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:d.ERR_NOT_ENOUGH_DATA};var n=e.readUint32(),l=e.readString(4);if(a.debug("BoxParser","Found box of type "+l+" and size "+n+" at position "+o),s=8,"uuid"==l&&(r=e.readUint8Array(16),s+=16),1==n){if(e.getEndPosition()-e.getPosition()<8)return e.seek(o),a.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+l+'" box'),{code:d.ERR_NOT_ENOUGH_DATA};n=e.readUint64(),s+=8}else if(0===n&&"mdat"!==l)throw"Unlimited box size not supported";return o+n>e.getEndPosition()?(e.seek(o),a.warn("BoxParser",'Not enough data in stream to parse the entire "'+l+'" box'),{code:d.ERR_NOT_ENOUGH_DATA,type:l,size:n,hdr_size:s,start:o}):t?{code:d.OK,type:l,size:n,hdr_size:s,start:o}:(d[l+"Box"]?i=new d[l+"Box"](n):("uuid"!==l&&a.warn("BoxParser","Unknown box type: "+l),i=new d.Box(l,n),r&&(i.uuid=r)),i.hdr_size=s,i.start=o,i.write===d.Box.prototype.write&&"mdat"!==i.type&&(a.warn("BoxParser",i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(e)),i.parse(e),{code:d.OK,box:i,size:n})},d.Box.prototype.parse=function(e){"mdat"!=this.type?this.data=e.readUint8Array(this.size-this.hdr_size):0===this.size?e.seek(e.getEndPosition()):e.seek(this.start+this.size)},d.Box.prototype.parseDataAndRewind=function(e){this.data=e.readUint8Array(this.size-this.hdr_size),e.position-=this.size-this.hdr_size},d.FullBox.prototype.parseDataAndRewind=function(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,e.position-=this.size-this.hdr_size},d.FullBox.prototype.parseFullHeader=function(e){this.version=e.readUint8(),this.flags=e.readUint24(),this.hdr_size+=4},d.FullBox.prototype.parse=function(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)},d.ContainerBox.prototype.parse=function(e){var t,i;while(e.getPosition()<this.start+this.size)t=d.parseOneBox(e,!1),i=t.box,this.boxes.push(i),this.subBoxNames&&-1!=this.subBoxNames.indexOf(i.type)?this[this.subBoxNames[this.subBoxNames.indexOf(i.type)]+"s"].push(i):this[i.type]=i},d.Box.prototype.parseLanguage=function(e){this.language=e.readUint16();var t=[];t[0]=this.language>>10&31,t[1]=this.language>>5&31,t[2]=31&this.language,this.languageString=String.fromCharCode(t[0]+96,t[1]+96,t[2]+96)},d.TrackGroupTypeBox.prototype.parse=function(e){this.parseFullHeader(e),this.track_group_id=e.readUint32()},d.TrackReferenceTypeBox=function(e,t,i,a){d.Box.call(this,e,t),this.hdr_size=i,this.start=a},d.TrackReferenceTypeBox.prototype=new d.Box,d.TrackReferenceTypeBox.prototype.parse=function(e){this.track_ids=e.readUint32Array((this.size-this.hdr_size)/4)},d.avcCBox.prototype.parse=function(e){var t,i,a,r;for(this.configurationVersion=e.readUint8(),this.AVCProfileIndication=e.readUint8(),this.profile_compatibility=e.readUint8(),this.AVCLevelIndication=e.readUint8(),this.lengthSizeMinusOne=3&e.readUint8(),i=31&e.readUint8(),r=this.size-this.hdr_size-6,this.SPS=new Array(i),t=0;t<i;t++)a=e.readUint16(),this.SPS[t]=e.readUint8Array(a),r-=2+a;for(i=e.readUint8(),r--,this.PPS=new Array(i),t=0;t<i;t++)a=e.readUint16(),this.PPS[t]=e.readUint8Array(a),r-=2+a;r>0&&(this.ext=e.readUint8Array(r))},d.btrtBox.prototype.parse=function(e){this.bufferSizeDB=e.readUint32(),this.maxBitrate=e.readUint32(),this.avgBitrate=e.readUint32()},d.co64Box.prototype.parse=function(e){var t,i;if(this.parseFullHeader(e),t=e.readUint32(),this.chunk_offsets=[],0===this.version)for(i=0;i<t;i++)this.chunk_offsets.push(e.readUint64());else this.data=e.readUint8Array(this.size-this.hdr_size-4)},d.cprtBox.prototype.parse=function(e){this.parseFullHeader(e),this.parseLanguage(e),this.notice=e.readCString(),e.getPosition()>this.start+this.size&&(a.warn("BoxParser","Parsed more than the size of the box (null-terminated string problem?)"),e.seek(this.start+this.size))},d.cslgBox.prototype.parse=function(e){this.parseFullHeader(e),0===this.version?(this.compositionToDTSShift=e.readInt32(),this.leastDecodeToDisplayDelta=e.readInt32(),this.greatestDecodeToDisplayDelta=e.readInt32(),this.compositionStartTime=e.readInt32(),this.compositionEndTime=e.readInt32()):this.data=e.readUint8Array(this.size-this.hdr_size-4)},d.cttsBox.prototype.parse=function(e){var t,i;if(this.parseFullHeader(e),t=e.readUint32(),this.sample_counts=[],this.sample_offsets=[],0===this.version)for(i=0;i<t;i++)this.sample_counts.push(e.readUint32()),this.sample_offsets.push(e.readInt32());else if(1==this.version)for(i=0;i<t;i++)this.sample_counts.push(e.readUint32()),this.sample_offsets.push(e.readInt32());else this.data=e.readUint8Array(this.size-this.hdr_size-4)},d.dimmBox.prototype.parse=function(e){this.bytessent=e.readUint64()},d.dmaxBox.prototype.parse=function(e){this.time=e.readUint32()},d.dmedBox.prototype.parse=function(e){this.bytessent=e.readUint64()},d.drefBox.prototype.parse=function(e){var t,i;this.parseFullHeader(e),this.entries=[];for(var a=e.readUint32(),r=0;r<a;r++)t=d.parseOneBox(e,!1),i=t.box,this.entries.push(i)},d.drepBox.prototype.parse=function(e){this.bytessent=e.readUint64()},d.elngBox.prototype.parse=function(e){this.parseFullHeader(e),this.extended_language=e.readString(this.size-this.hdr_size)},d.elstBox.prototype.parse=function(e){this.parseFullHeader(e),this.entries=[];for(var t=e.readUint32(),i=0;i<t;i++){var a={};this.entries.push(a),1===this.version?(a.segment_duration=e.readUint64(),a.media_time=e.readInt64()):(a.segment_duration=e.readUint32(),a.media_time=e.readInt32()),a.media_rate_integer=e.readInt16(),a.media_rate_fraction=e.readInt16()}},d.emsgBox.prototype.parse=function(e){this.parseFullHeader(e),this.scheme_id_uri=e.readCString(),this.value=e.readCString(),this.timescale=e.readUint32(),this.presentation_time_delta=e.readUint32(),this.event_duration=e.readUint32(),this.id=e.readUint32();var t=this.size-this.hdr_size-(16+(this.scheme_id_uri.length+1)+(this.value.length+1));this.message_data=e.readUint8Array(t)},d.esdsBox.prototype.parse=function(e){this.parseFullHeader(e);var t=e.readUint8Array(this.size-this.hdr_size);if("undefined"!==typeof l){var i=new l;this.esd=i.parseOneDescriptor(new o(t.buffer,0,o.BIG_ENDIAN))}},d.frmaBox.prototype.parse=function(e){this.data_format=e.readString(4)},d.ftypBox.prototype.parse=function(e){var t=this.size-this.hdr_size;this.major_brand=e.readString(4),this.minor_version=e.readUint32(),t-=8,this.compatible_brands=[];var i=0;while(t>=4)this.compatible_brands[i]=e.readString(4),t-=4,i++},d.hdlrBox.prototype.parse=function(e){this.parseFullHeader(e),0===this.version?(e.readUint32(),this.handler=e.readString(4),e.readUint32Array(3),this.name=e.readString(this.size-this.hdr_size-20),"\0"===this.name[this.name.length-1]&&(this.name=this.name.slice(0,-1))):this.data=e.readUint8Array(this.size-this.hdr_size)},d.hvcCBox.prototype.parse=function(e){var t,i,a,r;this.configurationVersion=e.readUint8(),r=e.readUint8(),this.general_profile_space=r>>6,this.general_tier_flag=(32&r)>>5,this.general_profile_idc=31&r,this.general_profile_compatibility=e.readUint32(),this.general_constraint_indicator=e.readUint8Array(6),this.general_level_idc=e.readUint8(),this.min_spatial_segmentation_idc=4095&e.readUint16(),this.parallelismType=3&e.readUint8(),this.chromaFormat=3&e.readUint8(),this.bitDepthLumaMinus8=7&e.readUint8(),this.bitDepthChromaMinus8=7&e.readUint8(),this.avgFrameRate=e.readUint16(),r=e.readUint8(),this.constantFrameRate=r>>6,this.numTemporalLayers=(13&r)>>3,this.temporalIdNested=(4&r)>>2,this.lengthSizeMinusOne=3&r,this.nalu_arrays=[];var o=e.readUint8();for(t=0;t<o;t++){var s=[];this.nalu_arrays.push(s),r=e.readUint8(),s.completeness=(128&r)>>7,s.nalu_type=63&r;var n=e.readUint16();for(i=0;i<n;i++){var l={};s.push(l),a=e.readUint16(),l.data=e.readUint8Array(a)}}},d.iinfBox.prototype.parse=function(e){var t;this.parseFullHeader(e),0===this.version?this.entry_count=e.readUint16():this.entry_count=e.readUint32(),this.item_infos=[];for(var i=0;i<this.entry_count;i++)t=d.parseOneBox(e,!1),"infe"!==t.box.type&&a.error("BoxParser","Expected 'infe' box, got "+t.box.type),this.item_infos[i]=t.box},d.ilocBox.prototype.parse=function(e){var t;this.parseFullHeader(e),t=e.readUint8(),this.offset_size=t>>4&15,this.length_size=15&t,t=e.readUint8(),this.base_offset_size=t>>4&15,1===this.version||2===this.version?this.index_size=15&t:this.index_size=0,this.items=[];var i=0;if(this.version<2)i=e.readUint16();else{if(2!==this.version)throw"version of iloc box not supported";i=e.readUint32()}for(var a=0;a<i;a++){var r={};if(this.items.push(r),this.version<2)r.item_ID=e.readUint16();else{if(2!==this.version)throw"version of iloc box not supported";r.item_ID=e.readUint16()}switch(1!==this.version&&2!==this.version||(r.construction_method=15&e.readUint16()),r.data_reference_index=e.readUint16(),this.base_offset_size){case 0:r.base_offset=0;break;case 4:r.base_offset=e.readUint32();break;case 8:r.base_offset=e.readUint64();break;default:throw"Error reading base offset size"}var o=e.readUint16();r.extents=[];for(var s=0;s<o;s++){var n={};if(r.extents.push(n),1===this.version||2===this.version)switch(this.index_size){case 0:n.extent_index=0;break;case 4:n.extent_index=e.readUint32();break;case 8:n.extent_index=e.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:n.extent_offset=0;break;case 4:n.extent_offset=e.readUint32();break;case 8:n.extent_offset=e.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:n.extent_length=0;break;case 4:n.extent_length=e.readUint32();break;case 8:n.extent_length=e.readUint64();break;default:throw"Error reading extent index"}}}},d.infeBox.prototype.parse=function(e){if(this.parseFullHeader(e),0!==this.version&&1!==this.version||(this.item_ID=e.readUint16(),this.item_protection_index=e.readUint16(),this.item_name=e.readCString(),this.content_type=e.readCString(),this.content_encoding=e.readCString()),1===this.version)return this.extension_type=e.readString(4),a.warn("BoxParser","Cannot parse extension type"),void e.seek(this.start+this.size);this.version>=2&&(2===this.version?this.item_ID=e.readUint16():3===this.version&&(this.item_ID=e.readUint32()),this.item_protection_index=e.readUint16(),this.item_type=e.readString(4),this.name=e.readCString(),"mime"===this.item_type?(this.content_type=e.readCString(),this.content_encoding=e.readCString()):"uri "===this.item_type&&(this.item_uri_type=e.readCString())),e.getPosition()>this.start+this.size&&(a.warn("BoxParser","Parsed more than the size of the box (null-terminated string problem?)"),e.seek(this.start+this.size))},d.irefBox=function(e){d.FullBox.call(this,"iref",e),this.references=[]},d.irefBox.prototype=new d.FullBox,d.irefBox.prototype.parse=function(e){var t,i;this.parseFullHeader(e);while(e.getPosition()<this.start+this.size)t=d.parseOneBox(e,!0),i=0===this.version?new d.SingleItemTypeReferenceBox(t.type,t.size,t.hdr_size,t.start):new d.SingleItemTypeReferenceBoxLarge(t.type,t.size,t.hdr_size,t.start),i.write===d.Box.prototype.write&&"mdat"!==i.type&&(a.warn("BoxParser",i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(e)),i.parse(e),this.references.push(i)},d.kindBox=function(e){d.FullBox.call(this,"kind",e),this.schemeURI="",this.value=""},d.kindBox.prototype=new d.FullBox,d.kindBox.prototype.parse=function(e){this.parseFullHeader(e),this.schemeURI=e.readCString(),this.value=e.readCString()},d.levaBox.prototype.parse=function(e){this.parseFullHeader(e);var t=e.readUint8();this.levels=[];for(var i=0;i<t;i++){var r={};this.levels[i]=r,r.track_ID=e.readUint32();var o=e.readUint8();switch(r.padding_flag=o>>7,r.assignment_type=127&o,r.assignment_type){case 0:r.grouping_type=e.readUint32();break;case 1:r.grouping_type=e.readUint32(),r.grouping_type_parameter=e.readUint32();break;case 2:break;case 3:break;case 4:r.sub_track_id=e.readUint32();break;default:a.warn("BoxParser","Unknown leva assignement type")}}},d.maxrBox.prototype.parse=function(e){this.period=e.readUint32(),this.bytes=e.readUint32()},d.mdhdBox.prototype.parse=function(e){this.parseFullHeader(e),1==this.version?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.parseLanguage(e),e.readUint16()},d.mehdBox.prototype.parse=function(e){this.parseFullHeader(e),1==this.version?this.fragment_duration=e.readUint64():this.fragment_duration=e.readUint32()},d.metaBox.prototype.parse=function(e){this.parseFullHeader(e),this.boxes=[],d.ContainerBox.prototype.parse.call(this,e)},d.mfhdBox.prototype.parse=function(e){this.parseFullHeader(e),this.sequence_number=e.readUint32()},d.mfroBox.prototype.parse=function(e){this.parseFullHeader(e),this.size=e.readUint32()},d.mvhdBox.prototype.parse=function(e){this.flags=0,this.parseFullHeader(e),1==this.version?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.rate=e.readUint32(),this.volume=e.readUint16()>>8,e.readUint16(),e.readUint32Array(2),this.matrix=e.readUint32Array(9),e.readUint32Array(6),this.next_track_id=e.readUint32()},d.npckBox.prototype.parse=function(e){this.packetssent=e.readUint32()},d.numpBox.prototype.parse=function(e){this.packetssent=e.readUint64()},d.padbBox.prototype.parse=function(e){this.parseFullHeader(e);var t=e.readUint32();this.padbits=[];for(var i=0;i<Math.floor((t+1)/2);i++)this.padbits=e.readUint8()},d.paylBox.prototype.parse=function(e){this.text=e.readString(this.size-this.hdr_size)},d.paytBox.prototype.parse=function(e){this.payloadID=e.readUint32();var t=e.readUint8();this.rtpmap_string=e.readString(t)},d.pdinBox.prototype.parse=function(e){this.parseFullHeader(e);var t=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var i=0;i<t;i++)this.rate[i]=e.readUint32(),this.initial_delay[i]=e.readUint32()},d.pitmBox.prototype.parse=function(e){this.parseFullHeader(e),0===this.version?this.item_id=e.readUint16():this.item_id=e.readUint32()},d.pmaxBox.prototype.parse=function(e){this.bytes=e.readUint32()},d.prftBox.prototype.parse=function(e){this.parseFullHeader(e),this.ref_track_id=e.readUint32(),this.ntp_timestamp=e.readUint64(),0===this.version?this.media_time=e.readUint32():this.media_time=e.readUint64()},d.psshBox.prototype.parse=function(e){if(this.parseFullHeader(e),this.system_id=e.readUint8Array(16),this.version>0){var t=e.readUint32();this.kid=[];for(var i=0;i<t;i++)this.kid[i]=e.readUint8Array(16)}var a=e.readUint32();a>0&&(this.data=e.readUint8Array(a))},d["rtp Box"].prototype.parse=function(e){this.descriptionformat=e.readString(4),this.sdptext=e.readString(this.size-this.hdr_size-4)},d.saioBox.prototype.parse=function(e){this.parseFullHeader(e),1&this.flags&&(this.aux_info_type=e.readUint32(),this.aux_info_type_parameter=e.readUint32());var t=e.readUint32();this.offset=[];for(var i=0;i<t;i++)0===this.version?this.offset[i]=e.readUint32():this.offset[i]=e.readUint64()},d.saizBox.prototype.parse=function(e){this.parseFullHeader(e),1&this.flags&&(this.aux_info_type=e.readUint32(),this.aux_info_type_parameter=e.readUint32()),this.default_sample_info_size=e.readUint8();var t=e.readUint32();if(this.sample_info_size=[],0===this.default_sample_info_size)for(var i=0;i<t;i++)this.sample_info_size[i]=e.readUint32()},d.mettSampleEntry.prototype.parse=function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)},d.metxSampleEntry.prototype.parse=function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.namespace=e.readCString(),this.schema_location=e.readCString(),this.parseFooter(e)},d.SampleEntry.prototype.parseHeader=function(e){e.readUint8Array(6),this.data_reference_index=e.readUint16(),this.hdr_size+=8},d.SampleEntry.prototype.parse=function(e){this.parseHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)},d.SampleEntry.prototype.parseDataAndRewind=function(e){this.parseHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,e.position-=this.size-this.hdr_size},d.SampleEntry.prototype.parseFooter=function(e){var t,i;while(e.getPosition()<this.start+this.size)t=d.parseOneBox(e,!1),i=t.box,this.boxes.push(i),this[i.type]=i},d.VisualSampleEntry.prototype.parse=function(e){this.parseHeader(e),e.readUint16(),e.readUint16(),e.readUint32Array(3),this.width=e.readUint16(),this.height=e.readUint16(),this.horizresolution=e.readUint32(),this.vertresolution=e.readUint32(),e.readUint32(),this.frame_count=e.readUint16(),this.compressorname=e.readString(32),this.depth=e.readUint16(),e.readUint16(),this.parseFooter(e)},d.AudioSampleEntry.prototype.parse=function(e){this.parseHeader(e),e.readUint32Array(2),this.channel_count=e.readUint16(),this.samplesize=e.readUint16(),e.readUint16(),e.readUint16(),this.samplerate=e.readUint32()/65536,this.parseFooter(e)},d.sbttSampleEntry.prototype.parse=function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)},d.stppSampleEntry.prototype.parse=function(e){this.parseHeader(e),this.namespace=e.readCString(),this.schema_location=e.readCString(),this.auxiliary_mime_types=e.readCString(),this.parseFooter(e)},d.stxtSampleEntry.prototype.parse=function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)},d.tx3gSampleEntry.prototype.parse=function(e){this.parseHeader(e),this.displayFlags=e.readUint32(),this.horizontal_justification=e.readInt8(),this.vertical_justification=e.readInt8(),this.bg_color_rgba=e.readUint8Array(4),this.box_record=e.readInt16Array(4),this.style_record=e.readUint8Array(12),this.parseFooter(e)},d.alstSampleGroupEntry.prototype.parse=function(e){var t,i=e.readUint16();for(this.first_output_sample=e.readUint16(),this.sample_offset=[],t=0;t<i;t++)this.sample_offset[t]=e.readUint32();var a=this.description_length-4-4*i;for(this.num_output_samples=[],this.num_total_samples=[],t=0;t<a/4;t++)this.num_output_samples[t]=e.readUint16(),this.num_total_samples[t]=e.readUint16()},d.avllSampleGroupEntry.prototype.parse=function(e){this.layerNumber=e.readUint8(),this.accurateStatisticsFlag=e.readUint8(),this.avgBitRate=e.readUint16(),this.avgFrameRate=e.readUint16()},d.avssSampleGroupEntry.prototype.parse=function(e){this.subSequenceIdentifier=e.readUint16(),this.layerNumber=e.readUint8();var t=e.readUint8();this.durationFlag=t>>7,this.avgRateFlag=t>>6&1,this.durationFlag&&(this.duration=e.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=e.readUint8(),this.avgBitRate=e.readUint16(),this.avgFrameRate=e.readUint16()),this.dependency=[];for(var i=e.readUint8(),a=0;a<i;a++){var r={};this.dependency.push(r),r.subSeqDirectionFlag=e.readUint8(),r.layerNumber=e.readUint8(),r.subSequenceIdentifier=e.readUint16()}},d.dtrtSampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.mvifSampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.prolSampleGroupEntry.prototype.parse=function(e){this.roll_distance=e.readInt16()},d["rap SampleGroupEntry"].prototype.parse=function(e){var t=e.readUint8();this.num_leading_samples_known=t>>7,this.num_leading_samples=127&t},d.rashSampleGroupEntry.prototype.parse=function(e){if(this.operation_point_count=e.readUint16(),this.description_length!==2+(1===this.operation_point_count?2:6*this.operation_point_count)+9)a.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=e.readUint8Array(this.description_length-2);else{if(1===this.operation_point_count)this.target_rate_share=e.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var t=0;t<this.operation_point_count;t++)this.available_bitrate[t]=e.readUint32(),this.target_rate_share[t]=e.readUint16()}this.maximum_bitrate=e.readUint32(),this.minimum_bitrate=e.readUint32(),this.discard_priority=e.readUint8()}},d.rollSampleGroupEntry.prototype.parse=function(e){this.roll_distance=e.readInt16()},d.SampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=e.readUint8Array(this.description_length)},d.scifSampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.scnmSampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.stsaSampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.syncSampleGroupEntry.prototype.parse=function(e){var t=e.readUint8();this.NAL_unit_type=63&t},d.teleSampleGroupEntry.prototype.parse=function(e){var t=e.readUint8();this.level_independently_decodable=t>>7},d.tsasSampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.tsclSampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.viprSampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")},d.sbgpBox.prototype.parse=function(e){this.parseFullHeader(e),this.grouping_type=e.readString(4),1===this.version?this.grouping_type_parameter=e.readUint32():this.grouping_type_parameter=0,this.entries=[];for(var t=e.readUint32(),i=0;i<t;i++){var a={};this.entries.push(a),a.sample_count=e.readInt32(),a.group_description_index=e.readInt32()}},d.schmBox.prototype.parse=function(e){this.parseFullHeader(e),this.scheme_type=e.readString(4),this.scheme_version=e.readUint32(),1&this.flags&&(this.scheme_uri=e.readString(this.size-this.hdr_size-8))},d["sdp Box"].prototype.parse=function(e){this.sdptext=e.readString(this.size-this.hdr_size)},d.sdtpBox.prototype.parse=function(e){var t;this.parseFullHeader(e);var i=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var a=0;a<i;a++)t=e.readUint8(),this.is_leading[a]=t>>6,this.sample_depends_on[a]=t>>4&3,this.sample_is_depended_on[a]=t>>2&3,this.sample_has_redundancy[a]=3&t},d.sgpdBox.prototype.parse=function(e){this.parseFullHeader(e),this.grouping_type=e.readString(4),a.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),1===this.version?this.default_length=e.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=e.readUint32()),this.entries=[];for(var t=e.readUint32(),i=0;i<t;i++){var r;r=d[this.grouping_type+"SampleGroupEntry"]?new d[this.grouping_type+"SampleGroupEntry"](this.grouping_type):new d.SampleGroupEntry(this.grouping_type),this.entries.push(r),1===this.version&&0===this.default_length?r.description_length=e.readUint32():r.description_length=this.default_length,r.write===d.SampleGroupEntry.prototype.write&&(a.warn("BoxParser"," SampleEntry for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),r.data=e.readUint8Array(r.description_length),e.position-=r.description_length),r.parse(e)}},d.sidxBox.prototype.parse=function(e){this.parseFullHeader(e),this.reference_ID=e.readUint32(),this.timescale=e.readUint32(),0===this.version?(this.earliest_presentation_time=e.readUint32(),this.first_offset=e.readUint32()):(this.earliest_presentation_time=e.readUint64(),this.first_offset=e.readUint64()),e.readUint16(),this.references=[];for(var t=e.readUint16(),i=0;i<t;i++){var a={};this.references.push(a);var r=e.readUint32();a.reference_type=r>>31&1,a.referenced_size=2147483647&r,a.subsegment_duration=e.readUint32(),r=e.readUint32(),a.starts_with_SAP=r>>31&1,a.SAP_type=r>>28&7,a.SAP_delta_time=268435455&r}},d.SingleItemTypeReferenceBox=function(e,t,i,a){d.Box.call(this,e,t),this.hdr_size=i,this.start=a},d.SingleItemTypeReferenceBox.prototype=new d.Box,d.SingleItemTypeReferenceBox.prototype.parse=function(e){this.from_item_ID=e.readUint16();var t=e.readUint16();this.references=[];for(var i=0;i<t;i++)this.references[i]=e.readUint16()},d.SingleItemTypeReferenceBoxLarge=function(e,t,i,a){d.Box.call(this,e,t),this.hdr_size=i,this.start=a},d.SingleItemTypeReferenceBoxLarge.prototype=new d.Box,d.SingleItemTypeReferenceBoxLarge.prototype.parse=function(e){this.from_item_ID=e.readUint32();var t=e.readUint16();this.references=[];for(var i=0;i<t;i++)this.references[i]=e.readUint32()},d.ssixBox.prototype.parse=function(e){this.parseFullHeader(e),this.subsegments=[];for(var t=e.readUint32(),i=0;i<t;i++){var a={};this.subsegments.push(a),a.ranges=[];for(var r=e.readUint32(),o=0;o<r;o++){var s={};a.ranges.push(s),s.level=e.readUint8(),s.range_size=e.readUint24()}}},d.stcoBox.prototype.parse=function(e){var t;this.parseFullHeader(e),t=e.readUint32(),0===this.version?this.chunk_offsets=e.readUint32Array(t):this.data=e.readUint8Array(this.size-this.hdr_size-4)},d.stdpBox.prototype.parse=function(e){this.parseFullHeader(e);var t=(this.size-this.hdr_size)/2;this.priority=[];for(var i=0;i<t;i++)this.priority[i]=e.readUint16()},d.striBox.prototype.parse=function(e){this.parseFullHeader(e),this.switch_group=e.readUint16(),this.alternate_group=e.readUint16(),this.sub_track_id=e.readUint32();var t=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var i=0;i<t;i++)this.attribute_list[i]=e.readUint32()},d.stscBox.prototype.parse=function(e){var t,i;if(this.parseFullHeader(e),t=e.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],0===this.version)for(i=0;i<t;i++)this.first_chunk.push(e.readUint32()),this.samples_per_chunk.push(e.readUint32()),this.sample_description_index.push(e.readUint32());else this.data=e.readUint8Array(this.size-this.hdr_size-4)},d.stsdBox=function(e){d.FullBox.call(this,"stsd",e),this.entries=[]},d.stsdBox.prototype=new d.FullBox,d.stsdBox.prototype.parse=function(e){var t,i,r,o;for(this.parseFullHeader(e),r=e.readUint32(),t=1;t<=r;t++)i=d.parseOneBox(e,!0),d[i.type+"SampleEntry"]?(o=new d[i.type+"SampleEntry"](i.size),o.hdr_size=i.hdr_size,o.start=i.start):(a.warn("BoxParser","Unknown sample entry type: "+i.type),o=new d.SampleEntry(i.type,i.size,i.hdr_size,i.start)),o.write===d.SampleEntry.prototype.write&&(a.warn("BoxParser",o.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),o.parseDataAndRewind(e)),o.parse(e),this.entries.push(o)},d.stsgBox.prototype.parse=function(e){this.parseFullHeader(e),this.grouping_type=e.readUint32();var t=e.readUint16();this.group_description_index=[];for(var i=0;i<t;i++)this.group_description_index[i]=e.readUint32()},d.stshBox.prototype.parse=function(e){var t,i;if(this.parseFullHeader(e),t=e.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],0===this.version)for(i=0;i<t;i++)this.shadowed_sample_numbers.push(e.readUint32()),this.sync_sample_numbers.push(e.readUint32());else this.data=e.readUint8Array(this.size-this.hdr_size-4)},d.stssBox.prototype.parse=function(e){var t,i;if(this.parseFullHeader(e),i=e.readUint32(),0===this.version)for(this.sample_numbers=[],t=0;t<i;t++)this.sample_numbers.push(e.readUint32());else this.data=e.readUint8Array(this.size-this.hdr_size-4)},d.stszBox.prototype.parse=function(e){var t;if(this.parseFullHeader(e),this.sample_sizes=[],0===this.version)if(this.sample_size=e.readUint32(),this.sample_count=e.readUint32(),0===this.sample_size)this.sample_sizes=e.readUint32Array(this.sample_count);else for(t=0;t<this.sample_count;t++)this.sample_sizes[t]=this.sample_size;else this.data=e.readUint8Array(this.size-this.hdr_size)},d.sttsBox.prototype.parse=function(e){var t,i,r;if(this.parseFullHeader(e),t=e.readUint32(),this.sample_counts=[],this.sample_deltas=[],0===this.version)for(i=0;i<t;i++)this.sample_counts.push(e.readUint32()),r=e.readInt32(),r<0&&(a.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),r=1),this.sample_deltas.push(r);else this.data=e.readUint8Array(this.size-this.hdr_size-4)},d.stviBox.prototype.parse=function(e){this.parseFullHeader(e);var t=e.readUint32();this.single_view_allowed=3&t,this.stereo_scheme=e.readUint32();var i,a,r=e.readUint32();this.stereo_indication_type=e.readString(r),this.boxes=[];while(e.getPosition()<this.start+this.size)i=d.parseOneBox(e,!1),a=i.box,this.boxes.push(a),this[a.type]=a},d.stxtSampleEntry.prototype.parse=function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)},d.stypBox.prototype.parse=function(e){d.ftypBox.prototype.parse.call(this,e)},d.stz2Box.prototype.parse=function(e){var t,i;if(this.parseFullHeader(e),this.sample_sizes=[],0===this.version)if(this.reserved=e.readUint24(),this.field_size=e.readUint8(),i=e.readUint32(),4===this.field_size)for(t=0;t<i;t+=2){var r=e.readUint8();this.sample_sizes[t]=r>>4&15,this.sample_sizes[t+1]=15&r}else if(8===this.field_size)for(t=0;t<i;t++)this.sample_sizes[t]=e.readUint8();else if(16===this.field_size)for(t=0;t<i;t++)this.sample_sizes[t]=e.readUint16();else a.error("BoxParser","Error in length field in stz2 box");else this.data=e.readUint8Array(this.size-this.hdr_size)},d.subsBox.prototype.parse=function(e){var t,i,a,r;for(this.parseFullHeader(e),a=e.readUint32(),this.samples=[],t=0;t<a;t++){var o={};if(this.samples[t]=o,o.sample_delta=e.readUint32(),o.subsamples=[],r=e.readUint16(),r>0)for(i=0;i<r;i++){var s={};o.subsamples.push(s),1==this.version?s.size=e.readUint32():s.size=e.readUint16(),s.priority=e.readUint8(),s.discardable=e.readUint8(),s.reserved=e.readUint32()}}},d.tfdtBox.prototype.parse=function(e){this.parseFullHeader(e),1==this.version?this.baseMediaDecodeTime=e.readUint64():this.baseMediaDecodeTime=e.readUint32()},d.tfhdBox.prototype.parse=function(e){var t=0;this.parseFullHeader(e),this.track_id=e.readUint32(),this.size-this.hdr_size>t&&this.flags&d.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=e.readUint64(),t+=8):this.base_data_offset=0,this.size-this.hdr_size>t&&this.flags&d.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=e.readUint32(),t+=4):this.default_sample_description_index=0,this.size-this.hdr_size>t&&this.flags&d.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=e.readUint32(),t+=4):this.default_sample_duration=0,this.size-this.hdr_size>t&&this.flags&d.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=e.readUint32(),t+=4):this.default_sample_size=0,this.size-this.hdr_size>t&&this.flags&d.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=e.readUint32(),t+=4):this.default_sample_flags=0},d.tfraBox.prototype.parse=function(e){this.parseFullHeader(e),this.track_ID=e.readUint32(),e.readUint24();var t=e.readUint8();this.length_size_of_traf_num=t>>4&3,this.length_size_of_trun_num=t>>2&3,this.length_size_of_sample_num=3&t,this.entries=[];for(var i=e.readUint32(),a=0;a<i;a++)1===this.version?(this.time=e.readUint64(),this.moof_offset=e.readUint64()):(this.time=e.readUint32(),this.moof_offset=e.readUint32()),this.traf_number=e["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=e["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=e["readUint"+8*(this.length_size_of_sample_num+1)]()},d.tkhdBox.prototype.parse=function(e){this.parseFullHeader(e),1==this.version?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.track_id=e.readUint32(),e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.track_id=e.readUint32(),e.readUint32(),this.duration=e.readUint32()),e.readUint32Array(2),this.layer=e.readInt16(),this.alternate_group=e.readInt16(),this.volume=e.readInt16()>>8,e.readUint16(),this.matrix=e.readInt32Array(9),this.width=e.readUint32(),this.height=e.readUint32()},d.tmaxBox.prototype.parse=function(e){this.time=e.readUint32()},d.tminBox.prototype.parse=function(e){this.time=e.readUint32()},d.totlBox.prototype.parse=function(e){this.bytessent=e.readUint32()},d.tpayBox.prototype.parse=function(e){this.bytessent=e.readUint32()},d.tpylBox.prototype.parse=function(e){this.bytessent=e.readUint64()},d.trefBox.prototype.parse=function(e){var t,i;while(e.getPosition()<this.start+this.size)t=d.parseOneBox(e,!0),i=new d.TrackReferenceTypeBox(t.type,t.size,t.hdr_size,t.start),i.write===d.Box.prototype.write&&"mdat"!==i.type&&(a.warn("BoxParser",i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(e)),i.parse(e),this.boxes.push(i)},d.trepBox.prototype.parse=function(e){this.parseFullHeader(e),this.track_ID=e.readUint32(),this.boxes=[];while(e.getPosition()<this.start+this.size)ret=d.parseOneBox(e,!1),box=ret.box,this.boxes.push(box)},d.trexBox.prototype.parse=function(e){this.parseFullHeader(e),this.track_id=e.readUint32(),this.default_sample_description_index=e.readUint32(),this.default_sample_duration=e.readUint32(),this.default_sample_size=e.readUint32(),this.default_sample_flags=e.readUint32()},d.trpyBox.prototype.parse=function(e){this.bytessent=e.readUint64()},d.trunBox.prototype.parse=function(e){var t=0;if(this.parseFullHeader(e),this.sample_count=e.readUint32(),t+=4,this.size-this.hdr_size>t&&this.flags&d.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=e.readInt32(),t+=4):this.data_offset=0,this.size-this.hdr_size>t&&this.flags&d.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=e.readUint32(),t+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>t)for(var i=0;i<this.sample_count;i++)this.flags&d.TRUN_FLAGS_DURATION&&(this.sample_duration[i]=e.readUint32()),this.flags&d.TRUN_FLAGS_SIZE&&(this.sample_size[i]=e.readUint32()),this.flags&d.TRUN_FLAGS_FLAGS&&(this.sample_flags[i]=e.readUint32()),this.flags&d.TRUN_FLAGS_CTS_OFFSET&&(0===this.version?this.sample_composition_time_offset[i]=e.readUint32():this.sample_composition_time_offset[i]=e.readInt32())},d.tselBox.prototype.parse=function(e){this.parseFullHeader(e),this.switch_group=e.readUint32();var t=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var i=0;i<t;i++)this.attribute_list[i]=e.readUint32()},d.tx3gSampleEntry.prototype.parse=function(e){this.parseHeader(e),this.displayFlags=e.readUint32(),this.horizontal_justification=e.readInt8(),this.vertical_justification=e.readInt8(),this.bg_color_rgba=e.readUint8Array(4),this.box_record=e.readInt16Array(4),this.style_record=e.readUint8Array(12),this.parseFooter(e)},d.txtCBox.prototype.parse=function(e){this.parseFullHeader(e),this.config=e.readCString()},d["url Box"].prototype.parse=function(e){this.parseFullHeader(e),1!==this.flags?this.location=e.readCString():this.size-this.hdr_size&&(a.warn("BoxParser","Invalid urlBox - contains data but flag not set"),this.location=e.readString(this.size-this.hdr_size))},d["urn Box"].prototype.parse=function(e){this.parseFullHeader(e),this.name=e.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=e.readCString())},d.vmhdBox.prototype.parse=function(e){this.parseFullHeader(e),this.graphicsmode=e.readUint16(),this.opcolor=e.readUint16Array(3)},d.vttCBox.prototype.parse=function(e){this.text=e.readString(this.size-this.hdr_size)},d.Box.prototype.writeHeader=function(e,t){this.size+=8,this.size>s&&(this.size+=8),"uuid"===this.type&&(this.size+=16),a.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+e.getPosition()+(t||"")),this.size>s?e.writeUint32(1):(this.sizePosition=e.getPosition(),e.writeUint32(this.size)),e.writeString(this.type,null,4),"uuid"===this.type&&e.writeUint8Array(this.uuid),this.size>s&&e.writeUint64(this.size)},d.FullBox.prototype.writeHeader=function(e){this.size+=4,d.Box.prototype.writeHeader.call(this,e," v="+this.version+" f="+this.flags),e.writeUint8(this.version),e.writeUint24(this.flags)},d.Box.prototype.write=function(e){"mdat"===this.type?this.data&&(this.size=this.data.length,this.writeHeader(e),e.writeUint8Array(this.data)):(this.size=this.data.length,this.writeHeader(e),e.writeUint8Array(this.data))},d.ContainerBox.prototype.write=function(e){this.size=0,this.writeHeader(e);for(var t=0;t<this.boxes.length;t++)this.boxes[t]&&(this.boxes[t].write(e),this.size+=this.boxes[t].size);a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},d.TrackReferenceTypeBox.prototype.write=function(e){this.size=4*this.track_ids.length,this.writeHeader(e),e.writeUint32Array(this.track_ids)},d.avcCBox.prototype.write=function(e){var t;for(this.size=7,t=0;t<this.SPS.length;t++)this.size+=2+this.SPS[t].length;for(t=0;t<this.PPS.length;t++)this.size+=2+this.PPS[t].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(e),e.writeUint8(this.configurationVersion),e.writeUint8(this.AVCProfileIndication),e.writeUint8(this.profile_compatibility),e.writeUint8(this.AVCLevelIndication),e.writeUint8(this.lengthSizeMinusOne+252),e.writeUint8(this.SPS.length+224),t=0;t<this.SPS.length;t++)e.writeUint16(this.SPS[t].length),e.writeUint8Array(this.SPS[t]);for(e.writeUint8(this.PPS.length),t=0;t<this.PPS.length;t++)e.writeUint16(this.PPS[t].length),e.writeUint8Array(this.PPS[t]);this.ext&&e.writeUint8Array(this.ext)},d.co64Box.prototype.write=function(e){var t;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(e),e.writeUint32(this.chunk_offsets.length),t=0;t<this.chunk_offsets.length;t++)e.writeUint64(this.chunk_offsets[t])},d.cslgBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=20,this.writeHeader(e),e.writeInt32(this.compositionToDTSShift),e.writeInt32(this.leastDecodeToDisplayDelta),e.writeInt32(this.greatestDecodeToDisplayDelta),e.writeInt32(this.compositionStartTime),e.writeInt32(this.compositionEndTime)},d.cttsBox.prototype.write=function(e){var t;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(e),e.writeUint32(this.sample_counts.length),t=0;t<this.sample_counts.length;t++)e.writeUint32(this.sample_counts[t]),1===this.version?e.writeInt32(this.sample_offsets[t]):e.writeUint32(this.sample_offsets[t])},d.drefBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.entries.length);for(var t=0;t<this.entries.length;t++)this.entries[t].write(e),this.size+=this.entries[t].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},d.elngBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(e),e.writeString(this.extended_language)},d.elstBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(e),e.writeUint32(this.entries.length);for(var t=0;t<this.entries.length;t++){var i=this.entries[t];e.writeUint32(i.segment_duration),e.writeInt32(i.media_time),e.writeInt16(i.media_rate_integer),e.writeInt16(i.media_rate_fraction)}},d.emsgBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=16+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(e),e.writeCString(this.scheme_id_uri),e.writeCString(this.value),e.writeUint32(this.timescale),e.writeUint32(this.presentation_time_delta),e.writeUint32(this.event_duration),e.writeUint32(this.id),e.writeUint8Array(this.message_data)},d.ftypBox.prototype.write=function(e){this.size=8+4*this.compatible_brands.length,this.writeHeader(e),e.writeString(this.major_brand,null,4),e.writeUint32(this.minor_version);for(var t=0;t<this.compatible_brands.length;t++)e.writeString(this.compatible_brands[t],null,4)},d.hdlrBox.prototype.write=function(e){this.size=20+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(e),e.writeUint32(0),e.writeString(this.handler,null,4),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeCString(this.name)},d.kindBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(e),e.writeCString(this.schemeURI),e.writeCString(this.value)},d.mdhdBox.prototype.write=function(e){this.size=20,this.flags=0,this.version=0,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.timescale),e.writeUint32(this.duration),e.writeUint16(this.language),e.writeUint16(0)},d.mehdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.fragment_duration)},d.mfhdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.sequence_number)},d.mvhdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=96,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.timescale),e.writeUint32(this.duration),e.writeUint32(this.rate),e.writeUint16(this.volume<<8),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32Array(this.matrix),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(this.next_track_id)},d.SampleEntry.prototype.writeHeader=function(e){this.size=8,d.Box.prototype.writeHeader.call(this,e),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint16(this.data_reference_index)},d.SampleEntry.prototype.writeFooter=function(e){for(var t=0;t<this.boxes.length;t++)this.boxes[t].write(e),this.size+=this.boxes[t].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},d.SampleEntry.prototype.write=function(e){this.writeHeader(e),e.writeUint8Array(this.data),this.size+=this.data.length,a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},d.VisualSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=70,e.writeUint16(0),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.width),e.writeUint16(this.height),e.writeUint32(this.horizresolution),e.writeUint32(this.vertresolution),e.writeUint32(0),e.writeUint16(this.frame_count),e.writeString(this.compressorname,null,32),e.writeUint16(this.depth),e.writeInt16(-1),this.writeFooter(e)},d.AudioSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=20,e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.channel_count),e.writeUint16(this.samplesize),e.writeUint16(0),e.writeUint16(0),e.writeUint32(this.samplerate<<16),this.writeFooter(e)},d.SampleGroupEntry.prototype.write=function(e){e.writeUint8Array(this.data)},d.sbgpBox.prototype.write=function(e){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(e),e.writeString(this.grouping_type,null,4),e.writeUint32(this.grouping_type_parameter),e.writeUint32(this.entries.length);for(var t=0;t<this.entries.length;t++){var i=this.entries[t];e.writeInt32(i.sample_count),e.writeInt32(i.group_description_index)}},d.sgpdBox.prototype.write=function(e){var t,i;for(this.flags=0,this.size=12,t=0;t<this.entries.length;t++)i=this.entries[t],1===this.version&&(0===this.default_length&&(this.size+=4),this.size+=i.data.length);for(this.writeHeader(e),e.writeString(this.grouping_type,null,4),1===this.version&&e.writeUint32(this.default_length),this.version>=2&&e.writeUint32(this.default_sample_description_index),e.writeUint32(this.entries.length),t=0;t<this.entries.length;t++)i=this.entries[t],1===this.version&&0===this.default_length&&e.writeUint32(i.description_length),i.write(e)},d.sidxBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=20+12*this.references.length,this.writeHeader(e),e.writeUint32(this.reference_ID),e.writeUint32(this.timescale),e.writeUint32(this.earliest_presentation_time),e.writeUint32(this.first_offset),e.writeUint16(0),e.writeUint16(this.references.length);for(var t=0;t<this.references.length;t++){var i=this.references[t];e.writeUint32(i.reference_type<<31|i.referenced_size),e.writeUint32(i.subsegment_duration),e.writeUint32(i.starts_with_SAP<<31|i.SAP_type<<28|i.SAP_delta_time)}},d.stcoBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(e),e.writeUint32(this.chunk_offsets.length),e.writeUint32Array(this.chunk_offsets)},d.stscBox.prototype.write=function(e){var t;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(e),e.writeUint32(this.first_chunk.length),t=0;t<this.first_chunk.length;t++)e.writeUint32(this.first_chunk[t]),e.writeUint32(this.samples_per_chunk[t]),e.writeUint32(this.sample_description_index[t])},d.stsdBox.prototype.write=function(e){var t;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(e),e.writeUint32(this.entries.length),this.size+=4,t=0;t<this.entries.length;t++)this.entries[t].write(e),this.size+=this.entries[t].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},d.stshBox.prototype.write=function(e){var t;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(e),e.writeUint32(this.shadowed_sample_numbers.length),t=0;t<this.shadowed_sample_numbers.length;t++)e.writeUint32(this.shadowed_sample_numbers[t]),e.writeUint32(this.sync_sample_numbers[t])},d.stssBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(e),e.writeUint32(this.sample_numbers.length),e.writeUint32Array(this.sample_numbers)},d.stszBox.prototype.write=function(e){var t,i=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0){t=0;while(t+1<this.sample_sizes.length){if(this.sample_sizes[t+1]!==this.sample_sizes[0]){i=!1;break}t++}}else i=!1;this.size=8,i||(this.size+=4*this.sample_sizes.length),this.writeHeader(e),i?e.writeUint32(this.sample_sizes[0]):e.writeUint32(0),e.writeUint32(this.sample_sizes.length),i||e.writeUint32Array(this.sample_sizes)},d.sttsBox.prototype.write=function(e){var t;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(e),e.writeUint32(this.sample_counts.length),t=0;t<this.sample_counts.length;t++)e.writeUint32(this.sample_counts[t]),e.writeUint32(this.sample_deltas[t])},d.tfdtBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,1===this.version&&(this.size+=4),this.writeHeader(e),1===this.version?e.writeUint64(this.baseMediaDecodeTime):e.writeUint32(this.baseMediaDecodeTime)},d.tfhdBox.prototype.write=function(e){this.version=0,this.size=4,this.flags&d.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&d.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&d.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&d.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&d.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(e),e.writeUint32(this.track_id),this.flags&d.TFHD_FLAG_BASE_DATA_OFFSET&&e.writeUint64(this.base_data_offset),this.flags&d.TFHD_FLAG_SAMPLE_DESC&&e.writeUint32(this.default_sample_description_index),this.flags&d.TFHD_FLAG_SAMPLE_DUR&&e.writeUint32(this.default_sample_duration),this.flags&d.TFHD_FLAG_SAMPLE_SIZE&&e.writeUint32(this.default_sample_size),this.flags&d.TFHD_FLAG_SAMPLE_FLAGS&&e.writeUint32(this.default_sample_flags)},d.tkhdBox.prototype.write=function(e){this.version=0,this.size=80,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.track_id),e.writeUint32(0),e.writeUint32(this.duration),e.writeUint32(0),e.writeUint32(0),e.writeInt16(this.layer),e.writeInt16(this.alternate_group),e.writeInt16(this.volume<<8),e.writeUint16(0),e.writeInt32Array(this.matrix),e.writeUint32(this.width),e.writeUint32(this.height)},d.trexBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=20,this.writeHeader(e),e.writeUint32(this.track_id),e.writeUint32(this.default_sample_description_index),e.writeUint32(this.default_sample_duration),e.writeUint32(this.default_sample_size),e.writeUint32(this.default_sample_flags)},d.trunBox.prototype.write=function(e){this.version=0,this.size=4,this.flags&d.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&d.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&d.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&d.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&d.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&d.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(e),e.writeUint32(this.sample_count),this.flags&d.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=e.getPosition(),e.writeInt32(this.data_offset)),this.flags&d.TRUN_FLAGS_FIRST_FLAG&&e.writeUint32(this.first_sample_flags);for(var t=0;t<this.sample_count;t++)this.flags&d.TRUN_FLAGS_DURATION&&e.writeUint32(this.sample_duration[t]),this.flags&d.TRUN_FLAGS_SIZE&&e.writeUint32(this.sample_size[t]),this.flags&d.TRUN_FLAGS_FLAGS&&e.writeUint32(this.sample_flags[t]),this.flags&d.TRUN_FLAGS_CTS_OFFSET&&(0===this.version?e.writeUint32(this.sample_composition_time_offset[t]):e.writeInt32(this.sample_composition_time_offset[t]))},d["url Box"].prototype.write=function(e){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(e),this.location&&e.writeCString(this.location)},d["urn Box"].prototype.write=function(e){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(e),e.writeCString(this.name),this.location&&e.writeCString(this.location)},d.vmhdBox.prototype.write=function(e){this.version=0,this.flags=1,this.size=8,this.writeHeader(e),e.writeUint16(this.graphicsmode),e.writeUint16Array(this.opcolor)},d.cttsBox.prototype.unpack=function(e){var t,i,a;for(a=0,t=0;t<this.sample_counts.length;t++)for(i=0;i<this.sample_counts[t];i++)e[a].pts=e[a].dts+this.sample_offsets[t],a++},d.sttsBox.prototype.unpack=function(e){var t,i,a;for(a=0,t=0;t<this.sample_counts.length;t++)for(i=0;i<this.sample_counts[t];i++)e[a].dts=0===a?0:e[a-1].dts+this.sample_deltas[t],a++},d.stcoBox.prototype.unpack=function(e){var t;for(t=0;t<this.chunk_offsets.length;t++)e[t].offset=this.chunk_offsets[t]},d.stscBox.prototype.unpack=function(e){var t,i,a,r,o;for(r=0,o=0,t=0;t<this.first_chunk.length;t++)for(i=0;i<(t+1<this.first_chunk.length?this.first_chunk[t+1]:1/0);i++)for(o++,a=0;a<this.samples_per_chunk[t];a++){if(!e[r])return;e[r].description_index=this.sample_description_index[t],e[r].chunk_index=o,r++}},d.stszBox.prototype.unpack=function(e){var t;for(t=0;t<this.sample_sizes.length;t++)e[t].size=this.sample_sizes[t]};var c=function(){};c.prototype.parseSample=function(e){var t,i,a=new r(e.buffer);t=[];while(!a.isEos())i=d.parseOneBox(a,!1),i.code===d.OK&&"vttc"===i.box.type&&t.push(i.box);return t},c.prototype.getText=function(e,t,i){function a(e,t,i){return i=i||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(i)+e}function r(e){var t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60),r=Math.floor(e-3600*t-60*i),o=Math.floor(1e3*(e-3600*t-60*i-r));return a(t,2)+":"+a(i,2)+":"+a(r,2)+"."+a(o,3)}for(var o=this.parseSample(i),s="",n=0;n<o.length;n++){var l=o[n];s+=r(e)+" --\x3e "+r(t)+"\r\n",s+=l.payl.text}return s};var p=function(){};p.prototype.parseSample=function(e){var t,i={};i.resources=[];var a=new r(e.data.buffer);if(e.subsamples&&0!==e.subsamples.length){if(i.documentString=a.readString(e.subsamples[0].size),e.subsamples.length>1)for(t=1;t<e.subsamples.length;t++)i.resources[t]=a.readUint8Array(e.subsamples[t].size)}else i.documentString=a.readString(e.data.length);return i.document=(new DOMParser).parseFromString(i.documentString,"application/xml"),i};var m=function(){};m.prototype.parseSample=function(e){var t,i=new r(e.data.buffer);return t=i.readString(e.data.length),t},m.prototype.parseConfig=function(e){var t,i=new r(e.buffer);return i.readUint32(),t=i.readCString(),t};var u=function(e){this.stream=e,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1};u.prototype.parse=function(){var e,t,i=!1;if(!this.restoreParsePosition||this.restoreParsePosition())while(1){if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}if(this.saveParsePosition&&this.saveParsePosition(),e=d.parseOneBox(this.stream,i),e.code===d.ERR_NOT_ENOUGH_DATA){if(this.processIncompleteBox){if(this.processIncompleteBox(e))continue;return}return}switch(t=e.box,this.boxes.push(t),t.type){case"mdat":this.mdats.push(t);break;case"moof":this.moofs.push(t);break;case"moov":this.moovStartFound=!0,0===this.mdats.length&&(this.isProgressive=!0);default:void 0!==this[t.type]&&a.warn("ISOFile","Duplicate Box of type: "+t.type+", overriding previous occurrence"),this[t.type]=t;break}this.updateUsedBytes&&this.updateUsedBytes(t,e)}},u.prototype.getBox=function(e){var t=this.getBoxes(e,!0);return t.length?t[0]:null},u.prototype.getBoxes=function(e,t){var i=[];return u._sweep.call(this,e,i,t),i},u._sweep=function(e,t,i){for(var a in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&i)return;u._sweep.call(this.boxes[a],e,t,i)}},t.ISOFile=u,u.prototype.lastBoxStartPosition=0,u.prototype.parsingMdat=null,u.prototype.nextParsePosition=0,u.prototype.discardMdatData=!1,u.prototype.processIncompleteBox=function(e){var t,i,a;return"mdat"===e.type?(t=new d[e.type+"Box"](e.size),this.parsingMdat=t,this.boxes.push(t),this.mdats.push(t),t.start=e.start,t.hdr_size=e.hdr_size,this.stream.addUsedBytes(t.hdr_size),this.lastBoxStartPosition=t.start+t.size,a=this.stream.seek(t.start+t.size,!1,this.discardMdatData),a?(this.parsingMdat=null,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=t.start+t.size,!1)):("moov"===e.type&&(this.moovStartFound=!0,0===this.mdats.length&&(this.isProgressive=!0)),i=this.stream.mergeNextBuffer(),i?(this.nextParsePosition=this.stream.getEndPosition(),!0):(e.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+e.size:this.nextParsePosition=this.stream.getEndPosition(),!1))},u.prototype.hasIncompleteMdat=function(){return null!==this.parsingMdat},u.prototype.processIncompleteMdat=function(){var e,t;return e=this.parsingMdat,t=this.stream.seek(e.start+e.size,!1,this.discardMdatData),t?(a.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},u.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},u.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},u.prototype.updateUsedBytes=function(e,t){"mdat"===e.type?(this.stream.addUsedBytes(e.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(e.size-e.hdr_size)):this.stream.addUsedBytes(e.size)},u.prototype.lastMoofIndex=0,u.prototype.samplesDataSize=0,u.prototype.resetTables=function(){var e,t,i,a,r,o,s,n;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,e=0;e<this.moov.traks.length;e++){t=this.moov.traks[e],t.tkhd.duration=0,t.mdia.mdhd.duration=0,i=t.mdia.minf.stbl.stco||t.mdia.minf.stbl.co64,i.chunk_offsets=[],a=t.mdia.minf.stbl.stsc,a.first_chunk=[],a.samples_per_chunk=[],a.sample_description_index=[],r=t.mdia.minf.stbl.stsz||t.mdia.minf.stbl.stz2,r.sample_sizes=[],o=t.mdia.minf.stbl.stts,o.sample_counts=[],o.sample_deltas=[],s=t.mdia.minf.stbl.ctts,s&&(s.sample_counts=[],s.sample_offsets=[]),n=t.mdia.minf.stbl.stss;var l=t.mdia.minf.stbl.boxes.indexOf(n);-1!=l&&(t.mdia.minf.stbl.boxes[l]=null)}},u.prototype.buildSampleLists=function(){var e,t,i,a,r,o,s,n,l,d,c,p,m,u,f,h,g,b,v,y,_,I,w;for(e=0;e<this.moov.traks.length;e++){for(i=this.moov.traks[e],i.samples=[],a=i.mdia.minf.stbl.stco||i.mdia.minf.stbl.co64,r=i.mdia.minf.stbl.stsc,o=i.mdia.minf.stbl.stsz||i.mdia.minf.stbl.stz2,s=i.mdia.minf.stbl.stts,n=i.mdia.minf.stbl.ctts,l=i.mdia.minf.stbl.stss,d=i.mdia.minf.stbl.stsd,c=i.mdia.minf.stbl.subs,g=-1,b=-1,v=-1,y=-1,_=0,I=0,w=0,t=0;t<o.sample_sizes.length;t++){var x={};x.number=t,x.track_id=i.tkhd.track_id,x.timescale=i.mdia.mdhd.timescale,x.alreadyRead=0,i.samples[t]=x,x.size=o.sample_sizes[t],0===t?(m=1,p=0,x.chunk_index=m,x.chunk_run_index=p,h=r.samples_per_chunk[p],f=0,u=p+1<r.first_chunk.length?r.first_chunk[p+1]-1:1/0):t<h?(x.chunk_index=m,x.chunk_run_index=p):(m++,x.chunk_index=m,f=0,m<=u||(p++,u=p+1<r.first_chunk.length?r.first_chunk[p+1]-1:1/0),x.chunk_run_index=p,h+=r.samples_per_chunk[p]),x.description_index=r.sample_description_index[x.chunk_run_index]-1,x.description=d.entries[x.description_index],x.offset=a.chunk_offsets[x.chunk_index-1]+f,f+=x.size,t>g&&(b++,g<0&&(g=0),g+=s.sample_counts[b]),t>0?(i.samples[t-1].duration=s.sample_deltas[b],x.dts=i.samples[t-1].dts+i.samples[t-1].duration):x.dts=0,n?(t>=v&&(y++,v<0&&(v=0),v+=n.sample_counts[y]),x.cts=i.samples[t].dts+n.sample_offsets[y]):x.cts=x.dts,l?t==l.sample_numbers[_]-1?(x.is_rap=!0,_++):x.is_rap=!1:x.is_rap=!0,c&&c.samples[I].sample_delta+w==t&&(x.subsamples=c.samples[I].subsamples,w+=c.samples[I].sample_delta)}t>0&&(i.samples[t-1].duration=Math.max(i.mdia.mdhd.duration-i.samples[t-1].dts,0))}},u.prototype.updateSampleLists=function(){var e,t,i,a,r,o,s,n,l,c,p,m,u,f,h;if(void 0!==this.moov)while(this.lastMoofIndex<this.moofs.length)if(l=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,"moof"==l.type)for(c=l,e=0;e<c.trafs.length;e++){for(p=c.trafs[e],m=this.getTrackById(p.tfhd.track_id),u=this.getTrexById(p.tfhd.track_id),a=p.tfhd.flags&d.TFHD_FLAG_SAMPLE_DESC?p.tfhd.default_sample_description_index:u?u.default_sample_description_index:1,r=p.tfhd.flags&d.TFHD_FLAG_SAMPLE_DUR?p.tfhd.default_sample_duration:u?u.default_sample_duration:0,o=p.tfhd.flags&d.TFHD_FLAG_SAMPLE_SIZE?p.tfhd.default_sample_size:u?u.default_sample_size:0,s=p.tfhd.flags&d.TFHD_FLAG_SAMPLE_FLAGS?p.tfhd.default_sample_flags:u?u.default_sample_flags:0,t=0;t<p.truns.length;t++){var g=p.truns[t];for(i=0;i<g.sample_count;i++){f={},f.number=m.samples.length,p.first_sample_index=m.samples.length,m.samples.push(f),f.track_id=m.tkhd.track_id,f.timescale=m.mdia.mdhd.timescale,f.description_index=a-1,f.description=m.mdia.minf.stbl.stsd.entries[f.description_index],f.size=o,g.flags&d.TRUN_FLAGS_SIZE&&(f.size=g.sample_size[i]),f.duration=r,g.flags&d.TRUN_FLAGS_DURATION&&(f.duration=g.sample_duration[i]),m.first_traf_merged||i>0?f.dts=m.samples[m.samples.length-2].dts+m.samples[m.samples.length-2].duration:(p.tfdt?f.dts=p.tfdt.baseMediaDecodeTime:f.dts=0,m.first_traf_merged=!0),f.cts=f.dts,g.flags&d.TRUN_FLAGS_CTS_OFFSET&&(f.cts=f.dts+g.sample_composition_time_offset[i]),h=s,g.flags&d.TRUN_FLAGS_FLAGS?h=g.sample_flags[i]:0===i&&g.flags&d.TRUN_FLAGS_FIRST_FLAG&&(h=g.first_sample_flags),f.is_rap=!(h>>16&1);var b=!!(p.tfhd.flags&d.TFHD_FLAG_BASE_DATA_OFFSET),v=!!(p.tfhd.flags&d.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),y=!!(g.flags&d.TRUN_FLAGS_DATA_OFFSET),_=0;_=b?p.tfhd.base_data_offset:v||0===t?c.start:n,f.offset=0===t&&0===i?y?_+g.data_offset:_:n,n=f.offset+f.size}}if(p.subs){var I=p.first_sample_index;for(t=0;t<p.subs.samples.length;t++)I+=p.subs.samples[t].sample_delta,f=m.samples[I-1],f.subsamples=p.subs.samples[t].subsamples}}},u.prototype.getSample=function(e,t){var i,r=e.samples[t];if(!this.moov)return null;if(r.data){if(r.alreadyRead==r.size)return r}else r.data=new Uint8Array(r.size),r.alreadyRead=0,this.samplesDataSize+=r.size,a.debug("ISOFile","Allocating sample #"+t+" on track #"+e.tkhd.track_id+" of size "+r.size+" (total: "+this.samplesDataSize+")");var s=this.stream.findPosition(!0,r.offset+r.alreadyRead,!1);if(s>-1){i=this.stream.buffers[s];var n=i.byteLength-(r.offset+r.alreadyRead-i.fileStart);return r.size-r.alreadyRead<=n?(a.debug("ISOFile","Getting sample #"+t+" data (alreadyRead: "+r.alreadyRead+" offset: "+(r.offset+r.alreadyRead-i.fileStart)+" read size: "+(r.size-r.alreadyRead)+" full size: "+r.size+")"),o.memcpy(r.data.buffer,r.alreadyRead,i,r.offset+r.alreadyRead-i.fileStart,r.size-r.alreadyRead),i.usedBytes+=r.size-r.alreadyRead,this.stream.logBufferLevel(),r.alreadyRead=r.size,r):(a.debug("ISOFile","Getting sample #"+t+" partial data (alreadyRead: "+r.alreadyRead+" offset: "+(r.offset+r.alreadyRead-i.fileStart)+" read size: "+n+" full size: "+r.size+")"),o.memcpy(r.data.buffer,r.alreadyRead,i,r.offset+r.alreadyRead-i.fileStart,n),r.alreadyRead+=n,i.usedBytes+=n,this.stream.logBufferLevel(),null)}return null},u.prototype.releaseSample=function(e,t){var i=e.samples[t];return i.data?(this.samplesDataSize-=i.size,i.data=null,i.alreadyRead=0,i.size):0},u.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},u.prototype.getCodecs=function(){var e,t="";for(e=0;e<this.moov.traks.length;e++){var i=this.moov.traks[e];e>0&&(t+=","),t+=i.mdia.minf.stbl.stsd.entries[0].getCodec()}return t},u.prototype.getTrexById=function(e){var t;if(!this.moov||!this.moov.mvex)return null;for(t=0;t<this.moov.mvex.trexs.length;t++){var i=this.moov.mvex.trexs[t];if(i.track_id==e)return i}return null},u.prototype.getTrackById=function(e){if(void 0===this.moov)return null;for(var t=0;t<this.moov.traks.length;t++){var i=this.moov.traks[t];if(i.tkhd.track_id==e)return i}return null},u.prototype.items=[],u.prototype.itemsDataSize=0,u.prototype.flattenItemInfo=function(){var e,t,i,r=this.items,o=this.meta;if(null!==o&&void 0!==o&&void 0!==o.hdlr&&void 0!==o.iinf){for(e=0;e<o.iinf.item_infos.length;e++)i={},i.id=o.iinf.item_infos[e].item_ID,r[i.id]=i,i.ref_to=[],i.name=o.iinf.item_infos[e].item_name,o.iinf.item_infos[e].protection_index>0&&(i.protection=o.ipro.protections[o.iinf.item_infos[e].protection_index-1]),o.iinf.item_infos[e].item_type?i.type=o.iinf.item_infos[e].item_type:i.type="mime",i.content_type=o.iinf.item_infos[e].content_type,i.content_encoding=o.iinf.item_infos[e].content_encoding;if(o.iloc)for(e=0;e<o.iloc.items.length;e++){var s=o.iloc.items[e];if(i=r[s.item_ID],0!==s.data_reference_index&&(a.warn("Item storage with reference to other files: not supported"),i.source=o.dinf.boxes[s.data_reference_index-1]),void 0!==s.construction_method)switch(a.warn("Item storage with construction_method : not supported"),s.construction_method){case 0:break;case 1:break;case 2:break}else for(i.extents=[],i.size=0,t=0;t<s.extents.length;t++)i.extents[t]={},i.extents[t].offset=s.extents[t].extent_offset+s.base_offset,i.extents[t].length=s.extents[t].extent_length,i.extents[t].alreadyRead=0,i.size+=i.extents[t].length}if(o.pitm&&(r[o.pitm.item_id].primary=!0),o.iref)for(e=0;e<o.iref.references.length;e++){var n=o.iref.references[e];for(t=0;t<n.references.length;t++)r[n.from_item_ID].ref_to.push({type:n.type,id:n.references[t]})}}},u.prototype.getItem=function(e){var t,i;if(!this.meta)return null;if(i=this.items[e],!i.data&&i.size)i.data=new Uint8Array(i.size),i.alreadyRead=0,this.itemsDataSize+=i.size,a.debug("ISOFile","Allocating item #"+e+" of size "+i.size+" (total: "+this.itemsDataSize+")");else if(i.alreadyRead===i.size)return i;for(var r=0;r<i.extents.length;r++){var s=i.extents[r];if(s.alreadyRead!==s.length){var n=this.stream.findPosition(!0,s.offset+s.alreadyRead,!1);if(!(n>-1))return null;t=this.stream.buffers[n];var l=t.byteLength-(s.offset+s.alreadyRead-t.fileStart);if(!(s.length-s.alreadyRead<=l))return a.debug("ISOFile","Getting item #"+e+" extent #"+r+" partial data (alreadyRead: "+s.alreadyRead+" offset: "+(s.offset+s.alreadyRead-t.fileStart)+" read size: "+l+" full extent size: "+s.length+" full item size: "+i.size+")"),o.memcpy(i.data.buffer,i.alreadyRead,t,s.offset+s.alreadyRead-t.fileStart,l),s.alreadyRead+=l,i.alreadyRead+=l,t.usedBytes+=l,this.stream.logBufferLevel(),null;a.debug("ISOFile","Getting item #"+e+" extent #"+r+" data (alreadyRead: "+s.alreadyRead+" offset: "+(s.offset+s.alreadyRead-t.fileStart)+" read size: "+(s.length-s.alreadyRead)+" full extent size: "+s.length+" full item size: "+i.size+")"),o.memcpy(i.data.buffer,i.alreadyRead,t,s.offset+s.alreadyRead-t.fileStart,s.length-s.alreadyRead),t.usedBytes+=s.length-s.alreadyRead,this.stream.logBufferLevel(),s.alreadyRead=s.length,i.alreadyRead+=s.length}}return i.alreadyRead===i.size?i:null},u.prototype.releaseItem=function(e){var t=this.items[e];if(t.data){this.itemsDataSize-=t.size,t.data=null,t.alreadyRead=0;for(var i=0;i<t.extents.length;i++){var a=t.extents[i];a.alreadyRead=0}return t.size}return 0},u.prototype.processItems=function(e){for(var t in this.items){var i=this.items[t];this.getItem(i.id),e&&!i.sent&&(e(i),i.sent=!0,i.data=null)}},u.prototype.hasItem=function(e){for(var t in this.items){var i=this.items[t];if(i.name===e)return i.id}return-1},u.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},u.prototype.getPrimaryItem=function(){return this.meta&&this.meta.pitm?this.getItem(this.meta.pitm.item_id):null},u.prototype.write=function(e){for(var t=0;t<this.boxes.length;t++)this.boxes[t].write(e)},u.writeInitializationSegment=function(e,t,i){var r,s;a.debug("ISOFile","Generating initialization segment");var n=new o;for(n.endianness=o.BIG_ENDIAN,e.mvex=new d.mvexBox,e.boxes.push(e.mvex),t&&(e.mvex.mehd=new d.mehdBox,e.mvex.boxes.push(e.mvex.mehd),e.mvex.mehd.fragment_duration=t),r=0;r<e.traks.length;r++)s=new d.trexBox,e.mvex.boxes.push(s),e.mvex.trexs.push(s),s.track_id=e.traks[r].tkhd.track_id,s.default_sample_description_index=1,s.default_sample_duration=i,s.default_sample_size=0,s.default_sample_flags=65536;return e.write(n),n.buffer};var f=function(e){this.inputStream=new n,this.keepMdatData=void 0===e||e,this.inputIsoFile=new u(this.inputStream),this.inputIsoFile.discardMdatData=!this.keepMdatData,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1};f.prototype.setSegmentOptions=function(e,t,i){var a=this.inputIsoFile.getTrackById(e);if(a){var r={};this.fragmentedTracks.push(r),r.id=e,r.user=t,r.trak=a,a.nextSample=0,r.segmentStream=null,r.nb_samples=1e3,r.rapAlignement=!0,i&&(i.nbSamples&&(r.nb_samples=i.nbSamples),i.rapAlignement&&(r.rapAlignement=i.rapAlignement))}},f.prototype.unsetSegmentOptions=function(e){for(var t=-1,i=0;i<this.fragmentedTracks.length;i++){var a=this.fragmentedTracks[i];a.id==e&&(t=i)}t>-1&&this.fragmentedTracks.splice(t,1)},f.prototype.setExtractionOptions=function(e,t,i){var a=this.inputIsoFile.getTrackById(e);if(a){var r={};this.extractedTracks.push(r),r.id=e,r.user=t,r.trak=a,a.nextSample=0,r.nb_samples=1e3,r.samples=[],i&&i.nbSamples&&(r.nb_samples=i.nbSamples)}},f.prototype.unsetExtractionOptions=function(e){for(var t=-1,i=0;i<this.extractedTracks.length;i++){var a=this.extractedTracks[i];a.id==e&&(t=i)}t>-1&&this.extractedTracks.splice(t,1)},f.prototype.createSingleSampleMoof=function(e){var t=new d.moofBox,i=new d.mfhdBox;i.sequence_number=this.nextMoofNumber,this.nextMoofNumber++,t.boxes.push(i);var a=new d.trafBox;t.boxes.push(a);var r=new d.tfhdBox;a.boxes.push(r),r.track_id=e.track_id,r.flags=d.TFHD_FLAG_DEFAULT_BASE_IS_MOOF;var o=new d.tfdtBox;a.boxes.push(o),o.baseMediaDecodeTime=e.dts;var s=new d.trunBox;return a.boxes.push(s),t.trun=s,s.flags=d.TRUN_FLAGS_DATA_OFFSET|d.TRUN_FLAGS_DURATION|d.TRUN_FLAGS_SIZE|d.TRUN_FLAGS_FLAGS|d.TRUN_FLAGS_CTS_OFFSET,s.data_offset=0,s.first_sample_flags=0,s.sample_count=1,s.sample_duration=[],s.sample_duration[0]=e.duration,s.sample_size=[],s.sample_size[0]=e.size,s.sample_flags=[],s.sample_flags[0]=0,s.sample_composition_time_offset=[],s.sample_composition_time_offset[0]=e.cts-e.dts,t},f.prototype.createFragment=function(e,t,i,r){var s=this.inputIsoFile.getTrackById(t),n=this.inputIsoFile.getSample(s,i);if(null==n)return n=s.samples[i],this.nextSeekPosition?this.nextSeekPosition=Math.min(n.offset+n.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=s.samples[i].offset+n.alreadyRead,null;var l=r||new o;l.endianness=o.BIG_ENDIAN;var c=this.createSingleSampleMoof(n);c.write(l),c.trun.data_offset=c.size+8,a.debug("MP4Box","Adjusting data_offset with new value "+c.trun.data_offset),l.adjustUint32(c.trun.data_offset_position,c.trun.data_offset);var p=new d.mdatBox;return p.data=n.data,p.write(l),l},f.prototype.processSamples=function(){var e,t;if(this.sampleProcessingStarted){if(this.isFragmentationInitialized&&null!==this.onSegment)for(e=0;e<this.fragmentedTracks.length;e++){var i=this.fragmentedTracks[e];t=i.trak;while(t.nextSample<t.samples.length&&this.sampleProcessingStarted){a.debug("MP4Box","Creating media fragment on track #"+i.id+" for sample "+t.nextSample);var r=this.createFragment(this.inputIsoFile,i.id,t.nextSample,i.segmentStream);if(!r)break;if(i.segmentStream=r,t.nextSample++,(t.nextSample%i.nb_samples===0||t.nextSample>=t.samples.length)&&(a.info("MP4Box","Sending fragmented data on track #"+i.id+" for samples ["+Math.max(0,t.nextSample-i.nb_samples)+","+(t.nextSample-1)+"]"),a.info("MP4Box","Sample data size in memory: "+this.inputIsoFile.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(i.id,i.user,i.segmentStream.buffer,t.nextSample),i.segmentStream=null,i!==this.fragmentedTracks[e]))break}}if(null!==this.onSamples)for(e=0;e<this.extractedTracks.length;e++){var o=this.extractedTracks[e];t=o.trak;while(t.nextSample<t.samples.length&&this.sampleProcessingStarted){a.debug("MP4Box","Exporting on track #"+o.id+" sample #"+t.nextSample);var s=this.inputIsoFile.getSample(t,t.nextSample);if(!s)break;if(t.nextSample++,o.samples.push(s),(t.nextSample%o.nb_samples===0||t.nextSample>=t.samples.length)&&(a.debug("MP4Box","Sending samples on track #"+o.id+" for sample "+t.nextSample),this.onSamples&&this.onSamples(o.id,o.user,o.samples),o.samples=[],o!==this.extractedTracks[e]))break}}}},f.prototype.checkBuffer=function(e){if(null===e||void 0===e)throw"Buffer must be defined and non empty";if(void 0===e.fileStart)throw"Buffer must have a fileStart property";return 0===e.byteLength?(a.warn("MP4Box","Ignoring empty buffer (fileStart: "+e.fileStart+")"),this.inputStream.logBufferLevel(),!1):(a.info("MP4Box","Processing buffer (fileStart: "+e.fileStart+")"),e.usedBytes=0,this.inputStream.insertBuffer(e),this.inputStream.logBufferLevel(),!!this.inputStream.initialized()||(a.warn("MP4Box","Not ready to start parsing"),!1))},f.prototype.appendBuffer=function(e){var t;if(!this.checkBuffer||this.checkBuffer(e))return this.inputIsoFile.parse(),this.inputIsoFile.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.inputIsoFile.moov?(this.processSamples&&(this.sampleListBuilt||(this.inputIsoFile.buildSampleLists(),this.sampleListBuilt=!0),this.inputIsoFile.updateSampleLists()),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples&&this.processSamples(),this.nextSeekPosition?(t=this.nextSeekPosition,this.nextSeekPosition=void 0):t=this.inputIsoFile.nextParsePosition,this.inputStream.getEndFilePositionAfter&&(t=this.inputStream.getEndFilePositionAfter(t))):t=null!==this.inputIsoFile?this.inputIsoFile.nextParsePosition:0,this.inputIsoFile.meta&&(this.inputIsoFile.flattenItemInfo&&!this.itemListBuilt&&(this.inputIsoFile.flattenItemInfo(),this.itemListBuilt=!0),this.inputIsoFile.processItems&&this.inputIsoFile.processItems(this.onItem)),this.inputStream.cleanBuffers&&(a.info("MP4Box","Done processing buffer (fileStart: "+e.fileStart+") - next buffer to fetch should have a fileStart position of "+t),this.inputStream.logBufferLevel(),this.inputStream.cleanBuffers(),this.inputStream.logBufferLevel(!0),a.info("MP4Box","Sample data size in memory: "+this.inputIsoFile.getAllocatedSampleDataSize())),t},f.prototype.getInfo=function(){var e,t,i,a,r,o={},s=new Date(4,0,1,0,0,0,0).getTime();if(this.inputIsoFile.moov)for(o.hasMoov=!0,o.duration=this.inputIsoFile.moov.mvhd.duration,o.timescale=this.inputIsoFile.moov.mvhd.timescale,o.isFragmented=null!=this.inputIsoFile.moov.mvex,o.isFragmented&&this.inputIsoFile.moov.mvex.mehd?o.fragment_duration=this.inputIsoFile.moov.mvex.mehd.fragment_duration:o.fragment_duration=0,o.isProgressive=this.inputIsoFile.isProgressive,o.hasIOD=null!=this.inputIsoFile.moov.iods,o.brands=[],o.brands.push(this.inputIsoFile.ftyp.major_brand),o.brands=o.brands.concat(this.inputIsoFile.ftyp.compatible_brands),o.created=new Date(s+1e3*this.inputIsoFile.moov.mvhd.creation_time),o.modified=new Date(s+1e3*this.inputIsoFile.moov.mvhd.modification_time),o.tracks=[],o.audioTracks=[],o.videoTracks=[],o.subtitleTracks=[],o.metadataTracks=[],o.hintTracks=[],o.otherTracks=[],e=0;e<this.inputIsoFile.moov.traks.length;e++){if(i=this.inputIsoFile.moov.traks[e],r=i.mdia.minf.stbl.stsd.entries[0],a={},o.tracks.push(a),a.id=i.tkhd.track_id,a.references=[],i.tref)for(t=0;t<i.tref.boxes.length;t++)ref={},a.references.push(ref),ref.type=i.tref.boxes[t].type,ref.track_ids=i.tref.boxes[t].track_ids;for(a.created=new Date(s+1e3*i.tkhd.creation_time),a.modified=new Date(s+1e3*i.tkhd.modification_time),a.movie_duration=i.tkhd.duration,a.layer=i.tkhd.layer,a.alternate_group=i.tkhd.alternate_group,a.volume=i.tkhd.volume,a.matrix=i.tkhd.matrix,a.track_width=i.tkhd.width/65536,a.track_height=i.tkhd.height/65536,a.timescale=i.mdia.mdhd.timescale,a.duration=i.mdia.mdhd.duration,a.codec=r.getCodec(),a.kind=i.udta&&i.udta.kinds.length?i.udta.kinds[0]:{schemeURI:"",value:""},a.language=i.mdia.elng?i.mdia.elng.extended_language:i.mdia.mdhd.languageString,a.nb_samples=i.samples.length,a.size=0,t=0;t<a.nb_samples;t++)a.size+=i.samples[t].size;a.bitrate=8*a.size*a.timescale/a.duration,r.isAudio()?(o.audioTracks.push(a),a.audio={},a.audio.sample_rate=r.getSampleRate(),a.audio.channel_count=r.getChannelCount(),a.audio.sample_size=r.getSampleSize()):r.isVideo()?(o.videoTracks.push(a),a.video={},a.video.width=r.getWidth(),a.video.height=r.getHeight()):r.isSubtitle()?o.subtitleTracks.push(a):r.isHint()?o.hintTracks.push(a):r.isMetadata()?o.metadataTracks.push(a):o.otherTracks.push(a)}else o.hasMoov=!1;return o},f.prototype.writeFile=function(){var e=new o;return e.endianness=o.BIG_ENDIAN,this.inputIsoFile.write(e),e.buffer},f.prototype.initializeSegmentation=function(){var e,t,i,r;for(null===this.onSegment&&a.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.inputIsoFile.resetTables()),t=[],e=0;e<this.fragmentedTracks.length;e++){var o=new d.moovBox;o.mvhd=this.inputIsoFile.moov.mvhd,o.boxes.push(o.mvhd),i=this.inputIsoFile.getTrackById(this.fragmentedTracks[e].id),o.boxes.push(i),o.traks.push(i),r={},r.id=i.tkhd.track_id,r.user=this.fragmentedTracks[e].user,r.buffer=u.writeInitializationSegment(o,this.inputIsoFile.moov.mvex&&this.inputIsoFile.moov.mvex.mehd?this.inputIsoFile.moov.mvex.mehd.fragment_duration:void 0,this.inputIsoFile.moov.traks[e].samples.length>0?this.inputIsoFile.moov.traks[e].samples[0].duration:0),t.push(r)}return t},f.prototype.releaseUsedSamples=function(e,t){var i=0,r=this.inputIsoFile.getTrackById(e);r.lastValidSample||(r.lastValidSample=0);for(var o=r.lastValidSample;o<t;o++)i+=this.inputIsoFile.releaseSample(r,o);a.info("MP4Box","Track #"+e+" released samples up to "+t+" (released size: "+i+", remaining: "+this.inputIsoFile.samplesDataSize+")"),r.lastValidSample=t},f.prototype.flush=function(){a.info("MP4Box","Flushing remaining samples"),this.inputIsoFile.updateSampleLists(),this.processSamples(),this.inputStream.cleanBuffers(),this.inputStream.logBufferLevel(!0)},f.prototype.seekTrack=function(e,t,i){var r,o,s,n=1/0,l=0,d=0;if(0===i.samples.length)return a.info("MP4Box","No sample in track, cannot seek! Using time "+a.getDurationString(0,1)+" and offset: 0"),{offset:0,time:0};for(r=0;r<i.samples.length;r++){if(o=i.samples[r],0===r)d=0,s=o.timescale;else if(o.cts>e*o.timescale){d=r-1;break}t&&o.is_rap&&(l=r)}t&&(d=l),e=i.samples[d].cts,i.nextSample=d;while(i.samples[d].alreadyRead===i.samples[d].size)d++;return n=i.samples[d].offset+i.samples[d].alreadyRead,a.info("MP4Box","Seeking to "+(t?"RAP":"")+" sample #"+i.nextSample+" on track "+i.tkhd.track_id+", time "+a.getDurationString(e,s)+" and offset: "+n),{offset:n,time:e/s}},f.prototype.seek=function(e,t){var i,r,o,s=this.inputIsoFile.moov,n={offset:1/0,time:1/0};if(this.inputIsoFile.moov){for(o=0;o<s.traks.length;o++)i=s.traks[o],r=this.seekTrack(e,t,i),r.offset<n.offset&&(n.offset=r.offset),r.time<n.time&&(n.time=r.time);return a.info("MP4Box","Seeking at time "+a.getDurationString(n.time,1)+" needs a buffer with a fileStart position of "+n.offset),n.offset===1/0?n={offset:this.inputIsoFile.nextParsePosition,time:0}:n.offset=this.inputStream.getEndFilePositionAfter(n.offset),a.info("MP4Box","Adjusted seek position (after checking data already in buffer): "+n.offset),n}throw"Cannot seek: moov not received!"},f.prototype.getTrackSamplesInfo=function(e){var t=this.inputIsoFile.getTrackById(e);return t?t.samples:void 0},f.prototype.getTrackSample=function(e,t){var i=this.inputIsoFile.getTrackById(e),a=this.inputIsoFile.getSample(i,t);return a},f.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples()},f.prototype.stop=function(){this.sampleProcessingStarted=!1},t.MP4Box=f},"0171":function(e,t,i){"use strict";var a=i("fb19"),r=i.n(a);r.a},"0346":function(e,t,i){},"03e1":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"accused-info"},["0"===e.info.state?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}):e._e(),i("div",{staticClass:"accused-info-item"},[i("p",{staticClass:"label"},[i("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("判定结果")]),i("div",["0"===e.info.state||"1"===e.info.state?i("el-radio",{attrs:{label:"1"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("申诉成功")]):e._e(),"0"===e.info.state||"2"===e.info.state?i("el-radio",{attrs:{label:"2"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("申诉失败")]):e._e(),"3"===e.info.state?i("span",{staticStyle:{color:"#ff7300"}},[e._v("申诉取消")]):e._e()],1)]),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("判定说明")]),i("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea",rows:4,disabled:"0"!==e.info.state},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("车牌号")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.info.plateNumber,callback:function(t){e.$set(e.info,"plateNumber",t)},expression:"info.plateNumber"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("车主姓名")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.realName,callback:function(t){e.realName=t},expression:"realName"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("手机号码")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("车辆识别代号")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.info.vin,callback:function(t){e.$set(e.info,"vin",t)},expression:"info.vin"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("发动机号")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.info.engineNumber,callback:function(t){e.$set(e.info,"engineNumber",t)},expression:"info.engineNumber"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("品牌")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.brand,callback:function(t){e.brand=t},expression:"brand"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("系列")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.series,callback:function(t){e.series=t},expression:"series"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("车型")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),i("div",{staticClass:"complant-img-div"},[i("img",{attrs:{src:e.imgUrl}})])],1)},r=[],o=(i("b0c0"),i("d3b7"),i("f36f")),s=i("8330"),n=i("1ab1"),l=i("c596"),d={name:"accused-info",data:function(){return{loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],radio:"",textarea:"",info:{},realName:"",mobile:"",brand:"",series:"",type:"",imgUrl:""}},props:{itemId:{type:String,default:function(){return""}}},components:{BizSaveButton:s["a"],BizGrid:o["a"]},computed:{},watch:{itemId:function(e,t){e&&(this.urls="",this.getAccusedInfo())}},methods:{operateHandler:function(){"1"===this.radio||"2"===this.radio?this.addComplaintInfo():this.$message.warning("请选择判定结果")},addComplaintInfo:function(){var e=this;this.loading=!0;var t={id:this.info.id,state:this.radio,vin:this.info.vin,plateNumber:this.info.plateNumber,engineNumber:this.info.engineNumber,plateNumberType:this.info.plateNumberType,paths:this.info.paths,memo:this.textarea,appealer:this.info.appealer,respondent:this.info.respondent,operator:this.info.operator,car:this.info.car};n["a"].put(l["g"].vehicleMgmt.VehicleBaseInfo_appeal,t).then((function(t){e.loading=!1,e.$message({title:"成功",message:"更新成功",type:"success"}),e.$emit("operationSuccess"),e.getAccusedInfo()})).catch((function(t){e.loading=!1,console.log(t),e.$message({title:"警告",message:t.errorMessage,type:"warning"})})).finally((function(){}))},getAccusedInfo:function(){var e=this;this.loading=!0;var t={id:this.itemId};n["a"].get(l["g"].vehicleMgmt.VehicleBaseInfo_appeal,t).then((function(t){console.log("通过id查询",t),e.loading=!1,e.info=t.data,e.textarea=e.info.memo,e.imgUrl=e.info.paths[0];var i=e.info.appealer,a=e.info.car;i&&(i.name&&(e.realName=i.name),i.mobile&&(e.mobile=i.mobile)),a&&(a.brand&&(e.brand=a.brand),a.series&&(e.series=a.series),a.type&&(e.type=a.type)),"1"===e.info.state?e.radio="1":"2"===e.info.state?e.radio="2":e.radio="0"})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage)})).finally((function(){}))}},created:function(){this.getAccusedInfo()}},c=d,p=(i("c9a3"),i("2877")),m=Object(p["a"])(c,a,r,!1,null,null,null);t["a"]=m.exports},"04b8":function(e,t,i){"use strict";t["a"]={isUnifiedSocialCreditCode:function(e){var t=/^[0-9A-Z]{18}$/;return t.test(e)},isMobile:function(e){var t=/^1(3|4|5|7|8|9)\d{9}$/;return t.test(e)},isNaturalNum:function(e){var t=/^(0|[1-9][0-9]*)$/;return t.test(e)},isIdCard:function(e){var t=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/;return t.test(e)},isPlateNum:function(e){var t=/([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}(([0-9]{5}[DF])|([DF]([A-HJ-NP-Z0-9])[0-9]{4})))|([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳]{1})/;return t.test(e)},isPostNum:function(e){var t=/^[0-9]{6}$/;return t.test(e)},isMail:function(e){var t=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/;return t.test(e)},isNum:function(e){var t=/^\d+$/;return t.test(e)}}},"0630":function(e,t,i){"use strict";var a=i("6bd2"),r=i.n(a);r.a},"069c":function(e,t,i){"use strict";var a=i("53c6"),r=i.n(a);r.a},"075d":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"apply-info"},[i("div",{staticClass:"apply-info-div"},[i("div",{staticClass:"apply-info-content"},[i("div",{staticClass:"apply-top-content"},[i("div",{staticClass:"apply-follow-up",on:{click:function(t){return e.onOrderSchedules(e.orderData.id)}}},[i("span",[e._v("申请单跟踪")]),i("div",{staticClass:"apply-state"},[i("span",[e._v(e._s(e.getOrderState))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]),i("div",{staticClass:"receiver-info"},[i("span",[e._v(e._s(e.orderData.receiver?e.orderData.receiver.consignee:""))]),i("span",[e._v(e._s(e.orderData.receiver?e.orderData.receiver.phone:""))]),i("p",[i("i",{staticClass:"el-icon-location-outline",staticStyle:{"margin-right":"5px"}}),e._v(" "+e._s(e.orderData.receiver?e.orderData.receiver.address:"")+" ")])])]),i("div",{staticClass:"apply-info-new"},[i("div",{staticClass:"shop-name",on:{click:e.goSupplier}},[i("img",{attrs:{src:e.iconShop}}),i("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(e.orderData.shop?e.orderData.shop.name:""))])]),e._l(e.orderData.itemDatas,(function(t,a){return i("div",{key:a},[i("div",{staticClass:"good-info"},[i("div",{staticClass:"goods-img"},[i("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:t.thumbnail&&t.thumbnail.indexOf("/")>=0?t.thumbnail:e.defaultImg},on:{error:function(t){return e.imgError(a)}}})]),i("div",{staticClass:"good-right"},[i("div",{staticClass:"good-name"},[i("span",{staticStyle:{flex:"1"}},[e._v(e._s(t.specValue)+" ")])]),i("div",{staticStyle:{"margin-bottom":"10px"}},[t.product.barCode?i("span",{staticStyle:{"font-size":"14px","margin-right":"10px"}},[e._v(e._s(t.product.barCode))]):e._e()]),i("div",{staticClass:"good-price"},[i("span",[e._v("￥"+e._s(t.price))]),i("span",[e._v("X"+e._s(t.amount))])])])])])}))],2),i("div",{staticClass:"price-info-content"},[i("div",{staticClass:"total-price"},[i("span",[e._v("合计")]),i("span",{staticStyle:{color:"red"}},[e._v("￥"+e._s(e.orderData.totalFee))])])]),i("div",{staticClass:"pay-type"},[i("span",[e._v("单据编号: "+e._s(e.orderData.sn))]),i("span",[e._v("创建时间: "+e._s(e.orderData.createDate))]),i("span",[e._v("申请人: "+e._s(e.orderData.applierName))])])])]),e.isPend?i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},["1"===e.orderData.state&&"1"===e.orderData.audit||"2"===e.orderData.state&&"1"===e.orderData.audit?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.toPass(e.orderData,"1")}}},[e._v("审核")]):e._e(),"0"===e.orderData.state?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.statusChange(e.orderData,"0")}}},[e._v("提交")]):e._e(),"1"===e.orderData.state&&"1"===e.orderData.isApplier?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.statusChange(e.orderData,"3")}}},[e._v("撤回")]):e._e()],1):e._e(),i("el-dialog",{attrs:{visible:e.dialogVisiable,center:"",width:"800px","min-height":"400px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("apply-follow",{ref:"invoice"})],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(t){e.showPassOrder=t}}},[i("div",[i("div",{staticClass:"reson-container"},[i("span",[e._v("审核结果：")]),i("el-radio",{attrs:{label:"1",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("通过")]),i("el-radio",{attrs:{label:"2",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("驳回")]),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[i("span",[e._v("驳回理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:e.curSelectCloseReason,callback:function(t){e.curSelectCloseReason=t},expression:"curSelectCloseReason"}},e._l(e.reasonList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showPassOrder=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange(e.row,e.auditState)}}},[e._v("确定")])],1)])],1)},r=[],o=(i("d3b7"),i("5530")),s=i("f36f"),n=i("2f62"),l=i("1ab1"),d=i("c596"),c=i("e83a"),p=i.n(c),m=i("f606"),u=i.n(m),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"order-log-info"},[i("div",{staticStyle:{"text-align":"center","font-size":"15px","margin-bottom":"20px"}},[e._v("单据进度跟踪")]),i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新申请",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderData.schedules,(function(t,a){return"0"===t.state||"1"===t.state?i("div",{key:a,staticClass:"logInfo"},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("0"===t.state?"已创建":"已提交"))]),i("p",[e._v(e._s(t.time))])]):e._e()})),0)]),i("el-step",{attrs:{title:"审核",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderData.schedules,(function(t,a){return"3"===t.state?i("div",{key:a},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(t.adminName+"已通过"))]),i("p",[e._v("备注："+e._s(t.remarks))]),i("p",[e._v(e._s(t.time))])]):e._e()})),e._l(e.orderData.schedules,(function(t,a){return"4"===t.state?i("div",{key:a},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(t.adminName+"审核不通过"))]),i("p",[e._v("理由："+e._s(t.details))]),i("p",[e._v("备注："+e._s(t.remarks))]),i("p",[e._v(e._s(t.time))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"审核通过/驳回",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},["3"===e.orderData.state?i("div",[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("审核通过"))])]):e._e(),"4"===e.orderData.state?i("div",[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("审核驳回"))])]):e._e()])])],1)],1)},h=[],g={name:"NewsMgmt",props:{},data:function(){return{loading:!1,orderData:[],active:"",state:""}},components:{},watch:{},created:function(){},computed:{getOrderLogState:function(e){switch(this.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"审核通过";default:return""}}},methods:{operate:function(e){this[e]()},getList:function(e){var t=this,i={id:e};l["a"].get(d["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,i).then((function(e){t.orderData=e.data})).catch((function(){})).finally((function(){}))}}},b=g,v=(i("9ce9"),i("2877")),y=Object(v["a"])(b,f,h,!1,null,null,null),_=y.exports,I={name:"apply-info",data:function(){return{orderData:{},iconShop:u.a,defaultImg:p.a,dialogVisiable:!1,showPassOrder:!1,loading:!1,remarks:"",auditState:"1",row:{},curSelectCloseReason:"申报的商品与实际需要采购的商品不符",reasonList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}]}},props:{itemId:{type:String,default:""},isPend:{type:Boolean,default:!1}},watch:{itemId:function(e){this.getOrderInfo()}},components:{BizGrid:s["a"],ApplyFollow:_},computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),{},{getOrderState:function(){switch(this.orderData.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"已驳回";default:return""}}}),methods:{goSupplier:function(){},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},onOrderSchedules:function(e){var t=this;this.dialogVisiable=!0,this.$nextTick((function(){t.$refs.invoice.getList(e)}))},toPass:function(e,t){this.remarks="",this.row=e,this.showPassOrder=!0},getOrderInfo:function(){var e=this,t={id:this.itemId};l["a"].get(d["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,t).then((function(t){e.orderData=t.data})).catch((function(){})).finally((function(){}))},statusChange:function(e,t){var i=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.loading=!0;var a={shopId:window.top.SHOP_ID||"",id:e.id,actionType:t,details:"2"===t?i.curSelectCloseReason:"",remarks:i.remarks};l["a"].post("/admin/invoicing/purchase/agentPurchaseApplyState.jhtml",a).then((function(e){i.$message.success("操作成功！"),i.showPassOrder=!1,i.loading=!1,i.$emit("operationSuccess")})).catch((function(e){i.loading=!1,e.errorMessage&&i.$message.warning(e.errorMessage)})).finally((function(){}))}))}},created:function(){}},w=I,x=(i("a751"),Object(v["a"])(w,a,r,!1,null,null,null));t["a"]=x.exports},"07ac":function(e,t,i){var a=i("23e7"),r=i("6f53").values;a({target:"Object",stat:!0},{values:function(e){return r(e)}})},"0943":function(e,t,i){"use strict";var a=i("1fac"),r=i.n(a);r.a},"0bb1":function(e,t,i){},"0d1d":function(e,t,i){},"0e5e":function(e,t,i){"use strict";var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={query:function(e,t,i){o.a.get(s["g"].vehicleMgmt.VehicleBaseInfo_query,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryShopList:function(e,t,i){o.a.get(s["g"].vehicleMgmt.Component_queryShops,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryBrandList:function(e,t,i){o.a.get(s["g"].vehicleMgmt.Component_queryBrands,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},querySeriesList:function(e,t,i){o.a.get(s["g"].vehicleMgmt.Component_querySeries,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryTypeList:function(e,t,i){o.a.get(s["g"].vehicleMgmt.Component_queryTypes,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryDimList:function(e,t,i){o.a.get(s["g"].vehicleMgmt.VehicleBaseInfo_queryDimList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryInsuranceList:function(e,t,i){o.a.get(s["g"].vehicleMgmt.VehicleBaseInfo_queryInsuranceList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryTerminalList:function(e,t,i){o.a.get(s["g"].vehicleMgmt.VehicleBaseInfo_queryTerminalList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryTerminalInfo:function(e,t,i){o.a.get(s["g"].vehicleMgmt.VehicleBaseInfo_queryTerminalInfo,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},update:function(e,t,i){o.a.post(s["g"].vehicleMgmt.VehicleBaseInfo_update,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},add:function(e,t,i){o.a.post(s["g"].vehicleMgmt.VehicleBaseInfo_add,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))}}},"0edd":function(e,t,i){"use strict";var a=i("d48f"),r=i.n(a);r.a},"0f32":function(e,t,i){"use strict";var a=i("75e2"),r=i.n(a);r.a},"0fd2":function(e,t,i){"use strict";var a=i("5c5a"),r=i.n(a);r.a},1029:function(e,t,i){"use strict";var a=i("f9a5"),r=i.n(a);r.a},"103b":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"work-sheet-base-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px",size:"small","inline-message":!0}},[""!==e.itemId.id?i("el-form-item",{attrs:{label:"工单号",prop:"number"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})],1):e._e(),""!==e.itemId.id?i("el-form-item",{attrs:{label:"创建时间",prop:"createDate"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.createDate,callback:function(t){e.$set(e.form,"createDate",t)},expression:"form.createDate"}})],1):e._e(),"3"!==e.form.type?i("el-form-item",{attrs:{label:"会员",prop:"member"}},[i("el-input",{attrs:{placeholder:"请选择会员",disabled:""!==e.itemId.id},on:{focus:e.handleSelect},model:{value:e.form.member.nickname,callback:function(t){e.$set(e.form.member,"nickname",t)},expression:"form.member.nickname"}})],1):e._e(),"3"!==e.form.type?i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{attrs:{placeholder:"请输入联系电话",disabled:""},model:{value:e.form.member.mobile,callback:function(t){e.$set(e.form.member,"mobile",t)},expression:"form.member.mobile"}})],1):e._e(),"3"===e.form.type?i("el-form-item",{attrs:{label:"姓名",prop:"name"}},[i("el-input",{attrs:{placeholder:"请选择姓名",disabled:""!==e.itemId.id},on:{focus:e.handleSelect},model:{value:e.form.member.name,callback:function(t){e.$set(e.form.member,"name",t)},expression:"form.member.name"}})],1):e._e(),"3"===e.form.type?i("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[i("el-input",{attrs:{placeholder:"请输入用户名",disabled:""!==e.itemId.id},model:{value:e.form.member.userName,callback:function(t){e.$set(e.form.member,"userName",t)},expression:"form.member.userName"}})],1):e._e(),"3"===e.form.type?i("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[i("el-input",{attrs:{placeholder:"请输入联系电话",disabled:""},model:{value:e.form.member.mobile,callback:function(t){e.$set(e.form.member,"mobile",t)},expression:"form.member.mobile"}})],1):e._e(),e.form.initiator?i("el-form-item",{attrs:{label:"发起人",prop:"initiator"}},[i("el-input",{attrs:{disabled:""},model:{value:e.form.initiator.name,callback:function(t){e.$set(e.form.initiator,"name",t)},expression:"form.initiator.name"}})],1):e._e(),i("el-form-item",{attrs:{label:"工单优先级",prop:"level"}},[i("el-radio",{attrs:{label:"0"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},[e._v("低")]),i("el-radio",{attrs:{label:"1"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},[e._v("中")]),i("el-radio",{attrs:{label:"2"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},[e._v("高")])],1),i("el-form-item",{attrs:{label:"工单类型",prop:"type"}},[i("el-select",{attrs:{placeholder:"请选择工单类型",disabled:2===e.form.state},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},["shop"===e.getUser().roleLevel?i("el-option",{attrs:{label:"售前",value:"0"}}):e._e(),"shop"===e.getUser().roleLevel?i("el-option",{attrs:{label:"售后",value:"1"}}):e._e(),"shop"===e.getUser().roleLevel?i("el-option",{attrs:{label:"问题反馈",value:"2"}}):e._e(),"shop"===e.getUser().roleLevel?i("el-option",{attrs:{label:"投诉",value:"3"}}):e._e(),"shop"===e.getUser().roleLevel?i("el-option",{attrs:{label:"拉黑",value:"4"}}):e._e(),"shop"!==e.getUser().roleLevel?i("el-option",{attrs:{label:"功能建议",value:"5"}}):e._e(),"shop"!==e.getUser().roleLevel?i("el-option",{attrs:{label:"体验问题",value:"6"}}):e._e()],1)],1),i("el-form-item",{staticClass:"work-sheet-content",attrs:{label:"工单内容",prop:"content"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入工单内容",maxlength:100},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}),i("img-uploader",{model:{value:e.imgList,callback:function(t){e.imgList=t},expression:"imgList"}}),i("span",{staticStyle:{color:"#666666","font-size":"12px"}},[e._v("当前仅支持.jpeg .jpg .png格式，大小10M以内")])],1),i("el-form-item",{attrs:{label:"工单状态",prop:"state"}},[i("el-select",{attrs:{placeholder:"请选择工单状态"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[i("el-option",{attrs:{label:"待受理",disabled:e.disabled1,value:"0"}}),i("el-option",{attrs:{label:"受理中",disabled:e.disabled2,value:"1"}}),i("el-option",{attrs:{label:"已完成",value:"2"}})],1)],1),i("el-form-item",{staticClass:"handle-type",attrs:{label:"转交"}},[i("el-select",{attrs:{placeholder:"请选择受理组",disabled:2===e.form.state},on:{change:e.onGroupChange},model:{value:e.form.handleGroup.id,callback:function(t){e.$set(e.form.handleGroup,"id",t)},expression:"form.handleGroup.id"}},e._l(e.handleGroupList,(function(e){return i("el-option",{key:e.index,attrs:{label:e.name,value:e.id}})})),1),i("el-select",{attrs:{placeholder:"请选择受理人",disabled:2===e.form.state},on:{change:e.onChange},model:{value:e.form.handlerAdmin.id,callback:function(t){e.$set(e.form.handlerAdmin,"id",t)},expression:"form.handlerAdmin.id"}},e._l(e.handlerList,(function(e){return i("el-option",{key:e.index,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"备注",prop:"handleContent"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入转交备注",autosize:"",disabled:2===e.form.state},model:{value:e.form.handleContent,callback:function(t){e.$set(e.form,"handleContent",t)},expression:"form.handleContent"}})],1)],1),i("biz-dialog-selector",{staticClass:"work-sheet-select-member",attrs:{title:"选择会员",selectionMode:"single",isClear:!1,visibility:e.showDialog,tableData:e.tableData,pagination:e.pagination,filters:e.filters,selectionKeys:e.selectedMemberId},on:{"update:visibility":e.updateVisibility,pageSizeChange:e.pageSizeChange,currentPageChange:e.currentPageChange,confirmed:e.confirmSelected,filterDataChange:e.filterDataChange}},[i("el-table-column",{attrs:{property:"nickname",label:"昵称"}}),i("el-table-column",{attrs:{property:"name",label:"姓名"}}),i("el-table-column",{attrs:{property:"mobile",label:"手机号"}})],1)],1)},r=[],o=(i("d81d"),i("b0c0"),i("a9e3"),i("b85c")),s=i("5530"),n=i("f36f"),l=i("8330"),d=i("2119"),c=i("af3f"),p=i("2bb3"),m=i("2863"),u=i("2f62"),f={name:"WorkSheetBaseInfo",props:{itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{imgList:[],id:"",url:"/admin/member/json/list.jhtml",selectedMemberId:[],handlerList:[],handleGroupList:[],showDialog:!1,disabled1:!1,disabled2:!1,isCS:!0,rules:{member:[{required:!1,trigger:"blur"}],level:[{required:!0,message:"请选择优先级",trigger:"blur"}],type:[{required:!0,message:"请选择工单类型",trigger:"blur"}],content:[{required:!0,message:"请填写工单内容",trigger:"blur"}],state:[{required:!0,message:"请选择工单状态",trigger:"blur"}]},operations:[{label:"保存",name:"save",type:"primary",disabled:!1,auth:["admin:customerServiceScheduling.edit"]}],loading:!1,form:this.resetForm(),filters:[{type:"input",placeholder:"请输入会员姓名或手机号",name:"searchbar",value:""}],tableData:[],pagination:this.resetPagination()}},methods:Object(s["a"])(Object(s["a"])({},Object(u["c"])(["getUser"])),{},{onChange:function(){this.form.creator.id!==this.getUser().id&&"1"!==this.form.state&&(this.form.state="1")},onGroupChange:function(e){this.querySponsorList(e)},getBaseInfo:function(){this.user=this.getUser();var e,t=Object(o["a"])(this.user.roleDatas);try{for(t.s();!(e=t.n()).done;){var i=e.value;if("5"===i.type){this.isCS=!1;break}}}catch(a){t.e(a)}finally{t.f()}},resetForm:function(){return{number:"",createDate:"",member:{id:"",nickname:""},creator:{},mobile:"",level:"0",type:"0",content:"",images:[],state:"0",handleType:"0",handlerAdmin:{id:"",name:""},handleGroup:{id:""},handleContent:""}},updateVisibility:function(){this.showDialog=!1},resetPagination:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}},pageSizeChange:function(e){this.pagination.pageSize=e,this.queryMemberList()},currentPageChange:function(e){this.pagination.currentPage=e,this.queryMemberList()},filterDataChange:function(e){this.pagination.currentPage=1,this.queryMemberList()},operate:function(e){this[e]()},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.submit()}))},submit:function(){this.form.id?this.update():this.create()},create:function(){var e=this,t=Object.assign({},this.form,this.formatImgList(this.imgList));this.loading=!0,p["a"].createBaseInfo(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("created")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage),console.log("ERR_CREATE: ",t)}))},update:function(){var e=this,t=Object.assign({},this.form,this.formatImgList(this.imgList));this.loading=!0,p["a"].updateBaseInfo(t,(function(t){e.loading=!1,e.$message.success("更新成功"),e.refresh(),e.$emit("created")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage),console.log("ERR_UPDATE: ",t)}))},clear:function(){this.form=this.resetForm(),this.imgList=[]},refresh:function(){var e=this;this.clear();var t={id:this.id};p["a"].queryBaseInfo(t,(function(t){e.loading=!1,console.log(t.data),e.form=Object.assign(e.resetForm(),t.data),e.imgList=e.formatFormImg(e.form.images),e.operations[0].disabled=!1,"2"===e.form.state&&(e.operations[0].disabled=!0),e.querySponsorList(),"1"===e.form.state&&(e.disabled1=!0),"2"===e.form.state&&(e.disabled1=!0,e.disabled2=!0)}),(function(t){e.loading=!1,e.$message.warning({message:t.errorMessage,showClose:!0}),console.log("ERR_REFRESH: ",t)}))},formatImgList:function(e){var t=e.map((function(e){return{image:e}}));return{images:t}},formatFormImg:function(e){var t=e.map((function(e){return e.image}));return t},handleSelect:function(){this.showDialog=!0,this.filters[0].value="",this.queryMemberList()},confirmSelected:function(e,t){console.log(e,t),this.showDialog=!1,this.$set(this.form,"member",{nickname:t[0].nickname,id:t[0].id}),this.form.member.mobile=t[0].mobile,this.form.member.userName=t[0].userName,this.form.member.name=t[0].name,this.selectedMemberId=e,this.$refs.form.clearValidate()},queryMemberList:function(){var e=this,t={pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,searchValue:this.filters[0].value};p["a"].queryMemberList(t,(function(t){e.tableData=[],e.tableData=t.content,e.pagination.total=Number(t.total)}),(function(e){}))},querySponsorList:function(e){var t=this;e||this.form.handleGroup.id||this.handlerList.push({id:this.form.handlerAdmin.id,name:this.form.handlerAdmin.name}),m["a"].query({id:e||this.form.handleGroup.id},(function(e){t.handlerList=e.data.members,t.loading=!1}),(function(e){console.log(e),console.log("code错误"),t.loading=!1}))},querySponsorGroupList:function(){var e=this,t={pageSize:200};p["a"].querySponsorGroupList(t,(function(t){e.handleGroupList=t.content}),(function(e){}))}}),computed:{},watch:{itemId:function(e,t){this.clear(),this.$refs.form.$el.scrollTop=0,e.id?(this.id=this.itemId.id,this.$refs.form.clearValidate(),this.refresh()):this.handlerList=[]},showDialog:function(e,t){e&&(this.pagination=this.resetPagination(),this.queryMemberList())}},mounted:function(){this.querySponsorGroupList()},components:{BizGrid:n["a"],BizSaveButton:l["a"],ImgUploader:d["a"],BizDialogSelector:c["a"]}},h=f,g=(i("3dcd"),i("2877")),b=Object(g["a"])(h,a,r,!1,null,null,null);t["a"]=b.exports},1148:function(e,t,i){"use strict";var a=i("a691"),r=i("1d80");e.exports="".repeat||function(e){var t=String(r(this)),i="",o=a(e);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(i+=t);return i}},"118c":function(e,t,i){},1367:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"merchants-mgmt-psn-qua"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small",disabled:"1"===e.form.state||"3"===this.state,"inline-message":!0}},[i("el-form-item",{attrs:{label:"姓名",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入姓名",minlength:"1",maxlength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"身份证号",prop:"idCartCode"}},[i("el-input",{attrs:{placeholder:"请输入身份证号"},model:{value:e.form.idCartCode,callback:function(t){e.$set(e.form,"idCartCode",t)},expression:"form.idCartCode"}})],1),i("el-form-item",{attrs:{label:"手持身份证",required:!0,error:""===e.form.personImg?"请上传所需照片":""}},[i("BizAvatarUploaderNew",{model:{value:e.form.personImg,callback:function(t){e.$set(e.form,"personImg",t)},expression:"form.personImg"}})],1),i("el-form-item",{attrs:{label:"身份证正面",required:!0,error:""===e.form.idCartImgFront?"请上传所需照片":""}},[i("BizAvatarUploaderNew",{model:{value:e.form.idCartImgFront,callback:function(t){e.$set(e.form,"idCartImgFront",t)},expression:"form.idCartImgFront"}})],1),i("el-form-item",{attrs:{label:"身份证反面",required:!0,error:""===e.form.idCartImgBack?"请上传所需照片":""}},[i("BizAvatarUploaderNew",{model:{value:e.form.idCartImgBack,callback:function(t){e.$set(e.form,"idCartImgBack",t)},expression:"form.idCartImgBack"}})],1),i("el-form-item",{attrs:{label:"所在区域",prop:"areaId"}},[i("biz-area-select",{attrs:{areaId:e.form.areaId},on:{areaChanged:e.areaChanged}})],1),i("el-form-item",{attrs:{label:"详细街道地址",prop:"address"}},[i("el-input",{attrs:{placeholder:"请输入详细地址",type:"textarea"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"店铺名称",prop:"shopName"}},[i("el-input",{attrs:{placeholder:"请输入您想申请的店铺名称"},model:{value:e.form.shopName,callback:function(t){e.$set(e.form,"shopName",t)},expression:"form.shopName"}})],1),i("el-form-item",{attrs:{label:"主营业务",prop:"majorBusiness"}},[i("el-input",{attrs:{placeholder:"请输入您的主营业务",type:"textarea"},model:{value:e.form.majorBusiness,callback:function(t){e.$set(e.form,"majorBusiness",t)},expression:"form.majorBusiness"}})],1),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{attrs:{disabled:""},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[i("el-option",{attrs:{label:"未审核",value:"0"}}),i("el-option",{attrs:{label:"通过",value:"1"}}),i("el-option",{attrs:{label:"未通过",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),i("el-dialog",{attrs:{slot:"float",title:"审核未通过邮件","append-to-body":"",visible:e.auditFailedDialog,"custom-class":"qualificationDialog"},on:{"update:visible":function(t){e.auditFailedDialog=t}},slot:"float"},[i("el-form",{attrs:{"label-width":"90px",size:"small"}},[i("el-form-item",{attrs:{label:"收件人地址"}},[i("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),i("el-form-item",{attrs:{label:"邮件标题"}},[i("el-input",{model:{value:e.auditFailedEmali.subject,callback:function(t){e.$set(e.auditFailedEmali,"subject",t)},expression:"auditFailedEmali.subject"}})],1),i("el-form-item",{attrs:{label:"邮件内容"}},[i("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.auditFailedEmali.content,callback:function(t){e.$set(e.auditFailedEmali,"content",t)},expression:"auditFailedEmali.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.auditFailedDialog=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendAuditFailedEmail}},[e._v("发送")])],1)],1),i("el-dialog",{attrs:{title:"提示",visible:e.dialogVisiblePass,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisiblePass=t}}},[i("span",[e._v(e._s(e.form.mobile)+"已被注册，请确认是否通过")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisiblePass=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onPassed}},[e._v("确 定")])],1)])],1)},r=[],o=(i("b0c0"),i("d3b7"),i("96cf"),i("1da1")),s=i("f36f"),n=i("8330"),l=i("ce2e"),d=i("2497"),c=i("bc3a"),p=i.n(c),m=i("c596"),u={get:function(e,t,i){p.a.get(m["g"].merchantsMgmt.selectPsnQua,{params:e}).then(Object(d["a"])(t,i)).catch((function(e){console.error(e)}))},save:function(e,t,i){p.a.get(m["g"].merchantsMgmt.updatePsnQua,{params:e}).then(Object(d["a"])(t,i)).catch((function(e){console.error(e)}))},create:function(e,t,i){p.a.get(m["g"].merchantsMgmt.createPsnQua,{params:e}).then(Object(d["a"])(t,i)).catch((function(e){console.error(e)}))},passed:function(e,t,i){p.a.get(m["g"].merchantsMgmt.passedPsnQua,{params:e}).then(Object(d["a"])(t,i)).catch((function(e){console.error(e)}))},abandoned:function(e,t,i){p.a.get(m["g"].merchantsMgmt.abandonedPsnQua,{params:e}).then(Object(d["a"])(t,i)).catch((function(e){console.error(e)}))}},f=i("5773"),h=i("c17f"),g=i("40ae"),b=i("1ab1"),v={name:"MerchantsMgmtPsnQua",components:{BizSaveButton:n["a"],BizAreaSelect:l["a"],BizGrid:s["a"],BizAvatarUploaderNew:h["b"],BizEditor:g["a"]},data:function(){var e=function(e,t,i){var a=/^1\d{10}$/;a.test(t)?i():i(new Error("请输入正确的手机号码"))},t=function(e,t,i){var a=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;a.test(t)?i():i(new Error("请输入正确的身份证"))};return{auditFailedDialog:!1,loading:!1,isCreated:!1,dialogVisiblePass:!1,updateId:"",email:"",userId:"",form:{name:"",idCartCode:"",personImg:"",idCartImgFront:"",idCartImgBack:"",areaId:"",address:"",mobile:"",shopName:"",majorBusiness:"",state:"0",remark:"",fileData:{type:"0"}},operations:[{disabled:!1,label:"废弃",name:"onAbandoned",type:"danger"},{disabled:!1,label:"审核未通过邮件",name:"auditFailed",type:"primary"},{disabled:!1,label:"通过",name:"pass",type:"primary"},{disabled:!1,label:"保存",name:"save",type:"primary"}],auditFailedEmali:{subject:"V服爱车信息审核反馈通知(重要)",content:""},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],idCartCode:[{required:!0,message:"请输入身份证号码",trigger:"blur"},{validator:t,trigger:"blur"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:e,trigger:"blur"}],areaId:[{required:!0,message:"请选择",trigger:"blur"}],address:[{required:!0,message:"请输入街道地址",trigger:"blur"}],shopName:[{required:!0,message:"请输入店铺名称",trigger:"blur"}],majorBusiness:[{required:!0,message:"请输入主营业务",trigger:"blur"}]}}},props:{id:{type:String,default:""},open:{type:Boolean,default:!1},state:{type:String,default:""}},watch:{id:function(e){""===e||this.getEmailContent()},open:function(e){e&&this.refresh()}},methods:{auditFailed:function(){this.getEmailContent(),this.auditFailedDialog=!0},sendAuditFailedEmail:function(){var e=this,t={id:this.id,toMail:this.email,subject:this.auditFailedEmali.subject,content:this.auditFailedEmali.content};this.loading=!0,f["a"].sendEmail(t,(function(t){e.$message({message:"邮件发送成功！",type:"success"}),e.loading=!1}),(function(t){e.loading=!1,console.log(t)})),this.qualificationsDialog=!1},handlePersonImgSuccess:function(e){this.form.personImg=e},handleIdCartImgFrontSuccess:function(e){this.form.idCartImgFront=e},handleIdCartImgBackSuccess:function(e){this.form.idCartImgBack=e},areaChanged:function(e){this.form.areaId=e},getEmailContent:function(){this.auditFailedEmali.content='亲爱的用户，您好：<br/><br/>经我方工作人员核实，您所提交的相关信息暂未通过平台审核，还需要对以下内容进行修正：<br/><br/>以下为样例：<br/><br/>1. 手持身份证信息不清楚<br/>2. 营业执照复印件没有加盖公章<br/>3. 请点击以下网址更新您的相关材料（该链接48小时内有效，若页面空白请复制该链接到浏览器地址栏打开）：<br/><a href="'+window.location.origin+"/?companyId=&investmentId="+this.id+"&personalId="+this.updateId+'#/merchants/qua">'+window.location.origin+"/?companyId=&investmentId="+this.id+"&personalId="+this.updateId+"#/merchants/qua</a><br/><br/>祝您 万事如意<br/><br/>V服爱车团队"},pass:function(){var e=this;""!==this.form.personImg&&""!==this.form.idCartImgFront&&""!==this.form.idCartImgBack&&this.$refs.form.validate((function(t){if(!t)return!1;b["a"].post("/admin/admin/checkMobile.jhtml",{mobile:e.form.mobile}).then((function(t){t.userId?(e.userId=t.userId,e.dialogVisiblePass=!0):(e.userId="",e.onPassed())})).catch((function(t){e.loading=!1,t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))},onPassed:function(){var e=this,t={id:this.updateId,investmentId:this.id,name:this.form.name,idCartCode:this.form.idCartCode,personImg:this.form.personImg,idCartImgFront:this.form.idCartImgFront,idCartImgBack:this.form.idCartImgBack,areaId:this.form.areaId,address:this.form.address,mobile:this.form.mobile,shopName:this.form.shopName,majorBusiness:this.form.majorBusiness,remark:this.form.remark,state:"1"};this.loading=!0,u.save(t,function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,e.$message.success("操作成功"),t.next=4,e.refresh();case 4:e.$emit("created",e.form.mobile),e.dialogVisiblePass=!1;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.loading=!1,e.$notify({title:"操作失败",message:t.errorMessage,type:"warning"}),e.dialogVisiblePass=!1}))},onAbandoned:function(){var e=this;this.$confirm("此操作将废弃该申请, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};e.loading=!0,u.abandoned(t,(function(t){e.$message.success("操作成功"),e.$emit("onAbandoned")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage),console.log(t)}))})).catch((function(){}))},operate:function(e){this[e]()},save:function(){var e=this;""!==this.form.personImg&&""!==this.form.idCartImgFront&&""!==this.form.idCartImgBack&&this.$refs.form.validate((function(t){if(!t)return!1;e.submit()}))},submit:function(){this.isCreated?this.create():this.update()},create:function(){var e=this,t={investmentId:this.id,name:this.form.name,idCartCode:this.form.idCartCode,personImg:this.form.personImg,idCartImgFront:this.form.idCartImgFront,idCartImgBack:this.form.idCartImgBack,areaId:this.form.areaId,address:this.form.address,mobile:this.form.mobile,shopName:this.form.shopName,majorBusiness:this.form.majorBusiness,remark:this.form.remark,state:this.form.state};this.loading=!0,u.create(t,(function(t){e.isCreated=!1,e.loading=!1,e.$message.success("操作成功"),e.refresh()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},update:function(){var e=this,t={id:this.updateId,investmentId:this.id,name:this.form.name,idCartCode:this.form.idCartCode,personImg:this.form.personImg,idCartImgFront:this.form.idCartImgFront,idCartImgBack:this.form.idCartImgBack,areaId:this.form.areaId,address:this.form.address,mobile:this.form.mobile,shopName:this.form.shopName,majorBusiness:this.form.majorBusiness,remark:this.form.remark,state:this.form.state};this.loading=!0,u.save(t,function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,e.$message.success("操作成功"),t.next=4,e.refresh();case 4:"1"===e.form.state&&e.$emit("updateState");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.loading=!1,e.$notify({title:"更新失败",message:t.errorMessage,type:"warning"})}))},refresh:function(){var e=this,t={investmentId:this.id};this.loading=!0,this.$refs.form.$el.scrollTop=0,u.get(t,(function(t){e.form.name=t.content.name||"",e.form.mobile=t.content.mobile||"",e.form.idCartCode=t.content.idCartCode||"",e.form.personImg=t.content.personImg||"",e.form.idCartImgFront=t.content.idCartImgFront||"",e.form.idCartImgBack=t.content.idCartImgBack||"",e.form.areaId=t.content.areaId||"",e.form.address=t.content.address||"",e.form.shopName=t.content.shopName||"",e.form.majorBusiness=t.content.majorBusiness||"",e.form.remark=t.content.remark||"",e.form.state=t.content.state||"0",e.updateId=t.content.id||"",e.email=t.content.email||"",e.operations[1].disabled=!1,e.operations[0].disabled=!1,e.operations[2].disabled=!0,e.operations[3].disabled=!1,e.state&&"3"===e.state&&(e.operations[0].disabled=!0,e.operations[1].disabled=!0,e.operations[2].disabled=!0,e.operations[3].disabled=!0),t.content.state&&"1"===t.content.state&&(e.operations[1].disabled=!0),t.content.name&&(e.operations[2].disabled=!1),t.content.id?e.isCreated=!1:e.isCreated=!0,e.loading=!1}),(function(t){e.loading=!1,console.log(t),"900"===t.resultCode&&(e.isCreated=!0,e.form.name="",e.form.mobile="",e.form.idCartCode="",e.form.personImg="",e.form.idCartImgFront="",e.form.idCartImgBack="",e.form.address="",e.form.shopName="",e.form.majorBusiness="",e.form.remark="",e.form.state="0")}))}}},y=v,_=(i("b5d6"),i("2877")),I=Object(_["a"])(y,a,r,!1,null,null,null);t["a"]=I.exports},1370:function(e,t,i){},"18eb":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-tag-select"},[i("div",{staticClass:"tag-content"},[i("div",{staticClass:"tag-show-eara"},e._l(e.curSelectedTags,(function(t,a){return i("el-tag",{key:a,staticClass:"sel-tag",attrs:{closable:""},on:{close:function(i){return e.onClose(t,a)}}},[e._v(" "+e._s(t.name?t.name:t)+" ")])})),1),i("div",{staticClass:"select-area"},[i("div",{staticClass:"search-container"},[e.bAddTag?i("el-input",{attrs:{placeholder:"请输入关键词，按回车添加新标签"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.tagName,callback:function(t){e.tagName=t},expression:"tagName"}}):e._e()],1),e.tagList.length?i("div",{staticClass:"tag-container"},[i("el-checkbox-group",{attrs:{size:"small"},on:{change:e.onChange},model:{value:e.curSelectedTags,callback:function(t){e.curSelectedTags=t},expression:"curSelectedTags"}},e._l(e.curShowTags,(function(t,a){return i("el-checkbox-button",{key:a,staticClass:"tag-column",attrs:{label:t.name}},[e._v(e._s(t.name)+" ")])})),1),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showMore,expression:"showMore"}],staticClass:"more-btn",attrs:{small:"",type:"primary"},on:{click:e.onMore}},[e._v("更多...")])],1):i("div",{staticClass:"empty"},[e._v("暂无标签数据")])])])])},r=[],o=(i("4160"),i("d81d"),i("a434"),i("b0c0"),i("ac1f"),i("5319"),i("159b"),i("1ab1")),s=i("c596"),n={name:"biz-tag-select",data:function(){return{curSelectedTags:[],tagName:"",tagCatrgoryId:"",showMore:!1,curShowTags:[]}},props:{tagList:{type:Array},selectedTags:{type:Array},bAddTag:{type:Boolean,default:!0},selectType:{type:String},categoryType:{type:String,default:function(){return""}}},components:{},computed:{},watch:{selectedTags:function(e){this.curSelectedTags=e.map((function(e){return e.name?e.name:e}))},tagList:function(e){var t=this;e&&e.length&&(this.curShowTags.splice(0,this.curShowTags.length),this.tagCatrgoryId=e[0].tagCategory.id,this.showMore=e.length>6,e.forEach((function(e,i){i<6&&t.curShowTags.push(e)})))}},methods:{getCurSelectedTags:function(e){var t,i,a=this;return t=[],this.curSelectedTags.forEach((function(e){a.tagList.forEach((function(a){a.name===e&&(i={},i.id=a.id,i.name=a.name,t.push(i))}))})),t},onChange:function(e){"order"===this.selectType&&this.curSelectedTags.length>1&&(this.curSelectedTags.pop(),this.$message.warning("您已选择标签，如需要变更请先删除之前的选择")),this.$emit("change",e)},onClose:function(e,t){console.log(e),this.curSelectedTags.splice(t,1)},handleInputConfirm:function(){this.tagName=this.tagName.replace(/\s+/g,""),this.tagName&&(this.tagCatrgoryId?this.addTag():"店铺特色"===this.categoryType&&this.getTagCatrgoryId())},getTagCatrgoryId:function(){var e=this,t={categoryType:"店铺特色",isIncludeParent:"1"};o["a"].get(s["g"].systemSetting.storeTagcategories,t).then((function(t){t.content.length&&(e.tagCatrgoryId=t.content[0].id,e.addTag())})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},addTag:function(){var e=this,t={name:this.tagName,hierarchy:"1",tagCategory:{id:this.tagCatrgoryId}};o["a"].post(s["g"].systemSetting.deleteTag,t).then((function(t){e.$emit("addSuccess"),console.log(e.curSelectedTags),e.tagName=""})).catch((function(t){e.$message.warning(t.errorMessage),console.log(t.errorMessage)}))},onMore:function(){"shopProfile"===this.selectType?this.$emit("showMore"):(this.showMore=!1,this.curShowTags=this.tagList)}}},l=n,d=(i("663e"),i("2877")),c=Object(d["a"])(l,a,r,!1,null,null,null),p=c.exports;t["a"]=p},1910:function(e,t,i){},"1a03":function(e,t,i){},"1af4":function(e,t,i){},"1d5f":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"afterSale-process"},[e._l(e.refunds,(function(t,a){return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:t.id},[i("div",{staticClass:"refundsHead"},[i("div",{staticClass:"refundsContent"},[i("img",{staticClass:"image",attrs:{src:t.orderItem.thumbnail,width:"20px"}}),i("label",[e._v(e._s(t.orderItem.fullName))]),"2"!==t.type?i("label",{staticClass:"price"},[e._v("￥"+e._s(t.amount))]):e._e(),i("label",{staticClass:"refundsState"},[e._v(e._s(e.refundsStates[t.state]))])])]),i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新申请",status:"0"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(t.refundsRecords,(function(r){return"0"==r.type?i("div",{key:r.id},["1"===t.type?i("p",[e._v("买家申请退货")]):e._e(),"0"===t.type?i("p",[e._v("买家申请退款")]):e._e(),"2"===t.type?i("p",[e._v("买家申请换货")]):e._e(),"2"!==t.type?i("p",[e._v("退款原因："+e._s(t.reason))]):e._e(),"2"!==t.type?i("p",[e._v("退款金额："+e._s(t.amount))]):e._e(),"2"!==t.type?i("p",[e._v("退款说明："+e._s(t.description))]):e._e(),"2"===t.type?i("p",[e._v("换货原因："+e._s(t.reason))]):e._e(),"2"===t.type?i("p",[e._v("换货数量："+e._s(t.orderItem.quantity))]):e._e(),"2"===t.type?i("p",[e._v("换货地址："+e._s(t.receiverAddress))]):e._e(),"2"===t.type?i("p",[e._v("换货说明："+e._s(t.description))]):e._e(),i("div",{staticStyle:{display:"flex"}},[e._v(" 凭证： "),e._l(t.refundsImages,(function(t){return i("div",{key:t,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:t,height:"100"},on:{click:function(i){return e.enlarge(t)}}})])})),i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})])],2),i("p",[e._v(e._s(t.createDate))]),"0"===t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree(a)}}},[e._v("同意")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse(a)}}},[e._v("拒绝")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"agreeForm_"+a}},[i("table",{staticClass:"agreeContent",attrs:{id:"agreeContent_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"2"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("input",{attrs:{type:"hidden",name:"refundType"},domProps:{value:t.type}}),i("tr",[i("th",[e._v("售后详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),"2"===t.type||"1"===t.type?i("tr",[i("th",[e._v("收货地址：")]),i("el-card",[i("div",{staticClass:"left",on:{click:e.clickAdress}},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",{staticStyle:{float:"right"}},[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit(a)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"refuseForm_"+a}},[i("table",{staticClass:"refuseContent",attrs:{id:"refuseContent_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"1"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit(a)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),0)]),i("el-step",{attrs:{title:"售后中",status:"2"===t.refundsRecords[0].type||"3"===t.refundsRecords[0].type||"7"===t.refundsRecords[0].type||"8"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(a){return"2"===a.type&&"2"!==t.type?i("div",{key:a.id},[i("p",[e._v("卖家同意退货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(a.details))]),i("p",[e._v(e._s(a.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(a){return"2"===a.type&&"2"===t.type?i("div",{key:a.id},[i("p",[e._v("卖家同意换货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(a.details))]),i("p",[e._v(e._s(a.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(r){return"3"===r.type?i("div",{key:r.id},[i("p",[e._v("买家已退货，等待卖家收货")]),i("p",[e._v("物流公司："+e._s(r.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(r.trackingNo))]),"2"!==t.type?i("p",[e._v("退款说明："+e._s(r.details))]):e._e(),i("p",[e._v(e._s(r.happenDate))]),e._l(t.returnsImages,(function(a){return"2"!==t.type?i("div",{key:a,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:a,height:"100"},on:{click:function(t){return e.enlarge(a)}}})]):e._e()})),"2"!==t.type?i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})]):e._e(),"3"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree1(a)}}},[e._v("确认收货")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse1(a)}}},[e._v("拒绝收货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"refuseForm1_"+a}},[i("table",{staticClass:"refuseContent1",attrs:{id:"refuseContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"4"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit1(a)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"agreeForm1_"+a}},[i("table",{staticClass:"agreeContent1",attrs:{id:"agreeContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),"2"!==t.type?i("input",{attrs:{type:"hidden",name:"state",value:"5"}}):e._e(),"2"===t.type?i("input",{attrs:{type:"hidden",name:"state",value:"7"}}):e._e(),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("收货详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit1(a)}}},[e._v("确定")]):e._e()],1)])],2):e._e()})),e._l(t.refundsRecords,(function(r){return"7"===r.type?i("div",{key:r.id},[i("p",[e._v("卖家已收到买家的换货商品，待发出换货商品")]),i("p",[e._v(e._s(r.happenDate))]),"7"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shipping(a)}}},[e._v("发货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"shippingForm_"+a}},[i("table",{staticClass:"shippingContent1",attrs:{id:"shippingContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"8"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("物流公司:")]),i("td",[i("select",{directives:[{name:"model",rawName:"v-model",value:e.deliveryId,expression:"deliveryId"}],staticStyle:{width:"225px"},attrs:{name:"deliveryId"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.deliveryId=t.target.multiple?i:i[0]}}},e._l(e.deliveryCorps,(function(e,t){return i("option",{key:t,attrs:{label:e.name},domProps:{value:e.id}})})),0)])]),i("tr",[i("th",[e._v("物流单号:")]),i("td",[i("input",{attrs:{type:"text",name:"trackingNo",onKeyUp:"value=value.replace(/[\\W]/g,'')"}})])]),i("tr",[i("th",[e._v("物流费用:")]),i("td",[i("input",{attrs:{type:"text",name:"tackingAmount",onkeyup:"this.value=this.value.replace(/[^\\d.]/g,'')"}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shippingSubmit1(a)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),e._l(t.refundsRecords,(function(t){return"8"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家已发出换新货，等待买家收货")]),i("p",[e._v("物流公司："+e._s(t.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(t.trackingNo))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"售后完成",status:"1"===t.refundsRecords[0].type||"4"===t.refundsRecords[0].type||"5"===t.refundsRecords[0].type||"6"===t.refundsRecords[0].type||"9"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(t){return"5"==t.type?i("div",{key:t.id},[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("退款金额："+e._s(t.amount))]),i("p",[e._v("售后详情："+e._s(t.details))])]):e._e()})),e._l(t.refundsRecords,(function(a){return"6"==a.type&&"2"!==t.type?i("div",{key:a.id},[i("p",[e._v("买家取消退货")])]):e._e()})),e._l(t.refundsRecords,(function(a){return"6"==a.type&&"2"===t.type?i("div",{key:a.id},[i("p",[e._v("买家取消换货")])]):e._e()})),e._l(t.refundsRecords,(function(t){return"1"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝售后申请")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"4"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝收货")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"9"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已确认收货，换货完成")])]):e._e()}))],2)])],1)],1)})),0===e.refunds.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],2)},r=[],o=(i("d3b7"),i("5530")),s=i("e42c"),n=i("624d"),l=i.n(n),d=i("f36f"),c=i("f260"),p=i.n(c),m=i("2f62"),u=i("1ab1"),f=i("c596"),h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"bill-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return i("el-card",{key:t.id},[i("div",{on:{click:function(i){return e.selectItem(t)}}},[i("div",{staticClass:"top"},[i("span",[e._v(e._s(t.consignee))]),i("span",[e._v(e._s(t.phone))])]),i("div",{staticClass:"content"},[i("span",[e._v(e._s(t.areaName+t.address))])])]),i("div",{staticClass:"bottom"},["1"===t.isDefault?i("div",[e._v("默认")]):e._e(),"0"===t.isDefault?i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(i){e.$set(t,"isDefault",i)},expression:"receiver.isDefault"}},[e._v("设为默认")]):e._e(),i("div",{staticClass:"handler"},[i("i",{staticClass:"el-icon-edit-outline",on:{click:function(i){return e.editForm(t)}}},[e._v("编辑")]),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"省市"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},g=[],b=i("8330"),v=i("ce2e"),y={components:{BizSaveButton:b["a"],BizAreaSelect:v["a"],BizGrid:d["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(o["a"])(Object(o["a"])({},Object(m["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+p.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(o["a"])(Object(o["a"])({},Object(m["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u["a"].delete(f["g"].hypermarketMgmt.receiver,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(console.log(e.form.area.id),e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};u["a"].post(f["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};u["a"].put(f["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};u["a"].get(f["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},_=y,I=(i("1fd2"),i("2877")),w=Object(I["a"])(_,h,g,!1,null,null,null),x=w.exports,S={components:{BizGrid:d["a"],BillInfo:x},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{activeStep:0,loading:!1,dialogVisiable:!1,refunds:[],refundsRecords:[],refundsImages:[],formData:[],getAddress:{},refundType:"",refundId:"",orderId:"",message:"",imageValue:"",imgStyle:"",deliveryId:"",trackingNo:"",tackingAmount:"",currentState:"",active:"",defaultImage:l.a,showShippingEditor:!1,deliveryCorps:[],refundsStates:{0:"未确认",1:"拒绝退款退货/换货申请",2:"同意退/换货申请",3:"买家发货",4:"卖家拒收",5:"卖家退款",6:"取消退款",7:"卖家发货",8:"买家收货"}}},computed:Object(o["a"])(Object(o["a"])({},Object(m["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+p.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.initData(),this.getAddressList()},watch:{itemId:function(e){this.initData()}},methods:{clickAdress:function(){console.log(1111),this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};u["a"].get(f["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},initData:function(){var e=this,t={orderId:this.itemId};s["a"].viewOrderRefunds(t,(function(t){e.refunds=t.refunds}),(function(e){console.log(e)}))},close:function(){document.querySelector(".overlay").style.display="none"},enlarge:function(e){document.querySelector(".overlay").style.display="block",this.imageValue=e||l.a,this.imgStyle="position: absolute; top: 100px; right: 150px;padding:20px;height: 500px;background:#fff"},agree:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="block";for(var a=document.getElementById(t).getElementsByTagName("input"),r=0;r<a.length-1;r++)this.refundType=a[1].value;document.getElementById(i).style.display="none"},refuse:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agree1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="block",document.getElementById(i).style.display="none"},refuse1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agreeSubmit:function(e){var t=this,i="agreeForm_"+e,a={orderId:this.itemId,depotReceiverId:this.getAddress.id,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[4].value,remarks:document.getElementById(i)[5].value};this.loading=!0,s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},refuseSubmit:function(e){var t=this,i="refuseForm_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(a),this.loading=!0,s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),t.loading=!1,document.getElementById(i).style.display="none"}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},agreeSubmit1:function(e){var t=this;this.loading=!0;var i="agreeForm1_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(a),s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage),t.loading=!1}))},refuseSubmit1:function(e){var t=this;this.loading=!0;var i="refuseForm1_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},shipping:function(e){var t="shippingContent1_"+e;document.getElementById(t).style.display="block",this.init()},init:function(){var e=this;s["a"].viewOrder({orderId:this.itemId},(function(t){e.deliveryCorps=t.deliveryCorps}),(function(t){e.$message.warning(t.errorMessage)}))},shippingSubmit1:function(e){var t=this;this.loading=!0;var i="shippingForm_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:"",remarks:"",deliveryId:document.getElementById(i)[3].value,trackingNo:document.getElementById(i)[4].value,tackingAmount:document.getElementById(i)[5].value};s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},messageClick:function(){this.initData(),this.message=""}}},C=S,M=(i("25d1"),Object(I["a"])(C,a,r,!1,null,null,null));t["a"]=M.exports},"1dad":function(e,t,i){"use strict";var a=i("fdfa"),r=i.n(a);r.a},"1e9b":function(e,t,i){},"1fac":function(e,t,i){},"1fd2":function(e,t,i){"use strict";var a=i("2916"),r=i.n(a);r.a},"202d":function(e,t,i){},2086:function(e,t,i){"use strict";var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={getList:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.getMemberCardList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getRightsList:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.getList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listDistributeRights:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.listDistributeRights,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listCardTemplate:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.listCardTemplate,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getlistVbean:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.getlistVbean,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getIntegralList:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.getIntegralList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listProduct:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.listProduct,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryUserRights:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.queryUserRights,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryUserCoupons:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.queryUserCoupons,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listByRights:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.listByRights,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getVipCardInfo:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.getVipCardInfo,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getVipCardTemplate:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.getVipCardTemplate,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},memberRankList:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.memberRankList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},setting:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.setting,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},settingUpdate:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.setting,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryPeople:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.queryPeople,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},delete:function(e,t,i){o.a.delete(s["g"].memberCardMgmt.memberCard.deleteManage,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},verification:function(e,t,i){o.a.post(s["g"].memberCardMgmt.vipRights.verification,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},updateTemplate:function(e,t,i){o.a.put(s["g"].memberCardMgmt.memberCard.updateTemplate,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createTemplate:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.updateTemplate,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},delTemplate:function(e,t,i){o.a.delete(s["g"].memberCardMgmt.memberCard.updateTemplate,{data:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},distributeRights:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.distributeRights,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},distributeAssignedRights:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.distributeAssignedRights,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},updateVipCardState:function(e,t,i){o.a.put(s["g"].memberCardMgmt.memberCard.updateVipCardState,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createVipCard:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.createVipCard,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createBean:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.createBean,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createPoint:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.createPoint,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},addScore:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.addScore,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},reduceDeposit:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.reduceDeposit,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getlistUpgrade:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.getlistUpgrade,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getlistStore:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.getlistStore,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},updateGrade:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.updateGrade,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getVipCardGradeInfo:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.getVipCardGradeInfo,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},editVipCardGrade:function(e,t,i){o.a.put(s["g"].memberCardMgmt.memberCard.VipCardGrade,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},addVipCardGrade:function(e,t,i){o.a.post(s["g"].memberCardMgmt.memberCard.VipCardGrade,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},delVipCardGrade:function(e,t,i){o.a.delete(s["g"].memberCardMgmt.memberCard.VipCardGrade,{data:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listAuthority:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.listAuthority,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},vipRightsList:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.getList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryrightsClass:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.get,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getFirstClassifies:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.getFirstClassifies,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},rightsCouponList:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.rightsCouponList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryRightsCoupon:function(e,t,i){o.a.get(s["g"].memberCardMgmt.vipRights.queryRightsCoupon,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},memberCardBox:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.memberCardBox,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},editRightsClass:function(e,t,i){o.a.put(s["g"].memberCardMgmt.vipRights.edit,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createRightsClass:function(e,t,i){o.a.post(s["g"].memberCardMgmt.vipRights.add,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},rightsCouponUpdate:function(e,t,i){o.a.put(s["g"].memberCardMgmt.vipRights.rightsCouponUpdate,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},rightsCouponCreate:function(e,t,i){o.a.post(s["g"].memberCardMgmt.vipRights.rightsCouponCreate,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},deleteRightscoupon:function(e,t,i){o.a.delete(s["g"].memberCardMgmt.vipRights.deleteRightscoupon,{data:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},deleteRights:function(e,t,i){o.a.delete(s["g"].memberCardMgmt.vipRights.delete,{data:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},certificate:function(e,t,i){o.a.get(s["g"].memberCardMgmt.memberCard.certificate,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))}}},"225d":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.tableShow,expression:"tableShow"}],ref:"template"},[e._t("default",[i("span",[e._v("编写你自己的打印区域组件，然后slot插入到vue-easy-print")])],{getChineseNumber:e.getChineseNumber})],2),e.buttonShow?i("button",{class:e.buttonClass,attrs:{type:"button"},on:{click:e.print}},[i("span",[e._v("开始打印")])]):e._e()])},r=[],o=(i("a9e3"),i("d3b7"),i("ac1f"),i("25f0"),i("466d"),i("5319"),i("1276"),{name:"vue-easy-print",components:{},props:{spaceRow:{type:Boolean,default:!1},tableData:{type:Object,default:function(){}},tableShow:{type:Boolean,default:!1},buttonShow:{type:Boolean,default:!1},buttonClass:{type:String,default:"el-button el-button--default"},onePageRow:{type:Number,default:5},beforeCopy:Function,beforePrint:Function},data:function(){return{}},mounted:function(){this.init()},methods:{init:function(){var e=this,t=document.getElementById("easyPrintIframe");t?this.getStyle():(t=document.createElement("iframe"),t.id="easyPrintIframe",t.style.position="fixed",t.style.width="0",t.style.height="0",t.style.top="-100px",window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)&&(t.src='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";<\/script></head><body></body>")'),t.onload=function(){e.getStyle()},document.body.appendChild(t))},print:function(){"function"===typeof this.beforeCopy&&this.beforeCopy();var e=document.getElementById("easyPrintIframe");e.contentDocument.body.innerHTML=this.$refs.template.innerHTML,"function"===typeof this.beforePrint&&this.beforePrint(),setTimeout((function(){e.contentWindow.print()}),100)},getStyle:function(){for(var e=document.getElementById("easyPrintIframe"),t="",i=document.querySelectorAll("style"),a=0;a<i.length;a++)t+=i[a].outerHTML;e.contentDocument.head.innerHTML=t;for(var r=document.querySelectorAll("link"),o=0;o<r.length;o++){var s=document.createElement("link");s.setAttribute("rel","stylesheet"),r[o].type?s.setAttribute("type",r[o].type):s.setAttribute("type","text/css"),s.setAttribute("href",r[o].href),s.setAttribute("media","all"),e.contentDocument.head.appendChild(s)}},getChineseNumber:function(e){var t,i,a,r,o,s,n,l,d,c,p,m,u,f,h=99999999999.99,g="零",b="壹",v="贰",y="叁",_="肆",I="伍",w="陆",x="柒",S="捌",C="玖",M="拾",k="佰",T="仟",D="万",$="亿",O="",L="元",z="角",P="分",R="整";if(void 0===e)return"";if(e=e.toString(),""==e)return"";if(null!=e.match(/[^,.\d]/))return"";if(null==e.match(/^((\d{1,3}(,\d{3})*(.((\d{3},)*\d{1,3}))?)|(\d+(.\d+)?))$/))return"";if(e=e.replace(/,/g,""),e=e.replace(/^0+/,""),Number(e)>h)return alert("您输入的金额太大，请重新输入!"),"";if(r=e.split("."),r.length>1?(t=r[0],i=r[1],i=i.substr(0,2)):(t=r[0],i=""),o=new Array(g,b,v,y,_,I,w,x,S,C),s=new Array("",M,k,T),n=new Array("",D,$),l=new Array(z,P),a="",Number(t)>0){for(d=0,c=0;c<t.length;c++)p=t.length-c-1,m=t.substr(c,1),u=p/4,f=p%4,"0"==m?d++:(d>0&&(a+=o[0]),d=0,a+=o[Number(m)]+s[f]),0==f&&d<4&&(a+=n[u]);a+=L}if(""!=i)for(c=0;c<i.length;c++)m=i.substr(c,1),"0"!=m&&(a+=o[Number(m)]+l[c]);return""==a&&(a=g+L),""==i&&(a+=R),a=O+a,a}}}),s=o,n=i("2877"),l=Object(n["a"])(s,a,r,!1,null,null,null),d=l.exports;t["a"]=d},2330:function(e,t,i){},2497:function(e,t,i){"use strict";var a=i("4360"),r=i("a18c");t["a"]=function(e,t){return function(i){var o=i.data;"100"===o.resultCode?e(o):"709"===o.resultCode?(a["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",a["a"].getters.currentUser),r["a"].push("/login")):t(o)}}},"25c2":function(e,t,i){},"25d1":function(e,t,i){"use strict";var a=i("1a03"),r=i.n(a);r.a},"25eb":function(e,t,i){var a=i("23e7"),r=i("c20d");a({target:"Number",stat:!0,forced:Number.parseInt!=r},{parseInt:r})},2671:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"merchants-mgmt-com-qua"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small",disabled:"1"===e.form.state||"3"===this.state,"inline-message":!0}},[i("el-form-item",{attrs:{label:"企业名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入企业名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"统一社会信用代码",prop:"bussinessLicenseCode"}},[i("el-input",{attrs:{placeholder:"请输入18位社会信用代码"},model:{value:e.form.bussinessLicenseCode,callback:function(t){e.$set(e.form,"bussinessLicenseCode",t)},expression:"form.bussinessLicenseCode"}})],1),i("el-form-item",{attrs:{label:"营业执照所在地",prop:"address"}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入详细地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("el-form-item",{attrs:{label:"营业期限"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",clearable:e.clearable,placeholder:"请选择营业期限","value-format":"yyyy-MM-dd"},model:{value:e.form.bussinessLicenseDue,callback:function(t){e.$set(e.form,"bussinessLicenseDue",t)},expression:"form.bussinessLicenseDue"}})],1),i("el-form-item",{attrs:{label:"注册资本",prop:"registeredCapital"}},[i("el-input-number",{attrs:{placeholder:"请输入注册资本",min:0},model:{value:e.form.registeredCapital,callback:function(t){e.$set(e.form,"registeredCapital",t)},expression:"form.registeredCapital"}})],1),i("el-form-item",{attrs:{label:"营业执照副本扫描件(加盖公章)",required:!0,error:""===e.form.bussinessLicenseImg?"请上传所需照片":""}},[i("BizAvatarUploaderNew",{model:{value:e.form.bussinessLicenseImg,callback:function(t){e.$set(e.form,"bussinessLicenseImg",t)},expression:"form.bussinessLicenseImg"}})],1),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{attrs:{disabled:""},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[i("el-option",{attrs:{label:"未审核",value:"0"}}),i("el-option",{attrs:{label:"通过",value:"1"}}),i("el-option",{attrs:{label:"未通过",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),i("el-dialog",{attrs:{slot:"float",title:"审核未通过邮件","append-to-body":"",visible:e.auditFailedDialog,"custom-class":"qualificationDialog"},on:{"update:visible":function(t){e.auditFailedDialog=t}},slot:"float"},[i("el-form",{attrs:{"label-width":"90px",size:"small"}},[i("el-form-item",{attrs:{label:"收件人地址"}},[i("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),i("el-form-item",{attrs:{label:"邮件标题"}},[i("el-input",{model:{value:e.auditFailedEmali.subject,callback:function(t){e.$set(e.auditFailedEmali,"subject",t)},expression:"auditFailedEmali.subject"}})],1),i("el-form-item",{attrs:{label:"邮件内容"}},[i("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.auditFailedEmali.content,callback:function(t){e.$set(e.auditFailedEmali,"content",t)},expression:"auditFailedEmali.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.auditFailedDialog=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendAuditFailedEmail}},[e._v("发送")])],1)],1),i("el-dialog",{attrs:{title:"认证通过邮件","append-to-body":"",visible:e.certificationPassedDialog,"custom-class":"qualificationDialog"},on:{"update:visible":function(t){e.certificationPassedDialog=t}}},[i("el-form",{attrs:{model:e.certificationPassedForm,"label-width":"90px",size:"small"}},[e.passMailCount&&"0"!==e.passMailCount?i("el-form-item",{attrs:{label:"已发送邮件次数"}},[e._v(" "+e._s(e.passMailCount)+"次 ")]):e._e(),i("el-form-item",{attrs:{label:"收件人地址"}},[i("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),i("el-form-item",{attrs:{label:"邮件标题"}},[i("el-input",{model:{value:e.certificationPassedForm.subject,callback:function(t){e.$set(e.certificationPassedForm,"subject",t)},expression:"certificationPassedForm.subject"}})],1),i("el-form-item",{attrs:{label:"邮件内容"}},[i("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.certificationPassedForm.content,callback:function(t){e.$set(e.certificationPassedForm,"content",t)},expression:"certificationPassedForm.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.certificationPassedDialog=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendCertificationPassedEmail}},[e._v("发送")])],1)],1),i("el-dialog",{attrs:{title:"提示",visible:e.dialogVisiblePass,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisiblePass=t}}},[i("span",[e._v(e._s(e.form.mobile)+"手机号已注册，确定添加此手机号为管理员请点击获取验证码，验证成功后自动添加")]),i("div",{staticClass:"valid-div"},[i("el-input",{attrs:{placeholder:"请输入验证码",size:"mini"},model:{value:e.validImg,callback:function(t){e.validImg=t},expression:"validImg"}}),i("img",{attrs:{src:e.imgSrc,alt:""},on:{click:e.getVerificationImg}})],1),i("div",{staticClass:"code-div"},[i("el-input",{attrs:{placeholder:"请输入手机验证码",size:"mini"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],attrs:{type:"primary",size:"mini"},on:{click:e.getVerification}},[e._v("获取验证码")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],attrs:{type:"primary",disabled:"",size:"mini"}},[e._v(e._s(e.count)+"秒后重新获取")])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisiblePass=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"提示",visible:e.dialogAdminVisible,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogAdminVisible=t},close:e.close}},[i("span",[e._v("该用户是其他店铺管理员，确认成为本店铺管理员")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogAdminVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.complete}},[e._v("确 定")])],1)])],1)},r=[],o=(i("b0c0"),i("a9e3"),i("96cf"),i("1da1")),s=i("f36f"),n=i("8330"),l=i("2497"),d=i("bc3a"),c=i.n(d),p=i("c596"),m={get:function(e,t,i){c.a.get(p["g"].merchantsMgmt.selectComQua,{params:e}).then(Object(l["a"])(t,i)).catch((function(e){console.error(e)}))},save:function(e,t,i){c.a.get(p["g"].merchantsMgmt.updateComQua,{params:e}).then(Object(l["a"])(t,i)).catch((function(e){console.error(e)}))},create:function(e,t,i){c.a.get(p["g"].merchantsMgmt.createComQua,{params:e}).then(Object(l["a"])(t,i)).catch((function(e){console.error(e)}))},passed:function(e,t,i){c.a.get(p["g"].merchantsMgmt.passedComQua,{params:e}).then(Object(l["a"])(t,i)).catch((function(e){console.error(e)}))},abandoned:function(e,t,i){c.a.get(p["g"].merchantsMgmt.abandonedComQua,{params:e}).then(Object(l["a"])(t,i)).catch((function(e){console.error(e)}))}},u=i("5773"),f=i("04b8"),h=i("40ae"),g=i("c17f"),b=i("4e29"),v=i("1ab1"),y={name:"MerchantsMgmtComQua",components:{BizSaveButton:n["a"],BizGrid:s["a"],BizAvatarUploaderNew:g["b"],BizEditor:h["a"]},data:function(){var e=function(e,t,i){f["a"].isUnifiedSocialCreditCode(t)?i():i(new Error("请输入正确的统一社会信用代码"))},t=function(e,t,i){isNaN(t)?i(new Error("请输入数字值")):t<0?i(new Error("必须输入正数")):i()};return{auditFailedDialog:!1,isCreated:!1,clearable:!1,dialogVisiblePass:!1,dialogAdminVisible:!1,show:!0,count:"",code:"",imgSrc:"",validImg:"",validCode:"",timer:null,isManageThisStore:"",updateId:"",email:"",memberId:"",passMailCount:"",certificationPassedDialog:!1,certificationPassedForm:{subject:"V服爱车账号开通通知(重要)",content:""},form:{fileData:{type:"0"},name:"",mobile:"",bussinessLicenseCode:"",bussinessLicenseImg:"",address:"",bussinessLicenseDue:"",registeredCapital:"",state:"0",remark:""},operations:[{disabled:!1,label:"废弃",name:"onAbandoned",type:"danger"},{disabled:!1,label:"审核未通过邮件",name:"auditFailed",type:"primary"},{disabled:!1,label:"通过",name:"onPassed",type:"primary"},{label:"完成",name:"complete",type:"primary",disabled:!0},{disabled:!1,label:"保存",name:"save",type:"primary"}],auditFailedEmali:{subject:"V服爱车信息审核反馈通知(重要)",content:""},rules:{name:[{required:!0,message:"请输入企业名称",trigger:"blur"}],bussinessLicenseCode:[{required:!0,message:"请输入统一社会信用代码",trigger:"blur"},{validator:e,trigger:"blur"}],address:[{required:!0,message:"请输入营业执照所在地",trigger:"blur"}],registeredCapital:[{required:!0,message:"请输入注册资本",trigger:"blur"},{validator:t,trigger:"blur"}]}}},props:{id:{type:String,default:""},open:{type:Boolean,default:!1},state:{type:String,default:""},mobile:{type:String,default:""}},watch:{id:function(e){""===e||this.getEmailContent()},open:function(e){e&&this.refresh()}},created:function(){this.getVerificationImg()},methods:{auditFailed:function(){this.getEmailContent(),this.auditFailedDialog=!0},close:function(){this.isManageThisStore=""},getCode:function(){var e=this,t=60;this.timer||(this.count=t,this.show=!1,this.timer=setInterval((function(){e.count>0&&e.count<=t?e.count--:(e.show=!0,clearInterval(e.timer),e.timer=null)}),1e3))},getVerificationImg:function(){var e=this;this.uid=b["a"].getUuid("xxxxxxxxxxxxxxxx");var t={uid:this.uid,clientType:"2",methodName:"QueryCaptcha"},i="/rest/member/captcha.jhtml?req="+encodeURIComponent(JSON.stringify(t));v["a"].get(i).then((function(t){e.imgSrc="data:image/png;base64,"+t.captchaImage,e.uid=t.uid})).catch((function(e){}))},getVerification:function(){var e=this,t={uid:this.uid,captcha:this.validImg,clientType:"2",methodName:"SendValidateCode",phoneNumber:this.form.mobile,type:"7"},i="/rest/member/sendValidateCode.jhtml";c.a.post(i,t).then((function(t){"100"===t.data.resultCode?(e.validCode=t.data.validateCode,e.show=!0,e.getCode()):e.$message({message:t.data.errorMessage,type:"warning"})})).catch((function(e){console.log(e)}))},confirm:function(){return""===this.validImg?(this.$message.warning("请输入验证码"),!1):""===this.code?(this.$message.warning("请输入手机验证码"),!1):this.code!==this.validCode?(this.$message.warning("请输入正确的验证码"),!1):void this.complete()},complete:function(){var e=this;this.dialogAdminVisible=!1,this.dialogVisiblePass=!1,u["a"].passed({id:this.id,memberId:this.memberId,isManageThisStore:this.isManageThisStore},(function(t){e.loading=!1,e.username=t.username,e.password=t.password,e.getEmailContent(),e.openCertificationPassedEmail(),e.$emit("created")}),(function(t){e.loading=!1,e.isManageThisStore="",t.memberId?(e.memberId=t.memberId,e.dialogVisiblePass=!0):"1070"===t.resultCode?(e.dialogAdminVisible=!0,e.isManageThisStore="1"):t.errorMessage&&e.$message.warning(t.errorMessage)}))},openCertificationPassedEmail:function(){this.certificationPassedDialog=!0},sendCertificationPassedEmail:function(){var e=this,t={id:this.id,toMail:this.email,subject:this.certificationPassedForm.subject,content:this.certificationPassedForm.content};this.loading=!0,u["a"].sendEmail(t,(function(t){e.passMailCount=Number(e.passMailCount)+1,e.$message({message:"认证通过邮件发送成功！",type:"success"}),e.loading=!1}),(function(t){e.loading=!1,console.log(t)})),this.qualificationsDialog=!1},sendAuditFailedEmail:function(){var e=this,t={id:this.id,toMail:this.email,subject:this.auditFailedEmali.subject,content:this.auditFailedEmali.content};this.loading=!0,u["a"].sendEmail(t,(function(t){e.$message({message:"邮件发送成功！",type:"success"}),e.loading=!1}),(function(t){e.loading=!1,console.log(t)})),this.qualificationsDialog=!1},getEmailContent:function(){this.auditFailedEmali.content='亲爱的用户，您好：<br/><br/>经我方工作人员核实，您所提交的相关信息暂未通过平台审核，还需要对以下内容进行修正：<br/><br/>以下为样例：<br/><br/>1. 手持身份证信息不清楚<br/>2. 营业执照复印件没有加盖公章<br/>3. 请点击以下网址更新您的相关材料（该链接48小时内有效，若页面空白请复制该链接到浏览器地址栏打开）：<br/><a href="'+window.location.origin+"/?personalId=&investmentId="+this.id+"&companyId="+this.updateId+'#/merchants/qua">'+window.location.origin+"/?personalId=&investmentId="+this.id+"&companyId="+this.updateId+"#/merchants/qua</a><br/><br/>祝您 万事如意<br/><br/>V服爱车团队",this.certificationPassedForm.content="亲爱的用户，您好：<br/><br/>我们很高兴的通知您，您所提交的相关信息已通过平台的审核，现已为您开通平台使用账号。<br/>1. V服爱车平台地址<br/>"+window.location.origin+"<br/>2. 输入平台为您分配的账号，开始您的V服之旅<br/>用户名："+this.username+"<br/>密码："+this.password+"<br/>3. 如您在使用过程中遇到任何问题，或要反馈您的宝贵意见和建议，请拔打400电话：400-6556-119。<br/><br/>祝您 万事如意<br/><br/>V服爱车团队"},onPassed:function(){var e=this;this.$refs.form.validate((function(t,i){if(t){var a={id:e.updateId,investmentId:e.id,name:e.form.name,bussinessLicenseCode:e.form.bussinessLicenseCode,address:e.form.address,bussinessLicenseImg:e.form.bussinessLicenseImg,bussinessLicenseDue:e.form.bussinessLicenseDue,registeredCapital:e.form.registeredCapital,remark:e.form.remark,state:"1"};e.loading=!0,m.save(a,function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:1500}),t.next=4,e.refresh();case 4:e.$emit("created");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.loading=!1,e.$notify({title:"更新失败",message:t.errorMessage,type:"warning"})}))}}))},onAbandoned:function(){var e=this;this.$confirm("此操作将废弃该申请, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};e.loading=!0,m.abandoned(t,(function(t){e.$message.success("操作成功"),e.$emit("onAbandoned")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))})).catch((function(){}))},operate:function(e){this[e]()},areaChanged:function(e){this.areaId=e},handleBussinessLicenseImgSuccess:function(e){this.form.bussinessLicenseImg=e},save:function(){var e=this;""!==this.form.bussinessLicenseImg&&this.$refs.form.validate((function(t){if(!t)return!1;e.submit()}))},submit:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.isCreated?e.create():e.update())}))},create:function(){var e=this,t={investmentId:this.id,name:this.form.name,bussinessLicenseCode:this.form.bussinessLicenseCode,address:this.form.address,bussinessLicenseImg:this.form.bussinessLicenseImg,bussinessLicenseDue:this.form.bussinessLicenseDue,registeredCapital:this.form.registeredCapital,remark:this.form.remark,state:this.form.state};this.loading=!0,m.create(t,(function(t){e.loading=!1,e.isCreated=!1,e.$message.success("操作成功"),e.refresh()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},update:function(){var e=this,t={id:this.updateId,investmentId:this.id,name:this.form.name,bussinessLicenseCode:this.form.bussinessLicenseCode,address:this.form.address,bussinessLicenseImg:this.form.bussinessLicenseImg,bussinessLicenseDue:this.form.bussinessLicenseDue,registeredCapital:this.form.registeredCapital,remark:this.form.remark,state:this.form.state};this.loading=!0,m.save(t,function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,e.$message.success("操作成功"),t.next=4,e.refresh();case 4:"1"===e.form.state&&e.$emit("updateState");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t){e.loading=!1,e.$notify({title:"更新失败",message:t.errorMessage,type:"warning"})}))},refresh:function(){var e=this;this.$refs.form.clearValidate();var t={investmentId:this.id};this.loading=!0,m.get(t,(function(t){e.$refs.form.$el.scrollTop=0,e.form.name=t.content.name||"",e.form.mobile=t.content.personalMobile||"",e.form.bussinessLicenseCode=t.content.bussinessLicenseCode||"",e.form.bussinessLicenseImg=t.content.bussinessLicenseImg||"",e.form.bussinessLicenseDue=t.content.bussinessLicenseDue||"",e.form.registeredCapital=t.content.registeredCapital||"",e.form.address=t.content.address||"",e.form.remark=t.content.remark||"",e.form.state=t.content.state||"0",e.passMailCount=t.content.passMailCount||"",e.updateId=t.content.id||"",e.loading=!1,t.content.id?e.isCreated=!1:e.isCreated=!0,e.email=t.content.email,e.operations[3].disabled=!0,e.operations[1].disabled=!1,e.operations[0].disabled=!1,e.operations[2].disabled=!1,e.operations[4].disabled=!1,"1"===t.content.totalPassButton&&(e.operations[3].disabled=!1),e.state&&"3"===e.state&&(e.operations[0].disabled=!0,e.operations[1].disabled=!0,e.operations[2].disabled=!0,e.operations[3].disabled=!0,e.operations[4].disabled=!0),t.content.state&&"1"===t.content.state&&(e.operations[1].disabled=!0)}),(function(t){e.loading=!1,"900"!==t.resultCode&&"886"!==t.resultCode||(e.isCreated=!0,e.form.name="",e.form.bussinessLicenseCode="",e.form.address="",e.form.bussinessLicenseImg="",e.form.registeredCapital="",e.form.remark="",e.form.state="0")}))}}},_=y,I=(i("924e"),i("2877")),w=Object(I["a"])(_,a,r,!1,null,null,null);t["a"]=w.exports},"276c":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-info"},[i("div",{staticClass:"order-info-div"},[i("div",{staticClass:"order-info-content"},[i("div",{staticClass:"order-top-content"},[i("div",{staticClass:"order-follow-up",on:{click:function(t){return e.onOrderTrack(e.orderInfo.id)}}},[i("span",[e._v("订单跟踪")]),i("div",{staticClass:"order-state"},[i("span",[e._v(e._s(e.getOrderPaymentState))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]),e.orderInfo.consignee?i("div",{staticClass:"receiver-info"},[i("span",[e._v(e._s(e.orderInfo.consignee))]),i("span",[e._v(e._s(e.orderInfo.phone))]),i("p",[i("i",{staticClass:"el-icon-location-outline",staticStyle:{"margin-right":"5px"}}),e._v(" "+e._s(e.orderInfo.areaName?e.orderInfo.areaName+e.orderInfo.address:e.orderInfo.address)+" ")])]):e._e(),e.orderInfo.appointmentEndDate?i("div",{staticClass:"order-num"},[i("span",[e._v("到店时间：")]),i("span",[e._v(e._s(e.orderInfo.appointmentDate)+"-"+e._s(e.orderInfo.appointmentEndDate.slice(11,20)))])]):e._e(),"6"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("心仪车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("已有车型")]),i("span",[e._v(e._s(e.orderInfo?e.orderInfo.orderItems[0].appointment.car.type:""))])])]):e._e(),"7"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("心仪车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("裸车价格")]),i("span",[e._v("￥"+e._s(e.orderInfo.orderItems[0].appointment.product.price))])]),i("div",{staticClass:"buy-car-detail"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("首付"+e._s(e.getDownPayment))]),i("span",[e._v("￥"+e._s(e.getInitPay))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("月供")]),i("span",[e._v("￥"+e._s(e.getMonthPaidNum))])])]):e._e(),"8"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("试驾车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("预约时间")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.appontmentDate.slice(0,10):""))])])]):e._e(),e.orderInfo.invoiceTitle?i("div",{staticClass:"order-follow-up",on:{click:e.selectInvoice}},[i("span",[e._v("发票抬头")]),i("div",{staticClass:"order-state",staticStyle:{color:"#808080"}},[i("span",[e._v(e._s(e.orderInfo.invoiceTitle?e.orderInfo.invoiceTitle:"无"))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]):e._e()]),i("div",{staticClass:"order-info-new"},[i("div",{staticClass:"shop-name",on:{click:e.goShop}},[i("img",{attrs:{src:e.iconShop}}),i("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(e.orderInfo.shop?e.orderInfo.shop.name:""))])]),e._l(e.orderInfo.orderItems,(function(t,a){return i("div",{key:a},[i("div",{staticClass:"good-info",on:{click:function(i){return e.onClickProduct(t)}}},[i("div",{staticClass:"goods-img"},[i("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:t.thumbnail&&t.thumbnail.indexOf("/")>=0?t.thumbnail:e.defaultImg},on:{error:function(t){return e.imgError(a)}}})]),i("div",{staticClass:"good-right"},[i("div",{staticClass:"good-name"},[i("span",{staticStyle:{flex:"1"}},[e._v(e._s(t.fullName))]),e.showRefund[a]&&!e.isRalateBill?i("div",{staticClass:"btn-group-div"},[i("div",{staticClass:"btn-group"},[e.showRefund[a]&&e.hasAuthEdit?i("span",{staticClass:"btn-good-pay",on:{click:function(i){return i.stopPropagation(),e.onRefund(t)}}},[e._v(e._s(e.refundsLabel[a]))]):e._e()])]):e._e()]),i("div",{staticStyle:{"margin-bottom":"10px"}},[t.product.barCode?i("span",{staticStyle:{"font-size":"14px","margin-right":"10px"}},[e._v(e._s(t.product.barCode))]):e._e()]),i("div",{staticClass:"good-price"},[i("span",[e._v("￥"+e._s(t.price))]),i("span",[e._v("X"+e._s(t.quantity))])])])])])})),"1"!==e.orderInfo.isSubscription||e.activity.activityId?e._e():i("div",{staticClass:"subscription"},[i("p",[e._v(" 阶段1：订金￥"+e._s(e.orderInfo.amountPrepay)+" "),i("span",{class:{tips:parseFloat(e.orderInfo.amountPaid)<=0}},[e._v(e._s(parseFloat(e.orderInfo.amountPaid)>0?"已支付":"未支付"))])]),i("p",[e._v(" 阶段2：尾款￥"+e._s(e.orderInfo.amountFinalpay)+" "),i("span",{class:{tips:0!==parseFloat(e.orderInfo.amountPayable)}},[e._v(e._s(0===parseFloat(e.orderInfo.amountPayable)?"已支付":"未支付"))])])])],2),i("div",{staticClass:"price-info-content"},[i("div",{staticClass:"total-price"},[i("span",[e._v("产品总额")]),i("span",[e._v("￥"+e._s(e.getAmount))])]),i("div",{staticClass:"total-price"},[i("span",[e._v("邮费")]),i("span",[e._v("+ ￥"+e._s(e.orderInfo.freight))])]),parseFloat(e.orderInfo.couponDiscount)>0?i("div",{staticClass:"total-price"},[i("span",[e._v("优惠")]),i("span",[e._v("- ￥"+e._s(e.orderInfo.couponDiscount))])]):e._e(),parseFloat(e.getOffsetAmount)>0?i("div",{staticClass:"total-price"},[i("span",[e._v("商家调整")]),i("span",[e._v(e._s(e.getOffsetAmount))])]):e._e(),"1"===e.orderInfo.type?i("div",{staticClass:"total-price"},[i("span",[e._v("需付款")]),i("span",{staticClass:"color"},[e._v("￥"+e._s(e.orderInfo.amountPayable))])]):i("div",{staticClass:"total-price"},[i("span",[e._v("已付款")]),i("span",{staticClass:"color"},[e._v("￥"+e._s(e.orderInfo.amountPaid))])])]),i("div",{staticClass:"pay-type"},[i("span",[e._v("订单编号："+e._s(e.orderInfo.sn))]),e.orderInfo.paymentMethodName?i("span",[e._v("支付方式："+e._s(e.orderInfo.paymentMethodName))]):e._e(),e.orderInfo.shippingMethodName?i("span",[e._v("配送方式："+e._s(e.orderInfo.shippingMethodName))]):e._e(),e.orderInfo.memo?i("div",{staticClass:"message"},[i("span",{staticClass:"label"},[e._v("买家留言：")]),i("span",{staticClass:"buy-message",staticStyle:{"margin-left":"-3px"}},[e._v(e._s(e.orderInfo.memo))])]):e._e(),i("span",[e._v("下单时间："+e._s(e.orderInfo.orderTime))]),e.orderInfo.payments&&e.orderInfo.payments.length?i("span",[e._v("付款时间："+e._s(e.orderInfo.payments[0].paymentDate))]):e._e(),e.orderInfo.deliverDate?i("span",[e._v("预计到货时间："+e._s(e.orderInfo.deliverDate))]):e._e()])]),i("div",{staticClass:"order-bottom"})]),e.hasAuthEdit?i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},[e.showLogistics?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onLookLogistics(e.orderInfo.shippings?e.orderInfo.shippings[0].sn:"")}}},[e._v("物流跟踪")]):e._e(),("4"===e.orderInfo.state&&"0"===e.orderInfo.shippingWay||"3"===e.orderInfo.state&&"1"===e.orderInfo.shippingWay)&&"0"===e.orderInfo.hasSyncOrder?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.confirmOrder(e.orderInfo)}}},[e._v("确认收货")]):e._e(),"0"===this.hasSyncOrder&&"5"===e.orderInfo.state?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onReview(e.orderInfo.id,e.orderInfo.state)}}},[e._v("立即评价")]):e._e(),e.showLookEvaluate?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onLookEvaluate(e.orderInfo.id,e.orderInfo.state)}}},[e._v("查看评价")]):e._e()],1):e._e(),e.isPend?i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},["1"===e.orderInfo.state&&("1"===e.orderInfo.auditState&&"1"===e.orderInfo.audit||"2"===e.orderInfo.auditState&&"1"===e.orderInfo.audit)?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.toPass(e.orderInfo)}}},[e._v("审核")]):e._e()],1):e._e(),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(t){e.showPassOrder=t}}},[i("div",[i("div",{staticClass:"reson-container"},[i("span",[e._v("审核结果：")]),i("el-radio",{attrs:{label:"1",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("通过")]),i("el-radio",{attrs:{label:"2",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("驳回")]),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[i("span",[e._v("驳回理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:e.curSelectAjectReason,callback:function(t){e.curSelectAjectReason=t},expression:"curSelectAjectReason"}},e._l(e.reasonAjectList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showPassOrder=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange(e.row,e.auditState)}}},[e._v("确定")])],1)]),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("my-invoice",{ref:"invoice"})],1),i("el-dialog",{attrs:{visible:e.dialogVisiableLog,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableLog=t}}},[i("order-track",{ref:"track"})],1),i("el-dialog",{attrs:{visible:e.dialogApplaySale,title:"售后",center:"","append-to-body":""},on:{"update:visible":function(t){e.dialogApplaySale=t}}},[i("apply-sale",{ref:"applySale",attrs:{itemId:e.orderItemId,isEditable:e.isEditable},on:{operationSuccess:e.operationSuccess}})],1),i("el-dialog",{attrs:{visible:e.dialogApplayRefundInfo,"append-to-body":""},on:{"update:visible":function(t){e.dialogApplayRefundInfo=t}}},[i("refund-info",{ref:"refundInfo",attrs:{itemId:e.itemId,dialogApplayRefundInfo:e.dialogApplayRefundInfo},on:{operationSuccess:e.operationSuccess,applySaleHanlder:e.applySaleHanlder}})],1)],1)},r=[],o=(i("caad"),i("a9e3"),i("b680"),i("d3b7"),i("ac1f"),i("2532"),i("5319"),i("5530")),s=i("f36f"),n=i("2f62"),l=i("1ab1"),d=i("c596"),c=i("e83a"),p=i.n(c),m=i("517a"),u=i.n(m),f=i("f606"),h=i.n(f),g=i("a57d"),b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-track"},[i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v("待商家确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v("商家已确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"AuditPassed"===t.type?i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v("审核者："+e._s(t.operator))]),i("p",[e._v(e._s(t.createTime))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.payments.length>0?i("div",[i("p",[e._v("支付方式："+e._s(e.paymentMethod))]),i("p",[e._v("付款方式："+e._s(e.paymentType))]),e._l(e.payments,(function(t){return i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v(e._s("0"===t.paymentStatus?"未支付":"1"===t.paymentStatus?"部分支付":"已支付"))]),i("p",[e._v(e._s(t.paymentDate))]),i("p",[e._v("付款金额：￥"+e._s(t.amount))]),i("p",[e._v("交易号："+e._s(t.sn))])])}))],2):e._e()])]),i("el-step",{attrs:{title:"执行",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,a){return i("div",{key:a},["6"===t.state?i("div",[i("p",[e._v("自动派单")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason))])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("自动派单")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v(" 用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile)+" ")]):e._e(),t.dispatchRecord?i("div",[e._v(e._s(t.dispatchRecord.createDate))]):e._e(),t.refuseRecord?i("div",[e._v(e._s(t.refuseRecord.reason))]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v(" 拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks))]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已出发")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已到达")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"3"===t.state?i("div",[i("p",[e._v("完成救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"4"===t.state?i("div",[i("p",[e._v("取消救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已执行")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.shippings,(function(t){return e.shippings&&e.shippings.length>0?i("div",{key:t.id},["1"===t.shippingStatus?i("p",[e._v("订单已部分发货")]):e._e(),"1"!==t.shippingStatus?i("p",[e._v("订单已执行")]):e._e(),i("p",[e._v(e._s(t.shippingDate))]),i("p",[e._v("物流公司："+e._s(t.logistics))]),i("p",[e._v("物流单号："+e._s(t.expressSn))]),i("p",[e._v(" 收货人："+e._s(t.consignee)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(i){return e.certificate(t.id)}}},[e._v("凭证")])],1),e._l(t.shippingItems,(function(t,a){return i("p",{key:a},[e._v(e._s(t.name)+"*"+e._s(t.quantity))])})),e.devProcessShippings&&e.devProcessShippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.devProcessShippings.shippingTraces,(function(t,a){return i("div",{key:a,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.devProcessShippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()],2):e._e()}))],2)]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v("交易完成")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已评价")]),e._l(e.reviews,(function(t,a){return i("div",{key:a},["0"===t.reviewType?i("div",[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("商品："+e._s(t.product.name))]),i("p",[e._v("评分："+e._s(t.score)+"分")]),i("p",[e._v("评语："+e._s(t.content))]),e._l(t.images,(function(t,a){return i("div",{key:a,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v("店铺评分")]),i("p",[e._v("服务态度："+e._s(t.serviceAttitude)+"分")]),i("p",[e._v("服务速度："+e._s(t.serviceSpeed)+"分")]),i("p",[e._v("专业技能："+e._s(t.professional)+"分")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已关闭")]),i("p",[e._v("关闭理由："+e._s(t.content))]),i("p",[e._v("备注："+e._s(t.memo))]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]):e._e()],1),i("el-dialog",{attrs:{title:"",visible:e.outerVisible,"append-to-body":""},on:{"update:visible":function(t){e.outerVisible=t}}},[i("img",{attrs:{src:e.larImg,width:"100%"}})]),i("el-dialog",{attrs:{visible:e.dialogShipping,center:"",width:"1200px","append-to-body":"","custom-class":"printDialog"},on:{"update:visible":function(t){e.dialogShipping=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单状态："+e._s("1"===e.shippingsPrint.shippingStatus?"订单已部分发货":"订单已执行"))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v(" 发货时间："+e._s(e.shippingsPrint.shippingDate?e.shippingsPrint.shippingDate.split(" ")[0]:""))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.shippingsPrint.logistics))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shippingsPrint.expressSn))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流费用："+e._s(e.shippingsPrint.freight))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingsPrint.consignee))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingsPrint.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货地址："+e._s(e.shippingsPrint.address))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1)],1)},v=[],y=(i("4160"),i("b0c0"),i("3ca3"),i("466d"),i("1276"),i("159b"),i("ddb0"),i("2b3d"),i("96cf"),i("1da1")),_=i("225d"),I=i("e42c"),w=i("f260"),x=i.n(w),S=i("bc3a"),C=i.n(S),M={name:"order-track",data:function(){return{orderItems:[],loading:!1,open:!1,outerVisible:!1,active:"",larImg:"",orderLogs:[],reviews:[],shippings:[],payments:[],dialogShipping:!1,form:{},title:"",gridData:[],shippingsPrint:"",devProcessShippings:"",memberRescueStates:[],paymentMethodNameReal:"",type:"",amount:"",amountpaid:"",paymentType:"",paymentMethod:"",shippingId:"",latestMemberRescueState:"",workers:[],sn:"",consignee:"",fee:"",operator:"",trackingNo:"",deliveryCorp:"",orderId:"",workerId:"",dispathButton:!1,redispathButton:!1,cbp_tmlabel:!1,imgStyle:"",imageValue:"",currentState:"",preState:"",create:!1,cancel:!1,confirm:!1,service:!1,shipping:!1,payment:!1,complete:!1,review:!1,isCreate:!1,isConfirm:!1,isService:!1,isPayment:!1,isComplete:!1,isReview:!1,isCancel:!1}},props:{},components:{vueEasyPrint:_["a"],BizGrid:s["a"]},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo"])),{},{styleObject:function(){return{height:"200px",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+x.a+") 50% 50% / 200px no-repeat"}}}),watch:{},methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateLucidLogs"])),{},{print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var i,a,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={shippingId:e.shippingId},t.prev=1,t.next=4,C.a.post("/admin/purchaseOrder/voucher/export/shipping.jhtml",i,{responseType:"blob"});case 4:return a=t.sent,console.log("response => ",a),r=new Blob([a.data],{type:"application/vnd.ms-excel"}),o=decodeURI(a.headers["content-disposition"].split("filename=")[1]),s=document.createElement("a"),s.download=o.match(/"(\S*)"/)[1],s.style.display="none",s.href=URL.createObjectURL(r),document.body.appendChild(s),s.click(),URL.revokeObjectURL(s.href),document.body.removeChild(s),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=i+"-"+(a<10?"0"+a:a)+"-"+(r<10?"0"+r:r);return o},certificate:function(e){var t=this,i={shippingId:e};l["a"].get("/admin/purchaseOrder/voucher/shipping.jhtml",i).then((function(i){t.dialogShipping=!0,t.title=t.getUser.shop?t.getUser.shop.name+"发货单":"发货单",t.form=i.order,t.shippingId=e,t.shippingsPrint=i.shipping,t.gridData=i.shipping.shippingItems})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},devProcess:function(){"新悦物流"===this.deliveryCorp&&this.$emit("logistics",this.orderItems.length>0&&this.orderItems[0].product&&this.orderItems[0].product.vins.length>0?this.orderItems[0].product.vins[0].number:""),"block"===this.$refs.devProcess[0].style.display?this.$refs.devProcess[0].style.display="none":this.$refs.devProcess[0].style.display="block"},enlarge:function(e){this.larImg=e,this.outerVisible=!0},getLogs:function(e){var t=this,i={clientType:"2",methodName:"QueryOrderLog",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:e};l["a"].get("/admin/purchaseOrder/orderLogs.jhtml",i).then((function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.payments=e.payments,e.payments&&e.payments.length>1?t.amountpaid=Number(e.payments[0].amount)+Number(e.payments[1].amount):t.amountpaid="",t.orderItems=e.shippings&&e.shippings.length>0&&e.shippings[0].shippingItems,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,t.shippings=e.shippings,t.devProcessShippings=e.shippings&&e.shippings.length>0&&e.shippings[0],e.payments&&(t.paymentType=e.payments.length>0?e.payments[0].paymentType:"",t.paymentMethod=e.payments.length>0?e.payments[0].paymentMethod:"",t.amount=e.payments.length>0?e.payments[0].amount:"",t.fee=e.payments.length>0?e.payments[0].fee:"",t.sn=e.payments.length>0?e.payments[0].sn:""),e.shippings&&(t.deliveryCorp=e.shippings.length>0?e.shippings[0].logistics:"",t.trackingNo=e.shippings.length>0?e.shippings[0].expressSn:"",t.operator=e.shippings.length>0?e.shippings[0].consignee:""),t.consignee=e.order.consignee||"",t.currentState=e.orderLogs[e.orderLogs.length-1].type,e.orderLogs.length>1&&(t.preState=e.orderLogs[e.orderLogs.length-2].type),"create"===t.currentState||"confirm"===t.currentState?t.active="1":"service"===t.currentState||"shipping"===t.currentState?t.active="3":"payment"===t.currentState?t.active="2":"complete"===t.currentState?t.active="4":"review"===t.currentState?t.active="5":"cancel"===t.currentState&&(t.active="6"),!t.latestMemberRescueState||"0"!==t.latestMemberRescueState.state&&"1"!==t.dispathType?(t.dispathButton=!0,t.cbp_tmlabel=!1):(t.dispathButton=!1,t.cbp_tmlabel=!0),t.latestMemberRescueState&&"3"!==t.latestMemberRescueState.state&&"8"!==t.latestMemberRescueState.state&&"9"!==t.latestMemberRescueState.state&&"4"!==t.latestMemberRescueState.state&&"0"!==t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0,t.isCreate=!1,t.isPayment=!1,t.isComplete=!1,t.isReview=!1,t.isCancel=!1,t.isService=!1,e.orderLogs.forEach((function(e){"create"===e.type&&(t.isCreate=!0),"payment"===e.type&&(t.isPayment=!0),"complete"===e.type&&(t.isComplete=!0),"review"===e.type&&(t.isReview=!0),"cancel"===e.type&&(t.isCancel=!0),"service"===e.type&&(t.isService=!0),"shipping"===e.type&&(t.isService=!0),"confirm"===e.type&&(t.isService=!0)})),t.serviceLogs=e.serviceLogs||[],t.updateLucidLogs(t.serviceLogs)})).catch((function(e){console.log("ERR: ",e)})).finally((function(){}))},dispath:function(e){var t=this;this.id=this.itemId||"",I["a"].rescuerDispath({orderId:this.id,workerId:this.workerId},(function(e){I["a"].rescueOrderLogs({orderId:t.id,dispathType:"0"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,"0"===t.latestMemberRescueState.state||"7"===t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))}),(function(e){console.log(e)}))},rdispath:function(e){var t=this;this.id=this.itemId||"",I["a"].rescueOrderLogs({orderId:this.id,dispathType:"1"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,t.cbp_tmlabel=!0}),(function(e){console.log(e)}))}}),created:function(){this.getLogs()}},k=M,T=(i("d438"),i("2877")),D=Object(T["a"])(k,b,v,!1,null,null,null),$=D.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"apply-sale-content"},[i("div",{staticClass:"input-area"},[i("el-form",{attrs:{size:"small","label-width":"120px","inline-message":!0}},[i("el-form-item",{attrs:{label:"售后类型："}},[i("el-select",{on:{change:e.inputHandle},model:{value:e.typeStr,callback:function(t){e.typeStr=t},expression:"typeStr"}},e._l(e.options,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"我要退货退款"===e.typeStr||"我要退货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"退货数量："}},[i("el-input-number",{attrs:{size:"mini",min:1},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}})],1):e._e(),"我要换货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"换货数量："}},[i("el-input-number",{attrs:{size:"mini",min:1},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}})],1):e._e(),i("el-form-item",{attrs:{label:"售后原因："}},[i("el-select",{model:{value:e.reasonType,callback:function(t){e.reasonType=t},expression:"reasonType"}},e._l(e.reasonOptions,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"我要换货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"收货地址："}},[i("el-card",{nativeOn:{click:function(t){return e.clickAdress(t)}}},[i("div",{staticClass:"left"},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",{staticStyle:{float:"right"}},[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),"我要退货退款"===e.typeStr||"我要退款（无需退货）"===e.typeStr?i("el-form-item",{attrs:{label:"退款金额："}},[i("el-input",{attrs:{disabled:e.disableInput,type:"text"},model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}})],1):e._e(),i("el-form-item",{attrs:{label:"售后说明："}},[i("el-input",{attrs:{placeholder:"请输入退款说明",type:"textarea"},model:{value:e.explain,callback:function(t){e.explain=t},expression:"explain"}})],1),i("el-form-item",{attrs:{label:"上传图片："}},[i("img-uploader",{model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),i("span",[e._v("当前仅支持.jpeg .jpg .png格式，大小10M以内")])],1),i("el-form-item",[e.hasAuthEdit?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onConfirm}},[e._v("确定")]):e._e()],1)],1)],1),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],1)},L=[],z=(i("c975"),i("25f0"),i("b85c")),P=i("2119"),R=i("efa0"),N={name:"ApplySale",data:function(){return{editable:!1,files:[],typeStr:"我要退款（无需退货）",options:["我要退款（无需退货）","我要退货退款","我要换货（无需退款）","我要退货（无需退款）"],reasonType:"多拍/错拍/不想要",reasonOptions:["多拍/错拍/不想要","快递无跟踪记录","空包裹/少货"],amount:"",explain:"",quantity:"",id:"",disabled:!1,uploadimgs:0,disableInput:!1,dialogVisiable:!1,getAddress:{},depotReceiver:""}},props:{isEditable:{type:Boolean,default:!0},itemId:{type:String,default:""}},components:{ImgUploader:P["a"],BillInfo:R["a"]},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curApplySaleItem"])),Object(n["c"])("Authority",["currentAuth"])),{},{hasAuthEdit:function(){return this.currentAuth.includes("admin:purchaseApplication.edit")},images:function(){var e,t=[],i=Object(z["a"])(this.files);try{for(i.s();!(e=i.n()).done;){var a=e.value;t.push(a)}}catch(r){i.e(r)}finally{i.f()}return t},type:function(){return this.options.indexOf(this.typeStr).toString()}}),watch:{itemId:function(e,t){this.changeValue(),this.getAddressList()},isEditable:function(e,t){}},mounted:function(){this.amount=this.curApplySaleItem.maxAmountRefundable,this.quantity=this.curApplySaleItem.quantity,this.disableInput=Number(this.curApplySaleItem.minAmountRefundable)===Number(this.curApplySaleItem.maxAmountRefundable),this.getAddressList()},methods:{changeValue:function(){this.amount=this.curApplySaleItem.maxAmountRefundable,this.quantity=this.curApplySaleItem.quantity,this.disableInput=Number(this.curApplySaleItem.minAmountRefundable)===Number(this.curApplySaleItem.maxAmountRefundable)},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};l["a"].get(d["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.depotReceiver=t.receivers[0].id,e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},inputHandle:function(){this.typeStr===this.options[0]?(this.reasonType="多拍/错拍/不想要",this.reasonOptions=["多拍/错拍/不想要","快递无跟踪记录","空包裹/少货"]):this.typeStr===this.options[1]?(this.reasonType="质量问题",this.reasonOptions=["质量问题","颜色/款式/图案与描述不符","商家发错货"]):this.typeStr===this.options[2]?(this.reasonType="质量问题",this.reasonOptions=["质量问题","商家发错货"]):this.typeStr===this.options[3]&&(this.reasonType="质量问题",this.reasonOptions=["质量问题","多拍/错拍/不想要"])},fileSuccess:function(e){console.log(e.response.urls[0])},onConfirm:function(){if(this.typeStr)if(this.reasonType)if(this.amount){var e=/^\d+(?=\.{0,1}\d+$|$)/;e.test(this.amount)?this.isEditable?this.refundsHandle():this.updateRefunds():this.$message.warning("请输入合法数字")}else this.$message.warning("请输入退款金额");else this.$message.warning("请输入售后原因");else this.$message.warning("请输入售后类型")},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},refundsHandle:function(){var e=this,t={orderId:this.curApplySaleItem.orderId,orderItem:{id:this.curApplySaleItem.id,quantity:this.curApplySaleItem.quantity,product:{id:this.curApplySaleItem.productId}},type:this.options.indexOf(this.typeStr).toString(),reason:this.reasonType,amount:this.amount,quantity:this.quantity,depotReceiver:this.depotReceiver,explain:this.explain,images:this.images,methodName:"AddRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,receiverId:this.getAddress.id};l["a"].post(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("申请成功",t),e.$message.success("申请成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)}))},updateRefunds:function(){var e=this,t={amount:this.amount,quantity:this.quantity,depotReceiver:this.depotReceiver,refundsId:this.id,type:this.type,reason:this.reasonType,explain:this.explain,methodName:"UpdateRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,images:this.images,receiverId:this.getAddress.id};l["a"].put(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("修改申请成功",t),e.$message.success("修改申请成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){}))},queryRefunds:function(e){var t=this,i={clientType:"2",methodName:"QueryRefunds",shopId:this.getUser.shop.id,userId:this.getUser.id,id:e};l["a"].get(d["g"].hypermarketMgmt.refunds,i).then((function(e){console.log("修改申请",e),t.typeStr=t.options[e.refunds.type],t.inputHandle(),t.reasonType=e.refunds.reason,t.amount=e.refunds.amount,t.explain=e.refunds.explain,t.id=e.refunds.id;for(var i,a=e.refunds.images,r=a.length,o=0;o<r;o++)t.files.push(i);t.uploadimgs=r})).catch((function(){})).finally((function(){}))},getParams:function(e){this.isEditable||this.queryRefunds(e),"1"!==this.orderInfo.paymentStatus&&"2"!==this.orderInfo.paymentStatus||"0"!==this.orderInfo.shippingStatus?"0"===this.orderInfo.shippingStatus&&"0"===this.orderInfo.paymentStatus?this.options=["我要退货（无需退款）"]:"0"!==this.orderInfo.shippingStatus&&"0"===this.orderInfo.paymentStatus?this.options=["我要退货（无需退款）","我要换货（无需退款）"]:this.options=["我要退款（无需退货）","我要退货退款","我要换货（无需退款）"]:this.options=["我要退款（无需退货）"]},onFinishUpload:function(){this.disabled=!1},onFileUploading:function(){this.disabled=!0},clickAdress:function(){this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e,this.depotReceiver=e.id}},created:function(){}},A=N,B=(i("0630"),Object(T["a"])(A,O,L,!1,null,null,null)),F=B.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"refund-info"},[i("div",{staticClass:"o-refund-info"},[i("div",{staticClass:"info-list"},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退货类型：")]),i("div",{staticClass:"des"},[e._v(e._s(e.typeStr))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款金额：")]),i("div",{staticClass:"des"},[e._v(e._s(e.amount))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款原因：")]),i("div",{staticClass:"des"},[e._v(e._s(e.reason))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款说明：")]),i("div",{staticClass:"des"},[e._v(e._s(e.explain))])]),e.curRefundsInfo&&e.curRefundsInfo.returns&&"3"===e.curRefundsInfo.returns[0].type?i("div",{staticClass:"info-item"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("退货地址：")]),i("div",{staticClass:"des"},[e._v(e._s("1"===e.type?e.curRefundsInfo.returns[0].address:""))])]):e._e(),e.curRefundsInfo&&e.curRefundsInfo.images&&e.curRefundsInfo.images.length?i("div",{staticClass:"refunds-img"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("上传图片：")]),e._l(e.curRefundsInfo.images,(function(e){return i("img",{key:e,staticStyle:{margin:"0px 5px"},attrs:{src:e,width:"80px",height:"80px"}})}))],2):e._e(),i("div",{staticClass:"order-track-content"},[i("ul",{staticClass:"trace-info"},[e._l(e.logs,(function(t,a){return[i("li",{key:a,class:t.status},[i("p",{domProps:{innerHTML:e._s(t.title)}}),i("span",[e._v(e._s(t.time))])])]}))],2)])]),i("div",{staticClass:"bottom-action"},[e.btnLabel?i("span",{staticClass:"half-action",on:{click:e.selectLogistics}},[e._v(e._s(e.getBtnLabel))]):e._e(),e.showModefyBtn?i("span",{staticClass:"half-action",on:{click:e.modefyApply}},[e._v("修改申请")]):e._e(),e.showCancelBtn?i("span",{staticClass:"half-action",on:{click:e.cancelApply}},[e._v("取消申请")]):e._e(),e.showReApply?i("span",{staticClass:"half-action",on:{click:e.reApplyHandle}},[e._v("重新申请")]):e._e(),e.showShipping?i("span",{staticClass:"half-action",on:{click:e.confirmShipping}},[e._v("确认收货")]):e._e()])]),i("el-dialog",{attrs:{visible:e.dialogInfo,"append-to-body":""},on:{"update:visible":function(t){e.dialogInfo=t}}},[i("logistic-info",{attrs:{refundsId:e.id},on:{operationSuccess:e.operationSuccess}})],1),i("el-dialog",{attrs:{visible:e.dialogFollowing,"append-to-body":""},on:{"update:visible":function(t){e.dialogFollowing=t}}},[i("logistics-following",{ref:"following",attrs:{sn:e.shippingSn}})],1)],1)},U=[],j=(i("d81d"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"logistic-info-content"},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"物流公司",prop:"deliveryId"}},[i("el-select",{model:{value:e.form.deliveryId,callback:function(t){e.$set(e.form,"deliveryId",t)},expression:"form.deliveryId"}},e._l(e.deliveryOptions,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"物流单号",prop:"trackingNo"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.trackingNo,callback:function(t){e.$set(e.form,"trackingNo",t)},expression:"form.trackingNo"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"退款说明",prop:"explain"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.form.explain,callback:function(t){e.$set(e.form,"explain",t)},expression:"form.explain"}})],1),i("el-form-item",{attrs:{label:""}},[i("img-uploader",{model:{value:e.form.files,callback:function(t){e.$set(e.form,"files",t)},expression:"form.files"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)}),q=[],V=i("8330"),H={name:"LogisticInfo",data:function(){return{deliveryOptions:[],formOperations:[{label:"提交退货物流信息",name:"onConfirm",type:"primary",auth:["admin:purchaseOrder.edit"]}],rules:{deliveryId:[{required:!0,message:"请选择物流公司",trigger:"blur"}],trackingNo:[{required:!0,message:"请输入物流单号",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^[1][1,2,3,4,5,6,7,8,9][0-9]{9}$/,message:"电话号格式错误",trigger:"blur"}],explain:[{required:!0,message:"请输入退款说明",trigger:"blur"}]},form:this.getDetaultModel()}},props:{refundsId:{type:String,default:""}},components:{ImgUploader:P["a"],BizSaveButton:V["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curApplySaleItem"])),watch:{},created:function(){this.getDeliveries()},methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateRefundsInfo"])),{},{fileSuccess:function(e){console.log(e.response.urls[0])},getDetaultModel:function(){return{deliveryId:"",files:[],trackingNo:"",mobile:"",explain:""}},operate:function(e){this[e]()},onConfirm:function(){var e=this;this.$refs.form.validate((function(t,i){t&&e.submitLogisticInfo()}))},getDeliveries:function(){var e=this,t={methodName:"ListDeliveryCorp",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,type:"0"};l["a"].get(d["g"].hypermarketMgmt.deliveryCorpsByType,t).then((function(t){e.deliveryOptions=t.deliveryCorps}))},getLogisticsInfo:function(){var e=this,t={methodName:"QueryRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.curApplySaleItem.id};l["a"].get(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("退款详情",t),e.updateRefundsInfo(t)})).catch((function(t){e.$message.warning(t.errorMessage)}))},submitLogisticInfo:function(){var e=this,t={orderId:this.curApplySaleItem.orderId,refundsId:this.refundsId,orderItem:{id:this.curApplySaleItem.id,quantity:this.curApplySaleItem.quantity,product:{id:this.curApplySaleItem.productId}},deliveryId:this.form.deliveryId,delivery:this.form.delivery,trackingNo:this.form.trackingNo,mobile:this.form.mobile,explain:this.form.explain,images:this.form.files,methodName:"AddReturns",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id};l["a"].post(d["g"].hypermarketMgmt.returns,t).then((function(t){console.log("填写物流成功",t),e.$message.success("操作成功"),e.$emit("operationSuccess")})).catch((function(t){""!==t.errorMessage&&e.$message.warning(t.errorMessage)}))}})},G=H,W=(i("8506"),Object(T["a"])(G,j,q,!1,null,null,null)),Z=W.exports,Y=i("2c2c"),J={name:"refund-info",props:{itemId:{type:String,default:""}},data:function(){return{orderItemId:"",type:"",amount:"",reason:"",explain:"",shippingSn:"",btnLabel:!1,dialogInfo:!1,dialogFollowing:!1,id:"",showDialog:!1,showModefyBtn:null,showCancelBtn:null,showReApply:null,showShipping:!1,deliveryCorp:"",trackingNo:"",orderId:""}},components:{LogisticInfo:Z,LogisticsFollowing:Y["a"]},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curRefundsInfo"])),{},{typeStr:function(){switch(this.type){case"0":return"我要退款(无需退货)";case"1":return"我要退货退款";case"2":return"我要换货(无需退款)";case"3":return"我要退货(无需退款)";default:return""}},getBtnLabel:function(){return"2"===this.curRefundsInfo.returns[0].type?"填写物流":"3"!==this.curRefundsInfo.returns[0].type&&"4"!==this.curRefundsInfo.returns[0].type&&"5"!==this.curRefundsInfo.returns[0].type||"1"!==this.type&&"2"!==this.type?"":"查看物流"},logs:function(){var e=this,t=[];return this.curRefundsInfo&&this.curRefundsInfo.returns&&this.curRefundsInfo.returns.forEach((function(i,a){var r={};switch(r.time=i.happenDate,i.type){case"0":"0"===e.type?r.title="提交退款(无需退货)申请":"2"===e.type?r.title="提交换货申请":"3"===e.type?r.title="提交退货(无需退款)":r.title="提交退货退款申请";break;case"2":r.title="卖家同意售后申请，等待买家发货给卖家<br/>退货地址："+e.curRefundsInfo.returns[0].address||!1;break;case"3":r.title="买家已退货，等待卖家收货<br/>物流公司："+i.deliveryCorp+"<br/>物流单号："+i.trackingNo;break;case"7":r.title="卖家已收到买家的换货商品，待发出换货商品";break;case"8":r.title="卖家已发货，等待买家收货<br/>物流公司："+i.deliveryCorp+"<br/>物流单号："+i.trackingNo,r.type="8";break;case"1":case"4":r.title="退款失败<br/>拒绝原因："+e.curRefundsInfo.returns[0].details+"<br/>备注："+e.curRefundsInfo.returns[0].remarks;break;case"5":r.title="退款成功";break;case"9":r.title="换货完成";break;default:break}r.status=0===a?"cur":"no-started",t.unshift(r)})),t}}),watch:{itemId:function(e,t){this.getLogisticsInfo()}},created:function(){this.getLogisticsInfo()},methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateRefundsInfo","updateApplySaleItem"])),{},{confirmShipping:function(){var e=this,t={refundsId:this.curRefundsInfo.id,state:"2"};l["a"].put("/admin/invoicing/purchase/refunds/takeOver.jhtml",t).then((function(t){e.$message.success("操作成功")})).catch((function(){})).finally((function(){}))},getOrderInfo:function(){var e=this,t={clientType:"2",methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderId};l["a"].get(d["g"].hypermarketMgmt.queryOrder,t).then((function(t){t.order.orderItems.map((function(t){t.id===e.itemId&&e.updateApplySaleItem(t)}))})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){}))},modefyApply:function(){this.$emit("applySaleHanlder",!1,this.id)},reApplyHandle:function(){this.$emit("applySaleHanlder",!0)},operationSuccess:function(){this.dialogInfo=!1,this.getLogisticsInfo()},cancelApply:function(){var e=this;this.$confirm("请确认是否取消退款申请?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.confirmReceive()}))},confirmReceive:function(){var e=this,t={clientType:"2",methodName:"DeleteRefunds",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.itemId};l["a"].delete(d["g"].hypermarketMgmt.refunds,t).then((function(t){e.$message.success("取消申请成功"),e.$emit("operationSuccess")})).catch((function(){})).finally((function(){}))},getLogisticsInfo:function(){var e=this,t={methodName:"QueryRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.itemId};l["a"].get(d["g"].hypermarketMgmt.refundsByOrderItemId,t).then((function(t){console.log("退款详情",t),e.type=t.refunds.type,e.amount=t.refunds.amount,e.reason=t.refunds.reason,e.explain=t.refunds.explain,e.id=t.refunds.id,e.orderId=t.refunds.orderItem.orderId,e.orderInfo&&e.orderInfo.orderItems?e.orderInfo.orderItems.map((function(t){t.id===e.itemId&&e.updateApplySaleItem(t)})):e.getOrderInfo(),t.refunds.returns.forEach((function(t){if("3"===t.type)return e.deliveryCorp=t.deliveryCorp,e.trackingNo=t.trackingNo,e.shippingSn=t.shippingSn,!1})),"2"!==t.refunds.returns[0].type&&"3"!==t.refunds.returns[0].type&&"4"!==t.refunds.returns[0].type&&"5"!==t.refunds.returns[0].type||"0"===e.type?e.btnLabel=!1:e.btnLabel=!0,e.updateRefundsInfo(t.refunds),"3"===t.refunds.returns[0].type||"5"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1):"4"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1,e.showReApply=!0):"2"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showShipping=!1,e.showCancelBtn=!0):"1"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1,e.showReApply=!0):"8"===t.refunds.returns[0].type?e.showShipping=!0:(e.showModefyBtn=!0,e.showCancelBtn=!0)})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)}))},touchCS:function(){this.$router.push({path:"/custom-service"})},selectLogistics:function(){var e=this;"2"===this.curRefundsInfo.returns[0].type?this.dialogInfo=!0:"3"!==this.curRefundsInfo.returns[0].type&&"4"!==this.curRefundsInfo.returns[0].type&&"5"!==this.curRefundsInfo.returns[0].type||(this.dialogFollowing=!0,this.$nextTick((function(){e.$refs.following.getLogisticsInfo()})))}})},Q=J,X=(i("c2cb"),Object(T["a"])(Q,E,U,!1,null,null,null)),K=X.exports,ee={name:"order-info",data:function(){return{auditState:"1",remarks:"",row:{},curSelectAjectReason:"申报的商品与实际需要采购的商品不符",reasonAjectList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}],iconShop:h.a,defaultImg:p.a,defaultFailImg:u.a,maxlength:6,passValue:"",loading:!1,dialogVisiable:!1,openCancel:!1,open:!1,showPayment:!1,showPayDeposit:!1,showFinalPayment:!1,showCancelOrder:!1,showBalancePay:!0,thirdPay:!0,showRefund:[],showLogistics:!1,showReceive:!1,showLookEvaluate:!1,showEvaluate:!1,showDialog:!1,refundsLabel:[],showCreatInvoice:!1,dialogVisiableLog:!1,dialogApplaySale:!1,dialogApplayRefundInfo:!1,showPassOrder:!1,isEditable:!0,itemId:"",orderItemId:""}},props:{orderId:{type:String,default:""},isPend:{type:Boolean,default:!1},hasSyncOrder:{type:String,default:""},isRalateBill:{type:Boolean,default:!1}},watch:{},components:{BizGrid:s["a"],MyInvoice:g["a"],OrderTrack:$,ApplySale:F,RefundInfo:K},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("RecentActivity",["activity","shop","product"])),Object(n["c"])("Order",["orderConfim","orderInfo","routerFrom","curApplySaleItem"])),Object(n["c"])("Order",["orderInfo","curInvoice"])),Object(n["c"])("Authority",["currentAuth"])),{},{hasAuthEdit:function(){return this.currentAuth.includes("admin:purchaseOrder.edit")},hasAuthExamine:function(){return this.currentAuth.includes("admin:purchaseOrder.examine")},getOffsetAmount:function(){var e=this.orderInfo.offsetAmount;return e?Number(e)>=0?"+ ￥"+e:"- ￥"+e.substr(1,e.length-1):""},getAmount:function(){var e,t=this.orderInfo.orderItems,i=0;t&&(e=t.length);for(var a=0;a<e;a++)i+=t[a].price*t[a].quantity;return i.toFixed(2)},getOrderPaymentState:function(){if("1"===this.orderInfo.afterSaleStatus)return"退货退款中";switch(this.orderInfo.type){case"1":return"待付款";case"2":return"待收货";case"3":return"已完成";case"5":return"4"===this.orderInfo.orderType||"5"===this.orderInfo.orderType||"6"===this.orderInfo.orderType||"7"===this.orderInfo.orderType||"8"===this.orderInfo.orderType?"商家已确认":"待发货";case"6":return"已完成";case"7":return"已关闭";case"8":return"订单过期";case"9":return"退款退货中";case"10":return"退款退货完成";case"11":return"待商家确认";default:return""}},getDownPayment:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.downPayment)+"%";return t},getInitPay:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.product.price),i=parseFloat(e.downPayment)*t*.01;return i.toFixed(2)},getMonthPaidNum:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.product.price),i=parseFloat(e.downPayment)*t*.01,a=12*parseInt(e.year),r=t-i,o=parseFloat(parseFloat(e.rate)/12),s=Math.pow(1+o,a)-1;if(0===s)return(0).toFixed(2);var n=r*o*Math.pow(1+o,a)/(Math.pow(1+o,a)-1);return n.toFixed(2)}}),methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateOrderInfo","updateOrderId","updateApplySaleItem","updateClickItemSelect"])),{},{imgError:function(e){this.$refs.img&&this.$refs.img[e]&&(this.$refs.img[e].src=this.defaultFailImg)},toPass:function(e,t){this.remarks="",this.row=e,this.showPassOrder=!0},statusChange:function(e,t){var i=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.loading=!0;var a={shopId:window.top.SHOP_ID||"",id:e.id,actionType:t,details:"2"===t?i.curSelectAjectReason:"",remarks:i.remarks};l["a"].post("/admin/purchaseOrderManage/audit.jhtml",a).then((function(e){i.$message.success("操作成功！"),i.showPassOrder=!1,i.loading=!1,i.$emit("closeTabByAudit")})).catch((function(e){i.loading=!1,e.errorMessage&&i.$message.warning(e.errorMessage)})).finally((function(){}))}))},confirmOrder:function(e){var t=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={clientType:"2",methodName:"UpdateOrder",shopId:t.getUser().shop.id,userId:t.getUser().id,orderId:e.id,type:"1"};l["a"].put(d["g"].hypermarketMgmt.purchaseOrder,i).then((function(e){t.$message.success("操作成功"),t.getList()})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){}))}))},applySaleHanlder:function(e,t){var i=this;this.isEditable=e,this.dialogApplaySale=!0,this.$nextTick((function(){i.$refs.applySale.getParams(t)}))},operationSuccess:function(){this.dialogApplaySale=!1,this.dialogApplayRefundInfo=!1,this.getOrderInfo()},goShop:function(){},handleCartClick:function(e){this.$router.push({path:"/cart"})},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},selectInvoice:function(){var e=this;this.orderInfo.invoiceTitle||"1"!==this.orderInfo.type?(this.dialogVisiable=!0,this.$nextTick((function(){e.$refs.invoice.getInvoiceInfo()}))):this.$message.warning("本订单暂无发票信息，付款后支持补开发票")},hideCancel:function(){this.openCancel=!1},onCancel:function(){this.open=!1},successHandle:function(e){this.getOrderInfo()},onOrderTrack:function(e){var t=this;this.dialogVisiableLog=!0,this.$nextTick((function(){t.$refs.track.getLogs(e)}))},onConsultation:function(){this.$router.push({path:"/custom-service"})},onPay:function(){this.open=!0},onCancelPay:function(){this.openCancel=!0},onConfirm:function(e){var t=this,i={clientType:"2",methodName:"UpdateOrder",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,type:0,content:e};l["a"].put(d["g"].order.cancelOrder,i).then((function(e){t.routerFrom?t.$router.replace({path:t.routerFrom}):(t.openCancel=!1,t.$router.go(-1),t.getOrderInfo())})).catch((function(){})).finally((function(){}))},getOrderInfo:function(){var e=this;this.updateOrderId(this.orderId),this.open=!1;var t={clientType:"2",methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id};l["a"].get(d["g"].hypermarketMgmt.queryOrder,t).then((function(t){console.log("订单信息1",t),e.updateOrderInfo(t.order),"1"===e.orderInfo.orderType||"13"===e.orderInfo.orderType?e.showBalancePay=!1:e.showBalancePay=!0,parseFloat(e.orderInfo.amountPayable)?e.thirdPay=!0:e.thirdPay=!1,("2"===e.orderInfo.paymentStatus||"3"===e.orderInfo.paymentStatus)&&parseFloat(e.orderInfo.amount)>0&&!e.orderInfo.invoiceTitle?e.showCreatInvoice=!0:e.showCreatInvoice=!1,e.showRefund=[];var i,a=t.order,r=a.orderItems,o=r.length;for(i=0;i<o;i++)e.showRefund.push(!1),e.refundsLabel.push("");for(a.shippings.length>0&&"5"!==a.state&&"6"!==a.state&&"7"!==a.state?e.showLogistics=!0:e.showLogistics=!1,i=0;i<o;i++)("0"!==a.method&&"2"!==a.method||"1"!==a.type||"0"!==a.orderType&&"2"!==a.orderType&&"9"!==a.orderType&&"10"!==a.orderType&&"3"!==a.orderType&&"6"!==a.orderType&&"7"!==a.orderType&&"8"!==a.orderType)&&("0"!==a.method&&""!==a.method||"1"!==a.orderType&&"13"!==a.orderType&&"17"!==a.orderType||"1"!==a.type)&&("11"!==a.type&&"5"!==a.type||"4"!==a.orderType&&"5"!==a.orderType)?e.showCancelOrder=!1:e.showCancelOrder=!0,"0"!==a.method&&""!==a.method||"1"!==a.orderType&&"13"!==a.orderType&&"17"!==a.orderType||"1"!==a.type?e.showPayment=!1:e.showPayment=!0,"0"!==a.method||"0"!==a.orderType&&"2"!==a.orderType&&"4"!==a.orderType&&"5"!==a.orderType&&"9"!==a.orderType&&"10"!==a.orderType||("1"===a.type?(e.showPayment=!1,e.showPayDeposit=!1,e.showFinalPayment=!1,"1"!==a.isSubscription||e.activity.activityId?e.showPayment=!0:0===Number(a.amountPaid)?e.showPayDeposit=!0:(Number(a.amountPayable)>0&&(e.showFinalPayment=!0,e.showCancelOrder=!1),parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"))):"2"===a.type?(e.showReceive=!0,parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后")):"3"===a.type?(e.showEvaluate=!0,e.showCancelOrder=!1,e.showReceive=!1,parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后")):"5"===a.type?(parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"),e.showFinalPayment=!1):"6"===a.type&&parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后")),"3"!==a.type||"0"!==a.orderType&&"1"!==a.orderType&&"2"!==a.orderType&&"9"!==a.orderType&&"10"!==a.orderType&&"3"!==a.orderType&&"4"!==a.orderType&&"5"!==a.orderType&&"6"!==a.orderType&&"7"!==a.orderType&&"8"!==a.orderType&&"13"!==a.orderType&&"17"!==a.orderType||(e.showEvaluate=!0,e.showCancelOrder=!1),"1"===a.isReviewed?e.showLookEvaluate=!0:e.showLookEvaluate=!1,"1"!==e.orderInfo.orderType&&"13"!==e.orderInfo.orderType&&"17"!==e.orderInfo.orderType&&("6"===e.orderInfo.type?(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"):"0"===r[i].refundsState||"2"===r[i].refundsState||"3"===r[i].refundsState?(e.showRefund[i]=!0,e.refundsLabel[i]="退款中"):"5"===r[i].refundsState?(e.showRefund[i]=!0,e.refundsLabel[i]="退款成功"):"6"===r[i].refundsState?(parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0),e.refundsLabel[i]="申请售后"):"1"!==r[i].refundsState&&"4"!==r[i].refundsState||(e.showRefund[i]=!0,e.refundsLabel[i]="退款失败"))})).catch((function(){})).finally((function(){}))},queryRefunds:function(){this.$router.push({path:this.$route.path+"/myOrder"})},onRefund:function(e){var t=this;this.updateApplySaleItem(e),console.log("申请退款的信息",e),e.refundsState&&"6"!==e.refundsState?(this.itemId=this.curApplySaleItem.id,this.dialogApplayRefundInfo=!0,this.$nextTick((function(){t.$refs.refundInfo.getLogisticsInfo()}))):(this.orderItemId=e.id,this.dialogApplaySale=!0,this.isEditable=!0,this.$nextTick((function(){t.$refs.applySale.getParams()})))},onLookLogistics:function(e){this.$emit("closeTabByLogistics",e)},onConfirmReceive:function(){this.showDialog=!0},onEvaluate:function(){this.$router.push({path:"/my-evaluate/"+this.orderInfo.id+"/true"})},onLookEvaluate:function(e,t){console.log(1213),this.$emit("closeTabByEvaluate",e,t)},onReview:function(e,t){this.$emit("closeTabByEvaluate",e,t)},onClickProduct:function(e){},confirmReceive:function(){var e=this,t={clientType:"2",methodName:"UpdateOrder",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,type:"1"};l["a"].put(d["g"].order.cancelOrder,t).then((function(t){console.log("确认收货",t),e.getOrderInfo()})).catch((function(){})).finally((function(){}))},onCreateInvoice:function(){this.updateClickItemSelect(!0),this.$router.push({path:this.$route.fullPath+"/invoiceInfo"})}}),created:function(){}},te=ee,ie=(i("2fd9"),Object(T["a"])(te,a,r,!1,null,null,null));t["a"]=ie.exports},2863:function(e,t,i){"use strict";var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={query:function(e,t,i){o.a.get(s["g"].customerService.CSGroup,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryExcutiveList:function(e,t,i){o.a.get(s["g"].customerService.CSList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},add:function(e,t,i){o.a.post(s["g"].customerService.CSGroup,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},update:function(e,t,i){o.a.put(s["g"].customerService.CSGroup,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))}}},"28d7":function(e,t,i){},2902:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"news-mgmt"},[i("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tableData:e.tableData,loading:e.loading,pagination:e.pagination},on:{operate:e.operate,"filter-data-change":e.filterDataChange,"selection-change":e.handleSelectionChange,"row-click":e.rowClick,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[i("el-table-column",{attrs:{prop:"title",label:"消息标题","min-width":"170"}}),i("el-table-column",{attrs:{prop:"content",label:"消息内容","min-width":"170"}}),"car"===e.category||"service"===e.category?i("el-table-column",{attrs:{prop:"carPlateNumber",label:"车辆","min-width":"80"}}):e._e(),"car"===e.category||"service"===e.category?i("el-table-column",{attrs:{label:"车主信息","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.car?i("div",{},[i("div",{staticClass:"biz-customcol"},[e._v(e._s(t.row.car.member?t.row.car.member.name:""))]),i("div",{staticClass:"biz-customcol"},[e._v(e._s(t.row.car.member?t.row.car.member.mobile:""))])]):e._e()}}],null,!0)}):e._e(),"car"===e.category?i("el-table-column",{attrs:{prop:"address",label:"地点","min-width":"170"}}):e._e(),i("el-table-column",{attrs:{prop:"typeName",label:"消息类别","min-width":"95"}}),i("el-table-column",{attrs:{prop:"sendTime",label:"日期","min-width":"90"}}),"pendingRemind"===e.category?i("el-table-column",{attrs:{prop:"verifyState",label:"状态","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e._v(e._s("0"===t.row.verifyState?"未处理":"已处理"))])}}],null,!1,2690375501)}):e._e(),i("el-table-column",{attrs:{prop:"date",label:"操作","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},["订单确认"===t.row.typeName?i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.orderConfirm(t.row)}}},[e._v("确认")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.closeOrder(t.row)}}},[e._v("关闭")])],1):i("div",{staticClass:"biz-customcol"},["pendingRemind"===e.category&&"0"===t.row.verifyState?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.handler(t.row)}}},[e._v("处理")]):e._e(),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.deleteHandler(t.row)}}},[e._v("删除")])],1)])}}])})],1),i("biz-popup-tabs",{attrs:{open:e.open},on:{close:function(t){e.open=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"详细信息",name:"info"}},[i("NewsMgmtInfo",{attrs:{itemId:e.itemId}})],1)],1),e.potentialCustomerId.id?i("right-popup",{attrs:{open:e.openPotentialCustomer,itemId:e.potentialCustomerId,defaultTab:e.defaultTab},on:{close:function(t){e.openPotentialCustomer=!1},operationSuccess:e.refresh}}):e._e(),i("biz-popup-tabs",{attrs:{open:e.openWork},on:{close:function(t){e.openWork=!1}},model:{value:e.workName,callback:function(t){e.workName=t},expression:"workName"}},[i("el-tab-pane",{directives:[{name:"show",rawName:"v-show",value:e.openWork,expression:"openWork"}],attrs:{label:"工单信息",name:"work"},on:{created:e.refresh}},[i("base-info",{ref:"baseInfo",attrs:{itemId:e.currentRowId}})],1)],1),"shop"===e.getUser().roleLevel?i("biz-popup-tabs",{attrs:{open:e.openOrder},on:{close:function(t){e.openOrder=!1}},model:{value:e.orderName,callback:function(t){e.orderName=t},expression:"orderName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[i("order-base-info",{ref:"orderBaseInfo",attrs:{itemId:e.orderId,activeNames:e.activeNames},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"商品信息",name:"productinfo"},on:{operationSuccess:e.refresh}},[i("product-info",{ref:"productinfo",attrs:{itemId:e.orderId},on:{setOrderItems:e.setOrderItems}})],1),i("el-tab-pane",{attrs:{label:"订单进度",name:"loginfo"}},[i("order-logs",{ref:"loginfo",attrs:{itemId:e.orderId,paymentMethodName:e.paymentMethodName},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"售后进度",name:"afterprocess"}},[i("after-process",{ref:"afterprocess",attrs:{itemId:e.orderId},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"服务记录",name:"orderhistory"}},[i("order-history",{ref:"orderhistory",attrs:{itemId:e.orderId}})],1),"无"!==e.invoiceState?i("el-tab-pane",{attrs:{label:"发票",name:"invoice"}},[i("invoice-info",{ref:"invoice",attrs:{itemId:e.orderId,open:e.openOrder}})],1):e._e()],1):e._e(),i("biz-popup-tabs",{attrs:{open:e.openReception},on:{close:function(t){e.openReception=!1}},model:{value:e.receptionName,callback:function(t){e.receptionName=t},expression:"receptionName"}},[e.receptionId.id?i("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[i("reception-base-info",{attrs:{itemId:e.receptionId}})],1):e._e()],1),i("biz-popup-tabs",{attrs:{open:e.openMerchants},on:{close:function(t){e.openMerchants=!1}},model:{value:e.merchantsName,callback:function(t){e.merchantsName=t},expression:"merchantsName"}},[i("el-tab-pane",{attrs:{label:"申请单基本信息",name:"first"}},[i("merchants-mgmt-base-info",{ref:"baseInfo",attrs:{id:e.currentId,open:e.openMerchants,email:e.currentRowEmail},on:{created:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"个人资质信息",name:"second"}},[i("merchants-mgmt-psn-qua",{attrs:{id:e.currentId,open:e.openMerchants,email:e.currentRowEmail}})],1),i("el-tab-pane",{attrs:{label:"企业资质信息",name:"third"}},[i("merchants-mgmt-com-qua",{attrs:{id:e.currentId,open:e.openMerchants,email:e.currentRowEmail}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openCard},on:{close:function(t){e.openCard=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"通讯卡信息",name:"siminfo"}},[i("card-base-info",{attrs:{itemId:e.cardId},on:{update:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"充值记录",name:"second"}},[i("recharge-records",{ref:"recharge",attrs:{itemId:e.cardId},on:{update:e.refresh}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openMember},on:{close:function(t){e.openMember=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[i("membership-mgmt-base-info",{attrs:{itemId:e.memberId},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"车辆信息",name:"carInfo"}},[i("membership-mgmt-vehicle-info",{attrs:{itemId:e.memberId},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"实名认证",name:"certificationInfo"}},[i("membership-certification",{attrs:{itemId:e.memberId},on:{operationSuccess:e.refresh}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openPurchase},on:{close:function(t){e.openPurchase=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[i("purchase-apply-info",{attrs:{itemId:e.purchaseId,isEdit:e.isEdit,isPend:e.isPend},on:{operationSuccess:e.operationSuccess}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openPurchaseReturn},on:{close:function(t){e.openPurchaseReturn=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[i("purchase-return-apply-base-info",{attrs:{itemId:e.purchaseReturnId,isEdit:e.isEdit},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"商品信息",name:"productinfo"}},[i("purchase-return-apply-product-info",{attrs:{itemId:e.purchaseReturnId,isEdit:e.isEdit},on:{operationSuccess:e.refresh}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openVehicle},on:{close:function(t){e.openVehicle=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"certificationInfo"}},[i("vehicle-base-info",{ref:"vehicleInfo",attrs:{itemId:e.vehicleId},on:{operationSuccess:e.refresh}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openSaleApply},on:{close:function(t){e.openSaleApply=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"申请单信息",name:"saleInfo"}},[i("sale-apply-info",{ref:"saleInfo",attrs:{itemId:e.saleApplyId,isPend:e.isPend},on:{operationSuccess:e.refresh}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openOrderSupplier},on:{close:function(t){e.openOrderSupplier=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"orderSupplierInfo"}},[i("order-supplier-info",{ref:"orderSupplierInfo",attrs:{itemId:e.orderSupplierId,handler:e.handlerName,activeNames:e.activeNames,isPend:e.isPend},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"商品信息",name:"orderSupplierProductinfo"}},[i("order-supplier-product-info",{ref:"orderSupplierProductinfo",attrs:{itemId:e.orderSupplierId,isEdit:e.isEdit},on:{operationSuccess:e.refresh}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openOrderSupplierAp},on:{close:function(t){e.openOrderSupplierAp=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"售后信息",name:"orderSupplierInfoAp"}},[i("order-supplier-after-process",{ref:"orderSupplierInfoAp",attrs:{itemId:e.orderSupplierId},on:{operationSuccess:e.refresh}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openOrderStore},on:{close:function(t){e.openOrderStore=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"orderStoreInfo"}},[i("order-store-info",{ref:"orderStoreInfo",attrs:{orderId:e.orderStoreId,isPend:e.isPend},on:{operationSuccess:e.refresh,closeTabByLogistics:e.closeTabByLogistics,closeTabByAudit:e.closeTabByAudit}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openOrderSale},on:{close:function(t){e.openOrderSale=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"orderSaleInfo"}},[i("order-sale-info",{ref:"orderSaleInfo",attrs:{itemId:e.orderSaleId,handler:e.handlerName,activeNames:e.activeNames},on:{operationSuccess:e.refresh}})],1),i("el-tab-pane",{attrs:{label:"商品信息",name:"OrderSaleProductInfo"}},[i("order-sale-product-info",{ref:"OrderSaleProductInfo",attrs:{itemId:e.orderSaleId,handler:e.handlerName},on:{operationSuccess:e.refresh}})],1),e.orderId?i("el-tab-pane",{attrs:{label:"发票",name:"saleInvoice"}},[i("sale-invoice-info",{ref:"saleInvoice",attrs:{itemId:e.orderId,open:e.openOrderSale},on:{operationSuccess:e.operationSuccess}})],1):e._e()],1),i("biz-popup-tabs",{attrs:{open:e.openOrderSaleAp},on:{close:function(t){e.openOrderSaleAp=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"售后信息",name:"orderSaleInfoAp"}},[i("order-sale-after-process",{ref:"orderSaleInfoAp",attrs:{itemId:e.orderSaleId},on:{operationSuccess:e.refresh}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openOrderAgency},on:{close:function(t){e.openOrderAgency=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"orderAgencyInfo"}},[i("order-agency-info",{ref:"orderAgencyInfo",attrs:{isPend:e.isPend,orderId:e.orderAgencyId},on:{operationSuccess:e.refresh,closeTabByLogistics:e.closeTabByLogistics,closeTabByAudit:e.closeTabByAudit}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openLogistics},on:{close:function(t){e.openLogistics=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"物流追踪",name:"loginfo"}},[i("logistics-following",{ref:"logistics",attrs:{orderId:e.orderId,sn:e.sn}})],1)],1),i("biz-popup-tabs",{attrs:{open:e.openCarAppeal},on:{close:function(t){e.openCarAppeal=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"carinfo"}},[i("accused-info",{attrs:{itemId:e.accusedId},on:{operationSuccess:e.operationSuccess}})],1),i("el-tab-pane",{attrs:{label:"被诉人信息",name:"complaintinfo"}},[i("complaint-base-info",{attrs:{itemId:e.accusedId}})],1)],1)],1)},r=[],o=(i("99af"),i("4160"),i("d81d"),i("a9e3"),i("159b"),i("5530")),s=i("7132"),n=i("04d3"),l=i("e685"),d=i("e42c"),c=i("b655"),p=i("2abe"),m=i("103b"),u=i("7895"),f=i("c954"),h=i("bc02"),g=i("1d5f"),b=i("b3368"),v=i("cfe9"),y=i("3077"),_=i("ba69"),I=i("440d"),w=i("1367"),x=i("2671"),S=i("aedc"),C=i("3f4e"),M=i("e0d7"),k=i("bea5"),T=i("ff9d"),D=i("a9f4"),$=i("d819"),O=i("40ab"),L=i("77b6"),z=i("447a"),P=i("ae8d"),R=i("9b3f"),N=i("276c"),A=i("b06a"),B=i("5801"),F=i("9462"),E=i("5eb4"),U=i("075d"),j=i("4382"),q=i("03e1"),V=i("2d15"),H=i("2f62"),G={name:"NewsMgmt",data:function(){return{row:{},tabName:"info",workName:"work",orderName:"info",receptionName:"first",merchantsName:"first",itemId:"",handlerName:"",invoiceState:"",orderId:"",currentRowId:{},cardId:{id:""},memberId:{id:""},currentId:"",accusedId:"1",purchaseId:"",purchaseReturnId:"",currentRowEmail:"",receptionId:{id:""},potentialCustomerId:{id:""},vehicleId:{id:""},sn:"",defaultTab:"0",category:"car",subCategory:"",paymentMethodName:"",saleApplyId:"",storeApplyId:"",openDepotInId:"",openDepotOutId:"",orderSupplierId:"",orderStoreId:"",orderSaleId:"",orderAgencyId:"",loading:!1,open:!1,openOrder:!1,openWork:!1,openReception:!1,openPotentialCustomer:!1,openLogistics:!1,openMerchants:!1,openCard:!1,openMember:!1,showWork:!1,isEdit:!0,isPend:!1,selections:[],openPurchase:!1,openPurchaseReturn:!1,openVehicle:!1,openSaleApply:!1,openStoreApply:!1,openDepotIn:!1,openDepotOut:!1,openOrderSupplier:!1,openOrderSupplierAp:!1,openOrderStore:!1,openOrderSale:!1,openOrderSaleAp:!1,openOrderAgency:!1,openSaleInvoice:!1,openCarAppeal:!1,activeNames:["2"],operations:[{disabled:!0,label:"删除",name:"delete",type:""},{label:"刷新",name:"refresh",type:""}],filters:[{type:"select",label:"消息类别",name:"type",value:"",options:[]},{type:"daterange",label:"日期",name:"publishDate",value:[]},{type:"select",label:"状态",name:"state",value:"1",class:"hidden",options:[{label:"全部",value:""},{label:"未处理",value:"1"},{label:"已处理",value:"2"}]},{type:"input",label:"",placeholder:"请输入关键字",name:"searchValue",value:""}],tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizPopupTabs:s["a"],BizFlexTable:n["c"],NewsMgmtInfo:c["a"],RightPopup:p["a"],BaseInfo:m["a"],OrderBaseInfo:u["a"],ProductInfo:f["a"],OrderLogs:h["a"],AfterProcess:g["a"],InvoiceInfo:v["a"],OrderHistory:b["a"],ReceptionBaseInfo:_["a"],MerchantsMgmtBaseInfo:I["a"],MerchantsMgmtPsnQua:w["a"],MerchantsMgmtComQua:x["a"],CardBaseInfo:S["a"],RechargeRecords:C["a"],MembershipMgmtBaseInfo:M["a"],MembershipMgmtVehicleInfo:k["a"],MembershipCertification:T["a"],PurchaseApplyInfo:D["a"],PurchaseReturnApplyBaseInfo:$["a"],PurchaseReturnApplyProductInfo:O["a"],VehicleBaseInfo:L["a"],SaleApplyInfo:U["a"],OrderSupplierInfo:z["a"],OrderSupplierProductInfo:P["a"],OrderStoreInfo:N["a"],OrderSaleInfo:A["a"],OrderSaleProductInfo:B["a"],OrderAgencyInfo:E["a"],OrderSupplierAfterProcess:R["a"],OrderSaleAfterProcess:F["a"],LogisticsFollowing:j["a"],SaleInvoiceInfo:y["a"],AccusedInfo:q["a"],ComplaintBaseInfo:V["a"]},created:function(){this.category=this.$route.params.category||this.$route.query.category||"",this.subCategory=this.$route.params.subCategory||this.$route.query.subCategory||"",this.state=this.$route.query.state||"",this.state&&(this.filters[2].class="show"),this.filters[0].value=this.$route.query.type||"",this.getList(),this.listMsgType()},mounted:function(){},watch:{$route:function(e,t){Object.assign(this.$data,this.$options.data()),this.category=this.$route.params.category||this.$route.query.category||"",this.subCategory=this.$route.params.subCategory||this.$route.query.subCategory||"",this.state=this.$route.query.state||"",this.state&&(this.filters[2].class="show"),this.filters[0].value=this.$route.query.type||"",this.getList(),this.listMsgType()}},methods:Object(o["a"])(Object(o["a"])({},Object(H["c"])(["getUser"])),{},{operate:function(e){this[e]()},setOrderItems:function(e){this.orderName="info",this.$refs.orderBaseInfo.setOrderItems(e)},refresh:function(){this.getList(),this.verify(this.row)},operationSuccess:function(){this.openPurchase=!1,this.openOrderSale=!1,this.getList()},rowClick:function(e,t,i){"pendingRemind"!==this.category&&(this.open=!0),this.itemId=String(e.messageId)},getList:function(){var e=this;this.loading=!0;var t={id:this.$route.query.id||"",searchValue:this.filters[3].value,category:this.category,state:this.filters[2].value,subCategory:this.subCategory,type:this.filters[0].value,beginDate:this.filters[1].value[0],endDate:this.filters[1].value[1],pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};l["a"].listMsg(t,(function(t){e.loading=!1,e.tableData=t.messages,e.pagination.total=Number(t.total)}),(function(e){console.log(e)}))},getPendList:function(){var e=this;this.loading=!0;var t={id:"",searchValue:this.filters[3].value,category:this.category,state:this.filters[2].value,subCategory:this.subCategory,type:this.filters[0].value,beginDate:this.filters[1].value[0],endDate:this.filters[1].value[1],pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};l["a"].listMsg(t,(function(t){e.loading=!1,e.tableData=t.messages,e.pagination.total=Number(t.total)}),(function(e){console.log(e)}))},listMsgType:function(){var e=this;this.loading=!0;var t={category:this.category,subCategory:this.subCategory};l["a"].listMsgType(t,(function(t){e.loading=!1,e.filters[0].options=[{label:"全部",value:""}].concat(t.content.map((function(e){return{label:e.label,value:e.value}})))}),(function(e){console.log(e)}))},deleteHandler:function(e){var t=this,i=[];i.push(e.messageId),this.$confirm("确认要删除这条信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,l["a"].deleteMsg({ids:i},(function(e){t.$message.success("删除成功"),t.loading=!1,t.getList()}),(function(e){console.log(e),t.loading=!1}))}),(function(){t.loading=!1}))},delete:function(){var e=this,t=[];this.selections.forEach((function(e){t.push(e.messageId)})),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,l["a"].deleteMsg({ids:t},(function(t){e.$message.success("删除成功"),e.loading=!1,e.getList()}),(function(t){console.log(t),e.loading=!1}))}),(function(){e.loading=!1}))},closeTabByLogistics:function(e){var t=this;this.tabName="loginfo",this.sn=e,this.openLogistics=!0,this.openOrderStore=!1,this.openOrderAgency=!1,this.$nextTick((function(){t.$refs.logistics.getLogisticsInfo()}))},closeTabByAudit:function(){this.openOrderStore=!1,this.openOrderAgency=!1},handler:function(e){var t=this;console.log(e),this.row=e;var i=e.msgType;switch(i){case"orderExecute":this.orderId=e.order.id,this.paymentMethodName=e.order.paymentMethodName,this.openOrder=!0,this.invoiceState=e.order.invoiceState,this.verify(e);break;case"rescue":this.orderId=e.order.id,this.paymentMethodName=e.order.paymentMethodName,this.orderName="loginfo",this.openOrder=!0,this.invoiceState=e.order.invoiceState;break;case"orderRefund":this.orderId=e.order.id,this.paymentMethodName=e.order.paymentMethodName,this.orderName="afterprocess",this.openOrder=!0,this.invoiceState=e.order.invoiceState;break;case"invoice":this.orderId=e.order.id,this.paymentMethodName=e.order.paymentMethodName,this.invoiceState=e.order.invoiceState,"purchaseOrder"===e.order.dType?(window.top.dType="purchaseOrder",this.tabName="saleInvoice",this.openOrderSale=!0):(this.orderName="invoice",this.openOrder=!0),this.verify(e);break;case"delivery":this.orderId=e.templateId,this.openOrder=!0;break;case"reception":this.receptionId={id:e.templateId},this.openReception=!0;break;case"potentialResult":this.potentialCustomerId={id:e.templateId},this.defaultTab="3",this.openPotentialCustomer=!0,this.verify(e);break;case"potential":this.potentialCustomerId={id:e.templateId},this.defaultTab="3",this.openPotentialCustomer=!0,this.verify(e);break;case"reply":this.$router.push({path:"/service/service-mgmt/online-response"});break;case"workOrder":this.currentRowId={id:e.templateId},this.workName="work",this.openWork=!0;break;case"investmentApply":this.currentId=e.templateId,this.currentRowEmail=e.email,this.openMerchants=!0;break;case"investmentAptitude":this.currentId=e.templateId,this.currentRowEmail=e.email,this.openMerchants=!0;break;case"addSim":this.tabName="siminfo",this.cardId={id:e.templateId},this.openCard=!0,this.verify(e);break;case"member":this.memberId={id:e.templateId},this.openMember=!0;break;case"idcardcertification":this.tabName="certificationInfo",this.memberId={id:e.templateId},this.openMember=!0;break;case"importbooklet":window.open(e.value);break;case"purchase":"0"===e.purchaseApply.ownerType?(this.tabName="info",this.purchaseId=e.templateId,this.openPurchase=!0,this.isPend=!0):(this.tabName="saleInfo",this.saleApplyId=e.templateId,this.openSaleApply=!0,this.isPend=!0),"PurchaseApplyPassAgent"!==e.value&&"PurchaseApplyRejectAgent"!==e.value&&"PurchaseOrderShippingAgent"!==e.value&&"PurchaseApplyPassPurchase"!==e.value&&"PurchaseApplyRejectPurchase"!==e.value||this.verify(e);break;case"purchaseReturn":this.tabName="info",this.purchaseReturnId=e.templateId,this.openPurchaseReturn=!0,this.isPend=!0;break;case"vehicleLicense":this.tabName="certificationInfo",this.vehicleId={id:e.carId},this.openVehicle=!0;break;case"purchaseOrder":console.log(e.purchaseOrder.state),window.dType="purchaseOrder",("3"===e.purchaseOrder.state&&"0"===e.purchaseOrder.shippingWay||"2"===e.purchaseOrder.state&&"1"===e.purchaseOrder.shippingWay)&&(this.activeNames=["5"],this.handlerName="shipping"),"PurchaseOrderRefundsDisagreeAgent"!==e.value&&"PurchaseOrderRefundsAgreeAgent"!==e.value&&"PurchaseOrderRefundsReturnsAgent"!==e.value&&"PurchaseOrderShippingAgent"!==e.value&&"PurchaseOrderAuditAgent"!==e.value&&"PurchaseOrderPassAgent"!==e.value&&"PurchaseOrderRejectAgent"!==e.value&&"PurchaseOrderCloseAgent"!==e.value||(this.tabName="orderAgencyInfo",this.orderAgencyId=e.purchaseOrder.id,this.isPend=!0,this.openOrderAgency=!0,this.$nextTick((function(){t.$refs.orderAgencyInfo.getOrderInfo()})),this.verify(e)),"PurchaseOrderRefundsDisagreePurchase"!==e.value&&"PurchaseOrderRefundsAgreePurchase"!==e.value&&"PurchaseOrderRefundsReturnsPurchase"!==e.value&&"PurchaseOrderShippingPurchase"!==e.value&&"PurchaseOrderAuditPurchase"!==e.value&&"PurchaseOrderPassPurchase"!==e.value&&"PurchaseOrderRejectPurchase"!==e.value&&"PurchaseOrderClosePurchase"!==e.value||(this.tabName="orderStoreInfo",this.orderStoreId=e.purchaseOrder.id,this.openOrderStore=!0,this.isPend=!0,this.$nextTick((function(){t.$refs.orderStoreInfo.getOrderInfo()})),this.verify(e)),"PurchaseOrderRefundsAgentApply"===e.value&&(this.tabName="orderSaleInfoAp",this.orderSaleId=e.purchaseOrder.id,this.openOrderSaleAp=!0,this.$nextTick((function(){t.$refs.orderSaleInfoAp.initData()})),this.verify(e)),"PurchaseOrderRefundsPurchaseApply"===e.value&&(this.tabName="orderSupplierInfoAp",this.orderSupplierId=e.purchaseOrder.id,this.openOrderSupplierAp=!0,this.$nextTick((function(){t.$refs.orderSupplierInfoAp.initData()})),this.verify(e)),"PurchaseOrderCreatePurchase"!==e.value&&"PurchaseOrderPrepareShippingPurchase"!==e.value||(this.tabName="orderSupplierInfo",this.orderSupplierId=e.purchaseOrder.id,this.openOrderSupplier=!0,this.isPend=!0,this.$nextTick((function(){t.$refs.orderSupplierInfo.init()})),this.verify(e)),"PurchaseOrderCreateAgent"!==e.value&&"PurchaseOrderPrepareShippingAgent"!==e.value||(this.tabName="orderSaleInfo",this.orderSaleId=e.purchaseOrder.id,this.openOrderSale=!0,this.$nextTick((function(){t.$refs.orderSaleInfo.init()})),this.verify(e));break;case"carAppeal":this.accusedId=e.templateId,this.tabName="carinfo",this.openCarAppeal=!0,this.verify(e);break;default:this.messagePendingDeal(e)}},handleSelectionChange:function(e){this.operations[0].disabled=!0,e.length>0&&(this.operations[0].disabled=!1),this.selections=e},filterDataChange:function(e){this.pagination.currentPage=1,this.getPendList()},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},orderConfirm:function(e){var t=this;d["a"].confirmOrder({orderId:e.order.id,shopId:window.top.SHOP_ID||""},(function(e){t.$message.success("操作成功"),t.loading=!1,t.getList()}),(function(e){console.log(e),t.$message.warning(e.errorMessage),t.loading=!1}))},closeOrder:function(e){var t=this;d["a"].closeOrder({orderId:e.order.id,shopId:window.top.SHOP_ID||""},(function(e){t.loading=!1,t.$message.success("操作成功"),t.getList()}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},verify:function(e){var t=this,i=[];i.push(e.messageId),this.loading=!0,l["a"].messagePendingDeal({ids:i},(function(e){t.loading=!1,t.getList()}),(function(e){console.log(e),t.loading=!1}))},messagePendingDeal:function(e){var t=this,i=[];i.push(e.messageId),this.$confirm("是否确认处理?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,l["a"].messagePendingDeal({ids:i},(function(e){t.$message.success("操作成功"),t.loading=!1,t.getList()}),(function(e){console.log(e),t.loading=!1}))}),(function(){t.loading=!1}))}})},W=G,Z=(i("e6d7"),i("2877")),Y=Object(Z["a"])(W,a,r,!1,null,null,null);t["default"]=Y.exports},2916:function(e,t,i){},2992:function(e,t,i){"use strict";var a=i("d437"),r=i.n(a);r.a},"2a92":function(e,t,i){"use strict";var a=i("5555"),r=i.n(a);r.a},"2abe":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-popup-tabs",{attrs:{open:e.open},on:{close:e.close},model:{value:e.tabSelection,callback:function(t){e.tabSelection=t},expression:"tabSelection"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[i("potential-customer-base-info",{ref:"base",attrs:{itemId:e.itemId,viewMode:e.viewMode},on:{operationSuccess:e.operationSuccess}})],1),e.itemId.id?i("el-tab-pane",{attrs:{label:"购买意向",name:"1"}},[i("potential-customer-intention",{attrs:{itemId:e.itemId,viewMode:e.viewMode},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId.id?i("el-tab-pane",{attrs:{label:"回访记录",name:"3"}},[i("potential-customer-callback-record",{attrs:{itemId:e.itemId,alertId:e.alertId,viewMode:e.viewMode},on:{operationSuccess:e.operationSuccess}})],1):e._e(),e.itemId.id?i("el-tab-pane",{attrs:{label:"试乘试驾",name:"4"}},[i("potential-customer-test-drive",{attrs:{itemId:e.itemId,alertId:e.alertId,viewMode:e.viewMode},on:{operationSuccess:e.operationSuccess}})],1):e._e()],1)},r=[],o=(i("d3b7"),i("7132")),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer-mgmt__base-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),i("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"渠道",prop:"customerChannel"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择渠道",filterable:""},on:{change:e.channelChange},model:{value:e.formModel.customerChannel.id,callback:function(t){e.$set(e.formModel.customerChannel,"id",t)},expression:"formModel.customerChannel.id"}},e._l(e.channelList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[i("el-input",{attrs:{type:"phone",placeholder:"请输入手机号",maxlength:"11",disabled:!!e.itemId.id},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}},[i("template",{slot:"append"},[i("el-button",{attrs:{size:"small"},on:{click:e.handleCreateClick}},[e._v("创建会员")])],1)],2)],1),i("el-form-item",{attrs:{label:"客户姓名",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入客户姓名"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),i("el-form-item",{attrs:{label:"客户类型",prop:"customerType"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择客户类型",filterable:""},on:{change:e.customerTypeChange},model:{value:e.formModel.customerType,callback:function(t){e.$set(e.formModel,"customerType",t)},expression:"formModel.customerType"}},e._l(e.customerTypeList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"性别",prop:"gernder"}},[i("el-radio-group",{model:{value:e.formModel.gernder,callback:function(t){e.$set(e.formModel,"gernder",t)},expression:"formModel.gernder"}},[i("el-radio",{attrs:{label:"male"}},[e._v("男")]),i("el-radio",{attrs:{label:"female"}},[e._v("女")]),i("el-radio",{attrs:{label:"unknown"}},[e._v("保密")])],1)],1),i("el-form-item",{attrs:{label:"头像",prop:"image"}},[i("BizAvatarUploaderNew",{model:{value:e.formModel.head,callback:function(t){e.$set(e.formModel,"head",t)},expression:"formModel.head"}})],1),i("el-form-item",{attrs:{label:"建档日期",prop:"entryDate"}},[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"请选择建档日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,clearable:!1,disabled:!!e.itemId.id},model:{value:e.formModel.entryDate,callback:function(t){e.$set(e.formModel,"entryDate",t)},expression:"formModel.entryDate"}})],1),i("el-form-item",{attrs:{label:"首次邀约来店"}},[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:e.itemId.id?"----":"选择首次邀约来店",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:!!e.itemId.id},model:{value:e.formModel.inshopDate,callback:function(t){e.$set(e.formModel,"inshopDate",t)},expression:"formModel.inshopDate"}})],1),i("el-form-item",{attrs:{label:"销售顾问",prop:"salesAdvisor"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择销售顾问",filterable:""},model:{value:e.formModel.salesAdvisor.id,callback:function(t){e.$set(e.formModel.salesAdvisor,"id",t)},expression:"formModel.salesAdvisor.id"}},e._l(e.salesList,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name||"未填写",value:e.id}})})),1)],1),i("el-collapse",{attrs:{accordion:""},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"1",title:"扩展信息"}},[i("el-form-item",{attrs:{label:"婚姻状况"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择婚姻状况",filterable:""},model:{value:e.formModel.maritalStatus,callback:function(t){e.$set(e.formModel,"maritalStatus",t)},expression:"formModel.maritalStatus"}},e._l(e.maritalStatusList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"地址"}},[i("el-input",{attrs:{maxlength:"100",placeholder:"请输入地址"},model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1),i("el-form-item",{attrs:{label:"职业"}},[i("el-input",{attrs:{maxlength:"20",placeholder:"请输入职业"},model:{value:e.formModel.job,callback:function(t){e.$set(e.formModel,"job",t)},expression:"formModel.job"}})],1)],1)],1)],1)],1)},n=[],l=(i("99af"),i("d81d"),i("b0c0"),i("5530")),d=i("f36f"),c=i("8330"),p=i("c596"),m=i("1ab1"),u=i("c466"),f=i("2f62"),h=i("c17f"),g={customerTypeList:[{label:"个人",value:"personal"},{label:"行业",value:"company"}],maritalStatusList:[{label:"已婚",value:"married"},{label:"未婚",value:"unmarried"}],salesList:[],activeNames:[],pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},operations:[{label:"保存",name:"save",type:"primary",auth:["admin:potential.edit"]}]},b=function(){return{customerChannel:{id:""},entryDate:new Date,salesAdvisor:{id:""},gernder:"unknown",head:"/resources/admin/images/Avatar.png",customerType:"personal"}},v={data:{loading:!1,channelList:[],defaultUser:"/resources/admin/images/Avatar.png",formModel:b()},events:{handleOperate:function(e){this[e]()}},methods:{customerTypeChange:function(){this.$refs.form.clearValidate("customerType")},channelChange:function(){this.$refs.form.clearValidate("customerChannel")},queryConsumerInfo:function(){var e=this;m["a"].get(p["u"].baseInfo.editQuery,{shopId:window.top.SHOP_ID||"",id:this.itemId.id,viewMode:this.viewMode}).then((function(t){if(e.salesList&&0!==e.salesList.length||(t.potentialConsumer&&t.potentialConsumer.salesAdvisor&&t.potentialConsumer.salesAdvisor.id?e.salesList=[{name:"无",id:""}].concat([{name:t.potentialConsumer.salesAdvisor.name,id:t.potentialConsumer.salesAdvisor.id}]):e.salesList=[{name:"无",id:""}].concat([{name:e.getUser().realName,id:e.getUser().id}])),t.potentialConsumer){var i=t.potentialConsumer;i.entryDate=new Date(i.entryDate),i.inshopDate=i.inshopDate?new Date(i.inshopDate):void 0,i.salesAdvisor||(i.salesAdvisor={id:""}),e.formModel=i;var a=!0;e.salesList.map((function(e){t.potentialConsumer.salesAdvisor&&t.potentialConsumer.salesAdvisor.id&&e.id===t.potentialConsumer.salesAdvisor.id&&(a=!1)})),a&&t.potentialConsumer.salesAdvisor&&t.potentialConsumer.salesAdvisor.id&&(e.salesList=e.salesList.concat([{name:t.potentialConsumer.salesAdvisor.name,id:t.potentialConsumer.salesAdvisor.id}]))}else{var r=e.getDefaultModel();r.salesAdvisor.id=e.getUser().id,e.formModel=r}})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(t){e.loading=!1}))},resetModel:function(){this.formModel=this.getDefaultModel()},getChannelList:function(){var e=this;m["a"].get(p["u"].customerChannels,{shopId:window.top.SHOP_ID||""}).then((function(t){e.channelList=t.dataList.map((function(e){return{value:e.id,label:e.name}}))})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},getDefaultModel:function(){return b()},getSaveParams:function(){return{token:"",id:this.formModel.id,customerChannel:{id:this.formModel.customerChannel.id},entryDate:u["a"].dateConverter(this.formModel.entryDate),inshopDate:u["a"].dateConverter(this.formModel.inshopDate),potentialConsumerId:this.formModel.potentialConsumerId,salesAdvisor:{id:this.formModel.salesAdvisor.id},name:this.formModel.name,gernder:this.formModel.gernder,head:this.formModel.head,customerType:this.formModel.customerType,mobile:this.formModel.mobile,maritalStatus:this.formModel.maritalStatus,address:this.formModel.address,job:this.formModel.job,shopId:window.top.SHOP_ID||"",viewMode:this.viewMode}},save:function(){var e=this;this.$refs.form.validate((function(t,i){if(!t)return!1;e.loading=!0;var a=e.getSaveParams();!e.formModel.id&&m["a"].post(p["u"].baseInfo.add,a).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess",t.potentialConsumerId)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1})),e.formModel.id&&m["a"].put(p["u"].baseInfo.update,a).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}))}}},y={events:{handleCreateClick:function(e){/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/.test(this.formModel.mobile)&&this.createMember()}},methods:{createMember:function(){var e=this;this.loading=!0,m["a"].post(p["u"].baseInfo.createMember,{shopId:window.top.SHOP_ID||"",gender:this.formModel.gernder,mobile:this.formModel.mobile,name:this.formModel.name,userSource:"1",viewMode:this.viewMode}).then((function(t){e.$message.success("创建成功")})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}}},_={name:"PotentialCustomerBaseInfo",components:{BizSaveButton:c["a"],BizGrid:d["a"],BizAvatarUploaderNew:h["b"]},data:function(){var e=this,t=function(t,i,a){return e.formModel.customerChannel.id?a():a(new Error("请选择渠道"))};return Object(l["a"])(Object(l["a"])(Object(l["a"])({},g),v.data),{},{rules:{customerChannel:[{required:!0,validator:t,trigger:"blur"}],name:[{required:!0,message:"请输入客户姓名",trigger:"blur"},{max:20,message:"客户姓名长度不得超过20位",trigger:"blur"}],gernder:[{required:!0,message:"请选择性别",trigger:"blur"}],entryDate:[{required:!0,message:"请输入建档日期",trigger:"blur"}],customerType:[{required:!0,message:"请选择客户类型",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}},viewMode:{type:String,default:function(){return"merge"}}},computed:Object(l["a"])({},Object(f["c"])("Sales",["potentialInfo","consumerInfo"])),methods:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},Object(f["c"])(["getUser"])),Object(f["d"])("Sales",["updatePotentialInfo","updateConsumer"])),v.methods),v.events),y.methods),y.events),watch:{itemId:function(e,t){this.$refs.form.clearValidate(),this.activeNames=[],this.potentialInfo.sales&&(this.salesList=[{name:"无",id:""}].concat(this.potentialInfo.sales)),e.id&&this.queryConsumerInfo()}},created:function(){this.getChannelList(),this.salesList=this.potentialInfo.sales||[],this.itemId.id&&this.queryConsumerInfo()}},I=_,w=(i("9433"),i("2877")),x=Object(w["a"])(I,s,n,!1,null,null,null),S=x.exports,C=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer-mgmt__intention"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}),i("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"客户意向级别",prop:"level"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择客户意向级别",disabled:""},model:{value:e.formModel.level,callback:function(t){e.$set(e.formModel,"level",t)},expression:"formModel.level"}},e._l(e.intentionLevelList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"购买意向",prop:"type"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addProduct}},[e._v("添加")])],1),i("el-form-item",{attrs:{label:""}},[i("el-table",{staticClass:"p-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"small"}},[i("el-table-column",{attrs:{prop:"productName",label:"意向商品"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[t.row.productName?i("div",{staticClass:"biz-customcol"},[e._v(" "+e._s(t.row.productName)+" ")]):i("div",{staticClass:"biz-customcol"},[e._v(" "+e._s(t.row.seriesName)+" ")])])}}])}),i("el-table-column",{attrs:{prop:"memo",label:"描述"}}),i("el-table-column",{attrs:{label:"操作",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteHandler(t.row)}}},[e._v(" 删除 ")])],1)}}])})],1)],1),i("el-form-item",{attrs:{label:"意向车色"}},[i("el-input",{attrs:{maxlength:"20",placeholder:"请输入意向车色"},model:{value:e.formModel.carColor,callback:function(t){e.$set(e.formModel,"carColor",t)},expression:"formModel.carColor"}})],1),i("el-form-item",{attrs:{label:"付款方式"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择付款方式"},model:{value:e.formModel.paymentMethod,callback:function(t){e.$set(e.formModel,"paymentMethod",t)},expression:"formModel.paymentMethod"}},e._l(e.paymentList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"预算"}},[i("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.formModel.budget,callback:function(t){e.$set(e.formModel,"budget",t)},expression:"formModel.budget"}})],1),i("el-form-item",{attrs:{label:"购买方式"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择购买方式"},model:{value:e.formModel.purchaseMode,callback:function(t){e.$set(e.formModel,"purchaseMode",t)},expression:"formModel.purchaseMode"}},e._l(e.purchaseModeList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"原使用商品"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择原使用商品",filterable:""},model:{value:e.formModel.originalBrand,callback:function(t){e.$set(e.formModel,"originalBrand",t)},expression:"formModel.originalBrand"}},e._l(e.brandList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),i("el-form-item",{attrs:{label:"预计购买日期"}},[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择预计购买日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.purchaseDate,callback:function(t){e.$set(e.formModel,"purchaseDate",t)},expression:"formModel.purchaseDate"}})],1),i("el-form-item",{attrs:{label:"购买目的"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择购买目的"},model:{value:e.formModel.purpose,callback:function(t){e.$set(e.formModel,"purpose",t)},expression:"formModel.purpose"}},e._l(e.purposeList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"购买侧重点"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择购买侧重点"},model:{value:e.formModel.emphasis,callback:function(t){e.$set(e.formModel,"emphasis",t)},expression:"formModel.emphasis"}},e._l(e.emphasisList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"竞争商品1"}},[i("el-input",{attrs:{maxlength:"50",placeholder:"请输入竞争商品1"},model:{value:e.formModel.competingCar,callback:function(t){e.$set(e.formModel,"competingCar",t)},expression:"formModel.competingCar"}})],1),i("el-form-item",{attrs:{label:"关注因素"}},[i("el-input",{attrs:{maxlength:"50",placeholder:"请输入关注因素"},model:{value:e.formModel.concernedfactors,callback:function(t){e.$set(e.formModel,"concernedfactors",t)},expression:"formModel.concernedfactors"}})],1),i("el-form-item",{attrs:{label:"竞争商品2"}},[i("el-input",{attrs:{maxlength:"50",placeholder:"请输入竞争商品2"},model:{value:e.formModel.competingCar2,callback:function(t){e.$set(e.formModel,"competingCar2",t)},expression:"formModel.competingCar2"}})],1),i("el-form-item",{attrs:{label:"关注因素"}},[i("el-input",{attrs:{maxlength:"50",placeholder:"请输入关注因素"},model:{value:e.formModel.concernedfactors2,callback:function(t){e.$set(e.formModel,"concernedfactors2",t)},expression:"formModel.concernedfactors2"}})],1),i("el-form-item",{attrs:{label:"客户特征"}},[i("el-input",{attrs:{maxlength:"50",placeholder:"请输入客户特征"},model:{value:e.formModel.feature,callback:function(t){e.$set(e.formModel,"feature",t)},expression:"formModel.feature"}})],1)],1),i("el-dialog",{attrs:{title:"意向商品",visible:e.dialogVisible,width:"30%","append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"dialogForm",attrs:{size:"small","label-width":"110px",model:e.dialogForm,rules:e.dialogRules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"品牌",prop:"brandId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌"},on:{change:e.handleBrandChange},model:{value:e.dialogForm.brandId,callback:function(t){e.$set(e.dialogForm,"brandId",t)},expression:"dialogForm.brandId"}},e._l(e.brandList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"系列",prop:"seriesId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列"},on:{change:e.handleSeriesChange},model:{value:e.dialogForm.seriesId,callback:function(t){e.$set(e.dialogForm,"seriesId",t)},expression:"dialogForm.seriesId"}},e._l(e.seriesList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"车型",prop:"productId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型"},on:{change:e.handleTypeChange},model:{value:e.dialogForm.productId,callback:function(t){e.$set(e.dialogForm,"productId",t)},expression:"dialogForm.productId"}},e._l(e.modeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"描述",prop:"memo"}},[i("el-input",{attrs:{placeholder:"请输入描述",maxlength:"30"},model:{value:e.dialogForm.memo,callback:function(t){e.$set(e.dialogForm,"memo",t)},expression:"dialogForm.memo"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)],1)},M=[],k=(i("c975"),i("a434"),i("e42c")),T={intentionLevelList:[],paymentList:[{label:"现金",value:"cash"},{label:"按揭",value:"mortgage"}],purchaseModeList:[{label:"新购",value:"new_buy"},{label:"增购",value:"add_buy"},{label:"换购",value:"change_buy"}],purposeList:[{label:"家庭用车",value:"family"},{label:"商务用车",value:"business"},{label:"生活",value:"life"},{label:"休闲",value:"leisure"},{label:"上班",value:"work"},{label:"其他",value:"others"}],emphasisList:[{label:"外形",value:"appearance"},{label:"动力",value:"power"},{label:"费用",value:"cost"},{label:"舒适",value:"comfort"},{label:"安全",value:"safety"},{label:"操控",value:"manipulative"},{label:"价格",value:"price"},{label:"品牌",value:"brand"},{label:"配置",value:"configure"},{label:"其他",value:"other"}],pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()}},tableData:[],saveTableData:[],productId:"",products:[],seriesId:"",series:[],dialogVisible:!1,operations:[{label:"保存",name:"save",type:"primary",auth:["admin:potential.edit"]}]},D={data:{brandList:[],seriesList:[],modeList:[]},methods:{queryBrandList:function(){var e=this;k["a"].brands({category:"car"},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;k["a"].series({brandId:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;k["a"].types({seriesId:e,brand:this.dialogForm.brandId},(function(e){t.modeList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))}},events:{handleBrandChange:function(e){this.querySeriesList(e),this.productId="",this.seriesId="",this.$set(this.dialogForm,"seriesId",""),this.$set(this.dialogForm,"productId",""),this.$refs.dialogForm.clearValidate("brandId")},handleSeriesChange:function(e){this.queryTypeList(e),this.productId="",this.seriesId=e,this.$set(this.dialogForm,"productId",""),this.$refs.dialogForm.clearValidate("seriesId")},handleTypeChange:function(e){this.productId=e,this.$refs.dialogForm.clearValidate("productId")}}},$=function(){return{}},O={data:{loading:!1,formModel:$(),dialogForm:$()},events:{handleOperate:function(e){this[e]()}},methods:Object(l["a"])(Object(l["a"])({},Object(f["d"])("Sales",["updatePotentialInfo","updateConsumer"])),{},{queryConsumerInfo:function(){var e=this;m["a"].get(p["u"].baseInfo.editQuery,{shopId:window.top.SHOP_ID||"",id:this.itemId.id,viewMode:this.viewMode}).then((function(t){var i=t.potentialConsumer;i.nextVisitTime=i.nextVisitTime?u["a"].dateConverter(new Date(i.nextVisitTime)):void 0,i.purchaseDate=i.purchaseDate?u["a"].dateConverter(new Date(i.purchaseDate)):void 0,e.formModel=i,e.tableData=i.intentionCars})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(t){e.loading=!1}))},addProduct:function(){this.dialogForm={},this.dialogVisible=!0},confirm:function(){var e=this;this.$refs.dialogForm.validate((function(t,i){if(t){if(e.tableData.map((function(t){e.products.push(t.productId),e.series.push(t.seriesId)})),e.productId&&-1!==e.products.indexOf(e.productId))return void e.$message.warning("已添加此意向车型，不能重复添加");if(!e.productId&&-1!==e.series.indexOf(e.seriesId))return void e.$message.warning("已添加此意向车型，不能重复添加");var a="",r="";e.modeList.map((function(t){t.id===e.productId&&(a=t.name)})),e.seriesList.map((function(t){t.id===e.dialogForm.seriesId&&(r=t.name)})),e.tableData.push({brandId:e.dialogForm.brandId,seriesId:e.dialogForm.seriesId,memo:e.dialogForm.memo,productName:a,seriesName:r,productId:e.productId}),e.dialogVisible=!1}}))},deleteHandler:function(e){this.tableData.splice(this.tableData.indexOf(e),1)},deleteRecommend:function(e){this.tableData.splice(this.tableData.indexOf(e),1),this.products.splice(this.products.indexOf(e.id),1)},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return $()},getSaveParams:function(){return{token:"",id:this.formModel.id,level:this.formModel.level,nextVisitTime:this.formModel.nextVisitTime,carColor:this.formModel.carColor,paymentMethod:this.formModel.paymentMethod,budget:this.formModel.budget,purchaseMode:this.formModel.purchaseMode,purchaseDate:this.formModel.purchaseDate,purpose:this.formModel.purpose,emphasis:this.formModel.emphasis,carBrand:this.formModel.carBrand,competingCar:this.formModel.competingCar,concernedfactors:this.formModel.concernedfactors,competingCar2:this.formModel.competingCar2,concernedfactors2:this.formModel.concernedfactors2,feature:this.formModel.feature,originalBrand:this.formModel.originalBrand,intentionCars:this.tableData,viewMode:this.viewMode,shopId:window.top.SHOP_ID||""}},save:function(){var e=this;this.$refs.form.validate((function(t,i){if(!t)return!1;e.loading=!0;var a=e.getSaveParams();m["a"].put(p["u"].intention.save,a).then((function(t){e.$message.success("保存成功"),e.$emit("operationSuccess",e.formModel.id)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}))}})},L={name:"PotentialCustomerIntention",components:{BizSaveButton:c["a"],BizGrid:d["a"]},data:function(){return Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},T),O.data),D.data),{},{rules:{},dialogRules:{brandId:[{required:!0,trigger:"blur",message:"请选择品牌"}],seriesId:[{required:!0,trigger:"blur",message:"请选择系列"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}},viewMode:{type:String,default:function(){return"merge"}}},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},Object(f["c"])(["getUser"])),O.methods),O.events),D.methods),D.events),computed:Object(l["a"])(Object(l["a"])({},Object(f["c"])("Sales",["potentialInfo","consumerInfo"])),{},{consumerState:function(){return this.$store.state.potentialCustomer.consumerState}}),watch:{itemId:function(e,t){this.intentionLevelList=this.potentialInfo.intentionLevels,e.id&&this.queryConsumerInfo()}},created:function(){this.queryBrandList(),this.intentionLevelList=this.potentialInfo.intentionLevels,console.log("intentionList: ",this.intentionLevelList),this.itemId.id&&this.queryConsumerInfo()}},z=L,P=(i("6c4f"),Object(w["a"])(z,C,M,!1,null,null,null)),R=P.exports,N=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer-mgmt__callback-record"},[i("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}}),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"400",size:"small"},on:{"row-click":e.handleRowClick}},[i("el-table-column",{attrs:{prop:"visitDate",label:"回访日期",formatter:e.dateConverter1}}),i("el-table-column",{attrs:{prop:"visitResult",label:"回访内容"}}),i("el-table-column",{attrs:{prop:"nextVisitDate",label:"下次回访日期",formatter:e.dateConverter}}),i("biz-empty-table-tab",{attrs:{slot:"empty"},slot:"empty"})],1),i("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[i("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-radio-group",{attrs:{disabled:!!this.formModel.id},on:{change:e.levelChange},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}},[i("el-radio",{attrs:{label:"1"}},[e._v("核心H")]),i("el-radio",{attrs:{label:"2"}},[e._v("重要A")]),i("el-radio",{attrs:{label:"3"}},[e._v("意向B")]),i("el-radio",{attrs:{label:"4"}},[e._v("一般C")]),i("el-radio",{attrs:{label:"0"}},[e._v("签约O")]),i("el-radio",{attrs:{label:"5"}},[e._v("战败F")]),i("el-radio",{attrs:{label:"6"}},[e._v("交车D")]),i("el-radio",{attrs:{label:"7"}},[e._v("无意向N")])],1),i("el-form-item",{attrs:{label:"下次回访日期",prop:"nextVisitDate"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择下次回访日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd hh:mm:ss",clearable:!1,disabled:!!this.formModel.id,"picker-options":e.pickerOptions},model:{value:e.formModel.nextVisitDate,callback:function(t){e.$set(e.formModel,"nextVisitDate",t)},expression:"formModel.nextVisitDate"}})],1),"6"===e.level?i("el-form-item",{attrs:{label:"交车日期",prop:"deliveryDate"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择交车日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd hh:mm:ss",clearable:!1,disabled:!!this.formModel.id},model:{value:e.formModel.deliveryDate,callback:function(t){e.$set(e.formModel,"deliveryDate",t)},expression:"formModel.deliveryDate"}})],1):e._e(),i("el-form-item",{attrs:{label:"回访内容",prop:"visitResult"}},[i("el-input",{attrs:{maxlength:"100",disabled:!!this.formModel.id,placeholder:"请输入回访内容"},model:{value:e.formModel.visitResult,callback:function(t){e.$set(e.formModel,"visitResult",t)},expression:"formModel.visitResult"}})],1),"0"===e.level?i("el-form-item",{attrs:{label:"订单号"}},[i("el-input",{attrs:{readonly:"",disabled:!0},model:{value:e.formModel.orderSn,callback:function(t){e.$set(e.formModel,"orderSn",t)},expression:"formModel.orderSn"}},[i("div",{staticClass:"input-operation",attrs:{slot:"append"},slot:"append"},[i("el-button",{attrs:{type:"text"},on:{click:e.handleListClick}},[i("i",{staticClass:"iconfont biz-icon-liebiaoshitu"})])],1)])],1):e._e(),"0"===e.level?i("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌",disabled:!!this.formModel.id},on:{change:e.handleBrandChange},model:{value:e.formModel.brand,callback:function(t){e.$set(e.formModel,"brand",t)},expression:"formModel.brand"}},e._l(e.brandList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"0"===e.level?i("el-form-item",{attrs:{label:"系列",prop:"series"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列",disabled:!!this.formModel.id},on:{change:e.handleSeriesChange},model:{value:e.formModel.series,callback:function(t){e.$set(e.formModel,"series",t)},expression:"formModel.series"}},e._l(e.seriesList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"0"===e.level?i("el-form-item",{attrs:{label:"车型",prop:"product"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型",disabled:!!this.formModel.id},model:{value:e.formModel.product,callback:function(t){e.$set(e.formModel,"product",t)},expression:"formModel.product"}},e._l(e.modeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"5"===e.level?i("el-form-item",{attrs:{label:"战败原因",prop:"failureReason"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择战败原因",disabled:!!this.formModel.id},model:{value:e.formModel.failureReason,callback:function(t){e.$set(e.formModel,"failureReason",t)},expression:"formModel.failureReason"}},e._l(e.reasonList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1):e._e()],1),this.formModel.id?e._e():i("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.formOperations},on:{operate:e.handleOperate}})],1),i("pc-order-picker",{ref:"orderPicker",attrs:{itemId:e.itemId,memberId:e.memberId},on:{input:e.handleOrderSelected}})],1)},A=[],B=(i("4160"),i("ac1f"),i("5319"),i("159b"),i("04d3")),F=i("6401"),E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"potential-customer__order-picker"},[i("biz-dialog-selector",{attrs:{slot:"float",title:"选择订单",visibility:e.showDialog,loading:e.loading,tableData:e.tableData,pagination:e.pagination,selectionMode:"single",isClear:!1,filters:e.filters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[i("el-table-column",{attrs:{prop:"sn",label:"订单编号"}}),i("el-table-column",{attrs:{prop:"orderTime",label:"订单时间"}}),i("el-table-column",{attrs:{prop:"orderType",label:"订单分类",formatter:e.orderTypeFormatter}}),i("el-table-column",{attrs:{prop:"orderItems",label:"商品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.orderItems,(function(t){return i("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])}))}}])}),i("el-table-column",{attrs:{prop:"consignee",label:"会员昵称"}}),i("el-table-column",{attrs:{prop:"plateNumber",label:"车牌"}}),i("el-table-column",{attrs:{prop:"amount",label:"订单金额"}}),i("el-table-column",{attrs:{prop:"amountPaid",label:"实付金额"}})],1)],1)},U=[],j=(i("a9e3"),i("af3f")),q={name:"PcOrderPicker",components:{BizDialogSelector:j["a"]},model:{prop:"value",event:"input"},data:function(){return{showDialog:!1,loading:!1,tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},filters:[{type:"input",label:"",placeholder:"请输入姓名/手机号",name:"searchValue",value:""}]}},props:{value:{type:Object},itemId:{type:Object},memberId:{type:Object}},methods:{orderTypeFormatter:function(e){var t={0:"普通商品订单",1:"充值订单",2:"服务订单",3:"一键救援预约",4:"维修预约",5:"保养预约",6:"置换预约",7:"贷款购车预约",8:"试乘试驾预约",9:"整车订单",10:"普通订单",11:"维修保养订单",12:"产品订单",13:"sim卡充值订单",14:"平台服务",15:"短信服务"};return t[e.orderType]},query:function(e){var t=this;this.loading=!0,m["a"].get(p["u"].sign.orderList,e).then((function(e){t.tableData=e.content,t.pagination.total=Number(e.total)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))},getStatus:function(e){switch(e.enableState){case"0":return"停用";case"1":return"启用"}return""},clickHandler:function(e){this.showDialog=!0},confirmedHandler:function(e,t){var i=t[0];this.$emit("input",i)},getQueryParams:function(){return{pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,searchValue:this.filters[0].value,searchProperty:"sn",id:this.itemId.id,orderType:"car",memberId:this.memberId?this.memberId.id:""}},openedHandler:function(){this.pagination.currentPage=1,this.pagination.pageSize=20,this.filters=[{type:"input",label:"",placeholder:"请输入订单号",name:"searchValue",value:""}],this.query(this.getQueryParams())},dialogFilterDataChange:function(e){this.pagination.currentPage=1,this.query(this.getQueryParams())},dialogPageSizeChange:function(e){this.$set(this.pagination,"pageSize",e),this.query(this.getQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.pagination,"currentPage",e),this.query(this.getQueryParams())}}},V=q,H=Object(w["a"])(V,E,U,!1,null,null,null),G=H.exports,W={data:{loading:!1,pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()}},operations:[{label:"新建",name:"add",type:"primary",auth:["admin:potential.edit"]}]},methods:{getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",potentialConsumerId:this.itemId.id,viewMode:this.viewMode,pageSize:100,pageNumber:1}},query:function(){var e=this;this.loading=!0,m["a"].get(p["u"].callbackRecord.list,this.getQueryParams()).then((function(t){e.tableData=t.content,e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},getCallbackInfo:function(e){var t=this;m["a"].get(p["u"].callbackRecord.updateCallbackRecord,{visitRecordId:e.id}).then((function(e){t.formModel.id=e.visitRecord.id,t.formModel.nextVisitDate=e.visitRecord.nextVisitDate||"",t.formModel.visitResult=e.visitRecord.visitResult||"",t.level=e.visitRecord.level||"",e.visitRecord.sign?(t.formModel.brand=e.visitRecord.sign.brandId,t.querySeriesList(e.visitRecord.sign.brandId),t.formModel.series=e.visitRecord.sign.seriesId,t.queryTypeList(e.visitRecord.sign.seriesId),t.formModel.product=e.visitRecord.sign.productId,t.formModel.orderSn=e.visitRecord.sign.orderSn):e.visitRecord.delivery?t.formModel.deliveryDate=e.visitRecord.delivery.deliveryDate||"":(t.formModel.brand="",t.formModel.series="",t.formModel.product="",t.formModel.orderSn=""),e.visitRecord.defeat?t.formModel.failureReason=e.visitRecord.defeat.reason:t.formModel.failureReason="",t.showForm=!0})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},add:function(){this.formModel={},this.showForm=!0},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")}},events:{handleOperate:function(e){this[e]()}}},Z={data:{tableData:[],selections:[]},methods:{dateConverter:function(e){if(e.nextVisitDate){e.nextVisitDate=e.nextVisitDate.replace(/-/g,"/");var t=new Date(e.nextVisitDate);return u["a"].dateConverter(t)}return"--"},dateConverter1:function(e){if(e.visitDate){e.visitDate=e.visitDate.replace(/-/g,"/");var t=new Date(e.visitDate);return u["a"].dateConverter(t)}return"--"},typeConverter:function(e){var t={alarm:"提醒回访",sale:"交车回访",insurance:"首保回访",failure:"战败"};return t[e.reasonType]},modeConverter:function(e){var t={call:"电话",inshop:"到店"};return t[e.mode]},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var i={ids:e};m["a"].delete(p["u"].callbackRecord.delete,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))}},events:{rowDeleteClickHandler:function(e,t){e.stopPropagation(),this.deleteItem([t.id])},handleRowClick:function(e){this.$refs.form.clearValidate(),this.getCallbackInfo(e)},handleSelectionChange:function(e){this.selections=e}}},Y=function(){return{visitResult:"",nextVisitDate:""}},J={data:{showForm:!1,brandList:[],seriesList:[],modeList:[],reasonList:[],memberId:{id:""},level:"1",formModel:Y(),rules:{visitResult:[{required:!0,message:"回访内容不少于5个字符",trigger:"blur",min:5}],deliveryDate:[{required:!0,message:"请输入交车日期",trigger:["blur","change"]}],brand:[{required:!0,message:"请选择品牌",trigger:["blur","change"]}],series:[{required:!0,message:"请选择系列",trigger:["blur","change"]}],product:[{required:!0,message:"请选择车型",trigger:["blur","change"]}],failureReason:[{required:!0,message:"请选择战败原因",trigger:["blur","change"]}]},formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"saveForm",type:"primary"}]},methods:{initForm:function(e){this.showForm=!0;var t=Y();this.formModel=e?Object.assign(t,e):t,this.$refs.form&&this.$refs.form.resetFields()},levelChange:function(){this.formModel=Y(),this.$refs.form.clearValidate()},queryBrandList:function(){var e=this;m["a"].get(p["u"].failure.queryBrandList,{brandId:"",seriesId:""}).then((function(t){e.brandList=t.dataList})).catch((function(t){e.brandList=t}))},querySeriesList:function(e){var t=this;m["a"].get(p["u"].failure.querySeriesList,{brandId:e}).then((function(e){t.seriesList=e.dataList})).catch((function(e){t.seriesList=e}))},queryTypeList:function(e){var t=this;m["a"].get(p["u"].failure.queryModeList,{brandId:this.formModel.failureBrandId,seriesId:e}).then((function(e){t.modeList=e.dataList})).catch((function(e){t.modeList=e}))},handleListClick:function(e){this.consumerInfo.potentialConsumer.member&&(this.memberId=this.consumerInfo.potentialConsumer.member),this.$refs.orderPicker.showDialog=!0},handleOrderSelected:function(e){this.$set(this.formModel,"orderSn",e.sn),this.$set(this.formModel,"orderId",e.id),this.$set(this.formModel,"brand",e.products[0].brandId),this.querySeriesList(e.products[0].brandId),this.$set(this.formModel,"series",e.products[0].seriesId),this.queryTypeList(e.products[0].seriesId),this.$set(this.formModel,"product",e.products[0].id)},handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.formModel,"series",""),this.$set(this.formModel,"product","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.formModel,"product","")},cancelForm:function(){this.showForm=!1},getSaveParams:function(){return{token:"",id:this.formModel.id,nextVisitDate:this.formModel.nextVisitDate,mode:this.formModel.mode,visitResult:this.formModel.visitResult,delivery:{deliveryDate:this.formModel.deliveryDate},level:this.level,sign:{orderId:this.formModel.orderId,brandId:this.formModel.brand,seriesId:this.formModel.series,productId:this.formModel.product},defeat:{reason:this.formModel.failureReason},alarmRecordId:this.formModel.alarmRecordId,potentialConsumerId:this.itemId.id,viewMode:this.viewMode,shopId:window.top.SHOP_ID||""}},saveForm:function(){var e=this;this.$refs.form.validate((function(t,i){if(!t)return!1;if(!e.formModel.visitResult)return!1;e.loading=!0;var a=e.getSaveParams();!e.formModel.id&&m["a"].post(p["u"].callbackRecord.add,a).then((function(t){e.query(),e.$message.success("添加成功"),e.$emit("operationSuccess"),e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1})),e.formModel.id&&m["a"].put(p["u"].callbackRecord.update,a).then((function(t){e.query(),e.$message.success("更新成功"),e.$emit("operationSuccess"),e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))}},events:{}},Q={name:"PotentialCustomerCallbackRecord",components:{BizHeader:B["d"],BizGrid:d["a"],BizSaveButton:c["a"],BizEmptyTableTab:F["a"],PcOrderPicker:G},props:{itemId:{type:Object,default:function(){return{id:""}}},viewMode:{type:String,default:function(){return"merge"}},alertId:{type:Object,default:function(){return{id:""}}}},data:function(){return Object(l["a"])(Object(l["a"])(Object(l["a"])({},W.data),Z.data),J.data)},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},W.methods),W.events),Z.methods),Z.events),J.methods),J.events),watch:{itemId:function(e,t){this.$refs.form.clearValidate(),e.id&&(this.query(),this.reasonList=this.potentialInfo.failureReasons)},alertId:function(e){e.id&&this.getCallbackInfo(e)}},computed:Object(l["a"])({},Object(f["c"])("Sales",["potentialInfo","consumerInfo"])),created:function(){this.queryBrandList(),this.reasonList=this.potentialInfo.failureReasons,this.itemId.id&&this.query()}},X=Q,K=(i("0edd"),Object(w["a"])(X,N,A,!1,null,null,null)),ee=K.exports,te=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"potential-customer-mgmt__test-drive"},[i("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}}),i("el-table",{attrs:{data:e.tableData,height:"300",size:"small"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[i("biz-empty-table-tab",{attrs:{slot:"empty"},slot:"empty"}),i("el-table-column",{attrs:{type:"selection",width:"30"}}),i("el-table-column",{attrs:{label:"日期",prop:"testTime",formatter:e.dateConverter,"min-width":"105"}}),i("el-table-column",{attrs:{label:"开始时间",prop:"startTime",formatter:e.startTimeConverter,"min-width":"80"}}),i("el-table-column",{attrs:{label:"结束时间",prop:"endTime",formatter:e.endTimeConverter,"min-width":"80"}}),i("el-table-column",{attrs:{label:"开始里程(km)",prop:"startMileage","min-width":"90"}}),i("el-table-column",{attrs:{label:"结束里程(km)",prop:"endMileage","min-width":"90"}}),i("el-table-column",{attrs:{label:"试驾车型","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.product?t.row.product.name:"")+" ")]}}])}),i("el-table-column",{attrs:{prop:"tag",label:"操作","min-width":"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{"margin-right":"4px"},attrs:{type:"text",size:"mini"},on:{click:function(i){return e.rowDeleteClickHandler(i,t.row)}}},[e._v(" 删除 ")])]}}])})],1),i("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"},{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],staticClass:"box-card",staticStyle:{"margin-top":"20px",width:"100%"}},[i("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"试驾日期",prop:"testTime"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择试驾日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",clearable:!1},model:{value:e.formModel.testTime,callback:function(t){e.$set(e.formModel,"testTime",t)},expression:"formModel.testTime"}})],1),i("el-form-item",{attrs:{label:"试驾车型",prop:"product"}},[i("el-input",{attrs:{placeholder:"请选择试驾车型"},on:{focus:e.queryProduct},model:{value:e.formModel.product.name,callback:function(t){e.$set(e.formModel.product,"name",t)},expression:"formModel.product.name"}})],1),i("el-form-item",{attrs:{label:"开始时间",prop:"startTimeText"}},[i("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",editable:!1,clearable:!1},model:{value:e.formModel.startTimeText,callback:function(t){e.$set(e.formModel,"startTimeText",t)},expression:"formModel.startTimeText"}})],1),i("el-form-item",{attrs:{label:"结束时间",prop:"endTimeText"}},[i("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",editable:!1,clearable:!1},model:{value:e.formModel.endTimeText,callback:function(t){e.$set(e.formModel,"endTimeText",t)},expression:"formModel.endTimeText"}})],1),i("el-form-item",{attrs:{label:"使用时间(分)",prop:"useTime"}},[i("el-input",{attrs:{value:e.dateInterval(e.formModel.endTimeText,e.formModel.startTimeText),disabled:!0}})],1),i("el-form-item",{attrs:{label:"开始里程(km)",prop:"startMileage"}},[i("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formModel.startMileage,callback:function(t){e.$set(e.formModel,"startMileage",t)},expression:"formModel.startMileage"}})],1),i("el-form-item",{attrs:{label:"结束里程(km)",prop:"endMileage"}},[i("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formModel.endMileage,callback:function(t){e.$set(e.formModel,"endMileage",t)},expression:"formModel.endMileage"}})],1),i("el-form-item",{attrs:{label:"使用里程(km)"}},[i("el-input",{attrs:{value:e.useMileage,disabled:!0}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{attrs:{maxlength:"100",placeholder:"请输入备注"},model:{value:e.formModel.remarks,callback:function(t){e.$set(e.formModel,"remarks",t)},expression:"formModel.remarks"}})],1)],1),i("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.formOperations},on:{operate:e.handleOperate}})],1),i("biz-dialog-selector",{attrs:{title:"选择车型",visibility:e.showProductSelector,tableData:e.productTableData,pagination:e.productPagination,selectionMode:"single"},on:{"update:visibility":function(t){e.showProductSelector=t},pageSizeChange:e.productPageSizeChange,currentPageChange:e.productCurrentPageChange,confirmed:e.confirmedProduct}},[i("el-table-column",{attrs:{property:"fullName",label:"名称"}}),i("el-table-column",{attrs:{property:"price",label:"销售价"}})],1)],1)},ie=[],ae=(i("4d63"),i("25f0"),i("1276"),i("46fc")),re=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[i("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tags:e.tags,pagination:e.pagination,tableData:e.tableData,loading:e.loading,checkable:e.checkable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange}},[e._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],1)},oe=[],se={name:"BizDialogSelector",components:{BizFlexTable:B["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},selectionKeys:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],innerSelection:[]}},methods:{generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]);else{var i=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(i,1)}},open:function(e){console.log(this.selectionKeys),this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){this.innerSelectionKeys.length>0?(this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1):this.$message("请选择一项")},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i>=0&&t.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i<0&&t.innerSelectionKeys.push(e[t.keyField])}))},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},rowClick:function(e,t,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){}},ne=se,le=(i("ef0b"),Object(w["a"])(ne,re,oe,!1,null,null,null)),de=le.exports,ce={data:{loading:!1,showProductSelector:!1,operations:[{label:"新建",name:"add",type:"primary",auth:["admin:potential.edit"]},{disabled:!0,label:"删除",name:"delete",type:"",auth:["admin:potential.edit"]}],productTableData:[],productPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入店铺名称",name:"searchValue",value:""}]},methods:Object(l["a"])(Object(l["a"])({},Object(f["c"])(["getUser"])),{},{dateInterval:function(e,t){if(e&&t)return Object(ae["a"])(e.split(" ")[1],t.split(" ")[1])},queryProduct:function(){var e=this;k["a"].listProductByTestDrive({clientType:"2",methodName:"ListProductByTestDrive",shopId:this.getUser().shop?this.getUser().shop.id:window.top.SHOP_ID,pageSize:this.productPagination.pageSize,pageNumber:this.productPagination.currentPage},(function(t){e.productTableData=t.content,e.productPagination.total=Number(t.total),e.showProductSelector=!0}),(function(t){e.$message.warning(t.errorMessage)}))},getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",viewMode:this.viewMode,potentialConsumerId:this.itemId.id,pageSize:100,pageNumber:1}},getLevel:function(e){return"1"===e?"核心客户H":"2"===e?"重要客户A":"3"===e?"意向客户B":"4"===e?"一般客户C":"0"===e?"签约O":"5"===e?"战败F":"6"===e?"交车D":"7"===e?"无意向N":void 0},query:function(){var e=this;this.loading=!0,m["a"].get(p["u"].testDrive.list,this.getQueryParams()).then((function(t){e.tableData=t.dataList,e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},add:function(){this.initForm()},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")},productPageSizeChange:function(e){this.$set(this.productPagination,"pageSize",e)},productCurrentPageChange:function(e){this.$set(this.productPagination,"currentPage",e)},confirmedProduct:function(e,t){this.$set(this.formModel.product,"id",t[0].id),this.$set(this.formModel.product,"name",t[0].fullName)}}),events:{handleOperate:function(e){this[e]()}}},pe={data:{tableData:[],selections:[]},methods:{dateConverter:function(e){if(e.testTime){e.testTime=e.testTime.replace(/-/g,"/");var t=new Date(e.testTime);return u["a"].dateConverter(t)}return"--"},startTimeConverter:function(e){if(e.startTime){e.startTime=e.startTime.replace(/-/g,"/");var t=new Date(e.startTime);return u["a"].shortTimeConverter(t)}return"--"},endTimeConverter:function(e){if(e.endTime){e.endTime=e.endTime.replace(/-/g,"/");var t=new Date(e.endTime);return u["a"].shortTimeConverter(t)}return"--"},deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var i={viewMode:t.viewMode,ids:e};m["a"].delete(p["u"].testDrive.delete,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))}},events:{rowDeleteClickHandler:function(e,t){e.stopPropagation(),this.deleteItem([t.id])},handleRowClick:function(e){this.queryItem(e.id)},handleSelectionChange:function(e){this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1),this.selections=e}}},me=function(){return{testTime:null,startTimeText:null,endTimeText:null,brand:null,series:null,product:{id:"",name:""}}},ue={data:{formLoading:!1,showForm:!1,formModel:me(),modeList:[{value:"call",label:"电话"},{value:"inshop",label:"到店"}],reasonList:[{value:"alarm",label:"提醒回访"},{value:"sale",label:"交车回访"},{value:"insurance",label:"首保回访"},{value:"failure",label:"战败"}],formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"saveForm",type:"primary"}]},methods:{queryItem:function(e){var t=this;this.formLoading=!0,m["a"].get(p["u"].testDrive.item,{testDriveRecordId:e,potentialConsumerId:this.itemId.id,viewMode:this.viewMode}).then((function(e){var i=e.testDriveRecord;i.startTimeText=i.startTime,i.endTimeText=i.endTime,i.brand=i.product.brandId?i.product.brandId.toString():"",i.series=i.product.seriesId?i.product.seriesId.toString():"",t.initForm(i),i.brand&&t.querySeriesList(t.formModel.brand),i.series&&t.queryTypeList(t.formModel.series)})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.formLoading=!1}))},initForm:function(e){this.showForm=!0;var t=me();this.formModel=e?Object.assign(t,e):t,this.$refs.form&&this.$refs.form.resetFields()},cancelForm:function(){this.showForm=!1},getSaveParams:function(){return{token:"",id:this.formModel.id,testTime:this.formModel.testTime.length>10?this.formModel.testTime:this.formModel.testTime+" "+this.formModel.startTimeText.split(" ")[1],startMileage:this.formModel.startMileage,endMileage:this.formModel.endMileage,remarks:this.formModel.remarks,product:{id:this.formModel.product.id},startTime:this.formModel.testTime+" "+this.formModel.startTimeText.split(" ")[1],endTime:this.formModel.testTime+" "+this.formModel.endTimeText.split(" ")[1],potentialConsumerId:this.itemId.id,shopId:window.top.SHOP_ID||"",viewMode:this.viewMode}},saveForm:function(){var e=this;this.$refs.form.validate((function(t,i){if(!t)return!1;e.loading=!0;var a=e.getSaveParams();!e.formModel.id&&m["a"].post(p["u"].testDrive.add,a).then((function(t){e.query(),e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1})),e.formModel.id&&m["a"].put(p["u"].testDrive.update,a).then((function(t){e.query(),e.showForm=!1})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))},convertDate:function(e,t){var i=u["a"].dateConverter(e);return i=i.replace(/-/g,"/"),new Date(i+" "+t)}},events:{}},fe={data:{brandList:[],seriesList:[],modeList:[]},methods:{queryBrandList:function(){var e=this;m["a"].get(p["u"].failure.queryBrandList,{brandId:"",seriesId:"",category:"car"}).then((function(t){e.brandList=t.dataList})).catch((function(t){e.brandList=t}))},querySeriesList:function(e){var t=this;m["a"].get(p["u"].failure.querySeriesList,{brandId:e}).then((function(e){t.seriesList=e.dataList})).catch((function(e){t.seriesList=e}))},queryTypeList:function(e){var t=this;m["a"].get(p["u"].failure.queryModeList,{brandId:this.formModel.failureBrandId,seriesId:e}).then((function(e){t.modeList=e.dataList})).catch((function(e){t.modeList=e}))}},events:{handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.formModel,"series",""),this.$set(this.formModel,"product","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.formModel,"product","")}}},he={name:"PotentialCustomerTestDrive",components:{BizHeader:B["d"],BizGrid:d["a"],BizSaveButton:c["a"],BizEmptyTableTab:F["a"],BizDialogSelector:de},props:{itemId:{type:Object,default:function(){return{id:""}}},viewMode:{type:String,default:function(){return"merge"}}},data:function(){var e=this;return Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},ce.data),pe.data),ue.data),fe.data),{},{rules:{testTime:[{required:!0,message:"请选择试驾日期",trigger:"blur"}],startTimeText:[{required:!0,message:"请选择开始时间",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){e.formModel.startTimeText>e.formModel.endTimeText?a(new Error("开始时间不能大于结束时间")):a()}}],endTimeText:[{required:!0,message:"请选择结束时间",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){e.formModel.startTimeText>e.formModel.endTimeText?a(new Error("结束时间不能小于开始时间")):a()}}],startMileage:[{required:!0,message:"请输入开始里程",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){var r=new RegExp(/^\+?[1-9][0-9]*$/);r.test(e.formModel.startMileage)?a():a(new Error("请输入一个大于0的整数"))}}],endMileage:[{required:!0,message:"请输入结束里程",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){var r=new RegExp(/^\+?[1-9][0-9]*$/);r.test(e.formModel.endMileage)?Number(e.formModel.endMileage)<Number(e.formModel.startMileage)?a(new Error("结束里程不能小于开始里程")):a():a(new Error("请输入一个大于0的整数"))}}],brand:[{required:!0,message:"请选择品牌",trigger:["blur","change"]}],series:[{required:!0,message:"请选择车系",trigger:["blur","change"]}],product:[{required:!0,message:"请选择车型",trigger:["blur","change"]},{trigger:"blur",validator:function(t,i,a){e.formModel.product.name?a():a(new Error("请选择试驾车型"))}}]}})},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},ce.methods),ce.events),pe.methods),pe.events),ue.methods),ue.events),fe.methods),fe.events),computed:{useTime:function(){var e=this.convertDate(this.formModel.testTime,this.formModel.startTimeText),t=this.convertDate(this.formModel.testTime,this.formModel.endTimeText),i=t-e;return isNaN(i)?"----":i/1e3/60},useMileage:function(){var e=Number(this.formModel.endMileage)-Number(this.formModel.startMileage);return isNaN(e)?"----":e}},watch:{itemId:function(e,t){e.id&&this.query()}},created:function(){this.queryBrandList(),this.itemId.id&&this.query()}},ge=he,be=(i("069c"),Object(w["a"])(ge,te,ie,!1,null,null,null)),ve=be.exports,ye=i("439f"),_e={name:"PotentialCustomerPopup",components:{BizPopupTabs:o["a"],PotentialCustomerBaseInfo:S,PotentialCustomerIntention:R,PotentialCustomerCallbackRecord:ee,PotentialCustomerTestDrive:ve},props:{open:{type:Boolean},itemId:{type:Object,default:function(){return{id:""}}},defaultTab:{type:String,default:function(){return"0"}},viewMode:{type:String,default:function(){return"merge"}}},data:function(){return{tabSelection:"0",alertId:{id:""},showFailure:!0,showSign:!0}},methods:{close:function(e){this.$emit("close",e)},operationSuccess:function(e){this.$emit("operationSuccess",e)},handleCallbackAlert:function(e){this.alertId=Object.assign({},e),this.tabSelection="3"},query:function(){var e=this;m["a"].get(p["u"].baseInfo.editQuery,{shopId:window.top.SHOP_ID||"",id:this.itemId.id,viewMode:this.viewMode}).then((function(t){var i=t.potentialConsumer,a="0";"1"===i.signTrackingResult&&i.deliverySalesAdvisor&&i.deliverySalesAdvisor.id?a="1":"1"===i.failureTrackingResult&&i.failureSalesAdvisor&&i.failureSalesAdvisor.id&&(a="2"),e.$store.commit("changeConsumerState",{value:a})})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}},computed:{consumerState:function(){return this.$store.state.potentialCustomer.consumerState}},watch:{open:function(e){var t=this;e&&setTimeout((function(){t.tabSelection=t.defaultTab?t.defaultTab:"0",ye["a"].clearMessageBoxes(),t.$message({showClose:!0,message:t.itemId.id?"创建或编辑潜客档案，完善客户信息。从营销活动、试乘试驾等自动建档的潜客需要您完善客户信息":"手动创建潜客档案，填写客户姓名电话等信息，越完整越好哦"})}),500)},itemId:function(e){this.$store.commit("changeConsumerState",{value:"-1"}),e.id?this.query():(this.showFailure=!0,this.showSign=!0)},tabSelection:function(e){switch(this.$refs.dataStreamTab&&this.$refs.dataStreamTab.clearInterval(),ye["a"].clearMessageBoxes(),e){case"0":this.$message({showClose:!0,message:this.itemId.id?"创建或编辑潜客档案，完善客户信息。从营销活动、试乘试驾等自动建档的潜客需要您完善客户信息":"手动创建潜客档案，填写客户姓名电话等信息，越完整越好哦"});break;case"1":this.$message({showClose:!0,message:"回访并确定潜客个性化需求，意向越完整越好；并按照O/H/A/B/C的标准给客户意向分级"});break;case"2":this.$refs.callbackAlert.updateHeight();break;case"3":this.$message({showClose:!0,message:"潜客的定期回访，持续跟踪，回访记录在案；通过回访挖掘客户需求，展现产品优势，预约客户到店试驾"});break;case"4":this.$message({showClose:!0,message:"记录潜客试乘试驾记录；试乘试驾能进一步建立客户信心，激发客户购买欲！"});break;case"5":this.$message({showClose:!0,message:"记录战败情况，以便分析战败原因，提高成交率；战败信息需销售经理确认"});break;case"6":this.$message({showClose:!0,message:"记录签约信息，签约信息需销售经理确认"});break}}}},Ie=_e,we=Object(w["a"])(Ie,a,r,!1,null,null,null);t["a"]=we.exports},"2ace":function(e,t,i){},"2b9a":function(e,t,i){},"2bb3":function(e,t,i){"use strict";var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={getNavInfo:function(e,t,i){o.a.get(s["g"].customerService.queryNavInfo,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryList:function(e,t,i){o.a.get(s["g"].customerService.WorkSheetList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryBaseInfo:function(e,t,i){o.a.get(s["g"].customerService.WorkSheetBaseInfo,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},updateBaseInfo:function(e,t,i){o.a.put(s["g"].customerService.WorkSheetBaseInfo,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createBaseInfo:function(e,t,i){o.a.post(s["g"].customerService.WorkSheetBaseInfo,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},deleteBaseInfo:function(e,t,i){o.a.delete(s["g"].customerService.WorkSheetBaseInfo,{data:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},querySponsorList:function(e,t,i){o.a.get(s["g"].customerService.WorkSheetSponsorList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},querySponsorGroupList:function(e,t,i){o.a.get(s["g"].customerService.WorkSheetSponsorGroupList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryMemberList:function(e,t,i){o.a.get(s["g"].customerService.WorkSheetMemberList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryKpi:function(e,t,i){o.a.get(s["g"].customerService.WorkSheetKpi,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))}}},"2c2c":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"logistic-following"},[i("div",{staticClass:"product-info"},[i("div",{staticClass:"img"},[i("img",{attrs:{src:e.image||e.defaultProductImg}})]),i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v("物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s(e.logisticState))])]),i("div",{staticClass:"i-item"},[e._v("物流公司："+e._s(e.logistics))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]),e.shippingTraces&&e.shippingTraces.length>0?i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0)])]):e._e()])},r=[],o=i("5530"),s=i("2f62"),n=i("1ab1"),l=i("c596"),d=i("e83a"),c=i.n(d),p={name:"LogisticsFollowing",components:{},data:function(){return{shippingSn:"",defaultProductImg:c.a,shippingTraces:[],state:"",logistics:"",expressSn:"",image:""}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(s["c"])(["getUser"])),Object(s["c"])("Order",["curApplySaleItem","orderInfo"])),{},{logisticState:function(){switch(this.state){case"0":return"无轨迹";case"1":return"已揽收";case"2":return"在途中";case"201":return"到达派件城市";case"3":return"签收";case"4":return"问题件";default:return""}}}),props:{sn:{type:String,default:""}},watch:{},created:function(){},methods:{getLogisticsInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.sn};n["a"].get(l["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.state=t.shipping.state,e.image=t.shipping.shippingItems.length>0?t.shipping.shippingItems[0].image:"",e.logistics=t.shipping.logistics,e.expressSn=t.shipping.expressSn,e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}},m=p,u=(i("b4cc"),i("2877")),f=Object(u["a"])(m,a,r,!1,null,null,null);t["a"]=f.exports},"2d15":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"complaint-base-info"},[i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("车牌号")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.plateNumber,callback:function(t){e.plateNumber=t},expression:"plateNumber"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("车主姓名")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.carOwnerName,callback:function(t){e.carOwnerName=t},expression:"carOwnerName"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("手机号码")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.phoneNumber,callback:function(t){e.phoneNumber=t},expression:"phoneNumber"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("车辆识别代号")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.carVinNo,callback:function(t){e.carVinNo=t},expression:"carVinNo"}})],1),i("div",{staticClass:"accused-info-item"},[i("span",{staticClass:"label"},[e._v("发动机号")]),i("el-input",{staticClass:"el-input",attrs:{disabled:!0},model:{value:e.engineNo,callback:function(t){e.engineNo=t},expression:"engineNo"}})],1)])},r=[],o=(i("b0c0"),i("d3b7"),i("f36f")),s=i("1ab1"),n=i("c596"),l={name:"complaint-base-info",data:function(){return{loading:!1,plateNumber:"",carOwnerName:"",phoneNumber:"",carVinNo:"",engineNo:""}},props:{itemId:{type:String,default:function(){return""}}},components:{BizGrid:o["a"]},computed:{},watch:{itemId:function(e,t){e&&this.getAccusedInfo()}},methods:{getAccusedInfo:function(){var e=this;this.loading=!0;var t={id:this.itemId};s["a"].get(n["g"].vehicleMgmt.VehicleBaseInfo_appeal,t).then((function(t){console.log("通过id查询",t),e.loading=!1;var i=t.data;e.plateNumber=i.plateNumber,e.carOwnerName=i.respondent.name,e.phoneNumber=i.respondent.mobile,e.carVinNo=i.car.vin,e.engineNo=i.engineNumber})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage)})).finally((function(){}))}},created:function(){this.getAccusedInfo()}},d=l,c=(i("a5c8"),i("2877")),p=Object(c["a"])(d,a,r,!1,null,null,null);t["a"]=p.exports},"2ee5":function(e,t,i){},"2fd9":function(e,t,i){"use strict";var a=i("e700"),r=i.n(a);r.a},3077:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-info-t"},[e.isEdit&&e.judgeState?i("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}},[i("template",{slot:"operation"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.handleSuccess,"on-error":e.handleError,data:{type:"0"},"file-list":e.fileList,name:"file",action:"/admin/file/uploads.jhtml"}},[e.invoiceMode?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"}},[e._v("上传电子发票")]):e._e()],1)],1)],2):e._e(),i("div",{staticClass:"invoiceInfo"},[e._v("发票详情")]),i("el-form",{ref:"formModel",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"发票类型",prop:"invoiceType"}},[i("el-select",{attrs:{placeholder:"请选择发票类型",disabled:!0},on:{change:e.invoiceTypeChange},model:{value:e.formModel.invoiceType,callback:function(t){e.$set(e.formModel,"invoiceType",t)},expression:"formModel.invoiceType"}},[i("el-option",{attrs:{label:"个人",value:"0"}}),i("el-option",{attrs:{label:"增值税普通发票",value:"1"}}),i("el-option",{attrs:{label:"增值税专用发票",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"发票抬头",prop:"invoiceTitle"}},[i("el-input",{attrs:{placeholder:"请输入发票抬头",disabled:!0},model:{value:e.formModel.invoiceTitle,callback:function(t){e.$set(e.formModel,"invoiceTitle",t)},expression:"formModel.invoiceTitle"}}),""===e.formModel.invoiceState?i("el-button",{attrs:{size:"mini",type:""},on:{click:e.selectInvoice}},[e._v("选择")]):e._e()],1),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"纳税人识别号",prop:"code"}},[i("el-input",{attrs:{placeholder:"请输入纳税人识别号",disabled:!0},model:{value:e.formModel.code,callback:function(t){e.$set(e.formModel,"code",t)},expression:"formModel.code"}})],1):e._e(),i("el-form-item",{attrs:{label:"发票金额",prop:"invoiceAmount"}},[i("el-input",{attrs:{placeholder:"请输入发票金额",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.invoiceAmount,callback:function(t){e.$set(e.formModel,"invoiceAmount",t)},expression:"formModel.invoiceAmount"}})],1),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"注册地址",prop:"registerAddress"}},[i("el-input",{attrs:{placeholder:"请输入注册地址",disabled:!0},model:{value:e.formModel.registerAddress,callback:function(t){e.$set(e.formModel,"registerAddress",t)},expression:"formModel.registerAddress"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"注册电话",prop:"registerMobile"}},[i("el-input",{attrs:{placeholder:"请输入注册电话",disabled:!0},model:{value:e.formModel.registerMobile,callback:function(t){e.$set(e.formModel,"registerMobile",t)},expression:"formModel.registerMobile"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[i("el-input",{attrs:{placeholder:"请输入开户银行",disabled:!0},model:{value:e.formModel.bank,callback:function(t){e.$set(e.formModel,"bank",t)},expression:"formModel.bank"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"银行账户",prop:"account"}},[i("el-input",{attrs:{placeholder:"请输入银行账户",disabled:!0},model:{value:e.formModel.account,callback:function(t){e.$set(e.formModel,"account",t)},expression:"formModel.account"}})],1):e._e(),i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("获取方式")]),i("el-form-item",{attrs:{label:"发票类型",prop:"invoiceMode"}},[i("el-radio-group",{attrs:{disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.invoiceMode,callback:function(t){e.$set(e.formModel,"invoiceMode",t)},expression:"formModel.invoiceMode"}},[i("el-radio",{attrs:{label:"0"}},[e._v("纸质发票")]),i("el-radio",{attrs:{label:"1"}},[e._v("电子发票")])],1)],1),"1"===e.formModel.invoiceMode?i("div",[i("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[i("el-input",{attrs:{placeholder:"请输入电子邮箱",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.email,callback:function(t){e.$set(e.formModel,"email",t)},expression:"formModel.email"}})],1)],1):e._e(),"0"===e.formModel.invoiceMode?i("div",[i("el-form-item",{attrs:{label:"是否邮寄",prop:"needMail"}},[i("el-radio-group",{attrs:{disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.needMail,callback:function(t){e.$set(e.formModel,"needMail",t)},expression:"formModel.needMail"}},[i("el-radio",{attrs:{label:"1"}},[e._v("是")]),i("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),"1"===e.formModel.needMail?i("div",[i("el-form-item",{attrs:{label:"收票人",prop:"contacts"}},[i("el-input",{attrs:{placeholder:"请输入收票人",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.contacts,callback:function(t){e.$set(e.formModel,"contacts",t)},expression:"formModel.contacts"}})],1),i("el-form-item",{attrs:{label:"收件人电话",prop:"mobile"}},[i("el-input",{attrs:{maxlength:"13",placeholder:"请输入电话",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),i("el-form-item",{attrs:{label:"所在地",prop:"area"}},[i("biz-area-select",{attrs:{areaId:e.formModel.area.id,disabled:""!==e.formModel.invoiceState},on:{areaChanged:e.areaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{placeholder:"请输入地址",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1)],1):e._e()],1):e._e(),e.logs&&e.logs.length>0?i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("发票进度")]):e._e(),e.logs&&e.logs.length>0?i("div",{staticClass:"order-track-new",staticStyle:{"padding-left":"30px","padding-top":"15px"}},[i("el-steps",{attrs:{direction:"vertical","finish-status":"success",space:"30px"}},[i("el-step",{attrs:{title:"已申请",status:"1"===e.active?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,a){return"0"===t.type?i("div",{key:a,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)]),i("el-step",{attrs:{title:"已开票",status:"2"===e.active1?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,a){return"1"===t.type?i("div",{key:a,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)]),i("el-step",{attrs:{title:"已邮寄",status:"3"===e.active2?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,a){return"2"===t.type?i("div",{key:a,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)])],1)],1):e._e(),"1"===e.formModel.invoiceMerged?i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("合并明细")]):e._e(),"1"===e.formModel.invoiceMerged?i("div",{staticStyle:{"margin-top":"10px"}},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{size:"small",data:e.formModel.purchaseOrders,stripe:"",border:"","highlight-current-row":"","tooltip-effect":"dark"}},[i("el-table-column",{attrs:{prop:"sn",label:"订单编号"}}),i("el-table-column",{attrs:{prop:"amount",label:"订单金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.amount))]}}],null,!1,2031540991)})],1)],1):e._e()],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showInvoiceExpress,center:"","append-to-body":"","custom-class":"close-invoice-dialog",title:"发票邮寄",width:"500px"},on:{"update:visible":function(t){e.showInvoiceExpress=t}}},[i("div",{staticClass:"reson-container"},[i("span",{staticStyle:{"margin-left":"40px"}},[e._v("请填写发票邮寄的物流公司和快递单号信息")]),i("el-form",{ref:"formModel",staticStyle:{"margin-top":"40px"},attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"快递公司",prop:"express"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择快递公司"},on:{change:e.expressChange},model:{value:e.formModel.express,callback:function(t){e.$set(e.formModel,"express",t)},expression:"formModel.express"}},e._l(e.deliverys,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"快递单号",prop:"expressCode"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入快递单号"},model:{value:e.formModel.expressCode,callback:function(t){e.$set(e.formModel,"expressCode",t)},expression:"formModel.expressCode"}})],1)],1)],1),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showInvoiceExpress=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange()}}},[e._v("确定")])],1)]),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showLogisticsFollowing,center:"","append-to-body":"","custom-class":"close-follow-dialog",title:"物流跟踪"},on:{"update:visible":function(t){e.showLogisticsFollowing=t}}},[i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[e.getTraces?i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0):e._e(),this.shippingTraces&&0===this.shippingTraces.length?i("ul",[i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v(" 物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s("暂无轨迹"))])]),i("div",{staticClass:"i-item"},[e._v("快递公司："+e._s(e.expressName))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]):e._e()])])]),i("el-dialog",{attrs:{visible:e.dialogVisiableInvoice,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableInvoice=t}}},[i("invoice-info-dialog",{on:{selectedInvoice:e.selectedInvoice}})],1),i("el-dialog",{staticClass:"show-file",attrs:{"append-to-body":"",visible:e.previewInvoice,width:"950px"},on:{close:function(t){e.previewInvoice=!1}}},[i("div",[i("img",{style:e.imgStyle,attrs:{src:e.formModel.path,alt:""}})]),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.returnUpload,"on-error":e.handleError,data:{type:"0"},"file-list":e.fileList,limit:1,name:"file",action:"/admin/file/uploads.jhtml"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重新上传")])],1)],1)]),i("el-dialog",{staticClass:"before-upload",attrs:{"append-to-body":"",visible:e.uploadReview,width:"950px"},on:{close:e.cancelUplod}},[i("div",[i("img",{style:e.imgStyle,attrs:{src:e.formModel.path,alt:""}})]),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.uploadReview=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.conformUpload}},[e._v("确定上传")])],1)])],1)},r=[],o=(i("4160"),i("d81d"),i("b0c0"),i("d3b7"),i("159b"),i("5530")),s=i("04d3"),n=i("f36f"),l=i("e42c"),d=i("ce2e"),c=i("5719"),p=i("2f62"),m=i("1ab1"),u={name:"invoiceInfo",props:{itemId:{type:String},orderIds:{type:Array},userId:{type:String},price:{type:String},invoiceInfoId:{type:String},invoiceId:{type:String},open:{type:Boolean,default:function(){return!0}},isEdit:{type:Boolean,default:function(){return!0}},fileList:{type:Array,default:function(){return[]}}},components:{BizHeader:s["d"],BizGrid:n["a"],InvoiceInfoDialog:c["a"],BizAreaSelect:d["a"]},data:function(){var e=this;return{loading:!1,formLoading:!1,isFirst:!0,expressName:"",expressSn:"",active:"",active1:"",active2:"",active3:"",showInvoiceExpress:!1,showLogisticsFollowing:!1,dialogVisiableInvoice:!1,shippingSn:"",shippingTraces:[],previewInvoice:!1,uploadReview:!1,logs:[],formModel:{id:"",invoiceType:"",invoiceTitle:"",invoiceState:"",price:"",code:"",registerAddress:"",registerMobile:"",bank:"",account:"",invoiceMode:"0",invoiceAmount:"",createDate:"",needMail:"0",contacts:"",mobile:"",area:{id:"1568"},address:"",express:"",expressCode:"",freight:"",zipCode:"",email:"",path:""},operations:[{label:"确认提交",name:"save",type:"primary",disabled:!1,class:"show"},{label:"撤销",name:"cancel",type:"primary",disabled:!1,class:"hidden"}],deliverys:[],rules:{mobile:[{required:!0,message:"电话不能少于5位",trigger:"blur",min:5},{pattern:/^[-0-9]*$/,message:"请输入数字",trigger:"blur"}],invoiceType:[{required:!0,message:"请选择发票类型",trigger:"blur"}],invoiceTitle:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],invoiceAmount:[{required:!0,message:"请输入发票金额",trigger:"blur"}],code:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入注册地址",trigger:"blur"}],registerMobile:[{required:!0,message:"请输入注册电话",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],account:[{required:!0,message:"请输入银行账户",trigger:"blur"}],needMail:[{required:!0,message:"请选择是否邮寄",trigger:"blur"}],contacts:[{required:!0,message:"请输入收票人",trigger:"blur"}],number:[{required:!0,message:"请输入电话",trigger:"blur"}],area:[{required:!0,message:"请选择所在地",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){e.formModel.area.id?a():a(new Error("请选择所在地"))}}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],express:[{required:!0,message:"请选择快递公司",trigger:"blur"}],expressCode:[{required:!0,message:"请输入快递单号",trigger:"blur"}],freight:[{required:!0,message:"请输入物流费用",trigger:"blur"}]}}},watch:{open:function(e,t){this.formModel=this.clear(),console.log("11111111111111===="),e&&(this.$refs.formModel.clearValidate(),console.log(this.invoiceInfoId),console.log(this.invoiceId),this.invoiceInfoId&&!this.invoiceId?this.getInvoiceInit():this.getList())}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(p["c"])(["getUser"])),Object(p["c"])("Order",["orderConfim","orderInfo","curInvoice","payment","defaultReceive","clickItemSelect"])),{},{judgeState:function(){if(console.log("invoiceState="+this.formModel.invoiceState),null!==this.formModel.invoiceState&&""!==this.formModel.invoiceState){if("2"===this.formModel.invoiceState||"3"===this.formModel.invoiceState)return!1;if("0"===this.formModel.needMail&&"1"===this.formModel.invoiceState)return!1}return!0},invoiceMode:function(){return"1"===this.formModel.invoiceMode&&"0"===this.formModel.invoiceState},showShippinig:function(){return"1"===this.formModel.invoiceState||"2"===this.formModel.invoiceState||"3"===this.formModel.invoiceState},getTraces:function(){return!!(this.shippingTraces&&this.shippingTraces.length>0)},imgStyle:function(){return{width:"100%",height:"100%"}}}),mounted:function(){console.log("22222222222222===="),this.invoiceInfoId&&!this.invoiceId?this.getInvoiceInit():this.getList()},methods:Object(o["a"])(Object(o["a"])({},Object(p["d"])("Order",["updateClickItemSelect"])),{},{clear:function(){return{id:"",invoiceType:"",invoiceTitle:"",invoiceState:"",price:"",code:"",registerAddress:"",registerMobile:"",bank:"",account:"",invoiceAmount:"",createDate:"",invoiceMode:"0",needMail:"0",contacts:"",mobile:"",area:{id:"1568"},address:"",express:"",expressCode:"",freight:"",zipCode:"",email:"",path:""}},cancelUplod:function(){this.uploadReview=!1},handleSuccess:function(e,t,i){console.log(e+"1111111"),e.fis&&e.fis[0]&&(this.fileList.push({uid:t.uid,url:e.fis[0].url}),this.formModel.path=e.fis[0].url),this.uploadReview=!0},conformUpload:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="1",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("上传成功"),e.getList(),e.$emit("operationSuccess"),e.uploadReview=!1}),(function(t){e.$message.warning(t.errorMessage)}))},handleError:function(e,t,i){e?this.$message.warning(e):this.$message.warning("发生错误")},selectedInvoice:function(e){this.dialogVisiableInvoice=!1,this.formModel.invoiceType=e.invoiceType,this.formModel.invoiceTitle=e.invoiceTitle,this.formModel.code=e.code,this.formModel.registerAddress=e.registerAddress,this.formModel.registerMobile=e.registerMobile,this.formModel.bank=e.bank,this.formModel.account=e.account,this.formModel.mobile=e.mobile,this.formModel.contacts=e.contacts,this.formModel.area.id=e.area.id,this.formModel.address=e.address},selectInvoice:function(){this.updateClickItemSelect(!0),this.dialogVisiableInvoice=!0},cancel:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="4",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("撤销成功"),e.formModel.invoiceState="",e.getList(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},expressInfo:function(){var e=this,t={userId:this.userId,shippingSn:this.shippingSn,shopId:this.getUser.shop.id};m["a"].get("/admin/purchaseOrder/logistics.jhtml",t).then((function(t){console.log("物流追踪",t),e.shippingTraces=t.shipping.shippingTraces,e.expressSn=t.shipping.expressSn,e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage),e.loading=!1}))},statusChange:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="2",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("保存成功"),e.showInvoiceExpress=!1,e.getList(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},returnUpload:function(e,t,i){var a=this;e.fis&&e.fis[0]&&(this.fileList.push({uid:t.uid,url:e.fis[0].url}),this.formModel.path=e.fis[0].url,this.formModel.orderId=this.itemId,this.formModel.invoiceState="1",l["a"].invoiceDetailUpdate(this.formModel,(function(e){a.$message.success("上传成功"),a.previewInvoice=!1,a.getList(),a.$emit("operationSuccess")}),(function(e){a.$message.warning(e.errorMessage)})))},invoiceTypeChange:function(){this.$refs.formModel.clearValidate("invoiceType")},expressChange:function(){this.$refs.formModel.clearValidate("express")},getLogs:function(){var e=this,t={userId:this.userId,orderId:this.itemId};m["a"].get("/rest/invoice/invoice.jhtml",t).then((function(t){e.logs=t.invoice.logs,e.active="",e.active1="",e.active2="",t.invoice.logs&&t.invoice.logs.length>0&&t.invoice.logs.forEach((function(t,i){"0"===t.type&&(e.active="1"),"1"===t.type&&(e.active1="2"),"2"===t.type&&(e.active2="3")})),e.shippingSn=t.invoice.shippingSn})).catch((function(e){console.log("ERR: ",e)})).finally((function(){}))},areaChanged:function(e){this.formModel.area.id=e,this.isFirst&&(this.formModel.area.id="1568",this.isFirst=!1)},getInvoiceInit:function(){var e=this;l["a"].invoiceInfoDefault({userId:this.userId||""},(function(t){e.formModel=Object.assign(e.clear(),t.invoiceInfo),console.log("this.price"),e.$set(e.formModel,"invoiceAmount",e.price),e.$set(e.formModel,"invoiceMode","0"),e.operations[1].class="hidden",e.operations[0].label="确认提交",e.logs=[],e.formModel.area.id||(e.formModel.area.id="1568")}),(function(t){console.log(t),e.loading=!1,console.log("code错误")}))},getList:function(){var e=this;this.loading=!0,this.showForm=!1,l["a"].invoiceByOrder({orderId:this.itemId||""},(function(t){e.formModel=Object.assign(e.clear(),t.invoice),"0"===e.formModel.invoiceMode?e.formModel.invoiceState?"0"===e.formModel.invoiceState?(e.operations[0].label="确认已开票",e.operations[0].class="show",e.operations[1].label="撤销",e.operations[1].class="show"):"1"===e.formModel.invoiceState?(e.operations[0].label="邮寄",e.operations[0].class="show",e.operations[1].class="hidden"):"2"===e.formModel.invoiceState?(e.operations[0].label="物流跟踪",e.operations[0].class="show",e.operations[1].class="hidden"):"4"===e.formModel.invoiceState?(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].label="已撤销",e.operations[1].class="show",e.formModel.invoiceState=""):e.operations[1].class="hidden":(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].class="hidden"):e.formModel.invoiceState?"0"===e.formModel.invoiceState?(e.operations[0].label="",e.operations[1].class="show",e.operations[1].label="撤销",e.operations[0].class="hidden"):"5"===e.formModel.invoiceState?(e.operations[0].label="查看电子发票",e.operations[0].class="show",e.operations[1].class="hidden"):"4"===e.formModel.invoiceState?(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].label="已撤销",e.operations[1].class="show",e.formModel.invoiceState=""):e.operations[1].class="hidden":(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].class="hidden"),e.formModel.area.id||(e.formModel.area.id="1568"),e.deliverys=t.deliverys,e.deliverys.map((function(i){i.id===t.invoice.express&&(e.expressName=i.name)})),e.getLogs(),e.loading=!1}),(function(t){e.loading=!1,e.formModel=e.clear()}))},handleOperate:function(e){this[e]()},save:function(){var e=this;this.$refs.formModel.validate((function(t){t&&(e.loading=!0,console.log("id="),console.log(e.formModel.id),e.$set(e.formModel,"orderIds",e.orderIds),e.formModel.id?("0"===e.formModel.invoiceMode?"0"===e.formModel.invoiceState?e.formModel.invoiceState="1":"1"===e.formModel.invoiceState?e.formModel.invoiceState="2":"2"===e.formModel.invoiceState?e.formModel.invoiceState="3":e.formModel.invoiceState="0":"0"===e.formModel.invoiceState?e.formModel.invoiceState="1":"4"!==e.formModel.invoiceState&&""!==e.formModel.invoiceState||(e.formModel.invoiceState="0"),"0"===e.formModel.invoiceMode?"2"===e.formModel.invoiceState?(e.formModel.express="",e.formModel.expressCode="",e.loading=!1,e.showInvoiceExpress=!0):"3"===e.formModel.invoiceState?(e.formModel.invoiceState="2",e.expressInfo(),e.showLogisticsFollowing=!0):(e.formModel.orderId=e.itemId,l["a"].invoiceDetailUpdate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage),"3"===e.formModel.invoiceState?e.formModel.invoiceState="2":"2"===e.formModel.invoiceState?e.formModel.invoiceState="1":(e.formModel.invoiceState,e.formModel.invoiceState="0")}))):"5"===e.formModel.invoiceState?(e.getList(),e.previewInvoice=!0,e.loading=!1):(e.formModel.orderId=e.itemId,l["a"].invoiceDetailUpdate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})))):(e.formModel.invoiceState="0",e.formModel.orderId=e.itemId,l["a"].invoiceDetailCreate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))))}))}})},f=u,h=(i("f58e"),i("2877")),g=Object(h["a"])(f,a,r,!1,null,null,null);t["a"]=g.exports},3101:function(e,t,i){"use strict";var a=i("7ba1"),r=i.n(a);r.a},3193:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vehicle-base-info__content"},[i("el-form",{ref:"form",attrs:{size:"small","label-width":"130px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("el-collapse-item",{attrs:{title:"基本信息",name:"1"}},[i("el-form-item",{attrs:{label:"车牌号码",prop:"plateNumber"}},[i("el-input",{attrs:{placeholder:"请输入车牌号码"},model:{value:e.formModel.plateNumber,callback:function(t){e.$set(e.formModel,"plateNumber",t)},expression:"formModel.plateNumber"}})],1),i("el-form-item",{attrs:{label:"品牌"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌",filterable:""},on:{change:e.handleBrandChange},model:{value:e.formModel.brand,callback:function(t){e.$set(e.formModel,"brand",t)},expression:"formModel.brand"}},e._l(e.brandList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"系列"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列",filterable:""},on:{change:e.handleSeriesChange},model:{value:e.formModel.series,callback:function(t){e.$set(e.formModel,"series",t)},expression:"formModel.series"}},e._l(e.seriesList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"车型"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型"},model:{value:e.formModel.type,callback:function(t){e.$set(e.formModel,"type",t)},expression:"formModel.type"}},e._l(e.modeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),e.memberId?e._e():i("el-form-item",{attrs:{label:"所有者"}},[i("people-picker",{attrs:{contentField:"userName"},model:{value:e.formModel.member,callback:function(t){e.$set(e.formModel,"member",t)},expression:"formModel.member"}})],1),e.memberId?e._e():i("el-form-item",{attrs:{label:"电话"}},[i("el-input",{attrs:{type:"phone",maxlength:"12",readonly:"",placeholder:"请输入电话"},model:{value:e.formModel.member.mobile,callback:function(t){e.$set(e.formModel.member,"mobile",t)},expression:"formModel.member.mobile"}})],1),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.state,callback:function(t){e.$set(e.formModel,"state",t)},expression:"formModel.state"}},e._l(e.stateList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",[i("div",{attrs:{slot:"label"},slot:"label"},[e._v(" 注册日期 "),i("el-button",{directives:[{name:"popover",rawName:"v-popover:onTimePop",arg:"onTimePop"}],attrs:{type:"text",size:"small"}},[i("i",{staticClass:"iconfont el-icon-question"})]),i("el-popover",{ref:"onTimePop",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"您可在车辆行驶证上查询到此信息"}})],1),i("el-date-picker",{attrs:{type:"date",placeholder:"选择注册日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.onTime,callback:function(t){e.$set(e.formModel,"onTime",t)},expression:"formModel.onTime"}})],1),i("el-form-item",{attrs:{label:"行驶证"}},[i("div",{staticClass:"image-content"},[i("BizAvatarUploaderNew",{model:{value:e.formModel.carLicense.positiveImage,callback:function(t){e.$set(e.formModel.carLicense,"positiveImage",t)},expression:"formModel.carLicense.positiveImage"}}),i("BizAvatarUploaderNew",{model:{value:e.formModel.carLicense.backgroundImage,callback:function(t){e.$set(e.formModel.carLicense,"backgroundImage",t)},expression:"formModel.carLicense.backgroundImage"}}),i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!!e.formModel.id,expression:"!!formModel.id"}],attrs:{type:"primary",disabled:!e.formModel.carLicense.positiveImage&&!e.formModel.carLicense.backgroundImage,size:"mini"},on:{click:e.reject}},[e._v("驳回")])],1)],1)]),i("el-form-item",{attrs:{label:"营运"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","inactive-color":"#d9d9d9","active-color":"#87d068"},model:{value:e.formModel.isCV,callback:function(t){e.$set(e.formModel,"isCV",t)},expression:"formModel.isCV"}})],1),i("el-form-item",{attrs:{label:"登记的交管所"}},[i("el-input",{attrs:{maxlength:"16",placeholder:"请输入车辆所登记的交管所"},model:{value:e.formModel.trafficControl,callback:function(t){e.$set(e.formModel,"trafficControl",t)},expression:"formModel.trafficControl"}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.formModel.remarks,callback:function(t){e.$set(e.formModel,"remarks",t)},expression:"formModel.remarks"}})],1)],1),i("el-collapse-item",{attrs:{title:"所属店铺",name:"8"}},[i("el-table",{attrs:{size:"small",data:e.formModel.shops}},[i("el-table-column",{attrs:{label:"店铺名称",prop:"name"}}),i("el-table-column",{attrs:{label:"详细地址",prop:"address"}}),i("el-table-column",{attrs:{label:"销售电话",prop:"mobile"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleDeleteClick(t.row)}}},[e._v(" 删除 ")])]}}])})],1)],1),i("el-collapse-item",{attrs:{title:"技术信息",name:"2"}},[i("el-form-item",{attrs:{label:"车辆识别代号",prop:"vin"}},[i("div",{attrs:{slot:"label"},slot:"label"},[e._v(" 车辆识别代号 "),i("el-button",{directives:[{name:"popover",rawName:"v-popover:vinPop",arg:"vinPop"}],attrs:{type:"text",size:"small"}},[i("i",{staticClass:"iconfont el-icon-question"})]),i("el-popover",{ref:"vinPop",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"车辆识别代号，即车架号，具有对车辆的唯一识别性，因此可称为“汽车身份证”。您可在车辆行驶证上查询到此信息，也可打开发动机盖，在挡板上可看到此码。"}})],1),i("el-input",{attrs:{maxlength:"17",placeholder:"请输入车辆识别代号信息"},model:{value:e.formModel.vin,callback:function(t){e.$set(e.formModel,"vin",t)},expression:"formModel.vin"}})],1),i("el-form-item",{attrs:{label:"发动机号",prop:"engineNumber"}},[i("div",{attrs:{slot:"label"},slot:"label"},[e._v(" 发动机号 "),i("el-button",{directives:[{name:"popover",rawName:"v-popover:engineNumberPop",arg:"engineNumberPop"}],attrs:{type:"text",size:"small"}},[i("i",{staticClass:"iconfont el-icon-question"})]),i("el-popover",{ref:"engineNumberPop",attrs:{placement:"bottom-start",width:"300",trigger:"hover",content:"您可在车辆行驶证上查询到此信息"}})],1),i("el-input",{attrs:{placeholder:"请输入发动机号信息"},model:{value:e.formModel.engineNumber,callback:function(t){e.$set(e.formModel,"engineNumber",t)},expression:"formModel.engineNumber"}})],1),i("el-form-item",{attrs:{label:"车身颜色"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.bodyColor,callback:function(t){e.$set(e.formModel,"bodyColor",t)},expression:"formModel.bodyColor"}},e._l(e.colorList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"车牌颜色"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.plateColor,callback:function(t){e.$set(e.formModel,"plateColor",t)},expression:"formModel.plateColor"}},e._l(e.colorList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"燃油编号"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.fuelGrade,callback:function(t){e.$set(e.formModel,"fuelGrade",t)},expression:"formModel.fuelGrade"}},e._l(e.fuelGradeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"变速箱类型"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.transmissionType,callback:function(t){e.$set(e.formModel,"transmissionType",t)},expression:"formModel.transmissionType"}},e._l(e.transmissionTypeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"排放标准"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formModel.dischargeStandard,callback:function(t){e.$set(e.formModel,"dischargeStandard",t)},expression:"formModel.dischargeStandard"}},e._l(e.effluentStandardList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"生产日期"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择生产日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.productionTime,callback:function(t){e.$set(e.formModel,"productionTime",t)},expression:"formModel.productionTime"}})],1)],1),i("el-collapse-item",{attrs:{title:"终端信息",name:"3"}},[i("div",[i("biz-header",{attrs:{operations:e.ruleTableOperations},on:{operate:e.operateHandler}}),i("el-table",{staticClass:"cp-table",staticStyle:{width:"100%"},attrs:{data:e.formModel.terminals,size:"small"}},[i("el-table-column",{attrs:{prop:"terminalTypeName",label:"设备类型"}}),i("el-table-column",{attrs:{prop:"number",label:"设备编号"}}),i("el-table-column",{attrs:{prop:"title",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.rowEditClickHandler(t.row,i)}}},[e._v(" 编辑 ")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.rowDeleteClickHandler(i,t.row)}}},[e._v(" 删除 ")])]}}])})],1),i("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showRule,expression:"showRule"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[i("el-form",{ref:"ruleForm",attrs:{size:"small","label-width":"110px",model:e.ruleModel,rules:e.ruleRules}},[i("el-form-item",{attrs:{label:"设备编号",prop:"number"}},[i("el-autocomplete",{staticStyle:{width:"100%"},attrs:{value:e.ruleModel.number,"fetch-suggestions":e.handleRemote,placeholder:"请输入设备编号","trigger-on-focus":!1,"value-key":"number"},on:{select:e.handleNumberChange,input:e.handleNumberInput}})],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.systemList&&e.systemList.length>0,expression:"systemList && systemList.length > 0"}],attrs:{label:"电控系统"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleModel.diagnoseType,callback:function(t){e.$set(e.ruleModel,"diagnoseType",t)},expression:"ruleModel.diagnoseType"}},e._l(e.systemList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"通讯方式"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleModel.communicationType,callback:function(t){e.$set(e.ruleModel,"communicationType",t)},expression:"ruleModel.communicationType"}},e._l(e.commTypeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),i("biz-save-button",{staticStyle:{"margin-right":"0"},attrs:{operations:e.ruleOperations},on:{operate:e.operateHandler}})],1)],1)]),i("el-collapse-item",{attrs:{title:"销售信息",name:"4"}},[i("el-form-item",{attrs:{label:"车辆销售公司"}},[i("el-input",{attrs:{placeholder:"请输入车辆销售公司"},model:{value:e.formModel.carSalesData.salesCompany,callback:function(t){e.$set(e.formModel.carSalesData,"salesCompany",t)},expression:"formModel.carSalesData.salesCompany"}})],1),i("el-form-item",{attrs:{label:"车辆销售单号",prop:"salesContractNumber"}},[i("el-input",{attrs:{maxlength:"16",placeholder:"请输入车辆销售单号"},model:{value:e.formModel.carSalesData.salesContractNumber,callback:function(t){e.$set(e.formModel.carSalesData,"salesContractNumber",t)},expression:"formModel.carSalesData.salesContractNumber"}})],1),i("el-form-item",{attrs:{label:"购买日期",prop:"purchaseTime"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择购买日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.carSalesData.purchaseTime,callback:function(t){e.$set(e.formModel.carSalesData,"purchaseTime",t)},expression:"formModel.carSalesData.purchaseTime"}})],1),i("el-form-item",{attrs:{label:"是否贷款"}},[i("el-radio-group",{model:{value:e.formModel.carSalesData.loanType,callback:function(t){e.$set(e.formModel.carSalesData,"loanType",t)},expression:"formModel.carSalesData.loanType"}},[i("el-radio",{attrs:{label:"0"}},[e._v("是")]),i("el-radio",{attrs:{label:"1"}},[e._v("否")]),i("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),i("el-form-item",{attrs:{label:"销售公司电话",prop:"salesCompanyPhone"}},[i("el-input",{attrs:{type:"phone",maxlength:"12",placeholder:"请输入销售公司电话"},model:{value:e.formModel.carSalesData.salesCompanyPhone,callback:function(t){e.$set(e.formModel.carSalesData,"salesCompanyPhone",t)},expression:"formModel.carSalesData.salesCompanyPhone"}})],1),i("el-form-item",{attrs:{label:"销售员"}},[i("el-input",{attrs:{placeholder:"请输入销售员"},model:{value:e.formModel.carSalesData.salesStaff,callback:function(t){e.$set(e.formModel.carSalesData,"salesStaff",t)},expression:"formModel.carSalesData.salesStaff"}})],1),i("el-form-item",{attrs:{label:"销售员电话",prop:"salesStaffPhone"}},[i("el-input",{attrs:{type:"phone",maxlength:"13",placeholder:"请输入销售员电话"},model:{value:e.formModel.carSalesData.salesStaffPhone,callback:function(t){e.$set(e.formModel.carSalesData,"salesStaffPhone",t)},expression:"formModel.carSalesData.salesStaffPhone"}})],1)],1),i("el-collapse-item",{attrs:{title:"质保信息",name:"5"}},[i("el-form-item",{attrs:{label:"质保起始日期",prop:"purchaseTime"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择保起始日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",clearable:!1},model:{value:e.qualityAssuranceDate,callback:function(t){e.qualityAssuranceDate=t},expression:"qualityAssuranceDate"}})],1),i("div",{staticClass:"zbxx"},[i("el-form-item",{staticClass:"isRequired",attrs:{label:"质保期",prop:"qualityAssuranceTime"}},[i("el-input",{model:{value:e.formModel.carQualityAssurance.time,callback:function(t){e.$set(e.formModel.carQualityAssurance,"time",t)},expression:"formModel.carQualityAssurance.time"}},[i("template",{slot:"append"},[e._v("年")])],2)],1),i("el-form-item",{attrs:{label:"或","label-width":"40px",prop:"qualityAssuranceDrivingRange"}},[i("el-input",{model:{value:e.formModel.carQualityAssurance.drivingRange,callback:function(t){e.$set(e.formModel.carQualityAssurance,"drivingRange",t)},expression:"formModel.carQualityAssurance.drivingRange"}},[i("template",{slot:"append"},[e._v("公里")])],2)],1)],1),i("el-form-item",{attrs:{label:"质保截止日期",prop:"purchaseTime"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择质保截止日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:""},model:{value:e.qualityAssuranceEndDate,callback:function(t){e.qualityAssuranceEndDate=t},expression:"qualityAssuranceEndDate"}})],1)],1),i("el-collapse-item",{attrs:{title:"保险信息",name:"6"}},[i("el-form-item",{attrs:{label:"投保公司"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择投保公司"},on:{change:e.handleInsuranceChange},model:{value:e.formModel.carInsurance.insuranceCompany,callback:function(t){e.$set(e.formModel.carInsurance,"insuranceCompany",t)},expression:"formModel.carInsurance.insuranceCompany"}},e._l(e.insuranceList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),i("el-form-item",{attrs:{label:"保单号码",prop:"insurancePolicyNumber"}},[i("el-input",{attrs:{maxlength:"20",placeholder:"请输入保单号码"},model:{value:e.formModel.carInsurance.insurancePolicyNumber,callback:function(t){e.$set(e.formModel.carInsurance,"insurancePolicyNumber",t)},expression:"formModel.carInsurance.insurancePolicyNumber"}})],1),i("el-form-item",{attrs:{label:"保单生效日期"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择保单生效日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.formModel.carInsurance.policyEffectiveDate,callback:function(t){e.$set(e.formModel.carInsurance,"policyEffectiveDate",t)},expression:"formModel.carInsurance.policyEffectiveDate"}})],1),i("el-form-item",{attrs:{label:"保单失效日期",prop:"policyExpiryDate"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择保单失效日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.formModel.carInsurance.policyExpiryDate,callback:function(t){e.$set(e.formModel.carInsurance,"policyExpiryDate",t)},expression:"formModel.carInsurance.policyExpiryDate"}})],1),i("el-form-item",{attrs:{label:"客服电话",prop:"customerServicePhone"}},[i("el-input",{attrs:{type:"phone",maxlength:"12"},model:{value:e.formModel.carInsurance.customerServicePhone,callback:function(t){e.$set(e.formModel.carInsurance,"customerServicePhone",t)},expression:"formModel.carInsurance.customerServicePhone"}})],1),i("el-form-item",{attrs:{label:"理赔员姓名"}},[i("el-input",{attrs:{placeholder:"请输入理赔员姓名"},model:{value:e.formModel.carInsurance.claimMemberName,callback:function(t){e.$set(e.formModel.carInsurance,"claimMemberName",t)},expression:"formModel.carInsurance.claimMemberName"}})],1),i("el-form-item",{attrs:{label:"理赔员电话",prop:"claimMemberPhone"}},[i("el-input",{attrs:{type:"phone",maxlength:"13",placeholder:"请输入理赔员电话"},model:{value:e.formModel.carInsurance.claimMemberPhone,callback:function(t){e.$set(e.formModel.carInsurance,"claimMemberPhone",t)},expression:"formModel.carInsurance.claimMemberPhone"}})],1),i("el-form-item",{attrs:{label:"保单详细信息"}},[i("el-input",{attrs:{placeholder:"请输入保单详细信息"},model:{value:e.formModel.carInsurance.insuranceDetails,callback:function(t){e.$set(e.formModel.carInsurance,"insuranceDetails",t)},expression:"formModel.carInsurance.insuranceDetails"}})],1),i("el-form-item",{attrs:{label:"保单说明"}},[i("el-input",{attrs:{placeholder:"请输入保单说明"},model:{value:e.formModel.carInsurance.policyDescription,callback:function(t){e.$set(e.formModel.carInsurance,"policyDescription",t)},expression:"formModel.carInsurance.policyDescription"}})],1)],1),i("el-collapse-item",{attrs:{title:"保养信息",name:"7"}},[i("el-form-item",{attrs:{label:"车辆里程(km)",prop:"nowDrivingRange"}},[i("el-input",{attrs:{"controls-position":"right",placeholder:"请输入车辆里程"},model:{value:e.formModel.drivingRange,callback:function(t){e.$set(e.formModel,"drivingRange",t)},expression:"formModel.drivingRange"}})],1),i("el-form-item",{attrs:{label:"保养日期"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择保养日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.carMaintain.happenDate,callback:function(t){e.$set(e.formModel.carMaintain,"happenDate",t)},expression:"formModel.carMaintain.happenDate"}})],1),i("el-form-item",{attrs:{label:"上次保养里程(km)",prop:"drivingRange"}},[i("el-input",{attrs:{"controls-position":"right",placeholder:"请输入上次保养里程"},model:{value:e.formModel.carMaintain.drivingRange,callback:function(t){e.$set(e.formModel.carMaintain,"drivingRange",t)},expression:"formModel.carMaintain.drivingRange"}})],1),i("el-form-item",{attrs:{label:"保养间隔里程(km)",prop:"drivingRangeGap"}},[i("el-input",{attrs:{"controls-position":"right"},model:{value:e.formModel.carMaintain.drivingRangeGap,callback:function(t){e.$set(e.formModel.carMaintain,"drivingRangeGap",t)},expression:"formModel.carMaintain.drivingRangeGap"}})],1)],1)],1)],1)],1)},r=[],o=(i("99af"),i("4160"),i("c975"),i("a434"),i("b0c0"),i("d3b7"),i("4d63"),i("ac1f"),i("25f0"),i("159b"),i("8330")),s=i("c365"),n=i("04d3"),l=i("c466"),d=i("0e5e"),c=i("c17f"),p=i("1ab1"),m={name:"VehicleBaseInfoContent",components:{BizSaveButton:o["a"],PeoplePicker:s["a"],BizHeader:n["d"],BizAvatarUploaderNew:c["b"]},data:function(){var e=this;return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},rules:{plateNumber:[{required:!0,message:"请输入车牌号码",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){var r=/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1,2}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/;r.test(e.formModel.plateNumber)?a():a(new Error("车牌号格式错误"))}}],vin:[{trigger:"blur",validator:function(t,i,a){e.formModel.vin&&e.$set(e.formModel,"vin",e.formModel.vin.toUpperCase());var r=/^[A-Z0-9]{17}$/;!e.formModel.vin||r.test(e.formModel.vin)?a():a(new Error("车辆识别代号格式错误"))}}],engineNumber:[{trigger:"blur",validator:function(t,i,a){e.formModel.engineNumber&&e.$set(e.formModel,"engineNumber",e.formModel.engineNumber.toUpperCase());var r=/^[a-zA-Z0-9]{6,14}$/;!e.formModel.engineNumber||r.test(e.formModel.engineNumber)?a():a(new Error("发动机号格式错误"))}}],salesContractNumber:[{trigger:"blur",validator:function(t,i,a){e.formModel.carSalesData&&e.formModel.carSalesData.salesContractNumber&&e.$set(e.formModel.carSalesData,"salesContractNumber",e.formModel.carSalesData.salesContractNumber.toUpperCase());var r=/^[A-Z0-9]*$/;e.formModel.carSalesData&&e.formModel.carSalesData.salesContractNumber&&!r.test(e.formModel.carSalesData.salesContractNumber)?a(new Error("车辆销售单号格式错误")):a()}}],salesStaffPhone:[{trigger:"blur",validator:function(t,i,a){var r=/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/;!e.formModel.carSalesData.salesStaffPhone||r.test(e.formModel.carSalesData.salesStaffPhone)?a():a(new Error("销售员电话格式错误"))}}],customerServicePhone:[{trigger:"blur",validator:function(t,i,a){var r=/^[0-9]\d*$/;!e.formModel.carInsurance.customerServicePhone||r.test(e.formModel.carInsurance.customerServicePhone)?a():a(new Error("客服电话格式错误"))}}],claimMemberPhone:[{trigger:"blur",validator:function(t,i,a){var r=/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/;!e.formModel.carInsurance.claimMemberPhone||r.test(e.formModel.carInsurance.claimMemberPhone)?a():a(new Error("理赔员电话格式错误"))}}],insurancePolicyNumber:[{trigger:"blur",validator:function(t,i,a){var r=/^[A-Z0-9]*$/;!e.formModel.carInsurance.insurancePolicyNumber||r.test(e.formModel.carInsurance.insurancePolicyNumber)?a():a(new Error("保单号码格式错误"))}}],policyExpiryDate:[{trigger:"blur",validator:function(t,i,a){e.formModel.carInsurance.policyExpiryDate&&e.formModel.carInsurance.policyEffectiveDate&&e.formModel.carInsurance.policyExpiryDate<=e.formModel.carInsurance.policyEffectiveDate?a(new Error("保单失效日期要晚于保单生效日期")):a()}}],purchaseTime:[{trigger:"blur",validator:function(t,i,a){e.formModel.carSalesData.purchaseTime&&e.formModel.productionTime&&e.formModel.carSalesData.purchaseTime<e.formModel.productionTime?a(new Error("购买日期要晚于生产日期")):a()}}],nowDrivingRange:[{trigger:"blur",validator:function(t,i,a){var r=new RegExp(/^\+?[0-9][0-9]*$/);e.formModel.drivingRange&&!r.test(e.formModel.drivingRange)?a(new Error("请输入整数")):a()}}],drivingRange:[{trigger:"blur",validator:function(t,i,a){var r=new RegExp(/^\+?[0-9][0-9]*$/);e.formModel.carMaintain.drivingRange&&!r.test(e.formModel.carMaintain.drivingRange)?a(new Error("请输入整数")):a()}}],drivingRangeGap:[{trigger:"blur",validator:function(t,i,a){var r=new RegExp(/^\+?[0-9][0-9]*$/);e.formModel.carMaintain.drivingRangeGap&&!r.test(e.formModel.carMaintain.drivingRangeGap)?a(new Error("请输入整数")):a()}}],qualityAssuranceTime:[{required:!1,message:"请输入质保期",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){var r=new RegExp(/^\+?[1-9][0-9]*$/);e.formModel.carQualityAssurance.time&&!r.test(e.formModel.carQualityAssurance.time)?a(new Error("请输入一个大于0的整数")):e.formModel.carQualityAssurance.time?a():a(new Error("请输入质保期"))}}],qualityAssuranceDrivingRange:[{required:!1,message:"请输入里程",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){var r=new RegExp(/^\+?[1-9][0-9]*$/);e.formModel.carQualityAssurance.drivingRange&&!r.test(e.formModel.carQualityAssurance.drivingRange)?a(new Error("请输入一个大于0的整数")):e.formModel.carQualityAssurance.drivingRange?a():a(new Error("请输入里程"))}}]},shopList:[],brandList:[],seriesList:[],modeList:[],stateList:[],transmissionTypeList:[],plateNumberTypeList:[],colorList:[],fuelGradeList:[],effluentStandardList:[],systemList:[],commTypeList:[],insuranceList:[],formModel:this.getDefaultModel(),activeNames:["1"],ruleTableOperations:[{label:"新建",name:"addOperate",type:"primary"}],showRule:!1,ruleModel:this.getDefaultRuleModel(),ruleOperations:[{label:"取消",name:"cancelRuleOperate"},{label:"保存",name:"saveRuleOperate",type:"primary",auth:["admin:car.edit"]}],ruleRules:{number:[{required:!0,trigger:"blur",validator:function(t,i,a){e.ruleModel.number?a():a(new Error("请选择终端"))}},{trigger:["blur"],validator:function(t,i,a){e.checkNumber(e.ruleModel.number,a)}}]},selectLoading:!1,terminalList:[]}},props:{itemId:{type:Object,default:function(){return{id:""}}},memberId:{type:Object}},created:function(){this.queryShopList(),this.queryBrandList(),this.queryInsuranceList(),this.queryDimList(),this.effluentStandardList=["国Ⅰ","国Ⅱ","国Ⅲ","国Ⅳ","国Ⅴ","国Ⅵ","欧Ⅰ","欧Ⅱ","欧Ⅲ","欧Ⅳ","欧Ⅴ"],this.commTypeList=[{id:"0",name:"自动切换"},{id:"1",name:"网络"},{id:"2",name:"蓝牙"},{id:"3",name:"WIFI"},{id:"4",name:"GPRS"},{id:"5",name:"3G"},{id:"6",name:"4G"}],this.deletedRules=[]},methods:{reject:function(){var e=this;p["a"].put("/admin/car/carLicense/state.jhtml",{id:this.formModel.id}).then((function(t){e.$message.success("驳回成功"),e.$emit("operationSuccess"),e.formModel.carLicense.positiveImage="",e.formModel.carLicense.backgroundImage=""})).catch((function(t){console.log(t),e.$message.warning(t.errorMessage)}))},handleDeleteClick:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,p["a"].delete("/admin/car/relateShop.jhtml",{shopId:e.id,id:t.itemId.id}).then((function(i){t.formModel.shops.splice(t.formModel.shops.indexOf(e),1),t.$message.success("删除成功"),t.$emit("operationSuccess")})).catch((function(e){console.log(e),console.log("code错误"),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},queryShopList:function(){var e=this;d["a"].queryShopList({},(function(t){e.shopList=t.storeList}),(function(e){console.log(e),console.log("code错误")}))},queryBrandList:function(){var e=this;d["a"].queryBrandList({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;d["a"].querySeriesList({brand:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;d["a"].queryTypeList({series:e,brand:this.formModel.brand},(function(e){t.modeList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryInsuranceList:function(){var e=this;d["a"].queryInsuranceList({},(function(t){e.insuranceList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryDimList:function(){var e=this;d["a"].queryDimList({},(function(t){e.stateList=t.carStateList,e.transmissionTypeList=t.transmissionTypeList,e.plateNumberTypeList=t.plateNumberTypeList,e.colorList=t.colorList,e.fuelGradeList=t.fuelGradeList}),(function(e){console.log(e),console.log("code错误")}))},getSaveParams:function(){var e=[];e=e.concat(this.formModel.terminals);var t=this.deletedRules,i=[];return e.forEach((function(e){i.push(e.number)})),t.forEach((function(t){i.indexOf(t.number)<0&&e.push({terminalType:t.terminalType,type:t.type})})),this.formModel.carQualityAssurance.qualityAssuranceDate=this.qualityAssuranceDate,this.formModel.carQualityAssurance.qualityAssuranceEndDate=this.qualityAssuranceEndDate,{id:this.formModel.id,plateNumber:this.formModel.plateNumber,brand:this.formModel.brand,series:this.formModel.series,type:this.formModel.type,member:this.memberId?this.memberId:this.formModel.member,shop:this.formModel.shop,state:this.formModel.state,onTime:this.formModel.onTime,isCV:this.formModel.isCV,trafficControl:this.formModel.trafficControl,remarks:this.formModel.remarks,drivingRange:this.formModel.drivingRange,carshipId:this.formModel.carshipId,vin:this.formModel.vin,engineNumber:this.formModel.engineNumber,bodyColor:this.formModel.bodyColor,plateColor:this.formModel.plateColor,fuelGrade:this.formModel.fuelGrade,carLicense:this.formModel.carLicense,transmissionType:this.formModel.transmissionType,dischargeStandard:this.formModel.dischargeStandard,productionTime:this.formModel.productionTime,terminals:e,carSalesData:this.formModel.carSalesData,carInsurance:this.formModel.carInsurance,carMaintain:this.formModel.carMaintain,carQualityAssurance:this.formModel.carQualityAssurance}},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return{member:{id:"",name:""},bodyColor:"2",plateColor:"0",fuelGrade:"1",carLicense:{positiveImage:"",backgroundImage:""},transmissionType:"2",dischargeStandard:"国5",shop:{id:"",name:""},engineNumber:"",carSalesData:{salesCompanyPhone:"",salesStaffPhone:""},carInsurance:{insuranceCompany:"",customerServicePhone:"",claimMemberPhone:""},carMaintain:{drivingRangeGap:""},carQualityAssurance:{drivingRange:"60000",qualityAssuranceDate:"",qualityAssuranceEndDate:"",time:"3",carId:"",id:""},terminals:[]}},operateHandler:function(e){this[e]()},handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.formModel,"series",""),this.$set(this.formModel,"type","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.formModel,"type","")},save:function(){var e=this;this.$refs.form.validate((function(t,i){return t?e.formModel.backgroundImage&&!e.formModel.positiveImage||!e.formModel.backgroundImage&&e.formModel.positiveImage?(e.$message.warning("驾驶证正反面图片都需要上传"),!1):(e.$emit("on-loading",!0),void(e.formModel.id?d["a"].update(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.$emit("on-loading",!1)}),(function(t){e.$message.warning(t.errorMessage),e.$emit("on-loading",!1)})):d["a"].add(e.getSaveParams(),(function(t){e.$message.success("保存成功"),e.$emit("operationSuccess"),e.$emit("on-loading",!1)}),(function(t){e.$message.warning(t.errorMessage),e.$emit("on-loading",!1)})))):(e.$message.warning("车辆信息输入有误，请修改"),e.activeNames=["1","2","4","5","6"],!1)}))},handleInsuranceChange:function(e){var t=this;this.insuranceList.forEach((function(i){i.name===e&&t.$set(t.formModel.carInsurance,"customerServicePhone",i.phoneNumber)}))},getDefaultRuleModel:function(){return{number:"",diagnoseType:"",communicationType:"0"}},rowEditClickHandler:function(e,t,i){t.stopPropagation(),this.systemList=e.diagnoseTypes?e.diagnoseTypes:[],this.terminalList=[],this.ruleModel=Object.assign({},e),this.showRule=!0,this.$refs.ruleForm.resetFields()},rowDeleteClickHandler:function(e,t){var i=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.formModel.terminals.forEach((function(e,a){e.number===t.number&&i.formModel.terminals.splice(a,1)})),i.deletedRules.push(t)}))},addOperate:function(){this.resetRuleModel(),this.showRule=!0,this.$refs.ruleForm.resetFields()},resetRuleModel:function(){this.systemList=[],this.terminalList=[],this.ruleModel=this.getDefaultRuleModel()},cancelRuleOperate:function(){this.showRule=!1},saveRuleOperate:function(){var e=this;this.$refs.ruleForm.validate((function(t,i){if(!t)return!1;var a=!1;e.formModel.terminals.forEach((function(t,i){t.number===e.ruleModel.number&&(e.formModel.terminals.splice(i,1,e.getRuleParams()),a=!0)})),a||e.formModel.terminals.push(e.getRuleParams()),e.showRule=!1}))},getRuleParams:function(){return Object.assign({},this.ruleModel)},checkNumber:function(e,t){var i=this;d["a"].queryTerminalInfo({sn:e,carId:this.itemId.id,shopId:window.top.SHOP_ID},(function(e){i.systemList=e.diagnoseTypes?e.diagnoseTypes:[],e.diagnoseType=i.systemList.length>0?i.systemList[0]:"";for(var a=0;a<i.systemList.length;a++)if(i.systemList[a]===i.ruleModel.diagnoseType){e.diagnoseType=i.systemList[a];break}Object.assign(i.ruleModel,e),t()}),(function(e){console.log("ERROR_QUERY",e),i.systemList=[],i.$set(i.ruleModel,"diagnoseType",""),t(new Error(e.errorMessage))}))},handleNumberChange:function(e){this.$set(this.ruleModel,"number",e.number),this.$refs.ruleForm.clearValidate()},handleNumberInput:function(e){this.$set(this.ruleModel,"number",e)},handleRemote:function(e,t){e?this.queryTerminalList(e,t):this.terminalList=[]},queryTerminalList:function(e,t){var i=this;this.$emit("on-loading",!0),d["a"].queryTerminalList({number:e},(function(e){t(e.dataList),i.$emit("on-loading",!1)}),(function(e){console.log(e),console.log("code错误"),i.$emit("on-loading",!1)}))}},computed:{point:{get:function(){return{lng:this.formModel.lngBaidu,lat:this.formModel.latBaidu}},set:function(e){e&&(this.formModel.lngBaidu=e.lng,this.formModel.latBaidu=e.lat)}},qualityAssuranceDate:{get:function(){return!this.formModel.carQualityAssurance.qualityAssuranceDate&&this.formModel.onTime?this.formModel.onTime:this.formModel.carQualityAssurance.qualityAssuranceDate},set:function(e){e&&(this.formModel.carQualityAssurance.qualityAssuranceDate=e)}},qualityAssuranceEndDate:{get:function(){return!this.formModel.carQualityAssurance.qualityAssuranceEndDate&&this.qualityAssuranceDate&&this.formModel.carQualityAssurance.time?l["a"].lastNYearDate(this.qualityAssuranceDate,this.formModel.carQualityAssurance.time):this.formModel.carQualityAssurance.qualityAssuranceEndDate},set:function(e){e&&(this.formModel.carQualityAssurance.qualityAssuranceEndDate=e)}}},watch:{itemId:function(e,t){var i=this;this.$refs.form.$el.scrollTop=0,console.log(e),e.id?(this.$emit("on-loading",!0),d["a"].query({carId:e.id,carShipId:e.carShipId},(function(e){var t=Object.assign(i.getDefaultModel(),e.car);i.formModel=t,i.querySeriesList(i.formModel.brand),i.queryTypeList(i.formModel.series),i.$refs.form.resetFields(),i.activeNames=["1"],i.deletedRules=[],i.$emit("on-loading",!1),i.showRule=!1}),(function(e){console.log(e),console.log("code错误"),i.$emit("on-loading",!1)}))):(this.resetModel(),this.$refs.form.$el.scrollTop=0,this.$refs.form.resetFields(),this.activeNames=["1"])}}},u=m,f=(i("d158"),i("2877")),h=Object(f["a"])(u,a,r,!1,null,null,null);t["a"]=h.exports},"349b":function(e,t,i){},3772:function(e,t,i){},"3dcd":function(e,t,i){"use strict";var a=i("765f"),r=i.n(a);r.a},"3f4e":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"communi-card-records"},[i("biz-flex-table",{ref:"table",attrs:{tableData:e.tableData,checkable:!1}},[i("el-table-column",{attrs:{label:"商品名",prop:"rechargePackageName"}}),i("el-table-column",{attrs:{label:"余额",prop:"balance"}}),i("el-table-column",{attrs:{label:"时间",prop:"rechargeTime"}}),i("el-table-column",{attrs:{label:"状态",prop:"state"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatState(t.row.state))+" ")]}}])}),i("el-table-column",{attrs:{label:"充值方式",prop:"payment"}})],1)],1)},r=[],o=i("04d3"),s=i("ec50"),n={name:"CommuniCardRecords",props:{itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{tableData:[]}},components:{BizFlexTable:o["c"]},methods:{refresh:function(){var e=this,t={simId:this.itemId.id,pageSize:1e3,pageNumber:1};s["a"].queryRecordsList(t,(function(t){e.tableData=t.content}),(function(e){}))},formatState:function(e){switch(e){case"0":return"充值失败";case"1":return"充值成功";default:return""}},setHeight:function(){var e=this;setTimeout((function(){e.$refs.table.doHeight()}),100)}},mounted:function(){this.refresh()},watch:{itemId:function(){this.refresh()}}},l=n,d=i("2877"),c=Object(d["a"])(l,a,r,!1,null,null,null);t["a"]=c.exports},"3f67":function(e,t,i){},"408a":function(e,t,i){var a=i("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=a(e))throw TypeError("Incorrect invocation");return+e}},"40ab":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"product-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),i("el-form",{attrs:{inline:!0,disabled:!e.isEdit}},[i("el-form-item",{staticClass:"subTotal",attrs:{label:"合计:",prop:"totalFee"}},[e._v("￥"+e._s(e.totalFee?e.totalFee:"0"))])],1),i("biz-list",{key:Math.random(),ref:"table",attrs:{tableData:e.tableData,height:"100%",loading:e.loading}},[i("el-table-column",{attrs:{prop:"productName",label:"商品名称","min-width":"100"}}),i("el-table-column",{attrs:{prop:"price",label:"采购单价(元)","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input",{attrs:{size:"small",disabled:!e.isEdit},on:{change:function(i){return e.priceChange(t.row.price)}},model:{value:t.row.price,callback:function(i){e.$set(t.row,"price",i)},expression:"scope.row.price"}})],1)])}}])}),i("el-table-column",{attrs:{prop:"amount",label:"退货数量","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input-number",{staticStyle:{width:"90px"},attrs:{size:"mini",min:1,disabled:!e.isEdit},on:{change:function(i){return e.amountChange(t.row.amount)}},model:{value:t.row.amount,callback:function(i){e.$set(t.row,"amount",i)},expression:"scope.row.amount"}})],1)])}}])}),i("el-table-column",{attrs:{prop:"totalFee",label:"金额(元)","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[e._v(e._s(t.row.amount?(Number(t.row.amount)*Number(t.row.price)).toFixed(2):""))])])}}])}),i("el-table-column",{attrs:{prop:"depotId",label:"仓库","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{attrs:{placeholder:"请选择类型",size:"mini",disabled:!e.isEdit},model:{value:t.row.depotId,callback:function(i){e.$set(t.row,"depotId",i)},expression:"scope.row.depotId"}},e._l(e.storeList,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}])}),e.isEdit?i("el-table-column",{attrs:{prop:"date",label:"操作",type:"index","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteHandeler(t)}}},[e._v("删除")])],1)])}}],null,!1,2138999389)}):e._e()],1),i("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"选择商品",visibility:e.showDialog,tableData:e.giftList,pagination:e.dialogPagination,filters:e.dialogFilters,selectionKeys:e.selectedGiftIds},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.dialogFilterDataChange,selectionChange:e.selectionChange}},[i("el-table-column",{attrs:{property:"fullName",label:"商品名称",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-two-column"},[i("img",{attrs:{src:t.row.image||e.DefaultImg,onerror:e.errorImg}}),i("div",{staticClass:"biz-two-row"},[i("div",{staticStyle:{"margin-left":"10px","font-size":"14px"}},[e._v(e._s(t.row.name))]),i("div",{staticStyle:{"margin-left":"10px"}},[e._v("编号："+e._s(t.row.sn))]),i("div",{staticStyle:{"margin-left":"10px"}},[e._v("规格："+e._s(t.row.fullName&&-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:""))])])])])}}])}),i("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),i("el-table-column",{attrs:{label:"库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.realStock))])]}}])})],1)],1)},r=[],o=(i("99af"),i("4160"),i("c975"),i("d81d"),i("a434"),i("a9e3"),i("b680"),i("d3b7"),i("25f0"),i("159b"),i("b85c")),s=i("5530"),n=i("7558"),l=i("8330"),d=i("f36f"),c=i("2f62"),p=i("c596"),m=i("1ab1"),u=i("af3f"),f=i("f3ac"),h=i.n(f),g={name:"ProductInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},returnId:{type:String}},data:function(){return{dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},selectedGiftList:[],selectedGiftIds:[],showDialog:!1,DefaultImg:h.a,dialogFilters:[{type:"input",placeholder:"请输入编号或商品名",name:"searchbar",value:""}],giftList:[],loading:!1,open:!1,totalFee:"",height:"585",tableData:[],restaurants:[],selections:[],itemDatas:[],dialogTableVisible:!1,storeList:[],selectionList:[],title:"",operations:[{label:"新增商品",name:"addProduct",type:"primary"},{label:"保存",name:"save",type:"primary"}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:n["a"],BizGrid:d["a"],BizSaveButton:l["a"],BizDialogSelector:u["a"]},watch:{itemId:function(e){this.tableData=[],this.totalFee="",this.storeList=[],this.itemId&&this.getList(),this.queryStoreHouseList()},returnId:function(e){this.tableData=[],this.totalFee="",this.storeList=[],this.returnId&&this.getList(),this.queryStoreHouseList()}},mounted:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},methods:Object(s["a"])(Object(s["a"])({},Object(c["c"])(["getUser"])),{},{addProduct:function(){this.getGiftList(),this.selectedGiftIds.splice(0,this.selectedGiftIds.length),this.selectedGiftList.splice(0,this.selectedGiftList.length),this.showDialog=!0},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.getGiftList()},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.getGiftList()},dialogFilterDataChange:function(e){this.dialogFilters=e,this.dialogPagination.currentPage=1,this.getGiftList()},getGiftList:function(){var e=this,t={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||""};m["a"].get(p["g"].commodity.getCommodityList,t).then((function(t){e.giftList=t.content,e.dialogPagination.total=Number(t.total)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},selectionChange:function(e){var t=this;e.forEach((function(e){-1===t.selectionList.indexOf(e)&&t.selectionList.push(e)}))},confirmedProduct:function(e){var t=this;this.selectedGiftIds=e.concat(),this.selectedGiftList=[],this.selectionList.map((function(e){-1!==t.selectedGiftIds.indexOf(e.id)&&(e.amount="1",e.productName=e.fullName,t.selectedGiftList.push(e))}));this.selectedGiftList.map((function(e){Number(e.amount)*Number(e.price)})),this.selectedGiftList.forEach((function(e){t.handleSelect(e)})),this.storeList=[],this.queryStoreHouseList()},operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.getList()},operationSuccess:function(){this.getList()},getList:function(){var e=this;this.loading=!0;var t={id:this.itemId||this.returnId,shopId:window.top.SHOP_ID||""};m["a"].get(p["g"].invoicing.purchaseReturnApplyMgmt.shopPurchaseReturnApplyItems,t).then((function(t){e.tableData=t.itemList,e.totalFee=t.data.totalFee})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},queryStoreHouseList:function(){var e=this;this.loading=!0;var t={shopId:window.top.SHOP_ID||""};m["a"].get(p["g"].invoicing.storeHouseMgmt.shopDepotList,t).then((function(t){var i,a=Object(o["a"])(t.dataList);try{for(a.s();!(i=a.n()).done;){var r=i.value;"1"===r.enabled&&e.storeList.push(r)}}catch(s){a.e(s)}finally{a.f()}})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},handleSelect:function(e){var t=!1;if(e.productId=e.id,e.id="",this.totalFee=(Number(this.totalFee)+Number(e.amount)*Number(e.price)).toFixed(2),0!==this.tableData.length){for(var i=0;i<this.tableData.length;i++)if(this.tableData[i].productId===e.productId){this.tableData[i].amount=(Number(this.tableData[i].amount)+1).toString(),t=!0;break}t||this.tableData.push(e)}else this.tableData.push(e)},deleteHandeler:function(e){var t=this;""===e.row.id?this.tableData.splice(e.$index,1):this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,m["a"].delete(p["g"].invoicing.purchaseReturnApplyMgmt.shopPurchaseReturnApplyItem,{ids:[e.row.id]}).then((function(e){t.$message.success("删除成功"),t.getList()})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))})),this.totalFee=(Number(this.totalFee)-Number(e.row.price)*Number(e.row.amount)).toFixed(2)},save:function(){var e=this;this.itemDatas=this.tableData.map((function(t){return{id:t.id||"",billId:e.itemId||e.returnId,productId:t.productId?t.productId:t.id,amount:t.amount||"",price:t.price||"",depotId:t.depotId||"",productName:t.fullName,specId:t.specId||"",specValue:t.specValue||"",totalFee:t.amount*t.price||"",categoryId:t.categoryId,categoryName:t.categoryName}}));var t=!1;if(this.tableData.forEach((function(i){-1!==String(i.amount).indexOf(".")&&(e.$message.warning("数量不能为小数"),t=!0),""!==i.price&&""!==i.depotId&&void 0!==i.depotId||(e.$message.warning("商品信息不完整!"),t=!0)})),t)return!1;var i={itemDatas:this.itemDatas};m["a"].post(p["g"].invoicing.purchaseReturnApplyMgmt.shopPurchaseReturnApplyItem,i).then((function(t){e.$message.success("保存成功"),e.$emit("setOrderItems",e.itemDatas),e.$emit("operationSuccess"),e.getList(),e.loading=!1})).catch((function(t){e.loading=!1,e.getList(),e.$message.warning(t.errorMessage)}))},amountChange:function(e){var t=0;this.tableData.map((function(e){t+=Number(e.amount)*Number(e.price)})),this.totalFee=t?t.toFixed(2):""},priceChange:function(e){var t=0;this.tableData.map((function(e){t+=Number(e.amount)*Number(e.price)})),this.totalFee=t?t.toFixed(2):""},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()}})},b=g,v=(i("78c2"),i("2877")),y=Object(v["a"])(b,a,r,!1,null,null,null);t["a"]=y.exports},"40ae":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-editor",style:e.style},[i("div",{staticStyle:{display:"none"}},[i("el-upload",{ref:"imageUploader",attrs:{multiple:"",accept:"image/*",action:e.serverUrl,"show-file-list":!1,name:"file",data:e.fileData0,"on-success":e.uploadSuccess}}),i("el-upload",{ref:"videoUploader",attrs:{accept:"video/*",action:e.serverUrl,"show-file-list":!1,name:"file",data:e.fileData3,"before-upload":e.beforeUpload,"on-progress":e.handleProgress,"on-success":e.uploadSuccess}}),i("video",{ref:"videoTool"})],1),i("toolbar",{ref:"toolbar",class:{disabledStyle:e.disabled},attrs:{toolbars:e.toolbars},on:{"on-editor-execCommand":e.execCommand}}),0!==e.percentage?i("el-progress",{attrs:{slot:"header","text-inside":!0,"stroke-width":18,percentage:e.percentage},slot:"header"}):e._e(),i("editor-body",{attrs:{canPaste:e.canPaste,value:e.value,height:e.height,width:e.width,config:e.config,disabled:e.disabled},on:{input:e.onInput,ready:e.init}})],1)},r=[],o=(i("99af"),i("c975"),i("a15b"),i("baa5"),i("b0c0"),i("a9e3"),i("25eb"),i("d3b7"),i("b85c")),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"editor-body",style:e.style},[i("div",{attrs:{id:e.id}})])},n=[],l=(i("4160"),i("fb6a"),i("b64b"),i("4d63"),i("ac1f"),i("25f0"),i("466d"),i("5319"),i("159b"),i("96cf"),i("1da1")),d=i("d4ec"),c=i("bee2"),p=i("1ab1"),m=function(){function e(){Object(d["a"])(this,e),this.listeners={}}return Object(c["a"])(e,[{key:"on",value:function(e,t){void 0===this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"emit",value:function(e){this.listeners[e]&&this.listeners[e].forEach((function(e){return e()}))}}]),e}(),u={name:"UeditorWrap",data:function(){return{imgList:[],reg:new RegExp(/<img [^>]* src=['"](http[s]*:\/\/[^'"]+)[^>]*>/g,"i"),id:"editor"+Math.random().toString().slice(-10),editor:null,status:0,initValue:"",defaultConfig:{toolbars:[],initialFrameWidth:null,autoHeightEnabled:!1,initialFrameHeight:300,enableAutoSave:!1,wordCount:!1,elementPathEnabled:!1,scaleEnabled:!1,UEDITOR_HOME_URL:"./static/ueditorh/"}}},props:{canPaste:{type:Boolean,default:function(){return!0}},value:{type:String,default:""},config:{type:Object,default:function(){return{}}},height:{type:String},width:{type:String},toolbar:{type:Array,default:function(){return[]}},disabled:{type:Boolean,defualt:function(){return!1}}},components:{},computed:{mixedConfig:function(){return Object.assign({},this.defaultConfig,this.config)},style:function(){var e={};return this.height&&(e.height=this.height),this.width&&(e.width=this.width),e}},methods:{initEditor:function(){var e=this;this.$nextTick((function(){e.editor=window.UE.getEditor(e.id,e.mixedConfig),e.editor.addListener("ready",(function(){e.status=2,e.editor.setContent(e.initValue),e.$emit("ready",e.editor),e.editor.addListener("contentChange",(function(){e.$emit("input",e.editor.getContent())})),e.editor.addListener("beforepaste",function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(i,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.canPaste||(a.html=""),setTimeout((function(){e.getImgList()}),50);case 2:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}())}))}))},checkDependencies:function(){var e=this;return new Promise((function(t,i){var a=!!window.UE&&!!window.UEDITOR_CONFIG&&0!==Object.keys(window.UEDITOR_CONFIG).length&&!!window.UE.getEditor;a?t():window.loadEnv?window.loadEnv.on("scriptsLoaded",(function(){t()})):(window.loadEnv=new m,e.loadConfig().then((function(){return e.loadCore()})).then((function(){t(),window.loadEnv.emit("scriptsLoaded")})))}))},loadConfig:function(){var e=this;return new Promise((function(t,i){if(window.UE&&window.UEDITOR_CONFIG&&0!==Object.keys(window.UEDITOR_CONFIG).length)t();else{var a=document.createElement("script");a.type="text/javascript",a.src=e.mixedConfig.UEDITOR_HOME_URL+"ueditor.config.js",document.getElementsByTagName("head")[0].appendChild(a),a.onload=function(){window.UE&&window.UEDITOR_CONFIG&&0!==Object.keys(window.UEDITOR_CONFIG).length?t():console.error("加载ueditor.config.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!\n",a.src)}}}))},loadCore:function(){var e=this;return new Promise((function(t,i){if(window.UE&&window.UE.getEditor)t();else{var a=document.createElement("script");a.type="text/javascript",a.src=e.mixedConfig.UEDITOR_HOME_URL+"ueditor.all.min.js",document.getElementsByTagName("head")[0].appendChild(a),a.onload=function(){window.UE&&window.UE.getEditor?t():console.error("加载ueditor.all.min.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!\n",a.src)}}}))},setContent:function(e){e===this.editor.getContent()||this.editor.setContent(e)},getImgList:function(){var e=this.editor.getContent(),t=/<img[^>]* src=['"](http[s]*:\/\/[^'"]+)[^>]*>/g;this.imgList=e.match(t)||[]},setNewImg:function(e){var t=this,i=e.match(/src=['"]?([^'"]*)['"]?/i)[1];i=i.replace(/(\?|#)[^'"]*/,"");var a={url:i};p["a"].post("/admin/file/downloadFromNet.jhtml",a).then((function(i){var a=t.editor.getContent();a=a.replace(e,'<img src="'.concat(i.path,'" style="max-width: 100%;">')),t.$emit("input",a)}))}},beforeDestroy:function(){this.editor&&this.editor.destroy&&this.editor.destroy()},watch:{value:{handler:function(e){var t=this;switch(this.status){case 0:this.status=1,this.initValue=e,this.checkDependencies().then((function(){return t.initEditor()}));break;case 1:this.initValue=e;break;case 2:this.setContent(e),setTimeout((function(){t.getImgList()}),50);break;default:break}},immediate:!0},imgList:function(e){var t,i=Object(o["a"])(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.setNewImg(a)}}catch(r){i.e(r)}finally{i.f()}},disabled:function(e){e?this.editor.setDisabled():this.editor.setEnabled()}}},f=u,h=(i("c708"),i("2877")),g=Object(h["a"])(f,s,n,!1,null,null,null),b=g.exports,v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-editor-toolbar"},e._l(e.toolbars,(function(t,a){return i("div",{key:a,staticClass:"toolbar-row"},e._l(t,(function(t,r){return i("div",{key:r,staticClass:"toolitem"},["toolbtn"===t.type?i("ToolButton",{attrs:{toolbar:t},on:{"on-toolbutton-click":e.handleButtonClick}}):e._e(),"toolcolorpicker"===t.type?i("ToolColorPicker",{ref:"picker",refInFor:!0,attrs:{toolbar:t},on:{"on-toolpicker-click":e.handleButtonClick}}):e._e(),"toolselect"===t.type?i("ToolSelect",{ref:"picker",refInFor:!0,attrs:{toolbar:t},on:{"on-toolselect-click":e.handleButtonClick}}):e._e(),"toolinput"===t.type?i("ToolInput",{ref:"inputPicker",refInFor:!0,attrs:{toolbar:t},on:{"on-toolinput-click":e.handleButtonClick}}):e._e(),"separator"===t.type?i("span",{key:a+"|"+r,staticClass:"toolseparator"}):e._e()],1)})),0)})),0)},y=[],_={bind:function(e,t,i){function a(i){if(e.contains(i.target))return!1;t.expression&&t.value(i)}e.__vueClickOutside__=a,document.addEventListener("click",a)},update:function(){},unbind:function(e,t){document.removeEventListener("click",e.__vueClickOutside__),delete e.__vueClickOutside__}},I=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.onListHide,expression:"onListHide"}],class:"editor-toolbar-input toolbar-input-"+e.toolbar.name},[i("el-tooltip",{attrs:{"popper-class":"euditor-tip",effect:"dark",content:e.toolbar.title,placement:"top",enterable:!1}},[i("div",{staticClass:"btn-c",on:{click:e.onListShow}},[i("input",{ref:"input",staticClass:"edui-input",attrs:{type:"text"},domProps:{value:e.toolbar.value},on:{blur:e.checkInput,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.blur(t)}}}),i("div",{staticClass:"edui-button edui-select"},[i("i",{staticClass:"triangle"})])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"edui-toolbar-selectlist"},[i("ul",e._l(e.options,(function(t,a){return i("li",{key:a,on:{click:function(i){return e.onSelect(t.value)}}},[t.value==e.toolbar.value?i("i",{staticClass:"el-icon-check"}):e._e(),i("span",[e._v(e._s(t.label))])])})),0)])],1)},w=[],x={name:"EToolInput",props:{toolbar:Object},directives:{clickoutside:_},components:{},data:function(){return{visible:!1,options:[{label:"10px",value:"10px"},{label:"11px",value:"11px"},{label:"12px",value:"12px"},{label:"14px",value:"14px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"24px",value:"24px"},{label:"36px",value:"36px"}]}},methods:{onListShow:function(){this.visible=!this.visible},onListHide:function(){this.visible=!1},onSelect:function(e){this.$emit("on-toolinput-click",this.toolbar.name,e),this.onListHide()},checkInput:function(e){var t=e.target.value;this.$emit("on-toolinput-click",this.toolbar.name,t),this.onListHide()},blur:function(){this.$refs.input.blur()}}},S=x,C=(i("92cd"),Object(h["a"])(S,I,w,!1,null,null,null)),M=C.exports,k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:"editor-toolbar-btn toolbar-btn-"+e.toolbar.name+e.toolbar.value},[i("el-tooltip",{attrs:{"popper-class":"euditor-tip",effect:"dark",content:e.toolbar.title,placement:"top",enterable:!1}},[i("div",{staticClass:"toolbar-btn",class:{checked:this.checked},attrs:{disabled:e.disabled},on:{click:e.onClick}},[i("i",{staticClass:"weui_edui_icon"})])])],1)},T=[],D={name:"EToolButton",props:{toolbar:Object,imageFloatMask:Boolean},computed:{disabled:function(){return this.toolbar.disabled},checked:function(){return this.toolbar.checked}},methods:{onClick:function(){this.$emit("on-toolbutton-click",this.toolbar.name,this.toolbar.value)}},mounted:function(){}},$=D,O=(i("c820"),Object(h["a"])($,k,T,!1,null,null,null)),L=O.exports,z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.onListHide,expression:"onListHide"}],class:"editor-toolbar-select toolbar-select-"+e.toolbar.name},[i("el-tooltip",{attrs:{"popper-class":"euditor-tip",effect:"dark",content:e.toolbar.title,placement:"top",enterable:!1}},[i("div",{staticClass:"btn-c",on:{click:e.onListShow}},[i("div",{staticClass:"edui-button"},[i("i",{staticClass:"edui-toolbar-icon"})]),i("div",{staticClass:"edui-button edui-select"},[i("i",{staticClass:"triangle"})])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"edui-toolbar-selectlist"},[i("ul",e._l(e.options,(function(t,a){return i("li",{key:a,on:{click:function(i){return e.onSelect(t.value)}}},[t.value==e.toolbar.value?i("i",{staticClass:"el-icon-check"}):e._e(),i("span",[e._v(e._s(t.label))])])})),0)])],1)},P=[],R={name:"EToolSelect",props:{toolbar:Object},directives:{clickoutside:_},components:{},data:function(){return{visible:!1}},computed:{options:function(){return"lineheight"===this.toolbar.name?[{label:"1",value:1},{label:"1.5",value:1.5},{label:"1.75",value:1.75},{label:"2",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5}]:"indentboth"===this.toolbar.name?[{label:"无",value:"0px"},{label:"8",value:"8px"},{label:"16",value:"16px"},{label:"32",value:"32px"},{label:"48",value:"48px"}]:[]}},methods:{onListShow:function(){this.visible=!this.visible},onListHide:function(){this.visible=!1},onSelect:function(e){this.onListHide(),this.$emit("on-toolselect-click",this.toolbar.name,e)}}},N=R,A=(i("9056"),Object(h["a"])(N,z,P,!1,null,null,null)),B=A.exports,F=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.onListHide,expression:"onListHide"}],class:"editor-toolbar-color-picker toolbar-color-picker-"+e.toolbar.name},[i("el-tooltip",{attrs:{"popper-class":"euditor-tip",effect:"dark",content:e.toolbar.title,placement:"top",enterable:!1}},[i("div",{staticClass:"btn-c",on:{click:e.onListShow}},[i("div",{staticClass:"edui-button"},[i("i",{staticClass:"edui-toolbar-icon"}),i("i",{staticClass:"colorbar",style:{backgroundColor:this.toolbar.value}})]),i("div",{staticClass:"edui-button edui-select"},[i("i",{staticClass:"triangle"})])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"edui-toolpicker-panel"},[i("div",{staticClass:"recent_color color_box"},[i("p",{staticClass:"title"},[e._v("最近使用颜色")]),i("div",{}),i("div",{staticClass:"clear",attrs:{title:"清除颜色"},on:{click:e.removeColor}}),i("div",{staticClass:"item-wrapper"},e._l(e.recentColorList,(function(t,a){return i("div",{key:a,staticClass:"b-item",style:{backgroundColor:t},attrs:{title:t},on:{click:function(i){return e.onSelect(t)}}})})),0)]),i("div",{staticClass:"basic_color color_box"},[i("p",{staticClass:"title"},[e._v("基本色")]),i("div",{staticClass:"item-wrapper"},e._l(e.baseColorList,(function(t,a){return i("div",{key:a,staticClass:"b-item",style:{backgroundColor:t},attrs:{title:t},on:{click:function(i){return e.onSelect(t)}}})})),0)]),i("div",{staticClass:"input_color"},[i("div",{staticClass:"preview",style:{backgroundColor:e.toolbar.value},on:{click:function(t){return e.onSelect("#"+e.toolbar.value)}}}),i("div",{staticClass:"input_wrap"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.toolbar.value,expression:"toolbar.value"}],attrs:{type:"text"},domProps:{value:e.toolbar.value},on:{input:function(t){t.target.composing||e.$set(e.toolbar,"value",t.target.value)}}})]),i("div",{staticClass:"js_ok",on:{click:function(t){return e.onSelect(e.toolbar.value)}}},[e._v("确认")])])])],1)},E=[],U=(i("a434"),{name:"EToolColorPicker",props:{toolbar:Object},directives:{clickoutside:_},components:{},data:function(){return{visible:!1,baseColorList:["#ffffff","#ffd7d5","#ffdaa9","#fffed5","#d4fa00","#73fcd6","#a5c8ff","#ffacd5","#ff7faa","#d6d6d6","#ffacaa","#ffb995","#fffb00","#73fa79","#00fcff","#78acfe","#d84fa9","#ff4f79","#b2b2b2","#d7aba9","#ff6827","#ffda51","#00d100","#00d5ff","#0080ff","#ac39ff","#ff2941","#888888","#7a4442","#ff4c00","#ffa900","#3da742","#3daad6","#0052ff","#7a4fd6","#d92142","#000000","#7b0c00","#ff4c41","#d6a841","#407600","#007aaa","#021eaa","#797baa","#ab1942"]}},computed:{recentColorList:function(){var e=window.localStorage.recentColorList;return e=e?JSON.parse(e):[],e}},methods:{onListShow:function(){this.visible=!0},onListHide:function(){this.visible=!1},removeColor:function(){var e="backcolor"===this.toolbar.name?"background-color":"color";this.$emit("on-toolpicker-click","removeformat","",e),this.toolbar.value="#FFFFFF",this.onListHide()},onSelect:function(e){this.$emit("on-toolpicker-click",this.toolbar.name,e),this.onListHide(),this.storeRecentColor(e)},storeRecentColor:function(e){for(var t=this.recentColorList,i=t.unshift(e),a=1;a<i;a++)if(t[a]===e){t.splice(a,1),i--;break}i>8&&(t.length=9),window.localStorage.recentColorList=JSON.stringify(t)}}}),j=U,q=(i("51a1"),Object(h["a"])(j,F,E,!1,null,null,null)),V=q.exports,H={name:"toolbar-component",components:{ToolInput:M,ToolButton:L,ToolSelect:B,ToolColorPicker:V},directives:{clickoutside:_},props:{listVisible:Boolean,imageFloatMask:Boolean,toolbars:{type:Array,default:function(){return[[{name:"undo",title:"撤销",type:"toolbtn",status:"disabled"},{name:"redo",title:"重做",type:"toolbtn",status:"disabled"},{type:"separator"},{name:"fontsize",title:"字号",type:"toolinput"},{name:"blockquote",title:"引用",type:"toolbtn",status:"checked"},{name:"horizontal",title:"分割线",type:"toolbtn",status:""},{name:"removeformat",title:"清除格式",type:"toolbtn",status:""},{name:"formatmatch",title:"格式刷",type:"toolbtn",status:""},{name:"simpleupload",title:"图片上传",type:"toolbtn",status:""},{name:"insertvideo",title:"视频",type:"toolbtn",status:""}],[{name:"bold",title:"加粗",type:"toolbtn",status:"checked"},{name:"italic",title:"斜体",type:"toolbtn",status:"checked"},{name:"underline",title:"下划线",type:"toolbtn",status:""},{name:"forecolor",title:"字体颜色",type:"toolcolorpicker"},{name:"backcolor",title:"背景色",type:"toolcolorpicker"},{type:"separator"},{name:"indent",title:"首行缩进",type:"toolbtn",status:"checked"},{type:"separator"},{name:"justify",title:"居左对齐",type:"toolbtn",value:"left",status:"checked"},{name:"justify",title:"居中对齐",type:"toolbtn",value:"center",status:"checked"},{name:"justify",title:"居右对齐",type:"toolbtn",value:"right",status:"checked"},{name:"justify",title:"两端对齐",type:"toolbtn",value:"justify",status:"checked"},{type:"separator"},{name:"rowspacing",title:"段前距",type:"toolselect",value:"top"},{name:"rowspacing",title:"段后距",type:"toolselect",value:"bottom"},{name:"lineheight",title:"行间距",type:"toolselect"},{type:"separator"},{name:"orderedlist",title:"有序列表",type:"toolselect",prefix:"insert"},{name:"unorderedlist",title:"无序列表",type:"toolselect",prefix:"insert"},{type:"separator"},{name:"imagefloat",title:"默认",type:"toolbtn",value:"none",status:"checked disabled"},{name:"imagefloat",title:"左浮动",type:"toolbtn",value:"left",status:"checked disabled"},{name:"imagefloat",title:"右浮动",type:"toolbtn",value:"right",status:"checked disabled"},{name:"imagefloat",title:"居中",type:"toolbtn",value:"center",status:"checked disabled"},{name:"insertImage",title:"图片",type:"extra-button"}]]}}},data:function(){return{}},methods:{clearVisible:function(){this.$refs.picker.forEach((function(e){e.onListHide()})),this.$refs.inputPicker.forEach((function(e){e.onListHide()}))},handleButtonClick:function(e,t){this.$emit("on-editor-execCommand",e,t)}}},G=H,W=(i("6f9b"),Object(h["a"])(G,v,y,!1,null,null,null)),Z=W.exports,Y=i("016c").MP4Box,J={name:"biz-editor",components:{Toolbar:Z,EditorBody:b},props:{value:{type:String,default:""},height:{type:String,default:"300px"},width:{type:String,default:"360px"},hasImage:{type:Boolean,default:function(){return!0}},hasVideo:{type:Boolean,default:function(){return!1}},hasLink:{type:Boolean,default:function(){return!1}},canPaste:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{dataRatio:0,fileData0:{type:"0"},fileData3:{type:"2"},serverUrl:"/admin/file/uploads.jhtml",percentage:0,editor:null,isImage:!1,toolbarsData:[[{name:"fontsize",title:"字号",type:"toolinput",value:"16px"},{name:"bold",title:"加粗",type:"toolbtn",value:"",checked:!1},{name:"italic",title:"斜体",type:"toolbtn",value:"",checked:!1},{name:"underline",title:"下划线",type:"toolbtn",value:"",checked:!1},{type:"separator"},{name:"forecolor",title:"字体颜色",type:"toolcolorpicker",value:"#000000",visible:!0},{name:"backcolor",title:"背景色",type:"toolcolorpicker",value:"#FFFFFF",visible:!0}],[{name:"indent",title:"首行缩进",type:"toolbtn",value:"",checked:!1},{name:"indentboth",title:"两端缩进",type:"toolselect",label:"无",value:"0px"},{name:"justify",title:"居左对齐",type:"toolbtn",value:"left",checked:!1},{name:"justify",title:"居中对齐",type:"toolbtn",value:"center",checked:!1},{name:"justify",title:"居右对齐",type:"toolbtn",value:"right",checked:!1},{name:"justify",title:"两端对齐",type:"toolbtn",value:"justify",checked:!1},{name:"lineheight",title:"行间距",type:"toolselect",label:"1",value:1}]]}},computed:{config:function(){var e={};return e.initialFrameHeight=parseInt(this.height),e},style:function(){var e={};return this.width&&(-1!==this.width.indexOf("%")?e.width=this.width:e.width=parseInt(this.width)+2+"px"),e},toolbars:function(){var e=this.toolbarsData;return this.hasImage&&e[0].push({name:"uploadimage",title:"图片",type:"toolbtn",value:"",checked:!1}),this.hasVideo&&e[0].push({name:"uploadvideo",title:"视频",type:"toolbtn",value:"",checked:!1}),this.hasLink&&e[0].push({name:"link",title:"超链接",type:"toolbtn",value:"",checked:!1}),e}},watch:{},created:function(){},methods:{init:function(e){this.editor=e,this.editor.addListener("selectionchange",this.onSelectionChange),this.onFocus()},onFocus:function(){this.editor.addListener("focus",function(){console.log("focus"),this.$refs.toolbar.clearVisible()}.bind(this)),this.editor.addListener("blur",function(){console.log("blur"),this.$refs.toolbar.clearVisible()}.bind(this))},execCommand:function(e,t){"uploadimage"===e?(this.isImage=!0,this.$refs.imageUploader.$refs["upload-inner"].$refs.input.click()):"uploadvideo"===e?(this.isImage=!1,this.$refs.videoUploader.$refs["upload-inner"].$refs.input.click()):"link"===e?this.$emit("openLink"):this.editor.execCommand(e,t)},execCommandLink:function(e){this.editor.execCommand("link",{href:e})},onInput:function(e){this.$emit("input",e)},onSelectionChange:function(){var e,t=Object(o["a"])(this.toolbars);try{for(t.s();!(e=t.n()).done;){var i,a=e.value,r=Object(o["a"])(a);try{for(r.s();!(i=r.n()).done;){var s=i.value,n=["bold","italic","underline","indent"];if(-1!==n.indexOf(s.name)){var l=this.editor.queryCommandState(s.name);s.checked=1===l||!0===l}var d=["justify"];if(-1!==d.indexOf(s.name)){var c=this.editor.queryCommandValue(s.name);s.checked=!1,s.value===c&&(s.checked=!0)}var p=["forecolor","backcolor","lineheight","fontsize","indentboth"];if(-1!==p.indexOf(s.name)){var m=this.editor.queryCommandValue(s.name);s.value=m}}}catch(u){r.e(u)}finally{r.f()}}}catch(u){t.e(u)}finally{t.f()}},beforeUpload:function(e){var t=this;return e.size/1024/1024>100?(this.$emit("video-oversize",{message:"视频文件过大，最大支持100M",type:"warning"}),!1):"video/ogg"===e.type||"video/webm"===e.type||("video/mp4"===e.type?new Promise((function(i,a){var r="MediaSource"in window,o=function(e){for(var a=[],o=0;o<e.tracks.length;++o)a.push(e.tracks[o].codec);if(r){var s='video/mp4; codecs="'+a.join(", ")+'"';MediaSource.isTypeSupported(s)?i(!0):t.$emit("video-wrong-format",{message:"视频格式不支持,仅支持ogg、webm和部分mp4",type:"warning"})}},s=new FileReader;s.readAsDataURL(e),s.addEventListener("load",(function(){var e=s.result;t.$refs.videoTool.src=e,t.$refs.videoTool.addEventListener("loadedmetadata",(function(){var e=t.$refs.videoTool.videoWidth/t.$refs.videoTool.videoHeight;t.dataRatio=e<1.33?1.33:e}))}));var n=new FileReader;n.readAsArrayBuffer(e),n.addEventListener("loadend",(function(){var e=n.result;e.fileStart=0;var t=new Y;t.onReady=o,t.appendBuffer(e)}))})):(this.$emit("video-wrong-format",{message:"视频格式不支持,仅支持ogg、webm和部分mp4",type:"warning"}),!1))},handleProgress:function(e){this.percentage=Number.parseInt(e.percent)},uploadSuccess:function(e,t){this.isImage?this.editor.execCommand("inserthtml",'<img src="'.concat(e.fis[0].url,'" style="max-width: 100%;">')):(this.percentage=0,this.imsertVideo(e))},imsertVideo:function(e){var t=e.fis[0].url.substring(0,e.fis[0].url.lastIndexOf("."))+".jpg",i='<p style="display: none;">0</p></p><p><video poster="'.concat(t,'" style="width:100%;" controls ><source type="video/mp4" src="').concat(e.fis[0].url,'" ></video></p>');this.editor.execCommand("inserthtml",i)}}},Q=J,X=(i("6e0b"),Object(h["a"])(Q,a,r,!1,null,null,null)),K=X.exports,ee=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-eidtor-template",style:e.templateStyle},[i("el-menu",{attrs:{"default-active":"0"},on:{select:e.handleSelect}},[i("el-menu-item",{attrs:{index:"0"}},[i("template",{slot:"title"},[i("span",[e._v("样式")])])],2),i("el-menu-item",{attrs:{index:"1"}},[i("template",{slot:"title"},[i("span",[e._v("模板")])])],2)],1),"0"===e.selectedNav?i("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-tab-pane",{attrs:{label:"标题",name:"first"}},e._l(e.styleTitles,(function(t){return i("div",{key:t.index,staticClass:"tab-item",domProps:{innerHTML:e._s(t)},on:{click:function(i){return e.templateSelect(t)}}})})),0),i("el-tab-pane",{attrs:{label:"正文",name:"second"}},e._l(e.styleContents,(function(t){return i("div",{key:t.index,staticClass:"tab-item",domProps:{innerHTML:e._s(t)},on:{click:function(i){return e.templateSelect(t)}}})})),0),i("el-tab-pane",{attrs:{label:"引导",name:"third"}},e._l(e.styleGuides,(function(t){return i("div",{key:t.index,staticClass:"tab-item",domProps:{innerHTML:e._s(t)},on:{click:function(i){return e.templateSelect(t)}}})})),0),i("el-tab-pane",{attrs:{label:"图文",name:"fourth"}},e._l(e.styleImgs,(function(t){return i("div",{key:t.index,staticClass:"tab-item",domProps:{innerHTML:e._s(t)},on:{click:function(i){return e.templateSelect(t)}}})})),0),i("el-tab-pane",{attrs:{label:"布局",name:"fifth"}},e._l(e.styleLayouts,(function(t){return i("div",{key:t.index,staticClass:"tab-item",domProps:{innerHTML:e._s(t)},on:{click:function(i){return e.templateSelect(t)}}})})),0),i("el-tab-pane",{attrs:{label:"行业",name:"sixth"}},e._l(e.styleTrades,(function(t){return i("div",{key:t.index,staticClass:"tab-item",domProps:{innerHTML:e._s(t)},on:{click:function(i){return e.templateSelect(t)}}})})),0)],1):e._e(),"1"===e.selectedNav?i("div",[e._m(0),i("div",{staticClass:"el-tabs__content"},e._l(e.templates,(function(t){return i("div",{key:t.index,staticClass:"tab-item",domProps:{innerHTML:e._s(t)},on:{click:function(i){return e.templateSelect(t)}}})})),0)]):e._e()],1)},te=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"el-tabs__header is-top"},[i("div",{staticClass:"el-tabs__nav-wrap is-top"},[i("div",{staticClass:"el-tabs__nav-scroll"},[i("div",{staticClass:"el-tabs__nav",staticStyle:{transform:"translateX(0px)"},attrs:{role:"tablist"}},[i("div",{staticClass:"el-tabs__item is-top",staticStyle:{width:"376px","text-align":"center"},attrs:{role:"tab",tabindex:"-1"}},[e._v("系统模板")])])])])])}],ie={name:"BizEditorTemplate",props:{templateStyle:{type:Object,default:function(){return{width:"445px",height:"100%"}}}},data:function(){return{selectedNav:"0",activeTab:"first",styleTitles:['<br>\n        <p style="margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: rgb(239, 112, 96); min-height: 32px; border-bottom-width: 2px; border-bottom-style: solid; border-color: rgb(239, 112, 96); text-align: justify;">\n          <span class="autonum" placeholder="1" style="border-radius: 80% 100% 90% 20%; color: #FFFFFF; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px; word-wrap: break-word !important; background-color: #EF7060;" data-original-title="" title="">1</span><strong class="brush" data-brushtype="text"></strong>\n        </p>\n        <br>','<br>\n        <div style="clear: both; padding: 0px; border: 0px none; margin:5px 0px;">\n          <div style="border-top-width: 2.5px; border-top-style: solid; border-color: rgb(239, 112, 96); font-size: 1em; font-weight: inherit; text-decoration: inherit; color: rgb(255, 255, 255); box-sizing: border-box;">\n            <div style="border: 0px rgb(239, 112, 96); margin: 2px 0px 0px; overflow: hidden; padding: 0px; color: inherit;">\n              <div style="display: inline-block; font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; color: inherit; border-color: rgb(239, 112, 96); background-color: transparent;">\n                <div class="brush" data-bcless="darken" data-brushtype="text" style="display: inline-block; line-height: 1.4em; padding: 5px 10px; height: 32px; vertical-align: top; font-size: 16px; font-family: inherit; font-weight: bold; float: left; color: inherit; border-color: rgb(212, 43, 21); box-sizing: border-box !important; background: rgb(239, 112, 96);">\n                  请输入标题\n                </div>\n                <div style="display: inline-block; vertical-align: top; font-size: 16px; width: 0px; height: 0px; border-top-width: 32px; border-top-style: solid; border-top-color: rgb(239, 112, 96); border-right-width: 32px; border-right-style: solid; border-right-color: transparent; border-top-right-radius: 4px; border-bottom-left-radius: 2px; color: inherit; box-sizing: border-box !important;">\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="margin: 0.8em 0 0.5em 0;font-size: 16px;line-height: 32px; font-weight: bold;">\n          <div style="display: inline-block; float: left; min-width: 32px; height: 32px; vertical-align: top; text-align: center;  ">\n            <div style="display: table; width: 100%; color: inherit; border-color: rgb(72, 192, 163);" data-width="100%">\n              <div style="display: table-cell;text-indent: 0; vertical-align: middle; font-style: normal; color: rgb(255, 255, 255); border-color: rgb(72, 192, 163);">\n                <span class="autonum" style="color:#C6C6C7; font-size:50px" data-original-title="" title="">1</span></div>\n              <div style="height: 70px;margin-left: -6px; margin-top:5px;border-left:1px solid rgb(198,198,199);background-color: rgb(254,254,254); box-sizing: border-box;transform: rotate(35deg);-webkit-transform: rotate(35deg);-moz-transform: rotate(35deg);-o-transform: rotate(35deg);"></div>\n            </div>\n          </div>\n          <div style="margin-left: 40px;padding-top:18px; font-style:normal;font-size:30px; color: #737373; border-color: rgb(72, 192, 163);">\n            <span class="brush" data-brushtype="text" style="color:#737373; font-size:20px">请输入标题</span></div>\n        </div>\n        <br>','<br>\n        <div class="" style="border-left:5px solid #666765;font-size: 16px;font-weight:bold; line-height: 32px;color:#666;padding: 5px 10px; margin: 10px 0px;">\n          <p>\n            你在跳一个深坑之前，要知道它有多深才行。当你在这个世界上还有快乐可寻的时候，万不可走绝路，否则不久你也许会觉醒，那时后悔就太迟了。 by 席勒\n          </p>\n        </div>\n        <br>'],styleContents:['<br>\n        <div style="margin-top: 0px; padding: 0px 5px; line-height: 10px; color: inherit; border: 1px solid rgb(226, 121, 97);">\n          <div style="padding: 0px; font-size: 16px; color: inherit; height: 8px; margin: -8px 0px 0px 140px; width: 50%; background-color: rgb(254, 254, 254);" data-width="50%">\n            <div style="width: 8px; height: 8px; border-radius: 100%; line-height: 1; box-sizing: border-box; font-size: 18px; text-decoration: inherit; border-color: rgb(226, 121, 97); display: inline-block; margin: 0px; color: inherit; background-color: rgb(226, 121, 97);"></div>\n          </div>\n          <div class="brush" data-style="text-indent: 2em;" style="padding: 0px; line-height: 2em; color: rgb(62, 62, 62); font-size: 14px; margin: 15px;">\n            <p style="text-indent: 2em;">\n              我这个二十岁的人，一再严肃地反省到自己由于孤儿根性养成的怪脾气，我正因为受不了那种令人窒息的忧郁感，这才走上伊豆的旅程。\n            </p>&#8203;<br>\n            <p style="text-indent: 2em;">\n              ——川端康成《伊豆的舞女》\n            </p>\n          </div>\n          <div style="padding: 0px; background-color: rgb(254, 254, 254); font-size: 16px; color: inherit; text-align: right; height: 10px; margin: 0px 0px -4px 25px; width: 65%;" data-width="65%">\n            <div style="margin: 0px auto 1px; border-radius: 100%; line-height: 1; box-sizing: border-box; text-decoration: inherit; border-color: rgb(226, 121, 97); display: inline-block; height: 8px; width: 8px; color: inherit; background-color: rgb(226, 121, 97);"></div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="color: inherit; font-size: 16px; padding: 5px 10px 0px 35px; margin-left: 27px; border-left-width: 2px; border-left-style: dotted; border-left-color: rgb(228, 228, 228);">\n          <div class="autonum" style="width: 32px; height: 32px; margin-left: -53px; margin-top: 23px; color: rgb(255, 255, 255); text-align: center; line-height: 32px; border-radius: 16px; background: rgb(157, 180, 194);" data-original-title="" title="">\n            1\n          </div>\n          <div class="" style="margin-top: -30px;padding-bottom: 10px; color: inherit;">\n            <p>\n              是真的有过那种，巴不得把自己的生活全盘托出奉献给谁，那人却讪笑着推诿着时远时近的经历，才开始觉得，比起一段风雨飘摇的感情，最该关照的永远是自己。 by 陈大力\n            </p>\n          </div>\n        </div>\n        <br>','<br>\n        <blockquote style="margin: 3px; padding: 10px 15px; border-width: 3px; border-color: rgb(102, 142, 104); border-top-left-radius: 50px; border-bottom-right-radius: 50px; box-shadow: rgb(165, 165, 165) 5px 5px 2px; background-color: rgb(250, 250, 250);">\n          <div class="brush" data-style="margin-top: 15px; margin-bottom: 0px; padding: 0px; color: rgb(107, 77, 64); line-height: 2em; font-size: 20px; border-color: rgb(107, 77, 64);font-size: 18px;font-weight:bold;">\n            <p style="margin-top: 15px; margin-bottom: 0px; padding: 0px; color: rgb(102, 142, 104); line-height: 2em; font-size: 20px; border-color: rgb(102, 142, 104);">\n              <span style="font-size:18px"><strong style="border-color: rgb(102, 142, 104); color: inherit;">读而思</strong></span>\n            </p>\n          </div>\n          <p style="margin-top: -10px; margin-bottom: 0px; padding: 0px; line-height: 2em; min-height: 1.5em; color: inherit;">\n            <span style="font-size:12px"><strong class="brush" data-brushtype="text" style="border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; color: rgb(255, 255, 255); font-size: 13px; padding: 0px 15px; background-color: rgb(102, 142, 104);">duersi</strong></span>\n          </p>\n          <div class="brush" data-style="margin-top: 0px; margin-bottom: 0px; padding: 0px; line-height: 2em; font-size: 14px; min-height: 1.5em; color: inherit;">\n            <p>\n              <span style="font-size:14px">编辑完成后，将内容复制粘贴到微信后台素材管理的编辑器中即可。</span>\n            </p>\n            <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; line-height: 2em; font-size: 16px; min-height: 1.5em; color: inherit;">\n              <br>\n            </p>\n          </div>\n        </blockquote>\n        <br>','<br>\n        <div class="layout" style="margin: 5px auto; border: 3px solid rgb(89, 155, 171); padding: 5px;">\n          <div data-bcless="lighten" style="border: 1px solid rgb(157, 196, 205); padding: 15px; text-align: center; color: inherit;">\n            <p class="title" style="color: inherit;font-size: 12px;">\n              <span class="brush" data-brushtype="text"></span>\n            </p>\n            <p style="color:inherit;">\n              <strong style="color:inherit"><span class="brush" style="color:inherit; font-size:16px">操作方便才是硬道理</span></strong>\n            </p>\n          </div>\n        </div>\n        <br>','<br>\n        <div class="layout" style="border: 0px; margin: 5px auto; box-sizing: border-box; padding: 0px;">\n          <div style="height: 25px; box-sizing: border-box; color: inherit;">\n            <div style="height: 100%; width: 50px; float: left; border-top-width: 2px; border-top-style: solid; border-color: rgb(172, 29, 16); border-left-width: 2px; border-left-style: solid; box-sizing: border-box; color: inherit;"></div>\n            <div style="display: inline-block; color: rgb(172, 29, 16); clear: both; box-sizing: border-box; border-color: rgb(172, 29, 16);"></div>\n          </div>\n          <div class="brush" data-style="color: rgb(51, 51, 51); font-size: 1em; line-height: 1.75em; word-break: break-all; word-wrap: break-word; text-align: justify;" style="margin: -0.8em 0.3em; padding: 0.8em; box-sizing: border-box; color: inherit;">\n            <p style="color: rgb(51, 51, 51); font-size: 1em; line-height: 1.75em; word-break: break-all; word-wrap: break-word; text-align: justify;">\n              反正人生不是在此处失败，就是在彼处失败。失败者才不管别的有多重要。任性一回，不然一辈子都憋屈。 by 毛利\n            </p>\n          </div>\n          <div style="height: 25px; box-sizing: border-box; color: inherit;">\n            <div style="height: 100%; width: 50px; float: right; border-bottom-width: 2px; border-bottom-style: solid; border-color: rgb(172, 29, 16); border-right-width: 2px; border-right-style: solid; box-sizing: border-box; color: inherit;"></div>\n          </div>\n        </div>\n        <br>'],styleGuides:['<br>\n        <p style="text-align:center;">\n          <img data-id="87820" data-role="guide-img" title="引导关注" src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9pYW5xMDNVVVdHbUt6Y2V0amhySjBUaWE5UHhUZFNLcWJWam9HNXNYM3hpYmRGbkdlZ1NSSldhVFRqQzR3d0VhVUxaUWhZT1duVnVsU2liNkJWd3BQOGljV2VRLzA/d3hfZm10PWdpZg==" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9pYW5xMDNVVVdHbUt6Y2V0amhySjBUaWE5UHhUZFNLcWJWam9HNXNYM3hpYmRGbkdlZ1NSSldhVFRqQzR3d0VhVUxaUWhZT1duVnVsU2liNkJWd3BQOGljV2VRLzA/d3hfZm10PWdpZg==" style="display: inline;width:95%">\n        </p>\n        <br>','<br>\n        <div style="border: none; width: 98%; margin-right: auto; margin-left: auto;" data-width="98%">\n          <div style="width: 100%; border: 1px solid rgb(53, 49, 53); padding-bottom: 3em;box-sizing:border-box;" data-width="100%">\n            <div style="width: 100%; background: rgb(53, 49, 53); height: auto; overflow: hidden; box-sizing: border-box; padding: 3em 2em 6em; text-align: center;" data-width="100%">\n              <div style="margin-right: 8px;width: 100%;font-size: 3em;font-family: arial;color: #fff;line-height: 0.8em;display: inline-block;text-align:center;font-weight: bolder;vertical-align: top;" data-width="100%"></div><br>\n              <div class="brush" style="font-size:1em;line-height:1.5em;color:#fff;">\n                <p>\n                  谁可相依？近处，要有可以依傍的亲人朋友，远处，要有神或者佛；实处，要有金钱，虚处，要有信仰。远近都有，虚实结合，才能填补人生的各种窟窿，抵挡生命中各种不妥，不至于凄云惨雾。 by 韩松落\n                </p>\n              </div>\n            </div>\n            <div style="width: 40%; margin-right: auto; margin-left: auto; overflow: hidden; margin-top: -4em;" data-width="40%">\n              <img style="width:100%;border:1px solid #1F1E20;" src="/resources/admin/images/article/qrcode.jpg" data-ke-src="/resources/admin/images/article/qrcode.jpg" data-width="100%">\n            </div>\n            <div style="width: 100%; font-size: 1.4em; margin-top: 0.2em; margin-bottom: 0.2em; text-align: center;" data-width="100%">\n              V服爱车\n            </div>\n            <div style="width: 100%; font-size: 1em; color: rgb(126, 126, 126); margin-top: 0.2em; margin-bottom: 0.2em; text-align: center;" data-width="100%">\n              长按识别二维码，关注V服爱车\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <p class="brush" style="margin-top: 0px; margin-bottom: 0px; font-size: 15.5556px; padding: 0px; max-width: 100%; min-height: 1.5em; line-height: 2em; word-wrap: break-word; word-break: normal; border-radius: 5px; color: rgb(255, 255, 255); text-align: center; background-color: rgb(128, 177, 53);" data-brushtype="text">\n          ↓↓↓ 点击"阅读原文" 【查看更多信息】 &nbsp;\n        </p>\n        <br>','<br>\n        <div style="border: none; margin: 0.8em 0px 0.3em; box-sizing: border-box; padding: 0px;">\n          <div style="text-align: center; text-decoration: inherit; color: rgb(255, 255, 255); border-color: rgb(123, 154, 181); box-sizing: border-box;">\n            <div style="width: 0px; margin: 0px 0px 0px 90px; border-bottom-width: 0.8em; border-bottom-style: solid; border-bottom-color: rgb(123, 154, 181); border-top-color: rgb(123, 154, 181); box-sizing: border-box; height: 10px; color: inherit; border-left-width: 0.8em !important; border-left-style: solid !important; border-left-color: transparent !important; border-right-width: 0.8em !important; border-right-style: solid !important; border-right-color: transparent !important;"></div>\n            <div class="brush" data-brushtype="text" style="padding: 0.5em; line-height: 1.2em; font-size: 1em; box-sizing: border-box; color: inherit; border-color: rgb(123, 154, 181); border-radius: 4px; background-color: rgb(123, 154, 181);">\n              <strong style="color:inherit">点击标题下「蓝色微信名」可快速关注</strong>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <p style="text-align:center;">\n          <img title="猫抓毛线球引导分享" src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9jWlYyaFJwdUFQak9qSUVBMU9qU2ljWEhjaWE5TWo5UlFqc09RVTh4R1hpYVlYWWZpYm9Nb0FKbXJyVHpPSjRtWDgxOXZqaGpYaG9EZ0lzZXBBdEs2S3k2OEEvMA==" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9jWlYyaFJwdUFQak9qSUVBMU9qU2ljWEhjaWE5TWo5UlFqc09RVTh4R1hpYVlYWWZpYm9Nb0FKbXJyVHpPSjRtWDgxOXZqaGpYaG9EZ0lzZXBBdEs2S3k2OEEvMA==" style="display: inline;">\n        </p>\n        <br>'],styleImgs:['<br>\n        <div style="border: 0px; box-sizing: border-box; width: 100%; clear: both; overflow: hidden; padding: 0px;" data-width="100%">\n          <div class="layout" style="box-sizing: border-box; width: 65%; float: left; padding: 0px 0.1em 0px 0px;" data-width="65%">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUVhUSW9LTkZBN29tSUFCUkRXMlhpYTAzSlNxZU01UFM5Q3loM3JFZXdtVmljYXNZcU5XSWVwMnlBLzA/d3hfZm10PWpwZWc=" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUVhUSW9LTkZBN29tSUFCUkRXMlhpYTAzSlNxZU01UFM5Q3loM3JFZXdtVmljYXNZcU5XSWVwMnlBLzA/d3hfZm10PWpwZWc=" style="box-sizing: border-box; margin: 0px; height: auto !important; visibility: visible !important; width: 100%;" width="100%" height="auto" border="0" opacity="" mapurl="" title="" alt="" data-width="100%">\n          </div>\n          <div class="layout" style="display: inline-block; width: 35%; box-sizing: border-box; float: left; padding: 0px 0px 0px 0.1em;" data-width="35%">\n            <div class="brush" data-brushtype="text" style="box-sizing: border-box; margin-right: 4px; padding: 4px 6px; border-bottom-width: 2px; border-bottom-style: solid; font-size: 1.2em; font-weight: bold;color: rgb(102,97,91); border-color: rgb(102,97,91);">\n              机会论\n            </div>\n            <div class="brush" data-styel="line-height: 2em;" style="box-sizing: border-box; margin-right: 0.3em; padding: 0.3em 0.5em; color: rgb(102,97,91); font-size: 0.9em;">\n              <p style="line-height: 2em;">\n                机会是给有准备的人\n              </p>\n              <p style="line-height: 2em;">\n                但准备的人多了\n              </p>\n              <p style="line-height: 2em;">\n                机会\n              </p>\n              <p style="line-height: 2em;">\n                决定摇号\n              </p>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="text-align:center;">\n          <div style="display:inline-block;text-align:right;">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUTE0cng2aWJocGdSUWhSYTdpYzBjeWtqSmxoQUFXZlM4aWFkYkx4aDlnMVpzUHBWWUdWT0V3QVRxUS8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUTE0cng2aWJocGdSUWhSYTdpYzBjeWtqSmxoQUFXZlM4aWFkYkx4aDlnMVpzUHBWWUdWT0V3QVRxUS8wP3d4X2ZtdD1qcGVn" style="border-radius: 50%; display: inline-block; width: 110px; margin: 0px; height: 110px !important;" width="110" height="110" border="0" opacity="" mapurl="" title="" alt="">\n          </div>\n          <div style="border-left-width: 1px; border-left-style: solid; border-color: rgb(173, 167, 105); padding-left: 1em; text-align: left; display: inline-block; height: 6em; vertical-align: top; color: rgb(173, 167, 105); margin-top: 0.5em; margin-left: 10px; padding-top: 5px;">\n            <div class="brush" data-brushtype="text" style="width: 100%; height: 50%; font-size: 1.4em; border-color: rgb(173, 167, 105); color: inherit; margin-bottom: 0.5em;" data-width="100%">\n              计划\n            </div>\n            <div class="brush" data-brushtype="text" style="font-size: 16px; border-color: rgb(173, 167, 105); color: inherit;">\n              = Planning =\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="text-align: center;">\n          <div style="display: inline-block; vertical-align: top; width:50%;" data-width="50%">\n            <div style="width: 8em;display:inline-block;">\n              <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUWFrMHY1Um9SaWNsOWxOcmlheUlyOG83aWF5NFpBekMySGliWkxaRURUOTZON0NWT2dEUHQzajRCSXcvMD93eF9mbXQ9anBlZw==" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUWFrMHY1Um9SaWNsOWxOcmlheUlyOG83aWF5NFpBekMySGliWkxaRURUOTZON0NWT2dEUHQzajRCSXcvMD93eF9mbXQ9anBlZw==" style="border-radius: 50%; width: 8em; margin: 0px; height: auto !important;" width="8em" height="auto" border="0" opacity="" mapurl="" title="" alt="">\n            </div>\n          </div>\n          <div style="display: inline-block; vertical-align: top; border-left-width: 1px;box-sizing:border-box; border-left-style: solid; border-left-color: rgb(139, 162, 176); padding-bottom: 2em; width: 50%; padding-top: 0.5em;" data-width="50%">\n            <div style="border: 1px solid;box-sizing:border-box; color: rgb(255, 255, 255); font-size: 18px; width: 0.8em; height: 0.8em; line-height: 0.8em; margin-left: -0.42em; border-radius: 100%; margin-top: 3em; background-color: rgb(139, 162, 176);"></div>\n            <div style="padding-left: 20px;box-sizing:border-box;margin-top:-4.5em;">\n              <div style="border: 1px solid rgb(139, 162, 176); padding: 10px;box-sizing:border-box;" class="brush">\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">一个爱我的人，</span>\n                </p>\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">如果爱得讲话结结巴巴，</span>\n                </p>\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">语无伦次，</span>\n                </p>\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">我就知道他爱我</span>\n                </p>\n                <p style="text-align: left; line-height: 1.75em;">\n                  <span style="font-size: 14px;">——木心</span>\n                </p>\n              </div>\n            </div>\n          </div>\n          <div style="vertical-align: top;box-sizing:border-box; width: 50%; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(139, 162, 176); display: inline-block; margin-right: -2px;" data-width="50%">\n            <div style="padding-right:20px;box-sizing:border-box;">\n              <div style="box-sizing:border-box;border: 1px solid rgb(139, 162, 176); padding: 10px;" class="brush">\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">一个爱我的人</span>\n                </p>\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">如果爱得讲话结结巴巴</span>\n                </p>\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">语无伦次</span>\n                </p>\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">我就知道他爱我</span>\n                </p>\n                <p style="text-align: right; line-height: 1.75em;">\n                  <span style="font-size: 14px;">——木心</span>\n                </p>\n              </div>\n            </div>\n          </div>\n          <div style="display: inline-block; vertical-align: top; width: 50%; padding-bottom: 2em;box-sizing:border-box;" data-width="50%">\n            <div style="border: 1px solid; color: rgb(255, 255, 255); font-size: 18px; width: 0.8em; height: 0.8em; line-height: 0.8em; border-radius: 100%; margin-top: 3em; margin-left: -0.34em; background-color: rgb(139, 162, 176);"></div>\n            <div style="width: 8em;display:inline-block;">\n              <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUVFpYmRtZU5wS0tUeGpjWVF1eG9XZ3dFZ0NPZmlhaWE3MEJodTFNZHBpYkFWUEdBTVFDTEpZTWljMGliZy8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUVFpYmRtZU5wS0tUeGpjWVF1eG9XZ3dFZ0NPZmlhaWE3MEJodTFNZHBpYkFWUEdBTVFDTEpZTWljMGliZy8wP3d4X2ZtdD1qcGVn" style="border-radius: 50%; width: 8em; margin: -64px 0px 0px; height: auto !important;" width="8em" height="auto" border="0" opacity="" mapurl="" title="" alt="">\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="padding:5px;margin:0 auto;text-align:center;">\n          <div style="display:inline-block;">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9jWlYyaFJwdUFQamczc3hvVHR5OGRNSDM2U2lhUWxuMG9pY3EzcDRhRTU4aWNSZ0tIUEwyVW9WeFVVTnRkMmNuWm1rT2lhTGtIRUZmelRpYlB4aWFKUG1xSXYwdy8w" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9jWlYyaFJwdUFQamczc3hvVHR5OGRNSDM2U2lhUWxuMG9pY3EzcDRhRTU4aWNSZ0tIUEwyVW9WeFVVTnRkMmNuWm1rT2lhTGtIRUZmelRpYlB4aWFKUG1xSXYwdy8w" style="width:290px;height:auto !important;" class="assistant">\n          </div>\n          <div style="margin-left: 1%; margin-right: 1%; margin-top: -45px; padding: 15px; color: rgb(123, 123, 111); background: rgb(245, 245, 244);">\n            <div style="border: solid 1px rgb(198,198,198);box-shadow:rgb(220,220,220) 0px 0px 5px;padding:8px;">\n              <img style="width: 100%; margin: 0px;" src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkdObGJjam4yVXd3a21Yc25qU2VqRzJzZnVzUFBNdUliY3Z6RWpXZlBiOGlidTVBdGR4Y1FhbnVqSXlIdzlpYlpHUUYzRktrb2xFYzl6QS8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkdObGJjam4yVXd3a21Yc25qU2VqRzJzZnVzUFBNdUliY3Z6RWpXZlBiOGlidTVBdGR4Y1FhbnVqSXlIdzlpYlpHUUYzRktrb2xFYzl6QS8wP3d4X2ZtdD1qcGVn" width="100%" height="" border="0" opacity="" mapurl="" title="" alt="" data-width="100%">\n              <div style="margin-top:15px;margin-bottom:5px;" class="brush">\n                <p style="line-height: 1.75; font-size: 14px; color: rgb(112, 112, 112); text-align: justify;">\n                  你是你自己的裁决者。你过去和现在做得有多好，由你自己说了算。别人永远不能审判你，就算是神。\n                </p>\n                <p style="line-height: 1.75; font-size: 14px; color: rgb(112, 112, 112); text-align: right;">\n                  <span style="line-height: 1.75;">——《与神对话》</span>\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="position:relative;width:50%;float:left;" data-width="50%">\n          <div style="width:100%;height:80%;overflow:hidden;" data-width="100%">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpel9qcGcvemlhZEREUXhiQ0pGYVhuWGZnZjg5anVvSVE1VTF1MWd2M0pJVmpTVHZITFJpYWx4Q2dCM3FEV205azdQc0Frc1NZaHFBcVc5RFFkbGJrRU52ckRiNVYwUS8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpel9qcGcvemlhZEREUXhiQ0pGYVhuWGZnZjg5anVvSVE1VTF1MWd2M0pJVmpTVHZITFJpYWx4Q2dCM3FEV205azdQc0Frc1NZaHFBcVc5RFFkbGJrRU52ckRiNVYwUS8wP3d4X2ZtdD1qcGVn" style="width: 100%; margin: 0px;" width="100%" height="" border="0" mapurl="" title="" alt="" data-width="100%">\n          </div>\n        </div>\n        <div style="float:left;width:44%;margin-top:3%;margin-left:4%;" data-style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-width="44%">\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            在季节的车上，\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            如果你要提前下车，\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            请别推醒装睡的我，\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            这样我可以沉睡到终点，\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            假装不知道你已经离开。\n          </p>\n          <p style="color:rgb(125,125,125);border-bottom:1px dashed rgb(192,192,192);font-size: 12px;line-height:2em;" class="brush" data-brushtype="text">\n            ——张嘉佳\n          </p>\n        </div>\n        <div style="clear:both;"></div>\n        <br>'],styleLayouts:['<br>\n        <div style="border: 0px none; padding: 0px; position: relative;">\n          <div style="border-color: rgb(157, 180, 194); color: rgb(255, 255, 255); padding: 35px; background-color: rgb(157, 180, 194);">\n            <div class="layout" style="margin: 0px auto; ">\n              <p class="brush" data-brushtype="text" style="font-size: 24px; font-weight: bold; border-color: rgb(157, 180, 194); color: inherit;">\n                纯底色大边距大段内容\n              </p>\n              <div class="brush" style="border-color: rgb(157, 180, 194); color: inherit;">\n                <p style="border-color: rgb(157, 180, 194); color: inherit;">\n                  日本的设计师提出过一个配色黄金比例，是70：25：5，其中的70%为大面积使用的主色，25%为辅助色，5%为点缀色。一般情况下建议画面色彩不超过3种，3种是指的3种色相，比如深红和暗红既可以视为一种色相。\n                </p>\n                <p style="border-color: rgb(157, 180, 194); color: inherit;">\n                  <br>\n                </p>\n                <p style="border-color: rgb(157, 180, 194); color: inherit;">\n                  一般来说颜色用的越少越好，颜色越少画面越简洁，作品会显得更加成熟。\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="margin-right: auto; margin-left: auto; clear: both; position: relative; width: 100%; overflow: hidden;" data-width="100%">\n          <div style="margin: 0.5em 0.5em 1.5em; border: 0px;">\n            <div style="margin-top: 0em; border: 2px solid rgb(0, 0, 0); border-radius: 0.8em; color: rgb(51, 51, 51); font-size: 1em; box-shadow: rgb(189, 189, 189) 0px 3px 5px;">\n              <div class="brush" style="font-size: 14px;padding: 1.4em 5em 1em 1em;line-height: 1.4; text-decoration: inherit;">\n                <p>\n                  有时想想，独居斗室和天涯浪迹好像是一件事情，身处寂寞和身处喧嚣其实也没什么两样，身外的整个世界都是镜子，我们必须自己认得自己。——马良《人间卧底》\n                </p>\n              </div>\n            </div>\n            <div style="margin-top:-3.5em;margin-right: 10px; line-height: 1.4; text-align: right;">\n              <div style="width:50px;display:inline-block;">\n                <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei84ZmJBNmJNVENlSktpYUlZcURSYXAwVGZEcVg5Unh0Z0N6aWFJVXNjZVhLaWJvdExjdmliNlJXUVJZU2liZjNZa1Q0QmlhS21qOHhrdjJMNklhd1hXdFdKbldlZy8wP3d4X2ZtdD1wbmc=" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei84ZmJBNmJNVENlSktpYUlZcURSYXAwVGZEcVg5Unh0Z0N6aWFJVXNjZVhLaWJvdExjdmliNlJXUVJZU2liZjNZa1Q0QmlhS21qOHhrdjJMNklhd1hXdFdKbldlZy8wP3d4X2ZtdD1wbmc=" style="width:100%" data-width="100%">\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="border: 0px none; padding: 0px;">\n          <div class="layout" style="margin:10px auto;width:70%" data-width="70%">\n            <div class="_editor" style="border: 0px none; padding: 0px; margin: 0px; position: relative;">\n              <p class="brush" data-brushtype="text" style="font-size: 16px; margin: 10px 0px; padding: 10px; max-width: 100%; border-top-style: solid; border-top-width: 1px; border-left-width: 0px; border-bottom-style: solid; border-bottom-width: 1px; line-height: 25px; color: rgb(33, 33, 34); text-align: center; border-color: rgb(33, 33, 34);">\n                大边距居中\n              </p>\n            </div>\n            <p style="text-align:right; color: inherit;">\n              自由调整两侧边距\n            </p>\n            <div class="brush" data-style="font-size:14px;text-align:center" style="line-height: 25px; color: inherit;">\n              <p style="color: inherit; text-align: center;">\n                单列居中样式，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                内部嵌套插入其它样式，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                内容宽度的自定义，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                让自己的文章更与众不同。<br>\n              </p>\n              <p style="color: inherit;">\n                <br>\n              </p>\n              <p style="color: inherit; text-align: center;">\n                <span style="color: inherit;"></span><br>\n              </p>\n              <p style="color: inherit; text-align: center;">\n                <span style="line-height: 25px; text-align: center;">缩短</span>您的排版时间，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                提升排版体验，\n              </p>\n              <p style="color: inherit; text-align: center;">\n                工作就应该成为享受！\n              </p>\n              <p>\n                <br>\n              </p>\n              <p>\n                <br>\n              </p>\n              <p style="color: inherit;">\n                <br>\n              </p>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="border: 0px none; padding: 0px; position: relative;">\n          <div style="margin-top:5px;">\n            <div style="width:50%;display:inline-block;box-sizing:border-box;float:left;padding-right:10px" class="layout" data-width="50%">\n              <div style="padding:20px 25px;box-sizing:border-box;border:1px solid #e7e7e7;text-align:center;">\n                <p>\n                  <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUTZTYm1sWlJ3TU9XeWdiaWFFU0dTNHJUb0RpYXFIakN4QzVmZGJXNTNYOFBQRm9LWEd4TmlhTFAyZy8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUTZTYm1sWlJ3TU9XeWdiaWFFU0dTNHJUb0RpYXFIakN4QzVmZGJXNTNYOFBQRm9LWEd4TmlhTFAyZy8wP3d4X2ZtdD1qcGVn" style="margin: 0px 0px 15px; height: 50px !important;" width="" height="50" border="0" opacity="" mapurl="" title="" alt="">\n                </p>\n                <p class="brush" data-brushtype="text" style="font-size:16px;font-weight:bold;margin:0 0 10px 0;">\n                </p>\n                <div class="brush" data-style="clear:none;">\n                  <p style="clear:none;margin:0 0;line-height:1.5em;">\n                    生而排版\n                  </p>\n                  <p style="clear:none;margin:0 0;line-height:1.5em;">\n                    <span style="text-align:center">为你而美</span>\n                  </p>\n                </div>\n              </div>\n            </div>\n            <div style="padding-left:10px;box-sizing:border-box;width:50%;display:inline-block;text-align:center;" class="layout" data-width="50%">\n              <div style="padding:20px 25px;box-sizing:border-box;border:1px solid #e7e7e7;">\n                <p>\n                  <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUXVtVjNldEJzV2RpYWlhbkljUnFRcURobE1jWHJKN2NVRm1YMGRPQVVjTWgybUtpY1VWbk9yNDhLUS8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkZTUG9XZ2lhTXNPaGtpYzZ0VGowdXRnUXVtVjNldEJzV2RpYWlhbkljUnFRcURobE1jWHJKN2NVRm1YMGRPQVVjTWgybUtpY1VWbk9yNDhLUS8wP3d4X2ZtdD1qcGVn" style="margin: 0px 0px 15px; height: 50px !important;" width="" height="50" border="0" opacity="" mapurl="" title="" alt="">\n                </p>\n                <p class="brush" data-brushtype="text" style="font-size:16px;font-weight:bold;margin:0 0 10px 0;">\n                  秒刷\n                </p>\n                <div class="brush" data-style="clear:none;margin:0 0;line-height:1.5em;">\n                  <p style="clear:none;margin:0 0;line-height:1.5em;">\n                    一键排版\n                  </p>\n                  <p style="clear:none;margin:0 0;line-height:1.5em;">\n                    珍惜生命\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="margin:2px;text-algin:center;">\n          <div style="border: 2px groove rgb(252, 180, 43); padding-bottom: 1.2em; font-weight: inherit; text-align: center; text-decoration: inherit; box-sizing: border-box; color: inherit; margin: 0px; background-color: transparent;display: inline-block;">\n            <div class="layout" style="width: 40%; float: left; display: inline-block; padding:20px 15px; text-align: left; box-sizing: border-box; color: inherit; margin: 0px;" data-width="40%">\n              <div style="box-sizing: border-box; color: rgb(252, 180, 43); border-color: rgb(252, 180, 43); padding: 0px; margin: 0px;">\n                <div style="border-color: rgb(252, 180, 43); box-sizing: border-box; color: inherit; display: inline-block; font-size: 24px; font-weight: inherit; line-height: 1.5em; text-align: left; text-decoration: inherit; padding: 0px; margin: 0px;">\n                  <span style="box-sizing:border-box; color:#262626; margin:0px; padding:0px"><strong class="brush" data-brushtype="text" style="box-sizing:border-box; color:inherit; margin:0px; padding:0px"></strong></span>\n                </div>\n              </div>\n              <div style="color: rgb(252, 180, 43); margin: 0px; font-size: 1.5em; line-height: 1em; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box; border-color: rgb(252, 180, 43); padding: 0px;">\n                <div style="box-sizing: border-box; color: inherit; border-color: rgb(252, 180, 43); padding: 0px; margin: 0px;">\n                  <span style="box-sizing:border-box; color:#262626; font-size:24px; margin:0px; padding:0px"><strong style="border-color:rgb(252, 180, 43); box-sizing:border-box; color:inherit; font-size:24px; margin:0px; padding:0px"><span class="brush" data-brushtype="text" style="box-sizing:border-box; color:inherit; font-size:24px; margin:0px; padding:0px">编辑器</span></strong></span>\n                </div>\n              </div>\n            </div>\n            <div class="layout" style="display: inline-block; float: right; border-left-width: 2px; border-left-style: groove; border-color: rgb(252, 180, 43); width: 60%; margin-top: 15px; padding-left: 1.5em; vertical-align: middle; box-sizing: border-box; font-weight: inherit; text-align: left; text-decoration: inherit; color: inherit;" data-width="60%">\n              <div class="brush" data-style="color: inherit; font-size: 14px; margin-bottom:0.8em; box-sizing: border-box; padding: 0px; line-height: 1.2em;font-weight:bold;" style="width: 100%; box-sizing: border-box; color: inherit; padding: 0px; margin:3px 0px;" data-width="100%">\n                <p style="color: inherit; font-size: 24px; margin-bottom:0.8em; box-sizing: border-box; padding: 0px; line-height: 1em;">\n                  <strong style="box-sizing:border-box; color:inherit; margin:0px; padding:0px"><span style="box-sizing:border-box; color:inherit; font-size:14px; line-height:1em; margin:0px; padding:0px">V服编辑器是一款在线编辑工具，为您提供丰富的样式，精美的模板</span></strong>\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>'],styleTrades:['<br>\n        <div style="padding: 20px; color: rgb(255, 255, 255); background-color: rgb(226, 121, 97);">\n          <div style="padding: 10px; color: rgb(255, 255, 255); margin: 0px; border: 2px solid rgba(254, 254, 254, 0.8); background: rgb(226, 121, 97);">\n            <div style="border: 0px; box-sizing: border-box; width: 100%; clear: both;  padding: 0px; text-align: center; color: rgb(255,255,255);height:60px" data-width="100%">\n              <div style="box-sizing: border-box; width: 42%; float: left; padding:3px 0px; text-align: right; color: inherit;" data-width="42%">\n                <div style="color: inherit;padding:0px;">\n                  <p style="box-sizing: border-box; margin-top: 3px; margin-bottom: 0; margin-right: 0.2em; padding: 3px 0px 0px; color: inherit; line-height: 1.3em; text-align: right; font-size: 18px; border-color: rgb(226, 121, 97);">\n                    <strong><span class="sh" data-brushtype="text" style="border-color: #E27961; color: inherit; font-size: 18px;">SAVE</span></strong>\n                  </p>\n                  <p style="box-sizing: border-box; margin-top: 0; margin-bottom: 0; margin-right: 0.2em; padding: 0px 0px 3px; line-height: 1.2em; text-align: right; font-size: 18px; text-indent: 0em; border-color: rgb(226, 121, 97);">\n                    <strong><span class="brush" data-brushtype="text" style="border-color: #E27961; color: inherit; font-size: 18px;">UPTO</span></strong>\n                  </p>\n                </div>\n              </div>\n              <div style="display: inline-block; width: 58%; box-sizing: border-box; float: right; padding: 0px; text-align: left; color: inherit;" data-width="58%">\n                <div style="color: inherit;height:60px">\n                  <p style="box-sizing: border-box; margin-top: 0; margin-bottom: 0; margin-right: 0.2em; padding: 3px 0px; color: inherit; line-height: 3.5em; text-align: left; border-color: rgb(226, 121, 97);">\n                    <span style="color:inherit"><strong><span class="brush" data-brushtype="text" style="border-color: #E27961; color: inherit; font-size: 55px;">50%</span></strong></span>\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br>','<br>\n        <div style="margin: 16px 0% 8px; text-align: center; position: static;">\n            <div style="padding: 32px 16px 16px; box-sizing:border-box;white-space: normal; background-image: -webkit-repeating-linear-gradient(135deg, transparent, transparent 4px, white 4px, white 12px); background-color: rgb(226, 223, 223);">\n              <div style="width: 32px; margin: -40px auto; font-size: 64px; line-height: 1; color: rgb(226, 223, 223); background: white;">\n                  “\n              </div>\n              <div style="padding: 8px; box-sizing:border-box;background-color: rgb(255, 255, 255);">\n                <div style="margin-top: -35px; margin-right: 0%; margin-left: 0%; position: static;">\n                  <div style="display: inline-block; width: 55%; vertical-align: top; background-color: rgb(254, 255, 255);" data-width="55%">\n                    <div style="position: static;">\n                      <div style="color: rgb(133, 118, 106); font-size: 20px;">\n                        <div>\n                          <p>\n                            全场满100<strong>包邮</strong>\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                    <div style="position: static;">\n                      <div style="text-align: left; font-size: 12px; color: rgb(160, 160, 160); letter-spacing: 1px;">\n                        <p style="text-align: center;">\n                          9.22 10:00 - 9.28 10:00\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div style="position: static;margin-top:20px;margin-bottom:10px;">\n                  <div style="display: inline-block; vertical-align: top; width: 50%; padding: 5px;box-sizing:border-box;" data-width="50%">\n                    <div style="position: static;">\n                      <div style="letter-spacing: 1px;">\n                        <div>\n                          <p>\n                            <span style="font-size: 7px;">￥&nbsp;</span><span style="font-size: 35px;"><strong><span style="line-height: 1.6;">10</span></strong></span><span style="font-size: 14px;"><strong><span style="line-height: 1.6;">优惠券</span></strong></span>\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                    <div style="margin-right: 0%; margin-bottom: 8px; margin-left: 0%; position: static;">\n                      <div style="border-top: 1px dotted rgb(11, 11, 11);"></div>\n                    </div>\n                    <div style="position: static;">\n                      <div style="position: static;">\n                        <p style="font-size: 13px;">\n                          订单满150元使用\n                        </p>\n                      </div>\n                    </div>\n                    <div style="position: relative;">\n                      <div style="margin-top: 10px; margin-bottom: 10px; position: static;">\n                        <div class="" style="display: inline-block;border: 2px solid rgb(133, 118, 106);box-sizing:border-box;padding: 0.1em 0.5em;border-radius: 3px;color: rgb(255, 255, 255);font-size: 14px;background-color: rgb(133, 118, 106);">\n                          <p>\n                            抢先领取&gt;&gt;\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <div style="display: inline-block; vertical-align: top; width: 50%;" data-width="50%">\n                    <div style="display: inline-block; width: 100%; border-width: 0px 0px 0px 1px; border-style: solid; border-left-color: rgb(226, 223, 223); border-right-color: rgb(226, 223, 223); padding: 5px;box-sizing:border-box;" data-width="100%">\n                      <div style="position: static;">\n                        <div style="letter-spacing: 1px;">\n                          <p>\n                            <span style="font-size: 7px;">￥&nbsp;</span><span style="font-size: 35px;"><strong><span style="line-height: 1.6;">50</span></strong></span><span style="font-size: 14px;"><strong><span style="line-height: 1.6;">优惠券</span></strong><strong><span style="line-height: 1.6;"></span></strong></span>\n                          </p>\n                        </div>\n                      </div>\n                      <div style="position: static;">\n                        <div style="margin-right: 0%; margin-bottom: 8px; margin-left: 0%; position: static;">\n                          <div style="border-top: 1px dotted rgb(11, 11, 11);"></div>\n                        </div>\n                      </div>\n                      <div style="position: static;">\n                        <div style="font-size: 13px;">\n                          <p>\n                            订单满350元使用\n                          </p>\n                        </div>\n                      </div>\n                      <div style="position: static;">\n                        <div style="margin-top: 10px; margin-bottom: 10px; position: static;">\n                          <div style="display: inline-block;border: 2px solid rgb(133, 118, 106);box-sizing:border-box;padding: 0.1em 0.5em;border-radius: 3px;color: rgb(255, 255, 255);font-size: 14px;background-color: rgb(133, 118, 106);">\n                            <p>\n                              抢先领取&gt;&gt;\n                            </p>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <br>','<br>\n        <div style="background-color:#fbfbfb;padding:10px;">\n            <p style="font-family:\'Microsoft Yahei\';color:#333;margin:0;padding:10px;">\n              <strong class="brush" data-brushtype="text">联系我们</strong>\n            </p>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 -135px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">电话：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">155xxxxxxxx</span><span style="display:block;float:right;margin-right:10px;font-weight:bold;line-height:38px;width:20px;height:36px;background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-repeat:no-repeat;background-position:0 -197px;"></span>\n            </div>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 -472px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:11px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">QQ：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">25822xxxx</span>\n            </div>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 0px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:8px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">微信：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">xxxx</span>\n            </div>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 -270px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">地址：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">xx省xx市xx区xx</span><span style="display:block;float:right;margin-right:10px;font-weight:bold;line-height:38px;"></span>\n            </div>\n            <div style="overflow:hidden;border-bottom:1px solid #ddd;font-size:14px;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei9RS0R4clZZZWhpY2ViZ3d6Y1JkZjlXZmRFWHBWRjFlQkREekc4b3FEdmdYQjBseURNaGljbFlxa21nY295QjkycFF4Y3doOTVGWWlhdlBlZG5raWJuSWlhcEJBLzA/d3hfZm10PXBuZw==);background-position:0 -31px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">官网：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">www.135editor.com/</span><span style="display:block;float:right;margin-right:10px;font-weight:bold;line-height:38px;width:20px;height:36px;background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-repeat:no-repeat;background-position:0 -197px;"></span>\n            </div>\n            <div style="overflow:hidden;font-size:14px;border-bottom:1px solid #ddd;color:#545454;background-color:#fbfbfb;">\n              <span style="background-image:url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkhFRkZpYkdhcjVJZTNVWm95SDdhaWFybGo2aWNkeGtBYkJDT3VJTjVoNjZPUGdPcFhGR3p0WDQ0cUVpY1gydEJnamFSNGZYeGJjY3dUTHhnLzA=);background-position:0 -99px ; background-repeat:no-repeat;display:block;width:24px;height:24px;float:left;margin-top:6px;margin-left:10px;"></span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">邮箱：</span><span style="display:block;float:left;margin-left:10px;line-height:38px;font-family:\'Microsoft Yahei\';" class="brush" data-brushtype="text">xxxxx@xxxx.xx</span>\n            </div>\n          </div>\n          <br>','<br>\n        <div style="text-align:center;">\n            <div style="width:280px;height:auto !important;padding:16px 5px;background-image: url(http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkZkVDVTZ2traWJlZGpQcUhtSGd1Z3ZTZERpYmU0ZUJrYlN6aWJEZ3hLTjhkczM1Q1NOdmljQVRBcEdvRGpUeFV0TUZpYlFYNHY4blcxZ1E3US8wP3d4X2ZtdD1wbmc=); background-size:contain; background-repeat: no-repeat;background-position:50% 0;display:inline-block;">\n              <div class="brush" style="margin: 3px auto; padding:5px 16px;color: rgb(62, 62, 62);border:2px solid rgba(254,254,254,0.3);display:inline-block;">\n                <p style="text-align: center; margin-top: 0; margin-bottom: 0;">\n                  <span style=";font-size: 18px;;color: #FFFFFF;">￥5优惠券</span>\n                </p>\n                <div style="padding:6px 50px; font-size: 18px; text-align: center; background-color: rgb(254, 254, 254);display:inline-block;">\n                  <strong><span style="color: #CB254E;" class="brush" data-brushtype="text">立即领取</span></strong>\n                </div>\n                <p style="text-align: center; margin-top: 0; margin-bottom: 0;">\n                  <span style="color: #FFFFFF;" class="brush" data-brushtype="text">（满10元使用）</span>\n                </p>\n              </div>\n            </div>\n          </div>\n          <br>','<br>\n        <div style="display:inline-block;transform: rotate(0deg);-webkit-transform: rotate(0deg);-moz-transform: rotate(0deg);-o-transform: rotate(0deg);">\n            <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkVLS2RKUk1aZWlhREV3Z2RrVGJZb0dhWmlhOGF0c1FpYVRPT2pQNlBER2tIanNNUDY2T2NlcHFYSW0xSGoxVlZIZGdHZEZySWZwQlI2ZEEvMD93eF9mbXQ9cG5n" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei95cVZBcW9adkRpYkVLS2RKUk1aZWlhREV3Z2RrVGJZb0dhWmlhOGF0c1FpYVRPT2pQNlBER2tIanNNUDY2T2NlcHFYSW0xSGoxVlZIZGdHZEZySWZwQlI2ZEEvMD93eF9mbXQ9cG5n" style="width: 120px !important; height: auto !important;" class="assistant">\n          </div>\n          <div style="color: inherit;margin-top: -5.8em;">\n            <p style="line-height: 1.75em; font-size: 12px; text-align: center;">\n              <img src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkVMZGx6Ym1hYjBZRVF1RFNKcTU1YXAxd3JpYmJKRzFtSlNUWVBYTThwOHlCWk5YUXdMZWVENExkUGlhcFBPSEN5VkEyOWdqSFd3UXNzdy8wP3d4X2ZtdD1qcGVn" data-ke-src="http://image3.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpei96aWFkRERReGJDSkVMZGx6Ym1hYjBZRVF1RFNKcTU1YXAxd3JpYmJKRzFtSlNUWVBYTThwOHlCWk5YUXdMZWVENExkUGlhcFBPSEN5VkEyOWdqSFd3UXNzdy8wP3d4X2ZtdD1qcGVn" style="width: 100%; margin: 0px;" width="100%" height="" border="0" opacity="" mapurl="" title="" alt="" data-width="100%">\n            </p>\n            <p style="line-height: 1.75em; font-size: 12px; text-align: center;">\n              <span style="font-size: 14px;" class="brush" data-brushtype="text">渐变色衬衫 ￥140</span>\n            </p>\n          </div>\n          <br>'],templates:['<br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <div>\n            <img src="/resources/admin/images/article/bottom.png" data-ke-src="/resources/admin/images/article/bottom.png" width="100%">\n          </div>\n          <br>','<br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <br>\n          <div>\n            <img src="/resources/admin/images/article/bottom1.png" data-ke-src="/resources/admin/images/article/bottom1.png" width="100%" height="150">\n          </div>\n          <br>']}},components:{},methods:{templateSelect:function(e){this.$emit("templateSelect",e)},handleSelect:function(e,t){this.selectedNav=e}}},ae=ie,re=(i("45e8"),Object(h["a"])(ae,ee,te,!1,null,null,null)),oe=re.exports;i.d(t,"a",(function(){return K})),i.d(t,"b",(function(){return oe}))},4382:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"logistic-following"},[i("div",{staticClass:"product-info"},[i("div",{staticClass:"img"},[i("img",{attrs:{src:e.image||e.defaultProductImg}})]),i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v("物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s(e.logisticState))])]),i("div",{staticClass:"i-item"},[e._v("物流公司："+e._s(e.logistics))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]),e.shippingTraces&&e.shippingTraces.length>0?i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0)])]):e._e()])},r=[],o=i("5530"),s=i("2f62"),n=i("1ab1"),l=i("c596"),d=i("e83a"),c=i.n(d),p={name:"LogisticsFollowing",components:{},data:function(){return{shippingSn:"",defaultProductImg:c.a,shippingTraces:[],state:"",logistics:"",expressSn:"",image:""}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(s["c"])(["getUser"])),Object(s["c"])("Order",["curApplySaleItem","orderInfo"])),{},{logisticState:function(){switch(this.state){case"0":return"无轨迹";case"1":return"已揽收";case"2":return"在途中";case"201":return"到达派件城市";case"3":return"签收";case"4":return"问题件";default:return""}}}),props:{sn:{type:String,default:""}},watch:{},created:function(){},methods:{getLogisticsInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.sn};n["a"].get(l["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.state=t.shipping.state,e.image=t.shipping.shippingItems.length>0?t.shipping.shippingItems[0].image:"",e.logistics=t.shipping.logistics,e.expressSn=t.shipping.expressSn,e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}},m=p,u=(i("b15b"),i("2877")),f=Object(u["a"])(m,a,r,!1,null,null,null);t["a"]=f.exports},"439f":function(e,t,i){"use strict";i("4160"),i("159b");t["a"]={clearMessageBoxes:function(){var e=document.querySelectorAll(".el-message");e.forEach((function(e){e.remove()}))}}},"440d":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"merchants-mgmt-base-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small",disabled:("1"===e.form.state||"3"===this.state)&&!!e.id,"inline-message":!0}},[i("el-form-item",{attrs:{label:"姓名",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入姓名",minlength:"1",maxlength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"电话",prop:"mobile"}},[i("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[i("el-input",{attrs:{placeholder:"请输入您的电子邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),i("el-form-item",{attrs:{label:"QQ号"}},[i("el-input",{attrs:{placeholder:"请输入您的QQ号"},model:{value:e.form.qq,callback:function(t){e.$set(e.form,"qq",t)},expression:"form.qq"}})],1),i("el-form-item",{attrs:{label:"微信号"}},[i("el-input",{attrs:{placeholder:"请输入您的微信号"},model:{value:e.form.wchat,callback:function(t){e.$set(e.form,"wchat",t)},expression:"form.wchat"}})],1),i("el-form-item",{attrs:{label:"所在区域",prop:"areaId"}},[i("biz-area-select",{attrs:{areaId:e.form.areaId},on:{areaChanged:e.areaChanged}})],1),i("el-form-item",{attrs:{label:"申请时间"}},[i("el-input",{attrs:{disabled:""},model:{value:e.form.createDate,callback:function(t){e.$set(e.form,"createDate",t)},expression:"form.createDate"}})],1),i("el-form-item",{attrs:{label:"合作意向"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入合作意向"},model:{value:e.form.cooperationIntention,callback:function(t){e.$set(e.form,"cooperationIntention",t)},expression:"form.cooperationIntention"}})],1),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{attrs:{placeholder:"请选择状态",disabled:""},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[i("el-option",{attrs:{label:"未审核",value:"0"}}),i("el-option",{attrs:{label:"通过",value:"1"}}),i("el-option",{attrs:{label:"未通过",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"备注信息"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),i("el-form-item",{attrs:{label:"所属运营商"}},[i("el-select",{attrs:{placeholder:"请选择运营商"},model:{value:e.form.companyId,callback:function(t){e.$set(e.form,"companyId",t)},expression:"form.companyId"}},e._l(e.companies,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),i("div",{staticClass:"help"},[e._v(" *通过电话联系，确认申请信息有效，则“发送资质邮件”，然后点击“通过”；若为虚假消息，则“废弃”该条申请信息。 ")])],1),i("div",{attrs:{slot:"float"},slot:"float"},[i("el-dialog",{attrs:{title:"发送资质邮件","append-to-body":"",visible:e.qualificationsDialog,"custom-class":"qualification-Dialog"},on:{"update:visible":function(t){e.qualificationsDialog=t}}},[i("el-form",{attrs:{model:e.qualificationsForm,"label-width":"120px",size:"small"}},[i("el-form-item",{attrs:{label:"收件人地址"}},[i("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),i("el-form-item",{attrs:{label:"邮件标题"}},[i("el-input",{model:{value:e.qualificationsForm.subject,callback:function(t){e.$set(e.qualificationsForm,"subject",t)},expression:"qualificationsForm.subject"}})],1),i("el-form-item",{attrs:{label:"邮件内容"}},[i("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.qualificationsForm.content,callback:function(t){e.$set(e.qualificationsForm,"content",t)},expression:"qualificationsForm.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.qualificationsDialog=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendQualificationsEmail}},[e._v("发送")])],1)],1),i("el-dialog",{attrs:{title:"认证通过邮件","append-to-body":"",visible:e.certificationPassedDialog,"custom-class":"qualification-Dialog"},on:{"update:visible":function(t){e.certificationPassedDialog=t}}},[i("el-form",{attrs:{model:e.certificationPassedForm}},[e.passMailCount&&"0"!==e.passMailCount?i("el-form-item",{attrs:{label:"已发送邮件次数"}},[e._v(" "+e._s(e.passMailCount)+"次 ")]):e._e(),i("el-form-item",{attrs:{label:"收件人地址"}},[i("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),i("el-form-item",{attrs:{label:"邮件标题"}},[i("el-input",{model:{value:e.certificationPassedForm.subject,callback:function(t){e.$set(e.certificationPassedForm,"subject",t)},expression:"certificationPassedForm.subject"}})],1),i("el-form-item",{attrs:{label:"邮件内容"}},[i("biz-editor",{ref:"editor",attrs:{width:"100%",height:"400px",hasImage:!1},model:{value:e.certificationPassedForm.content,callback:function(t){e.$set(e.certificationPassedForm,"content",t)},expression:"certificationPassedForm.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.certificationPassedDialog=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendCertificationPassedEmail}},[e._v("发送")])],1)],1),i("el-dialog",{attrs:{title:"提示",visible:e.dialogVisiblePass,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisiblePass=t}}},[i("span",[e._v(e._s(e.form.mobile)+"已被注册，请确认是否通过")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisiblePass=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.pass}},[e._v("确 定")])],1)])],1)],1)},r=[],o=(i("b0c0"),i("a9e3"),i("d3b7"),i("f36f")),s=i("8330"),n=i("ce2e"),l=i("40ae"),d=i("5773"),c=i("1ab1"),p={name:"MerchantsMgmtBaseInfo",components:{BizSaveButton:s["a"],BizAreaSelect:n["a"],BizGrid:o["a"],BizEditor:l["a"]},data:function(){var e=function(e,t,i){var a=/^1\d{10}$/;a.test(t)?i():i(new Error("请输入正确的手机号码"))};return{username:"",password:"",passMailCount:"",loading:!1,hasKaou:!1,dialogVisible:!1,dialogVisiblePass:!1,kaouCompanyId:"",qualificationsDialog:!1,qualificationsForm:{subject:"V服爱车商务合作申请反馈通知(重要)",content:""},certificationPassedDialog:!1,certificationPassedForm:{subject:"V服爱车账号开通通知(重要)",content:""},companies:[],userId:"",form:{areaId:"1568",name:"",mobile:"",email:"",createDate:"",cooperationIntention:"",state:"0",remark:"",companyId:"",qq:"",wchat:""},operations:[{disabled:!1,label:"废弃",name:"abandoned",type:"danger"},{disabled:!1,label:"发送资质邮件",name:"openQualificationsEmail",type:"primary"},{disabled:!1,label:"通过",name:"onPassed",type:"primary"},{disabled:!1,label:"保存",name:"save",type:"primary"}],rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:e,trigger:"blur"}],email:[{type:"email",required:!0,message:"请输入正确的邮箱地址",trigger:"blur"}],areaId:[{required:!0,message:"请选择",trigger:"blur"}]}}},props:{id:{type:String,default:""},open:{type:Boolean,default:!1},state:{type:String,default:""}},watch:{id:function(e){""===e?(this.$refs.form.$el.scrollTop=0,this.form.name="",this.form.mobile="",this.form.investmentState="0",this.form.email="",this.form.createDate="",this.form.state="0",this.form.cooperationIntention="",this.form.remark="",this.form.companyId=this.companies[0].id,this.form.areaId="1568",this.form.qq="",this.form.wchat="",this.operations[0].disabled=!0,this.operations[1].disabled=!0,this.operations[2].disabled=!0,this.operations[3].disabled=!1):this.getEmailContent()},open:function(e){e&&(this.refresh(),this.$refs.form.clearValidate(),""===this.id&&(this.operations[0].disabled=!0,this.operations[1].disabled=!0,this.operations[2].disabled=!0,this.operations[3].disabled=!1))}},created:function(){this.getCompanies()},computed:{},methods:{operate:function(e){this[e]()},areaChanged:function(e){console.log(e),this.form.areaId=e},save:function(){var e=this;this.$refs.form.validate((function(t){e.submit()}))},submit:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(""===e.id?e.create():e.update())}))},checkMobile:function(e){var t=this;c["a"].post("/admin/admin/checkMobile.jhtml",{mobile:e}).then((function(e){e.userId?(t.userId=e.userId,t.dialogVisible=!0):(t.userId="",t.submit())})).catch((function(e){t.loading=!1,e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))},create:function(){var e=this,t={name:this.form.name,mobile:this.form.mobile,email:this.form.email,cooperationIntention:this.form.cooperationIntention,remark:this.form.remark,companyId:this.form.companyId,state:this.form.state,areaId:this.form.areaId,qq:this.form.qq,wchat:this.form.wchat,memberId:this.userId};this.loading=!0,d["a"].create(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("createdSuccess",t.id),e.refresh(t.id)}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},update:function(){var e=this,t={id:this.id,name:this.form.name,mobile:this.form.mobile,email:this.form.email,cooperationIntention:this.form.cooperationIntention,remark:this.form.remark,companyId:this.form.companyId,state:this.form.state,areaId:this.form.areaId,qq:this.form.qq,wchat:this.form.wchat,memberId:this.userId};this.loading=!0,d["a"].save(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("created"),e.refresh()}),(function(t){e.loading=!1,e.$notify({title:"更新失败",message:t.errorMessage,type:"warning"})}))},refresh:function(e){var t=this,i={id:this.id||e||""};this.loading=!0,d["a"].get(i,(function(e){t.loading=!1,t.form.name=e.content.name,t.form.mobile=e.content.mobile,t.form.investmentState=e.content.investmentState,t.form.email=e.content.email,t.form.createDate=e.content.createDate,t.form.areaId=e.content.areaId,t.form.state=e.content.state,t.form.cooperationIntention=e.content.cooperationIntention,t.form.remark=e.content.remark,t.username=e.content.username,t.password=e.content.password,t.form.qq=e.content.qq,t.form.wchat=e.content.wchat,t.passMailCount=e.content.passMailCount,e.content.companyId&&""!==e.content.companyId?t.form.companyId=e.content.companyId:t.form.companyId=t.companies[0].id,t.operations[1].disabled=!0,t.operations[0].disabled=!1,t.operations[2].disabled=!1,t.operations[3].disabled=!1,"1"===t.form.state&&(t.operations[1].disabled=!1),t.state&&"3"===t.state&&t.id&&(t.operations[0].disabled=!0,t.operations[1].disabled=!0,t.operations[2].disabled=!0,t.operations[3].disabled=!0)}),(function(e){t.loading=!1,console.log(e)}))},onPassed:function(){var e=this;this.$refs.form.validate((function(t){t&&e.pass()}))},pass:function(){var e=this,t={id:this.id,name:this.form.name,mobile:this.form.mobile,email:this.form.email,cooperationIntention:this.form.cooperationIntention,remark:this.form.remark,companyId:this.form.companyId,state:"1",areaId:this.form.areaId,memberId:this.userId};this.loading=!0,d["a"].save(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("created"),e.refresh()}),(function(t){e.loading=!1,e.$notify({title:"操作失败",message:t.errorMessage,type:"warning"})}))},abandoned:function(){var e=this;this.$confirm("此操作将废弃该申请, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.onAbandoned()})).catch((function(){}))},onAbandoned:function(){var e=this,t={id:this.id};this.loading=!0,d["a"].abandoned(t,(function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("onAbandoned")}),(function(t){e.loading=!1,console.log(t)}))},getEmailContent:function(){this.qualificationsForm.content='亲爱的用户，您好：<br/><br/>我们收到了您提交的合作申请。感谢您对V服爱车平台的关注与信任，为了更好的体验平台的功能与服务，请您依照以下的步骤进行：<br/><br/>1. 请点击以下网址（该链接48小时内有效，若页面空白请复制该链接到浏览器地址栏打开）：<br/><a href="'+window.location.origin+"/?personalId=&companyId=&investmentId="+this.id+'#/merchants/qua">'+window.location.origin+"/?personalId=&companyId=&investmentId="+this.id+"#/merchants/qua</a><br/>2.提交相关资质证明信息<br/>3.审核通过后会为您开通相应的权限<br/><br/>烦请注意，本封邮件是由系统发送，请您不要回复。如果回复本信，我们无法给您回信。如果您还有其它的问题，请在网页上点击“联系客服中心”，并输入您要反映的问题或意见，或回复carowl@carowl.cn。我们会尽快与您联系。<br/><br/>祝您 万事如意<br/><br/>V服爱车团队",this.certificationPassedForm.content="亲爱的用户，您好：<br/><br/>我们很高兴的通知您，您所提交的相关信息已通过平台的审核，现已为您开通平台使用账号。<br/>1. V服爱车平台地址<br/>"+window.location.origin+"<br/>2. 输入平台为您分配的账号，开始您的V服之旅<br/>用户名："+this.username+"<br/>密码："+this.password+"<br/>3. 如您在使用过程中遇到任何问题，或要反馈您的宝贵意见和建议，请拔打400电话：400-6556-119。<br/><br/>祝您 万事如意<br/><br/>V服爱车团队"},openQualificationsEmail:function(){this.qualificationsDialog=!0},sendQualificationsEmail:function(){var e=this,t={id:this.id,toMail:this.form.email,subject:this.qualificationsForm.subject,content:this.qualificationsForm.content};this.loading=!0,d["a"].sendEmail(t,(function(t){e.loading=!1,"100"===t.resultCode&&e.$message({message:"资质邮件发送成功！",type:"success"})}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})),this.qualificationsDialog=!1},openCertificationPassedEmail:function(){this.certificationPassedDialog=!0},sendCertificationPassedEmail:function(){var e=this,t={id:this.id,toMail:this.form.email,subject:this.certificationPassedForm.subject,content:this.certificationPassedForm.content};this.loading=!0,d["a"].sendEmail(t,(function(t){e.passMailCount=Number(e.passMailCount)+1,e.$message({message:"认证通过邮件发送成功！",type:"success"}),e.loading=!1}),(function(t){e.loading=!1,console.log(t)})),this.qualificationsDialog=!1},getCompanies:function(){var e=this;d["a"].getCompanies((function(t){var i=[];for(var a in t.content)i.push({id:a,name:t.content[a]});e.companies=i}),(function(e){console.log(e)}))}}},m=p,u=(i("5e8e"),i("2877")),f=Object(u["a"])(m,a,r,!1,null,null,null);t["a"]=f.exports},"447a":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-base-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"label-width":"120px",size:"small",disabled:!e.isEdit,"inline-message":!0}},[e.itemId?i("el-form-item",{attrs:{label:"订单编号",prop:"sn"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.sn,callback:function(t){e.$set(e.form,"sn",t)},expression:"form.sn"}})],1):e._e(),i("el-form-item",{attrs:{label:"订单状态"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),i("el-form-item",{attrs:{label:"订单原价",prop:"originalAmount"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.originalAmount,callback:function(t){e.$set(e.form,"originalAmount",t)},expression:"form.originalAmount"}})],1),i("el-form-item",{attrs:{label:"调整金额",prop:"offsetAmount"}},[i("el-input-number",{attrs:{"controls-position":"right",disabled:"订单关闭"===e.form.type},on:{change:e.offsetAmountChange},model:{value:e.form.offsetAmount,callback:function(t){e.$set(e.form,"offsetAmount",t)},expression:"form.offsetAmount"}})],1),i("el-form-item",{attrs:{label:"订单现价",prop:"amount"}},[i("el-input",{attrs:{disabled:"订单关闭"===e.form.type},on:{change:e.curAmountChange},model:{value:e.form.curAmount,callback:function(t){e.$set(e.form,"curAmount",t)},expression:"form.curAmount"}})],1),i("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"1"}},[-1!==e.activeNames.indexOf("1")&&e.handler?i("template",{slot:"title"},[i("div",{staticClass:"title-class"},[i("div",{staticClass:"title-class-one"},[i("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("客户信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("1")&&e.handler?e._e():i("template",{slot:"title"},[e._v("客户信息")]),i("el-form-item",{staticClass:"isRequired",attrs:{label:"会员",prop:"member.nickname"}},[i("el-input",{attrs:{disabled:!!e.itemId,placeholder:"请选择或添加会员"},model:{value:e.form.member.nickname,callback:function(t){e.$set(e.form.member,"nickname",t)},expression:"form.member.nickname"}})],1),i("el-form-item",{attrs:{label:"性别",prop:"member.gender"}},[i("el-select",{attrs:{disabled:!1===!e.itemId},model:{value:e.form.member.gender,callback:function(t){e.$set(e.form.member,"gender",t)},expression:"form.member.gender"}},[i("el-option",{attrs:{label:"男",value:"0"}}),i("el-option",{attrs:{label:"女",value:"1"}}),i("el-option",{attrs:{label:"保密",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"电话",prop:"member.mobile"}},[i("el-input",{attrs:{disabled:!1===!e.itemId,placeholder:"请输入电话"},model:{value:e.form.member.mobile,callback:function(t){e.$set(e.form.member,"mobile",t)},expression:"form.member.mobile"}})],1),e.form.plateNumber?i("el-form-item",{attrs:{label:"车辆",prop:"palteNumber"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.plateNumber,callback:function(t){e.$set(e.form,"plateNumber",t)},expression:"form.plateNumber"}})],1):e._e(),i("el-form-item",{attrs:{label:"车型",prop:"car.type"}},[i("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.car.type,callback:function(t){e.$set(e.form.car,"type",t)},expression:"form.car.type"}})],1),e.form.plateNumber?i("el-form-item",{attrs:{label:"行驶里程",prop:"drivingRange"}},[i("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.drivingRange,callback:function(t){e.$set(e.form,"drivingRange",t)},expression:"form.drivingRange"}})],1):e._e()],2),i("el-collapse-item",{attrs:{name:"2"}},[-1!==e.activeNames.indexOf("2")&&e.handler?i("template",{slot:"title"},[i("div",{staticClass:"title-class"},[i("div",{staticClass:"title-class-one"},[i("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("服务信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("2")&&e.handler?e._e():i("template",{slot:"title"},[e._v("服务信息")]),i("el-form-item",{staticClass:"isRequired",attrs:{label:"顾问",prop:"consultant.id"}},[i("el-select",{attrs:{placeholder:"请选择顾问"},model:{value:e.form.consultant.id,callback:function(t){e.$set(e.form.consultant,"id",t)},expression:"form.consultant.id"}},e._l(e.consultants,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name||"未填写",value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"买家留言",prop:"memo"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),i("el-form-item",{attrs:{label:"业务类型"}},[i("tag-select",{ref:"tagSelect",attrs:{tagList:e.tagList,bAddTag:!1,selectType:"order",selectedTags:e.selectedTags},on:{addSuccess:e.onAddSuccess}})],1),i("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[i("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],2),e.showPayment?i("el-collapse-item",{attrs:{name:"3"}},[-1!==e.activeNames.indexOf("3")&&e.handler?i("template",{slot:"title"},[i("div",{staticClass:"title-class"},[i("div",{staticClass:"title-class-one"},[i("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("付款信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("3")&&e.handler?e._e():i("template",{slot:"title"},[e._v("付款信息")]),e.itemId?i("el-form-item",{staticClass:"isRequired",attrs:{label:"支付方式",prop:"paymentMethodId"}},[i("el-select",{attrs:{disabled:!1===!e.itemId,placeholder:"请选择支付方式"},model:{value:e.form.paymentMethodId,callback:function(t){e.$set(e.form,"paymentMethodId",t)},expression:"form.paymentMethodId"}},e._l(e.paymentMethods,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),i("el-form-item",{staticClass:"isRequired",attrs:{label:"付款方式",prop:"payments[0].paymentType"}},[i("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择付款方式"},on:{change:e.paymentTypeChange},model:{value:e.form.payments[0].paymentType,callback:function(t){e.$set(e.form.payments[0],"paymentType",t)},expression:"form.payments[0].paymentType"}},e._l(e.paymentTypes,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),"会员卡余额"===e.form.payments[0].paymentType?i("el-form-item",{staticClass:"isRequired",attrs:{label:"会员卡",prop:"memberCardId"}},[i("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择会员卡"},on:{change:e.memberCardChange},model:{value:e.form.memberCardId,callback:function(t){e.$set(e.form,"memberCardId",t)},expression:"form.memberCardId"}},e._l(e.listExistCard,(function(e,t){return i("el-option",{key:t,attrs:{label:e.template.name,value:e.id}})})),1)],1):e._e(),"刷卡"===e.form.payments[0].paymentType||"汇款"===e.form.payments[0].paymentType?i("el-form-item",{staticClass:"isRequired",attrs:{label:"付款银行",prop:"payments[0].payBank"}},[i("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择付款银行"},model:{value:e.form.payments[0].payBank,callback:function(t){e.$set(e.form.payments[0],"payBank",t)},expression:"form.payments[0].payBank"}},[i("el-option",{attrs:{label:"中国工商银行",value:"中国工商银行"}}),i("el-option",{attrs:{label:"中国农业银行",value:"中国农业银行"}}),i("el-option",{attrs:{label:"中国银行",value:"中国银行"}}),i("el-option",{attrs:{label:"中国建设银行",value:"中国建设银行"}}),i("el-option",{attrs:{label:"交通银行",value:"交通银行"}}),i("el-option",{attrs:{label:"中信银行",value:"中信银行"}}),i("el-option",{attrs:{label:"广发银行",value:"广发银行"}}),e._v("、 "),i("el-option",{attrs:{label:"深圳发展银行",value:"深圳发展银行"}}),i("el-option",{attrs:{label:"招商银行",value:"招商银行"}}),i("el-option",{attrs:{label:"中国光大银行",value:"中国光大银行"}}),i("el-option",{attrs:{label:"华夏银行",value:"华夏银行"}}),i("el-option",{attrs:{label:"中国民生银行",value:"中国民生银行"}}),i("el-option",{attrs:{label:"兴业银行",value:"兴业银行"}}),i("el-option",{attrs:{label:"上海浦东发展银行",value:"上海浦东发展银行"}}),i("el-option",{attrs:{label:"恒丰银行",value:"恒丰银行"}}),i("el-option",{attrs:{label:"浙商银行",value:"浙商银行"}}),i("el-option",{attrs:{label:"渤海银行",value:"渤海银行"}}),i("el-option",{attrs:{label:"中国邮政储蓄银行",value:"中国邮政储蓄银行"}}),i("el-option",{attrs:{label:"其他银行",value:"其他银行"}})],1)],1):e._e(),"刷卡"===e.form.payments[0].paymentType||"汇款"===e.form.payments[0].paymentType?i("el-form-item",{staticClass:"isRequired",attrs:{label:"付款帐号",prop:"payments[0].payAccount"}},[i("el-input",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请输入付款帐号"},model:{value:e.form.payments[0].payAccount,callback:function(t){e.$set(e.form.payments[0],"payAccount",t)},expression:"form.payments[0].payAccount"}})],1):e._e()],2):e._e(),i("el-collapse-item",{attrs:{title:"优惠信息",name:"4"}},[e.itemId?i("div",[i("el-form-item",{attrs:{label:"优惠券折扣",prop:"couponDiscount"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.couponDiscount,callback:function(t){e.$set(e.form,"couponDiscount",t)},expression:"form.couponDiscount"}})],1),i("el-form-item",{attrs:{label:"赠送积分",prop:"point"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.point,callback:function(t){e.$set(e.form,"point",t)},expression:"form.point"}})],1)],1):i("div",[i("el-form-item",{attrs:{label:"福利",prop:"couponDiscount"}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.couponChange},model:{value:e.form.couponCodeId,callback:function(t){e.$set(e.form,"couponCodeId",t)},expression:"form.couponCodeId"}},e._l(e.form.couponList,(function(e){return i("el-option",{key:e.id,attrs:{label:e.coupon.name,value:e.id}})})),1)],1)],1)]),i("el-collapse-item",{attrs:{title:"其他信息",name:"6"}},[i("el-form-item",{attrs:{label:"创建时间"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.orderTime,callback:function(t){e.$set(e.form,"orderTime",t)},expression:"form.orderTime"}})],1),i("el-form-item",{attrs:{label:"执行时间"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.deliveryTime,callback:function(t){e.$set(e.form,"deliveryTime",t)},expression:"form.deliveryTime"}})],1),i("el-form-item",{attrs:{label:"付款时间"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.paymentTime,callback:function(t){e.$set(e.form,"paymentTime",t)},expression:"form.paymentTime"}})],1),i("el-form-item",{attrs:{label:"预计交货时间"}},[i("el-input",{attrs:{disabled:"待商家确认"!==e.form.type&&"商家已确认"!==e.form.type},model:{value:e.form.deliverDate,callback:function(t){e.$set(e.form,"deliverDate",t)},expression:"form.deliverDate"}})],1),i("el-form-item",{attrs:{label:"完成时间"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.completeTime,callback:function(t){e.$set(e.form,"completeTime",t)},expression:"form.completeTime"}})],1)],1)],1)],1)],1)},r=[],o=(i("99af"),i("7db0"),i("4160"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("ac1f"),i("25f0"),i("3ca3"),i("5319"),i("159b"),i("ddb0"),i("b85c")),s=(i("96cf"),i("1da1")),n=i("5530"),l=i("f36f"),d=i("e42c"),c=i("8330"),p=i("c466"),m=i("2f62"),u=i("18eb"),f=i("1ab1"),h=i("c596"),g={stateConverter:function(e){return"0"===e.enableState?"停用":"1"===e.enableState?"启用":"--"},createDateConverter:function(e){if(e.createDate){e.createDate=e.createDate.replace(/-/g,"/");var t=new Date(e.createDate);return p["a"].dateConverter(t)}return"--"},loginDateConverter:function(e){if(e.lastLoginDate){e.lastLoginDate=e.lastLoginDate.replace(/-/g,"/");var t=new Date(e.lastLoginDate);return p["a"].dateConverter(t)}return"--"},ipConverter:function(e){return e.lastLoginIp?e.lastLoginIp:"--"}},b={name:"baseInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},open:{type:Boolean,default:function(){return!1}},handler:{type:String,default:function(){return""}},activeNames:{type:Array,default:function(){return["1","2","3","4","5"]}},isPend:{type:Boolean,default:!1}},components:{BizGrid:l["a"],BizSaveButton:c["a"],TagSelect:u["a"]},data:function(){var e=this;return{isShipped:!1,beanCanUse:"",maxOffsetBean:0,minOffsetBean:0,originalAmount:"",orderStateTypeList:[{label:"订单已执行",value:"1"},{label:"交易完成",value:"2"}],beanRate:0,tagList:[],selectedTags:[],restaurants:[],dialogRules:{userName:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[0-9a-zA-Z]+$/,message:"用户名只能为数字或字母",trigger:"blur"},{min:4,max:20,message:"长度在4-20位",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"}],name:[{required:!0,trigger:"blur",message:"请输入姓名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:20,message:"密码应在6-20位之间",trigger:"blur"}],rePassword:[{required:!0,trigger:"blur",message:"请再次输入密码"},{trigger:"blur",validator:function(t,i,a){e.formModel.password===e.formModel.rePassword?a():a(new Error("两次输入密码不一致"))}}]},loading:!1,picDialogVisible:!1,showProductSelector:!1,dialogImageUrl:"",isFirst:!0,showDialog:!1,dialogVisible:!1,showDelivery:!1,showReceiver:!1,flag:!1,data:{type:"",method:""},productTableData:[],imageList:[],consultants:[],shippingMethod:[],deliveryCorps:[],paymentTypes:[],paymentMethods:[],listExistCard:[],brandList:[],seriesList:[],modeList:[],brandData:[],seriesData:[],modeData:[],financialPlans:[],selectionKeys:[],rescueOrganizations:[],cars:[],reasons:[],workers:[],orderItems:[],areaId:"1568",useTime:"",useMileage:"",appointmentDate:"",downPaymentPrice:"",loanPrice:"",form:{bean:"",appointmentData:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}},appointmentDate:"",appointmentEndDate:"",sn:"",type:"",amount:"",amountPrepay:"",amountFinalpay:"",originalAmount:"",offsetAmount:"",curAmount:"",memberCardId:"",userId:"",consultant:{id:""},area:{id:"1568"},car:{id:"",tpye:"",drivingRange:""},address:"",areaName:"",consignee:"",phone:"",zipCode:"",remarks:"",memo:"",promotionDiscount:"",couponDiscount:"",couponCodeId:"",couponCode:{},couponList:[],beanDiscount:"",point:"",giftBean:"",shippingMethodName:"",paymentMethodId:"",shippingMethodId:"",invoiceState:"",orderTime:"",deliveryTime:"",paymentTime:"",deliverDate:"",completeTime:"",orderItems:[{appointment:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",plateNumber:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}}}],payments:[{paymentType:"",payBank:"",payAccount:""}],member:{nickname:"",gender:"",mobile:""},shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",phone:"",zipCode:""}]},operations:[{label:"保存",name:"save",type:"primary"}],adminCurrent:[],dialogLoading:!0,dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},isCreated:!1,dialogFilters:[{type:"input",label:"",placeholder:"请输入名称/手机号",name:"searchValue",value:""}]}},computed:Object(n["a"])(Object(n["a"])({},Object(m["c"])(["currentUser"])),{},{showPayment:function(){return!!this.itemId||"1"!==this.form.type},isCreate:function(){return!this.itemId}}),created:function(){this.getStoreTags()},watch:{itemId:function(e){this.itemId&&this.init(),this.isShipped=!1,this.itemId||(this.resetFormData(),this.getStoreTags())},form:{deep:!0,immediate:!0,handler:function(e){var t=this;this.showDelivery=!1,this.showReceiver=!1,this.shippingMethod.map((function(i){i.name===e.shippingMethodName&&"1"===i.isNeedDelivery&&(t.showDelivery=!0),i.name===e.shippingMethodName&&"1"===i.isNeedReceiver&&(t.showReceiver=!0)}))}}},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(m["c"])(["getUser"])),g),{},{getDefaultForm:function(){return{bean:"",curAmount:"",couponCodeId:"",couponCode:{},couponList:[],appointmentData:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}},appointmentDate:"",appointmentEndDate:"",sn:"",type:"",amount:"",amountPrepay:"",amountFinalpay:"",originalAmount:"",offsetAmount:"0",memberCardId:"",userId:"",consultant:{id:""},area:{id:"1568"},car:{id:"",tpye:"",drivingRange:""},address:"",areaName:"",consignee:"",phone:"",zipCode:"",remarks:"",memo:"",promotionDiscount:"",couponDiscount:"",beanDiscount:"",point:"",giftBean:"",shippingMethodName:"",paymentMethodId:"",shippingMethodId:"",invoiceState:"",orderTime:"",deliveryTime:"",paymentTime:"",deliverDate:"",completeTime:"",orderItems:[{appointment:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",plateNumber:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}}}],payments:[{paymentType:"",payBank:"",payAccount:""}],member:{nickname:"",gender:"",mobile:""},shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",phone:"",zipCode:""}]}},onShippingChange:function(){this.form.shippingMethodName&&this.showDelivery||(this.form.shippings[0].freight="",this.getOriginalAmount())},getStoreTags:function(){var e=this,t={categoryType:"订单/服务业务类型",shopId:window.top.SHOP_ID||""};f["a"].get(h["g"].systemSetting.storeTags,t).then((function(t){console.log("订单/服务业务类型标签",t),e.tagList=t.content})).catch((function(e){console.log(e.errorMessage)}))},getOriginalAmount:function(){this.isCreate&&(this.form.originalAmount=(Number(this.originalAmount)-Number(this.form.beanDiscount*this.beanRate||"0")-Number(this.form.couponDiscount||"0")+Number(this.form.shippings[0].freight||"0")).toFixed(2),this.getCurAmount())},getCurAmount:function(){this.form.curAmount=(Number(this.form.originalAmount)+Number(this.form.offsetAmount||"0")).toFixed(2),this.form.curAmount<=0&&(this.form.curAmount=0),this.form.curAmount=this.form.curAmount.toString()},couponChange:function(){var e=this;this.form.couponList.forEach((function(t){if(t.id===e.form.couponCodeId)return e.form.couponDiscount=t.coupon.amount,!1})),this.getOriginalAmount()},freightChange:function(){this.getOriginalAmount()},offsetAmountChange:function(){this.getCurAmount()},curAmountChange:function(){this.form.offsetAmount=Number(this.form.curAmount)+Number(this.form.beanDiscount*this.beanRate)+Number(this.form.couponDiscount)-Number(this.form.originalAmount),this.form.offsetAmount=this.form.offsetAmount.toString()},tagMapping:function(){var e={refId:this.itemId,type:"7",tags:this.$refs.tagSelect.getCurSelectedTags(),shopId:window.top.SHOP_ID||""};f["a"].post(h["g"].systemSetting.tagMapping,e).then((function(e){console.log("映射成功")})).catch((function(e){console.log(e.errorMessage)}))},getTagMapping:function(){var e=this;this.selectedTags=[];var t={refId:this.itemId,type:"7",shopId:window.top.SHOP_ID||""};f["a"].get(h["g"].systemSetting.tagMapping,t).then((function(t){console.log("查看映射信息",t),t.data.tags&&(e.selectedTags=t.data.tags)})).catch((function(e){console.log(e.errorMessage)}))},onAddSuccess:function(){this.getStoreTags()},operate:function(e){this[e]()},resetFormData:function(){this.form=this.getDefaultForm(),this.form.userId="",this.form.memberCardId="",this.listExistCard=[],this.form.member={},this.form.couponList=[],this.form.couponCodeId="",this.form.beanDiscount="",this.paymentTypes=[],this.form.payments[0].paymentType="",this.form.shippings[0].deliveryCorpId="",this.form.originalAmount="",this.form.curAmount="",this.form.car.type="",this.form.car.drivingRange="",this.form.drivingRange="",this.form.plateNumber="",this.form.car.id="",this.form.offsetAmount=""},carOptions:function(e){var t,i=this;d["a"].carOptions({memberId:e},(function(e){i.cars=e.cars,i.cars.length>0&&(i.cars.forEach((function(e){if(e.plateNumber===i.form.plateNumber)return t=e,!1})),i.form.car.id=t?t.id:"",i.cars.map((function(e){if(e.id===i.form.car.id)return i.form.car.type=e.type,!1})))}),(function(e){i.$message.warning(e.errorMessage)}))},init:function(){var e=this;d["a"].viewOrder(this.getSaveParams(),(function(t){e.form=t.order,e.form.curAmount=Number(e.form.originalAmount)+Number(e.form.offsetAmount),0===e.form.payments.length?(e.form.payments=[{paymentType:"",payBank:"",payAccount:""}],e.form.payments[0].paymentType=e.form.paymentTypeName):e.form.memberCardId=e.form.payments[0].memberCardId,0===e.form.shippings.length&&(e.form.shippings=[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:e.form.area&&e.form.area.fullName?e.form.area.fullName+e.form.address:e.form.address,consignee:e.form.consignee,phone:e.form.phone,zipCode:e.form.zipCode}]),e.carOptions(e.form.member.id),e.shippingMethod=t.shippingMethods,e.deliveryCorps=t.deliveryCorps,e.paymentTypes=t.paymentTypes,e.paymentMethods=t.paymentMethods,e.paymentMethods.map((function(i){(i.name=t.order.paymentMethodName)&&(e.form.paymentMethodId=i.id)})),"到店支付"===e.form.paymentMethodName&&e.paymentTypes.forEach((function(t,i){"会员卡余额"===t.name&&e.paymentTypes.splice(i,1)})),e.adminCurrent=[{id:t.adminCurrent.id,name:t.adminCurrent.realName}],e.form.consultant.id?e.adminCurrent=[{id:e.form.consultant.id,name:e.form.consultant.realName}]:e.form.consultant={id:t.adminCurrent.id},e.form.area&&(e.areaId=e.form.area.id),e.form.type=e.getOrderStatus(e.form.type),e.listExistCardTemplate(),e.listAdminByRole(),"2"===e.form.orderType&&(e.getTagMapping(),e.getStoreTags()),e.offsetAmountChange()}),(function(t){e.$message.warning(t.errorMessage)}))},paymentTypeChange:function(e){"会员卡余额"!==e&&(this.form.memberCardId="",this.form.beanDiscount="",this.getOriginalAmount())},memberCardChange:function(){this.getMemberCardInfo(),this.getBeanRate()},getMemberCardInfo:function(){var e=this,t={userCardId:this.form.memberCardId};f["a"].get("/admin/memberCard/memberCard.jhtml",t).then((function(t){e.form.bean=t.content.bean,e.getCouponList()})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getBeanRate:function(){var e=this,t={id:this.form.memberCardId};f["a"].get("/admin/memberCard/memberCard.jhtml",t).then((function(t){e.beanRate=Number(t.rewardSet.cash)/Number(t.rewardSet.vBean)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getCouponList:function(){var e=this;if(0!==this.orderItems.length){this.form.couponList=[];var t=this.orderItems.map((function(e){return{product:{id:e.productId},quantity:e.quantity||""}})),i={shopId:window.top.SHOP_ID||"",cartItems:t,userId:this.form.userId,userCardId:this.form.memberCardId};f["a"].post("/admin/order/couponCodes.jhtml",i).then((function(t){e.form.couponList=t.content,e.maxOffsetBean=t.maxOffsetBean,e.minOffsetBean=t.minOffsetBean})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))}},listExistCardTemplate:function(){var e=this;d["a"].listExistCardTemplate({userId:this.form.userId},(function(t){e.loading=!1,e.listExistCard=t.content,e.listExistCard.forEach((function(e){e.template.name+=" ¥"+e.balance}))}),(function(e){console.log(e)}))},listAdminByRole:function(){var e=this,t="";t=["supplier"],d["a"].listAdminByRole({roleTypes:t},(function(t){e.loading=!1,e.flag=!1,console.log(e.form.consultant.id),t.dataList.map((function(t){t.id===e.adminCurrent[0].id&&(e.flag=!0)})),e.flag?e.consultants=t.dataList:e.consultants=t.dataList.concat(e.adminCurrent)}),(function(e){console.log(e)}))},submitOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var i,a,r,s,n,l,d,c,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.analysisAddress(e.currentUser.shop.address);case 2:return i=t.sent,t.next=5,e.analysisAddress(e.form.shippings[0].address);case 5:a=t.sent,r=e.form.orderItems,s=[],n=Object(o["a"])(r);try{for(n.s();!(l=n.n()).done;)for(d=l.value,c=0;c<d.quantity;c++)p={cname:e.currentUser.shop.name,spro:i.province,scity:i.city,num:d.product.vins[c].number,epro:a.province,ecity:a.city,depname:e.form.shippings[0].consignee},s.push(f["a"].post("/admin/order/shipping2XinYue.jhtml",p))}catch(m){n.e(m)}finally{n.f()}Promise.all(s).then((function(t){e.$emit("xrorder")})).catch((function(t){e.$emit("xrorder")}));case 11:case"end":return t.stop()}}),t)})))()},analysisAddress:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("开始解析, "+e),t.abrupt("return",new Promise((function(t,i){var a=new window.BMap.Geocoder;a.getPoint(e,(function(e){a.getLocation(e,(function(e){console.log(e),t({province:e.addressComponents.province,city:e.addressComponents.city})}))}))})));case 2:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;if(""===this.form.consultant.id)return this.$message.warning("请输入顾问"),!1;if("shipping"===this.handler){if(this.loading=!0,this.shippingMethod.map((function(t){t.name===e.form.shippingMethodName&&(e.form.shippingMethodId=t.id)})),this.form.deliveryCorpId=this.form.shippings[0].deliveryCorpId,this.showDelivery){if(""===this.form.shippings[0].deliveryCorpId)return this.$message.warning("请输入物流公司"),this.loading=!1,!1;if(""===this.form.shippings[0].expressSn)return this.$message.warning("请输入物流单号"),this.loading=!1,!1;if(""===this.form.shippings[0].freight||!/^(0|[1-9][0-9]*)(\.\d+)?$/.test(this.form.shippings[0].freight))return this.$message.warning("请输入正确的物流费用"),this.loading=!1,!1;this.showReceiver?this.$set(this.form,"shippingData",{phone:this.form.shippings[0].phone||this.form.phone,address:this.form.shippings[0].address||this.form.areaName,consignee:this.form.shippings[0].consignee||this.form.consignee,expressSn:this.form.shippings[0].expressSn,freight:this.form.shippings[0].freight}):this.$set(this.form,"shippingData",{expressSn:this.form.shippings[0].expressSn,freight:this.form.shippings[0].freight})}else this.showReceiver&&!this.showDelivery&&(this.$set(this.form,"shippingData",{phone:this.form.shippings[0].phone||this.form.phone,address:this.form.shippings[0].address||this.form.areaName,consignee:this.form.shippings[0].consignee||this.form.consignee}),this.$set(this.form,"deliveryCorpId",this.form.shippings[0].deliveryCorpId));this.loading=!0,d["a"].shippingOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess"),console.log("shipping-success"),e.isShipped=!0}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}else if("service"===this.handler)this.loading=!0,d["a"].excuteOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}));else if("payment"===this.handler){if(this.loading=!0,this.paymentTypes.map((function(t){t.name===e.form.payments[0].paymentType&&(e.form.paymentTypeId=t.id)})),this.form.payment={payBank:this.form.payments[0].payBank,payAccount:this.form.payments[0].payAccount,amount:this.form.amount},!this.form.payments[0].paymentType||("刷卡"===this.form.payments[0].paymentType||"汇款"===this.form.payments[0].paymentType)&&(""===this.form.payments[0].payBank||""===this.form.payments[0].payAccount))return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.$refs.form.validate((function(t,i){t?d["a"].paymentOrder(e.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})):e.loading=!1}))}else this.loading=!0,d["a"].updateOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess"),"2"===e.form.orderType&&e.tagMapping()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}));var t=this.deliveryCorps.find((function(t){return t.id===e.form.shippings[0].deliveryCorpId})).name;"shipping"===this.handler&&"新悦物流"===t&&this.submitOrder()},setOrderItems:function(e){this.orderItems=e,this.orderItems.forEach((function(e){e.productId=e.productId?e.productId:e.id}));var t=0;e.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.originalAmount=t,this.form.originalAmount=t,this.offsetAmountChange(),this.form.member.nickname&&this.getCouponList()},getSaveParams:function(){return{orderId:this.itemId}},getOrderStatus:function(e){switch(e){case"11":return"卖家已发货";case"10":return"退款退货完成";case"9":return"退款退货中";case"8":return"已过期";case"7":return"已评价";case"6":return"订单关闭";case"5":return"交易完成";case"4":return"订单已执行";case"3":return"买家已付款";case"2":return"商家已确认";case"1":return"待商家确认";default:return"无"}}})},v=b,y=(i("0171"),i("2877")),_=Object(y["a"])(v,a,r,!1,null,null,null);t["a"]=_.exports},"44e3":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"bill-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return i("el-card",{key:t.id},[i("div",{on:{click:function(i){return e.selectItem(t)}}},[i("div",{staticClass:"top"},[i("span",[e._v(e._s(t.consignee))]),i("span",[e._v(e._s(t.phone))])]),i("div",{staticClass:"content"},[i("span",[e._v(e._s(t.areaName+t.address))])])]),i("div",{staticClass:"bottom"},["1"===t.isDefault?i("div",[e._v("默认")]):e._e(),"0"===t.isDefault?i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(i){e.$set(t,"isDefault",i)},expression:"receiver.isDefault"}},[e._v("设为默认")]):e._e(),i("div",{staticClass:"handler"},[i("i",{staticClass:"el-icon-edit-outline",on:{click:function(i){return e.editForm(t)}}},[e._v("编辑")]),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"省市"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},r=[],o=(i("d3b7"),i("5530")),s=i("f36f"),n=i("8330"),l=i("1ab1"),d=i("c596"),c=i("2f62"),p=i("ce2e"),m=i("f260"),u=i.n(m),f={components:{BizSaveButton:n["a"],BizAreaSelect:p["a"],BizGrid:s["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(o["a"])(Object(o["a"])({},Object(c["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+u.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(o["a"])(Object(o["a"])({},Object(c["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"].delete(d["g"].hypermarketMgmt.receiver,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].post(d["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].put(d["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};l["a"].get(d["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},h=f,g=(i("6116"),i("2877")),b=Object(g["a"])(h,a,r,!1,null,null,null);t["a"]=b.exports},"453a":function(e,t,i){},"45e8":function(e,t,i){"use strict";var a=i("6611"),r=i.n(a);r.a},"46fc":function(e,t,i){"use strict";i("ac1f"),i("1276");t["a"]=function(e,t){if(!e||!t)return 0;var i=t.split(":"),a=e.split(":"),r=60*(a[0]-i[0])+(a[1]-i[1]);return r<0?0:r}},"474c":function(e,t,i){},4837:function(e,t,i){"use strict";var a=i("5f95"),r=i.n(a);r.a},"48c2":function(e,t,i){"use strict";var a=i("d198"),r=i.n(a);r.a},4944:function(e,t,i){"use strict";var a=i("7cce"),r=i.n(a);r.a},"4d03":function(e,t,i){"use strict";var a=i("c53e"),r=i.n(a);r.a},"4d9f":function(e,t,i){},"4e34":function(e,t,i){"use strict";var a=i("2ace"),r=i.n(a);r.a},"4ec9":function(e,t,i){"use strict";var a=i("6d61"),r=i("6566");e.exports=a("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},"4f2a9":function(e,t,i){"use strict";var a=i("7671"),r=i.n(a);r.a},"50c2":function(e,t,i){"use strict";var a=i("4d9f"),r=i.n(a);r.a},"517a":function(e,t,i){e.exports=i.p+"static/img/pic_default_fail_100.b6b0849d.png"},"51a1":function(e,t,i){"use strict";var a=i("453a"),r=i.n(a);r.a},"53c6":function(e,t,i){},"53c9":function(e,t,i){"use strict";var a=i("990e"),r=i.n(a);r.a},5555:function(e,t,i){},"562c":function(e,t,i){},5719:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"invoice-info-sale"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.invoiceList,(function(t){return i("el-card",{key:t.id},[i("div",[i("div",{staticClass:"radio-i",on:{click:function(i){return e.applyFor(t)}}},[i("el-radio",{attrs:{label:"1",size:"mini"},on:{change:function(i){return e.selectChange(t)}},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"invoice.checked"}},[i("span",{staticStyle:{color:"#ffffff"}},[e._v(".")])]),i("div",[i("div",{staticClass:"default"},[i("span",[e._v("发票抬头：")]),i("span",[e._v(e._s(t.invoiceTitle))]),"1"===t.isDefault?i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"mini"}},[e._v("默认")]):e._e()],1),i("div",{staticStyle:{"padding-top":"10px"}},[i("span",[e._v("发票类型：")]),i("span",[e._v(e._s("0"===t.invoiceType?"个人":"1"===t.invoiceType?"增值税普通发票":"2"===t.invoiceType?"增值税专用发票":""))])]),i("div",{staticStyle:{padding:"10px 0px"}},[i("span",[e._v("联系人：")]),i("span",[e._v(e._s(t.contacts))])]),i("div",[i("span",[e._v("联系电话：")]),i("span",[e._v(e._s(t.mobile))])]),i("div",{staticClass:"content-d"},[i("span",[e._v("详细地址：")]),i("span",[e._v(e._s(t.areaName+t.address))])])])],1),i("div",{staticClass:"bottom-d"},["0"===t.isDefault?i("span",{on:{click:function(i){return i.stopPropagation(),e.setDefault(t)}}},[e._v("设为默认")]):e._e(),i("span",{on:{click:function(i){return i.stopPropagation(),e.editForm(t)}}},[e._v("编辑")]),i("span",{on:{click:function(i){return i.stopPropagation(),e.deleteForm(t.id)}}},[e._v("删除")])])])])})),0===e.invoiceList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"发票信息"}}),i("el-form-item",{attrs:{label:"发票类型",prop:"consignee"}},[i("el-select",{staticStyle:{width:"220px"},model:{value:e.form.invoiceType,callback:function(t){e.$set(e.form,"invoiceType",t)},expression:"form.invoiceType"}},[i("el-option",{attrs:{label:"个人",value:"0"}}),i("el-option",{attrs:{label:"增值税普通发票",value:"1"}}),i("el-option",{attrs:{label:"增值税专用发票",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"发票抬头",prop:"invoiceTitle"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.invoiceTitle,callback:function(t){e.$set(e.form,"invoiceTitle",t)},expression:"form.invoiceTitle"}})],1),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"纳税人识别号",prop:"code"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"注册地址",prop:"registerAddress"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.registerAddress,callback:function(t){e.$set(e.form,"registerAddress",t)},expression:"form.registerAddress"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"注册电话",prop:"registerMobile"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.registerMobile,callback:function(t){e.$set(e.form,"registerMobile",t)},expression:"form.registerMobile"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.bank,callback:function(t){e.$set(e.form,"bank",t)},expression:"form.bank"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"银行账户",prop:"account"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1):e._e(),i("el-form-item",{attrs:{label:"邮寄地址"}}),i("el-form-item",{attrs:{label:"联系人",prop:"contacts"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.contacts,callback:function(t){e.$set(e.form,"contacts",t)},expression:"form.contacts"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"所在地区"}},[i("biz-area-select",{staticStyle:{width:"220px"},attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},r=[],o=(i("d81d"),i("a9e3"),i("d3b7"),i("5530")),s=i("8330"),n=i("1ab1"),l=i("c596"),d=i("2f62"),c=i("ce2e"),p=i("f260"),m=i.n(p),u={components:{BizSaveButton:s["a"],BizAreaSelect:c["a"]},data:function(){return{invoiceList:[],invoiceInfoId:"",checked:"1",showForm:!1,dialogVisiable:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{invoiceType:[{required:!0,message:"请输入发票类型",trigger:"blur"}],invoiceTitle:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],code:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入注册地址",trigger:"blur"}],registerMobile:[{required:!0,message:"请输入注册电话",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],account:[{required:!0,message:"请输入银行账户",trigger:"blur"}],contacts:[{required:!0,message:"请输入联系人",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},props:{orderIds:{type:Array},invoiceAmount:{type:Number}},computed:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+m.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(o["a"])(Object(o["a"])({},Object(d["d"])("Order",["updateCurInvoice"])),{},{operate:function(e){this[e]()},applyFor:function(e){this.invoiceInfoId=e.id,this.$emit("selectedInvoice",e),this.updateCurInvoice(e)},cancle:function(){this.dialogVisiable=!1},close:function(){this.dialogVisiable=!1,this.$emit("close")},selectChange:function(e){this.invoiceList.map((function(t){t.id!==e.id&&(t.checked="0")}))},getDetaultModel:function(){return{account:"",address:"",areaId:"",area:{id:"1568"},areaName:"",bank:"",code:"",contacts:"",invoiceTitle:"",invoiceType:"0",isDefault:"",mobile:"",registerAddress:"",registerMobile:""}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除发票?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["a"].delete(l["g"].hypermarketMgmt.invoiceInfo,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,invoice:this.form};n["a"].post(l["g"].hypermarketMgmt.invoiceInfo,t).then((function(t){e.$message.success("添加成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateCurInvoice(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,invoice:this.form};n["a"].put(l["g"].hypermarketMgmt.invoiceInfo,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateCurInvoice(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};n["a"].get(l["g"].hypermarketMgmt.invoiceInfos,t).then((function(t){e.invoiceList=t.invoices||[],e.invoiceList.map((function(t){e.$set(t,"checked",t.isDefault)}))})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},f=u,h=(i("90b3"),i("2877")),g=Object(h["a"])(f,a,r,!1,null,null,null);t["a"]=g.exports},5773:function(e,t,i){"use strict";var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={get:function(e,t,i){o.a.get(s["g"].merchantsMgmt.select,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},create:function(e,t,i){o.a.get(s["g"].merchantsMgmt.create,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},save:function(e,t,i){o.a.get(s["g"].merchantsMgmt.edit,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},passed:function(e,t,i){o.a.post(s["g"].merchantsMgmt.passed,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},abandoned:function(e,t,i){o.a.get(s["g"].merchantsMgmt.failed,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},sendEmail:function(e,t,i){o.a.post(s["g"].merchantsMgmt.sendMail,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getCompanies:function(e,t){o.a.get(s["g"].merchantsMgmt.companyList).then(Object(a["a"])(e,t)).catch((function(e){console.error(e)}))}}},"57a5":function(e,t,i){"use strict";var a=i("b84c"),r=i.n(a);r.a},5801:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-product-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),i("el-form",{attrs:{inline:!0,disabled:!e.isEdit,"inline-message":!0}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addProduct}},[e._v("新增")]),i("el-form-item",{staticClass:"subTotal",attrs:{label:"合计:",prop:"subTotal"}},[e._v(e._s(e.subTotal))])],1),i("biz-list",{key:Math.random(),ref:"table",staticStyle:{width:"100%",height:"100%"},attrs:{tableData:e.tableData,loading:e.loading}},[i("el-table-column",{attrs:{prop:"sn",label:"编号"}}),i("el-table-column",{attrs:{prop:"fullName",label:"商品名称"}}),i("el-table-column",{attrs:{prop:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{prop:"price",label:"商品价格"}}),i("el-table-column",{attrs:{prop:"minimumPackQuantity",label:"最小包装数","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.minimumPackQuantity?t.row.product.minimumPackQuantity:""))]}}])}),i("el-table-column",{attrs:{prop:"quantity",label:"数量","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input-number",{attrs:{size:"mini",min:1},on:{change:function(i){return e.quantityChange(t.row.quantity)}},model:{value:t.row.quantity,callback:function(i){e.$set(t.row,"quantity",i)},expression:"scope.row.quantity"}})],1)])}}])}),i("el-table-column",{attrs:{prop:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[e._v(e._s(t.row.quantity?(Number(t.row.quantity)*Number(t.row.price)).toFixed(2):"")+" ")])])}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作",type:"index"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e.isEdit?i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteHandeler(t)}}},[e._v("删除")])],1):e._e()])}}])})],1),i("biz-pagination",{attrs:{pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),i("el-dialog",{attrs:{visible:e.dialogTableVisible,center:"",width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.shippingData.sn))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("配送方式："+e._s(e.shippingData.shippingMethod))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingData.consignee))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingData.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:12}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("地址："+e._s(e.shippingData.address))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("买家留言："+e._s(e.shippingData.memo))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"})])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",width:"50",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"address",label:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:""))]}}],null,!0)}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("运费：￥"+e._s(e.formData.freight))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("优惠金额：￥"+e._s(e.formData.couponDiscount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("调整金额：￥"+e._s(e.formData.offsetAmount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单金额：￥"+e._s(e.formData.originalAmount))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("仓库签字：")])])],1)],1)])],1),i("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"选择商品",visibility:e.showDialog,tableData:e.giftList,pagination:e.dialogPagination,filters:e.dialogFilters,selectionKeys:e.selectedGiftIds},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.dialogFilterDataChange,selectionChange:e.selectionChange}},[i("el-table-column",{attrs:{property:"fullName",label:"商品名称",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"dialog-column"},[i("img",{staticClass:"productImg",attrs:{src:t.row.image||e.DefaultImg,onerror:e.errorImg}}),i("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.fullName))])])]}}])}),i("el-table-column",{attrs:{property:"barCode",label:"条码"}}),i("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),i("el-table-column",{attrs:{property:"brandName",label:"品牌"}}),i("el-table-column",{attrs:{property:"price",label:"价格"}}),i("el-table-column",{attrs:{label:"剩余库存/库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.availableStock)+"/"+e._s(t.row.stock))])]}}])})],1)],1)},r=[],o=(i("99af"),i("4de4"),i("4160"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("25f0"),i("159b"),i("5530")),s=i("7558"),n=i("5c40"),l=i("8330"),d=i("f36f"),c=i("e42c"),p=i("2086"),m=i("225d"),u=i("2f62"),f=i("c596"),h=i("1ab1"),g=i("af3f"),b=i("f3ac"),v=i.n(b),y={name:"NewsMgmt",props:{itemId:{type:String},agentId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},errorImg:'this.src="/resources/admin/images/default/product-default.png"',DefaultImg:v.a,selectedGiftList:[],selectedGiftIds:[],showDialog:!1,dialogFilters:[{type:"input",placeholder:"请输入编号/商品名/条码",name:"searchbar",value:""}],giftList:[],loading:!1,open:!1,subTotal:"",height:"585",subTotalAll:"",tableData:[],restaurants:[],selections:[],orderItems:[],selectionList:[],dialogTableVisible:!1,gridData:[],formData:{},shippingData:{},title:"",form:{products:""},operations:[{label:"保存",name:"save",type:"primary"},{label:"打印",name:"certificate",type:"primary"}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:s["a"],BizPagination:n["a"],BizGrid:d["a"],BizSaveButton:l["a"],vueEasyPrint:m["a"],BizDialogSelector:g["a"]},watch:{itemId:function(e){this.tableData=[],this.subTotal="",this.itemId&&this.getList()}},mounted:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},methods:Object(o["a"])(Object(o["a"])({},Object(u["c"])(["getUser"])),{},{addProduct:function(){this.dialogFilters[0].value="",this.getGiftList(),this.selectedGiftIds.splice(0,this.selectedGiftIds.length),this.selectedGiftList.splice(0,this.selectedGiftList.length),this.showDialog=!0},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.getGiftList()},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.getGiftList()},dialogFilterDataChange:function(e){this.dialogFilters=e,this.dialogPagination.currentPage=1,this.getGiftList()},getGiftList:function(){var e=this,t={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||"",isOutOfStock:"0",agentId:this.agentId,type:"couponOrder"===this.$route.params.orderType?"7":""};h["a"].get("purchaseOrder"===window.top.dType?"/admin/purchaseOrderManage/product/list.jhtml":f["g"].memberCardMgmt.memberCard.listProduct,t).then((function(t){e.giftList=t.content,e.dialogPagination.total=Number(t.total)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},selectionChange:function(e){var t=this;e.forEach((function(e){-1===t.selectionList.indexOf(e)&&t.selectionList.push(e)}))},confirmedProduct:function(e){var t=this;this.selectedGiftIds=e.concat(),this.selectedGiftList=[],this.selectionList.map((function(e){-1!==t.selectedGiftIds.indexOf(e.id)&&(e.quantity="1",t.selectedGiftList.push(e))}));this.selectedGiftList.map((function(e){Number(e.quantity)*Number(e.price)})),this.selectedGiftList.forEach((function(e){t.handleSelect(e),t.listProduct(e)}))},print:function(){this.$refs.easyPrint.print()},certificate:function(){var e=this;if(!this.itemId)return this.$message.warning("请先生成一个订单"),!1;var t={orderId:this.itemId,shopId:window.top.SHOP_ID||""};h["a"].get("purchaseOrder"===window.dType?f["l"].delivery.queryShippingVoucherPurchase:f["l"].delivery.queryShippingVoucher,t).then((function(t){e.dialogTableVisible=!0,e.title=e.getUser().shop?e.getUser().shop.name+"发货单":"发货单",e.formData=t.order,e.shippingData=t.shipping||{},e.userCard=t.userCard,e.gridData=t.order.orderItems})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),e.$message.warning(t.errorMessage)}))},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=i+"-"+(a<10?"0"+a:a)+"-"+(r<10?"0"+r:r);return o},resize:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.getList()},operationSuccess:function(){this.getList()},getList:function(){var e=this;console.log("window.top.dType"+window.top.dType),this.loading=!0;var t={orderId:this.itemId,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};c["a"].viewProducts(t,(function(t){e.loading=!1,e.tableData=t.orderItems,e.subTotal=t.order.price,e.pagination.total=Number(t.total),console.log("this.tableData",e.tableData)}),(function(e){console.log(e)}))},handleSelect:function(e){var t=!1;if(e.productId=e.id,e.id="",this.subTotal=(Number(this.subTotal)+Number(e.quantity)*Number(e.price)).toFixed(2),0!==this.tableData.length){for(var i=0;i<this.tableData.length;i++)if(this.tableData[i].productId===e.productId){this.tableData[i].quantity=(Number(this.tableData[i].quantity)+1).toString(),t=!0;break}t||this.tableData.push(Object.assign(e,{product:{minimumPackQuantity:e.minimumPackQuantity,barCode:e.barCode}}))}else this.tableData.push(e)},deleteHandeler:function(e){this.tableData.splice(e.$index,1),this.subTotal=(Number(this.subTotal)-Number(e.row.price)*Number(e.row.quantity)).toFixed(2)},quantityChange:function(e){var t=0;this.tableData.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.subTotal=t?t.toFixed(2):""},save:function(){var e=this;this.orderItems=this.tableData.map((function(e){return{id:e.id||"",productId:e.productId?e.productId:e.id,quantity:e.quantity||"",price:e.price||""}}));var t=!1;if(this.tableData.forEach((function(i){console.log(i.quantity),-1!==String(i.quantity).indexOf(".")&&(e.$message.warning("数量不能为小数"),t=!0),i.quantity%i.product.minimumPackQuantity!==0&&(e.$message.warning("数量为最小包装数的整数倍"),t=!0)})),t)return!1;!this.itemId&&this.$emit("setOrderItems",this.orderItems),this.itemId&&c["a"].addOrderItems({orderId:this.itemId,orderData:{orderItems:this.orderItems},shopId:window.top.SHOP_ID},(function(t){e.$emit("setOrderItems",e.orderItems),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.getList(),e.$message.warning(t.errorMessage)}))},listProduct:function(e){var t=this;p["a"].listProduct({searchValue:e.name},(function(e){t.restaurants=e.content.map((function(e){return{fullName:e.fullName,sn:e.sn,price:e.price,quantity:"1",subTotal:e.price,productId:e.id,value:e.fullName}})),t.loading=!1}),(function(e){console.log(e),console.log("code错误")}))},querySearchAsync:function(e,t){var i=this.restaurants,a=e?i.filter(this.createStateFilter(e)):i;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t(a)}),300*Math.random())},createStateFilter:function(e){return function(e){return!0}},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()}})},_=y,I=(i("8f05"),i("2877")),w=Object(I["a"])(_,a,r,!1,null,null,null);t["a"]=w.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,i){var a=i("1d80"),r=i("5899"),o="["+r+"]",s=RegExp("^"+o+o+"*"),n=RegExp(o+o+"*$"),l=function(e){return function(t){var i=String(a(t));return 1&e&&(i=i.replace(s,"")),2&e&&(i=i.replace(n,"")),i}};e.exports={start:l(1),end:l(2),trim:l(3)}},"5b8e":function(e,t,i){"use strict";var a=i("9678"),r=i.n(a);r.a},"5c5a":function(e,t,i){},"5e8e":function(e,t,i){"use strict";var a=i("62e0"),r=i.n(a);r.a},"5eb4":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-info"},[i("div",{staticClass:"order-info-div"},[i("div",{staticClass:"order-info-content"},[i("div",{staticClass:"order-top-content"},[i("div",{staticClass:"order-follow-up",on:{click:e.onOrderTrack}},[i("span",[e._v("订单跟踪")]),i("div",{staticClass:"order-state"},[i("span",[e._v(e._s(e.getOrderPaymentState))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]),e.orderInfo.consignee?i("div",{staticClass:"receiver-info"},[i("span",[e._v(e._s(e.orderInfo.consignee))]),i("span",[e._v(e._s(e.orderInfo.phone))]),i("p",[i("i",{staticClass:"el-icon-location-outline",staticStyle:{"margin-right":"5px"}}),e._v(" "+e._s(e.orderInfo.areaName?e.orderInfo.areaName+e.orderInfo.address:e.orderInfo.address)+" ")])]):e._e(),e.orderInfo.appointmentEndDate?i("div",{staticClass:"order-num"},[i("span",[e._v("到店时间：")]),i("span",[e._v(e._s(e.orderInfo.appointmentDate)+"-"+e._s(e.orderInfo.appointmentEndDate.slice(11,20)))])]):e._e(),"6"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("心仪车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("已有车型")]),i("span",[e._v(e._s(e.orderInfo?e.orderInfo.orderItems[0].appointment.car.type:""))])])]):e._e(),"7"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("心仪车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("裸车价格")]),i("span",[e._v("￥"+e._s(e.orderInfo.orderItems[0].appointment.product.price))])]),i("div",{staticClass:"buy-car-detail"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("首付"+e._s(e.getDownPayment))]),i("span",[e._v("￥"+e._s(e.getInitPay))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("月供")]),i("span",[e._v("￥"+e._s(e.getMonthPaidNum))])])]):e._e(),"8"===e.orderInfo.orderType?i("div",{staticClass:"buy-car"},[i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("试驾车型")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.productName:""))])]),i("div",{staticClass:"buy-car-detail"},[i("span",[e._v("预约时间")]),i("span",[e._v(e._s(e.orderInfo.orderItems[0].appointment?e.orderInfo.orderItems[0].appointment.appontmentDate.slice(0,10):""))])])]):e._e(),e.orderInfo.invoiceTitle?i("div",{staticClass:"order-follow-up",on:{click:e.selectInvoice}},[i("span",[e._v("发票抬头")]),i("div",{staticClass:"order-state",staticStyle:{color:"#808080"}},[i("span",[e._v(e._s(e.orderInfo.invoiceTitle?e.orderInfo.invoiceTitle:"无"))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]):e._e()]),i("div",{staticClass:"order-info-new"},[i("div",{staticClass:"shop-name",on:{click:e.goShop}},[i("img",{attrs:{src:e.iconShop}}),i("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(e.orderInfo.shop?e.orderInfo.shop.name:""))])]),e._l(e.orderInfo.orderItems,(function(t,a){return i("div",{key:a},[i("div",{staticClass:"good-info",on:{click:function(i){return e.onClickProduct(t)}}},[i("div",{staticClass:"goods-img"},[i("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:t.thumbnail&&t.thumbnail.indexOf("/")>=0?t.thumbnail:e.defaultImg},on:{error:function(t){return e.imgError(a)}}})]),i("div",{staticClass:"good-right"},[i("div",{staticClass:"good-name"},[i("span",{staticStyle:{flex:"1"}},[e._v(e._s(t.fullName))]),e.showRefund[a]?i("div",{staticClass:"btn-group-div"},[i("div",{staticClass:"btn-group"},[e.showRefund[a]?i("span",{staticClass:"btn-good-pay",on:{click:function(i){return i.stopPropagation(),e.onRefund(t)}}},[e._v(e._s(e.refundsLabel[a]))]):e._e()])]):e._e()]),i("div",{staticStyle:{"margin-bottom":"10px"}},[t.product.barCode?i("span",{staticStyle:{"font-size":"14px","margin-right":"10px"}},[e._v(e._s(t.product.barCode))]):e._e(),i("span",{staticStyle:{"font-size":"14px"}},[e._v("最小包装数："+e._s(t.product.minimumPackQuantity))])]),i("div",{staticClass:"good-price"},[i("span",[e._v("￥"+e._s(t.price))]),i("span",[e._v("X"+e._s(t.quantity))])])])])])})),"1"!==e.orderInfo.isSubscription||e.activity.activityId?e._e():i("div",{staticClass:"subscription"},[i("p",[e._v(" 阶段1：订金￥"+e._s(e.orderInfo.amountPrepay)+" "),i("span",{class:{tips:parseFloat(e.orderInfo.amountPaid)<=0}},[e._v(e._s(parseFloat(e.orderInfo.amountPaid)>0?"已支付":"未支付"))])]),i("p",[e._v(" 阶段2：尾款￥"+e._s(e.orderInfo.amountFinalpay)+" "),i("span",{class:{tips:0!==parseFloat(e.orderInfo.amountPayable)}},[e._v(e._s(0===parseFloat(e.orderInfo.amountPayable)?"已支付":"未支付"))])])])],2),i("div",{staticClass:"price-info-content"},[i("div",{staticClass:"total-price"},[i("span",[e._v("产品总额")]),i("span",[e._v("￥"+e._s(e.getAmount))])]),i("div",{staticClass:"total-price"},[i("span",[e._v("邮费")]),i("span",[e._v("+ ￥"+e._s(e.orderInfo.freight))])]),parseFloat(e.orderInfo.couponDiscount)>0?i("div",{staticClass:"total-price"},[i("span",[e._v("优惠")]),i("span",[e._v("- ￥"+e._s(e.orderInfo.couponDiscount))])]):e._e(),parseFloat(e.getOffsetAmount)>0?i("div",{staticClass:"total-price"},[i("span",[e._v("商家调整")]),i("span",[e._v(e._s(e.getOffsetAmount))])]):e._e(),"1"===e.orderInfo.type?i("div",{staticClass:"total-price"},[i("span",[e._v("需付款")]),i("span",{staticClass:"color"},[e._v("￥"+e._s(e.orderInfo.amountPayable))])]):i("div",{staticClass:"total-price"},[i("span",[e._v("已付款")]),i("span",{staticClass:"color"},[e._v("￥"+e._s(e.orderInfo.amountPaid))])])]),i("div",{staticClass:"pay-type"},[i("span",[e._v("订单编号："+e._s(e.orderInfo.sn))]),e.orderInfo.paymentMethodName?i("span",[e._v("支付方式："+e._s(e.orderInfo.paymentMethodName))]):e._e(),e.orderInfo.shippingMethodName?i("span",[e._v("配送方式："+e._s(e.orderInfo.shippingMethodName))]):e._e(),e.orderInfo.memo?i("div",{staticClass:"message"},[i("span",{staticClass:"label"},[e._v("买家留言：")]),i("span",{staticClass:"buy-message",staticStyle:{"margin-left":"-3px"}},[e._v(e._s(e.orderInfo.memo))])]):e._e(),i("span",[e._v("下单时间："+e._s(e.orderInfo.orderTime))]),e.orderInfo.payments&&e.orderInfo.payments.length?i("span",[e._v("付款时间："+e._s(e.orderInfo.payments[0].paymentDate))]):e._e()])]),i("div",{staticClass:"order-bottom"},[i("div",{staticClass:"btn-group"})])]),i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},[e.showLogistics?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onLookLogistics(e.orderInfo.shippings?e.orderInfo.shippings[0].sn:"")}}},[e._v("物流跟踪")]):e._e(),"4"===e.orderInfo.state&&"0"===e.orderInfo.shippingWay||"3"===e.orderInfo.state&&"1"===e.orderInfo.shippingWay?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.confirmOrder(e.orderInfo)}}},[e._v("确认收货")]):e._e(),"5"===e.orderInfo.state?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onReview(e.orderInfo.id,e.orderInfo.state)}}},[e._v("立即评价")]):e._e(),e.showLookEvaluate?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onLookEvaluate(e.orderInfo.id,e.orderInfo.state)}}},[e._v("查看评价")]):e._e()],1),e.isPend?i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},["1"===e.orderInfo.state&&("1"===e.orderInfo.auditState&&"1"===e.orderInfo.audit||"2"===e.orderInfo.auditState&&"1"===e.orderInfo.audit)?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.toPass(e.orderInfo)}}},[e._v("审核")]):e._e()],1):e._e(),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(t){e.showPassOrder=t}}},[i("div",[i("div",{staticClass:"reson-container"},[i("span",[e._v("审核结果：")]),i("el-radio",{attrs:{label:"1",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("通过")]),i("el-radio",{attrs:{label:"2",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("驳回")]),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[i("span",[e._v("驳回理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:e.curSelectAjectReason,callback:function(t){e.curSelectAjectReason=t},expression:"curSelectAjectReason"}},e._l(e.reasonAjectList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showPassOrder=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange(e.row,e.auditState)}}},[e._v("确定")])],1)]),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("my-invoice",{ref:"invoice"})],1),i("el-dialog",{attrs:{visible:e.dialogVisiableLog,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableLog=t}}},[i("order-track",{ref:"log"})],1),i("el-dialog",{attrs:{visible:e.dialogApplaySale,title:"售后",center:"","append-to-body":""},on:{"update:visible":function(t){e.dialogApplaySale=t}}},[i("apply-sale",{ref:"applysale",attrs:{isEditable:e.isEditable,itemId:e.orderItemId,dialogApplaySale:e.dialogApplaySale},on:{operationSuccess:e.operationSuccess}})],1),i("el-dialog",{attrs:{visible:e.dialogApplayRefundInfo,"append-to-body":""},on:{"update:visible":function(t){e.dialogApplayRefundInfo=t}}},[i("refund-info",{attrs:{itemId:e.itemId,dialogApplayRefundInfo:e.dialogApplayRefundInfo},on:{operationSuccess:e.operationSuccess,applySaleHanlder:e.applySaleHanlder}})],1)],1)},r=[],o=(i("a9e3"),i("b680"),i("d3b7"),i("ac1f"),i("5319"),i("5530")),s=i("f36f"),n=i("2f62"),l=i("1ab1"),d=i("c596"),c=i("e83a"),p=i.n(c),m=i("517a"),u=i.n(m),f=i("f606"),h=i.n(f),g=i("ce09"),b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"order-track"},[i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v("待商家确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v("商家已确认")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.orderLogs,(function(t){return"AuditPassed"===t.type?i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v("审核者："+e._s(t.operator))]),i("p",[e._v(e._s(t.createTime))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.payments.length>0?i("div",[i("p",[e._v("支付方式："+e._s(e.paymentMethod))]),i("p",[e._v("付款方式："+e._s(e.paymentType))]),e._l(e.payments,(function(t){return i("div",{key:t.id},[i("span",{staticStyle:{"font-size":"58px","margin-left":"-15px","vertical-align":"text-bottom"}},[e._v("·")]),i("span",[e._v(e._s("0"===t.paymentStatus?"未支付":"1"===t.paymentStatus?"部分支付":"已支付"))]),i("p",[e._v(e._s(t.paymentDate))]),i("p",[e._v("付款金额：￥"+e._s(t.amount))]),i("p",[e._v("交易号："+e._s(t.sn))])])}))],2):e._e()])]),i("el-step",{attrs:{title:"执行",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,a){return i("div",{key:a},["6"===t.state?i("div",[i("p",[e._v("自动派单")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason))])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v("自动派单")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v("用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile))]):e._e(),t.dispatchRecord?i("div",[e._v(e._s(t.dispatchRecord.createDate))]):e._e(),t.refuseRecord?i("div",[e._v(e._s(t.refuseRecord.reason))]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v("拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks))]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已出发")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(e._s(t.member.nickname)+"已到达")]):e._e(),i("p",[e._v(e._s(t.location))]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"3"===t.state?i("div",[i("p",[e._v("完成救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e(),"4"===t.state?i("div",[i("p",[e._v("取消救援任务")]),i("p",[e._v(e._s(t.happenDate))])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已执行")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),e._l(e.shippings,(function(t){return e.shippings&&e.shippings.length>0?i("div",{key:t.id},["1"===t.shippingStatus?i("p",[e._v("订单已部分发货")]):e._e(),"1"!==t.shippingStatus?i("p",[e._v("订单已执行")]):e._e(),i("p",[e._v(e._s(t.shippingDate))]),i("p",[e._v("物流公司："+e._s(t.logistics))]),i("p",[e._v("物流单号："+e._s(t.expressSn))]),i("p",[e._v(" 收货人："+e._s(t.consignee)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(i){return e.certificate(t.id)}}},[e._v("凭证")])],1),e._l(t.shippingItems,(function(t,a){return i("p",{key:a},[e._v(e._s(t.name)+"*"+e._s(t.quantity))])})),e.devProcessShippings&&e.devProcessShippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.devProcessShippings.shippingTraces,(function(t,a){return i("div",{key:a,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.devProcessShippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()],2):e._e()}))],2)]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v("交易完成")]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已评价")]),e._l(e.reviews,(function(t,a){return i("div",{key:a},["0"===t.reviewType?i("div",[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("商品："+e._s(t.product.name))]),i("p",[e._v("评分："+e._s(t.score)+"分")]),i("p",[e._v("评语："+e._s(t.content))]),e._l(t.images,(function(t,a){return i("div",{key:a,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v("店铺评分")]),i("p",[e._v("服务态度："+e._s(t.serviceAttitude)+"分")]),i("p",[e._v("服务速度："+e._s(t.serviceSpeed)+"分")]),i("p",[e._v("专业技能："+e._s(t.professional)+"分")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v("订单已关闭")]),i("p",[e._v("关闭理由："+e._s(t.content))]),i("p",[e._v("备注："+e._s(t.memo))]),i("p",[e._v(e._s(t.createTime))])]):e._e()})),0)]):e._e()],1),i("el-dialog",{attrs:{title:"",visible:e.outerVisible,"append-to-body":""},on:{"update:visible":function(t){e.outerVisible=t}}},[i("img",{attrs:{src:e.larImg,width:"100%"}})]),i("el-dialog",{attrs:{visible:e.dialogShipping,center:"",width:"1200px","append-to-body":"","custom-class":"printDialog"},on:{"update:visible":function(t){e.dialogShipping=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.printExport}},[e._v("导出")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"center"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.form.sn))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单状态："+e._s("1"===e.shippingsPrint.shippingStatus?"订单已部分发货":"订单已执行"))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("发货时间："+e._s(e.shippingsPrint.shippingDate?e.shippingsPrint.shippingDate.split(" ")[0]:""))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流公司："+e._s(e.shippingsPrint.logistics))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流单号："+e._s(e.shippingsPrint.expressSn))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("物流费用："+e._s(e.shippingsPrint.freight))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingsPrint.consignee))])]),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingsPrint.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货地址："+e._s(e.shippingsPrint.address))])])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("客户签字：")])])],1)],1)])],1)],1)},v=[],y=(i("4160"),i("b0c0"),i("3ca3"),i("466d"),i("1276"),i("159b"),i("ddb0"),i("2b3d"),i("96cf"),i("1da1")),_=i("225d"),I=i("e42c"),w=i("f260"),x=i.n(w),S=i("bc3a"),C=i.n(S),M={name:"order-track",data:function(){return{orderItems:[],loading:!1,open:!1,outerVisible:!1,active:"",larImg:"",orderLogs:[],reviews:[],shippings:[],devProcessShippings:"",payments:[],dialogShipping:!1,form:{},title:"",gridData:[],shippingsPrint:"",memberRescueStates:[],paymentMethodNameReal:"",type:"",amount:"",amountpaid:"",paymentType:"",paymentMethod:"",latestMemberRescueState:"",workers:[],sn:"",consignee:"",fee:"",shippingId:"",operator:"",trackingNo:"",deliveryCorp:"",orderId:"",workerId:"",dispathButton:!1,redispathButton:!1,cbp_tmlabel:!1,imgStyle:"",imageValue:"",currentState:"",preState:"",create:!1,cancel:!1,confirm:!1,service:!1,shipping:!1,payment:!1,complete:!1,review:!1,isCreate:!1,isConfirm:!1,isService:!1,isPayment:!1,isComplete:!1,isReview:!1,isCancel:!1}},props:{},components:{vueEasyPrint:_["a"]},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo"])),{},{styleObject:function(){return{height:"200px",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+x.a+") 50% 50% / 200px no-repeat"}}}),watch:{},methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateLucidLogs"])),{},{devProcess:function(){"新悦物流"===this.deliveryCorp&&this.$emit("logistics",this.orderItems[0].product.vins[0].number),"block"===this.$refs.devProcess[0].style.display?this.$refs.devProcess[0].style.display="none":this.$refs.devProcess[0].style.display="block"},print:function(){this.$refs.easyPrint.print()},printExport:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var i,a,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={shippingId:e.shippingId},t.prev=1,t.next=4,C.a.post("/admin/purchaseOrder/voucher/export/shipping.jhtml",i,{responseType:"blob"});case 4:return a=t.sent,console.log("response => ",a),r=new Blob([a.data],{type:"application/vnd.ms-excel"}),o=decodeURI(a.headers["content-disposition"].split("filename=")[1]),s=document.createElement("a"),s.download=o.match(/"(\S*)"/)[1],s.style.display="none",s.href=URL.createObjectURL(r),document.body.appendChild(s),s.click(),URL.revokeObjectURL(s.href),document.body.removeChild(s),t.abrupt("return");case 19:throw t.prev=19,t.t0=t["catch"](1),new Error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=i+"-"+(a<10?"0"+a:a)+"-"+(r<10?"0"+r:r);return o},certificate:function(e){var t=this,i={shippingId:e};l["a"].get("/admin/purchaseOrder/voucher/shipping.jhtml",i).then((function(i){t.dialogShipping=!0,t.title=t.getUser.shop?t.getUser.shop.name+"发货单":"发货单",t.form=i.order,t.shippingId=e,t.shippingsPrint=i.shipping,t.gridData=i.shipping.shippingItems})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)}))},enlarge:function(e){this.larImg=e,this.outerVisible=!0},getLogs:function(){var e=this,t={clientType:"2",methodName:"QueryOrderLog",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id};l["a"].get("/admin/purchaseOrder/orderLogs.jhtml",t).then((function(t){e.orderLogs=t.orderLogs,e.reviews=t.reviews,e.payments=t.payments,t.payments&&t.payments.length>1?e.amountpaid=Number(t.payments[0].amount)+Number(t.payments[1].amount):e.amountpaid="",e.memberRescueStates=t.memberRescueStates,e.latestMemberRescueState=t.latestMemberRescueState,e.workers=t.workers,e.orderId=t.orderId,e.dispathType=t.dispathType,e.shippings=t.shippings,e.devProcessShippings=t.shippings&&t.shippings[0],t.payments&&(e.paymentType=t.payments.length>0?t.payments[0].paymentType:"",e.paymentMethod=t.payments.length>0?t.payments[0].paymentMethod:"",e.amount=t.payments.length>0?t.payments[0].amount:"",e.fee=t.payments.length>0?t.payments[0].fee:"",e.sn=t.payments.length>0?t.payments[0].sn:""),t.shippings&&(e.deliveryCorp=t.shippings.length>0?t.shippings[0].logistics:"",e.trackingNo=t.shippings.length>0?t.shippings[0].expressSn:"",e.operator=t.shippings.length>0?t.shippings[0].consignee:""),e.consignee=t.order.consignee||"",e.currentState=t.orderLogs[t.orderLogs.length-1].type,t.orderLogs.length>1&&(e.preState=t.orderLogs[t.orderLogs.length-2].type),"create"===e.currentState||"confirm"===e.currentState?e.active="1":"service"===e.currentState||"shipping"===e.currentState?e.active="3":"payment"===e.currentState?e.active="2":"complete"===e.currentState?e.active="4":"review"===e.currentState?e.active="5":"cancel"===e.currentState&&(e.active="6"),!e.latestMemberRescueState||"0"!==e.latestMemberRescueState.state&&"1"!==e.dispathType?(e.dispathButton=!0,e.cbp_tmlabel=!1):(e.dispathButton=!1,e.cbp_tmlabel=!0),e.latestMemberRescueState&&"3"!==e.latestMemberRescueState.state&&"8"!==e.latestMemberRescueState.state&&"9"!==e.latestMemberRescueState.state&&"4"!==e.latestMemberRescueState.state&&"0"!==e.latestMemberRescueState.state?e.redispathButton=!1:e.redispathButton=!0,e.isCreate=!1,e.isPayment=!1,e.isComplete=!1,e.isReview=!1,e.isCancel=!1,e.isService=!1,t.orderLogs.forEach((function(t){"create"===t.type&&(e.isCreate=!0),"payment"===t.type&&(e.isPayment=!0),"complete"===t.type&&(e.isComplete=!0),"review"===t.type&&(e.isReview=!0),"cancel"===t.type&&(e.isCancel=!0),"service"===t.type&&(e.isService=!0),"shipping"===t.type&&(e.isService=!0),"confirm"===t.type&&(e.isService=!0)})),e.serviceLogs=t.serviceLogs||[],e.updateLucidLogs(e.serviceLogs)})).catch((function(e){console.log("ERR: ",e)})).finally((function(){}))},dispath:function(e){var t=this;this.id=this.itemId||"",I["a"].rescuerDispath({orderId:this.id,workerId:this.workerId},(function(e){I["a"].rescueOrderLogs({orderId:t.id,dispathType:"0"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,"0"===t.latestMemberRescueState.state||"7"===t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))}),(function(e){console.log(e)}))},rdispath:function(e){var t=this;this.id=this.itemId||"",I["a"].rescueOrderLogs({orderId:this.id,dispathType:"1"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,t.cbp_tmlabel=!0}),(function(e){console.log(e)}))}}),created:function(){this.getLogs()}},k=M,T=(i("3101"),i("2877")),D=Object(T["a"])(k,b,v,!1,null,null,null),$=D.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"apply-sale-content"},[i("div",{staticClass:"input-area"},[i("el-form",{attrs:{size:"small","label-width":"120px","inline-message":!0}},[i("el-form-item",{attrs:{label:"售后类型："}},[i("el-select",{on:{change:e.inputHandle},model:{value:e.typeStr,callback:function(t){e.typeStr=t},expression:"typeStr"}},e._l(e.options,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"我要退货退款"===e.typeStr||"我要退货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"退货数量："}},[i("el-input-number",{attrs:{size:"mini",min:1},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}})],1):e._e(),"我要换货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"换货数量："}},[i("el-input-number",{attrs:{size:"mini",min:1},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}})],1):e._e(),i("el-form-item",{attrs:{label:"售后原因："}},[i("el-select",{model:{value:e.reasonType,callback:function(t){e.reasonType=t},expression:"reasonType"}},e._l(e.reasonOptions,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"我要换货（无需退款）"===e.typeStr?i("el-form-item",{attrs:{label:"收货地址："}},[i("el-card",{nativeOn:{click:function(t){return e.clickAdress(t)}}},[i("div",{staticClass:"left"},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",{staticStyle:{float:"right"}},[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),"我要退货退款"===e.typeStr||"我要退款（无需退货）"===e.typeStr?i("el-form-item",{attrs:{label:"退款金额："}},[i("el-input",{attrs:{disabled:e.disableInput,type:"text"},model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}})],1):e._e(),i("el-form-item",{attrs:{label:"售后说明："}},[i("el-input",{attrs:{placeholder:"请输入退款说明",type:"textarea"},model:{value:e.explain,callback:function(t){e.explain=t},expression:"explain"}})],1),i("el-form-item",{attrs:{label:"上传图片："}},[i("img-uploader",{model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),i("span",[e._v("当前仅支持.jpeg .jpg .png格式，大小10M以内")])],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onConfirm}},[e._v("确定")])],1)],1)],1),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],1)},L=[],z=(i("c975"),i("25f0"),i("b85c")),P=i("2119"),R=i("ea36"),N={name:"ApplySale",data:function(){return{editable:!1,files:[],typeStr:"我要退款（无需退货）",options:["我要退款（无需退货）","我要退货退款","我要换货（无需退款）","我要退货（无需退款）"],reasonType:"多拍/错拍/不想要",reasonOptions:["多拍/错拍/不想要","快递无跟踪记录","空包裹/少货"],amount:"",explain:"",quantity:"",id:"",disabled:!1,uploadimgs:0,disableInput:!1,dialogVisiable:!1,getAddress:{},depotReceiver:""}},props:{isEditable:{type:Boolean,default:!0},open:{type:Boolean,default:!1},itemId:{type:String,default:""}},components:{ImgUploader:P["a"],BillInfo:R["a"]},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curApplySaleItem"])),{},{images:function(){var e,t=[],i=Object(z["a"])(this.files);try{for(i.s();!(e=i.n()).done;){var a=e.value;t.push(a)}}catch(r){i.e(r)}finally{i.f()}return t},type:function(){return this.options.indexOf(this.typeStr).toString()}}),watch:{itemId:function(e,t){this.changeValue(),this.getAddressList()},open:function(e,t){}},mounted:function(){this.amount=this.curApplySaleItem.maxAmountRefundable,this.quantity=this.curApplySaleItem.quantity,this.disableInput=Number(this.curApplySaleItem.minAmountRefundable)===Number(this.curApplySaleItem.maxAmountRefundable),this.getAddressList()},methods:{changeValue:function(){this.amount=this.curApplySaleItem.maxAmountRefundable,this.quantity=this.curApplySaleItem.quantity,this.disableInput=Number(this.curApplySaleItem.minAmountRefundable)===Number(this.curApplySaleItem.maxAmountRefundable)},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};l["a"].get(d["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.depotReceiver=t.receivers[0].id,e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},inputHandle:function(){this.typeStr===this.options[0]?(this.reasonType="多拍/错拍/不想要",this.reasonOptions=["多拍/错拍/不想要","快递无跟踪记录","空包裹/少货"]):this.typeStr===this.options[1]?(this.reasonType="质量问题",this.reasonOptions=["质量问题","颜色/款式/图案与描述不符","商家发错货"]):this.typeStr===this.options[2]?(this.reasonType="质量问题",this.reasonOptions=["质量问题","商家发错货"]):this.typeStr===this.options[3]&&(this.reasonType="质量问题",this.reasonOptions=["质量问题","多拍/错拍/不想要"])},fileSuccess:function(e){console.log(e.response.urls[0])},onConfirm:function(){if(this.typeStr)if(this.reasonType)if(this.amount){var e=/^\d+(?=\.{0,1}\d+$|$)/;e.test(this.amount)?this.isEditable?this.refundsHandle():this.updateRefunds():this.$message.warning("请输入合法数字")}else this.$message.warning("请输入退款金额");else this.$message.warning("请输入售后原因");else this.$message.warning("请输入售后类型")},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},refundsHandle:function(){var e=this,t={orderId:this.curApplySaleItem.orderId,orderItem:{id:this.curApplySaleItem.id,quantity:this.curApplySaleItem.quantity,product:{id:this.curApplySaleItem.productId}},type:this.options.indexOf(this.typeStr).toString(),reason:this.reasonType,amount:this.amount,quantity:this.quantity,depotReceiver:this.depotReceiver,explain:this.explain,images:this.images,methodName:"AddRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,receiverId:this.getAddress.id};l["a"].post(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("申请成功",t),e.$message.success("申请成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)}))},updateRefunds:function(){var e=this,t={amount:this.amount,quantity:this.quantity,depotReceiver:this.depotReceiver,refundsId:this.id,type:this.type,reason:this.reasonType,explain:this.explain,methodName:"UpdateRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,images:this.images,receiverId:this.getAddress.id};l["a"].put(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("修改申请成功",t),e.$message.success("修改申请成功"),e.$emit("operationSuccess")})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){}))},queryRefunds:function(e){var t=this,i={clientType:"2",methodName:"QueryRefunds",shopId:this.getUser.shop.id,userId:this.getUser.id,id:e};l["a"].get(d["g"].hypermarketMgmt.refunds,i).then((function(e){console.log("修改申请",e),t.typeStr=t.options[e.refunds.type],t.inputHandle(),t.reasonType=e.refunds.reason,t.amount=e.refunds.amount,t.explain=e.refunds.explain,t.id=e.refunds.id;for(var i,a=e.refunds.images,r=a.length,o=0;o<r;o++)t.files.push(i);t.uploadimgs=r})).catch((function(){})).finally((function(){}))},getParams:function(e){this.isEditable||this.queryRefunds(e),"1"!==this.orderInfo.paymentStatus&&"2"!==this.orderInfo.paymentStatus||"0"!==this.orderInfo.shippingStatus?"0"===this.orderInfo.shippingStatus&&"0"===this.orderInfo.paymentStatus?this.options=["我要退货（无需退款）"]:"0"!==this.orderInfo.shippingStatus&&"0"===this.orderInfo.paymentStatus?this.options=["我要退货（无需退款）","我要换货（无需退款）"]:this.options=["我要退款（无需退货）","我要退货退款","我要换货（无需退款）"]:this.options=["我要退款（无需退货）"]},onFinishUpload:function(){this.disabled=!1},onFileUploading:function(){this.disabled=!0},clickAdress:function(){this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e,this.depotReceiver=e.id}},created:function(){}},A=N,B=(i("7bd6"),Object(T["a"])(A,O,L,!1,null,null,null)),F=B.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"refund-info"},[i("div",{staticClass:"o-refund-info"},[i("div",{staticClass:"info-list"},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退货类型：")]),i("div",{staticClass:"des"},[e._v(e._s(e.typeStr))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款金额：")]),i("div",{staticClass:"des"},[e._v(e._s(e.amount))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款原因：")]),i("div",{staticClass:"des"},[e._v(e._s(e.reason))])]),i("div",{staticClass:"info-item"},[i("div",{staticClass:"t"},[e._v("退款说明：")]),i("div",{staticClass:"des"},[e._v(e._s(e.explain))])]),e.curRefundsInfo&&e.curRefundsInfo.returns&&"3"===e.curRefundsInfo.returns[0].type?i("div",{staticClass:"info-item"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("退货地址：")]),i("div",{staticClass:"des"},[e._v(e._s("1"===e.type?e.curRefundsInfo.returns[0].address:""))])]):e._e(),e.curRefundsInfo&&e.curRefundsInfo.images&&e.curRefundsInfo.images.length?i("div",{staticClass:"refunds-img"},[i("span",{staticStyle:{"white-space":"nowrap"}},[e._v("上传图片：")]),e._l(e.curRefundsInfo.images,(function(e){return i("img",{key:e,staticStyle:{margin:"0px 5px"},attrs:{src:e,width:"80px",height:"80px"}})}))],2):e._e(),i("div",{staticClass:"order-track-content"},[i("ul",{staticClass:"trace-info"},[e._l(e.logs,(function(t,a){return[i("li",{key:a,class:t.status},[i("p",{domProps:{innerHTML:e._s(t.title)}}),i("span",[e._v(e._s(t.time))])])]}))],2)])]),i("div",{staticClass:"bottom-action"},[e.btnLabel?i("span",{staticClass:"half-action",on:{click:e.selectLogistics}},[e._v(e._s(e.getBtnLabel))]):e._e(),e.showModefyBtn?i("span",{staticClass:"half-action",on:{click:e.modefyApply}},[e._v("修改申请")]):e._e(),e.showCancelBtn?i("span",{staticClass:"half-action",on:{click:e.cancelApply}},[e._v("取消申请")]):e._e(),e.showReApply?i("span",{staticClass:"half-action",on:{click:e.reApplyHandle}},[e._v("重新申请")]):e._e(),e.showShipping?i("span",{staticClass:"half-action",on:{click:e.confirmShipping}},[e._v("确认收货")]):e._e()])]),i("el-dialog",{attrs:{visible:e.dialogInfo,"append-to-body":""},on:{"update:visible":function(t){e.dialogInfo=t}}},[i("logistic-info",{attrs:{refundsId:e.id},on:{operationSuccess:e.operationSuccess}})],1),i("el-dialog",{attrs:{visible:e.dialogFollowing,"append-to-body":""},on:{"update:visible":function(t){e.dialogFollowing=t}}},[i("logistics-following",{ref:"following",attrs:{sn:e.shippingSn}})],1)],1)},U=[],j=(i("d81d"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"logistic-info-content"},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"物流公司",prop:"deliveryId"}},[i("el-select",{model:{value:e.form.deliveryId,callback:function(t){e.$set(e.form,"deliveryId",t)},expression:"form.deliveryId"}},e._l(e.deliveryOptions,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"物流单号",prop:"trackingNo"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.trackingNo,callback:function(t){e.$set(e.form,"trackingNo",t)},expression:"form.trackingNo"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"退款说明",prop:"explain"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.form.explain,callback:function(t){e.$set(e.form,"explain",t)},expression:"form.explain"}})],1),i("el-form-item",{attrs:{label:""}},[i("img-uploader",{model:{value:e.form.files,callback:function(t){e.$set(e.form,"files",t)},expression:"form.files"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)}),q=[],V=i("8330"),H={name:"LogisticInfo",data:function(){return{deliveryOptions:[],formOperations:[{label:"提交退货物流信息",name:"onConfirm",type:"primary"}],rules:{deliveryId:[{required:!0,message:"请选择物流公司",trigger:"blur"}],trackingNo:[{required:!0,message:"请输入物流单号",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^[1][1,2,3,4,5,6,7,8,9][0-9]{9}$/,message:"电话号格式错误",trigger:"blur"}],explain:[{required:!0,message:"请输入退款说明",trigger:"blur"}]},form:this.getDetaultModel()}},props:{refundsId:{type:String,default:""}},components:{ImgUploader:P["a"],BizSaveButton:V["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curApplySaleItem"])),watch:{},created:function(){this.getDeliveries()},methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateRefundsInfo"])),{},{fileSuccess:function(e){console.log(e.response.urls[0])},getDetaultModel:function(){return{deliveryId:"",files:[],trackingNo:"",mobile:"",explain:""}},operate:function(e){this[e]()},onConfirm:function(){var e=this;this.$refs.form.validate((function(t,i){t&&e.submitLogisticInfo()}))},getDeliveries:function(){var e=this,t={methodName:"ListDeliveryCorp",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,type:"0"};l["a"].get(d["g"].hypermarketMgmt.deliveryCorpsByType,t).then((function(t){e.deliveryOptions=t.deliveryCorps}))},getLogisticsInfo:function(){var e=this,t={methodName:"QueryRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.curApplySaleItem.id};l["a"].get(d["g"].hypermarketMgmt.refunds,t).then((function(t){console.log("退款详情",t),e.updateRefundsInfo(t)})).catch((function(t){e.$message.warning(t.errorMessage)}))},submitLogisticInfo:function(){var e=this,t={orderId:this.curApplySaleItem.orderId,refundsId:this.refundsId,orderItem:{id:this.curApplySaleItem.id,quantity:this.curApplySaleItem.quantity,product:{id:this.curApplySaleItem.productId}},deliveryId:this.form.deliveryId,delivery:this.form.delivery,trackingNo:this.form.trackingNo,mobile:this.form.mobile,explain:this.form.explain,images:this.form.files,methodName:"AddReturns",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id};l["a"].post(d["g"].hypermarketMgmt.returns,t).then((function(t){console.log("填写物流成功",t),e.$message.success("操作成功"),e.$emit("operationSuccess")}))}})},G=H,W=(i("53c9"),Object(T["a"])(G,j,q,!1,null,null,null)),Z=W.exports,Y=i("4382"),J={name:"refund-info",props:{itemId:{type:String,default:""}},data:function(){return{orderItemId:"",type:"",amount:"",reason:"",explain:"",shippingSn:"",btnLabel:!1,dialogInfo:!1,dialogFollowing:!1,id:"",showDialog:!1,showModefyBtn:null,showCancelBtn:null,showReApply:null,showShipping:!1,deliveryCorp:"",trackingNo:"",orderId:""}},components:{LogisticInfo:Z,LogisticsFollowing:Y["a"]},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Order",["orderInfo","curRefundsInfo"])),{},{typeStr:function(){switch(this.type){case"0":return"我要退款(无需退货)";case"1":return"我要退货退款";case"2":return"我要换货(无需退款)";case"3":return"我要退货(无需退款)";default:return""}},getBtnLabel:function(){return"2"===this.curRefundsInfo.returns[0].type?"填写物流":"3"!==this.curRefundsInfo.returns[0].type&&"4"!==this.curRefundsInfo.returns[0].type&&"5"!==this.curRefundsInfo.returns[0].type||"1"!==this.type&&"2"!==this.type?"":"查看物流"},logs:function(){var e=this,t=[];return this.curRefundsInfo&&this.curRefundsInfo.returns&&this.curRefundsInfo.returns.forEach((function(i,a){var r={};switch(r.time=i.happenDate,i.type){case"0":"0"===e.type?r.title="提交退款(无需退货)申请":"2"===e.type?r.title="提交换货申请":"3"===e.type?r.title="提交退货(无需退款)":r.title="提交退货退款申请";break;case"2":r.title="卖家同意售后申请，等待买家发货给卖家<br/>退货地址："+e.curRefundsInfo.returns[0].address||!1;break;case"3":r.title="买家已退货，等待卖家收货<br/>物流公司："+i.deliveryCorp+"<br/>物流单号："+i.trackingNo;break;case"7":r.title="卖家已收到买家的换货商品，待发出换货商品";break;case"8":r.title="卖家已发货，等待买家收货<br/>物流公司："+i.deliveryCorp+"<br/>物流单号："+i.trackingNo,r.type="8";break;case"1":case"4":r.title="退款失败<br/>拒绝原因："+e.curRefundsInfo.returns[0].details+"<br/>备注："+e.curRefundsInfo.returns[0].remarks;break;case"5":r.title="退款成功";break;case"9":r.title="换货完成";break;default:break}r.status=0===a?"cur":"no-started",t.unshift(r)})),t}}),watch:{itemId:function(e,t){this.getLogisticsInfo()}},created:function(){this.getLogisticsInfo()},methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateRefundsInfo","updateApplySaleItem"])),{},{confirmShipping:function(){var e=this,t={refundsId:this.curRefundsInfo.id,state:"2"};l["a"].put("/admin/invoicing/purchase/refunds/takeOver.jhtml",t).then((function(t){e.$message.success("操作成功")})).catch((function(){})).finally((function(){}))},getOrderInfo:function(){var e=this,t={clientType:"2",methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderId};l["a"].get(d["g"].hypermarketMgmt.queryOrder,t).then((function(t){t.order.orderItems.map((function(t){t.id===e.itemId&&e.updateApplySaleItem(t)}))})).catch((function(){})).finally((function(){}))},modefyApply:function(){this.$emit("applySaleHanlder",!1,this.id)},reApplyHandle:function(){this.$emit("applySaleHanlder",!0)},operationSuccess:function(){this.dialogInfo=!1,this.getLogisticsInfo()},cancelApply:function(){var e=this;this.$confirm("请确认是否取消退款申请?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.confirmReceive()}))},confirmReceive:function(){var e=this,t={clientType:"2",methodName:"DeleteRefunds",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.itemId};l["a"].delete(d["g"].hypermarketMgmt.refunds,t).then((function(t){e.$message.success("取消申请成功"),e.$emit("operationSuccess")})).catch((function(){})).finally((function(){}))},getLogisticsInfo:function(){var e=this,t={methodName:"QueryRefunds",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderItemId:this.itemId};l["a"].get(d["g"].hypermarketMgmt.refundsByOrderItemId,t).then((function(t){console.log("退款详情",t),e.type=t.refunds.type,e.amount=t.refunds.amount,e.reason=t.refunds.reason,e.explain=t.refunds.explain,e.id=t.refunds.id,e.orderId=t.refunds.orderItem.orderId,e.orderInfo&&e.orderInfo.orderItems?e.orderInfo.orderItems.map((function(t){t.id===e.itemId&&e.updateApplySaleItem(t)})):e.getOrderInfo(),t.refunds.returns.forEach((function(t){if("3"===t.type)return e.deliveryCorp=t.deliveryCorp,e.trackingNo=t.trackingNo,e.shippingSn=t.shippingSn,!1})),"2"!==t.refunds.returns[0].type&&"3"!==t.refunds.returns[0].type&&"4"!==t.refunds.returns[0].type&&"5"!==t.refunds.returns[0].type||"0"===e.type?e.btnLabel=!1:e.btnLabel=!0,e.updateRefundsInfo(t.refunds),"3"===t.refunds.returns[0].type||"5"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1):"4"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1,e.showReApply=!0):"2"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showShipping=!1,e.showCancelBtn=!0):"1"===t.refunds.returns[0].type?(e.showModefyBtn=!1,e.showCancelBtn=!1,e.showShipping=!1,e.showReApply=!0):"8"===t.refunds.returns[0].type?e.showShipping=!0:(e.showModefyBtn=!0,e.showCancelBtn=!0)})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)}))},touchCS:function(){this.$router.push({path:"/custom-service"})},selectLogistics:function(){var e=this;"2"===this.curRefundsInfo.returns[0].type?this.dialogInfo=!0:"3"!==this.curRefundsInfo.returns[0].type&&"4"!==this.curRefundsInfo.returns[0].type&&"5"!==this.curRefundsInfo.returns[0].type||(this.dialogFollowing=!0,this.$nextTick((function(){e.$refs.following.getLogisticsInfo()})))}})},Q=J,X=(i("e2f0"),Object(T["a"])(Q,E,U,!1,null,null,null)),K=X.exports,ee={name:"order-info",data:function(){return{auditState:"1",remarks:"",row:{},curSelectAjectReason:"申报的商品与实际需要采购的商品不符",reasonAjectList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}],iconShop:h.a,defaultImg:p.a,defaultFailImg:u.a,maxlength:6,passValue:"",dialogVisiable:!1,openCancel:!1,open:!1,showPayment:!1,showPayDeposit:!1,showFinalPayment:!1,showCancelOrder:!1,showBalancePay:!0,thirdPay:!0,showRefund:[],showLogistics:!1,showReceive:!1,showLookEvaluate:!1,showEvaluate:!1,showDialog:!1,refundsLabel:[],loading:!1,showCreatInvoice:!1,dialogVisiableLog:!1,dialogApplaySale:!1,dialogApplayRefundInfo:!1,isEditable:!0,itemId:"",orderItemId:"",showPassOrder:!1}},props:{orderId:{type:String,default:""},isPend:{type:Boolean,default:!1}},watch:{},components:{BizGrid:s["a"],MyInvoice:g["a"],OrderTrack:$,ApplySale:F,RefundInfo:K},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("RecentActivity",["activity","shop","product"])),Object(n["c"])("Order",["orderConfim","orderInfo","routerFrom","curApplySaleItem"])),Object(n["c"])("Order",["orderInfo","curInvoice"])),{},{getOffsetAmount:function(){var e=this.orderInfo.offsetAmount;return e?Number(e)>=0?"+ ￥"+e:"- ￥"+e.substr(1,e.length-1):""},getAmount:function(){var e,t=this.orderInfo.orderItems,i=0;t&&(e=t.length);for(var a=0;a<e;a++)i+=t[a].price*t[a].quantity;return i.toFixed(2)},getOrderPaymentState:function(){if("1"===this.orderInfo.afterSaleStatus)return"退货退款中";switch(this.orderInfo.type){case"1":return"待付款";case"2":return"待收货";case"3":return"待评价";case"5":return"4"===this.orderInfo.orderType||"5"===this.orderInfo.orderType||"6"===this.orderInfo.orderType||"7"===this.orderInfo.orderType||"8"===this.orderInfo.orderType?"商家已确认":"待发货";case"6":return"已完成";case"7":return"已关闭";case"8":return"订单过期";case"9":return"退款退货中";case"10":return"退款退货完成";case"11":return"待商家确认";default:return""}},getDownPayment:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.downPayment)+"%";return t},getInitPay:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.product.price),i=parseFloat(e.downPayment)*t*.01;return i.toFixed(2)},getMonthPaidNum:function(){var e=this.orderInfo.orderItems[0].appointment,t=parseFloat(e.product.price),i=parseFloat(e.downPayment)*t*.01,a=12*parseInt(e.year),r=t-i,o=parseFloat(parseFloat(e.rate)/12),s=Math.pow(1+o,a)-1;if(0===s)return(0).toFixed(2);var n=r*o*Math.pow(1+o,a)/(Math.pow(1+o,a)-1);return n.toFixed(2)}}),methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("Order",["updateOrderInfo","updateOrderId","updateApplySaleItem","updateClickItemSelect"])),{},{imgError:function(e){this.$refs.img&&this.$refs.img[e]&&(this.$refs.img[e].src=this.defaultFailImg)},toPass:function(e,t){this.remarks="",this.row=e,this.showPassOrder=!0},statusChange:function(e,t){var i=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.loading=!0;var a={shopId:window.top.SHOP_ID||"",id:e.id,actionType:t,details:"2"===t?i.curSelectAjectReason:"",remarks:i.remarks};l["a"].post("/admin/purchaseOrderManage/audit.jhtml",a).then((function(e){i.$message.success("操作成功！"),i.showPassOrder=!1,i.loading=!1,i.$emit("closeTabByAudit")})).catch((function(e){i.loading=!1,e.errorMessage&&i.$message.warning(e.errorMessage)})).finally((function(){}))}))},confirmOrder:function(e){var t=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={clientType:"2",methodName:"UpdateOrder",shopId:t.getUser().shop.id,userId:t.getUser().id,orderId:e.id,type:"1"};l["a"].put(d["g"].hypermarketMgmt.purchaseOrder,i).then((function(e){t.$message.success("操作成功"),t.getList()})).catch((function(e){t.$message.warning(e.errorMessage),t.loading=!1})).finally((function(){}))}))},applySaleHanlder:function(e,t){var i=this;this.isEditable=e,this.dialogApplaySale=!0,this.$nextTick((function(){i.$refs.applysale.getParams(t)}))},operationSuccess:function(){this.dialogApplaySale=!1,this.dialogApplayRefundInfo=!1,this.getOrderInfo()},goShop:function(){},handleCartClick:function(e){this.$router.push({path:"/cart"})},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},selectInvoice:function(){var e=this;this.orderInfo.invoiceTitle||"1"!==this.orderInfo.type?(this.dialogVisiable=!0,this.$nextTick((function(){e.$refs.invoice.getInvoiceInfo()}))):this.$message.warning("本订单暂无发票信息，付款后支持补开发票")},hideCancel:function(){this.openCancel=!1},onCancel:function(){this.open=!1},successHandle:function(e){this.getOrderInfo()},onOrderTrack:function(){var e=this;this.dialogVisiableLog=!0,this.$nextTick((function(){e.$refs.log.getLogs()}))},onConsultation:function(){this.$router.push({path:"/custom-service"})},onPay:function(){this.open=!0},onCancelPay:function(){this.openCancel=!0},onConfirm:function(e){var t=this,i={clientType:"2",methodName:"UpdateOrder",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,type:0,content:e};l["a"].put(d["g"].order.cancelOrder,i).then((function(e){t.routerFrom?t.$router.replace({path:t.routerFrom}):(t.openCancel=!1,t.$router.go(-1),t.getOrderInfo())})).catch((function(){})).finally((function(){}))},getOrderInfo:function(){var e=this;this.updateOrderId(this.orderId),this.open=!1;var t={clientType:"2",methodName:"QueryOrderDetail",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id};l["a"].get(d["g"].hypermarketMgmt.queryOrder,t).then((function(t){console.log("订单信息2",t),e.updateOrderInfo(t.order),"1"===e.orderInfo.orderType||"13"===e.orderInfo.orderType?e.showBalancePay=!1:e.showBalancePay=!0,parseFloat(e.orderInfo.amountPayable)?e.thirdPay=!0:e.thirdPay=!1,("2"===e.orderInfo.paymentStatus||"3"===e.orderInfo.paymentStatus)&&parseFloat(e.orderInfo.amount)>0&&!e.orderInfo.invoiceTitle?e.showCreatInvoice=!0:e.showCreatInvoice=!1,e.showRefund=[];var i,a=t.order,r=a.orderItems,o=r.length;for(a.shippings.length>0&&"5"!==a.state&&"6"!==a.state&&"7"!==a.state?e.showLogistics=!0:e.showLogistics=!1,i=0;i<o;i++)e.showRefund.push(!1),e.refundsLabel.push("");for(i=0;i<o;i++)("0"!==a.method&&"2"!==a.method||"1"!==a.type||"0"!==a.orderType&&"2"!==a.orderType&&"9"!==a.orderType&&"10"!==a.orderType&&"3"!==a.orderType&&"6"!==a.orderType&&"7"!==a.orderType&&"8"!==a.orderType)&&("0"!==a.method&&""!==a.method||"1"!==a.orderType&&"13"!==a.orderType&&"17"!==a.orderType||"1"!==a.type)&&("11"!==a.type&&"5"!==a.type||"4"!==a.orderType&&"5"!==a.orderType)?e.showCancelOrder=!1:e.showCancelOrder=!0,"0"!==a.method&&""!==a.method||"1"!==a.orderType&&"13"!==a.orderType&&"17"!==a.orderType||"1"!==a.type?e.showPayment=!1:e.showPayment=!0,"0"!==a.method||"0"!==a.orderType&&"2"!==a.orderType&&"4"!==a.orderType&&"5"!==a.orderType&&"9"!==a.orderType&&"10"!==a.orderType||("1"===a.type?(e.showPayment=!1,e.showPayDeposit=!1,e.showFinalPayment=!1,"1"!==a.isSubscription||e.activity.activityId?e.showPayment=!0:0===Number(a.amountPaid)?e.showPayDeposit=!0:(Number(a.amountPayable)>0&&(e.showFinalPayment=!0,e.showCancelOrder=!1),parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"))):"2"===a.type?(e.showReceive=!0,parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后")):"3"===a.type?(e.showEvaluate=!0,e.showCancelOrder=!1,e.showReceive=!1,parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后")):"5"===a.type&&(parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"),e.showFinalPayment=!1)),"3"!==a.type||"0"!==a.orderType&&"1"!==a.orderType&&"2"!==a.orderType&&"9"!==a.orderType&&"10"!==a.orderType&&"3"!==a.orderType&&"4"!==a.orderType&&"5"!==a.orderType&&"6"!==a.orderType&&"7"!==a.orderType&&"8"!==a.orderType&&"13"!==a.orderType&&"17"!==a.orderType||(e.showEvaluate=!0,e.showCancelOrder=!1),"1"===a.isReviewed?e.showLookEvaluate=!0:e.showLookEvaluate=!1,"1"!==e.orderInfo.orderType&&"13"!==e.orderInfo.orderType&&"17"!==e.orderInfo.orderType&&("6"===e.orderInfo.type?(e.showRefund[i]=!0,e.refundsLabel[i]="售后"):"0"===r[i].refundsState||"2"===r[i].refundsState||"3"===r[i].refundsState?(e.showRefund[i]=!0,e.refundsLabel[i]="申请售后"):"5"===r[i].refundsState?(e.showRefund[i]=!0,e.refundsLabel[i]="退款成功"):"6"===r[i].refundsState?(parseFloat(e.orderInfo.orderItems[i].maxAmountRefundable)>0&&(e.showRefund[i]=!0),e.refundsLabel[i]="申请售后"):"1"!==r[i].refundsState&&"4"!==r[i].refundsState||(e.showRefund[i]=!0,e.refundsLabel[i]="退款失败"))})).catch((function(){})).finally((function(){}))},queryRefunds:function(){this.$router.push({path:this.$route.path+"/myOrder"})},onRefund:function(e){this.updateApplySaleItem(e),console.log("申请退款的信息",e),e.refundsState&&"6"!==e.refundsState?(this.itemId=e.id,this.dialogApplayRefundInfo=!0):(this.orderItemId=e.id,this.dialogApplaySale=!0)},onLookLogistics:function(e){this.$emit("closeTabByLogistics",e)},onConfirmReceive:function(){this.showDialog=!0},onEvaluate:function(){this.$router.push({path:"/my-evaluate/"+this.orderInfo.id+"/true"})},onLookEvaluate:function(e,t){console.log(222),this.$emit("closeTabByEvaluate",e,t)},onReview:function(e,t){this.$emit("closeTabByEvaluate",e,t)},onClickProduct:function(e){},confirmReceive:function(){var e=this,t={clientType:"2",methodName:"UpdateOrder",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,type:"1"};l["a"].put(d["g"].order.cancelOrder,t).then((function(t){console.log("确认收货",t),e.getOrderInfo()})).catch((function(){})).finally((function(){}))},onCreateInvoice:function(){this.updateClickItemSelect(!0),this.$router.push({path:this.$route.fullPath+"/invoiceInfo"})}}),created:function(){}},te=ee,ie=(i("cc46"),Object(T["a"])(te,a,r,!1,null,null,null));t["a"]=ie.exports},"5f95":function(e,t,i){},6116:function(e,t,i){"use strict";var a=i("3772"),r=i.n(a);r.a},"62e0":function(e,t,i){},6401:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-empty-table",style:e.emptyStyle})},r=[],o=i("f260"),s=i.n(o),n={name:"",data:function(){return{EmptyImg:s.a}},components:{},computed:{emptyStyle:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+s.a+") 50% 50% / auto 200px no-repeat"}}},methods:{},mounted:function(){}},l=n,d=i("2877"),c=Object(d["a"])(l,a,r,!1,null,null,null);t["a"]=c.exports},6611:function(e,t,i){},"663e":function(e,t,i){"use strict";var a=i("3f67"),r=i.n(a);r.a},6649:function(e,t,i){"use strict";var a=i("f2d4"),r=i.n(a);r.a},"674b":function(e,t,i){},6975:function(e,t,i){"use strict";var a=i("f65f"),r=i.n(a);r.a},"697f":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[e._t("top"),i("biz-flex-table",{ref:"table",attrs:{showTable:e.showTable,operations:e.operations,filters:e.filters,tags:e.tags,rowKeys:e.rowKeys,pagination:e.pagination,tableData:e.tableData,rowClassName:e.rowClassName,loading:e.loading,memberIds:e.memberIds,checkable:e.checkable,isDepotOutNew:e.isDepotOutNew,checkedTable:e.checkedTable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange,"cascader-change":e.cascaderChange,"active-item-change":e.activeItemChange,"sort-change":e.handleSortChange}},[e._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isClear?i("el-button",{attrs:{size:"small"},on:{click:e.clear}},[e._v("清除")]):e._e(),i("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],2)},r=[],o=(i("99af"),i("4160"),i("c975"),i("a434"),i("a9e3"),i("159b"),i("04d3")),s={name:"BizDialogSelector",components:{BizFlexTable:o["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(e){return e.id},generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]),this.innerSelection.push(t);else{var i=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(i,1),this.innerSelection.splice(i,1)}},open:function(e){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var e=this;this.tableData.forEach((function(t){e.$refs.table.toggleRowSelection(t,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var e=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(t){e.innerSelectionKeys.indexOf(t[e.keyField])>=0?(e.$refs.table.toggleRowSelection(t,!0),"single"===e.selectionMode&&(e.$refs.table.$refs.table.setCurrentRow(t),e.innerSelection=[t])):e.$refs.table.toggleRowSelection(t,!1)}))},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i>=0&&t.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i<0&&t.innerSelectionKeys.push(e[t.keyField])})),this.$emit("selectionChange",e)},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t),this.$emit("selectionChange",e)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},cascaderChange:function(e){this.$emit("cascaderChange",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},handleSortChange:function(e){this.$emit("sort-change",e)},rowClick:function(e,t,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},n=s,l=(i("0943"),i("2877")),d=Object(l["a"])(n,a,r,!1,null,null,null);t["a"]=d.exports},"6bd2":function(e,t,i){},"6c4f":function(e,t,i){"use strict";var a=i("674b"),r=i.n(a);r.a},"6e0b":function(e,t,i){"use strict";var a=i("ff5b"),r=i.n(a);r.a},"6ecb":function(e,t,i){},"6f53":function(e,t,i){var a=i("83ab"),r=i("df75"),o=i("fc6a"),s=i("d1e7").f,n=function(e){return function(t){var i,n=o(t),l=r(n),d=l.length,c=0,p=[];while(d>c)i=l[c++],a&&!s.call(n,i)||p.push(e?[i,n[i]]:n[i]);return p}};e.exports={entries:n(!0),values:n(!1)}},"6f9b":function(e,t,i){"use strict";var a=i("b61f"),r=i.n(a);r.a},7132:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"biz-fade-t"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[i("transition",{attrs:{name:"biz-fade-t-right"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"popup-content",style:e.contentStyle},[e._t("default")],2)])],1)])},r=[],o={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},s=o,n=(i("5b8e"),i("2877")),l=Object(n["a"])(s,a,r,!1,null,null,null),d=l.exports,c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-popup-tabs"},[i("biz-popup",{attrs:{open:e.open,contentStyle:e.contentStyle},on:{close:e.close}},[i("el-tabs",{attrs:{type:"border-card",value:e.value},on:{"tab-click":e.tabClick}},[e._t("default")],2)],1)],1)},p=[],m=(i("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:d},methods:{close:function(){var e=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close")}))},tabClick:function(e){this.$emit("input",e.name)}}}),u=m,f=(i("d4c2"),Object(n["a"])(u,c,p,!1,null,null,null)),h=f.exports;i.d(t,"a",(function(){return h}))},7339:function(e,t,i){"use strict";var a=i("f604"),r=i.n(a);r.a},7400:function(e,t,i){"use strict";var a=i("8819"),r=i.n(a);r.a},"75e2":function(e,t,i){},"765f":function(e,t,i){},7671:function(e,t,i){},"77b6":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"vehicle-mgmt-all-vehicle__base-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operateHandler},slot:"top"}):e._e(),i("div",{staticStyle:{height:"100%"}},[i("vehicle-base-info-content",{ref:"content",attrs:{itemId:e.itemId},on:{"on-loading":e.handleLoading,operationSuccess:e.operationSuccess}})],1)],1)},r=[],o=i("f36f"),s=i("8330"),n=i("3193"),l={name:"VehicleBaseInfo",components:{BizSaveButton:s["a"],BizGrid:o["a"],VehicleBaseInfoContent:n["a"]},data:function(){return{loading:!1,operations:[{label:"保存",name:"save",type:"primary",auth:["admin:car.edit"]}]}},props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},created:function(){},methods:{handleLoading:function(e){this.loading=e},operateHandler:function(e){this[e]()},operationSuccess:function(){this.$emit("operationSuccess")},save:function(){this.$refs.content.save()}}},d=l,c=(i("90c8"),i("2877")),p=Object(c["a"])(d,a,r,!1,null,null,null);t["a"]=p.exports},7895:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"order-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px",size:"small",disabled:!e.isEdit,"inline-message":!0}},[e.itemId?a("el-form-item",{attrs:{label:"订单编号",prop:"sn"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.sn,callback:function(t){e.$set(e.form,"sn",t)},expression:"form.sn"}})],1):e._e(),a("el-form-item",{attrs:{label:"订单状态"}},[e.itemId?a("el-input",{attrs:{disabled:!0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}}):a("el-select",{attrs:{disabled:"couponOrder"===this.$route.params.orderType||"replace"===this.$route.params.orderType||"ride"===this.$route.params.orderType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.orderStateTypeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.showInfo?a("el-form-item",{attrs:{label:"订单原价",prop:"originalAmount"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.originalAmount,callback:function(t){e.$set(e.form,"originalAmount",t)},expression:"form.originalAmount"}})],1):e._e(),e.form.amountPrepay?a("el-form-item",{attrs:{label:"订金",prop:"amountPrepay"}},[a("el-input",{attrs:{disabled:""!==e.itemId&&("交易完成"===e.form.type||"订单关闭"===e.form.type||"已评价"===e.form.type)},model:{value:e.form.amountPrepay,callback:function(t){e.$set(e.form,"amountPrepay",t)},expression:"form.amountPrepay"}})],1):e._e(),e.form.amountFinalpay?a("el-form-item",{attrs:{label:"尾款",prop:"amountFinalpay"}},[a("el-input",{attrs:{disabled:""!==e.itemId&&("交易完成"===e.form.type||"订单关闭"===e.form.type||"已评价"===e.form.type)},model:{value:e.form.amountFinalpay,callback:function(t){e.$set(e.form,"amountFinalpay",t)},expression:"form.amountFinalpay"}})],1):e._e(),e.showInfo?a("el-form-item",{attrs:{label:"调整金额",prop:"offsetAmount"}},[a("el-input-number",{attrs:{"controls-position":"right",disabled:""!==e.itemId&&"2"===e.form.paymentStatus||"订单关闭"===e.form.type},on:{change:e.offsetAmountChange},model:{value:e.form.offsetAmount,callback:function(t){e.$set(e.form,"offsetAmount",t)},expression:"form.offsetAmount"}})],1):e._e(),e.showInfo?a("el-form-item",{attrs:{label:"订单现价",prop:"amount"}},[a("el-input",{attrs:{disabled:""!==e.itemId&&"2"===e.form.paymentStatus||"订单关闭"===e.form.type},on:{change:e.curAmountChange},model:{value:e.form.curAmount,callback:function(t){e.$set(e.form,"curAmount",t)},expression:"form.curAmount"}})],1):e._e(),a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{name:"1"}},[-1!==e.activeNames.indexOf("1")&&e.handler?a("template",{slot:"title"},[a("div",{staticClass:"title-class"},[a("div",{staticClass:"title-class-one"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("客户信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("1")&&e.handler?e._e():a("template",{slot:"title"},[e._v("客户信息")]),a("el-form-item",{staticClass:"isRequired",attrs:{label:"会员昵称",prop:"member.nickname"}},[a("el-input",{attrs:{disabled:!!e.itemId,placeholder:"请选择或添加会员"},model:{value:e.form.member.nickname,callback:function(t){e.$set(e.form.member,"nickname",t)},expression:"form.member.nickname"}},[e.itemId?e._e():a("div",{staticClass:"input-append",attrs:{slot:"append"},slot:"append"},[a("el-button",{attrs:{type:"text"},on:{click:e.addMember}},[a("i",{staticClass:"el-icon-circle-plus-outline"})]),a("el-button",{attrs:{type:"text"},on:{click:e.showDialogFc}},[a("i",{staticClass:"iconfont biz-icon-man"})])],1)])],1),a("el-form-item",{attrs:{label:"性别",prop:"member.gender"}},[a("el-select",{attrs:{disabled:!1===!e.itemId},model:{value:e.form.member.gender,callback:function(t){e.$set(e.form.member,"gender",t)},expression:"form.member.gender"}},[a("el-option",{attrs:{label:"男",value:"0"}}),a("el-option",{attrs:{label:"女",value:"1"}}),a("el-option",{attrs:{label:"保密",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"电话",prop:"member.mobile"}},[a("el-input",{attrs:{disabled:!1===!e.itemId,placeholder:"请输入电话"},model:{value:e.form.member.mobile,callback:function(t){e.$set(e.form.member,"mobile",t)},expression:"form.member.mobile"}})],1),a("el-form-item",{attrs:{label:"车辆",prop:"car.id"}},[a("el-select",{attrs:{placeholder:"请选择车辆",disabled:""!==e.itemId},on:{change:e.carChange},model:{value:e.form.car.id,callback:function(t){e.$set(e.form.car,"id",t)},expression:"form.car.id"}},e._l(e.cars,(function(e,t){return a("el-option",{key:t,attrs:{label:e.plateNumber,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"车型",prop:"car.type"}},[a("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.car.type,callback:function(t){e.$set(e.form.car,"type",t)},expression:"form.car.type"}})],1),e.form.plateNumber?e._e():a("el-form-item",{attrs:{label:"行驶里程",prop:"car.drivingRange"}},[a("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.car.drivingRange,callback:function(t){e.$set(e.form.car,"drivingRange",t)},expression:"form.car.drivingRange"}})],1),e.form.plateNumber?a("el-form-item",{attrs:{label:"行驶里程",prop:"drivingRange"}},[a("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.drivingRange,callback:function(t){e.$set(e.form,"drivingRange",t)},expression:"form.drivingRange"}})],1):e._e()],2),a("el-collapse-item",{attrs:{name:"2"}},[-1!==e.activeNames.indexOf("2")&&e.handler?a("template",{slot:"title"},[a("div",{staticClass:"title-class"},[a("div",{staticClass:"title-class-one"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("服务信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("2")&&e.handler?e._e():a("template",{slot:"title"},[e._v("服务信息")]),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"呼叫方式",prop:"orderItems[0].appointment.way"}},[a("el-select",{attrs:{placeholder:"请选择呼叫方式"},model:{value:e.form.orderItems[0].appointment.way,callback:function(t){e.$set(e.form.orderItems[0].appointment,"way",t)},expression:"form.orderItems[0].appointment.way"}},[a("el-option",{attrs:{label:"电话",value:"0"}}),a("el-option",{attrs:{label:"在线",value:"1"}})],1)],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"救援机构",prop:"orderItems[0].appointment.rescueUnit"}},[a("el-select",{attrs:{placeholder:"请选择救援机构"},model:{value:e.form.orderItems[0].appointment.rescueUnit,callback:function(t){e.$set(e.form.orderItems[0].appointment,"rescueUnit",t)},expression:"form.orderItems[0].appointment.rescueUnit"}},e._l(e.rescueOrganizations,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"救援人员",prop:"orderItems[0].appointment.rescuerId"}},[a("el-select",{attrs:{placeholder:"请选择救援人员"},model:{value:e.form.orderItems[0].appointment.rescuerId,callback:function(t){e.$set(e.form.orderItems[0].appointment,"rescuerId",t)},expression:"form.orderItems[0].appointment.rescuerId"}},e._l(e.workers,(function(e,t){return a("el-option",{key:t,attrs:{label:e.nickname,value:e.id}})})),1)],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"救援地点",prop:"orderItems[0].appointment.workerLocation"}},[a("el-input",{attrs:{placeholder:"请输入救援地点"},model:{value:e.form.orderItems[0].appointment.workerLocation,callback:function(t){e.$set(e.form.orderItems[0].appointment,"workerLocation",t)},expression:"form.orderItems[0].appointment.workerLocation"}})],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"服务项目",prop:"orderItems[0].appointment.reasons"}},[a("el-checkbox-group",{model:{value:e.form.orderItems[0].appointment.reasons,callback:function(t){e.$set(e.form.orderItems[0].appointment,"reasons",t)},expression:"form.orderItems[0].appointment.reasons"}},e._l(e.reasons,(function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.id}},[e._v(e._s(t.content))])})),1)],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{staticClass:"imgUpload",attrs:{label:"图片信息"}},[a("el-upload",{attrs:{action:"/admin/file/uploads.jhtml","before-upload":e.beforeAvatarUpload,"file-list":e.imageList,"list-type":"picture-card",name:"file",accept:"image/*",data:{type:"0"},"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.handleSuccess}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:e.picDialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1):e._e(),"rescue"===this.$route.params.orderType&&e.itemId?a("el-form-item",{attrs:{label:"语音信息"}},e._l(e.form.orderItems[0].appointment.voices,(function(e,t){return a("div",{key:t},[a("audio",{attrs:{src:e.path,controls:""}})])})),0):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"服务日期",prop:"orderItems[0].appointment.appontmentDate"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"请选择服务日期"},model:{value:e.form.orderItems[0].appointment.appontmentDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"appontmentDate",t)},expression:"form.orderItems[0].appointment.appontmentDate"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"开始时间",prop:"orderItems[0].appointment.driveStartDate"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.driveStartDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"driveStartDate",t)},expression:"form.orderItems[0].appointment.driveStartDate"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"结束时间",prop:"orderItems[0].appointment.driveEndDate"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.driveEndDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"driveEndDate",t)},expression:"form.orderItems[0].appointment.driveEndDate"}})],1):e._e(),"service"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"服务日期",prop:"appointmentDate"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"请选择服务日期",clearable:!1,editable:!1},model:{value:e.appointmentDate,callback:function(t){e.appointmentDate=t},expression:"appointmentDate"}})],1):e._e(),"service"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"开始时间",prop:"appointmentStartDate"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",editable:!1,clearable:!1},model:{value:e.form.appointmentDate,callback:function(t){e.$set(e.form,"appointmentDate",t)},expression:"form.appointmentDate"}})],1):e._e(),"service"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"结束时间",prop:"appointmentEndDate"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",editable:!1,clearable:!1},model:{value:e.form.appointmentEndDate,callback:function(t){e.$set(e.form,"appointmentEndDate",t)},expression:"form.appointmentEndDate"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"使用时间(分)",prop:"useTime"}},[a("el-input",{attrs:{value:e.dateInterval(e.form.orderItems[0].appointment.driveEndDate,e.form.orderItems[0].appointment.driveStartDate),disabled:!0}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"开始里程",prop:"orderItems[0].appointment.startMileage"}},[a("el-input-number",{attrs:{"controls-position":"right",precision:0,min:0,disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.startMileage,callback:function(t){e.$set(e.form.orderItems[0].appointment,"startMileage",t)},expression:"form.orderItems[0].appointment.startMileage"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"结束里程",prop:"orderItems[0].appointment.endMileage"}},[a("el-input-number",{attrs:{"controls-position":"right",precision:0,min:0,disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.endMileage,callback:function(t){e.$set(e.form.orderItems[0].appointment,"endMileage",t)},expression:"form.orderItems[0].appointment.endMileage"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"使用里程(公里)"}},[a("el-input",{attrs:{value:e.form.orderItems[0].appointment.endMileage-e.form.orderItems[0].appointment.startMileage,disabled:!0}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"实际试驾车号",prop:"orderItems[0].appointment.plateNumber"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入实际试驾车号"},on:{select:e.handleSelect},model:{value:e.form.orderItems[0].appointment.plateNumber,callback:function(t){e.$set(e.form.orderItems[0].appointment,"plateNumber",t)},expression:"form.orderItems[0].appointment.plateNumber"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"实际试驾车型",prop:"testDriveId"}},[a("el-select",{model:{value:e.form.orderItems[0].appointment.testDriveId,callback:function(t){e.$set(e.form.orderItems[0].appointment,"testDriveId",t)},expression:"form.orderItems[0].appointment.testDriveId"}},e._l(e.restaurants,(function(e){return a("el-option",{key:e.id,attrs:{label:e.type,value:e.id}})})),1)],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"预约试驾车型",prop:"orderItems[0].appointment.product.fullName"}},[a("el-input",{attrs:{placeholder:"请选择预约试驾车型"},on:{focus:e.queryProduct},model:{value:e.form.orderItems[0].appointment.product.fullName,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"fullName",t)},expression:"form.orderItems[0].appointment.product.fullName"}})],1):e._e(),"replace"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"已有车型",prop:"orderItems[0].appointment.car.type"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.orderItems[0].appointment.car.type,callback:function(t){e.$set(e.form.orderItems[0].appointment.car,"type",t)},expression:"form.orderItems[0].appointment.car.type"}})],1):e._e(),"replace"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"行驶里程",prop:"orderItems[0].appointment.drivingRange"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.form.orderItems[0].appointment.drivingRange,callback:function(t){e.$set(e.form.orderItems[0].appointment,"drivingRange",t)},expression:"form.orderItems[0].appointment.drivingRange"}})],1):e._e(),"replace"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"上牌时间",prop:"orderItems[0].appointment.onTime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.orderItems[0].appointment.onTime,callback:function(t){e.$set(e.form.orderItems[0].appointment,"onTime",t)},expression:"form.orderItems[0].appointment.onTime"}})],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"心仪车型",prop:"orderItems[0].appointment.product.brandId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌",filterable:""},on:{change:e.handleBrandChange},model:{value:e.form.orderItems[0].appointment.product.brandId,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"brandId",t)},expression:"form.orderItems[0].appointment.product.brandId"}},e._l(e.brandList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"",prop:"orderItems[0].appointment.product.seriesId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列",filterable:""},on:{change:e.handleSeriesChange},model:{value:e.form.orderItems[0].appointment.product.seriesId,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"seriesId",t)},expression:"form.orderItems[0].appointment.product.seriesId"}},e._l(e.seriesList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"",prop:"orderItems[0].appointment.product.id"}},[a("el-select",{staticClass:"isRequired",staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型"},on:{change:e.productChange},model:{value:e.form.orderItems[0].appointment.product.id,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"id",t)},expression:"form.orderItems[0].appointment.product.id"}},e._l(e.modeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"裸车总价",prop:"orderItems[0].appointment.product.price"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.orderItems[0].appointment.product.price,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"price",t)},expression:"form.orderItems[0].appointment.product.price"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"金融方案",prop:"orderItems[0].appointment.financialPlan.id"}},[a("el-select",{attrs:{placeholder:"请选择金融方案"},on:{change:function(t){return e.loanTerm(e.form.orderItems[0].appointment.financialPlan.id)}},model:{value:e.form.orderItems[0].appointment.financialPlan.id,callback:function(t){e.$set(e.form.orderItems[0].appointment.financialPlan,"id",t)},expression:"form.orderItems[0].appointment.financialPlan.id"}},e._l(e.financialPlans,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"首付比例",prop:"orderItems[0].appointment.downPayment"}},[a("el-select",{attrs:{placeholder:"请选择首付比例"},on:{change:e.monthPay},model:{value:e.form.orderItems[0].appointment.downPayment,callback:function(t){e.$set(e.form.orderItems[0].appointment,"downPayment",t)},expression:"form.orderItems[0].appointment.downPayment"}},e._l(e.form.orderItems[0].appointment.financialPlan.downPayments,(function(e,t){return a("el-option",{key:t,attrs:{label:Math.round(e)+"%",value:e}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"还款期限",prop:"orderItems[0].appointment.year"}},[a("el-select",{attrs:{placeholder:"请选择还款年限"},on:{change:e.monthPay},model:{value:e.form.orderItems[0].appointment.year,callback:function(t){e.$set(e.form.orderItems[0].appointment,"year",t)},expression:"form.orderItems[0].appointment.year"}},e._l(e.form.orderItems[0].appointment.financialPlan.loanTerms,(function(e,t){return a("el-option",{key:t,attrs:{label:e.year+"年",value:e.year}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"首付金额"}},[a("el-input",{attrs:{value:e.form.orderItems[0].appointment.product.price?e.form.orderItems[0].appointment.product.price*e.form.orderItems[0].appointment.downPayment/100:e.form.orderItems[0].appointment.product.price,disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"贷款额度"}},[a("el-input",{attrs:{value:e.form.orderItems[0].appointment.product.price?e.form.orderItems[0].appointment.product.price-e.form.orderItems[0].appointment.product.price*e.form.orderItems[0].appointment.downPayment/100:e.form.orderItems[0].appointment.product.price,disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"月供"}},[a("el-input",{attrs:{value:e.monthPay(),disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"手续费",prop:"orderItems[0].appointment.fee"}},[a("el-input",{attrs:{placeholder:"请输入手续费"},model:{value:e.form.orderItems[0].appointment.fee,callback:function(t){e.$set(e.form.orderItems[0].appointment,"fee",t)},expression:"form.orderItems[0].appointment.fee"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"身份证",prop:"orderItems[0].appointment.personId"}},[a("el-input",{attrs:{placeholder:"请输入身份证"},model:{value:e.form.orderItems[0].appointment.personId,callback:function(t){e.$set(e.form.orderItems[0].appointment,"personId",t)},expression:"form.orderItems[0].appointment.personId"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"工作单位",prop:"orderItems[0].appointment.workUnit"}},[a("el-input",{attrs:{placeholder:"请输入工作单位"},model:{value:e.form.orderItems[0].appointment.workUnit,callback:function(t){e.$set(e.form.orderItems[0].appointment,"workUnit",t)},expression:"form.orderItems[0].appointment.workUnit"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"房屋情况",prop:"orderItems[0].appointment.houseState"}},[a("el-select",{model:{value:e.form.orderItems[0].appointment.houseState,callback:function(t){e.$set(e.form.orderItems[0].appointment,"houseState",t)},expression:"form.orderItems[0].appointment.houseState"}},[a("el-option",{attrs:{label:"有",value:"1"}}),a("el-option",{attrs:{label:"无",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"上牌城市",prop:"orderItems[0].appointment.onCity"}},[a("el-input",{attrs:{placeholder:"请输入上牌城市"},model:{value:e.form.orderItems[0].appointment.onCity,callback:function(t){e.$set(e.form.orderItems[0].appointment,"onCity",t)},expression:"form.orderItems[0].appointment.onCity"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"意向购车时间",prop:"orderItems[0].appointment.intentionTime"}},[a("el-select",{attrs:{placeholder:"请选择意向购车时间"},model:{value:e.form.orderItems[0].appointment.intentionTime,callback:function(t){e.$set(e.form.orderItems[0].appointment,"intentionTime",t)},expression:"form.orderItems[0].appointment.intentionTime"}},[a("el-option",{attrs:{label:"一年",value:"4"}}),a("el-option",{attrs:{label:"半年",value:"3"}}),a("el-option",{attrs:{label:"三个月",value:"2"}}),a("el-option",{attrs:{label:"两个月",value:"1"}}),a("el-option",{attrs:{label:"一个月",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"月收入",prop:"orderItems[0].appointment.monthIncome"}},[a("el-select",{attrs:{placeholder:"请选择月收入"},model:{value:e.form.orderItems[0].appointment.monthIncome,callback:function(t){e.$set(e.form.orderItems[0].appointment,"monthIncome",t)},expression:"form.orderItems[0].appointment.monthIncome"}},[a("el-option",{attrs:{label:"20000以上",value:"4"}}),a("el-option",{attrs:{label:"15000-19999",value:"3"}}),a("el-option",{attrs:{label:"10000-14999",value:"2"}}),a("el-option",{attrs:{label:"5000-9999",value:"1"}}),a("el-option",{attrs:{label:"0-4999",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"有车情况",prop:"orderItems[0].appointment.carState"}},[a("el-select",{attrs:{placeholder:"请选择有车情况"},model:{value:e.form.orderItems[0].appointment.carState,callback:function(t){e.$set(e.form.orderItems[0].appointment,"carState",t)},expression:"form.orderItems[0].appointment.carState"}},[a("el-option",{attrs:{label:"有",value:"1"}}),a("el-option",{attrs:{label:"无",value:"0"}})],1)],1):e._e(),a("el-form-item",{staticClass:"isRequired",attrs:{label:"顾问",prop:"consultant.id"}},[a("el-select",{attrs:{placeholder:"请选择顾问"},model:{value:e.form.consultant.id,callback:function(t){e.$set(e.form.consultant,"id",t)},expression:"form.consultant.id"}},e._l(e.consultants,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name||"未填写",value:e.id}})})),1)],1),"service"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"业务类型"}},[a("tag-select",{ref:"tagSelect",attrs:{tagList:e.tagList,bAddTag:!1,selectType:"order",selectedTags:e.selectedTags},on:{addSuccess:e.onAddSuccess}})],1):e._e(),a("el-form-item",{attrs:{label:"买家留言",prop:"memo"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],2),e.showPayment||!e.itemId&&"0"===e.form.type?a("el-collapse-item",{attrs:{name:"4"}},[-1!==e.activeNames.indexOf("4")&&e.handler?a("template",{slot:"title"},[a("div",{staticClass:"title-class"},[a("div",{staticClass:"title-class-one"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("付款信息")])],1)])]):e._e(),-1===e.activeNames.indexOf("4")||!e.handler||!e.itemId&&"0"===e.form.type?a("template",{slot:"title"},[e._v("付款信息")]):e._e(),e.itemId||!e.itemId&&"0"===e.form.type?a("el-form-item",{staticClass:"isRequired",attrs:{label:"支付方式",prop:"paymentMethodId"}},[a("el-select",{attrs:{disabled:!1===!e.itemId,placeholder:"请选择支付方式"},model:{value:e.form.paymentMethodId,callback:function(t){e.$set(e.form,"paymentMethodId",t)},expression:"form.paymentMethodId"}},e._l(e.paymentMethods,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e.showPayment&&"0"!==e.form.type?a("el-form-item",{staticClass:"isRequired",attrs:{label:"付款方式",prop:"payments[0].paymentType"}},[a("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择付款方式"},on:{change:e.paymentTypeChange},model:{value:e.form.payments[0].paymentType,callback:function(t){e.$set(e.form.payments[0],"paymentType",t)},expression:"form.payments[0].paymentType"}},e._l(e.paymentTypes,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1):e._e(),"会员卡余额"===e.form.payments[0].paymentType&&"0"!==e.form.type?a("el-form-item",{staticClass:"isRequired",attrs:{label:"会员卡",prop:"memberCardId"}},[a("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择会员卡"},on:{change:e.memberCardChange},model:{value:e.form.memberCardId,callback:function(t){e.$set(e.form,"memberCardId",t)},expression:"form.memberCardId"}},e._l(e.listExistCard,(function(e,t){return a("el-option",{key:t,attrs:{label:e.template.name,value:e.id}})})),1)],1):e._e(),"刷卡"===e.form.payments[0].paymentType||"汇款"===e.form.payments[0].paymentType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"付款银行",prop:"payments[0].payBank"}},[a("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择付款银行"},model:{value:e.form.payments[0].payBank,callback:function(t){e.$set(e.form.payments[0],"payBank",t)},expression:"form.payments[0].payBank"}},[a("el-option",{attrs:{label:"中国工商银行",value:"中国工商银行"}}),a("el-option",{attrs:{label:"中国农业银行",value:"中国农业银行"}}),a("el-option",{attrs:{label:"中国银行",value:"中国银行"}}),a("el-option",{attrs:{label:"中国建设银行",value:"中国建设银行"}}),a("el-option",{attrs:{label:"交通银行",value:"交通银行"}}),a("el-option",{attrs:{label:"中信银行",value:"中信银行"}}),a("el-option",{attrs:{label:"广发银行",value:"广发银行"}}),e._v("、 "),a("el-option",{attrs:{label:"深圳发展银行",value:"深圳发展银行"}}),a("el-option",{attrs:{label:"招商银行",value:"招商银行"}}),a("el-option",{attrs:{label:"中国光大银行",value:"中国光大银行"}}),a("el-option",{attrs:{label:"华夏银行",value:"华夏银行"}}),a("el-option",{attrs:{label:"中国民生银行",value:"中国民生银行"}}),a("el-option",{attrs:{label:"兴业银行",value:"兴业银行"}}),a("el-option",{attrs:{label:"上海浦东发展银行",value:"上海浦东发展银行"}}),a("el-option",{attrs:{label:"恒丰银行",value:"恒丰银行"}}),a("el-option",{attrs:{label:"浙商银行",value:"浙商银行"}}),a("el-option",{attrs:{label:"渤海银行",value:"渤海银行"}}),a("el-option",{attrs:{label:"中国邮政储蓄银行",value:"中国邮政储蓄银行"}}),a("el-option",{attrs:{label:"其他银行",value:"其他银行"}})],1)],1):e._e(),"刷卡"===e.form.payments[0].paymentType||"汇款"===e.form.payments[0].paymentType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"付款帐号",prop:"payments[0].payAccount"}},[a("el-input",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请输入付款帐号"},model:{value:e.form.payments[0].payAccount,callback:function(t){e.$set(e.form.payments[0],"payAccount",t)},expression:"form.payments[0].payAccount"}})],1):e._e()],2):e._e(),e.showInfo?a("el-collapse-item",{attrs:{title:"优惠信息",name:"3"}},[e.itemId?a("div",[a("el-form-item",{attrs:{label:"优惠券折扣",prop:"couponDiscount"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.couponDiscount,callback:function(t){e.$set(e.form,"couponDiscount",t)},expression:"form.couponDiscount"}})],1),a("el-form-item",{attrs:{label:"V豆抵扣",prop:"bean"}},[a("el-input-number",{attrs:{disabled:!0,"controls-position":"right"},model:{value:e.form.bean,callback:function(t){e.$set(e.form,"bean",t)},expression:"form.bean"}})],1),a("el-form-item",{attrs:{label:"赠送积分",prop:"point"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.point,callback:function(t){e.$set(e.form,"point",t)},expression:"form.point"}})],1),a("el-form-item",{attrs:{label:"赠送V豆",prop:"giftBean"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.giftBean,callback:function(t){e.$set(e.form,"giftBean",t)},expression:"form.giftBean"}})],1)],1):a("div",[a("el-form-item",{attrs:{label:"福利",prop:"couponDiscount"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.couponChange},model:{value:e.form.couponCodeId,callback:function(t){e.$set(e.form,"couponCodeId",t)},expression:"form.couponCodeId"}},e._l(e.form.couponList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.coupon.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"V豆抵扣",prop:"bean"}},[a("el-input-number",{attrs:{"controls-position":"right",disabled:!("会员卡余额"===e.form.payments[0].paymentType&&e.form.memberCardId&&e.form.bean),min:0},on:{change:e.beanChange},model:{value:e.form.bean,callback:function(t){e.$set(e.form,"bean",t)},expression:"form.bean"}}),"会员卡余额"===e.form.payments[0].paymentType&&e.form.memberCardId?a("div",[e._v(e._s(e.beanCanUse))]):e._e()],1)],1)]):e._e(),"product"===this.$route.params.orderType||"car"===this.$route.params.orderType||"general"===this.$route.params.orderType||"service"===this.$route.params.orderType||"rescue"===this.$route.params.orderType?a("el-collapse-item",{attrs:{name:"5"}},[-1!==e.activeNames.indexOf("5")&&e.handler?a("template",{slot:"title"},[a("div",{staticClass:"title-class"},[a("div",{staticClass:"title-class-one"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("物流信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("5")&&e.handler?e._e():a("template",{slot:"title"},[e._v("物流信息")]),a("el-form-item",{attrs:{label:"配送方式",prop:"shippingMethodName"}},[a("el-select",{attrs:{disabled:!!e.itemId,placeholder:"请选择配送方式"},on:{change:e.onShippingChange},model:{value:e.form.shippingMethodName,callback:function(t){e.$set(e.form,"shippingMethodName",t)},expression:"form.shippingMethodName"}},[a("el-option",{attrs:{label:"空",value:""}}),e._l(e.shippingMethod,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})}))],2)],1),e.form.shippingMethodName&&e.showDelivery?a("el-form-item",{staticClass:"isRequired",attrs:{label:"物流公司",prop:"shippings[0].deliveryCorpId"}},[a("el-select",{attrs:{filterable:"",disabled:!!e.itemId&&("shipping"!==e.handler||e.isShipped),placeholder:"请选择物流公司"},model:{value:e.form.shippings[0].deliveryCorpId,callback:function(t){e.$set(e.form.shippings[0],"deliveryCorpId",t)},expression:"form.shippings[0].deliveryCorpId"}},e._l(e.deliveryCorps,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e.form.shippingMethodName&&e.showDelivery?a("el-form-item",{staticClass:"isRequired",attrs:{label:"物流单号",prop:"shippings[0].expressSn"}},[a("el-input",{attrs:{disabled:!!e.itemId&&("shipping"!==e.handler||e.isShipped),placeholder:"请输入物流单号"},model:{value:e.form.shippings[0].expressSn,callback:function(t){e.$set(e.form.shippings[0],"expressSn",t)},expression:"form.shippings[0].expressSn"}})],1):e._e(),e.form.shippingMethodName&&e.showDelivery?a("el-form-item",{staticClass:"isRequired",attrs:{label:"物流费用",prop:"shippings[0].freight"}},[a("el-input",{attrs:{disabled:!!e.itemId&&("shipping"!==e.handler||e.isShipped),placeholder:"请输入物流费用"},on:{change:e.freightChange},model:{value:e.form.shippings[0].freight,callback:function(t){e.$set(e.form.shippings[0],"freight",t)},expression:"form.shippings[0].freight"}})],1):e._e(),e.form.shippingMethodName&&e.showReceiver?a("el-form-item",{staticClass:"isRequired",attrs:{label:"收货地址",prop:"shippings[0].address"}},[a("el-input",{attrs:{disabled:!!e.itemId&&("shipping"!==e.handler||e.isShipped),placeholder:"请输入收货地址"},model:{value:e.form.shippings[0].address,callback:function(t){e.$set(e.form.shippings[0],"address",t)},expression:"form.shippings[0].address"}})],1):e._e(),e.form.shippingMethodName&&e.showReceiver?a("el-form-item",{staticClass:"isRequired",attrs:{label:"收货人",prop:"shippings[0].consignee"}},[a("el-input",{attrs:{disabled:!!e.itemId&&("shipping"!==e.handler||e.isShipped),placeholder:"请输入收货人"},model:{value:e.form.shippings[0].consignee,callback:function(t){e.$set(e.form.shippings[0],"consignee",t)},expression:"form.shippings[0].consignee"}})],1):e._e(),e.form.shippingMethodName&&e.showReceiver?a("el-form-item",{staticClass:"isRequired",attrs:{label:"电话",prop:"shippings[0].phone"}},[a("el-input",{attrs:{disabled:!!e.itemId&&("shipping"!==e.handler||e.isShipped),placeholder:"请输入电话"},model:{value:e.form.shippings[0].phone,callback:function(t){e.$set(e.form.shippings[0],"phone",t)},expression:"form.shippings[0].phone"}})],1):e._e()],2):e._e(),e.showInfo?a("el-collapse-item",{attrs:{title:"其他信息",name:"7"}},[a("el-form-item",{attrs:{label:"创建时间"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.orderTime,callback:function(t){e.$set(e.form,"orderTime",t)},expression:"form.orderTime"}})],1),a("el-form-item",{attrs:{label:"执行时间"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.deliveryTime,callback:function(t){e.$set(e.form,"deliveryTime",t)},expression:"form.deliveryTime"}})],1),a("el-form-item",{attrs:{label:"付款时间"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.paymentTime,callback:function(t){e.$set(e.form,"paymentTime",t)},expression:"form.paymentTime"}})],1),a("el-form-item",{attrs:{label:"完成时间"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.completeTime,callback:function(t){e.$set(e.form,"completeTime",t)},expression:"form.completeTime"}})],1)],1):e._e()],1)],1),a("el-dialog",{attrs:{title:"创建会员",visible:e.dialogVisible,width:"50%",appendToBody:!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"dialogFormModel",attrs:{model:e.formModel,"label-width":"120px",size:"small",rules:e.dialogRules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入手机号，如1888888888"},on:{blur:e.mobileBlur},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{attrs:{placeholder:"请输入用户名，如1888888888"},model:{value:e.formModel.userName,callback:function(t){e.$set(e.formModel,"userName",t)},expression:"formModel.userName"}})],1),a("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请输入昵称，如1888888888"},model:{value:e.formModel.nickname,callback:function(t){e.$set(e.formModel,"nickname",t)},expression:"formModel.nickname"}})],1),a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入姓名，如张三"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入密码"},model:{value:e.formModel.password,callback:function(t){e.$set(e.formModel,"password",t)},expression:"formModel.password"}})],1),a("el-form-item",{attrs:{label:"性别",prop:"gender"}},[a("el-radio-group",{model:{value:e.formModel.gender,callback:function(t){e.$set(e.formModel,"gender",t)},expression:"formModel.gender"}},[a("el-radio",{attrs:{label:"0"}},[e._v("男")]),a("el-radio",{attrs:{label:"1"}},[e._v("女")]),a("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),a("el-form-item",{attrs:{label:"车牌号"}},[a("el-input",{attrs:{placeholder:"请输入车牌号，如浙12345"},model:{value:e.formModel.defaultCarInfo.plateNumber,callback:function(t){e.$set(e.formModel.defaultCarInfo,"plateNumber",t)},expression:"formModel.defaultCarInfo.plateNumber"}})],1),a("el-form-item",{attrs:{label:"品牌"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马",filterable:""},on:{change:e.brandChange},model:{value:e.formModel.defaultCarInfo.brand,callback:function(t){e.$set(e.formModel.defaultCarInfo,"brand",t)},expression:"formModel.defaultCarInfo.brand"}},e._l(e.brandData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"系列"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系",filterable:""},on:{change:e.seriesChange},model:{value:e.formModel.defaultCarInfo.series,callback:function(t){e.$set(e.formModel.defaultCarInfo,"series",t)},expression:"formModel.defaultCarInfo.series"}},e._l(e.seriesData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"车型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系2016款"},model:{value:e.formModel.defaultCarInfo.type,callback:function(t){e.$set(e.formModel.defaultCarInfo,"type",t)},expression:"formModel.defaultCarInfo.type"}},e._l(e.modeData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"车辆识别代码"}},[a("el-input",{attrs:{placeholder:"请输入车辆识别代码，如1G1BL52P7TR115520"},model:{value:e.formModel.defaultCarInfo.vin,callback:function(t){e.$set(e.formModel.defaultCarInfo,"vin",t)},expression:"formModel.defaultCarInfo.vin"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.createMember()}}},[e._v("确 定")])],1)],1),a("biz-dialog-selector",{staticClass:"memberDialog",attrs:{title:"选择会员",visibility:e.showDialog,appendToBody:!0,keyField:"id",selectionKeys:e.selectionKeys,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,selectionMode:"single",filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.handleConfirmed,open:e.opened,operate:e.dialogOperate,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange}},[a("el-table-column",{attrs:{label:"用户名",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"customer-info"},[t.row.head?a("img",{attrs:{src:t.row.head}}):a("img",{attrs:{src:i("624d")}}),a("div",{staticClass:"wrapper"},[a("div",{staticClass:"title"},[e._v(e._s(t.row.name))]),a("div",{staticClass:"gender"},["0"===t.row.gender?a("i",{staticClass:"male iconfont biz-icon-i-web-m"}):e._e(),"1"===t.row.gender?a("i",{staticClass:"female iconfont biz-icon-i-web-f"}):e._e(),"2"===t.row.gender?a("i",{staticClass:"none iconfont biz-icon-i-web-bm"}):e._e(),a("span",[e._v(e._s(t.row.mobile))])])])])]}}])}),a("el-table-column",{attrs:{label:"状态",formatter:e.stateConverter}}),a("el-table-column",{attrs:{prop:"",label:"店铺"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",e._l(t.row.shops,(function(t,i){return a("div",{key:i,staticClass:"customer-info"},[e._v(e._s(t.name))])})),0)]}}])}),a("el-table-column",{attrs:{prop:"nickname",label:"最后登录"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lastLoginDate)+" ")]}}])})],1),a("biz-dialog-selector",{attrs:{title:"选择车型",visibility:e.showProductSelector,tableData:e.productTableData,pagination:e.productPagination,selectionMode:"single"},on:{"update:visibility":function(t){e.showProductSelector=t},pageSizeChange:e.productPageSizeChange,currentPageChange:e.productCurrentPageChange,confirmed:e.confirmedProduct}},[a("el-table-column",{attrs:{property:"fullName",label:"名称"}}),a("el-table-column",{attrs:{property:"price",label:"销售价"}})],1)],1)},r=[],o=(i("99af"),i("4de4"),i("7db0"),i("c740"),i("4160"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("ac1f"),i("25f0"),i("3ca3"),i("5319"),i("1276"),i("159b"),i("ddb0"),i("b85c")),s=(i("96cf"),i("1da1")),n=i("5530"),l=i("f36f"),d=i("e42c"),c=i("8330"),p=i("46fc"),m=i("c466"),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[i("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tags:e.tags,pagination:e.pagination,tableData:e.tableData,loading:e.loading,checkable:e.checkable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange}},[e._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],1)},f=[],h=i("04d3"),g={name:"BizDialogSelector",components:{BizFlexTable:h["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},selectionKeys:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],innerSelection:[]}},methods:{generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]);else{var i=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(i,1)}},open:function(e){console.log(this.selectionKeys),this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){this.innerSelectionKeys.length>0?(this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1):this.$message("请选择一项")},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i>=0&&t.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i<0&&t.innerSelectionKeys.push(e[t.keyField])}))},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},rowClick:function(e,t,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){}},b=g,v=(i("48c2"),i("2877")),y=Object(v["a"])(b,u,f,!1,null,null,null),_=y.exports,I=i("2f62"),w=i("18eb"),x=i("0e5e"),S=i("1ab1"),C=i("c596"),M={stateConverter:function(e){return"0"===e.enableState?"停用":"1"===e.enableState?"启用":"--"},createDateConverter:function(e){if(e.createDate){e.createDate=e.createDate.replace(/-/g,"/");var t=new Date(e.createDate);return m["a"].dateConverter(t)}return"--"},loginDateConverter:function(e){if(e.lastLoginDate){e.lastLoginDate=e.lastLoginDate.replace(/-/g,"/");var t=new Date(e.lastLoginDate);return m["a"].dateConverter(t)}return"--"},ipConverter:function(e){return e.lastLoginIp?e.lastLoginIp:"--"}},k={name:"baseInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},open:{type:Boolean,default:function(){return!1}},handler:{type:String},activeNames:{type:Array,default:function(){return["1","2","3","4","5"]}}},components:{BizGrid:l["a"],BizSaveButton:c["a"],BizDialogSelector:_,TagSelect:w["a"]},data:function(){var e=this;return{isShipped:!1,beanCanUse:"",maxOffsetBean:0,minOffsetBean:0,originalAmount:"",orderStateTypeList:[{label:"订单已执行",value:"1"},{label:"交易完成",value:"2"},{label:"商家已确认",value:"0"}],beanRate:0,tagList:[],selectedTags:[],restaurants:[],dialogRules:{userName:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[0-9a-zA-Z]+$/,message:"用户名只能为数字或字母",trigger:"blur"},{min:4,max:20,message:"长度在4-20位",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"}],name:[{required:!0,trigger:"blur",message:"请输入姓名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:20,message:"密码应在6-20位之间",trigger:"blur"}],rePassword:[{required:!0,trigger:"blur",message:"请再次输入密码"},{trigger:"blur",validator:function(t,i,a){e.formModel.password===e.formModel.rePassword?a():a(new Error("两次输入密码不一致"))}}]},loading:!1,picDialogVisible:!1,showProductSelector:!1,dialogImageUrl:"",isFirst:!0,showDialog:!1,dialogVisible:!1,showDelivery:!1,showReceiver:!1,flag:!1,data:{type:"",method:""},productTableData:[],imageList:[],consultants:[],shippingMethod:[],deliveryCorps:[],paymentTypes:[],paymentMethods:[],listExistCard:[],brandList:[],seriesList:[],modeList:[],brandData:[],seriesData:[],modeData:[],financialPlans:[],selectionKeys:[],rescueOrganizations:[],cars:[],reasons:[],workers:[],orderItems:[],areaId:"1568",useTime:"",useMileage:"",appointmentDate:"",downPaymentPrice:"",loanPrice:"",formModel:{userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",brand:"",series:"",type:"",vin:""}},form:{bean:"",appointmentData:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}},appointmentDate:"",appointmentEndDate:"",sn:"",type:"",amount:"",amountPrepay:"",amountFinalpay:"",originalAmount:"",offsetAmount:"",curAmount:"",memberCardId:"",userId:"",consultant:{id:""},area:{id:"1568"},car:{id:"",tpye:"",drivingRange:""},address:"",areaName:"",consignee:"",phone:"",zipCode:"",remarks:"",memo:"",promotionDiscount:"",couponDiscount:"",couponCodeId:"",couponCode:{},couponList:[],beanDiscount:"",point:"",giftBean:"",shippingMethodName:"",paymentMethodId:"",shippingMethodId:"",invoiceState:"",orderTime:"",deliveryTime:"",paymentTime:"",completeTime:"",orderItems:[{appointment:{testDriveId:"",appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",plateNumber:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}}}],payments:[{paymentType:"",payBank:"",payAccount:""}],member:{nickname:"",gender:"",mobile:""},shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",phone:"",zipCode:""}]},operations:[{label:"保存",name:"save",type:"primary"}],adminCurrent:[],dialogLoading:!0,dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},productPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},isCreated:!1,dialogFilters:[{type:"input",label:"",placeholder:"请输入店铺名称",name:"searchValue",value:""}]}},computed:Object(n["a"])(Object(n["a"])({},Object(I["c"])(["currentUser"])),{},{getCouponCode:function(){var e,t=this;return this.form.couponList.forEach((function(i){if(i.id===t.form.couponCodeId)return e=i,!1})),e},showInfo:function(){return"product"===this.$route.params.orderType||"car"===this.$route.params.orderType||"general"===this.$route.params.orderType||"service"===this.$route.params.orderType||"rescue"===this.$route.params.orderType||"couponOrder"===this.$route.params.orderType},showPayment:function(){return("product"===this.$route.params.orderType||"car"===this.$route.params.orderType||"general"===this.$route.params.orderType||"service"===this.$route.params.orderType||"rescue"===this.$route.params.orderType||"couponOrder"===this.$route.params.orderType)&&(!!this.itemId||"1"!==this.form.type)},isCreate:function(){return!this.itemId}}),created:function(){this.queryBrandList(),this.getBrandList(),this.getFinancialPlans(),!this.itemId&&this.orderOptions(),this.getStoreTags(),this.testDrives()},watch:{itemId:function(e){this.itemId&&this.init(),this.itemId||(this.resetFormData(),this.form.type="2",this.getStoreTags())},open:function(e){this.isShipped=!1,!this.itemId&&e&&this.isCreated&&this.resetFormData(),this.itemId&&this.init()},form:{deep:!0,immediate:!0,handler:function(e){var t=this;this.showDelivery=!1,this.showReceiver=!1,this.shippingMethod.map((function(i){i.name===e.shippingMethodName&&"1"===i.isNeedDelivery&&(t.showDelivery=!0),i.name===e.shippingMethodName&&"1"===i.isNeedReceiver&&(t.showReceiver=!0)}))}}},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(I["c"])(["getUser"])),M),{},{getDefaultForm:function(){return{bean:"",curAmount:"",couponCodeId:"",couponCode:{},couponList:[],appointmentData:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}},appointmentDate:"",appointmentEndDate:"",sn:"",type:"",amount:"",amountPrepay:"",amountFinalpay:"",originalAmount:"",offsetAmount:"0",memberCardId:"",userId:"",consultant:{id:""},area:{id:"1568"},car:{id:"",tpye:"",drivingRange:""},address:"",areaName:"",consignee:"",phone:"",zipCode:"",remarks:"",memo:"",promotionDiscount:"",couponDiscount:"",beanDiscount:"",point:"",giftBean:"",shippingMethodName:"",paymentMethodId:"",shippingMethodId:"",invoiceState:"",orderTime:"",deliveryTime:"",paymentTime:"",completeTime:"",orderItems:[{appointment:{testDriveId:"",appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",plateNumber:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}}}],payments:[{paymentType:"",payBank:"",payAccount:""}],member:{nickname:"",gender:"",mobile:""},shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",phone:"",zipCode:""}]}},onShippingChange:function(){this.form.shippingMethodName&&this.showDelivery||(this.form.shippings[0].freight="",this.getOriginalAmount())},mobileBlur:function(){this.formModel.id||this.formModel.nickname||this.$set(this.formModel,"nickname",this.formModel.mobile),this.formModel.id||this.formModel.userName||this.$set(this.formModel,"userName",this.formModel.mobile)},brandChange:function(e){this.getSeriesList(e),this.formModel.defaultCarInfo.series="",this.formModel.defaultCarInfo.type=""},seriesChange:function(e){this.getModeList(e),this.formModel.defaultCarInfo.type=""},getStoreTags:function(){var e=this,t={categoryType:"订单/服务业务类型",shopId:window.top.SHOP_ID||""};S["a"].get(C["g"].systemSetting.storeTags,t).then((function(t){console.log("订单/服务业务类型标签",t),e.tagList=t.content})).catch((function(e){console.log(e.errorMessage)}))},beanChange:function(){this.getOriginalAmount()},getOriginalAmount:function(){this.isCreate&&(console.log(123),this.form.originalAmount=(Number(this.originalAmount)-Number(this.form.bean*this.beanRate||"0")-Number(this.form.couponDiscount||"0")+Number(this.form.shippings[0].freight||"0")).toFixed(2),this.getCurAmount())},getCurAmount:function(){this.form.curAmount=(Number(this.form.originalAmount)+Number(this.form.offsetAmount||"0")).toFixed(2),this.form.curAmount<=0&&(this.form.curAmount=0),this.form.curAmount=this.form.curAmount.toString()},freightChange:function(){this.getOriginalAmount()},offsetAmountChange:function(){this.getCurAmount()},curAmountChange:function(){this.form.offsetAmount=Number(this.form.curAmount)+Number(this.form.bean*this.beanRate)+Number(this.form.couponDiscount)-Number(this.form.originalAmount),this.form.offsetAmount=this.form.offsetAmount.toString()},couponChange:function(){var e=this;this.form.couponList.forEach((function(t){if(t.id===e.form.couponCodeId)return e.form.couponDiscount=t.coupon.amount,!1})),this.getOriginalAmount()},tagMapping:function(){var e={refId:this.itemId,type:"7",tags:this.$refs.tagSelect.getCurSelectedTags(),shopId:window.top.SHOP_ID||""};S["a"].post(C["g"].systemSetting.tagMapping,e).then((function(e){console.log("映射成功")})).catch((function(e){console.log(e.errorMessage)}))},getTagMapping:function(){var e=this;this.selectedTags=[];var t={refId:this.itemId,type:"7",shopId:window.top.SHOP_ID||""};S["a"].get(C["g"].systemSetting.tagMapping,t).then((function(t){console.log("查看映射信息",t),t.data.tags&&(e.selectedTags=t.data.tags)})).catch((function(e){console.log(e.errorMessage)}))},onAddSuccess:function(){this.getStoreTags()},operate:function(e){this[e]()},dateInterval:function(e,t){if(e&&t)return Object(p["a"])(e.split(" ")[1],t.split(" ")[1])},showDialogFc:function(){this.showDialog=!0,this.dialogFilters[0].value=""},monthPay:function(){var e=this;if(this.form.orderItems[0].appointment.year)return this.form.orderItems[0].appointment.financialPlan.loanTerms.map((function(t){t.year===e.form.orderItems[0].appointment.year&&(e.form.orderItems[0].appointment.rate=t.rate)})),this.form.orderItems[0].appointment.rate>0?((this.form.orderItems[0].appointment.product.price-this.form.orderItems[0].appointment.product.price*this.form.orderItems[0].appointment.downPayment/100)*this.form.orderItems[0].appointment.rate/12*Math.pow(1+this.form.orderItems[0].appointment.rate/12,12*this.form.orderItems[0].appointment.year)/(Math.pow(1+this.form.orderItems[0].appointment.rate/12,12*this.form.orderItems[0].appointment.year)-1)).toFixed(2):(this.form.orderItems[0].appointment.product.price/(12*this.form.orderItems[0].appointment.year)).toFixed(2)},queryProduct:function(){var e=this;d["a"].listProductByTestDrive({clientType:"2",methodName:"ListProductByTestDrive",shopId:this.getUser().shop?this.getUser().shop.id:window.top.SHOP_ID,pageSize:this.productPagination.pageSize,pageNumber:this.productPagination.currentPage},(function(t){e.productTableData=t.content,e.showProductSelector=!0}),(function(t){e.$message.warning(t.errorMessage)}))},confirmedProduct:function(e,t){this.form.orderItems[0].appointment.product.id=t[0].id,this.form.orderItems[0].appointment.product.fullName=t[0].fullName},handleConfirmed:function(e,t){this.form.member.nickname=t[0].nickname,this.form.member.mobile=t[0].mobile,this.form.memberCardId="",this.form.userId=t[0].id,this.$set(this.form.member,"gender",t[0].gender),this.$set(this.form,"selectionKeys",e),this.listExistCardTemplate(),this.form.plateNumber=t[0].defaultCarInfo.plateNumber,this.form.drivingRange=t[0].defaultCarInfo.drivingRange||"",this.form.car.type=t[0].defaultCarInfo.type||"",this.form.car.drivingRange="",this.form.shippings[0].address&&this.itemId||(this.form.shippings[0].address=t[0].defaultReceiver.areaName+t[0].defaultReceiver.address),this.form.shippings[0].consignee&&this.itemId||(this.form.shippings[0].consignee=t[0].name),this.form.shippings[0].phone&&this.itemId||(this.form.shippings[0].phone=t[0].mobile),this.carOptions(this.form.userId),this.getCouponList()},carOptions:function(e){var t,i=this;d["a"].carOptions({memberId:e},(function(e){i.cars=e.cars,i.cars.length>0&&(i.cars.forEach((function(e){if(e.plateNumber===i.form.plateNumber)return t=e,!1})),i.form.car.id=t?t.id:"",i.cars.map((function(e){if(e.id===i.form.car.id)return i.form.car.type=e.type,!1})))}),(function(e){i.$message.warning(e.errorMessage)}))},carChange:function(e){var t=this;this.cars.map((function(i){i.id===e&&(t.form.car.type=i.type,t.form.car.drivingRange=i.drivingRange,t.form.drivingRange=i.drivingRange)}))},createMember:function(){var e=this;this.$refs.dialogFormModel.validate((function(t,i){t&&d["a"].createMember(e.formModel,(function(t){e.loading=!1,e.$message.success("保存成功"),e.dialogVisible=!1,e.form.member.nickname=t.data.name,e.form.member.gender=t.data.gender,e.form.member.mobile=t.data.mobile,e.form.userId=t.data.id,t.data.defaultCarInfo&&(e.cars.push({plateNumber:t.data.defaultCarInfo.plateNumber,id:t.data.defaultCarInfo.id,type:t.data.defaultCarInfo.type}),e.form.car.id=t.data.defaultCarInfo.id,e.form.car.type=t.data.defaultCarInfo.type)}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},resetFormData:function(){this.form=this.getDefaultForm(),this.form.userId="",this.form.memberCardId="",this.listExistCard=[],this.form.member={},this.form.couponList=[],this.form.couponCodeId="",this.form.beanDiscount="",this.paymentTypes=[],this.form.payments[0].paymentType="",this.form.shippings[0].deliveryCorpId="",this.form.originalAmount="",this.form.curAmount="",this.form.car.type="",this.form.car.drivingRange="",this.form.drivingRange="",this.form.plateNumber="",this.form.car.id="",this.form.offsetAmount="",this.form.orderItems[0].appointment.product.brandId="",this.form.orderItems[0].appointment.product.seriesId="",this.form.orderItems[0].appointment.product.id=""},init:function(){var e=this;d["a"].viewOrder(this.getSaveParams(),(function(t){e.form=Object.assign(e.getDefaultForm(),t.order),e.form.curAmount=Number(e.form.originalAmount)+Number(e.form.offsetAmount),console.log(e.form),0===e.form.payments.length?(e.form.payments=[{paymentType:"",payBank:"",payAccount:""}],e.form.payments[0].paymentType=e.form.paymentTypeName):e.form.memberCardId=e.form.payments[0].memberCardId,0===e.form.shippings.length&&(e.form.shippings=[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:e.form.area&&e.form.area.fullName?e.form.area.fullName+e.form.address:e.form.address,consignee:e.form.consignee,phone:e.form.phone,zipCode:e.form.zipCode}]),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.product&&e.form.orderItems[0].appointment.product.brandId&&e.querySeriesList(e.form.orderItems[0].appointment.product.brandId),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.product&&e.form.orderItems[0].appointment.product.seriesId&&e.queryTypeList(e.form.orderItems[0].appointment.product.seriesId),t.order.appointmentDate&&(e.appointmentDate=t.order.appointmentDate),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.reasons&&(e.form.orderItems[0].appointment.reasons=e.form.orderItems[0].appointment.reasons.map((function(e){return e.id}))),e.carOptions(e.form.member.id),e.shippingMethod=t.shippingMethods,e.deliveryCorps=t.deliveryCorps,e.paymentTypes=t.paymentTypes,e.paymentMethods=t.paymentMethods,e.paymentMethods.map((function(i){i.name===t.order.paymentMethodName&&(e.form.paymentMethodId=i.id)})),e.reasons=t.reasons,e.adminCurrent=[{id:t.adminCurrent.id,name:t.adminCurrent.realName}],e.form.consultant.id?e.adminCurrent=[{id:e.form.consultant.id,name:e.form.consultant.realName}]:e.form.consultant={id:t.adminCurrent.id},e.form.area&&(e.areaId=e.form.area.id),"rescue"===e.$route.params.orderType&&(e.imageList=e.form.orderItems[0].appointment.images.map((function(e){return{url:e.path}}))),e.form.type=e.getOrderStatus(e.form.type),e.listExistCardTemplate(),e.listAdminByRole(),"2"===e.form.orderType&&(console.log("查询映射",e.form.orderType),e.getTagMapping(),e.getStoreTags()),e.offsetAmountChange()}),(function(t){e.$message.warning(t.errorMessage)}))},paymentTypeChange:function(e){"会员卡余额"!==e&&(this.form.memberCardId="",this.form.bean="",this.getOriginalAmount())},memberCardChange:function(){this.getMemberCardInfo()},getMemberCardInfo:function(){var e=this,t={userCardId:this.form.memberCardId};S["a"].get("/admin/memberCard/memberCard.jhtml",t).then((function(t){e.form.bean=t.content.bean,e.beanCanUse="可用 "+e.form.bean,e.getBeanRate(),e.getCouponList()})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getBeanRate:function(){var e=this,t={id:this.form.memberCardId};S["a"].get("/admin/memberCard/memberCard.jhtml",t).then((function(t){e.beanRate=Number(t.rewardSet.cash)/Number(t.rewardSet.vBean)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getCouponList:function(){var e=this;if(0!==this.orderItems.length){this.form.couponList=[];var t=this.orderItems.map((function(e){return{product:{id:e.productId},quantity:e.quantity||""}})),i={shopId:window.top.SHOP_ID||"",cartItems:t,userId:this.form.userId,userCardId:this.form.memberCardId};S["a"].post("/admin/order/couponCodes.jhtml",i).then((function(t){e.form.couponList=t.content,e.maxOffsetBean=t.maxOffsetBean,e.minOffsetBean=t.minOffsetBean,e.form.bean>t.maxOffsetBean&&(e.form.bean=t.maxOffsetBean),Number(e.form.bean)<e.minOffsetBean||"0"===e.form.bean?e.beanCanUse="V豆不足, V豆抵扣范围["+e.minOffsetBean+", "+e.maxOffsetBean+"]":e.beanCanUse="V豆抵扣范围["+e.minOffsetBean+", "+e.maxOffsetBean+"]",e.beanChange()})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))}},listAdminByRole:function(){var e=this,t="";t="car"===this.$route.params.orderType?["salesman"]:["afterSale","reception","testDriver"],d["a"].listAdminByRole({roleTypes:t},(function(t){e.loading=!1,e.flag=!1,console.log(e.form.consultant.id),t.dataList.map((function(t){t.id===e.adminCurrent[0].id&&(e.flag=!0)})),e.flag?e.consultants=t.dataList:e.consultants=t.dataList.concat(e.adminCurrent)}),(function(e){console.log(e)}))},loanTerm:function(e){var t=this;d["a"].loanTerms({financialId:e},(function(e){t.loading=!1,t.form.orderItems[0].appointment.financialPlan.downPayments=[e.downPayment,e.downPayment+10,e.downPayment+20,e.downPayment+30],t.form.orderItems[0].appointment.downPayment="",t.form.orderItems[0].appointment.financialPlan.loanTerms=e.loanTerms}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},orderOptions:function(){var e=this,t=!1;this.form.type="交易完成",d["a"].options({shopId:window.top.SHOP_ID},(function(i){e.loading=!1,e.paymentMethods=i.paymentMethods,e.paymentTypes=i.paymentTypes,e.shippingMethod=i.shippingMethods,e.deliveryCorps=i.deliveryCorps,e.reasons=i.reasons,e.rescueOrganizations=i.rescueOrganizations,e.workers=i.workers,e.adminCurrent=[{id:i.adminCurrent.id,name:i.adminCurrent.realName}],e.form.consultant={id:i.adminCurrent.id},e.listAdminByRole(),!e.itemId&&e.showInfo&&(e.paymentTypes.forEach((function(e){if("会员卡余额"===e.name)return t=!0,!1})),e.form.payments[0].paymentType=t?"会员卡余额":e.paymentTypes[0].name),e.form.userId&&e.listExistCardTemplate()}),(function(t){e.loading=!1,"店铺不存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},submitOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var i,a,r,s,n,l,d,c,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.analysisAddress(e.currentUser.shop.address);case 2:return i=t.sent,t.next=5,e.analysisAddress(e.form.shippings[0].address);case 5:a=t.sent,r=e.form.orderItems,s=[],n=Object(o["a"])(r);try{for(n.s();!(l=n.n()).done;)for(d=l.value,c=0;c<d.quantity;c++)p={cname:e.currentUser.shop.name,spro:i.province,scity:i.city,num:d.product.vins[c].number,epro:a.province,ecity:a.city,depname:e.form.shippings[0].consignee},s.push(S["a"].post("/admin/order/shipping2XinYue.jhtml",p))}catch(m){n.e(m)}finally{n.f()}Promise.all(s).then((function(t){e.$emit("xrorder")})).catch((function(t){e.$emit("xrorder")}));case 11:case"end":return t.stop()}}),t)})))()},analysisAddress:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("开始解析, "+e),t.abrupt("return",new Promise((function(t,i){var a=new window.BMap.Geocoder;a.getPoint(e,(function(e){a.getLocation(e,(function(e){console.log(e),t({province:e.addressComponents.province,city:e.addressComponents.city})}))}))})));case 2:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;if(this.reasons&&this.reasons.length>0&&this.itemId&&this.form.orderItems[0].appointment&&(this.form.orderItems[0].appointment.reasons=this.reasons.map((function(t){return e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.reasons&&-1!==e.form.orderItems[0].appointment.reasons.indexOf(t.id)?{id:t.id,content:t.content}:{id:"",content:""}}))),""===this.form.consultant.id)return this.$message.warning("请输入顾问"),!1;if("ride"===this.$route.params.orderType){if(console.log(this.form.orderItems[0].appointment.plateNumber),""===this.form.orderItems[0].appointment.plateNumber)return this.$message.warning("请输入试驾车号"),!1;if(""===this.form.orderItems[0].appointment.product.fullName)return this.$message.warning("请输入试驾车型"),!1}if(!this.itemId){if(Number(this.form.bean)<this.minOffsetBean&&Number(this.form.beanDiscount)>0)return void this.$message.warning("V豆不足");if(Number(this.form.bean)<this.minOffsetBean||Number(this.form.bean)>this.maxOffsetBean)return void this.$message.warning("V豆抵扣数值不在可用范围内")}if(this.itemId)if(console.log(11),"ride"===this.$route.params.orderType&&this.$set(this.form,"appointmentData",{testDriveId:this.form.orderItems[0].appointment.testDriveId}),"shipping"===this.handler){if(this.loading=!0,this.shippingMethod.map((function(t){t.name===e.form.shippingMethodName&&(e.form.shippingMethodId=t.id)})),this.form.deliveryCorpId=this.form.shippings[0].deliveryCorpId,this.showDelivery){if(""===this.form.shippings[0].deliveryCorpId)return this.$message.warning("请输入物流公司"),this.loading=!1,!1;if(""===this.form.shippings[0].expressSn)return this.$message.warning("请输入物流单号"),this.loading=!1,!1;if(""===this.form.shippings[0].freight||!/^(0|[0-9][0-9]*)(\.\d+)?$/.test(this.form.shippings[0].freight))return this.$message.warning("请输入正确的物流费用"),this.loading=!1,!1;this.showReceiver?this.$set(this.form,"shippingData",{phone:this.form.shippings[0].phone||this.form.phone,address:this.form.shippings[0].address||this.form.areaName,consignee:this.form.shippings[0].consignee||this.form.consignee,expressSn:this.form.shippings[0].expressSn,freight:this.form.shippings[0].freight}):this.$set(this.form,"shippingData",{expressSn:this.form.shippings[0].expressSn,freight:this.form.shippings[0].freight})}else this.showReceiver&&!this.showDelivery&&(this.$set(this.form,"shippingData",{phone:this.form.shippings[0].phone||this.form.phone,address:this.form.shippings[0].address||this.form.areaName,consignee:this.form.shippings[0].consignee||this.form.consignee}),this.$set(this.form,"deliveryCorpId",this.form.shippings[0].deliveryCorpId));this.loading=!0,d["a"].shippingOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess"),console.log("shipping-success"),e.isShipped=!0}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}else if("service"===this.handler)this.loading=!0,d["a"].excuteOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}));else if("payment"===this.handler){if(this.loading=!0,this.paymentTypes.map((function(t){t.name===e.form.payments[0].paymentType&&(e.form.paymentTypeId=t.id)})),this.form.payment={payBank:this.form.payments[0].payBank,payAccount:this.form.payments[0].payAccount,amount:this.form.amount},("rescue"===this.$route.params.orderType||"product"===this.$route.params.orderType||"car"===this.$route.params.orderType||"service"===this.$route.params.orderType||"general"===this.$route.params.orderType)&&!this.form.payments[0].paymentType||("rescue"===this.$route.params.orderType||"product"===this.$route.params.orderType||"car"===this.$route.params.orderType||"service"===this.$route.params.orderType||"general"===this.$route.params.orderType)&&("刷卡"===this.form.payments[0].paymentType||"汇款"===this.form.payments[0].paymentType)&&(""===this.form.payments[0].payBank||""===this.form.payments[0].payAccount))return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.$refs.form.validate((function(t,i){t?d["a"].paymentOrder(e.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})):e.loading=!1}))}else this.loading=!0,d["a"].updateOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess"),"2"===e.form.orderType&&e.tagMapping()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}));else{if(("rescue"===this.$route.params.orderType||"product"===this.$route.params.orderType||"car"===this.$route.params.orderType||"service"===this.$route.params.orderType||"general"===this.$route.params.orderType)&&!this.form.payments[0].paymentType)return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.createOrder()}var t=this.deliveryCorps.find((function(t){return t.id===e.form.shippings[0].deliveryCorpId})).name;"shipping"===this.handler&&"新悦物流"===t&&this.submitOrder()},setOrderItems:function(e){this.orderItems=e,this.orderItems.forEach((function(e){e.productId=e.productId?e.productId:e.id}));var t=0;e.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.originalAmount=t,this.form.originalAmount=t,this.offsetAmountChange(),this.form.member.nickname&&this.getCouponList()},createOrder:function(){var e=this;if(this.shippingMethod.map((function(t){t.name===e.form.shippingMethodName&&(e.form.shippingMethodId=t.id)})),this.paymentTypes.map((function(t){t.name===e.form.payments[0].paymentType&&(e.form.paymentTypeId=t.id)})),this.form.appointmentData=this.form.orderItems[0].appointment,"rescue"===this.$route.params.orderType&&(this.form.appointmentData.reasons=this.reasons.map((function(t){return-1!==e.form.appointmentData.reasons.indexOf(t.id)?{id:t.id,content:t.content}:{id:"",content:""}}))),this.showInfo&&!this.form.payments[0].paymentType||this.showInfo&&("刷卡"===this.form.payments[0].paymentType||"汇款"===this.form.payments[0].paymentType)&&(""===this.form.payments[0].payBank||""===this.form.payments[0].payAccount))return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.loading=!0,this.$refs.form.validate((function(t,i){t&&d["a"].createOrder({appointmentData:e.form.orderItems[0].appointment,appointmentDate:e.form.appointmentDate,appointmentEndDate:e.form.appointmentEndDate,sn:e.form.sn,type:e.form.type,orderType:e.$route.params.orderType,orderStatus:"交易完成"===e.form.type?"2":e.form.type,bean:e.form.bean,couponCode:e.getCouponCode,amount:e.form.amount,amountPrepay:e.form.amountPrepay,paymentTypeId:e.form.paymentTypeId,shippingMethod:{id:e.form.shippingMethodId},amountFinalpay:e.form.amountFinalpay,originalAmount:e.form.originalAmount,offsetAmount:e.form.offsetAmount,freight:e.form.shippings&&e.form.shippings.length?e.form.shippings[0].freight:"",memberCardId:e.form.memberCardId,amountPaid:e.form.curAmount,userId:e.form.userId,consultant:{id:e.form.consultant.id},car:{id:e.form.car.id},area:{id:e.areaId},address:e.form.address,areaName:e.form.areaName,consignee:e.form.consignee,phone:e.form.phone,zipCode:e.form.zipCode,remarks:e.form.remarks,memo:e.form.memo,promotionDiscount:e.form.promotionDiscount,couponDiscount:e.form.couponDiscount,beanDiscount:e.form.beanDiscount,point:e.form.point,giftBean:e.form.giftBean,shippingMethodName:e.form.shippingMethodName,paymentMethodId:e.form.paymentMethodId,invoiceState:e.form.invoiceState,orderTime:e.form.orderTime,deliveryTime:e.form.deliveryTime,paymentTime:e.form.paymentTime,completeTime:e.form.completeTime,orderItems:e.orderItems,payments:[{paymentType:e.form.payments[0].paymentType,payBank:e.form.payments[0].payBank,payAccount:e.form.payments[0].payAccount}],member:{nickname:e.form.member.nickname,gender:e.form.member.gender,mobile:e.form.member.mobile},shippings:[{shippingMethod:e.form.shippings[0].shippingMethod,deliveryCorpId:e.form.shippings[0].deliveryCorpId,expressSn:e.form.shippings[0].expressSn,freight:e.form.shippings[0].freight,address:e.form.shippings[0].address,consignee:e.form.shippings[0].consignee,phone:e.form.shippings[0].phone,zipCode:e.form.shippings[0].zipCode}]},(function(t){e.loading=!1,e.$message.success("保存成功"),e.form=e.getDefaultForm(),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.driveStartDate&&(e.form.orderItems[0].appointment.driveStartDate=e.form.orderItems[0].appointment.driveStartDate.split(" ")[1]),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.driveEndDate&&(e.form.orderItems[0].appointment.driveEndDate=e.form.orderItems[0].appointment.driveEndDate.split(" ")[1]),e.$emit("operationSuccess"),e.isCreated=!0,e.itemId=t.id,e.tagMapping()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},productChange:function(){var e=this;this.modeList.map((function(t){t.id===e.form.orderItems[0].appointment.product.id&&(e.form.orderItems[0].appointment.product.price=t.price)}))},listExistCardTemplate:function(){var e=this;d["a"].listExistCardTemplate({userId:this.form.userId},(function(t){e.loading=!1,e.listExistCard=t.content,e.listExistCard.forEach((function(e){e.template.name+=" ¥"+e.balance+" "+e.shop.name}))}),(function(e){console.log(e)}))},getFinancialPlans:function(){var e=this;d["a"].getFinancialPlans({shopId:window.top.SHOP_ID||""},(function(t){e.loading=!1,e.financialPlans=t.financials}),(function(e){console.log(e)}))},getSaveParams:function(){return{orderId:this.itemId}},areaChanged:function(e){this.areaId=e,this.isFirst&&(this.areaId="1568",this.isFirst=!1)},handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.form.orderItems[0].appointment.product,"seriesId",""),this.$set(this.form.orderItems[0].appointment.product,"id","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.form.orderItems[0].appointment.product,"id","")},queryMemberList:function(e){var t=this;d["a"].memberList(e,(function(e){t.dialogLoading=!1,t.dialogTableData=e.content,t.dialogPagination.total=Number(e.total)}),(function(e){console.log(e),console.log("code错误")}))},opened:function(){this.dialogPagination.currentPage=1,this.dialogPagination.pageSize=20,this.dialogFilters=[{type:"input",label:"",placeholder:"请输入名称或手机号",name:"searchValue",value:""}],this.queryMemberList(this.getDialogQueryParams())},getDialogQueryParams:function(){return{pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value}},productPageSizeChange:function(e){this.$set(this.productPagination,"pageSize",e)},productCurrentPageChange:function(e){this.$set(this.productPagination,"currentPage",e)},dialogFilterDataChange:function(e){this.dialogPagination.currentPage=1,this.queryMemberList(this.getDialogQueryParams())},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),this.queryMemberList(this.getDialogQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),this.queryMemberList(this.getDialogQueryParams())},handleSuccess:function(e,t,i){this.form.orderItems[0].appointment.images.push({path:e.urls[0]})},handleRemove:function(e,t){var i=this.form.orderItems[0].appointment.images.findIndex((function(t){return t.path===e.path}));-1!==i&&this.form.orderItems[0].appointment.images.splice(i,1)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.picDialogVisible=!0},dialogOperate:function(e){},queryBrandList:function(){var e=this;d["a"].brands({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;d["a"].series({brandId:e},(function(e){t.seriesList=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},getBrandList:function(){var e=this;x["a"].queryBrandList({},(function(t){e.brandData=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},getSeriesList:function(e){var t=this;x["a"].querySeriesList({brand:e},(function(e){t.seriesData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},getModeList:function(e){var t=this;x["a"].queryTypeList({series:e,brand:this.formModel.defaultCarInfo.brand},(function(e){t.modeData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;d["a"].types({seriesId:e,brandId:this.form.brand},(function(e){t.modeList=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},beforeAvatarUpload:function(e){var t=/^image\/(.*)$/.test(e.type);if(!t)return this.$message.error("请选择符合图片格式的文件上传!"),!1;var i=e.size/1024<=200;return!!i||(this.$message.error("上传图片大小不能超过 200K!"),!1)},addMember:function(){this.formModel={userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",vin:"",brand:"",series:"",type:""}},this.dialogVisible=!0},getOrderStatus:function(e){switch(e){case"11":return"卖家已发货";case"10":return"退款退货完成";case"9":return"退款退货中";case"8":return"已过期";case"7":return"已评价";case"6":return"订单关闭";case"5":return"交易完成";case"4":return"订单已执行";case"3":return"买家已付款";case"2":return"商家已确认";case"1":return"待商家确认";default:return"无"}},testDrives:function(){var e=this,t={pageSize:1e3,pageNumber:1,shopId:window.top.SHOP_ID||""};S["a"].get("/admin/testDriveMgmt/testDrives.jhtml",t).then((function(t){e.restaurants=t.dataList.map((function(e){return{value:e.car.plateNumber,id:e.id,type:e.car.type}}))})).catch((function(e){console.log(e.errorMessage)}))},querySearchAsync:function(e,t){var i=this.restaurants,a=e?i.filter(this.createStateFilter(e)):i;t(a)},createStateFilter:function(e){return function(e){return!0}},handleSelect:function(e){this.form.orderItems[0].appointment.testDriveId=e.id}})},T=k,D=(i("c454"),Object(v["a"])(T,a,r,!1,null,null,null));t["a"]=D.exports},"78c2":function(e,t,i){"use strict";var a=i("bd50"),r=i.n(a);r.a},"7ba1":function(e,t,i){},"7bd6":function(e,t,i){"use strict";var a=i("562c"),r=i.n(a);r.a},"7cce":function(e,t,i){},"7d91":function(e,t,i){},"7f45":function(e,t,i){},8506:function(e,t,i){"use strict";var a=i("1910"),r=i.n(a);r.a},8819:function(e,t,i){},"8d37":function(e,t,i){},"8f05":function(e,t,i){"use strict";var a=i("28d7"),r=i.n(a);r.a},"8f4d":function(e,t,i){},9056:function(e,t,i){"use strict";var a=i("25c2"),r=i.n(a);r.a},"90b3":function(e,t,i){"use strict";var a=i("7d91"),r=i.n(a);r.a},"90c8":function(e,t,i){"use strict";var a=i("9a6a"),r=i.n(a);r.a},"912a":function(e,t,i){},"924e":function(e,t,i){"use strict";var a=i("f223"),r=i.n(a);r.a},"92cd":function(e,t,i){"use strict";var a=i("0bb1"),r=i.n(a);r.a},9433:function(e,t,i){"use strict";var a=i("202d"),r=i.n(a);r.a},9462:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"afterSale-process"},[e._l(e.refunds,(function(t,a){return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:t.id},[i("div",{staticClass:"refundsHead"},[i("div",{staticClass:"refundsContent"},[i("img",{staticClass:"image",attrs:{src:t.orderItem.thumbnail,width:"20px"}}),i("label",[e._v(e._s(t.orderItem.fullName))]),"2"!==t.type?i("label",{staticClass:"price"},[e._v("￥"+e._s(t.amount))]):e._e(),i("label",{staticClass:"refundsState"},[e._v(e._s(e.refundsStates[t.state]))])])]),i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新申请",status:"0"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(t.refundsRecords,(function(r){return"0"==r.type?i("div",{key:r.id},["1"===t.type?i("p",[e._v("买家申请退货")]):e._e(),"0"===t.type?i("p",[e._v("买家申请退款")]):e._e(),"2"===t.type?i("p",[e._v("买家申请换货")]):e._e(),"2"!==t.type?i("p",[e._v("退款原因："+e._s(t.reason))]):e._e(),"2"!==t.type?i("p",[e._v("退款金额："+e._s(t.amount))]):e._e(),"2"!==t.type?i("p",[e._v("退款说明："+e._s(t.explain))]):e._e(),"2"===t.type?i("p",[e._v("换货原因："+e._s(t.reason))]):e._e(),"2"===t.type?i("p",[e._v("换货数量："+e._s(t.orderItem.quantity))]):e._e(),"2"===t.type?i("p",[e._v("换货地址："+e._s(t.receiverAddress))]):e._e(),"2"===t.type?i("p",[e._v("换货说明："+e._s(t.explain))]):e._e(),i("div",{staticStyle:{display:"flex"}},[e._v(" 凭证： "),e._l(t.refundsImages,(function(t){return i("div",{key:t,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:t,height:"100"},on:{click:function(i){return e.enlarge(t)}}})])})),i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})])],2),i("p",[e._v(e._s(t.createDate))]),"0"===t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree(a)}}},[e._v("同意")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse(a)}}},[e._v("拒绝")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"agreeForm_"+a}},[i("table",{staticClass:"agreeContent",attrs:{id:"agreeContent_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"2"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("input",{attrs:{type:"hidden",name:"refundType"},domProps:{value:t.type}}),i("tr",[i("th",[e._v("售后详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),"2"===t.type||"1"===t.type?i("tr",[i("th",[e._v("收货地址：")]),i("el-card",[i("div",{staticClass:"left",on:{click:e.clickAdress}},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",{staticStyle:{float:"right"}},[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit(a)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"refuseForm_"+a}},[i("table",{staticClass:"refuseContent",attrs:{id:"refuseContent_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"1"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit(a)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),0)]),i("el-step",{attrs:{title:"售后中",status:"2"===t.refundsRecords[0].type||"3"===t.refundsRecords[0].type||"7"===t.refundsRecords[0].type||"8"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(a){return"2"===a.type&&"2"!==t.type?i("div",{key:a.id},[i("p",[e._v("卖家同意退货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(a.details))]),i("p",[e._v(e._s(a.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(a){return"2"===a.type&&"2"===t.type?i("div",{key:a.id},[i("p",[e._v("卖家同意换货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(a.details))]),i("p",[e._v(e._s(a.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(r){return"3"===r.type?i("div",{key:r.id},[i("p",[e._v("买家已退货，等待卖家收货")]),i("p",[e._v("物流公司："+e._s(r.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(r.trackingNo))]),"2"!==t.type?i("p",[e._v("退款说明："+e._s(r.details))]):e._e(),i("p",[e._v(e._s(r.happenDate))]),e._l(t.returnsImages,(function(a){return"2"!==t.type?i("div",{key:a,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:a,height:"100"},on:{click:function(t){return e.enlarge(a)}}})]):e._e()})),"2"!==t.type?i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})]):e._e(),"3"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree1(a)}}},[e._v("确认收货")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse1(a)}}},[e._v("拒绝收货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"refuseForm1_"+a}},[i("table",{staticClass:"refuseContent1",attrs:{id:"refuseContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"4"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit1(a)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"agreeForm1_"+a}},[i("table",{staticClass:"agreeContent1",attrs:{id:"agreeContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),"2"!==t.type?i("input",{attrs:{type:"hidden",name:"state",value:"5"}}):e._e(),"2"===t.type?i("input",{attrs:{type:"hidden",name:"state",value:"7"}}):e._e(),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("收货详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit1(a)}}},[e._v("确定")]):e._e()],1)])],2):e._e()})),e._l(t.refundsRecords,(function(r){return"7"===r.type?i("div",{key:r.id},[i("p",[e._v("卖家已收到买家的换货商品，待发出换货商品")]),i("p",[e._v(e._s(r.happenDate))]),"7"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shipping(a)}}},[e._v("发货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"shippingForm_"+a}},[i("table",{staticClass:"shippingContent1",attrs:{id:"shippingContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"8"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("物流公司:")]),i("td",[i("select",{directives:[{name:"model",rawName:"v-model",value:e.deliveryId,expression:"deliveryId"}],staticStyle:{width:"225px"},attrs:{name:"deliveryId"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.deliveryId=t.target.multiple?i:i[0]}}},e._l(e.deliveryCorps,(function(e,t){return i("option",{key:t,attrs:{label:e.name},domProps:{value:e.id}})})),0)])]),i("tr",[i("th",[e._v("物流单号:")]),i("td",[i("input",{attrs:{type:"text",name:"trackingNo",onKeyUp:"value=value.replace(/[\\W]/g,'')"}})])]),i("tr",[i("th",[e._v("物流费用:")]),i("td",[i("input",{attrs:{type:"text",name:"tackingAmount",onkeyup:"this.value=this.value.replace(/[^\\d.]/g,'')"}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shippingSubmit1(a)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),e._l(t.refundsRecords,(function(t){return"8"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家已发出换新货，等待买家收货")]),i("p",[e._v("物流公司："+e._s(t.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(t.trackingNo))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"售后完成",status:"1"===t.refundsRecords[0].type||"4"===t.refundsRecords[0].type||"5"===t.refundsRecords[0].type||"6"===t.refundsRecords[0].type||"9"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(t){return"5"==t.type?i("div",{key:t.id},[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("退款金额："+e._s(t.amount))]),i("p",[e._v("售后详情："+e._s(t.details))])]):e._e()})),e._l(t.refundsRecords,(function(a){return"6"==a.type&&"2"!==t.type?i("div",{key:a.id},[i("p",[e._v("买家取消退货")])]):e._e()})),e._l(t.refundsRecords,(function(a){return"6"==a.type&&"2"===t.type?i("div",{key:a.id},[i("p",[e._v("买家取消换货")])]):e._e()})),e._l(t.refundsRecords,(function(t){return"1"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝售后申请")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"4"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝收货")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"9"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已确认收货，换货完成")])]):e._e()}))],2)])],1)],1)})),0===e.refunds.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],2)},r=[],o=(i("d3b7"),i("5530")),s=i("e42c"),n=i("624d"),l=i.n(n),d=i("f36f"),c=i("f260"),p=i.n(c),m=i("2f62"),u=i("1ab1"),f=i("c596"),h=i("44e3"),g={components:{BizGrid:d["a"],BillInfo:h["a"]},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{activeStep:0,loading:!1,dialogVisiable:!1,refunds:[],refundsRecords:[],refundsImages:[],formData:[],getAddress:{},refundType:"",refundId:"",orderId:"",message:"",imageValue:"",imgStyle:"",deliveryId:"",trackingNo:"",tackingAmount:"",currentState:"",active:"",defaultImage:l.a,showShippingEditor:!1,deliveryCorps:[],refundsStates:{0:"未确认",1:"拒绝退款退货/换货申请",2:"同意退/换货申请",3:"买家发货",4:"卖家拒收",5:"卖家退款",6:"取消退款",7:"卖家发货",8:"买家收货"}}},computed:Object(o["a"])(Object(o["a"])({},Object(m["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+p.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.initData(),this.getAddressList()},watch:{itemId:function(e){this.initData()}},methods:{clickAdress:function(){console.log(1111),this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};u["a"].get(f["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},initData:function(){var e=this,t={orderId:this.itemId};s["a"].viewOrderRefunds(t,(function(t){e.refunds=t.refunds}),(function(e){console.log(e)}))},close:function(){document.querySelector(".overlay").style.display="none"},enlarge:function(e){document.querySelector(".overlay").style.display="block",this.imageValue=e||l.a,this.imgStyle="position: absolute; top: 100px; right: 150px;padding:20px;height: 500px;background:#fff"},agree:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="block";for(var a=document.getElementById(t).getElementsByTagName("input"),r=0;r<a.length-1;r++)this.refundType=a[1].value;document.getElementById(i).style.display="none"},refuse:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agree1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="block",document.getElementById(i).style.display="none"},refuse1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agreeSubmit:function(e){var t=this,i="agreeForm_"+e,a={depotReceiverId:this.getAddress.id,orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[4].value,remarks:document.getElementById(i)[5].value};this.loading=!0,s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},refuseSubmit:function(e){var t=this,i="refuseForm_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(a),this.loading=!0,s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),t.loading=!1,document.getElementById(i).style.display="none"}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},agreeSubmit1:function(e){var t=this;this.loading=!0;var i="agreeForm1_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(a),s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage),t.loading=!1}))},refuseSubmit1:function(e){var t=this;this.loading=!0;var i="refuseForm1_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},shipping:function(e){var t="shippingContent1_"+e;document.getElementById(t).style.display="block",this.init()},init:function(){var e=this;s["a"].viewOrder({orderId:this.itemId},(function(t){e.deliveryCorps=t.deliveryCorps}),(function(t){e.$message.warning(t.errorMessage)}))},shippingSubmit1:function(e){var t=this;this.loading=!0;var i="shippingForm_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:"",remarks:"",deliveryId:document.getElementById(i)[3].value,trackingNo:document.getElementById(i)[4].value,tackingAmount:document.getElementById(i)[5].value};s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},messageClick:function(){this.initData(),this.message=""}}},b=g,v=(i("007c"),i("2877")),y=Object(v["a"])(b,a,r,!1,null,null,null);t["a"]=y.exports},9678:function(e,t,i){},"971b":function(e,t,i){"use strict";var a=i("f8a5"),r=i.n(a);r.a},"990e":function(e,t,i){},"9a6a":function(e,t,i){},"9b1a":function(e,t,i){"use strict";var a=i("cc00"),r=i.n(a);r.a},"9b3f":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"afterSale-process"},[e._l(e.refunds,(function(t,a){return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:t.id},[i("div",{staticClass:"refundsHead"},[i("div",{staticClass:"refundsContent"},[i("img",{staticClass:"image",attrs:{src:t.orderItem.thumbnail,width:"20px"}}),i("label",[e._v(e._s(t.orderItem.fullName))]),"2"!==t.type?i("label",{staticClass:"price"},[e._v("￥"+e._s(t.amount))]):e._e(),i("label",{staticClass:"refundsState"},[e._v(e._s(e.refundsStates[t.state]))])])]),i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新申请",status:"0"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(t.refundsRecords,(function(r){return"0"==r.type?i("div",{key:r.id},["1"===t.type?i("p",[e._v("买家申请退货")]):e._e(),"0"===t.type?i("p",[e._v("买家申请退款")]):e._e(),"2"===t.type?i("p",[e._v("买家申请换货")]):e._e(),"2"!==t.type?i("p",[e._v("退款原因："+e._s(t.reason))]):e._e(),"2"!==t.type?i("p",[e._v("退款金额："+e._s(t.amount))]):e._e(),"2"!==t.type?i("p",[e._v("退款说明："+e._s(t.explain))]):e._e(),"2"===t.type?i("p",[e._v("换货原因："+e._s(t.reason))]):e._e(),"2"===t.type?i("p",[e._v("换货数量："+e._s(t.orderItem.quantity))]):e._e(),"2"===t.type?i("p",[e._v("换货地址："+e._s(t.receiverAddress))]):e._e(),"2"===t.type?i("p",[e._v("换货说明："+e._s(t.explain))]):e._e(),i("div",{staticStyle:{display:"flex"}},[e._v(" 凭证： "),e._l(t.refundsImages,(function(t){return i("div",{key:t,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:t,height:"100"},on:{click:function(i){return e.enlarge(t)}}})])})),i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})])],2),i("p",[e._v(e._s(t.createDate))]),"0"===t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree(a)}}},[e._v("同意")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse(a)}}},[e._v("拒绝")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"agreeForm_"+a}},[i("table",{staticClass:"agreeContent",attrs:{id:"agreeContent_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"2"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("input",{attrs:{type:"hidden",name:"refundType"},domProps:{value:t.type}}),i("tr",[i("th",[e._v("售后详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),"2"===t.type||"1"===t.type?i("tr",[i("th",[e._v("收货地址：")]),i("el-card",[i("div",{staticClass:"left",on:{click:e.clickAdress}},[i("div",{staticClass:"address"},[i("div",{staticClass:"receiver-address"},[i("span",[e._v(e._s(e.getAddress?e.getAddress.consignee:""))]),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.getAddress?e.getAddress.phone:""))])]),i("div",{staticClass:"icon"},[i("span",[i("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.getAddress?e.getAddress.areaName+e.getAddress.address:"请设置收货地址")+" ")]),i("span",{staticStyle:{float:"right"}},[i("i",{staticClass:"right-arrow iconfont biz-icon-i-web-zk1"})])])])]),i("div",[i("i",{staticClass:"right-arrow iconfont icon-i-sh-man-tz"})])])],1):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit(a)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"refuseForm_"+a}},[i("table",{staticClass:"refuseContent",attrs:{id:"refuseContent_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"1"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit(a)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),0)]),i("el-step",{attrs:{title:"售后中",status:"2"===t.refundsRecords[0].type||"3"===t.refundsRecords[0].type||"7"===t.refundsRecords[0].type||"8"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(a){return"2"===a.type&&"2"!==t.type?i("div",{key:a.id},[i("p",[e._v("卖家同意退货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(a.details))]),i("p",[e._v(e._s(a.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(a){return"2"===a.type&&"2"===t.type?i("div",{key:a.id},[i("p",[e._v("卖家同意换货申请，等待买家发货给卖家")]),i("p",[e._v("售后详情："+e._s(a.details))]),i("p",[e._v(e._s(a.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(r){return"3"===r.type?i("div",{key:r.id},[i("p",[e._v("买家已退货，等待卖家收货")]),i("p",[e._v("物流公司："+e._s(r.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(r.trackingNo))]),"2"!==t.type?i("p",[e._v("退款说明："+e._s(r.details))]):e._e(),i("p",[e._v(e._s(r.happenDate))]),e._l(t.returnsImages,(function(a){return"2"!==t.type?i("div",{key:a,staticStyle:{display:"inline-block",padding:"0px 5px"}},[i("img",{attrs:{src:a,height:"100"},on:{click:function(t){return e.enlarge(a)}}})]):e._e()})),"2"!==t.type?i("div",{staticClass:"overlay",on:{click:e.close}},[i("img",{style:e.imgStyle,attrs:{src:e.imageValue}})]):e._e(),"3"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agree1(a)}}},[e._v("确认收货")]):e._e(),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuse1(a)}}},[e._v("拒绝收货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"refuseForm1_"+a}},[i("table",{staticClass:"refuseContent1",attrs:{id:"refuseContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"4"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("拒绝原因:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.refuseSubmit1(a)}}},[e._v("确定")]):e._e()],1)]),i("form",{attrs:{action:"",id:"agreeForm1_"+a}},[i("table",{staticClass:"agreeContent1",attrs:{id:"agreeContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),"2"!==t.type?i("input",{attrs:{type:"hidden",name:"state",value:"5"}}):e._e(),"2"===t.type?i("input",{attrs:{type:"hidden",name:"state",value:"7"}}):e._e(),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("收货详情:")]),i("td",[i("textarea",{attrs:{name:"details",rows:3}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.agreeSubmit1(a)}}},[e._v("确定")]):e._e()],1)])],2):e._e()})),e._l(t.refundsRecords,(function(r){return"7"===r.type?i("div",{key:r.id},[i("p",[e._v("卖家已收到买家的换货商品，待发出换货商品")]),i("p",[e._v(e._s(r.happenDate))]),"7"==t.state?i("div",[e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shipping(a)}}},[e._v("发货")]):e._e()],1):e._e(),i("form",{attrs:{action:"",id:"shippingForm_"+a}},[i("table",{staticClass:"shippingContent1",attrs:{id:"shippingContent1_"+a}},[i("input",{attrs:{type:"hidden",name:"refundId"},domProps:{value:t.id}}),i("input",{attrs:{type:"hidden",name:"state",value:"8"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.orderId,expression:"orderId"}],attrs:{type:"hidden",name:"orderId"},domProps:{value:e.orderId},on:{input:function(t){t.target.composing||(e.orderId=t.target.value)}}}),i("tr",[i("th",[e._v("物流公司:")]),i("td",[i("select",{directives:[{name:"model",rawName:"v-model",value:e.deliveryId,expression:"deliveryId"}],staticStyle:{width:"225px"},attrs:{name:"deliveryId"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.deliveryId=t.target.multiple?i:i[0]}}},e._l(e.deliveryCorps,(function(e,t){return i("option",{key:t,attrs:{label:e.name},domProps:{value:e.id}})})),0)])]),i("tr",[i("th",[e._v("物流单号:")]),i("td",[i("input",{attrs:{type:"text",name:"trackingNo",onKeyUp:"value=value.replace(/[\\W]/g,'')"}})])]),i("tr",[i("th",[e._v("物流费用:")]),i("td",[i("input",{attrs:{type:"text",name:"tackingAmount",onkeyup:"this.value=this.value.replace(/[^\\d.]/g,'')"}})])]),e.isEdit?i("el-button",{staticClass:"demo-step-button",attrs:{size:"small"},on:{click:function(t){return e.shippingSubmit1(a)}}},[e._v("确定")]):e._e()],1)])]):e._e()})),e._l(t.refundsRecords,(function(t){return"8"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家已发出换新货，等待买家收货")]),i("p",[e._v("物流公司："+e._s(t.deliveryCorp))]),i("p",[e._v("物流单号："+e._s(t.trackingNo))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"售后完成",status:"1"===t.refundsRecords[0].type||"4"===t.refundsRecords[0].type||"5"===t.refundsRecords[0].type||"6"===t.refundsRecords[0].type||"9"===t.refundsRecords[0].type?"finish":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(t.refundsRecords,(function(t){return"5"==t.type?i("div",{key:t.id},[i("p",[e._v(e._s(t.happenDate))]),i("p",[e._v("退款金额："+e._s(t.amount))]),i("p",[e._v("售后详情："+e._s(t.details))])]):e._e()})),e._l(t.refundsRecords,(function(a){return"6"==a.type&&"2"!==t.type?i("div",{key:a.id},[i("p",[e._v("买家取消退货")])]):e._e()})),e._l(t.refundsRecords,(function(a){return"6"==a.type&&"2"===t.type?i("div",{key:a.id},[i("p",[e._v("买家取消换货")])]):e._e()})),e._l(t.refundsRecords,(function(t){return"1"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝售后申请")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"4"===t.type?i("div",{key:t.id},[i("p",[e._v("卖家拒绝收货")]),i("p",[e._v("拒绝原因："+e._s(t.details))]),i("p",[e._v(e._s(t.happenDate))])]):e._e()})),e._l(t.refundsRecords,(function(t){return"9"===t.type?i("div",{key:t.id},[i("p",[e._v("买家已确认收货，换货完成")])]):e._e()}))],2)])],1)],1)})),0===e.refunds.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.dialogVisiable,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("bill-info",{staticStyle:{"margin-top":"15px"},on:{selectedItem:e.selectedItem}})],1)],2)},r=[],o=(i("d3b7"),i("5530")),s=i("e42c"),n=i("624d"),l=i.n(n),d=i("f36f"),c=i("f260"),p=i.n(c),m=i("2f62"),u=i("1ab1"),f=i("c596"),h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"bill-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return i("el-card",{key:t.id},[i("div",{on:{click:function(i){return e.selectItem(t)}}},[i("div",{staticClass:"top"},[i("span",[e._v(e._s(t.consignee))]),i("span",[e._v(e._s(t.phone))])]),i("div",{staticClass:"content"},[i("span",[e._v(e._s(t.areaName+t.address))])])]),i("div",{staticClass:"bottom"},["1"===t.isDefault?i("div",[e._v("默认")]):e._e(),"0"===t.isDefault?i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(i){e.$set(t,"isDefault",i)},expression:"receiver.isDefault"}},[e._v("设为默认 ")]):e._e(),i("div",{staticClass:"handler"},[i("i",{staticClass:"el-icon-edit-outline",on:{click:function(i){return e.editForm(t)}}},[e._v("编辑")]),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"省市"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},g=[],b=i("8330"),v=i("ce2e"),y={components:{BizSaveButton:b["a"],BizAreaSelect:v["a"],BizGrid:d["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(o["a"])(Object(o["a"])({},Object(m["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+p.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(o["a"])(Object(o["a"])({},Object(m["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u["a"].delete(f["g"].hypermarketMgmt.receiver,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};u["a"].post(f["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};u["a"].put(f["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.updateSelAddress(e),this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};u["a"].get(f["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},_=y,I=(i("d79d"),i("2877")),w=Object(I["a"])(_,h,g,!1,null,null,null),x=w.exports,S={components:{BizGrid:d["a"],BillInfo:x},props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{activeStep:0,loading:!1,dialogVisiable:!1,refunds:[],refundsRecords:[],refundsImages:[],formData:[],getAddress:{},refundType:"",refundId:"",orderId:"",message:"",imageValue:"",imgStyle:"",deliveryId:"",trackingNo:"",tackingAmount:"",currentState:"",active:"",defaultImage:l.a,showShippingEditor:!1,deliveryCorps:[],refundsStates:{0:"未确认",1:"拒绝退款退货/换货申请",2:"同意退/换货申请",3:"买家发货",4:"卖家拒收",5:"卖家退款",6:"取消退款",7:"卖家发货",8:"买家收货"}}},computed:Object(o["a"])(Object(o["a"])({},Object(m["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+p.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.initData(),this.getAddressList()},watch:{itemId:function(e){this.initData()}},methods:{clickAdress:function(){console.log(1111),this.dialogVisiable=!0},selectedItem:function(e){this.dialogVisiable=!1,this.getAddress=e},getAddressList:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};u["a"].get(f["g"].hypermarketMgmt.receiverList,t).then((function(t){t.receivers.length>0&&(e.getAddress=t.receivers[0])})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},initData:function(){var e=this,t={orderId:this.itemId};s["a"].viewOrderRefunds(t,(function(t){e.refunds=t.refunds}),(function(e){console.log(e)}))},close:function(){document.querySelector(".overlay").style.display="none"},enlarge:function(e){document.querySelector(".overlay").style.display="block",this.imageValue=e||l.a,this.imgStyle="position: absolute; top: 100px; right: 150px;padding:20px;height: 500px;background:#fff"},agree:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="block";for(var a=document.getElementById(t).getElementsByTagName("input"),r=0;r<a.length-1;r++)this.refundType=a[1].value;document.getElementById(i).style.display="none"},refuse:function(e){var t="agreeContent_"+e,i="refuseContent_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agree1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="block",document.getElementById(i).style.display="none"},refuse1:function(e){var t="agreeContent1_"+e,i="refuseContent1_"+e;document.getElementById(t).style.display="none",document.getElementById(i).style.display="block"},agreeSubmit:function(e){var t=this,i="agreeForm_"+e,a={orderId:this.itemId,depotReceiverId:this.getAddress.id,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[4].value,remarks:document.getElementById(i)[5].value};this.loading=!0,s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},refuseSubmit:function(e){var t=this,i="refuseForm_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(a),this.loading=!0,s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),t.loading=!1,document.getElementById(i).style.display="none"}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},agreeSubmit1:function(e){var t=this;this.loading=!0;var i="agreeForm1_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};console.log(a),s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage),t.loading=!1}))},refuseSubmit1:function(e){var t=this;this.loading=!0;var i="refuseForm1_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:document.getElementById(i)[3].value,remarks:document.getElementById(i)[4].value};s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},shipping:function(e){var t="shippingContent1_"+e;document.getElementById(t).style.display="block",this.init()},init:function(){var e=this;s["a"].viewOrder({orderId:this.itemId},(function(t){e.deliveryCorps=t.deliveryCorps}),(function(t){e.$message.warning(t.errorMessage)}))},shippingSubmit1:function(e){var t=this;this.loading=!0;var i="shippingForm_"+e,a={orderId:this.itemId,refundId:document.getElementById(i)[0].value,refundsState:document.getElementById(i)[1].value,details:"",remarks:"",deliveryId:document.getElementById(i)[3].value,trackingNo:document.getElementById(i)[4].value,tackingAmount:document.getElementById(i)[5].value};s["a"].refundsAudit(a,(function(e){t.$message.success("操作成功"),t.initData(),t.$emit("operationSuccess"),document.getElementById(i).style.display="none",t.loading=!1}),(function(e){t.loading=!1,"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},messageClick:function(){this.initData(),this.message=""}}},C=S,M=(i("6975"),Object(I["a"])(C,a,r,!1,null,null,null));t["a"]=M.exports},"9c7b":function(e,t,i){},"9ce9":function(e,t,i){"use strict";var a=i("d47e"),r=i.n(a);r.a},"9de1":function(e,t,i){"use strict";var a=i("7f45"),r=i.n(a);r.a},a0f6:function(e,t,i){},a57d:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"my-invoice-my-purchase"},[i("div",{staticClass:"invoice-info-my-purchase"},[i("span",{staticClass:"invoice-title"},[e._v("发票信息")]),i("el-form",{attrs:{"label-width":"100","inline-message":!0}},[i("el-form-item",{attrs:{label:"发票抬头："}},[e._v(e._s(e.curInvoice.invoiceTitle))]),i("el-form-item",{attrs:{label:"发票类型："}},[e._v(e._s("0"===e.curInvoice.invoiceType?"个人":"1"===e.curInvoice.invoiceType?"增值税普通发票":"2"===e.curInvoice.invoiceType?"增值税专用发票":""))]),i("el-form-item",{attrs:{label:"发票状态："}},[e._v(e._s(e.curInvoice.invoiceState?e.curInvoice.invoiceState:"未申请"))]),i("el-form-item",{attrs:{label:"联系人："}},[e._v(e._s(e.curInvoice.contacts))]),i("el-form-item",{attrs:{label:"联系电话："}},[e._v(e._s(e.curInvoice.mobile))]),i("el-form-item",{attrs:{label:"所在地区："}},[e._v(e._s(e.curInvoice.areaName))]),i("el-form-item",{attrs:{label:"详细地址："}},[e._v(e._s(e.curInvoice.address))]),e.expressName?i("el-form-item",{attrs:{label:"快递公司："}},[e._v(e._s(e.expressName))]):e._e(),e.curInvoice.expressCode?i("el-form-item",{attrs:{label:"快递单号："}},[e._v(e._s(e.curInvoice.expressCode))]):e._e()],1),this.shippingSn?i("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("el-collapse-item",{attrs:{title:"发票追踪",name:"1"}},[i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[e.getTraces?i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0):e._e(),this.shippingTraces&&0===this.shippingTraces.length?i("ul",[i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v(" 物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s("暂无轨迹"))])]),i("div",{staticClass:"i-item"},[e._v("快递公司："+e._s(e.expressName))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.curInvoice.expressCode))])])]):e._e()])])])],1):e._e()],1),e.invoiceInfoId&&e.hasAuthEdit?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("提交")]):e._e(),e.invoiceInfoId&&e.hasAuthEdit?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.cancle}},[e._v("取消")]):e._e()],1)},r=[],o=(i("caad"),i("d81d"),i("b0c0"),i("d3b7"),i("2532"),i("5530")),s=i("2f62"),n=i("1ab1"),l=i("c596"),d=i("f36f"),c={name:"my-invoice",data:function(){return{deliverys:[],activeNames:["1"],expressName:"",shippingTraces:[],shippingSn:""}},props:{orderId:{type:String,default:""},orderIds:{type:Array},invoiceInfoId:{type:String,default:""}},components:{BizGrid:d["a"]},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(s["c"])(["getUser"])),Object(s["c"])("Order",["orderInfo","curInvoice"])),Object(s["c"])("Authority",["currentAuth"])),{},{hasAuthEdit:function(){return this.currentAuth.includes("admin:purchaseOrder.edit")},getTraces:function(){return!!(this.shippingTraces&&this.shippingTraces.length>0)}}),watch:{invoiceInfoId:function(e){}},methods:Object(o["a"])(Object(o["a"])({},Object(s["d"])("Order",["updateCurInvoice"])),{},{onContact:function(){this.$router.push({path:"/custom-service"})},getInvoiceInfo:function(){var e=this,t={clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,methodName:"QueryInvoiceBasicInfo"};n["a"].get(l["g"].hypermarketMgmt.invoiceByOrder,t).then((function(t){"0"===t.invoice.invoiceState?(t.invoice.invoiceState="待开票",t.invoice.expressState="待开票"):"1"===t.invoice.invoiceState?(t.invoice.invoiceState="未邮寄",t.invoice.expressState="未邮寄"):"2"===t.invoice.invoiceState&&(t.invoice.invoiceState="已邮寄",t.invoice.expressState="已邮寄"),e.deliverys=t.deliverys,e.deliverys.map((function(i){i.id===t.invoice.express&&(e.expressName=i.name)})),e.shippingSn=t.shipping.sn,e.shippingSn&&e.expressInfo(),t.invoice.area&&(t.invoice.areaName=t.invoice.area.fullName),e.updateCurInvoice(t.invoice)})).catch((function(t){"906"===t.resultCode&&e.updateCurInvoice({})})).finally((function(){}))},handleChange:function(){},cancle:function(){this.$emit("cancle")},submit:function(){var e=this,t={clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,invoiceInfoId:this.curInvoice.id,orderIds:this.orderIds,methodName:"CreateInvoiceBasicInfo"};n["a"].post(l["g"].hypermarketMgmt.applyInvoice,t).then((function(t){e.$message.success("申请成功"),e.$emit("close")})).catch((function(t){e.$message.warning(t.errorMessage),"906"===t.resultCode&&e.updateCurInvoice({})})).finally((function(){}))},expressInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.shippingSn};n["a"].get(l["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}),created:function(){}},p=c,m=(i("4837"),i("2877")),u=Object(m["a"])(p,a,r,!1,null,null,null);t["a"]=u.exports},a5c8:function(e,t,i){"use strict";var a=i("0d1d"),r=i.n(a);r.a},a5eb:function(e,t,i){},a751:function(e,t,i){"use strict";var a=i("a0f6"),r=i.n(a);r.a},a9e3:function(e,t,i){"use strict";var a=i("83ab"),r=i("da84"),o=i("94ca"),s=i("6eeb"),n=i("5135"),l=i("c6b6"),d=i("7156"),c=i("c04e"),p=i("d039"),m=i("7c73"),u=i("241c").f,f=i("06cf").f,h=i("9bf2").f,g=i("58a8").trim,b="Number",v=r[b],y=v.prototype,_=l(m(y))==b,I=function(e){var t,i,a,r,o,s,n,l,d=c(e,!1);if("string"==typeof d&&d.length>2)if(d=g(d),t=d.charCodeAt(0),43===t||45===t){if(i=d.charCodeAt(2),88===i||120===i)return NaN}else if(48===t){switch(d.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+d}for(o=d.slice(2),s=o.length,n=0;n<s;n++)if(l=o.charCodeAt(n),l<48||l>r)return NaN;return parseInt(o,a)}return+d};if(o(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var w,x=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof x&&(_?p((function(){y.valueOf.call(i)})):l(i)!=b)?d(new v(I(t)),i,x):I(t)},S=a?u(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;S.length>C;C++)n(v,w=S[C])&&!n(x,w)&&h(x,w,f(v,w));x.prototype=y,y.constructor=x,s(r,b,x)}},a9f4:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"apply-info"},[i("div",{staticClass:"apply-info-div"},[i("div",{staticClass:"apply-info-content"},[i("div",{staticClass:"apply-top-content"},[i("div",{staticClass:"apply-follow-up",on:{click:function(t){return e.onOrderSchedules(e.orderData.id)}}},[i("span",[e._v("申请单跟踪")]),i("div",{staticClass:"apply-state"},[i("span",[e._v(e._s(e.getOrderState))]),i("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"10px",color:"#808080"}})])]),i("div",{staticClass:"receiver-info"},[i("span",[e._v(e._s(e.orderData.depot?e.orderData.depot.contactor:""))]),i("span",[e._v(e._s(e.orderData.depot?e.orderData.depot.phone:""))]),i("p",[i("i",{staticClass:"el-icon-location-outline",staticStyle:{"margin-right":"5px"}}),e._v(" "+e._s(e.orderData.depot?e.orderData.depot.address:"")+" ")])])]),i("div",{staticClass:"apply-info-new"},[i("div",{staticClass:"shop-name",on:{click:e.goSupplier}},[i("img",{attrs:{src:e.iconShop}}),i("span",{staticStyle:{fontSize:"14px"}},[e._v(e._s(e.orderData.relatePartnerName))])]),e._l(e.orderData.itemDatas,(function(t,a){return i("div",{key:a},[i("div",{staticClass:"good-info"},[i("div",{staticClass:"goods-img"},[i("img",{ref:"img",refInFor:!0,staticClass:"img",attrs:{src:t.thumbnail&&t.thumbnail.indexOf("/")>=0?t.thumbnail:e.defaultImg},on:{error:function(t){return e.imgError(a)}}})]),i("div",{staticClass:"good-right"},[i("div",{staticClass:"good-name"},[i("span",{staticStyle:{flex:"1"}},[e._v(" "+e._s(t.specValue)+" ")])]),i("div",{staticStyle:{"margin-bottom":"10px"}},[t.product.barCode?i("span",{staticStyle:{"font-size":"14px","margin-right":"10px"}},[e._v(e._s(t.product.barCode))]):e._e()]),i("div",{staticClass:"good-price"},[i("span",[e._v("￥"+e._s(t.price))]),i("span",[e._v("X"+e._s(t.amount))])])])])])}))],2),i("div",{staticClass:"price-info-content"},[i("div",{staticClass:"total-price"},[i("span",[e._v("合计")]),i("span",{staticStyle:{color:"red"}},[e._v("￥"+e._s(e.orderData.totalFee))])])]),i("div",{staticClass:"pay-type"},[i("span",[e._v("单据编号: "+e._s(e.orderData.sn))]),i("span",[e._v("创建时间: "+e._s(e.orderData.createDate))]),i("span",[e._v("申请人: "+e._s(e.orderData.applierName))])])])]),e.isPend?i("div",{staticStyle:{float:"right"},attrs:{slot:"bottom"},slot:"bottom"},[e.hasAuthExamine&&("1"===e.orderData.state&&"1"===e.orderData.audit||"2"===e.orderData.state&&"1"===e.orderData.audit)?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.toPass(e.orderData,"1")}}},[e._v("审核")]):e._e(),"0"===e.orderData.state?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.statusChange(e.orderData,"0")}}},[e._v("提交")]):e._e(),"1"===e.orderData.state&&"1"===e.orderData.isApplier?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.statusChange(e.orderData,"3")}}},[e._v("撤回")]):e._e()],1):e._e(),i("el-dialog",{attrs:{visible:e.dialogVisiable,center:"",width:"800px","min-height":"400px","append-to-body":"","custom-class":"orderDialog"},on:{"update:visible":function(t){e.dialogVisiable=t}}},[i("apply-follow",{ref:"invoice"})],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showPassOrder,center:"","append-to-body":"","custom-class":"close-order-dialog",title:"审核"},on:{"update:visible":function(t){e.showPassOrder=t}}},[i("div",[i("div",{staticClass:"reson-container"},[i("span",[e._v("审核结果：")]),i("el-radio",{attrs:{label:"1",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("通过")]),i("el-radio",{attrs:{label:"2",size:"mini"},model:{value:e.auditState,callback:function(t){e.auditState=t},expression:"auditState"}},[e._v("驳回")]),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.auditState,expression:"auditState==='2'"}],staticStyle:{padding:"5px 0px","margin-top":"15px"}},[i("span",[e._v("驳回理由：")]),i("el-select",{staticClass:"order-select",attrs:{placeholder:"请选择驳回理由",size:"mini"},model:{value:e.curSelectCloseReason,callback:function(t){e.curSelectCloseReason=t},expression:"curSelectCloseReason"}},e._l(e.reasonList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),i("div",{staticClass:"close-button",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showPassOrder=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange(e.row,e.auditState)}}},[e._v("确定")])],1)])],1)},r=[],o=(i("caad"),i("d3b7"),i("2532"),i("5530")),s=i("f36f"),n=i("2f62"),l=i("1ab1"),d=i("c596"),c=i("e83a"),p=i.n(c),m=i("f606"),u=i.n(m),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"order-log-info"},[i("div",{staticStyle:{"text-align":"center","font-size":"15px","margin-bottom":"20px"}},[e._v("单据进度跟踪")]),i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新申请",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderData.schedules,(function(t,a){return"0"===t.state||"1"===t.state?i("div",{key:a,staticClass:"logInfo"},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("0"===t.state?"已创建":"已提交"))]),i("p",[e._v(e._s(t.time))])]):e._e()})),0)]),i("el-step",{attrs:{title:"审核",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderData.schedules,(function(t,a){return"2"===t.state||"3"===t.state?i("div",{key:a},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(t.adminName+"已通过"))]),i("p",[e._v("备注："+e._s(t.remarks))]),i("p",[e._v(e._s(t.time))])]):e._e()})),e._l(e.orderData.schedules,(function(t,a){return"4"===t.state?i("div",{key:a},[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(t.adminName+"审核不通过"))]),i("p",[e._v("理由："+e._s(t.details))]),i("p",[e._v("备注："+e._s(t.remarks))]),i("p",[e._v(e._s(t.time))])]):e._e()}))],2)]),i("el-step",{attrs:{title:"审核通过/驳回",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},["3"===e.orderData.state?i("div",[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("审核通过"))])]):e._e(),"4"===e.orderData.state?i("div",[i("p",{staticStyle:{"margin-right":"20px"}},[e._v(e._s("审核驳回"))])]):e._e()])])],1)],1)},h=[],g={name:"NewsMgmt",props:{},data:function(){return{loading:!1,orderData:[],active:"",state:""}},components:{},watch:{},created:function(){},computed:{getOrderLogState:function(e){switch(this.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"审核通过";default:return""}}},methods:{operate:function(e){this[e]()},getList:function(e){var t=this,i={id:e};l["a"].get(d["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,i).then((function(e){t.orderData=e.data})).catch((function(){})).finally((function(){}))}}},b=g,v=(i("2992"),i("2877")),y=Object(v["a"])(b,f,h,!1,null,null,null),_=y.exports,I={name:"apply-info",data:function(){return{orderData:{},iconShop:u.a,defaultImg:p.a,dialogVisiable:!1,showPassOrder:!1,loading:!1,remarks:"",auditState:"1",row:{},curSelectCloseReason:"申报的商品与实际需要采购的商品不符",reasonList:[{label:"申报的商品与实际需要采购的商品不符",value:"申报的商品与实际需要采购的商品不符"},{label:"送达仓库地址填写错误",value:"送达仓库地址填写错误"},{label:"申报的商品供应方已停售或缺货",value:"申报的商品供应方已停售或缺货"},{label:"申报的商品数量有误",value:"申报的商品数量有误"},{label:"已与部分商品供应商终止合作",value:"已与部分商品供应商终止合作"},{label:"其他原因",value:"其他原因"}]}},props:{itemId:{type:String,default:""},isPend:{type:Boolean,default:!1}},watch:{itemId:function(e){this.getOrderInfo()}},components:{BizGrid:s["a"],ApplyFollow:_},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getUser"])),Object(n["c"])("Authority",["currentAuth"])),{},{hasAuthExamine:function(){return this.currentAuth.includes("admin:purchaseApplication.examine")},getOrderState:function(){switch(this.orderData.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"已驳回";default:return""}}}),methods:{goSupplier:function(){},showToast:function(e){this.$createToast({time:1e3,txt:e,type:"warn"}).show()},toPass:function(e,t){this.remarks="",this.row=e,this.showPassOrder=!0},onOrderSchedules:function(e){var t=this;this.dialogVisiable=!0,this.$nextTick((function(){t.$refs.invoice.getList(e)}))},getOrderInfo:function(){var e=this,t={id:this.itemId};l["a"].get(d["g"].invoicing.purchaseApplyMgmt.purchaseApplyNew,t).then((function(t){e.orderData=t.data})).catch((function(){})).finally((function(){}))},statusChange:function(e,t){var i=this;this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.loading=!0;var a={shopId:window.top.SHOP_ID||"",id:e.id,actionType:t,details:"2"===t?i.curSelectCloseReason:"",remarks:i.remarks};l["a"].post("/admin/invoicing/purchase/shopPurchaseApplyState.jhtml",a).then((function(e){i.$message.success("操作成功！"),i.loading=!1,i.showPassOrder=!1,i.$emit("operationSuccess")})).catch((function(e){i.loading=!1,e.errorMessage&&i.$message.warning(e.errorMessage)})).finally((function(){}))}))}},created:function(){}},w=I,x=(i("7339"),Object(v["a"])(w,a,r,!1,null,null,null));t["a"]=x.exports},ae8d:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-product-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),i("el-form",{attrs:{inline:!0,disabled:!e.isEdit,"inline-message":!0}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addProduct}},[e._v("新增")]),i("el-form-item",{staticClass:"subTotal",attrs:{label:"合计:",prop:"subTotal"}},[e._v(e._s(e.subTotal))])],1),i("biz-list",{key:Math.random(),ref:"table",attrs:{tableData:e.tableData,loading:e.loading}},[i("el-table-column",{attrs:{prop:"sn",label:"编号"}}),i("el-table-column",{attrs:{prop:"fullName",label:"商品名称"}}),i("el-table-column",{attrs:{prop:"barCode",label:"条码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.product&&t.row.product.barCode?t.row.product.barCode:""))]}}])}),i("el-table-column",{attrs:{prop:"price",label:"价格(元)"}}),i("el-table-column",{attrs:{prop:"quantity",label:"数量","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input-number",{attrs:{size:"mini",min:1},on:{change:function(i){return e.quantityChange(t.row.quantity)}},model:{value:t.row.quantity,callback:function(i){e.$set(t.row,"quantity",i)},expression:"scope.row.quantity"}})],1)])}}])}),i("el-table-column",{attrs:{prop:"subTotal",label:"小计(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[e._v(e._s(t.row.quantity?(Number(t.row.quantity)*Number(t.row.price)).toFixed(2):""))])])}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作",type:"index"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e.isEdit?i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteHandeler(t)}}},[e._v("删除")])],1):e._e()])}}])})],1),i("biz-pagination",{attrs:{pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),i("el-dialog",{attrs:{visible:e.dialogTableVisible,center:"",width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(e._s(e.title))])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.formData.sn))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("配送方式："+e._s(e.formData.shippingMethodName))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.formData.consignee))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.formData.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:12}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("地址："+e._s(e.formData.areaName?e.formData.areaName+e.formData.address:e.formData.address))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("买家留言："+e._s(e.formData.memo))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"})])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",width:"50",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(t.row.name))]}}],null,!0)}),i("el-table-column",{attrs:{property:"address",label:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(e._s(-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:""))]}}],null,!0)}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v("￥"+e._s(t.row.price))]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.subTotal))]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("运费：￥"+e._s(e.formData.freight))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("优惠金额：￥"+e._s(e.formData.couponDiscount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("调整金额：￥"+e._s(e.formData.offsetAmount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单金额：￥"+e._s(e.formData.originalAmount))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("仓库签字：")])])],1)],1)])],1),i("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"选择商品",visibility:e.showDialog,tableData:e.giftList,pagination:e.dialogPagination,filters:e.dialogFilters,selectionKeys:e.selectedGiftIds},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.dialogFilterDataChange,selectionChange:e.selectionChange}},[i("el-table-column",{attrs:{property:"fullName",label:"商品名称",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-two-column"},[i("img",{attrs:{src:t.row.image||e.DefaultImg,onerror:e.errorImg}}),i("div",{staticClass:"biz-two-row"},[i("div",{staticStyle:{"margin-left":"10px","font-size":"14px"}},[e._v(e._s(t.row.name))]),i("div",{staticStyle:{"margin-left":"10px"}},[e._v("编号："+e._s(t.row.sn))]),i("div",{staticStyle:{"margin-left":"10px"}},[e._v("规格："+e._s(t.row.fullName&&-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:""))])])])])}}])}),i("el-table-column",{attrs:{property:"barCode",label:"条码"}}),i("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),i("el-table-column",{attrs:{property:"brandName",label:"品牌"}}),i("el-table-column",{attrs:{property:"price",label:"价格"}}),i("el-table-column",{attrs:{label:"剩余库存/库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.availableStock)+"/"+e._s(t.row.stock))])]}}])})],1)],1)},r=[],o=(i("99af"),i("4de4"),i("4160"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("25f0"),i("159b"),i("5530")),s=i("7558"),n=i("5c40"),l=i("8330"),d=i("f36f"),c=i("e42c"),p=i("2086"),m=i("225d"),u=i("2f62"),f=i("c596"),h=i("1ab1"),g=i("af3f"),b=i("f3ac"),v=i.n(b),y={name:"NewsMgmt",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},errorImg:'this.src="/resources/admin/images/default/product-default.png"',DefaultImg:v.a,selectedGiftList:[],selectedGiftIds:[],showDialog:!1,dialogFilters:[{type:"input",placeholder:"请输入编号/商品名/条码",name:"searchbar",value:""}],giftList:[],loading:!1,open:!1,subTotal:"",height:"585",subTotalAll:"",tableData:[],restaurants:[],selections:[],orderItems:[],selectionList:[],dialogTableVisible:!1,gridData:[],formData:{},shippingData:{},title:"",form:{products:""},operations:[{label:"保存",name:"save",type:"primary"},{label:"打印",name:"certificate",type:"primary"}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:s["a"],BizPagination:n["a"],BizGrid:d["a"],BizSaveButton:l["a"],vueEasyPrint:m["a"],BizDialogSelector:g["a"]},watch:{itemId:function(e){this.tableData=[],this.subTotal="",this.itemId&&this.getList()}},mounted:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},methods:Object(o["a"])(Object(o["a"])({},Object(u["c"])(["getUser"])),{},{addProduct:function(){this.dialogFilters[0].value="",this.getGiftList(),this.selectedGiftIds.splice(0,this.selectedGiftIds.length),this.selectedGiftList.splice(0,this.selectedGiftList.length),this.showDialog=!0},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.getGiftList()},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.getGiftList()},dialogFilterDataChange:function(e){this.dialogFilters=e,this.dialogPagination.currentPage=1,this.getGiftList()},getGiftList:function(){var e=this,t={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||"",isOutOfStock:"0",type:"couponOrder"===this.$route.params.orderType?"7":""};h["a"].get("purchaseOrder"===window.top.dType?"/admin/purchaseOrderManage/product/list.jhtml":f["g"].memberCardMgmt.memberCard.listProduct,t).then((function(t){e.giftList=t.content,e.dialogPagination.total=Number(t.total)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},selectionChange:function(e){var t=this;e.forEach((function(e){-1===t.selectionList.indexOf(e)&&t.selectionList.push(e)}))},confirmedProduct:function(e){var t=this;this.selectedGiftIds=e.concat(),this.selectedGiftList=[],this.selectionList.map((function(e){-1!==t.selectedGiftIds.indexOf(e.id)&&(e.quantity="1",t.selectedGiftList.push(e))}));this.selectedGiftList.map((function(e){Number(e.quantity)*Number(e.price)})),this.selectedGiftList.forEach((function(e){t.handleSelect(e),t.listProduct(e)}))},print:function(){this.$refs.easyPrint.print()},certificate:function(){var e=this;if(!this.itemId)return this.$message.warning("请先生成一个订单"),!1;var t={orderId:this.itemId,shopId:window.top.SHOP_ID||""};h["a"].get(f["l"].delivery.queryShippingVoucherPurchase,t).then((function(t){e.dialogTableVisible=!0,e.title=e.getUser().shop?e.getUser().shop.name+"发货单":"发货单",e.formData=t.order,e.shippingData=t.shipping,e.userCard=t.userCard,e.gridData=t.order.orderItems})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),e.$message.warning(t.errorMessage)}))},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=i+"-"+(a<10?"0"+a:a)+"-"+(r<10?"0"+r:r);return o},resize:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.getList()},operationSuccess:function(){this.getList()},getList:function(){var e=this;this.loading=!0;var t={orderId:this.itemId,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};h["a"].get("admin/purchaseOrderManage/products.jhtml",t).then((function(t){e.loading=!1,e.tableData=t.orderItems,e.subTotal=t.order.price,e.pagination.total=Number(t.total)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},handleSelect:function(e){var t=!1;if(e.productId=e.id,e.id="",this.subTotal=(Number(this.subTotal)+Number(e.quantity)*Number(e.price)).toFixed(2),0!==this.tableData.length){for(var i=0;i<this.tableData.length;i++)if(this.tableData[i].productId===e.productId){this.tableData[i].quantity=(Number(this.tableData[i].quantity)+1).toString(),t=!0;break}t||this.tableData.push(e)}else this.tableData.push(e)},deleteHandeler:function(e){this.tableData.splice(e.$index,1),this.subTotal=(Number(this.subTotal)-Number(e.row.price)*Number(e.row.quantity)).toFixed(2)},quantityChange:function(e){var t=0;this.tableData.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.subTotal=t?t.toFixed(2):""},save:function(){var e=this;this.orderItems=this.tableData.map((function(e){return{id:e.id||"",productId:e.productId?e.productId:e.id,quantity:e.quantity||"",price:e.price||""}}));var t=!1;if(this.tableData.forEach((function(e){console.log(e.quantity),-1!==String(e.quantity).indexOf(".")&&(t=!0)})),t)return this.$message.warning("数量不能为小数"),!1;!this.itemId&&this.$emit("setOrderItems",this.orderItems),this.itemId&&c["a"].addOrderItems({orderId:this.itemId,orderData:{orderItems:this.orderItems},shopId:window.top.SHOP_ID},(function(t){e.$emit("setOrderItems",e.orderItems),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.getList(),e.$message.warning(t.errorMessage)}))},listProduct:function(e){var t=this;p["a"].listProduct({searchValue:e.name},(function(e){t.restaurants=e.content.map((function(e){return{fullName:e.fullName,sn:e.sn,price:e.price,quantity:"1",subTotal:e.price,productId:e.id,value:e.fullName}})),t.loading=!1}),(function(e){console.log(e),console.log("code错误")}))},querySearchAsync:function(e,t){var i=this.restaurants,a=e?i.filter(this.createStateFilter(e)):i;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t(a)}),300*Math.random())},createStateFilter:function(e){return function(e){return!0}},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()}})},_=y,I=(i("e90e"),i("2877")),w=Object(I["a"])(_,a,r,!1,null,null,null);t["a"]=w.exports},aedc:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"communi-mgmt-communi-card-base-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"125px",size:"small"}},[i("el-form-item",{attrs:{label:"SIM",prop:"number"}},[i("el-input",{attrs:{placeholder:"请输入SIM卡号"},model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})],1),i("el-form-item",{attrs:{label:"ICCID",prop:"iccid"}},[i("el-input",{attrs:{placeholder:"请输入ICCID号"},model:{value:e.form.iccid,callback:function(t){e.$set(e.form,"iccid",t)},expression:"form.iccid"}})],1),i("el-form-item",{attrs:{label:"卡类型",prop:"type"}},[i("el-select",{attrs:{placeholder:"请选择卡类别"},on:{change:e.typeChange},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[i("el-option",{attrs:{label:"无",value:""}}),i("el-option",{attrs:{label:"移动",value:"移动"}}),i("el-option",{attrs:{label:"联通",value:"联通"}}),i("el-option",{attrs:{label:"电信",value:"电信"}})],1)],1),i("el-form-item",{attrs:{label:"运营商",prop:"company"}},[i("biz-company-selector",{attrs:{queryParent:e.queryParent},model:{value:e.companyInfo,callback:function(t){e.companyInfo=t},expression:"companyInfo"}})],1),i("el-form-item",{attrs:{label:"所有者",prop:"ownerName"}},[i("el-input",{attrs:{placeholder:"请选择所有者"},model:{value:e.form.ownerName,callback:function(t){e.$set(e.form,"ownerName",t)},expression:"form.ownerName"}},[i("el-button",{attrs:{slot:"append"},on:{click:e.selectOwner},slot:"append"},[e._v("选择")])],1)],1),i("el-form-item",{attrs:{label:"电信运营商",prop:"telecomOperatorId"}},[i("el-select",{attrs:{placeholder:"请选择电信运营商"},on:{change:e.telecomOperatorIdChange},model:{value:e.form.telecomOperatorId,callback:function(t){e.$set(e.form,"telecomOperatorId",t)},expression:"form.telecomOperatorId"}},e._l(e.telecomOperatorList,(function(e){return i("el-option",{key:e.index,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"状态",prop:"status"}},[i("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[i("el-option",{attrs:{label:"停用",value:"0"}}),i("el-option",{attrs:{label:"启用",value:"1"}}),i("el-option",{attrs:{label:"未审核",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"终端分类",prop:"terminalTypeName"}},[i("el-input",{attrs:{placeholder:"请输入终端设备",disabled:""},model:{value:e.form.terminalTypeName,callback:function(t){e.$set(e.form,"terminalTypeName",t)},expression:"form.terminalTypeName"}})],1),i("el-form-item",{attrs:{label:"套餐",prop:"rechargePackageName"}},[i("el-input",{attrs:{placeholder:"请输入套餐名称",disabled:""},model:{value:e.form.rechargePackageName,callback:function(t){e.$set(e.form,"rechargePackageName",t)},expression:"form.rechargePackageName"}})],1),i("el-form-item",{attrs:{label:"余额(元)",prop:"balance"}},[i("el-input",{attrs:{placeholder:"请输入余额",disabled:""},model:{value:e.form.balance,callback:function(t){e.$set(e.form,"balance",t)},expression:"form.balance"}})],1),i("el-form-item",{attrs:{label:"流量总量(MB)",prop:"totalData"}},[i("el-input",{attrs:{placeholder:"请输入流量总量",disabled:""},model:{value:e.form.totalData,callback:function(t){e.$set(e.form,"totalData",t)},expression:"form.totalData"}})],1),i("el-form-item",{attrs:{label:"剩余流量(MB)",prop:"remainingData"}},[i("el-input",{attrs:{placeholder:"请输入剩余流量",disabled:""},model:{value:e.form.remainingData,callback:function(t){e.$set(e.form,"remainingData",t)},expression:"form.remainingData"}})],1),i("el-form-item",{attrs:{label:"创建日期",prop:"createdTime"}},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss",disabled:""},model:{value:e.form.createdTime,callback:function(t){e.$set(e.form,"createdTime",t)},expression:"form.createdTime"}})],1),i("el-form-item",{attrs:{label:"激活日期",prop:"createdTime"}},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss",disabled:""},model:{value:e.form.activatedTime,callback:function(t){e.$set(e.form,"activatedTime",t)},expression:"form.activatedTime"}})],1),i("el-form-item",{attrs:{label:"到期日期",prop:"createdTime"}},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss",disabled:""},model:{value:e.form.expiredTime,callback:function(t){e.$set(e.form,"expiredTime",t)},expression:"form.expiredTime"}})],1),i("el-form-item",{attrs:{label:"短信可用量(平台>>卡)",prop:"smsDown","label-width":"160px"}},[i("el-input",{attrs:{placeholder:"请输入短信可用量",disabled:""},model:{value:e.form.smsDown,callback:function(t){e.$set(e.form,"smsDown",t)},expression:"form.smsDown"}})],1),i("el-form-item",{attrs:{label:"短信已用量(平台>>卡)",prop:"smsDownUsed","label-width":"160px"}},[i("el-input",{attrs:{placeholder:"请输入短信已用量",disabled:""},model:{value:e.form.smsDownUsed,callback:function(t){e.$set(e.form,"smsDownUsed",t)},expression:"form.smsDownUsed"}})],1),i("el-form-item",{attrs:{label:"短信可用量(卡>>平台)",prop:"smsUp","label-width":"160px"}},[i("el-input",{attrs:{placeholder:"请输入短信可用量",disabled:""},model:{value:e.form.smsUp,callback:function(t){e.$set(e.form,"smsUp",t)},expression:"form.smsUp"}})],1),i("el-form-item",{attrs:{label:"短信已用量(卡>>平台)",prop:"smsUpUsed","label-width":"160px"}},[i("el-input",{attrs:{placeholder:"请输入短信已用量",disabled:""},model:{value:e.form.smsUpUsed,callback:function(t){e.$set(e.form,"smsUpUsed",t)},expression:"form.smsUpUsed"}})],1)],1),i("biz-dialog-selector",{attrs:{title:"选择所有者",visibility:e.showDialog,isClear:!1,appendToBody:!0,keyField:"id",selectionKeys:Array(e.form.ownerId),loading:e.dialogLoading,tableData:e.dialogTableData,selectionMode:"single",pagination:e.dialogPagination,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,confirmed:e.handleConfirmed}},[i("el-table-column",{attrs:{label:"用户名",prop:"userName"}}),i("el-table-column",{attrs:{label:"昵称",prop:"nickname"}}),i("el-table-column",{attrs:{label:"手机号",prop:"mobile"}})],1)],1)},r=[],o=(i("d81d"),i("b0c0"),i("a9e3"),i("f36f")),s=i("8330"),n=i("d335"),l=i("af3f"),d=i("ec50"),c={name:"CardMgmtBaseInfo",props:{itemId:{type:Object,default:function(){return{id:""}}}},data:function(){return{showDialog:!1,dialogLoading:!1,dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",value:"",placeholder:"请输入用户名、昵称、手机号"}],queryParent:!1,loading:!1,rules:{number:[{required:!0,message:"请输入SIM卡号",trigger:"blur"},{pattern:/^[0-9]*$/,message:"请输入数字",trigger:"blur"}],iccid:[{required:!0,message:"请输入ICCID",trigger:"blur"},{pattern:/^[0-9a-zA-Z]*$/g,message:"请输入字母或数字",trigger:"blur"}],telecomOperatorId:[{required:!0,message:"请选择电信运营商",trigger:"blur"}],type:[{required:!0,message:"请选择卡类别",trigger:"blur"}],balance:[{pattern:/^[0-9]+\.?[0-9]*$/,message:"请输入数字",trigger:"blur"}],totalData:[{pattern:/^[0-9]+\.?[0-9]*$/,message:"请输入数字",trigger:"blur"}],remainingData:[{pattern:/^[0-9]+\.?[0-9]*$/,message:"请输入数字",trigger:"blur"}],smsDown:[{pattern:/^[0-9]*$/,message:"请输入数字",trigger:"blur"}],smsDownUsed:[{pattern:/^[0-9]*$/,message:"请输入数字",trigger:"blur"}],smsUp:[{pattern:/^[0-9]*$/,message:"请输入数字",trigger:"blur"}],smsUpUsed:[{pattern:/^[0-9]*$/,message:"请输入数字",trigger:"blur"}]},operations:[{label:"保存",name:"save",type:"primary"}],companyInfo:{id:"",name:""},telecomOperatorList:[],form:this.resetForm()}},components:{BizGrid:o["a"],BizSaveButton:s["a"],BizCompanySelector:n["a"],BizDialogSelector:l["a"]},methods:{operate:function(e){this[e]()},resetForm:function(){return{number:"",iccid:"",type:"",ownerId:"",ownerName:"",telecomOperatorId:"",telecomOperatorName:"",companyId:"",companyName:"",status:"",terminalTypeName:"",rechargePackageName:"",balance:"0.00",totalData:"0",remainingData:"0",createdTime:new Date,activatedTime:"",expiredTime:"",smsDown:"0",smsDownUsed:"0",smsUp:"0",smsUpUsed:"0"}},clear:function(){this.companyInfo={id:"",name:""},this.form=this.resetForm(),this.$refs.form.resetFields()},telecomOperatorIdChange:function(){this.$refs.form.clearValidate("telecomOperatorId")},typeChange:function(){this.$refs.form.clearValidate("type")},refresh:function(){var e=this,t={id:this.itemId.id};d["a"].queryBaseInfo(t,(function(t){e.queryParent=!0,e.form=Object.assign(e.resetForm(),t.content),e.companyInfo=e.formatBaseInfo(t.content),e.$nextTick((function(){e.queryParent=!1}))}),(function(t){e.$message.warning(t.errorMessage)}))},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.submit()}))},submit:function(){this.itemId.id?this.update():this.create()},create:function(){var e=this;this.loading=!0;var t=Object.assign({},this.form,this.telecomOperator,{companyId:this.companyInfo.id,companyName:this.companyInfo.name});d["a"].createBaseInfo(t,(function(t){e.loading=!1,e.$message.success("操作成功")}),(function(t){e.loading=!1,console.log("ERR_CREATE: ",t.errorMessage),e.$message.warning(t.errorMessage)}))},update:function(){var e=this;this.loading=!0;var t=Object.assign({},this.form,this.telecomOperator,{companyId:this.companyInfo.id,companyName:this.companyInfo.name},this.itemId);d["a"].updateBaseInfo(t,(function(t){e.loading=!1,e.$message.success("操作成功")}),(function(t){e.loading=!1,console.log("ERR_CREATE: ",t.errorMessage),e.$message.warning(t.errorMessage)}))},selectOwner:function(){this.dialogFilters[0].value="",this.showDialog=!0},queryOwnerList:function(e){var t=this;this.dialogLoading=!0;var i={companyId:e,pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value};d["a"].queryOwnerList(i,(function(e){t.dialogLoading=!1,t.dialogTableData=e.content,t.dialogPagination.total=Number(e.total)}),(function(e){t.dialogLoading=!1}))},handleConfirmed:function(e,t){this.form.ownerId=t[0].id,this.form.ownerName=t[0].nickname},dialogFilterDataChange:function(e){this.dialogPagination.currentPage=1,this.queryOwnerList(this.companyInfo.id)},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.queryOwnerList(this.companyInfo.id)},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.queryOwnerList(this.companyInfo.id)},queryTeleOperator:function(){var e=this,t={pageSize:1e3,pageNumber:1};d["a"].queryTeleOperator(t,(function(t){e.telecomOperatorList=t.content}),(function(e){}))},formatBaseInfo:function(e){return{id:e.companyId||"",name:e.companyName||""}},showMessage:function(e,t){this.$notify({message:e,type:t,showClose:!0})}},mounted:function(){this.queryTeleOperator()},watch:{itemId:function(e,t){this.clear(),this.itemId.id&&this.refresh()},companyInfo:function(e,t){this.queryOwnerList(e.id)}},computed:{telecomOperator:function(){var e=this,t={};return this.telecomOperatorList.map((function(i){i.id===e.form.telecomOperatorId&&(t={telecomOperatorName:i.name})})),t},stateValue:function(){switch(this.form.state){case"1":return"已使用";default:return"未使用"}}}},p=c,m=(i("e7ca"),i("2877")),u=Object(m["a"])(p,a,r,!1,null,null,null);t["a"]=u.exports},af3f:function(e,t,i){"use strict";var a=i("697f");t["a"]=a["a"]},b06a:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"order-base-info"},[e.isEdit?a("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"label-width":"120px",size:"small",disabled:!e.isEdit,"inline-message":!0}},[e.itemId?a("el-form-item",{attrs:{label:"订单编号",prop:"sn"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.sn,callback:function(t){e.$set(e.form,"sn",t)},expression:"form.sn"}})],1):e._e(),a("el-form-item",{attrs:{label:"订单状态"}},[e.itemId?a("el-input",{attrs:{disabled:!0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}}):a("el-select",{attrs:{disabled:"couponOrder"===this.$route.params.orderType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.orderStateTypeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.showInfo?a("el-form-item",{attrs:{label:"订单原价",prop:"originalAmount"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.originalAmount,callback:function(t){e.$set(e.form,"originalAmount",t)},expression:"form.originalAmount"}})],1):e._e(),e.form.amountPrepay?a("el-form-item",{attrs:{label:"订金",prop:"amountPrepay"}},[a("el-input",{attrs:{disabled:""!==e.itemId&&("交易完成"===e.form.type||"订单关闭"===e.form.type||"已评价"===e.form.type)},model:{value:e.form.amountPrepay,callback:function(t){e.$set(e.form,"amountPrepay",t)},expression:"form.amountPrepay"}})],1):e._e(),e.form.amountFinalpay?a("el-form-item",{attrs:{label:"尾款",prop:"amountFinalpay"}},[a("el-input",{attrs:{disabled:""!==e.itemId&&("交易完成"===e.form.type||"订单关闭"===e.form.type||"已评价"===e.form.type)},model:{value:e.form.amountFinalpay,callback:function(t){e.$set(e.form,"amountFinalpay",t)},expression:"form.amountFinalpay"}})],1):e._e(),e.showInfo?a("el-form-item",{attrs:{label:"调整金额",prop:"offsetAmount"}},[a("el-input-number",{attrs:{"controls-position":"right",disabled:""!==e.itemId&&"2"===e.form.paymentStatus||"订单关闭"===e.form.type},on:{change:e.offsetAmountChange},model:{value:e.form.offsetAmount,callback:function(t){e.$set(e.form,"offsetAmount",t)},expression:"form.offsetAmount"}})],1):e._e(),e.showInfo?a("el-form-item",{attrs:{label:"订单现价",prop:"amount"}},[a("el-input",{attrs:{disabled:""!==e.itemId&&"2"===e.form.paymentStatus||"订单关闭"===e.form.type},on:{change:e.curAmountChange},model:{value:e.form.curAmount,callback:function(t){e.$set(e.form,"curAmount",t)},expression:"form.curAmount"}})],1):e._e(),a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{name:"1"}},[-1!==e.activeNames.indexOf("1")&&e.handler?a("template",{slot:"title"},[a("div",{staticClass:"title-class"},[a("div",{staticClass:"title-class-one"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("客户信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("1")&&e.handler?e._e():a("template",{slot:"title"},[e._v("客户信息")]),a("el-form-item",{staticClass:"isRequired",attrs:{label:"会员昵称",prop:"member.nickname"}},[a("el-input",{attrs:{disabled:!!e.itemId,placeholder:"请选择或添加会员"},on:{focus:e.showDialogFc},model:{value:e.form.member.nickname,callback:function(t){e.$set(e.form.member,"nickname",t)},expression:"form.member.nickname"}},[e.itemId?e._e():a("el-button",{attrs:{slot:"append",icon:"el-icon-plus"},on:{click:e.addMember},slot:"append"})],1)],1),a("el-form-item",{attrs:{label:"性别",prop:"member.gender"}},[a("el-select",{attrs:{disabled:!1===!e.itemId},model:{value:e.form.member.gender,callback:function(t){e.$set(e.form.member,"gender",t)},expression:"form.member.gender"}},[a("el-option",{attrs:{label:"男",value:"0"}}),a("el-option",{attrs:{label:"女",value:"1"}}),a("el-option",{attrs:{label:"保密",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"电话",prop:"member.mobile"}},[a("el-input",{attrs:{disabled:!1===!e.itemId,placeholder:"请输入电话"},model:{value:e.form.member.mobile,callback:function(t){e.$set(e.form.member,"mobile",t)},expression:"form.member.mobile"}})],1),a("el-form-item",{attrs:{label:"车辆",prop:"car.id"}},[a("el-select",{attrs:{placeholder:"请选择车辆",disabled:""!==e.itemId},on:{change:e.carChange},model:{value:e.form.car.id,callback:function(t){e.$set(e.form.car,"id",t)},expression:"form.car.id"}},e._l(e.cars,(function(e,t){return a("el-option",{key:t,attrs:{label:e.plateNumber,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"车型",prop:"car.type"}},[a("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.car.type,callback:function(t){e.$set(e.form.car,"type",t)},expression:"form.car.type"}})],1),e.form.plateNumber?e._e():a("el-form-item",{attrs:{label:"行驶里程",prop:"car.drivingRange"}},[a("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.car.drivingRange,callback:function(t){e.$set(e.form.car,"drivingRange",t)},expression:"form.car.drivingRange"}})],1),e.form.plateNumber?a("el-form-item",{attrs:{label:"行驶里程",prop:"drivingRange"}},[a("el-input",{attrs:{disabled:!0,placeholder:"选择车辆自动带入"},model:{value:e.form.drivingRange,callback:function(t){e.$set(e.form,"drivingRange",t)},expression:"form.drivingRange"}})],1):e._e()],2),a("el-collapse-item",{attrs:{name:"2"}},[-1!==e.activeNames.indexOf("2")&&e.handler?a("template",{slot:"title"},[a("div",{staticClass:"title-class"},[a("div",{staticClass:"title-class-one"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("服务信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("2")&&e.handler?e._e():a("template",{slot:"title"},[e._v("服务信息")]),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"呼叫方式",prop:"orderItems[0].appointment.way"}},[a("el-select",{attrs:{placeholder:"请选择呼叫方式"},model:{value:e.form.orderItems[0].appointment.way,callback:function(t){e.$set(e.form.orderItems[0].appointment,"way",t)},expression:"form.orderItems[0].appointment.way"}},[a("el-option",{attrs:{label:"电话",value:"0"}}),a("el-option",{attrs:{label:"在线",value:"1"}})],1)],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"救援机构",prop:"orderItems[0].appointment.rescueUnit"}},[a("el-select",{attrs:{placeholder:"请选择救援机构"},model:{value:e.form.orderItems[0].appointment.rescueUnit,callback:function(t){e.$set(e.form.orderItems[0].appointment,"rescueUnit",t)},expression:"form.orderItems[0].appointment.rescueUnit"}},e._l(e.rescueOrganizations,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"救援人员",prop:"orderItems[0].appointment.rescuerId"}},[a("el-select",{attrs:{placeholder:"请选择救援人员"},model:{value:e.form.orderItems[0].appointment.rescuerId,callback:function(t){e.$set(e.form.orderItems[0].appointment,"rescuerId",t)},expression:"form.orderItems[0].appointment.rescuerId"}},e._l(e.workers,(function(e,t){return a("el-option",{key:t,attrs:{label:e.nickname,value:e.id}})})),1)],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"救援地点",prop:"orderItems[0].appointment.workerLocation"}},[a("el-input",{attrs:{placeholder:"请输入救援地点"},model:{value:e.form.orderItems[0].appointment.workerLocation,callback:function(t){e.$set(e.form.orderItems[0].appointment,"workerLocation",t)},expression:"form.orderItems[0].appointment.workerLocation"}})],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"服务项目",prop:"orderItems[0].appointment.reasons"}},[a("el-checkbox-group",{model:{value:e.form.orderItems[0].appointment.reasons,callback:function(t){e.$set(e.form.orderItems[0].appointment,"reasons",t)},expression:"form.orderItems[0].appointment.reasons"}},e._l(e.reasons,(function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.id}},[e._v(e._s(t.content))])})),1)],1):e._e(),"rescue"===this.$route.params.orderType?a("el-form-item",{staticClass:"imgUpload",attrs:{label:"图片信息"}},[a("el-upload",{attrs:{action:"/admin/file/uploads.jhtml","before-upload":e.beforeAvatarUpload,"file-list":e.imageList,"list-type":"picture-card",name:"file",accept:"image/*",data:{type:"0"},"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.handleSuccess}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:e.picDialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1):e._e(),"rescue"===this.$route.params.orderType&&e.itemId?a("el-form-item",{attrs:{label:"语音信息"}},e._l(e.form.orderItems[0].appointment.voices,(function(e,t){return a("div",{key:t},[a("audio",{attrs:{src:e.path,controls:""}})])})),0):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"服务日期",prop:"orderItems[0].appointment.appontmentDate"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"请选择服务日期"},model:{value:e.form.orderItems[0].appointment.appontmentDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"appontmentDate",t)},expression:"form.orderItems[0].appointment.appontmentDate"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"开始时间",prop:"orderItems[0].appointment.driveStartDate"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.driveStartDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"driveStartDate",t)},expression:"form.orderItems[0].appointment.driveStartDate"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"结束时间",prop:"orderItems[0].appointment.driveEndDate"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.driveEndDate,callback:function(t){e.$set(e.form.orderItems[0].appointment,"driveEndDate",t)},expression:"form.orderItems[0].appointment.driveEndDate"}})],1):e._e(),"service"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"服务日期",prop:"appointmentDate"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"请选择服务日期",clearable:!1,editable:!1},model:{value:e.appointmentDate,callback:function(t){e.appointmentDate=t},expression:"appointmentDate"}})],1):e._e(),"service"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"开始时间",prop:"appointmentStartDate"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",editable:!1,clearable:!1},model:{value:e.form.appointmentDate,callback:function(t){e.$set(e.form,"appointmentDate",t)},expression:"form.appointmentDate"}})],1):e._e(),"service"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"结束时间",prop:"appointmentEndDate"}},[a("el-time-picker",{attrs:{format:"HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",editable:!1,clearable:!1},model:{value:e.form.appointmentEndDate,callback:function(t){e.$set(e.form,"appointmentEndDate",t)},expression:"form.appointmentEndDate"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"使用时间(分)",prop:"useTime"}},[a("el-input",{attrs:{value:e.dateInterval(e.form.orderItems[0].appointment.driveEndDate,e.form.orderItems[0].appointment.driveStartDate),disabled:!0}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"开始里程",prop:"orderItems[0].appointment.startMileage"}},[a("el-input-number",{attrs:{"controls-position":"right",precision:0,min:0,disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.startMileage,callback:function(t){e.$set(e.form.orderItems[0].appointment,"startMileage",t)},expression:"form.orderItems[0].appointment.startMileage"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"结束里程",prop:"orderItems[0].appointment.endMileage"}},[a("el-input-number",{attrs:{"controls-position":"right",precision:0,min:0,disabled:!!e.itemId&&"service"!==e.handler},model:{value:e.form.orderItems[0].appointment.endMileage,callback:function(t){e.$set(e.form.orderItems[0].appointment,"endMileage",t)},expression:"form.orderItems[0].appointment.endMileage"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"使用里程(公里)"}},[a("el-input",{attrs:{value:e.form.orderItems[0].appointment.endMileage-e.form.orderItems[0].appointment.startMileage,disabled:!0}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"试驾车号",prop:"orderItems[0].appointment.plateNumber"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入试驾车号"},on:{select:e.handleSelect},model:{value:e.form.orderItems[0].appointment.plateNumber,callback:function(t){e.$set(e.form.orderItems[0].appointment,"plateNumber",t)},expression:"form.orderItems[0].appointment.plateNumber"}})],1):e._e(),"ride"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"试驾车型",prop:"orderItems[0].appointment.product.fullName"}},[a("el-input",{attrs:{placeholder:"请选择试驾车型"},on:{focus:e.queryProduct},model:{value:e.form.orderItems[0].appointment.product.fullName,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"fullName",t)},expression:"form.orderItems[0].appointment.product.fullName"}})],1):e._e(),"replace"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"已有车型",prop:"orderItems[0].appointment.car.type"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.orderItems[0].appointment.car.type,callback:function(t){e.$set(e.form.orderItems[0].appointment.car,"type",t)},expression:"form.orderItems[0].appointment.car.type"}})],1):e._e(),"replace"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"行驶里程",prop:"orderItems[0].appointment.drivingRange"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.form.orderItems[0].appointment.drivingRange,callback:function(t){e.$set(e.form.orderItems[0].appointment,"drivingRange",t)},expression:"form.orderItems[0].appointment.drivingRange"}})],1):e._e(),"replace"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"上牌时间",prop:"orderItems[0].appointment.onTime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.orderItems[0].appointment.onTime,callback:function(t){e.$set(e.form.orderItems[0].appointment,"onTime",t)},expression:"form.orderItems[0].appointment.onTime"}})],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"心仪车型",prop:"orderItems[0].appointment.product.brandId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择品牌",filterable:""},on:{change:e.handleBrandChange},model:{value:e.form.orderItems[0].appointment.product.brandId,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"brandId",t)},expression:"form.orderItems[0].appointment.product.brandId"}},e._l(e.brandList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"",prop:"orderItems[0].appointment.product.seriesId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系列",filterable:""},on:{change:e.handleSeriesChange},model:{value:e.form.orderItems[0].appointment.product.seriesId,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"seriesId",t)},expression:"form.orderItems[0].appointment.product.seriesId"}},e._l(e.seriesList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"replace"===this.$route.params.orderType||"loan"===this.$route.params.orderType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"",prop:"orderItems[0].appointment.product.id"}},[a("el-select",{staticClass:"isRequired",staticStyle:{width:"100%"},attrs:{placeholder:"请选择车型"},on:{change:e.productChange},model:{value:e.form.orderItems[0].appointment.product.id,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"id",t)},expression:"form.orderItems[0].appointment.product.id"}},e._l(e.modeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"裸车总价",prop:"orderItems[0].appointment.product.price"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.orderItems[0].appointment.product.price,callback:function(t){e.$set(e.form.orderItems[0].appointment.product,"price",t)},expression:"form.orderItems[0].appointment.product.price"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"金融方案",prop:"orderItems[0].appointment.financialPlan.id"}},[a("el-select",{attrs:{placeholder:"请选择金融方案"},on:{change:function(t){return e.loanTerm(e.form.orderItems[0].appointment.financialPlan.id)}},model:{value:e.form.orderItems[0].appointment.financialPlan.id,callback:function(t){e.$set(e.form.orderItems[0].appointment.financialPlan,"id",t)},expression:"form.orderItems[0].appointment.financialPlan.id"}},e._l(e.financialPlans,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"首付比例",prop:"orderItems[0].appointment.downPayment"}},[a("el-select",{attrs:{placeholder:"请选择首付比例"},on:{change:e.monthPay},model:{value:e.form.orderItems[0].appointment.downPayment,callback:function(t){e.$set(e.form.orderItems[0].appointment,"downPayment",t)},expression:"form.orderItems[0].appointment.downPayment"}},e._l(e.form.orderItems[0].appointment.financialPlan.downPayments,(function(e,t){return a("el-option",{key:t,attrs:{label:Math.round(e)+"%",value:e}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"还款期限",prop:"orderItems[0].appointment.year"}},[a("el-select",{attrs:{placeholder:"请选择还款年限"},on:{change:e.monthPay},model:{value:e.form.orderItems[0].appointment.year,callback:function(t){e.$set(e.form.orderItems[0].appointment,"year",t)},expression:"form.orderItems[0].appointment.year"}},e._l(e.form.orderItems[0].appointment.financialPlan.loanTerms,(function(e,t){return a("el-option",{key:t,attrs:{label:e.year+"年",value:e.year}})})),1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"首付金额"}},[a("el-input",{attrs:{value:e.form.orderItems[0].appointment.product.price?e.form.orderItems[0].appointment.product.price*e.form.orderItems[0].appointment.downPayment/100:e.form.orderItems[0].appointment.product.price,disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"贷款额度"}},[a("el-input",{attrs:{value:e.form.orderItems[0].appointment.product.price?e.form.orderItems[0].appointment.product.price-e.form.orderItems[0].appointment.product.price*e.form.orderItems[0].appointment.downPayment/100:e.form.orderItems[0].appointment.product.price,disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"月供"}},[a("el-input",{attrs:{value:e.monthPay(),disabled:!0}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"手续费",prop:"orderItems[0].appointment.fee"}},[a("el-input",{attrs:{placeholder:"请输入手续费"},model:{value:e.form.orderItems[0].appointment.fee,callback:function(t){e.$set(e.form.orderItems[0].appointment,"fee",t)},expression:"form.orderItems[0].appointment.fee"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"身份证",prop:"orderItems[0].appointment.personId"}},[a("el-input",{attrs:{placeholder:"请输入身份证"},model:{value:e.form.orderItems[0].appointment.personId,callback:function(t){e.$set(e.form.orderItems[0].appointment,"personId",t)},expression:"form.orderItems[0].appointment.personId"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"工作单位",prop:"orderItems[0].appointment.workUnit"}},[a("el-input",{attrs:{placeholder:"请输入工作单位"},model:{value:e.form.orderItems[0].appointment.workUnit,callback:function(t){e.$set(e.form.orderItems[0].appointment,"workUnit",t)},expression:"form.orderItems[0].appointment.workUnit"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"房屋情况",prop:"orderItems[0].appointment.houseState"}},[a("el-select",{model:{value:e.form.orderItems[0].appointment.houseState,callback:function(t){e.$set(e.form.orderItems[0].appointment,"houseState",t)},expression:"form.orderItems[0].appointment.houseState"}},[a("el-option",{attrs:{label:"有",value:"1"}}),a("el-option",{attrs:{label:"无",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"上牌城市",prop:"orderItems[0].appointment.onCity"}},[a("el-input",{attrs:{placeholder:"请输入上牌城市"},model:{value:e.form.orderItems[0].appointment.onCity,callback:function(t){e.$set(e.form.orderItems[0].appointment,"onCity",t)},expression:"form.orderItems[0].appointment.onCity"}})],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"意向购车时间",prop:"orderItems[0].appointment.intentionTime"}},[a("el-select",{attrs:{placeholder:"请选择意向购车时间"},model:{value:e.form.orderItems[0].appointment.intentionTime,callback:function(t){e.$set(e.form.orderItems[0].appointment,"intentionTime",t)},expression:"form.orderItems[0].appointment.intentionTime"}},[a("el-option",{attrs:{label:"一年",value:"4"}}),a("el-option",{attrs:{label:"半年",value:"3"}}),a("el-option",{attrs:{label:"三个月",value:"2"}}),a("el-option",{attrs:{label:"两个月",value:"1"}}),a("el-option",{attrs:{label:"一个月",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"月收入",prop:"orderItems[0].appointment.monthIncome"}},[a("el-select",{attrs:{placeholder:"请选择月收入"},model:{value:e.form.orderItems[0].appointment.monthIncome,callback:function(t){e.$set(e.form.orderItems[0].appointment,"monthIncome",t)},expression:"form.orderItems[0].appointment.monthIncome"}},[a("el-option",{attrs:{label:"20000以上",value:"4"}}),a("el-option",{attrs:{label:"15000-19999",value:"3"}}),a("el-option",{attrs:{label:"10000-14999",value:"2"}}),a("el-option",{attrs:{label:"5000-9999",value:"1"}}),a("el-option",{attrs:{label:"0-4999",value:"0"}})],1)],1):e._e(),"loan"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"有车情况",prop:"orderItems[0].appointment.carState"}},[a("el-select",{attrs:{placeholder:"请选择有车情况"},model:{value:e.form.orderItems[0].appointment.carState,callback:function(t){e.$set(e.form.orderItems[0].appointment,"carState",t)},expression:"form.orderItems[0].appointment.carState"}},[a("el-option",{attrs:{label:"有",value:"1"}}),a("el-option",{attrs:{label:"无",value:"0"}})],1)],1):e._e(),a("el-form-item",{staticClass:"isRequired",attrs:{label:"顾问",prop:"consultant.id"}},[a("el-select",{attrs:{placeholder:"请选择顾问"},model:{value:e.form.consultant.id,callback:function(t){e.$set(e.form.consultant,"id",t)},expression:"form.consultant.id"}},e._l(e.consultants,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name||"未填写",value:e.id}})})),1)],1),"service"===this.$route.params.orderType?a("el-form-item",{attrs:{label:"业务类型"}},[a("tag-select",{ref:"tagSelect",attrs:{tagList:e.tagList,bAddTag:!1,selectType:"order",selectedTags:e.selectedTags},on:{addSuccess:e.onAddSuccess}})],1):e._e(),a("el-form-item",{attrs:{label:"买家留言",prop:"memo"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],2),e.showPayment?a("el-collapse-item",{attrs:{name:"4"}},[-1!==e.activeNames.indexOf("4")&&e.handler?a("template",{slot:"title"},[a("div",{staticClass:"title-class"},[a("div",{staticClass:"title-class-one"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[e._v("付款信息")])],1)])]):e._e(),-1!==e.activeNames.indexOf("4")&&e.handler?e._e():a("template",{slot:"title"},[e._v("付款信息")]),e.itemId?a("el-form-item",{staticClass:"isRequired",attrs:{label:"支付方式",prop:"paymentMethodId"}},[a("el-select",{attrs:{disabled:"1"!==e.form.type&&"2"!==e.form.type,placeholder:"请选择支付方式"},model:{value:e.form.paymentMethodId,callback:function(t){e.$set(e.form,"paymentMethodId",t)},expression:"form.paymentMethodId"}},e._l(e.paymentMethods,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),a("el-form-item",{staticClass:"isRequired",attrs:{label:"付款方式",prop:"payments[0].paymentType"}},[a("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择付款方式"},on:{change:e.paymentTypeChange},model:{value:e.form.payments[0].paymentType,callback:function(t){e.$set(e.form.payments[0],"paymentType",t)},expression:"form.payments[0].paymentType"}},e._l(e.paymentTypes,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),"会员卡余额"===e.form.payments[0].paymentType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"会员卡",prop:"memberCardId"}},[a("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择会员卡"},on:{change:e.memberCardChange},model:{value:e.form.memberCardId,callback:function(t){e.$set(e.form,"memberCardId",t)},expression:"form.memberCardId"}},e._l(e.listExistCard,(function(e,t){return a("el-option",{key:t,attrs:{label:e.template.name,value:e.id}})})),1)],1):e._e(),"刷卡"===e.form.payments[0].paymentType||"汇款"===e.form.payments[0].paymentType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"付款银行",prop:"payments[0].payBank"}},[a("el-select",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请选择付款银行"},model:{value:e.form.payments[0].payBank,callback:function(t){e.$set(e.form.payments[0],"payBank",t)},expression:"form.payments[0].payBank"}},[a("el-option",{attrs:{label:"中国工商银行",value:"中国工商银行"}}),a("el-option",{attrs:{label:"中国农业银行",value:"中国农业银行"}}),a("el-option",{attrs:{label:"中国银行",value:"中国银行"}}),a("el-option",{attrs:{label:"中国建设银行",value:"中国建设银行"}}),a("el-option",{attrs:{label:"交通银行",value:"交通银行"}}),a("el-option",{attrs:{label:"中信银行",value:"中信银行"}}),a("el-option",{attrs:{label:"广发银行",value:"广发银行"}}),e._v("、 "),a("el-option",{attrs:{label:"深圳发展银行",value:"深圳发展银行"}}),a("el-option",{attrs:{label:"招商银行",value:"招商银行"}}),a("el-option",{attrs:{label:"中国光大银行",value:"中国光大银行"}}),a("el-option",{attrs:{label:"华夏银行",value:"华夏银行"}}),a("el-option",{attrs:{label:"中国民生银行",value:"中国民生银行"}}),a("el-option",{attrs:{label:"兴业银行",value:"兴业银行"}}),a("el-option",{attrs:{label:"上海浦东发展银行",value:"上海浦东发展银行"}}),a("el-option",{attrs:{label:"恒丰银行",value:"恒丰银行"}}),a("el-option",{attrs:{label:"浙商银行",value:"浙商银行"}}),a("el-option",{attrs:{label:"渤海银行",value:"渤海银行"}}),a("el-option",{attrs:{label:"中国邮政储蓄银行",value:"中国邮政储蓄银行"}}),a("el-option",{attrs:{label:"其他银行",value:"其他银行"}})],1)],1):e._e(),"刷卡"===e.form.payments[0].paymentType||"汇款"===e.form.payments[0].paymentType?a("el-form-item",{staticClass:"isRequired",attrs:{label:"付款帐号",prop:"payments[0].payAccount"}},[a("el-input",{attrs:{disabled:!!e.itemId&&"payment"!==e.handler,placeholder:"请输入付款帐号"},model:{value:e.form.payments[0].payAccount,callback:function(t){e.$set(e.form.payments[0],"payAccount",t)},expression:"form.payments[0].payAccount"}})],1):e._e()],2):e._e(),e.showInfo?a("el-collapse-item",{attrs:{title:"优惠信息",name:"3"}},[e.itemId?a("div",[a("el-form-item",{attrs:{label:"优惠券折扣",prop:"couponDiscount"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.couponDiscount,callback:function(t){e.$set(e.form,"couponDiscount",t)},expression:"form.couponDiscount"}})],1),a("el-form-item",{attrs:{label:"赠送积分",prop:"point"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.point,callback:function(t){e.$set(e.form,"point",t)},expression:"form.point"}})],1)],1):a("div",[a("el-form-item",{attrs:{label:"福利",prop:"couponDiscount"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.couponChange},model:{value:e.form.couponCodeId,callback:function(t){e.$set(e.form,"couponCodeId",t)},expression:"form.couponCodeId"}},e._l(e.form.couponList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.coupon.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"V豆抵扣",prop:"beanDiscount"}},[a("el-input",{attrs:{disabled:!("会员卡余额"===e.form.payments[0].paymentType&&e.form.memberCardId&&e.form.bean),min:0},on:{change:e.beanChange},model:{value:e.form.beanDiscount,callback:function(t){e.$set(e.form,"beanDiscount",t)},expression:"form.beanDiscount"}}),"会员卡余额"===e.form.payments[0].paymentType&&e.form.memberCardId?a("div",[e._v(e._s(e.beanCanUse))]):e._e()],1)],1)]):e._e(),e.showInfo?a("el-collapse-item",{attrs:{title:"其他信息",name:"7"}},[a("el-form-item",{attrs:{label:"创建时间"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.orderTime,callback:function(t){e.$set(e.form,"orderTime",t)},expression:"form.orderTime"}})],1),a("el-form-item",{attrs:{label:"执行时间"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.deliveryTime,callback:function(t){e.$set(e.form,"deliveryTime",t)},expression:"form.deliveryTime"}})],1),a("el-form-item",{attrs:{label:"付款时间"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.paymentTime,callback:function(t){e.$set(e.form,"paymentTime",t)},expression:"form.paymentTime"}})],1),a("el-form-item",{attrs:{label:"完成时间"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.completeTime,callback:function(t){e.$set(e.form,"completeTime",t)},expression:"form.completeTime"}})],1)],1):e._e()],1)],1),a("el-dialog",{attrs:{title:"创建会员",visible:e.dialogVisible,width:"50%",appendToBody:!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"dialogFormModel",attrs:{model:e.formModel,"label-width":"120px",size:"small",rules:e.dialogRules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入手机号，如1888888888"},on:{blur:e.mobileBlur},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{attrs:{placeholder:"请输入用户名，如1888888888"},model:{value:e.formModel.userName,callback:function(t){e.$set(e.formModel,"userName",t)},expression:"formModel.userName"}})],1),a("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请输入昵称，如1888888888"},model:{value:e.formModel.nickname,callback:function(t){e.$set(e.formModel,"nickname",t)},expression:"formModel.nickname"}})],1),a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入姓名，如张三"},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入密码"},model:{value:e.formModel.password,callback:function(t){e.$set(e.formModel,"password",t)},expression:"formModel.password"}})],1),a("el-form-item",{attrs:{label:"性别",prop:"gender"}},[a("el-radio-group",{model:{value:e.formModel.gender,callback:function(t){e.$set(e.formModel,"gender",t)},expression:"formModel.gender"}},[a("el-radio",{attrs:{label:"0"}},[e._v("男")]),a("el-radio",{attrs:{label:"1"}},[e._v("女")]),a("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),a("el-form-item",{attrs:{label:"车牌号"}},[a("el-input",{attrs:{placeholder:"请输入车牌号，如浙12345"},model:{value:e.formModel.defaultCarInfo.plateNumber,callback:function(t){e.$set(e.formModel.defaultCarInfo,"plateNumber",t)},expression:"formModel.defaultCarInfo.plateNumber"}})],1),a("el-form-item",{attrs:{label:"品牌"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马",filterable:""},on:{change:e.brandChange},model:{value:e.formModel.defaultCarInfo.brand,callback:function(t){e.$set(e.formModel.defaultCarInfo,"brand",t)},expression:"formModel.defaultCarInfo.brand"}},e._l(e.brandData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"系列"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系",filterable:""},on:{change:e.seriesChange},model:{value:e.formModel.defaultCarInfo.series,callback:function(t){e.$set(e.formModel.defaultCarInfo,"series",t)},expression:"formModel.defaultCarInfo.series"}},e._l(e.seriesData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"车型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系2016款"},model:{value:e.formModel.defaultCarInfo.type,callback:function(t){e.$set(e.formModel.defaultCarInfo,"type",t)},expression:"formModel.defaultCarInfo.type"}},e._l(e.modeData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"车辆识别代码"}},[a("el-input",{attrs:{placeholder:"请输入车辆识别代码，如1G1BL52P7TR115520"},model:{value:e.formModel.defaultCarInfo.vin,callback:function(t){e.$set(e.formModel.defaultCarInfo,"vin",t)},expression:"formModel.defaultCarInfo.vin"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.createMember()}}},[e._v("确 定")])],1)],1),a("biz-dialog-selector",{staticClass:"memberDialog",attrs:{title:"选择会员",visibility:e.showDialog,appendToBody:!0,keyField:"id",selectionKeys:e.selectionKeys,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,selectionMode:"single",filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.handleConfirmed,open:e.opened,operate:e.dialogOperate,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange}},[a("el-table-column",{attrs:{label:"用户名",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"customer-info"},[t.row.head?a("img",{attrs:{src:t.row.head}}):a("img",{attrs:{src:i("624d")}}),a("div",{staticClass:"wrapper"},[a("div",{staticClass:"title"},[e._v(e._s(t.row.name))]),a("div",{staticClass:"gender"},["0"===t.row.gender?a("i",{staticClass:"male iconfont biz-icon-i-web-m"}):e._e(),"1"===t.row.gender?a("i",{staticClass:"female iconfont biz-icon-i-web-f"}):e._e(),"2"===t.row.gender?a("i",{staticClass:"none iconfont biz-icon-i-web-bm"}):e._e(),a("span",[e._v(e._s(t.row.mobile))])])])])]}}])}),a("el-table-column",{attrs:{prop:"mobile",label:"手机号"}}),a("el-table-column",{attrs:{prop:"createDate",label:"创建日期",formatter:e.createDateConverter,sortable:"custom"}}),a("el-table-column",{attrs:{label:"状态",formatter:e.stateConverter}}),a("el-table-column",{attrs:{prop:"",label:"店铺名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",e._l(t.row.shops,(function(t,i){return a("div",{key:i,staticClass:"customer-info"},[e._v(e._s(t.name))])})),0)]}}])}),a("el-table-column",{attrs:{prop:"lastLoginIp",label:"最后登录地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"customer-info"},[a("span",{staticStyle:{display:"block"}},[e._v(e._s(t.row.loginAddress||t.row.lastLoginIp))])])]}}])}),a("el-table-column",{attrs:{prop:"lastLoginDate",label:"最后登录时间",formatter:e.loginDateConverter,sortable:"custom"}})],1),a("biz-dialog-selector",{attrs:{title:"选择车型",visibility:e.showProductSelector,tableData:e.productTableData,pagination:e.productPagination,selectionMode:"single"},on:{"update:visibility":function(t){e.showProductSelector=t},pageSizeChange:e.productPageSizeChange,currentPageChange:e.productCurrentPageChange,confirmed:e.confirmedProduct}},[a("el-table-column",{attrs:{property:"fullName",label:"名称"}}),a("el-table-column",{attrs:{property:"price",label:"销售价"}})],1)],1)},r=[],o=(i("99af"),i("4de4"),i("7db0"),i("c740"),i("4160"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("ac1f"),i("25f0"),i("3ca3"),i("5319"),i("1276"),i("159b"),i("ddb0"),i("b85c")),s=(i("96cf"),i("1da1")),n=i("5530"),l=i("f36f"),d=i("e42c"),c=i("8330"),p=i("46fc"),m=i("c466"),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close,open:e.open}},[i("biz-flex-table",{ref:"table",attrs:{operations:e.operations,filters:e.filters,tags:e.tags,pagination:e.pagination,tableData:e.tableData,loading:e.loading,checkable:e.checkable},on:{operate:e.operate,"row-click":e.rowClick,"filter-data-change":e.filterDataChange,"select-all":e.handleSelectAll,select:e.handleSelectionChange,"size-change":e.pageSizeChange,"current-change":e.currentPageChange}},[e._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmed}},[e._v("确定")])],1)],1)},f=[],h=i("04d3"),g={name:"BizDialogSelector",components:{BizFlexTable:h["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},selectionKeys:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],innerSelection:[]}},methods:{generateSelectionKeys:function(e,t){if(e.indexOf(t)>=0)this.innerSelectionKeys.push(t[this.keyField]);else{var i=this.innerSelectionKeys.indexOf(t[this.keyField]);this.innerSelectionKeys.splice(i,1)}},open:function(e){console.log(this.selectionKeys),this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(e){this.innerSelectionKeys=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){this.innerSelectionKeys.length>0?(this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1):this.$message("请选择一项")},operate:function(e){this.$emit("operate",e)},filterDataChange:function(e){this.$emit("filterDataChange",e)},handleSelectAll:function(e){var t=this;0===e.length?this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i>=0&&t.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(e){var i=t.innerSelectionKeys.indexOf(e[t.keyField]);i<0&&t.innerSelectionKeys.push(e[t.keyField])}))},handleSelectionChange:function(e,t){this.generateSelectionKeys(e,t)},pageSizeChange:function(e){this.$emit("pageSizeChange",e)},currentPageChange:function(e){this.$emit("currentPageChange",e)},rowClick:function(e,t,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[e[this.keyField]],this.innerSelection=[e])}},watch:{visibility:function(e,t){this.dialogVisible=e}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){}},b=g,v=(i("1029"),i("2877")),y=Object(v["a"])(b,u,f,!1,null,null,null),_=y.exports,I=i("2f62"),w=i("18eb"),x=i("0e5e"),S=i("1ab1"),C=i("c596"),M={stateConverter:function(e){return"0"===e.enableState?"停用":"1"===e.enableState?"启用":"--"},createDateConverter:function(e){if(e.createDate){e.createDate=e.createDate.replace(/-/g,"/");var t=new Date(e.createDate);return m["a"].dateConverter(t)}return"--"},loginDateConverter:function(e){if(e.lastLoginDate){e.lastLoginDate=e.lastLoginDate.replace(/-/g,"/");var t=new Date(e.lastLoginDate);return m["a"].dateConverter(t)}return"--"},ipConverter:function(e){return e.lastLoginIp?e.lastLoginIp:"--"}},k={name:"baseInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},open:{type:Boolean,default:function(){return!1}},handler:{type:String},activeNames:{type:Array,default:function(){return["1","2","3","4","5"]}}},components:{BizGrid:l["a"],BizSaveButton:c["a"],BizDialogSelector:_,TagSelect:w["a"]},data:function(){var e=this;return{isShipped:!1,beanCanUse:"",maxOffsetBean:0,minOffsetBean:0,originalAmount:"",orderStateTypeList:[{label:"订单已执行",value:"1"},{label:"交易完成",value:"2"}],beanRate:0,tagList:[],selectedTags:[],restaurants:[],dialogRules:{userName:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[0-9a-zA-Z]+$/,message:"用户名只能为数字或字母",trigger:"blur"},{min:4,max:20,message:"长度在4-20位",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"}],name:[{required:!0,trigger:"blur",message:"请输入姓名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:20,message:"密码应在6-20位之间",trigger:"blur"}],rePassword:[{required:!0,trigger:"blur",message:"请再次输入密码"},{trigger:"blur",validator:function(t,i,a){e.formModel.password===e.formModel.rePassword?a():a(new Error("两次输入密码不一致"))}}]},loading:!1,picDialogVisible:!1,showProductSelector:!1,dialogImageUrl:"",isFirst:!0,showDialog:!1,dialogVisible:!1,showDelivery:!1,showReceiver:!1,flag:!1,data:{type:"",method:""},productTableData:[],imageList:[],consultants:[],shippingMethod:[],deliveryCorps:[],paymentTypes:[],paymentMethods:[],listExistCard:[],brandList:[],seriesList:[],modeList:[],brandData:[],seriesData:[],modeData:[],financialPlans:[],selectionKeys:[],rescueOrganizations:[],cars:[],reasons:[],workers:[],orderItems:[],areaId:"1568",useTime:"",useMileage:"",appointmentDate:"",downPaymentPrice:"",loanPrice:"",formModel:{userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",brand:"",series:"",type:"",vin:""}},form:{bean:"",appointmentData:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}},appointmentDate:"",appointmentEndDate:"",sn:"",type:"",amount:"",amountPrepay:"",amountFinalpay:"",originalAmount:"",offsetAmount:"",curAmount:"",memberCardId:"",userId:"",consultant:{id:""},area:{id:"1568"},car:{id:"",tpye:"",drivingRange:""},address:"",areaName:"",consignee:"",phone:"",zipCode:"",remarks:"",memo:"",promotionDiscount:"",couponDiscount:"",couponCodeId:"",couponCode:{},couponList:[],beanDiscount:"",point:"",giftBean:"",shippingMethodName:"",paymentMethodId:"",shippingMethodId:"",invoiceState:"",orderTime:"",deliveryTime:"",paymentTime:"",completeTime:"",orderItems:[{appointment:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",plateNumber:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}}}],payments:[{paymentType:"",payBank:"",payAccount:""}],member:{nickname:"",gender:"",mobile:""},shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",isLCL:"0",phone:"",zipCode:""}]},operations:[{label:"保存",name:"save",type:"primary"}],adminCurrent:[],dialogLoading:!0,dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},productPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},isCreated:!1,dialogFilters:[{type:"input",label:"",placeholder:"请输入店铺名称",name:"searchValue",value:""}]}},computed:Object(n["a"])(Object(n["a"])({},Object(I["c"])(["currentUser"])),{},{getCouponCode:function(){var e,t=this;return this.form.couponList.forEach((function(i){if(i.id===t.form.couponCodeId)return e=i,!1})),e},showInfo:function(){return!0},showPayment:function(){return!!this.itemId||"1"!==this.form.type},isCreate:function(){return!this.itemId}}),created:function(){this.queryBrandList(),this.getBrandList(),this.getFinancialPlans(),!this.itemId&&this.orderOptions(),this.getStoreTags(),this.testDrives()},watch:{itemId:function(e){this.itemId&&this.init(),this.itemId||(this.resetFormData(),this.form.type="2",this.getStoreTags())},open:function(e){this.isShipped=!1,!this.itemId&&e&&this.isCreated&&this.resetFormData()},form:{deep:!0,immediate:!0,handler:function(e){var t=this;this.showDelivery=!1,this.showReceiver=!1,this.shippingMethod.map((function(i){i.name===e.shippingMethodName&&"1"===i.isNeedDelivery&&(t.showDelivery=!0),i.name===e.shippingMethodName&&"1"===i.isNeedReceiver&&(t.showReceiver=!0)}))}}},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(I["c"])(["getUser"])),M),{},{getDefaultForm:function(){return{bean:"",curAmount:"",couponCodeId:"",couponCode:{},couponList:[],appointmentData:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}},appointmentDate:"",appointmentEndDate:"",sn:"",type:"",amount:"",amountPrepay:"",amountFinalpay:"",originalAmount:"",offsetAmount:"0",memberCardId:"",userId:"",consultant:{id:""},area:{id:"1568",fullanme:""},car:{id:"",tpye:"",drivingRange:""},address:"",areaName:"",consignee:"",phone:"",zipCode:"",remarks:"",memo:"",promotionDiscount:"",couponDiscount:"",beanDiscount:"",point:"",giftBean:"",shippingMethodName:"",paymentMethodId:"",shippingMethodId:"",invoiceState:"",orderTime:"",deliveryTime:"",paymentTime:"",completeTime:"",orderItems:[{appointment:{appontmentDate:"",driveEndDate:"",driveStartDate:"",startMileage:"",endMileage:"",level:"",palteNumber:"",productId:"",drivingRange:"",onTime:"",downPayment:"",year:"",price:"",fee:"",plateNumber:"",personId:"",workUnit:"",houseState:"",onCity:"",intentionTime:"",monthIncome:"",carState:"",way:"",rescueUnit:"",rescuerId:"",rescueCar:"",distance:"",workerLocation:"",reasons:[],images:[],voices:[],financialPlan:{id:"",name:"",loanTerm:[],downPayments:[]},product:{brandId:"",seriesIs:"",id:"",fullName:""},car:{type:""}}}],payments:[{paymentType:"",payBank:"",payAccount:""}],member:{nickname:"",gender:"",mobile:""},shippings:[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:"",consignee:"",phone:"",zipCode:""}]}},onShippingChange:function(){this.form.shippingMethodName&&this.showDelivery||(this.form.shippings[0].freight="",this.getOriginalAmount())},mobileBlur:function(){this.formModel.id||this.formModel.nickname||this.$set(this.formModel,"nickname",this.formModel.mobile),this.formModel.id||this.formModel.userName||this.$set(this.formModel,"userName",this.formModel.mobile)},brandChange:function(e){this.getSeriesList(e),this.formModel.defaultCarInfo.series="",this.formModel.defaultCarInfo.type=""},seriesChange:function(e){this.getModeList(e),this.formModel.defaultCarInfo.type=""},getStoreTags:function(){var e=this,t={categoryType:"订单/服务业务类型",shopId:window.top.SHOP_ID||""};S["a"].get(C["g"].systemSetting.storeTags,t).then((function(t){console.log("订单/服务业务类型标签",t),e.tagList=t.content})).catch((function(e){console.log(e.errorMessage)}))},beanChange:function(){this.getOriginalAmount()},getOriginalAmount:function(){this.isCreate&&(this.form.originalAmount=(Number(this.originalAmount)-Number(this.form.beanDiscount*this.beanRate||"0")-Number(this.form.couponDiscount||"0")+Number(this.form.shippings[0].freight||"0")).toFixed(2),this.getCurAmount())},getCurAmount:function(){this.form.curAmount=(Number(this.form.originalAmount)+Number(this.form.offsetAmount||"0")).toFixed(2),this.form.curAmount<=0&&(this.form.curAmount=0),this.form.curAmount=this.form.curAmount.toString()},freightChange:function(){this.getOriginalAmount()},offsetAmountChange:function(){this.getCurAmount()},curAmountChange:function(){this.form.offsetAmount=Number(this.form.curAmount)+Number(this.form.beanDiscount*this.beanRate)+Number(this.form.couponDiscount)-Number(this.form.originalAmount),this.form.offsetAmount=this.form.offsetAmount.toString()},couponChange:function(){var e=this;this.form.couponList.forEach((function(t){if(t.id===e.form.couponCodeId)return e.form.couponDiscount=t.coupon.amount,!1})),this.getOriginalAmount()},tagMapping:function(){var e={refId:this.itemId,type:"7",tags:this.$refs.tagSelect.getCurSelectedTags(),shopId:window.top.SHOP_ID||""};S["a"].post(C["g"].systemSetting.tagMapping,e).then((function(e){console.log("映射成功")})).catch((function(e){console.log(e.errorMessage)}))},getTagMapping:function(){var e=this;this.selectedTags=[];var t={refId:this.itemId,type:"7",shopId:window.top.SHOP_ID||""};S["a"].get(C["g"].systemSetting.tagMapping,t).then((function(t){console.log("查看映射信息",t),t.data.tags&&(e.selectedTags=t.data.tags)})).catch((function(e){console.log(e.errorMessage)}))},onAddSuccess:function(){this.getStoreTags()},operate:function(e){this[e]()},dateInterval:function(e,t){if(e&&t)return Object(p["a"])(e.split(" ")[1],t.split(" ")[1])},showDialogFc:function(){this.showDialog=!0,this.dialogFilters[0].value=""},monthPay:function(){var e=this;if(this.form.orderItems[0].appointment.year)return this.form.orderItems[0].appointment.financialPlan.loanTerms.map((function(t){t.year===e.form.orderItems[0].appointment.year&&(e.form.orderItems[0].appointment.rate=t.rate)})),((this.form.orderItems[0].appointment.product.price-this.form.orderItems[0].appointment.product.price*this.form.orderItems[0].appointment.downPayment/100)*this.form.orderItems[0].appointment.rate/12*Math.pow(1+this.form.orderItems[0].appointment.rate/12,12*this.form.orderItems[0].appointment.year)/(Math.pow(1+this.form.orderItems[0].appointment.rate/12,12*this.form.orderItems[0].appointment.year)-1)).toFixed(2)},queryProduct:function(){var e=this;d["a"].listProductByTestDrive({clientType:"2",methodName:"ListProductByTestDrive",shopId:this.getUser().shop?this.getUser().shop.id:window.top.SHOP_ID,pageSize:this.productPagination.pageSize,pageNumber:this.productPagination.currentPage},(function(t){e.productTableData=t.content,e.showProductSelector=!0}),(function(t){e.$message.warning(t.errorMessage)}))},confirmedProduct:function(e,t){this.form.orderItems[0].appointment.product.id=t[0].id,this.form.orderItems[0].appointment.product.fullName=t[0].fullName},handleConfirmed:function(e,t){this.form.member.nickname=t[0].nickname,this.form.member.mobile=t[0].mobile,this.form.memberCardId="",this.form.userId=t[0].id,this.$set(this.form.member,"gender",t[0].gender),this.$set(this.form,"selectionKeys",e),this.listExistCardTemplate(),this.form.plateNumber=t[0].defaultCarInfo.plateNumber,this.form.drivingRange=t[0].defaultCarInfo.drivingRange||"",this.form.car.type=t[0].defaultCarInfo.type||"",this.form.car.drivingRange="",this.form.shippings[0].address&&this.itemId||(this.form.shippings[0].address=t[0].defaultReceiver.areaName+t[0].defaultReceiver.address),this.form.shippings[0].consignee&&this.itemId||(this.form.shippings[0].consignee=t[0].name),this.form.shippings[0].phone&&this.itemId||(this.form.shippings[0].phone=t[0].mobile),this.carOptions(this.form.userId),this.getCouponList()},carOptions:function(e){var t,i=this;d["a"].carOptions({memberId:e},(function(e){i.cars=e.cars,i.cars.length>0&&(i.cars.forEach((function(e){if(e.plateNumber===i.form.plateNumber)return t=e,!1})),i.form.car.id=t?t.id:"",i.cars.map((function(e){if(e.id===i.form.car.id)return i.form.car.type=e.type,!1})))}),(function(e){i.$message.warning(e.errorMessage)}))},carChange:function(e){var t=this;this.cars.map((function(i){i.id===e&&(t.form.car.type=i.type,t.form.car.drivingRange=i.drivingRange,t.form.drivingRange=i.drivingRange)}))},createMember:function(){var e=this;this.$refs.dialogFormModel.validate((function(t,i){t&&d["a"].createMember(e.formModel,(function(t){e.loading=!1,e.$message.success("保存成功"),e.dialogVisible=!1,e.form.member.nickname=t.data.name,e.form.member.gender=t.data.gender,e.form.member.mobile=t.data.mobile,e.form.userId=t.data.id,t.data.defaultCarInfo&&(e.cars.push({plateNumber:t.data.defaultCarInfo.plateNumber,id:t.data.defaultCarInfo.id,type:t.data.defaultCarInfo.type}),e.form.car.id=t.data.defaultCarInfo.id,e.form.car.type=t.data.defaultCarInfo.type)}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},resetFormData:function(){this.form=this.getDefaultForm(),this.form.userId="",this.form.memberCardId="",this.listExistCard=[],this.form.member={},this.form.couponList=[],this.form.couponCodeId="",this.form.beanDiscount="",this.paymentTypes=[],this.form.payments[0].paymentType="",this.form.shippings[0].deliveryCorpId="",this.form.originalAmount="",this.form.curAmount="",this.form.car.type="",this.form.car.drivingRange="",this.form.drivingRange="",this.form.plateNumber="",this.form.car.id="",this.form.offsetAmount="",this.form.orderItems[0].appointment.product.brandId="",this.form.orderItems[0].appointment.product.seriesId="",this.form.orderItems[0].appointment.product.id=""},init:function(){var e=this;d["a"].viewOrder(this.getSaveParams(),(function(t){e.form=Object.assign(e.getDefaultForm(),t.order),e.form.curAmount=Number(e.form.originalAmount)+Number(e.form.offsetAmount),console.log(e.form),0===e.form.payments.length?(e.form.payments=[{paymentType:"",payBank:"",payAccount:""}],e.form.payments[0].paymentType=e.form.paymentTypeName):e.form.memberCardId=e.form.payments[0].memberCardId,0===e.form.shippings.length&&(e.form.shippings=[{shippingMethod:"",deliveryCorpId:"",expressSn:"",freight:"",address:e.form.area&&e.form.area.fullName?e.form.area.fullName+e.form.address:e.form.address,consignee:e.form.consignee,phone:e.form.phone,zipCode:e.form.zipCode}]),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.product&&e.form.orderItems[0].appointment.product.brandId&&e.querySeriesList(e.form.orderItems[0].appointment.product.brandId),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.product&&e.form.orderItems[0].appointment.product.seriesId&&e.queryTypeList(e.form.orderItems[0].appointment.product.seriesId),t.order.appointmentDate&&(e.appointmentDate=t.order.appointmentDate),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.reasons&&(e.form.orderItems[0].appointment.reasons=e.form.orderItems[0].appointment.reasons.map((function(e){return e.id}))),e.carOptions(e.form.member.id),e.shippingMethod=t.shippingMethods,e.deliveryCorps=t.deliveryCorps,e.paymentTypes=t.paymentTypes,e.paymentMethods=t.paymentMethods,e.paymentMethods.map((function(i){i.name===t.order.paymentMethodName&&(e.form.paymentMethodId=i.id)})),e.reasons=t.reasons,e.adminCurrent=[{id:t.adminCurrent.id,name:t.adminCurrent.realName}],e.form.consultant.id?e.adminCurrent=[{id:e.form.consultant.id,name:e.form.consultant.realName}]:e.form.consultant={id:t.adminCurrent.id},e.form.area&&(e.areaId=e.form.area.id),"rescue"===e.$route.params.orderType&&(e.imageList=e.form.orderItems[0].appointment.images.map((function(e){return{url:e.path}}))),e.form.type=e.getOrderStatus(e.form.type),e.listExistCardTemplate(),e.listAdminByRole(),"2"===e.form.orderType&&(console.log("查询映射",e.form.orderType),e.getTagMapping(),e.getStoreTags()),e.offsetAmountChange()}),(function(t){e.$message.warning(t.errorMessage)}))},paymentTypeChange:function(e){"会员卡余额"!==e&&(this.form.memberCardId="",this.form.beanDiscount="",this.getOriginalAmount())},memberCardChange:function(){this.getMemberCardInfo(),this.getBeanRate()},getMemberCardInfo:function(){var e=this,t={userCardId:this.form.memberCardId};S["a"].get("/admin/memberCard/memberCard.jhtml",t).then((function(t){e.form.bean=t.content.bean,e.getCouponList()})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getBeanRate:function(){var e=this,t={id:this.form.memberCardId};S["a"].get("/admin/memberCard/memberCard.jhtml",t).then((function(t){e.beanRate=Number(t.rewardSet.cash)/Number(t.rewardSet.vBean)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},getCouponList:function(){var e=this;if(0!==this.orderItems.length){this.form.couponList=[];var t=this.orderItems.map((function(e){return{product:{id:e.productId},quantity:e.quantity||""}})),i={shopId:window.top.SHOP_ID||"",cartItems:t,userId:this.form.userId,userCardId:this.form.memberCardId};S["a"].post("/admin/order/couponCodes.jhtml",i).then((function(t){e.form.couponList=t.content,e.maxOffsetBean=t.maxOffsetBean,e.minOffsetBean=t.minOffsetBean})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))}},listAdminByRole:function(){var e=this,t="";t="car"===this.$route.params.orderType?["salesman"]:["afterSale","reception","testDriver"],d["a"].listAdminByRole({roleTypes:t},(function(t){e.loading=!1,e.flag=!1,console.log(e.form.consultant.id),t.dataList.map((function(t){t.id===e.adminCurrent[0].id&&(e.flag=!0)})),e.flag?e.consultants=t.dataList:e.consultants=t.dataList.concat(e.adminCurrent)}),(function(e){console.log(e)}))},loanTerm:function(e){var t=this;d["a"].loanTerms({financialId:e},(function(e){t.loading=!1,t.form.orderItems[0].appointment.financialPlan.downPayments=[e.downPayment,e.downPayment+10,e.downPayment+20,e.downPayment+30],t.form.orderItems[0].appointment.downPayment="",t.form.orderItems[0].appointment.financialPlan.loanTerms=e.loanTerms}),(function(e){t.loading=!1,t.$message.warning(e.errorMessage)}))},orderOptions:function(){var e=this,t=!1;this.form.type="交易完成",d["a"].options({shopId:window.top.SHOP_ID},(function(i){e.loading=!1,e.paymentMethods=i.paymentMethods,e.paymentTypes=i.paymentTypes,e.shippingMethod=i.shippingMethods,e.deliveryCorps=i.deliveryCorps,e.reasons=i.reasons,e.rescueOrganizations=i.rescueOrganizations,e.workers=i.workers,e.adminCurrent=[{id:i.adminCurrent.id,name:i.adminCurrent.realName}],e.form.consultant={id:i.adminCurrent.id},e.listAdminByRole(),!e.itemId&&e.showInfo&&(e.paymentTypes.forEach((function(e){if("会员卡余额"===e.name)return t=!0,!1})),e.form.payments[0].paymentType=t?"会员卡余额":e.paymentTypes[0].name),e.form.userId&&e.listExistCardTemplate()}),(function(t){e.loading=!1,"店铺不存在"!==t.errorMessage&&e.$message.warning(t.errorMessage)}))},submitOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var i,a,r,s,n,l,d,c,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.analysisAddress(e.currentUser.shop.address);case 2:return i=t.sent,t.next=5,e.analysisAddress(e.form.shippings[0].address);case 5:a=t.sent,r=e.form.orderItems,s=[],n=Object(o["a"])(r);try{for(n.s();!(l=n.n()).done;)for(d=l.value,c=0;c<d.quantity;c++)p={cname:e.currentUser.shop.name,spro:i.province,scity:i.city,num:d.product.vins[c].number,epro:a.province,ecity:a.city,depname:e.form.shippings[0].consignee},s.push(S["a"].post("/admin/order/shipping2XinYue.jhtml",p))}catch(m){n.e(m)}finally{n.f()}Promise.all(s).then((function(t){e.$emit("xrorder")})).catch((function(t){e.$emit("xrorder")}));case 11:case"end":return t.stop()}}),t)})))()},analysisAddress:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("开始解析, "+e),t.abrupt("return",new Promise((function(t,i){var a=new window.BMap.Geocoder;a.getPoint(e,(function(e){a.getLocation(e,(function(e){console.log(e),t({province:e.addressComponents.province,city:e.addressComponents.city})}))}))})));case 2:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;if(this.reasons&&this.reasons.length>0&&this.itemId&&this.form.orderItems[0].appointment&&(this.form.orderItems[0].appointment.reasons=this.reasons.map((function(t){return e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.reasons&&-1!==e.form.orderItems[0].appointment.reasons.indexOf(t.id)?{id:t.id,content:t.content}:{id:"",content:""}}))),""===this.form.consultant.id)return this.$message.warning("请输入顾问"),!1;if("ride"===this.$route.params.orderType){if(console.log(this.form.orderItems[0].appointment.plateNumber),""===this.form.orderItems[0].appointment.plateNumber)return this.$message.warning("请输入试驾车号"),!1;if(""===this.form.orderItems[0].appointment.product.fullName)return this.$message.warning("请输入试驾车型"),!1}if(this.itemId)if("shipping"===this.handler){if(this.loading=!0,this.shippingMethod.map((function(t){t.name===e.form.shippingMethodName&&(e.form.shippingMethodId=t.id)})),this.form.deliveryCorpId=this.form.shippings[0].deliveryCorpId,this.showDelivery){if(""===this.form.shippings[0].deliveryCorpId&&"0"===this.form.shippings[0].isLCL)return this.$message.warning("请输入物流公司"),this.loading=!1,!1;if(""===this.form.shippings[0].expressSn&&"0"===this.form.shippings[0].isLCL)return this.$message.warning("请输入物流单号"),this.loading=!1,!1;if(""===this.form.shippings[0].freight||!/^(0|[0-9][0-9]*)(\.\d+)?$/.test(this.form.shippings[0].freight))return this.$message.warning("请输入正确的物流费用"),this.loading=!1,!1;this.showReceiver?this.$set(this.form,"shippingData",{isLCL:this.form.shippings[0].isLCL,phone:this.form.shippings[0].phone||this.form.phone,address:this.form.shippings[0].address||this.form.areaName,consignee:this.form.shippings[0].consignee||this.form.consignee,expressSn:this.form.shippings[0].expressSn,freight:this.form.shippings[0].freight}):this.$set(this.form,"shippingData",{expressSn:this.form.shippings[0].expressSn,freight:this.form.shippings[0].freight})}else this.showReceiver&&!this.showDelivery&&(this.$set(this.form,"shippingData",{phone:this.form.shippings[0].phone||this.form.phone,address:this.form.shippings[0].address||this.form.areaName,consignee:this.form.shippings[0].consignee||this.form.consignee}),this.$set(this.form,"deliveryCorpId",this.form.shippings[0].deliveryCorpId));this.loading=!0,d["a"].shippingOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess"),console.log("shipping-success"),e.isShipped=!0}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}else if("service"===this.handler)this.loading=!0,d["a"].excuteOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}));else if("payment"===this.handler){if(this.loading=!0,this.paymentTypes.map((function(t){t.name===e.form.payments[0].paymentType&&(e.form.paymentTypeId=t.id)})),this.form.payment={payBank:this.form.payments[0].payBank,payAccount:this.form.payments[0].payAccount,amount:this.form.amount},!this.form.payments[0].paymentType||("刷卡"===this.form.payments[0].paymentType||"汇款"===this.form.payments[0].paymentType)&&(""===this.form.payments[0].payBank||""===this.form.payments[0].payAccount))return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.$refs.form.validate((function(t,i){t?d["a"].paymentOrder(e.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess")}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})):e.loading=!1}))}else this.loading=!0,d["a"].updateOrder(this.form,(function(t){e.loading=!1,e.$message.success("保存成功"),e.$emit("operationSuccess"),"2"===e.form.orderType&&e.tagMapping()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}));else{if(!this.form.payments[0].paymentType)return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.createOrder()}var t=this.deliveryCorps.find((function(t){return t.id===e.form.shippings[0].deliveryCorpId})).name;"shipping"===this.handler&&"新悦物流"===t&&this.submitOrder()},setOrderItems:function(e){this.orderItems=e,this.orderItems.forEach((function(e){e.productId=e.productId?e.productId:e.id}));var t=0;e.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.originalAmount=t,this.form.originalAmount=t,this.offsetAmountChange(),this.form.member.nickname&&this.getCouponList()},createOrder:function(){var e=this;if(this.shippingMethod.map((function(t){t.name===e.form.shippingMethodName&&(e.form.shippingMethodId=t.id)})),this.paymentTypes.map((function(t){t.name===e.form.payments[0].paymentType&&(e.form.paymentTypeId=t.id)})),this.form.appointmentData=this.form.orderItems[0].appointment,"rescue"===this.$route.params.orderType&&(this.form.appointmentData.reasons=this.reasons.map((function(t){return-1!==e.form.appointmentData.reasons.indexOf(t.id)?{id:t.id,content:t.content}:{id:"",content:""}}))),this.showInfo&&!this.form.payments[0].paymentType||this.showInfo&&("刷卡"===this.form.payments[0].paymentType||"汇款"===this.form.payments[0].paymentType)&&(""===this.form.payments[0].payBank||""===this.form.payments[0].payAccount))return this.$message.warning("请输入付款信息"),this.loading=!1,!1;this.loading=!0,this.$refs.form.validate((function(t,i){t&&d["a"].createOrder({appointmentData:e.form.orderItems[0].appointment,appointmentDate:e.form.appointmentDate,appointmentEndDate:e.form.appointmentEndDate,sn:e.form.sn,type:e.form.type,orderType:e.$route.params.orderType,orderStatus:"交易完成"===e.form.type?"2":e.form.type,bean:e.form.beanDiscount,couponCode:e.getCouponCode,amount:e.form.amount,amountPrepay:e.form.amountPrepay,paymentTypeId:e.form.paymentTypeId,shippingMethod:{id:e.form.shippingMethodId},amountFinalpay:e.form.amountFinalpay,originalAmount:e.form.originalAmount,offsetAmount:e.form.offsetAmount,freight:e.form.shippings&&e.form.shippings.length?e.form.shippings[0].freight:"",memberCardId:e.form.memberCardId,amountPaid:e.form.curAmount,userId:e.form.userId,consultant:{id:e.form.consultant.id},car:{id:e.form.car.id},area:{id:e.areaId},address:e.form.address,areaName:e.form.areaName,consignee:e.form.consignee,phone:e.form.phone,zipCode:e.form.zipCode,remarks:e.form.remarks,memo:e.form.memo,promotionDiscount:e.form.promotionDiscount,couponDiscount:e.form.couponDiscount,beanDiscount:e.form.beanDiscount,point:e.form.point,giftBean:e.form.giftBean,shippingMethodName:e.form.shippingMethodName,paymentMethodId:e.form.paymentMethodId,invoiceState:e.form.invoiceState,orderTime:e.form.orderTime,deliveryTime:e.form.deliveryTime,paymentTime:e.form.paymentTime,completeTime:e.form.completeTime,orderItems:e.orderItems,payments:[{paymentType:e.form.payments[0].paymentType,payBank:e.form.payments[0].payBank,payAccount:e.form.payments[0].payAccount}],member:{nickname:e.form.member.nickname,gender:e.form.member.gender,mobile:e.form.member.mobile},shippings:[{isLCL:e.form.shippings[0].isLCL,shippingMethod:e.form.shippings[0].shippingMethod,deliveryCorpId:e.form.shippings[0].deliveryCorpId,expressSn:e.form.shippings[0].expressSn,freight:e.form.shippings[0].freight,address:e.form.shippings[0].address,consignee:e.form.shippings[0].consignee,phone:e.form.shippings[0].phone,zipCode:e.form.shippings[0].zipCode}]},(function(t){e.loading=!1,e.$message.success("保存成功"),e.form=e.getDefaultForm(),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.driveStartDate&&(e.form.orderItems[0].appointment.driveStartDate=e.form.orderItems[0].appointment.driveStartDate.split(" ")[1]),e.form.orderItems[0].appointment&&e.form.orderItems[0].appointment.driveEndDate&&(e.form.orderItems[0].appointment.driveEndDate=e.form.orderItems[0].appointment.driveEndDate.split(" ")[1]),e.$emit("operationSuccess"),e.isCreated=!0,e.itemId=t.id,e.tagMapping()}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},productChange:function(){var e=this;this.modeList.map((function(t){t.id===e.form.orderItems[0].appointment.product.id&&(e.form.orderItems[0].appointment.product.price=t.price)}))},listExistCardTemplate:function(){var e=this;d["a"].listExistCardTemplate({userId:this.form.userId},(function(t){e.loading=!1,e.listExistCard=t.content,e.listExistCard.forEach((function(e){e.template.name+=" ¥"+e.balance}))}),(function(e){console.log(e)}))},getFinancialPlans:function(){var e=this;d["a"].getFinancialPlans({shopId:window.top.SHOP_ID||""},(function(t){e.loading=!1,e.financialPlans=t.financials}),(function(e){console.log(e)}))},getSaveParams:function(){return{orderId:this.itemId}},areaChanged:function(e){this.areaId=e,this.isFirst&&(this.areaId="1568",this.isFirst=!1)},handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.form.orderItems[0].appointment.product,"seriesId",""),this.$set(this.form.orderItems[0].appointment.product,"id","")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.form.orderItems[0].appointment.product,"id","")},queryMemberList:function(e){var t=this;d["a"].memberList(e,(function(e){t.dialogLoading=!1,t.dialogTableData=e.content,t.dialogPagination.total=Number(e.total)}),(function(e){console.log(e),console.log("code错误")}))},opened:function(){this.dialogPagination.currentPage=1,this.dialogPagination.pageSize=20,this.dialogFilters=[{type:"input",label:"",placeholder:"请输入名称或手机号",name:"searchValue",value:""}],this.queryMemberList(this.getDialogQueryParams())},getDialogQueryParams:function(){return{pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value}},productPageSizeChange:function(e){this.$set(this.productPagination,"pageSize",e)},productCurrentPageChange:function(e){this.$set(this.productPagination,"currentPage",e)},dialogFilterDataChange:function(e){this.dialogPagination.currentPage=1,this.queryMemberList(this.getDialogQueryParams())},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),this.queryMemberList(this.getDialogQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),this.queryMemberList(this.getDialogQueryParams())},handleSuccess:function(e,t,i){this.form.orderItems[0].appointment.images.push({path:e.fis[0].url})},handleRemove:function(e,t){var i=this.form.orderItems[0].appointment.images.findIndex((function(t){return t.path===e.path}));-1!==i&&this.form.orderItems[0].appointment.images.splice(i,1)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.picDialogVisible=!0},dialogOperate:function(e){},queryBrandList:function(){var e=this;d["a"].brands({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;d["a"].series({brandId:e},(function(e){t.seriesList=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},getBrandList:function(){var e=this;x["a"].queryBrandList({},(function(t){e.brandData=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},getSeriesList:function(e){var t=this;x["a"].querySeriesList({brand:e},(function(e){t.seriesData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},getModeList:function(e){var t=this;x["a"].queryTypeList({series:e,brand:this.formModel.defaultCarInfo.brand},(function(e){t.modeData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;d["a"].types({seriesId:e,brandId:this.form.brand},(function(e){t.modeList=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},beforeAvatarUpload:function(e){var t=/^image\/(.*)$/.test(e.type);if(!t)return this.$message.error("请选择符合图片格式的文件上传!"),!1;var i=e.size/1024<=200;return!!i||(this.$message.error("上传图片大小不能超过 200K!"),!1)},addMember:function(){this.formModel={userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",vin:"",brand:"",series:"",type:""}},this.dialogVisible=!0},getOrderStatus:function(e){switch(e){case"11":return"卖家已发货";case"10":return"退款退货完成";case"9":return"退款退货中";case"8":return"已过期";case"7":return"已评价";case"6":return"订单关闭";case"5":return"交易完成";case"4":return"订单已执行";case"3":return"买家已付款";case"2":return"商家已确认";case"1":return"待商家确认";default:return"无"}},testDrives:function(){var e=this,t={pageSize:1e3,pageNumber:1,shopId:window.top.SHOP_ID||""};S["a"].get("/admin/testDriveMgmt/testDrives.jhtml",t).then((function(t){e.restaurants=t.dataList.map((function(e){return{value:e.car.plateNumber,id:e.car.id,type:e.car.type}}))})).catch((function(e){console.log(e.errorMessage)}))},querySearchAsync:function(e,t){var i=this.restaurants,a=e?i.filter(this.createStateFilter(e)):i;t(a)},createStateFilter:function(e){return function(e){return!0}},handleSelect:function(e){this.form.orderItems[0].appointment.product.fullName=e.type}})},T=k,D=(i("0f32"),Object(v["a"])(T,a,r,!1,null,null,null));t["a"]=D.exports},b15b:function(e,t,i){"use strict";var a=i("bbfa"),r=i.n(a);r.a},b3368:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-history"},[i("biz-list",{ref:"table",attrs:{tableData:e.tableData,loading:e.loading,height:e.height}},[i("el-table-column",{attrs:{prop:"orderTime",label:"时间"}}),i("el-table-column",{attrs:{prop:"plateNumber",label:"会员车辆"}}),i("el-table-column",{attrs:{prop:"price",label:"服务分类"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[e._v(" "+e._s((t.row.orderType,"普通服务"))+" ")])])}}])}),i("el-table-column",{attrs:{prop:"quantity",label:"服务项目"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},e._l(t.row.orderItems,(function(t){return i("div",{key:t.id,staticClass:"biz-customcol"},[e._v(" "+e._s(t.fullName)+" ")])})),0)}}])})],1),i("biz-pagination",{attrs:{pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)},r=[],o=(i("a9e3"),i("7558")),s=i("5c40"),n=i("f36f"),l=i("e42c"),d={name:"OrderHistory",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{loading:!1,height:"90%",tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:o["a"],BizPagination:s["a"],BizGrid:n["a"]},created:function(){this.getList()},watch:{itemId:function(e){this.itemId&&this.getList()}},methods:{getList:function(){var e=this;this.loading=!0;var t={orderId:this.itemId,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};l["a"].repairMaintainHistory(t,(function(t){e.loading=!1,e.tableData=t.content,e.pagination.total=Number(t.total)}),(function(t){e.loading=!1,console.log(t)}))},handleSizeChange:function(e){this.pagination.pageSize=e,this.getList()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.getList()}}},c=d,p=i("2877"),m=Object(p["a"])(c,a,r,!1,null,null,null);t["a"]=m.exports},b442:function(e,t,i){"use strict";var a=i("2ee5"),r=i.n(a);r.a},b4cc:function(e,t,i){"use strict";var a=i("d9b9"),r=i.n(a);r.a},b5d6:function(e,t,i){"use strict";var a=i("1af4"),r=i.n(a);r.a},b61f:function(e,t,i){},b655:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"news-info"},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"label-width":"120px",size:"small"}},[i("el-form-item",{attrs:{label:"消息标题:",prop:"title"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.data.title,callback:function(t){e.$set(e.data,"title",t)},expression:"data.title"}})],1),i("el-form-item",{attrs:{label:"消息内容:",prop:"content"}},[i("el-input",{attrs:{value:e.data.content,disabled:!0,type:"textarea"}})],1),"car"===e.data.msgCategory||"service"===e.data.msgCategory?i("el-form-item",{attrs:{label:"车辆:",prop:"carPlateNumber"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.data.carPlateNumber,callback:function(t){e.$set(e.data,"carPlateNumber",t)},expression:"data.carPlateNumber"}})],1):e._e(),"car"===e.data.msgCategory||"service"===e.data.msgCategory?i("el-form-item",{attrs:{label:"车主:",prop:"name"}},[i("el-input",{attrs:{value:e.data.car&&e.data.car.member?e.data.car.member.name:"",disabled:!0}})],1):e._e(),"car"===e.data.msgCategory||"service"===e.data.msgCategory?i("el-form-item",{attrs:{label:"车主电话:",prop:"mobile"}},[i("el-input",{attrs:{value:e.data.car&&e.data.car.member?e.data.car.member.mobile:"",disabled:!0}})],1):e._e(),"community"===e.data.msgCategory||"system"===e.data.msgCategory?i("el-form-item",{attrs:{label:"会员:",prop:"name"}},[i("el-input",{attrs:{value:e.data.reviever?e.data.reviever.name:"",disabled:!0}})],1):e._e(),"community"===e.data.msgCategory||"system"===e.data.msgCategory?i("el-form-item",{attrs:{label:"会员电话:",prop:"mobile"}},[i("el-input",{attrs:{value:e.data.reviever?e.data.reviever.mobile:"",disabled:!0}})],1):e._e(),"car"===e.data.msgCategory||"service"===e.data.msgCategory?i("el-form-item",{attrs:{label:"地点:",prop:"address"}},[i("el-input",{attrs:{value:e.data.address,disabled:!0}})],1):e._e(),i("el-form-item",{attrs:{label:"消息类别:",prop:"typeName"}},[i("el-input",{attrs:{value:e.data.typeName,disabled:!0}})],1),i("el-form-item",{attrs:{label:"日期:",prop:"sendTime"}},[i("el-input",{attrs:{value:e.data.sendTime,disabled:!0}})],1)],1)],1)},r=[],o=i("f36f"),s=i("e685"),n={name:"NewsMgmtInfo",props:{itemId:{type:String}},components:{BizGrid:o["a"]},data:function(){return{loading:!1,data:{}}},watch:{itemId:function(e){this.init()}},methods:{init:function(){var e=this;s["a"].queryMsg(this.getSaveParams(),(function(t){e.data=t.message}),(function(t){e.$message.warning(t.errorMessage)}))},getSaveParams:function(){return{id:this.itemId}}}},l=n,d=(i("dbe8"),i("2877")),c=Object(d["a"])(l,a,r,!1,null,null,null);t["a"]=c.exports},b680:function(e,t,i){"use strict";var a=i("23e7"),r=i("a691"),o=i("408a"),s=i("1148"),n=i("d039"),l=1..toFixed,d=Math.floor,c=function(e,t,i){return 0===t?i:t%2===1?c(e,t-1,i*e):c(e*e,t/2,i)},p=function(e){var t=0,i=e;while(i>=4096)t+=12,i/=4096;while(i>=2)t+=1,i/=2;return t},m=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n((function(){l.call({})}));a({target:"Number",proto:!0,forced:m},{toFixed:function(e){var t,i,a,n,l=o(this),m=r(e),u=[0,0,0,0,0,0],f="",h="0",g=function(e,t){var i=-1,a=t;while(++i<6)a+=e*u[i],u[i]=a%1e7,a=d(a/1e7)},b=function(e){var t=6,i=0;while(--t>=0)i+=u[t],u[t]=d(i/e),i=i%e*1e7},v=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==u[e]){var i=String(u[e]);t=""===t?i:t+s.call("0",7-i.length)+i}return t};if(m<0||m>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(f="-",l=-l),l>1e-21)if(t=p(l*c(2,69,1))-69,i=t<0?l*c(2,-t,1):l/c(2,t,1),i*=4503599627370496,t=52-t,t>0){g(0,i),a=m;while(a>=7)g(1e7,0),a-=7;g(c(10,a,1),0),a=t-1;while(a>=23)b(1<<23),a-=23;b(1<<a),g(1,1),b(2),h=v()}else g(0,i),g(1<<-t,0),h=v()+s.call("0",m);return m>0?(n=h.length,h=f+(n<=m?"0."+s.call("0",m-n)+h:h.slice(0,n-m)+"."+h.slice(n-m))):h=f+h,h}})},b755:function(e,t,i){},b84c:function(e,t,i){},ba69:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"reception-mgmt-base-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"125px",size:"small",disabled:!e.isEdit,"inline-message":!0}},[i("el-form-item",{attrs:{label:"车牌号码",prop:"plateNumber"}},[i("el-input",{attrs:{disabled:e.disable,placeholder:""},model:{value:e.form.plateNumber,callback:function(t){e.$set(e.form,"plateNumber",t)},expression:"form.plateNumber"}})],1),i("el-form-item",{attrs:{label:"会员卡号",prop:"memberCardSn"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.form.memberCardSn,callback:function(t){e.$set(e.form,"memberCardSn",t)},expression:"form.memberCardSn"}})],1),i("el-form-item",{attrs:{label:"会员姓名",prop:"memberName"}},[i("el-input",{attrs:{disabled:"",placeholder:"请选择会员"},model:{value:e.form.memberName,callback:function(t){e.$set(e.form,"memberName",t)},expression:"form.memberName"}},[i("div",{staticClass:"input-append",attrs:{slot:"append"},slot:"append"},[i("el-button",{attrs:{type:"text"},on:{click:e.createMember}},[i("i",{staticClass:"el-icon-circle-plus-outline",attrs:{title:"添加会员"}})]),i("el-button",{attrs:{type:"text"},on:{click:e.addMember}},[i("i",{staticClass:"iconfont biz-icon-man",attrs:{title:"选择会员"}})])],1)])],1),i("el-form-item",{attrs:{label:"会员卡等级",prop:"userRankName"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.form.userRankName,callback:function(t){e.$set(e.form,"userRankName",t)},expression:"form.userRankName"}})],1),i("el-form-item",{attrs:{label:"到店时间",prop:"accessTime"}},[i("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"",clearable:!1,disabled:e.disable,"default-value":e.dateNow,"picker-options":e.pickerOptions},model:{value:e.form.accessTime,callback:function(t){e.$set(e.form,"accessTime",t)},expression:"form.accessTime"}}),e.form.accessImage?i("img",{attrs:{src:e.form.accessImage,alt:""},on:{click:function(t){return t.stopPropagation(),e.showImg(e.form.accessImage)}}}):e._e()],1),i("el-form-item",{attrs:{label:"离店时间",prop:"leaveTime"}},[i("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"",clearable:!1,disabled:e.disable,"default-value":e.dateNow,"picker-options":e.pickerOptions},model:{value:e.form.leaveTime,callback:function(t){e.$set(e.form,"leaveTime",t)},expression:"form.leaveTime"}}),e.form.leaveImage?i("img",{attrs:{src:e.form.leaveImage,alt:""},on:{click:function(t){return t.stopPropagation(),e.showImg(e.form.leaveImage)}}}):e._e()],1),i("el-form-item",{attrs:{prop:"isReception"}},[i("template",{slot:"label"},[e._v(" 接待状态 "),i("el-tooltip",{attrs:{placement:"bottom",effect:"light"}},[i("div",{staticStyle:{width:"300px"},attrs:{slot:"content"},slot:"content"},[e._v("您可以将接待状态从未接待改为已接待，专属顾问自动设为您的账号；当您在微信端确认后，接待状态也自动变更为已接待，专属顾问为您的账号")]),i("i",{staticClass:"el-icon-question"})])],1),i("el-radio-group",{attrs:{disabled:e.disableReception},on:{change:e.valueChange},model:{value:e.form.isReception,callback:function(t){e.$set(e.form,"isReception",t)},expression:"form.isReception"}},[i("el-radio",{attrs:{label:!1}},[e._v("未接待")]),i("el-radio",{attrs:{label:!0}},[e._v("已接待")])],1)],2),i("el-form-item",{attrs:{label:"专属顾问",prop:"adminId"}},[i("el-select",{attrs:{placeholder:"",disabled:e.disableReception||!1===e.form.isReception},model:{value:e.form.adminId,callback:function(t){e.$set(e.form,"adminId",t)},expression:"form.adminId"}},e._l(e.receptionList,(function(e){return i("el-option",{key:e.index,attrs:{label:e.name||"未填写",value:e.id}})})),1)],1),i("el-form-item",{attrs:{prop:"isAppointment"}},[i("template",{slot:"label"},[e._v(" 是否预约 "),i("el-tooltip",{attrs:{placement:"bottom",effect:"light"}},[i("div",{staticStyle:{width:"300px"},attrs:{slot:"content"},slot:"content"},[e._v("系统自动判断是否为预约订单，并自动匹配订单。如订单还未创建，您可以点击+前往订单页手动创建订单如订单已创建未匹配成功，您可以点击订单图标手动匹配订单")]),i("i",{staticClass:"el-icon-question"})])],1),i("el-radio",{attrs:{label:!1},model:{value:e.form.isAppointment,callback:function(t){e.$set(e.form,"isAppointment",t)},expression:"form.isAppointment"}},[e._v("否")]),i("el-radio",{attrs:{label:!0},model:{value:e.form.isAppointment,callback:function(t){e.$set(e.form,"isAppointment",t)},expression:"form.isAppointment"}},[e._v("是")])],2),e.form.memberName?i("el-form-item",{attrs:{label:"订单编号",prop:"orderSn"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.form.orderSn,callback:function(t){e.$set(e.form,"orderSn",t)},expression:"form.orderSn"}},[e.showOrderBtn?i("div",{staticClass:"input-append",attrs:{slot:"append"},slot:"append"},[i("el-button",{attrs:{type:"text"},on:{click:e.createOrder}},[i("i",{staticClass:"el-icon-circle-plus-outline",attrs:{title:"添加订单"}})]),i("el-button",{attrs:{type:"text"},on:{click:e.addOrder}},[i("i",{staticClass:"iconfont iconfont biz-icon-liebiaoshitu",attrs:{title:"选择订单"}})])],1):e._e()])],1):e._e(),e.form.memberName?i("el-form-item",{attrs:{label:"商品名称"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.form.productName,callback:function(t){e.$set(e.form,"productName",t)},expression:"form.productName"}})],1):e._e(),e.form.memberName?i("el-form-item",{attrs:{label:"订单金额"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}},[i("template",{slot:"append"},[e._v("元")])],2)],1):e._e(),e.form.memberName?i("el-form-item",{attrs:{label:"实付金额"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.form.amountPaid,callback:function(t){e.$set(e.form,"amountPaid",t)},expression:"form.amountPaid"}},[i("template",{slot:"append"},[e._v("元")])],2)],1):e._e()],1),i("create-member",{attrs:{visible:e.showCreateMember,"plate-number":e.form.plateNumber},on:{"update:visible":function(t){e.showCreateMember=t},created:e.memberCreated}}),i("query-member-list",{attrs:{visible:e.showMemberList},on:{"update:visible":function(t){e.showMemberList=t},confirm:e.memberSelected}}),i("create-order",{ref:"createOrder",attrs:{visible:e.showCreateOrder,userId:e.userId},on:{"update:visible":function(t){e.showCreateOrder=t},confirm:e.orderCreated}}),i("query-order-list",{attrs:{visible:e.showOrderList,memberId:e.userId},on:{"update:visible":function(t){e.showOrderList=t},confirm:e.memberSelected}})],1)},r=[],o=(i("d3b7"),i("f36f")),s=i("8330"),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"create-member",attrs:{"append-to-body":"",title:"创建会员",width:"500px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},open:e.clear}},[i("biz-grid",[i("el-form",{ref:"form",attrs:{size:"small","label-width":"80px",model:e.form,rules:e.rules,"v-loading":e.loading,"inline-message":!0}},[i("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[i("el-input",{attrs:{placeholder:"请输入手机号，如1888888888"},on:{blur:e.mobileBlur},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[i("el-input",{attrs:{placeholder:"请输入用户名，如1888888888"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),i("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[i("el-input",{attrs:{placeholder:"请输入昵称，如1888888888"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),i("el-form-item",{attrs:{label:"姓名",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入姓名，如张三"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),i("el-form-item",{attrs:{label:"性别",prop:"gender"}},[i("el-radio",{attrs:{label:"0"},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[e._v("男")]),i("el-radio",{attrs:{label:"1"},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[e._v("女")]),i("el-radio",{attrs:{label:"2"},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[e._v("保密")])],1),i("el-form-item",{attrs:{label:"车牌号"}},[i("el-input",{attrs:{disabled:""},model:{value:e.defaultCarInfo.plateNumber,callback:function(t){e.$set(e.defaultCarInfo,"plateNumber",t)},expression:"defaultCarInfo.plateNumber"}})],1),i("el-form-item",{attrs:{label:"品牌"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马",filterable:""},on:{change:e.handleBrandChange},model:{value:e.brand,callback:function(t){e.brand=t},expression:"brand"}},e._l(e.brandList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"系列"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系",filterable:""},on:{change:e.handleSeriesChange},model:{value:e.series,callback:function(t){e.series=t},expression:"series"}},e._l(e.seriesList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"车型"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系2016款"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.modeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"车辆识别代码"}},[i("el-input",{attrs:{placeholder:"请输入车辆识别代码，如1G1BL52P7TR115520"},model:{value:e.vin,callback:function(t){e.vin=t},expression:"vin"}})],1)],1)],1),i("biz-save-button",{attrs:{slot:"footer",operations:e.operations},on:{operate:e.operate},slot:"footer"})],1)},l=[],d=(i("b0c0"),i("0e5e")),c=i("c596"),p=i("1ab1"),m={name:"CreateMember",props:{visible:{type:Boolean,default:!1},plateNumber:{type:String,default:""}},data:function(){var e=this,t=function(t,i,a){i?(e.checkPass&&e.$refs.form.validateField("checkPass"),a()):a(new Error("请输入密码"))},i=function(t,i,a){e.checkPass?e.checkPass!==e.form.password?a(new Error("两次输入密码不一致")):a():a(new Error("请再次输入密码"))};return{dialogVisible:!1,loading:!1,brandList:[],seriesList:[],modeList:[],brand:"",series:"",type:"",vin:"",rules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{max:20,message:"不得超过20位",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"},{max:20,message:"不得超过20位",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"},{max:20,message:"不得超过20位",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:t,trigger:"blur"},{min:6,max:20,message:"密码应在6-20位之间",trigger:"blur"}],checkPass:[{validator:i,trigger:"blur",required:!0}],type:[{required:!0,message:"请输入车型",trigger:"blur"}],vin:[{required:!0,message:"请输入车辆识别代码",trigger:"blur"},{pattern:/^[A-Z0-9]{17}$/,message:"车辆识别代码格式错误",trigger:"blur"}]},form:this.getDefaultForm(),checkPass:"",operations:[{label:"创建",name:"save",type:"primary"}]}},computed:{defaultCarInfo:function(){return{plateNumber:this.plateNumber,brand:this.brand,series:this.series,type:this.type,vin:this.vin}}},created:function(){this.queryBrandList()},components:{BizGrid:o["a"],BizSaveButton:s["a"]},methods:{operate:function(e){this[e]()},mobileBlur:function(){this.form.id||this.form.nickname||this.$set(this.form,"nickname",this.form.mobile),this.form.id||this.form.userName||this.$set(this.form,"userName",this.form.mobile)},handleBrandChange:function(e){this.querySeriesList(e),this.$set(this.series,""),this.$set(this.type,"")},handleSeriesChange:function(e){this.queryTypeList(e),this.$set(this.type,"")},querySeriesList:function(e){var t=this;d["a"].querySeriesList({brand:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryBrandList:function(){var e=this;d["a"].queryBrandList({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;d["a"].queryTypeList({series:e,brand:this.brand},(function(e){t.modeList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.create()}))},create:function(){var e=this,t=Object.assign(this.form,this.defaultCarInfo,{defaultCarInfo:this.defaultCarInfo},{token:""});this.loading=!0,p["a"].post(c["f"].ReceptionMgmt.baseInfo.createMember,t).then((function(t){e.loading=!1,e.$message.success("操作成功");var i={memberId:t.member.id,memberName:t.member.name,memberCardSn:t.memberCard.sn,userRankName:t.memberCard.memberRank.name};e.$emit("created",Object.assign({},i))})).catch((function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))},clear:function(){var e=this;this.form=this.getDefaultForm(),this.checkPass="",this.$nextTick((function(){e.$refs.form.resetFields()}))},getDefaultForm:function(){return{userName:"",nickname:"",mobile:"",password:"123456",name:"",gender:"2"}},showMessage:function(e,t){this.$message({message:e,type:t,showClose:!0,duration:1e3})}},mounted:function(){},watch:{visible:function(e,t){this.dialogVisible=e},dialogVisible:function(e,t){e||this.$emit("update:visible",!1)}}},u=m,f=(i("4d03"),i("2877")),h=Object(f["a"])(u,n,l,!1,null,null,null),g=h.exports,b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-dialog-selector",{staticClass:"query-member-list",attrs:{selectionMode:"single",visibility:e.showDialog,tableData:e.tableData,pagination:e.pagination,filters:e.filters,selectionKeys:e.selectedItemKeys,loading:e.loading,isClear:!1},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.handleSizeChange,currentPageChange:e.handleCurrentChange,confirmed:e.confirm,filterDataChange:e.filterDataChange}},[i("el-table-column",{attrs:{label:"用户名"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"customer-info"},[i("img",{attrs:{src:t.row.head||e.defaultAvatar,alt:""}}),i("div",{staticClass:"wrapper"},[i("div",{staticClass:"title"},[e._v(e._s(t.row.userName))]),i("div",{staticClass:"gender"},["0"===t.row.gender?i("i",{staticClass:"male iconfont biz-icon-i-web-m"}):e._e(),"1"===t.row.gender?i("i",{staticClass:"female iconfont biz-icon-i-web-f"}):e._e(),"2"===t.row.gender?i("i",{staticClass:"none iconfont biz-icon-i-web-bm"}):e._e(),i("span",[e._v(e._s(t.row.mobile))])])])])]}}])}),i("el-table-column",{attrs:{label:"手机号",prop:"mobile"}}),i("el-table-column",{attrs:{label:"创建日期",prop:"createDate"}}),i("el-table-column",{attrs:{label:"状态",prop:"enableState",formatter:e.stateFormatter}}),i("el-table-column",{attrs:{label:"店铺名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",e._l(t.row.shops,(function(t,a){return i("div",{key:a,staticClass:"customer-info"},[e._v(e._s(t.name))])})),0)]}}])})],1)},v=[],y=(i("a9e3"),i("af3f")),_=i("624d"),I=i.n(_),w={name:"QueryMemberList",props:{visible:{type:Boolean,default:!1}},data:function(){return{loading:!1,defaultAvatar:I.a,showDialog:!1,tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},filters:[{label:"状态",value:"",type:"select",options:[{label:"全部",value:""},{label:"启用",value:"1"},{label:"停用",value:"0"}]},{type:"input",placeholder:"请输入姓名/手机号",value:""}],selectedItemKeys:[]}},components:{BizDialogSelector:y["a"]},methods:{clear:function(){this.selectedItemKeys=[],this.filters[0].value="",this.filters[1].value="",this.pagination.pageSize=20,this.pagination.currentPage=1,this.pagination.total=0},stateFormatter:function(e){return"0"===e.enableState?"停用":"启用"},shopFormatter:function(e){return e.shop?e.shop.name:""},filterDataChange:function(e){this.refresh()},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},confirm:function(e,t){if(this.selectedItemKeys=e,0!==t.length){var i={memberId:t[0].id,memberCardSn:t[0].memberCardSn,memberName:t[0].name,userRankName:t[0].userRankName};this.$emit("confirm",i)}},refresh:function(){var e=this,t={pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,searchValue:this.filters[1].value,state:this.filters[0].value};this.loading=!0,p["a"].get(c["f"].ReceptionMgmt.baseInfo.queryMemberList,t).then((function(t){e.tableData=t.content,e.pagination.total=Number(t.total)})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}},mounted:function(){},watch:{visible:function(e,t){e&&(this.showDialog=e,this.clear(),this.refresh())},showDialog:function(e,t){e||this.$emit("update:visible",!1)}}},x=w,S=(i("971b"),Object(f["a"])(x,b,v,!1,null,null,null)),C=S.exports,M=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:"创建订单",visible:e.dialogVisible,width:"600px","append-to-body":"","custom-class":"create-order",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"订单属性",prop:"orderType"}},[i("el-radio-group",{attrs:{size:"mini"},on:{change:e.orderTypeChange},model:{value:e.form.orderType,callback:function(t){e.$set(e.form,"orderType",t)},expression:"form.orderType"}},[i("el-radio",{attrs:{label:"0"}},[e._v("车品订单")]),i("el-radio",{attrs:{label:"2"}},[e._v("普通服务")]),i("el-radio",{attrs:{label:"9"}},[e._v("整车订单")]),i("el-radio",{attrs:{label:"10"}},[e._v("普通订单")])],1)],1),i("el-form-item",{attrs:{label:"商品",prop:"products"}},[i("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,size:"small",placeholder:"输入搜索的商品编号、名称",clearable:""},on:{select:e.handleSelect,input:e.listProduct},model:{value:e.form.products,callback:function(t){e.$set(e.form,"products",t)},expression:"form.products"}}),i("biz-list",{ref:"table",attrs:{tableData:e.tableData,loading:e.loading,height:e.height}},[i("el-table-column",{attrs:{prop:"fullName",label:"商品名称"}}),i("el-table-column",{attrs:{prop:"price",label:"商品价格"}}),i("el-table-column",{attrs:{prop:"quantity",label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input",{attrs:{type:"number",size:"mini",min:1},on:{input:e.quantityChange},model:{value:t.row.quantity,callback:function(i){e.$set(t.row,"quantity",i)},expression:"scope.row.quantity"}})],1)])}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作",type:"index"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteHandeler(t)}}},[e._v(" 删除 ")])],1)])}}])})],1)],1),i("el-form-item",{attrs:{label:"优惠券",prop:"couponCodeId"}},[i("el-select",{attrs:{filterable:"",placeholder:"请选择优惠券"},on:{change:e.couponChnage},model:{value:e.form.couponCodeId,callback:function(t){e.$set(e.form,"couponCodeId",t)},expression:"form.couponCodeId"}},e._l(e.couponList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.coupon.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"实付金额",prop:"amountPaid"}},[i("el-input",{attrs:{placeholder:"请输入实付金额"},model:{value:e.form.amountPaid,callback:function(t){e.$set(e.form,"amountPaid",t)},expression:"form.amountPaid"}})],1),"2"===e.form.orderType?i("el-form-item",{attrs:{label:"业务类型"}},[i("tag-select",{ref:"tagSelect",attrs:{tagList:e.tagList,bAddTag:!1,selectType:"order",selectedTags:e.selectedTags},on:{addSuccess:e.onAddSuccess}})],1):e._e()],1),i("biz-save-button",{attrs:{slot:"footer",operations:e.operations},on:{operate:e.operate},slot:"footer"})],1)},k=[],T=(i("4de4"),i("d81d"),i("a434"),i("4ec9"),i("b680"),i("3ca3"),i("ddb0"),i("2086")),D=i("7558"),$=i("18eb"),O={name:"CreateOrder",props:{userId:{type:Object,default:function(){return{id:""}}},visible:{type:Boolean,default:!1}},data:function(){return{tagList:[],selectedTags:[],loading:!1,loadingSelect:!1,dialogVisible:!1,subTotal:"",height:"385",tableData:[],restaurants:[],couponList:[],operations:[{label:"取消",name:"cancel"},{label:"确认已执行",name:"confirm",type:"primary"}],form:{products:"",couponCodeId:"",amountPaid:"",orderStatus:1,orderType:""},rules:{productId:[{required:!0,message:"请选择商品",trigger:"blur"}]},productList:[],productListMap:new Map}},components:{BizSaveButton:s["a"],BizList:D["a"],TagSelect:$["a"]},methods:{orderTypeChange:function(e){this.listProduct(),"2"===e&&this.getStoreTags()},onAddSuccess:function(){this.getStoreTags()},tagMapping:function(e){var t={refId:e,type:"7",tags:this.$refs.tagSelect?this.$refs.tagSelect.getCurSelectedTags():[]};p["a"].post(c["g"].systemSetting.tagMapping,t).then((function(e){console.log("映射成功")})).catch((function(e){console.log(e.errorMessage)}))},getStoreTags:function(){var e=this,t={categoryType:"订单/服务业务类型"};p["a"].get(c["g"].systemSetting.storeTags,t).then((function(t){console.log("订单/服务业务类型标签",t),e.tagList=t.content})).catch((function(e){console.log(e.errorMessage)}))},operate:function(e){this[e]()},cancel:function(){this.form=this.getOriginForm(),this.dialogVisible=!1},deleteHandeler:function(e){this.subTotal=(Number(this.subTotal)-Number(e.row.price)*Number(e.row.quantity)).toFixed(2),this.form.amountPaid=this.subTotal,this.tableData.splice(e.$index,1),this.form.couponCodeId="",this.getCoupon()},listProduct:function(e){var t=this;T["a"].listProduct({searchValue:this.form.products,orderType:this.form.orderType},(function(e){t.restaurants=e.content.map((function(e){return{fullName:e.fullName,sn:e.sn,price:e.price,quantity:"1",subTotal:e.price,productId:e.id,value:e.fullName}})),t.loading=!1}),(function(e){console.log(e),console.log("code错误")}))},querySearchAsync:function(e,t){var i=this.restaurants,a=e?i.filter(this.createStateFilter(e)):i;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t(a)}),300*Math.random())},createStateFilter:function(e){return function(e){return!0}},couponChnage:function(e){var t="";this.couponList.map((function(i){i.id===e&&(t=i.coupon.amount)}));var i=(Number(this.subTotal)-Number(t)).toFixed(2);this.$set(this.form,"amountPaid",i)},quantityChange:function(){var e=0;this.tableData.map((function(t){e+=Number(t.quantity)*Number(t.price)})),this.subTotal=e.toFixed(2),this.form.amountPaid=this.subTotal,this.getCoupon()},handleSelect:function(e){if(console.log("val",e),this.subTotal=(Number(this.subTotal)+Number(e.quantity)*Number(e.price)).toFixed(2),this.form.amountPaid=this.subTotal,0===this.tableData.length)return this.tableData.push(e),void this.getCoupon();for(var t=0;t<this.tableData.length;t++){if(this.tableData[t].productId===e.productId){this.tableData[t].quantity=Number(this.tableData[t].quantity)+1;break}this.tableData.push(e);break}this.getCoupon()},getCoupon:function(){var e=this,t=this.tableData.map((function(e){return{product:{id:e.id?"":e.productId},quantity:e.quantity||""}})),i={shopId:window.top.SHOP_ID||"",cartItems:t,userId:this.userId.id};this.couponList=[],p["a"].post("/admin/order/couponCodes.jhtml",i).then((function(t){e.couponList=t.content})).catch((function(t){console.log("errdata: ",t),e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},complete:function(){this.confirm("2")},confirm:function(e){var t=this,i=this.tableData.map((function(e){return{product:{id:e.id?"":e.productId},quantity:e.quantity||""}})),a={amountPaid:this.form.amountPaid,orderStatus:e||"1",couponCodeId:this.form.couponCodeId,cartItems:i,userId:this.userId.id};if(this.loading=!0,0===this.tableData.length)return this.$message.warning("请选择商品"),this.loading=!1,!1;p["a"].post(c["f"].ReceptionMgmt.baseInfo.createOrder,a).then((function(e){t.$message.success("操作成功"),t.$emit("confirm",Object.assign({},t.form,{orderId:e.data.id,productName:e.data.orderItems[0]?e.data.orderItems[0].name:"",orderSn:e.data.sn,amount:e.data.amount,amountPaid:e.data.amountPaid})),t.dialogVisible=!1,"2"===t.form.orderType&&t.tagMapping(e.data.id)})).catch((function(e){console.log("errdata: ",e),t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},getOriginForm:function(){return{tableData:[],products:"",couponCodeId:"",amountPaid:"",orderStatus:1,orderType:""}},showMessage:function(e,t){this.$message({message:e,type:t,showClose:!0,duration:1e3})}},mounted:function(){},watch:{visible:function(e,t){this.dialogVisible=e,this.tableData=[],this.subTotal="",this.getStoreTags()},dialogVisible:function(e,t){e||(this.$emit("update:visible",!1),this.tableData=[],this.subTotal="",this.couponList=[])}}},L=O,z=(i("7400"),Object(f["a"])(L,M,k,!1,null,null,null)),P=z.exports,R=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-dialog-selector",{staticClass:"query-order-list",attrs:{selectionMode:"single",visibility:e.showDialog,tableData:e.tableData,pagination:e.pagination,filters:e.filters,selectionKeys:e.selectedItemKeys,isClear:!1},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.handleSizeChange,currentPageChange:e.handleCurrentChange,confirmed:e.confirm,filterDataChange:e.filterDataChange}},[i("el-table-column",{attrs:{label:"订单编号",prop:"sn"}}),i("el-table-column",{attrs:{label:"订单时间",prop:"orderTime"}}),i("el-table-column",{attrs:{label:"订单分类",prop:"orderType",formatter:e.typeFormatter}}),i("el-table-column",{attrs:{label:"商品名称",formatter:e.productNameFormatter},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},e._l(t.row.orderItems,(function(t,a){return i("div",{key:a,staticClass:"biz-customcol"},[e._v(" "+e._s(t.fullName)+" ")])})),0)}}])}),i("el-table-column",{attrs:{label:"车牌号",prop:"plateNumber"}}),i("el-table-column",{attrs:{label:"订单金额",prop:"amount"}}),i("el-table-column",{attrs:{label:"实付金额",prop:"amountPaid"}})],1)},N=[],A={name:"QueryMemberList",props:{memberId:{type:Object,default:function(){return{id:""}}},visible:{type:Boolean,default:!1}},data:function(){return{showDialog:!1,tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},filters:[{type:"input",placeholder:"请输入订单编号",value:""}],selectedItemKeys:[]}},components:{BizDialogSelector:y["a"]},methods:{clear:function(){this.filters[0].value="",this.pagination.pageSize=20,this.pagination.currentPage=1,this.pagination.total=0},filterDataChange:function(e){this.refresh()},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},confirm:function(e,t){if(this.selectedItemKeys=e,0!==t.length){var i={orderId:t[0].id,orderSn:t[0].sn,productName:t[0].orderItems[0].fullName,amount:t[0].amount,amountPaid:t[0].amountPaid};this.$emit("confirm",i)}},refresh:function(){var e=this,t={memberId:this.memberId.id,pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,searchProperty:"sn",searchValue:this.filters[0].value};p["a"].get(c["f"].ReceptionMgmt.baseInfo.queryOrderList,t).then((function(t){e.tableData=t.content,e.pagination.total=Number(t.total)})).catch((function(t){e.$message.warning(t.errorMessage)}))},typeFormatter:function(e){var t={0:"普通商品订单",1:"充值订单",2:"服务订单",3:"一键救援预约",4:"维修预约",5:"保养预约",6:"置换预约",7:"贷款购车预约",8:"试乘试驾预约",9:"整车订单",10:"普通订单",13:"sim卡充值订单",14:"平台服务",15:"短信服务",99:"总计"};return t[e.orderType]||""},productNameFormatter:function(e){return e.orderItems[0].fullName}},mounted:function(){},watch:{memberId:function(e,t){this.selectedItemKeys=[]},visible:function(e,t){e&&(this.showDialog=e,this.clear(),this.refresh())},showDialog:function(e,t){e||this.$emit("update:visible",!1)}}},B=A,F=(i("0fd2"),Object(f["a"])(B,R,N,!1,null,null,null)),E=F.exports,U=i("c466"),j={name:"ReceptionMgmtBaseInfo",props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{dateNow:new Date,pickerOptions:{disabledDate:function(e){return!1}},showCreateMember:!1,showMemberList:!1,showCreateOrder:!1,showOrderList:!1,loading:!1,id:"",operations:[{label:"保存",name:"save",type:"primary",auth:["admin:reception.edit"]}],rules:{plateNumber:[{required:!0,message:"请输入车牌号",trigger:"blur"},{pattern:/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1,2}[A-Z0-9]{4,5}[A-Z0-9挂学警港澳]{1}$/,message:"车牌号格式不正确",trigger:"blur"}]},form:this.resetForm(),receptionList:[],disableReception:!1}},components:{BizGrid:o["a"],BizSaveButton:s["a"],CreateMember:g,QueryMemberList:C,CreateOrder:P,QueryOrderList:E},computed:{userId:function(){return{id:this.form.memberId||""}},disable:function(){return!!this.itemId.id},showOrderBtn:function(){return!!this.form.memberId}},methods:{operate:function(e){this[e]()},valueChange:function(e){e||(this.form.adminId="")},resetForm:function(){return{memberId:"",plateNumber:"",memberCardSn:"",memberName:"",userRankName:"",accessTime:U["a"].dateTimeConverter(new Date),leaveTime:U["a"].dateTimeConverter(new Date),accessImage:"",leaveImage:"",isReception:!1,adminId:"",adminName:"",isAppointment:!1,orderId:"",orderSn:"",productName:"",amount:"",amountPaid:""}},createMember:function(){this.form.plateNumber?this.showCreateMember=!0:this.$message.warning("请先填写车牌号")},memberCreated:function(e){var t=this;Object.assign(this.form,e),this.showCreateMember=!1;var i=Object.assign({},this.form,this.itemId);this.loading=!0,this.itemId.id?p["a"].put(c["f"].ReceptionMgmt.baseInfo.update,i).then((function(e){t.$emit("update"),t.$message.success("操作成功"),t.refresh()})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1})):p["a"].post(c["f"].ReceptionMgmt.baseInfo.create,i).then((function(e){t.$emit("update"),t.$message.success("操作成功"),t.id=e.data.id,t.refresh(e.data.id)})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},addMember:function(){this.showMemberList=!0},memberSelected:function(e){Object.assign(this.form,e)},createOrder:function(){this.$refs.createOrder.form={productId:"",amount:"0",amountPaid:"0"},this.showCreateOrder=!0},orderCreated:function(e){Object.assign(this.form,e),this.form.isReception=!0,this.showOrderList=!1},addOrder:function(){this.showOrderList=!0},clear:function(){this.showCreateMember=!1,this.showMemberList=!1,this.showCreateOrder=!1,this.showOrderList=!1,this.disableReception=!1,this.form=this.resetForm(),this.$refs.form.resetFields()},checkIfAdmin:function(){if(this.form.adminId){for(var e=!0,t=0;t<this.receptionList.length;t++)this.receptionList[t].id===String(this.form.adminId)&&(e=!1);e&&this.receptionList.unshift({id:this.form.adminId,name:this.form.adminName})}},save:function(){var e=this;this.$refs.form.validate((function(t){return!!t&&(e.form.accessTime&&e.form.leaveTime&&e.form.accessTime>e.form.leaveTime?(e.$message.warning("到店时间不能晚于离店时间"),!1):void e.submit())}))},submit:function(){this.itemId.id||this.id||this.form.id?this.update():this.create()},update:function(){var e=this;this.itemId.id||(this.itemId.id=this.id||this.form.id);var t=Object.assign({},this.form,this.itemId);this.loading=!0,p["a"].put(c["f"].ReceptionMgmt.baseInfo.update,t).then((function(t){e.$message.success("操作成功"),e.$emit("update"),e.refresh()})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},create:function(){var e=this,t=Object.assign({},this.form);this.loading=!0,p["a"].post(c["f"].ReceptionMgmt.baseInfo.create,t).then((function(t){e.$message.success("操作成功"),e.$emit("update")})).catch((function(t){e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},refresh:function(e){var t=this;this.loading=!0;var i=this.itemId.id||e;p["a"].get(c["f"].ReceptionMgmt.baseInfo.query,{id:i}).then((function(e){t.loading=!1,t.form=Object.assign(t.resetForm(),e.data),t.form.adminId=String(t.form.adminId),e.data.accessTime||(t.form.accessTime=""),e.data.leaveTime||(t.form.leaveTime=""),e.data.order&&(t.form.productName=e.data.order.orderItems[0].fullName,t.form.amount=e.data.order.amount,t.form.amountPaid=e.data.order.amountPaid),t.disableReception=!!t.form.isReception,t.id="",t.checkIfAdmin()})).catch((function(e){t.loading=!1,console.log("ERR_REFRESH: ",e),t.$message.warning(e.errorMessage)}))},showImg:function(e){this.$emit("show-image",e)},queryReceptionList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i={roleType:"reception",pageSize:"1000",shopId:window.top.SHOP_ID||t||""};p["a"].get(c["f"].ReceptionMgmt.baseInfo.queryReceptionList,i).then((function(t){e.receptionList=t.data,e.checkIfAdmin()})).catch((function(t){e.$message.warning(t.errorMessage)}))},showMessage:function(e,t){this.$notify({message:e,type:t,showClose:!0})}},mounted:function(){this.queryReceptionList(),this.itemId.id&&this.refresh()},watch:{itemId:function(e,t){this.clear(),""!==e.id&&this.refresh()}}},q=j,V=(i("2a92"),Object(f["a"])(q,a,r,!1,null,null,null));t["a"]=V.exports},baa5:function(e,t,i){var a=i("23e7"),r=i("e58c");a({target:"Array",proto:!0,forced:r!==[].lastIndexOf},{lastIndexOf:r})},bbfa:function(e,t,i){},bc02:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-log-info"},["在线支付"!==e.paymentMethodName?i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v(" 待商家确认 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v(" 商家已确认 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()}))],2)]),i("el-step",{attrs:{title:"执行",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,a){return i("div",{key:a},["6"===t.state?i("div",[i("p",[e._v(" 自动派单 ")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v(" 拒绝理由："+e._s(t.refuseRecord.reason)+" ")])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v(" 自动派单 ")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v(" 用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile)+" ")]):e._e(),t.dispatchRecord?i("div",[e._v(" "+e._s(t.dispatchRecord.createDate)+" ")]):e._e(),t.refuseRecord?i("div",[e._v(" "+e._s(t.refuseRecord.reason)+" ")]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v(" 拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks)+" ")]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(" "+e._s(t.member.nickname)+"已出发 ")]):e._e(),i("p",[e._v(" "+e._s(t.location)+" ")]),i("p",[e._v(" "+e._s(t.happenDate)+" ")])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(" "+e._s(t.member.nickname)+"已到达 ")]):e._e(),i("p",[e._v(" "+e._s(t.location)+" ")]),i("p",[e._v(" "+e._s(t.happenDate)+" ")])]):e._e(),"3"===t.state?i("div",[i("p",[e._v(" 完成救援任务 ")]),i("p",[e._v(" "+e._s(t.happenDate)+" ")])]):e._e(),"4"===t.state?i("div",[i("p",[e._v(" 取消救援任务 ")]),i("p",[e._v(" "+e._s(t.happenDate)+" ")])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v(" 订单已执行 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()})),e._l(e.orderLogs,(function(t){return"shipping"===t.type?i("div",{key:t.id},[i("p",[e._v(" 订单已执行 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")]),i("p",[e._v(" 物流公司："+e._s(e.deliveryCorp)+" ")]),i("p",[e._v(" 物流单号："+e._s(e.trackingNo)+" ")]),i("p",[e._v(" 收货人："+e._s(e.operator)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")])],1),e.shippings&&e.shippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.shippings.shippingTraces,(function(t,a){return i("div",{key:a,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.shippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()]):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"payment"===t.type?i("div",{key:t.id},[i("p",[e._v(" 买家已付款 ")]),e.payments&&2===e.payments.length?i("div",[i("p",[e._v(" 订金已支付 ")]),i("p",[e._v(" "+e._s(e.payments[0].paymentDate)+" ")]),i("p",[e._v(" 买家已付款 ")]),i("p",[e._v(" "+e._s(e.payments[0].paymentDate)+" ")]),i("p",[e._v(" 尾款已支付 ")]),i("p",[e._v(" "+e._s(e.payments[1].paymentDate)+" ")]),i("p",[e._v(" 买家已付款 ")]),i("p",[e._v(" "+e._s(e.payments[1].paymentDate)+" ")]),i("p",[e._v(" 实付金额："+e._s(e.amountpaid)+" ")])]):i("div",[i("p",[e._v(" "+e._s(t.createTime)+" ")]),i("p",[e._v(" 付款金额：￥"+e._s(e.amount)+" ")]),i("p",[e._v(" 支付方式："+e._s(e.paymentMethodName)+" ")]),i("p",[e._v(" 付款方式："+e._s(e.paymentType)+" ")]),i("p",[e._v(" 手续费："+e._s(e.fee)+" ")]),i("p",[e._v(" 交易号："+e._s(e.sn)+" ")])])]):e._e()})),0)]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v(" 交易完成 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v(" 买家已评价 ")]),e._l(e.reviews,(function(t,a){return i("div",{key:a},["0"===t.reviewType?i("div",[i("p",[e._v(" "+e._s(t.happenDate)+" ")]),i("p",[e._v(" 商品："+e._s(t.product.name)+" ")]),i("p",[e._v(" 评分："+e._s(t.score)+"分 ")]),i("p",[e._v(" 评语："+e._s(t.content)+" ")]),e._l(t.images,(function(t,a){return i("div",{key:a,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v(" 店铺评分 ")]),i("p",[e._v(" 服务态度："+e._s(t.serviceAttitude)+"分 ")]),i("p",[e._v(" 服务速度："+e._s(t.serviceSpeed)+"分 ")]),i("p",[e._v(" 专业技能："+e._s(t.professional)+"分 ")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v(" 订单已关闭 ")]),i("p",[e._v(" 关闭理由："+e._s(t.content)+" ")]),i("p",[e._v(" 备注："+e._s(t.memo)+" ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()})),0)]):e._e()],1):e._e(),"在线支付"===e.paymentMethodName?i("el-steps",{attrs:{direction:"vertical",space:"auto"}},[i("el-step",{attrs:{title:"新订单",status:"1"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e._l(e.orderLogs,(function(t){return"create"===t.type?i("div",{key:t.id},[i("p",[e._v(" 待商家确认 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()})),e._l(e.orderLogs,(function(t){return"confirm"===t.type?i("div",{key:t.id},[i("p",[e._v(" 商家已确认 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()}))],2)]),i("el-step",{attrs:{title:"付款",status:"3"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"payment"===t.type?i("div",{key:t.id},[i("p",[e._v(" 买家已付款 ")]),e.payments&&2===e.payments.length?i("div",[i("p",[e._v(" 订金已支付 ")]),i("p",[e._v(" "+e._s(e.payments[0].paymentDate)+" ")]),i("p",[e._v(" 支付方式："+e._s(e.payments[0].paymentMethod)+" ")]),i("p",[e._v(" 买家已付款 ")]),i("p",[e._v(" 付款方式："+e._s(e.payments[0].paymentType)+" ")]),i("p",[e._v(" "+e._s(e.payments[0].paymentDate)+" ")]),i("p",[e._v(" 尾款已支付 ")]),i("p",[e._v(" 支付方式："+e._s(e.payments[1].paymentMethod)+" ")]),i("p",[e._v(" "+e._s(e.payments[1].paymentDate)+" ")]),i("p",[e._v(" 买家已付款 ")]),i("p",[e._v(" 付款方式："+e._s(e.payments[1].paymentType)+" ")]),i("p",[e._v(" "+e._s(e.payments[1].paymentDate)+" ")]),i("p",[e._v(" 实付金额："+e._s(e.amountpaid)+" ")])]):i("div",[i("p",[e._v(" "+e._s(t.createTime)+" ")]),i("p",[e._v(" 付款金额：￥"+e._s(e.amount)+" ")]),i("p",[e._v(" 支付方式："+e._s(e.paymentMethodName)+" ")]),i("p",[e._v(" 付款方式："+e._s(e.paymentType)+" ")]),i("p",[e._v(" 手续费："+e._s(e.fee)+" ")]),i("p",[e._v(" 交易号："+e._s(e.sn)+" ")])])]):e._e()})),0)]),i("el-step",{attrs:{title:"执行",status:"2"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},[e.memberRescueStates&&e.memberRescueStates.length>0?i("div",[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dispathButton,expression:"!dispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.dispath(e.orderId)}}},[e._v("派单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.redispathButton,expression:"!redispathButton"}],attrs:{size:"small"},on:{click:function(t){return e.rdispath(e.orderId)}}},[e._v("重新派单")])],1),i("div",[e.cbp_tmlabel?i("div",{staticClass:"cbp_tmlabel",attrs:{id:"cbp_tmlabel"}},[i("p",{staticStyle:{color:"#bababa"}},[e._v(" 任务分派给 "),i("el-select",{model:{value:e.workerId,callback:function(t){e.workerId=t},expression:"workerId"}},e._l(e.workers,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]):e._e()]),e._l(e.memberRescueStates,(function(t,a){return i("div",{key:a},["6"===t.state?i("div",[i("p",[e._v(" 自动派单 ")]),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v(" 拒绝理由："+e._s(t.refuseRecord.reason)+" ")])]):e._e(),t.refuseRecord?i("div",[i("p",{staticStyle:{color:"#c60007"}},[e._v(" 自动派单 ")])]):e._e()]):e._e(),"7"===t.state?i("div",[e._v(" 任务发给 "),t.dispatchRecord?i("div",[e._v(" 用户："+e._s(t.dispatchRecord.worker.nickname)+"电话："+e._s(t.dispatchRecord.worker.mobile)+" ")]):e._e(),t.dispatchRecord?i("div",[e._v(" "+e._s(t.dispatchRecord.createDate)+" ")]):e._e(),t.refuseRecord?i("div",[e._v(" "+e._s(t.refuseRecord.reason)+" ")]):e._e()]):e._e(),"5"===t.state?i("div",[e._v(" 已拒绝 "),t.refuseRecord?i("p",{staticStyle:{color:"#c60007"}},[e._v(" 拒绝理由："+e._s(t.refuseRecord.reason)+e._s(t.refuseRecord.remarks)+" ")]):e._e()]):e._e(),"1"===t.state?i("div",[t.member?i("p",[e._v(" "+e._s(t.member.nickname)+"已出发 ")]):e._e(),i("p",[e._v(" "+e._s(t.location)+" ")]),i("p",[e._v(" "+e._s(t.happenDate)+" ")])]):e._e(),"2"===t.state?i("div",[t.member?i("p",[e._v(" "+e._s(t.member.nickname)+"已到达 ")]):e._e(),i("p",[e._v(" "+e._s(t.location)+" ")]),i("p",[e._v(" "+e._s(t.happenDate)+" ")])]):e._e(),"3"===t.state?i("div",[i("p",[e._v(" 完成救援任务 ")]),i("p",[e._v(" "+e._s(t.happenDate)+" ")])]):e._e(),"4"===t.state?i("div",[i("p",[e._v(" 取消救援任务 ")]),i("p",[e._v(" "+e._s(t.happenDate)+" ")])]):e._e()])}))],2):e._e(),e._l(e.orderLogs,(function(t){return"service"===t.type?i("div",{key:t.id},[i("p",[e._v(" 订单已执行 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()})),e._l(e.orderLogs,(function(t){return"shipping"===t.type?i("div",{key:t.id},[i("p",[e._v(" 订单已执行 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")]),i("p",[e._v(" 物流公司："+e._s(e.deliveryCorp)+" ")]),i("p",[e._v(" 物流单号："+e._s(e.trackingNo)+" ")]),i("p",[e._v(" 收货人："+e._s(e.operator)+" "),i("el-button",{attrs:{size:"small"},on:{click:e.devProcess}},[e._v("物流进度")])],1),e.shippings&&e.shippings.shippingTraces?i("div",{ref:"devProcess",refInFor:!0,staticClass:"devProcess"},[e._l(e.shippings.shippingTraces,(function(t,a){return i("div",{key:a,staticClass:"shippingTrace"},[i("li",{attrs:{calss:"station"}},[e._v(e._s(t.station))]),i("li",{staticClass:"happenTime"},[e._v(e._s(t.happenTime))])])})),0===e.shippings.shippingTraces.length?i("div",{style:e.styleObject}):e._e()],2):e._e()]):e._e()}))],2)]),i("el-step",{attrs:{title:"完成",status:"4"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"complete"===t.type?i("div",{key:t.id},[i("p",[e._v(" 交易完成 ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()})),0)]),e.isReview?i("el-step",{attrs:{title:"评价",status:"5"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"review"===t.type?i("div",{key:t.id},[i("p",[e._v(" 买家已评价 ")]),e._l(e.reviews,(function(t,a){return i("div",{key:a},["0"===t.reviewType?i("div",[i("p",[e._v(" "+e._s(t.happenDate)+" ")]),i("p",[e._v(" 商品："+e._s(t.product.name)+" ")]),i("p",[e._v(" 评分："+e._s(t.score)+"分 ")]),i("p",[e._v(" 评语："+e._s(t.content)+" ")]),e._l(t.images,(function(t,a){return i("div",{key:a,staticStyle:{display:"inline"}},[i("img",{attrs:{src:t,width:"50"},on:{click:function(i){return e.enlarge(t)}}})])}))],2):e._e(),"1"===t.reviewType?i("div",[i("p",[e._v(" 店铺评分 ")]),i("p",[e._v(" 服务态度："+e._s(t.serviceAttitude)+"分 ")]),i("p",[e._v(" 服务速度："+e._s(t.serviceSpeed)+"分 ")]),i("p",[e._v(" 专业技能："+e._s(t.professional)+"分 ")])]):e._e()])}))],2):e._e()})),0)]):e._e(),e.isCancel?i("el-step",{attrs:{title:"关闭",status:"6"===e.active?"finish":"wait "}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.orderLogs,(function(t){return"cancel"===t.type?i("div",{key:t.id},[i("p",[e._v(" 订单已关闭 ")]),i("p",[e._v(" 关闭理由："+e._s(t.content)+" ")]),i("p",[e._v(" 备注："+e._s(t.memo)+" ")]),i("p",[e._v(" "+e._s(t.createTime)+" ")])]):e._e()})),0)]):e._e()],1):e._e(),i("el-dialog",{attrs:{title:"",visible:e.outerVisible,"append-to-body":""},on:{"update:visible":function(t){e.outerVisible=t}}},[i("img",{attrs:{src:e.larImg,width:"100%"}})])],1)},r=[],o=(i("4160"),i("a9e3"),i("159b"),i("f36f")),s=i("e42c"),n=i("f260"),l=i.n(n),d={name:"NewsMgmt",props:{itemId:{type:String},open:{type:Boolean,default:function(){return!1}},paymentMethodName:{type:String,default:"在线支付"}},data:function(){return{orderItems:[],loading:!1,outerVisible:!1,active:"",larImg:"",orderLogs:[],reviews:[],shippings:"",payments:[],memberRescueStates:[],paymentMethodNameReal:"",type:"",amount:"",amountpaid:"",paymentType:"",latestMemberRescueState:"",workers:[],sn:"",consignee:"",fee:"",operator:"",trackingNo:"",deliveryCorp:"",orderId:"",workerId:"",dispathButton:!1,redispathButton:!1,cbp_tmlabel:!1,imgStyle:"",imageValue:"",currentState:"",preState:"",create:!1,cancel:!1,confirm:!1,service:!1,shipping:!1,payment:!1,complete:!1,review:!1,isCreate:!1,isConfirm:!1,isService:!1,isPayment:!1,isComplete:!1,isReview:!1,isCancel:!1}},components:{BizGrid:o["a"]},watch:{itemId:function(e){this.getList()},open:function(e){this.itemId&&this.getList()}},created:function(){this.getList()},computed:{styleObject:function(){return{height:"200px",top:0,bottom:0,left:0,right:0,margin:"auto",background:"url("+l.a+") 50% 50% / 200px no-repeat"}}},methods:{operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.getList()},devProcess:function(){"新悦物流"===this.deliveryCorp&&this.$emit("logistics",this.orderItems[0].product.vins[0].number),"block"===this.$refs.devProcess[0].style.display?this.$refs.devProcess[0].style.display="none":this.$refs.devProcess[0].style.display="block"},enlarge:function(e){this.larImg=e,this.outerVisible=!0},getList:function(e){var t=this;this.loading=!0;var i={orderId:e||this.itemId};s["a"].viewOrderlogs(i,(function(e){t.orderItems=e.order.orderItems,t.loading=!1,t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.payments=e.payments,e.payments&&e.payments.length>1?t.amountpaid=Number(e.payments[0].amount)+Number(e.payments[1].amount):t.amountpaid="",t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,t.shippings=e.shippings&&e.shippings[0],e.payments&&(t.paymentType=e.payments.length>0?e.payments[0].paymentType:"",t.amount=e.payments.length>0?e.payments[0].amount:"",t.fee=e.payments.length>0?e.payments[0].fee:"",t.sn=e.payments.length>0?e.payments[0].sn:""),e.shippings&&(t.deliveryCorp=e.shippings.length>0?e.shippings[0].logistics:"",t.trackingNo=e.shippings.length>0?e.shippings[0].expressSn:"",t.operator=e.shippings.length>0?e.shippings[0].consignee:""),t.consignee=e.order.consignee||"",t.currentState=e.orderLogs[e.orderLogs.length-1].type,e.orderLogs.length>1&&(t.preState=e.orderLogs[e.orderLogs.length-2].type),"create"===t.currentState||"confirm"===t.currentState?t.active="1":"service"===t.currentState||"shipping"===t.currentState?t.active="2":"payment"===t.currentState?t.active="3":"complete"===t.currentState?t.active="4":"review"===t.currentState?t.active="5":"cancel"===t.currentState&&(t.active="6"),!t.latestMemberRescueState||"0"!==t.latestMemberRescueState.state&&"1"!==t.dispathType?(t.dispathButton=!0,t.cbp_tmlabel=!1):(t.dispathButton=!1,t.cbp_tmlabel=!0),t.latestMemberRescueState&&"3"!==t.latestMemberRescueState.state&&"8"!==t.latestMemberRescueState.state&&"9"!==t.latestMemberRescueState.state&&"4"!==t.latestMemberRescueState.state&&"0"!==t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0,t.isCreate=!1,t.isPayment=!1,t.isComplete=!1,t.isReview=!1,t.isCancel=!1,t.isService=!1,e.orderLogs.forEach((function(e){"create"===e.type&&(t.isCreate=!0),"payment"===e.type&&(t.isPayment=!0),"complete"===e.type&&(t.isComplete=!0),"review"===e.type&&(t.isReview=!0),"cancel"===e.type&&(t.isCancel=!0),"service"===e.type&&(t.isService=!0),"shipping"===e.type&&(t.isService=!0),"confirm"===e.type&&(t.isService=!0)}))}),(function(e){console.log(e)}))},getRescueList:function(e){var t=this;this.loading=!0;var i={orderId:e||this.itemId};s["a"].rescueOrderLogs(i,(function(e){t.loading=!1,t.orderLogs=e.orderLog,t.reviews=e.reviews,t.payments=e.payments,e.payments&&e.payments.length>1?t.amountpaid=Number(e.payments[0].amount)+Number(e.payments[1].amount):t.amountpaid="",t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,t.shippings=e.order.shippings&&e.order.shippings[0],e.order.payments&&(t.paymentType=e.order.payments.length>0?e.order.payments[0].paymentType:"",t.amount=e.order.payments.length>0?e.order.payments[0].amount:"",t.fee=e.order.payments.length>0?e.order.payments[0].fee:"",t.sn=e.order.payments.length>0?e.order.payments[0].sn:""),e.order.shippings&&(t.deliveryCorp=e.order.shippings.length>0?e.order.shippings[0].logistics:"",t.trackingNo=e.order.shippings.length>0?e.order.shippings[0].expressSn:"",t.operator=e.order.shippings.length>0?e.order.shippings[0].consignee:""),t.consignee=e.order.consignee||"",t.currentState=e.orderLogs[e.orderLogs.length-1].type,e.orderLogs.length>1&&(t.preState=e.orderLogs[e.orderLogs.length-2].type),"create"===t.currentState||"confirm"===t.currentState?t.active="1":"service"===t.currentState||"shipping"===t.currentState?t.active="2":"payment"===t.currentState?t.active="3":"complete"===t.currentState?t.active="4":"review"===t.currentState?t.active="5":"cancel"===t.currentState&&(t.active="6"),"0"===t.latestMemberRescueState.state||"1"===t.dispathType?(t.dispathButton=!1,t.cbp_tmlabel=!0):(t.dispathButton=!0,t.cbp_tmlabel=!1),"3"!==t.latestMemberRescueState.state&&"8"!==t.latestMemberRescueState.state&&"9"!==t.latestMemberRescueState.state&&"4"!==t.latestMemberRescueState.state&&"0"!==t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0,t.isCreate=!1,t.isPayment=!1,t.isComplete=!1,t.isReview=!1,t.isCancel=!1,t.isService=!1,e.orderLogs.forEach((function(e){"create"===e.type&&(t.isCreate=!0),"payment"===e.type&&(t.isPayment=!0),"complete"===e.type&&(t.isComplete=!0),"review"===e.type&&(t.isReview=!0),"cancel"===e.type&&(t.isCancel=!0),"service"===e.type&&(t.isService=!0),"shipping"===e.type&&(t.isService=!0),"confirm"===e.type&&(t.isService=!0)}))}),(function(e){console.log(e)}))},dispath:function(e){var t=this;this.id=this.itemId||"",s["a"].rescuerDispath({orderId:this.id,workerId:this.workerId},(function(e){s["a"].rescueOrderLogs({orderId:t.id,dispathType:"0"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,"0"===t.latestMemberRescueState.state||"7"===t.latestMemberRescueState.state?t.redispathButton=!1:t.redispathButton=!0}),(function(e){t.$message.warning(e.errorMessage),console.log(e)}))}),(function(e){console.log(e)}))},rdispath:function(e){var t=this;this.id=this.itemId||"",s["a"].rescueOrderLogs({orderId:this.id,dispathType:"1"},(function(e){t.orderLogs=e.orderLogs,t.reviews=e.reviews,t.memberRescueStates=e.memberRescueStates,t.latestMemberRescueState=e.latestMemberRescueState,t.workers=e.workers,t.orderId=e.orderId,t.dispathType=e.dispathType,"0"===t.latestMemberRescueState.state||"1"===t.dispathType?t.dispathButton=!1:t.dispathButton=!0,t.cbp_tmlabel=!0}),(function(e){console.log(e)}))}}},c=d,p=(i("cc34"),i("2877")),m=Object(p["a"])(c,a,r,!1,null,null,null);t["a"]=m.exports},bd50:function(e,t,i){},bea5:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"membership-mgmt__vehicle-info"},[e.isEdit?i("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}}):e._e(),i("el-table",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"85%",size:"small"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[i("biz-empty-table",{attrs:{slot:"empty"},slot:"empty"}),i("el-table-column",{attrs:{prop:"plateNumber",label:"车牌号"}}),i("el-table-column",{attrs:{prop:"type",label:"车型"}}),i("el-table-column",{attrs:{prop:"engineNumber",label:"发动机号"}}),i("el-table-column",{attrs:{prop:"vin",label:"车辆识别代号","min-width":"120"}}),e.ishandler?i("el-table-column",{attrs:{prop:"title",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEdit?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.rowDeleteClickHandler(i,t.row)}}},[e._v(" 删除 ")]):e._e(),e.isEdit?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleRowClick(i,t.row)}}},[e._v(" 编辑 ")]):e._e()]}}],null,!1,1370604828)}):e._e()],1),i("el-card",{directives:[{name:"show",rawName:"v-show",value:e.showForm,expression:"showForm"}],staticClass:"box-card",staticStyle:{"margin-top":"20px"}},[e.isEdit?i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.handleOperate}}):e._e(),e.isEdit?i("vehicle-base-info-content",{ref:"baseInfo",attrs:{itemId:e.formId,memberId:e.itemId},on:{operationSuccess:e.handleOperationSuccess}}):e._e()],1)],1)},r=[],o=(i("4160"),i("d3b7"),i("159b"),i("5530")),s=i("8330"),n=i("04d3"),l=i("f36f"),d=i("dcc1"),c=i("c596"),p=i("1ab1"),m=i("3193"),u={data:{loading:!1,ishandler:!0,show:!0,operations:[{label:"新增",name:"add",type:"primary"}]},methods:{getQueryParams:function(){return{shopId:window.top.SHOP_ID||"",userId:this.itemId.id,pageSize:100,pageNumber:1}},query:function(){var e=this;this.loading=!0,p["a"].get(c["o"].vehicleInfo.list,this.getQueryParams()).then((function(t){e.tableData=t.ownCars,e.showForm=!1,e.show=!0})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},add:function(){this.show=!1,this.initForm()},delete:function(){if(this.selections&&this.selections.length>0){var e=[];this.selections.forEach((function(t){e.push(t.id)})),this.deleteItem(e)}else this.$message("请选择一条数据")}},events:{handleOperate:function(e){this[e]()}}},f={data:{tableData:[],selections:[]},methods:{deleteItem:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var i={ids:e};p["a"].post(c["o"].vehicleInfo.delete,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))}},events:{rowDeleteClickHandler:function(e,t){e.stopPropagation(),this.deleteItem([t.id])},handleRowClick:function(e){this.initForm(e)},handleSelectionChange:function(e){this.operations[1].disabled=!0,e.length>0&&(this.operations[1].disabled=!1),this.selections=e}}},h={data:{showForm:!1,formId:{id:""},formOperations:[{label:"取消",name:"cancelForm"},{label:"保存",name:"saveForm",type:"primary"}]},methods:{initForm:function(e){this.formId=e?{id:e.id}:{id:""},this.showForm=!0},cancelForm:function(){this.showForm=!1,this.show=!0},saveForm:function(){var e=this,t=this.$refs.baseInfo.getSaveParams();t.userId=this.itemId.id,t.carSales=this.$refs.baseInfo.getSaveParams().carSalesData,t.carQualityAssurance=this.$refs.baseInfo.getSaveParams().carQualityAssurance,t.car={id:t.id,plateNumber:t.plateNumber,brand:t.brand,series:t.series,type:t.type,shop:t.shop,state:t.state,onTime:t.onTime,isCV:t.isCV,trafficControl:t.trafficControl,remarks:t.remarks,drivingRange:t.drivingRange,carshipId:t.carshipId,vin:t.vin,engineNumber:t.engineNumber,bodyColor:t.bodyColor,plateColor:t.plateColor,fuelGrade:t.fuelGrade,transmissionType:t.transmissionType,dischargeStandard:t.dischargeStandard,productionTime:t.productionTime,terminals:t.terminals,carLicense:t.carLicense},this.formId.id&&p["a"].post(c["o"].vehicleInfo.update,t).then((function(t){e.$message.success("保存成功"),e.query()})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1})),!this.formId.id&&p["a"].post(c["o"].vehicleInfo.add,t).then((function(t){e.$message.success("保存成功"),e.query()})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))}},events:{handleOperationSuccess:function(){this.query()}}},g={name:"MembershipMgmtVehicleInfo",components:{BizHeader:n["d"],BizGrid:l["a"],BizSaveButton:s["a"],VehicleBaseInfoContent:m["a"],BizEmptyTable:d["a"]},props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}},alertId:{type:Object,default:function(){return{id:""}}}},data:function(){return Object(o["a"])(Object(o["a"])(Object(o["a"])({},u.data),f.data),h.data)},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},u.methods),u.events),f.methods),f.events),h.methods),h.events),watch:{itemId:function(e,t){e.id&&this.query()},alertId:function(e){e.id&&this.getCallbackInfo(e)}},created:function(){this.itemId.id&&this.query()}},b=g,v=(i("9de1"),i("2877")),y=Object(v["a"])(b,a,r,!1,null,null,null);t["a"]=y.exports},bee2:function(e,t,i){"use strict";function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}i.d(t,"a",(function(){return r}))},c162:function(e,t,i){},c20d:function(e,t,i){var a=i("da84"),r=i("58a8").trim,o=i("5899"),s=a.parseInt,n=/^[+-]?0[Xx]/,l=8!==s(o+"08")||22!==s(o+"0x16");e.exports=l?function(e,t){var i=r(String(e));return s(i,t>>>0||(n.test(i)?16:10))}:s},c2cb:function(e,t,i){"use strict";var a=i("fd29"),r=i.n(a);r.a},c365:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vehicle-mgmt-vehicle__people-picker"},[a("el-input",{attrs:{placeholder:"请选择用户",readonly:"readonly"},model:{value:e.value[e.contentField],callback:function(t){e.$set(e.value,e.contentField,t)},expression:"value[contentField]"}},[a("el-button",{staticClass:"el-icon-circle-plus-outline",staticStyle:{color:"#fa9f33",padding:"10px"},attrs:{slot:"append",type:"primary"},on:{click:e.addMember},slot:"append"}),a("el-button",{staticClass:"iconfont biz-icon-man",staticStyle:{padding:"2px 10px",color:"#fa9f33"},attrs:{slot:"append",type:"primary"},on:{click:e.clickHandler},slot:"append"})],1),a("el-dialog",{attrs:{title:"添加所有者",visible:e.dialogVisible,width:"50%",appendToBody:!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"dialogFormModel",attrs:{model:e.formMember,"label-width":"120px",size:"small",rules:e.dialogRules,"inline-message":!0}},[a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入手机号，如1888888888"},on:{blur:e.mobileBlur},model:{value:e.formMember.mobile,callback:function(t){e.$set(e.formMember,"mobile",t)},expression:"formMember.mobile"}})],1),a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{attrs:{placeholder:"请输入用户名，如1888888888"},model:{value:e.formMember.userName,callback:function(t){e.$set(e.formMember,"userName",t)},expression:"formMember.userName"}})],1),a("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请输入昵称，如1888888888"},model:{value:e.formMember.nickname,callback:function(t){e.$set(e.formMember,"nickname",t)},expression:"formMember.nickname"}})],1),a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入姓名，如张三"},model:{value:e.formMember.name,callback:function(t){e.$set(e.formMember,"name",t)},expression:"formMember.name"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入密码"},model:{value:e.formMember.password,callback:function(t){e.$set(e.formMember,"password",t)},expression:"formMember.password"}})],1),a("el-form-item",{attrs:{label:"性别",prop:"gender"}},[a("el-radio-group",{model:{value:e.formMember.gender,callback:function(t){e.$set(e.formMember,"gender",t)},expression:"formMember.gender"}},[a("el-radio",{attrs:{label:"0"}},[e._v("男")]),a("el-radio",{attrs:{label:"1"}},[e._v("女")]),a("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),a("el-form-item",{attrs:{label:"车牌号"}},[a("el-input",{attrs:{placeholder:"请输入车牌号，如浙12345"},model:{value:e.formMember.defaultCarInfo.plateNumber,callback:function(t){e.$set(e.formMember.defaultCarInfo,"plateNumber",t)},expression:"formMember.defaultCarInfo.plateNumber"}})],1),a("el-form-item",{attrs:{label:"品牌"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马",filterable:""},on:{change:e.brandChange},model:{value:e.formMember.defaultCarInfo.brand,callback:function(t){e.$set(e.formMember.defaultCarInfo,"brand",t)},expression:"formMember.defaultCarInfo.brand"}},e._l(e.brandData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"系列"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系",filterable:""},on:{change:e.seriesChange},model:{value:e.formMember.defaultCarInfo.series,callback:function(t){e.$set(e.formMember.defaultCarInfo,"series",t)},expression:"formMember.defaultCarInfo.series"}},e._l(e.seriesData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"车型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择，如宝马3系2016款"},model:{value:e.formMember.defaultCarInfo.type,callback:function(t){e.$set(e.formMember.defaultCarInfo,"type",t)},expression:"formMember.defaultCarInfo.type"}},e._l(e.modeData,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"车辆识别代码"}},[a("el-input",{attrs:{placeholder:"请输入车辆识别代码，如1G1BL52P7TR115520"},model:{value:e.formMember.defaultCarInfo.vin,callback:function(t){e.$set(e.formMember.defaultCarInfo,"vin",t)},expression:"formMember.defaultCarInfo.vin"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.createMember()}}},[e._v("确 定")])],1)],1),a("biz-dialog-selector",{attrs:{slot:"float",visibility:e.showDialog,loading:e.dialogLoading,tableData:e.dialogTableData,pagination:e.dialogPagination,selectionMode:"single",isClear:!1,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showDialog=t},confirmed:e.confirmedHandler,open:e.openedHandler,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange},slot:"float"},[a("el-table-column",{attrs:{prop:"userName",label:"会员信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"customer-info"},[t.row.head?a("img",{attrs:{src:t.row.head}}):a("img",{attrs:{src:i("624d")}}),a("div",{staticClass:"wrapper"},[a("div",{staticClass:"title",attrs:{title:t.row.name}},[e._v(e._s(t.row.name))]),a("div",{staticClass:"gender"},["0"===t.row.gender?a("i",{staticClass:"male iconfont biz-icon-i-web-m"}):e._e(),"1"===t.row.gender?a("i",{staticClass:"female iconfont biz-icon-i-web-f"}):e._e(),"2"===t.row.gender?a("i",{staticClass:"none iconfont biz-icon-i-web-bm"}):e._e(),a("span",[e._v(e._s(t.row.mobile||t.row.contactMobile))])])])])]}}])}),a("el-table-column",{attrs:{prop:"nickname",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("1"===t.row.enableState?"启用":"停用")+" ")]}}])}),a("el-table-column",{attrs:{prop:"nickname",label:"店铺"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.shop.name)+" ")]}}])}),a("el-table-column",{attrs:{prop:"nickname",label:"最后登录"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lastLoginDate)+" ")]}}])})],1)],1)},r=[],o=(i("b0c0"),i("af3f")),s=i("e4c3"),n=i("0e5e"),l=i("e42c"),d={name:"VehicleMgmtPeoplePicker",components:{BizDialogSelector:o["a"]},model:{prop:"value",event:"input"},props:{value:{type:Object},contentField:{type:String,default:function(){return"name"}}},data:function(){var e=this;return{text:"",showDialog:!1,dialogLoading:!1,dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入姓名/手机号",name:"searchValue",value:""}],dialogVisible:!1,dialogRules:{userName:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[0-9a-zA-Z]+$/,message:"用户名只能为数字或字母",trigger:"blur"},{min:4,max:20,message:"长度在4-20位",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"}],name:[{required:!0,trigger:"blur",message:"请输入姓名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:20,message:"密码应在6-20位之间",trigger:"blur"}],rePassword:[{required:!0,trigger:"blur",message:"请再次输入密码"},{trigger:"blur",validator:function(t,i,a){e.formMember.password===e.formMember.rePassword?a():a(new Error("两次输入密码不一致"))}}]},formMember:{userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",brand:"",series:"",type:"",vin:""}},brandData:[],seriesData:[],brandList:[],seriesList:[],modeData:[]}},methods:{addMember:function(){this.formMember={userName:"",mobile:"",name:"",password:"123456",nickname:"",gender:"2",defaultCarInfo:{plateNumber:"",vin:"",brand:"",series:"",type:""}},this.queryBrandList(),this.getBrandList(),this.dialogVisible=!0},createMember:function(){var e=this;this.$refs.dialogFormModel.validate((function(t,i){t&&l["a"].createMember(e.formMember,(function(t){e.loading=!1,e.$message.success("保存成功"),e.dialogVisible=!1;var i={defaultCarInfo:{id:t.data.defaultCarInfo?t.data.defaultCarInfo.id:"",brand:t.data.defaultCarInfo?t.data.defaultCarInfo.brand:"",plateNumber:t.data.defaultCarInfo?t.data.defaultCarInfo.plateNumber:"",series:t.data.defaultCarInfo?t.data.defaultCarInfo.series:"",type:t.data.defaultCarInfo?t.data.defaultCarInfo.type:""},gender:t.data.gender,id:t.data.id,mobile:t.data.mobile,name:t.data.name,userName:t.data.name};e.$emit("input",i)}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))}))},mobileBlur:function(){this.formMember.id||this.formMember.nickname||this.$set(this.formMember,"nickname",this.formMember.mobile),this.formMember.id||this.formMember.userName||this.$set(this.formMember,"userName",this.formMember.mobile)},brandChange:function(e){this.getSeriesList(e),this.formMember.defaultCarInfo.series="",this.formMember.defaultCarInfo.type=""},seriesChange:function(e){this.getModeList(e),this.formMember.defaultCarInfo.type=""},queryBrandList:function(){var e=this;n["a"].queryBrandList({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},querySeriesList:function(e){var t=this;n["a"].querySeriesList({brand:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},getBrandList:function(){var e=this;n["a"].queryBrandList({},(function(t){e.brandData=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},getSeriesList:function(e){var t=this;n["a"].querySeriesList({brand:e},(function(e){t.seriesData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},getModeList:function(e){var t=this;n["a"].queryTypeList({series:e,brand:this.formMember.defaultCarInfo.brand},(function(e){t.modeData=e.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryPeople:function(e){var t=this;this.dialogLoading=!0,s["a"].queryPeople(e,(function(e){t.dialogTableData=e.content,t.$set(t.dialogPagination,"total",parseInt(e.total)),t.dialogLoading=!1}),(function(e){console.log(e),console.log("code错误")}))},getStatus:function(e){switch(e.enableState){case"0":return"停用";case"1":return"启用"}return""},clickHandler:function(e){this.showDialog=!0},confirmedHandler:function(e,t){var i=t[0];this.text=i.name,this.$emit("input",i)},getDialogQueryParams:function(){return{pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||""}},openedHandler:function(){this.dialogPagination.currentPage=1,this.dialogPagination.pageSize=20,this.dialogFilters=[{type:"input",label:"",placeholder:"请输入姓名/手机号",name:"searchValue",value:""}],this.queryPeople(this.getDialogQueryParams())},dialogFilterDataChange:function(e){this.$set(this.dialogPagination,"currentPage",1),this.queryPeople(this.getDialogQueryParams())},dialogPageSizeChange:function(e){this.$set(this.dialogPagination,"pageSize",e),this.queryPeople(this.getDialogQueryParams())},dialogCurrentPageChange:function(e){this.$set(this.dialogPagination,"currentPage",e),this.queryPeople(this.getDialogQueryParams())}}},c=d,p=(i("50c2"),i("2877")),m=Object(p["a"])(c,a,r,!1,null,null,null);t["a"]=m.exports},c454:function(e,t,i){"use strict";var a=i("8f4d"),r=i.n(a);r.a},c466:function(e,t,i){"use strict";i("99af"),i("d3b7"),i("ac1f"),i("25f0"),i("5319");t["a"]={nowDate:function(){var e=new Date,t=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getDate()+1<10?"0"+e.getDate():e.getDate();return e.getFullYear().toString()+"-"+t+"-"+i},getMonthDays:function(e){var t=new Date(Date.parse(e.replace(/-/g,"/"))),i=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,1),r=(a-i)/864e5;return r},halfYearAgo:function(e){var t="";return t=e?new Date(Date.parse(e.replace(/-/g,"/"))):new Date,console.log(t),t.setMonth(t.getMonth()-6),"".concat(t.getFullYear(),"-").concat(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getDate()<10?"0"+t.getDate():t.getDate())},lastMonthDate:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1<10?"0"+e.getMonth():e.getMonth(),a=e.getDate()+1<10?"0"+e.getDate():e.getDate();return"00"===i&&(i="12",t--),t.toString()+"-"+i+"-"+a},nextMonthDate:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),r=parseInt(i)+1;13===r&&(t=parseInt(t)+1,r=1);var o=new Date(t,r,0);return o=o.getDate(),a>o&&(a=o),r<10&&(r="0"+r),t+"-"+r+"-"+a},lastYearDate:function(){var e=new Date,t=new Date(e.getFullYear()-1,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastTwoYearDate:function(){var e=new Date,t=new Date(e.getFullYear()+2,e.getMonth(),e.getDate());return t.getFullYear()+"-"+this.convertToFullMode(t.getMonth()+1)+"-"+this.convertToFullMode(t.getDate())},lastNYearDate:function(e,t){var i=new Date(e),a=new Date(i.getFullYear()+parseInt(t),i.getMonth(),i.getDate());return a.getFullYear()+"-"+this.convertToFullMode(a.getMonth()+1)+"-"+this.convertToFullMode(a.getDate())},dateConverter:function(e){return e instanceof Date?e.getFullYear()+"-"+this.convertToFullMode(e.getMonth()+1)+"-"+this.convertToFullMode(e.getDate()):e},timeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes())+":"+this.convertToFullMode(e.getSeconds()):e},shortTimeConverter:function(e){return e instanceof Date?this.convertToFullMode(e.getHours())+":"+this.convertToFullMode(e.getMinutes()):e},dateTimeConverter:function(e){return e instanceof Date?this.dateConverter(e)+" "+this.timeConverter(e):e},convertToFullMode:function(e){return e=e.toString(),1===e.length?"0"+e:e}}},c53e:function(e,t,i){},c708:function(e,t,i){"use strict";var a=i("1370"),r=i.n(a);r.a},c820:function(e,t,i){"use strict";var a=i("474c"),r=i.n(a);r.a},c954:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"order-product-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),i("el-form",{attrs:{inline:!0,disabled:!e.isEdit,"inline-message":!0}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addProduct}},[e._v("新增")]),i("el-form-item",{staticClass:"subTotal",attrs:{label:"合计:",prop:"subTotal"}},[e._v(" "+e._s(e.subTotal)+" ")])],1),i("biz-list",{key:Math.random(),ref:"table",attrs:{tableData:e.tableData,loading:e.loading}},[i("el-table-column",{attrs:{prop:"sn",label:"编号"}}),i("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),i("el-table-column",{attrs:{prop:"price",label:"商品价格","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input-number",{attrs:{size:"mini",min:0},on:{change:function(i){return e.priceChange(t.row.price)}},model:{value:t.row.price,callback:function(i){e.$set(t.row,"price",i)},expression:"scope.row.price"}})],1)])}}])}),i("el-table-column",{attrs:{prop:"quantity",label:"数量","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[i("el-input-number",{attrs:{size:"mini",min:1},on:{change:function(i){return e.quantityChange(t.row.quantity)}},model:{value:t.row.quantity,callback:function(i){e.$set(t.row,"quantity",i)},expression:"scope.row.quantity"}})],1)])}}])}),i("el-table-column",{attrs:{prop:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-customcol"},[e._v(" "+e._s(t.row.quantity?(Number(t.row.quantity)*Number(t.row.price)).toFixed(2):"")+" ")])])}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作",type:"index"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e.isEdit?i("div",{staticClass:"biz-customcol"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteHandeler(t)}}},[e._v(" 删除 ")])],1):e._e()])}}])})],1),i("biz-pagination",{attrs:{pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),i("el-dialog",{attrs:{visible:e.dialogTableVisible,center:"",width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.print}},[e._v("打印")])],1)])],1),i("vue-easy-print",{ref:"easyPrint",attrs:{tableShow:""}},[i("div",{staticClass:"d-p-wrap"},[i("el-row",{attrs:{gutter:10}},[i("div",{staticClass:"p-title"},[e._v(" "+e._s(e.title)+" ")])]),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple",attrs:{align:"right"}},[e._v("打印日期："+e._s(e.formatDate((new Date).getTime())))])])],1),i("el-row",{staticClass:"row-top",attrs:{gutter:10}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单编号："+e._s(e.formData.sn))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("配送方式："+e._s(e.shippingData.shippingMethod))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("收货人："+e._s(e.shippingData.consignee))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("电话："+e._s(e.shippingData.phone))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:12}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("地址："+e._s(e.shippingData.address))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("买家留言："+e._s(e.formData.memo))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"})])],1),i("el-table",{staticClass:"table-class",attrs:{data:e.gridData}},[i("el-table-column",{attrs:{property:"isTotal",width:"50",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isTotal?i("div",[e._v("合计")]):i("div",[e._v(e._s(t.$index+1))])]}}])}),i("el-table-column",{attrs:{property:"name",label:"商品名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(" "+e._s(t.row.name)+" ")]}}],null,!0)}),i("el-table-column",{attrs:{property:"address",label:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(" "+e._s(-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:"")+" ")]}}],null,!0)}),i("el-table-column",{attrs:{property:"price",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isTotal?void 0:[e._v(" ￥"+e._s(t.row.price)+" ")]}}],null,!0)}),i("el-table-column",{attrs:{property:"quantity",label:"数量"}}),i("el-table-column",{attrs:{property:"subTotal",label:"小计"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" ￥"+e._s(t.row.subTotal)+" ")]}}])})],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("运费：￥"+e._s(e.formData.freight))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("优惠金额：￥"+e._s(e.formData.couponDiscount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("调整金额：￥"+e._s(e.formData.offsetAmount))])]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("订单金额：￥"+e._s(e.formData.originalAmount))])])],1),i("el-row",{staticClass:"row",attrs:{gutter:10}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"grid18"})]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"grid-content bg-purple"},[e._v("仓库签字：")])])],1)],1)])],1),i("biz-dialog-selector",{staticClass:"product-info-dailog",attrs:{title:"选择商品",visibility:e.showDialog,tableData:e.giftList,pagination:e.dialogPagination,filters:e.dialogFilters,selectionKeys:e.selectedGiftIds},on:{"update:visibility":function(t){e.showDialog=t},pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange,confirmed:e.confirmedProduct,filterDataChange:e.dialogFilterDataChange,selectionChange:e.selectionChange}},[i("el-table-column",{attrs:{property:"fullName",label:"商品名称",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("div",{staticClass:"biz-two-column"},[i("img",{attrs:{src:t.row.image||e.DefaultImg,onerror:e.errorImg}}),i("div",{staticClass:"biz-two-row"},[i("div",{staticStyle:{"margin-left":"10px","font-size":"14px"}},[e._v(e._s(t.row.name))]),i("div",{staticStyle:{"margin-left":"10px"}},[e._v("编号："+e._s(t.row.sn))]),i("div",{staticStyle:{"margin-left":"10px"}},[e._v("规格："+e._s(t.row.fullName&&-1!==t.row.fullName.indexOf("[")?t.row.fullName.split("[")[1].split("]")[0]:""))])])])])}}])}),i("el-table-column",{attrs:{property:"categoryName",label:"分类"}}),i("el-table-column",{attrs:{property:"brandName",label:"品牌"}}),i("el-table-column",{attrs:{property:"price",label:"价格"}}),i("el-table-column",{attrs:{label:"剩余库存/库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.row.availableStock)+"/"+e._s(t.row.stock))])]}}])})],1)],1)},r=[],o=(i("99af"),i("4de4"),i("4160"),i("c975"),i("d81d"),i("a434"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("25f0"),i("159b"),i("5530")),s=i("7558"),n=i("5c40"),l=i("8330"),d=i("f36f"),c=i("e42c"),p=i("2086"),m=i("225d"),u=i("2f62"),f=i("c596"),h=i("1ab1"),g=i("af3f"),b=i("f3ac"),v=i.n(b),y={name:"NewsMgmt",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},errorImg:'this.src="/resources/admin/images/default/product-default.png"',DefaultImg:v.a,selectedGiftList:[],selectedGiftIds:[],showDialog:!1,dialogFilters:[{type:"input",placeholder:"请输入编号或商品名",name:"searchbar",value:""}],giftList:[],loading:!1,open:!1,subTotal:"",height:"585",subTotalAll:"",tableData:[],restaurants:[],selections:[],orderItems:[],selectionList:[],dialogTableVisible:!1,gridData:[],formData:{},shippingData:{},title:"",form:{products:""},operations:[{label:"保存",name:"save",type:"primary"},{label:"打印",name:"certificate",type:"primary"}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},components:{BizList:s["a"],BizPagination:n["a"],BizGrid:d["a"],BizSaveButton:l["a"],vueEasyPrint:m["a"],BizDialogSelector:g["a"]},watch:{itemId:function(e){this.tableData=[],this.subTotal="",this.itemId&&this.getList()}},mounted:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},methods:Object(o["a"])(Object(o["a"])({},Object(u["c"])(["getUser"])),{},{addProduct:function(){this.dialogFilters[0].value="",this.getGiftList(),this.selectedGiftIds.splice(0,this.selectedGiftIds.length),this.selectedGiftList.splice(0,this.selectedGiftList.length),this.showDialog=!0},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.getGiftList()},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.getGiftList()},dialogFilterDataChange:function(e){this.dialogFilters=e,this.dialogPagination.currentPage=1,this.getGiftList()},getGiftList:function(){var e=this,t={pageSize:this.dialogPagination.pageSize,pageNumber:this.dialogPagination.currentPage,searchValue:this.dialogFilters[0].value,shopId:window.top.SHOP_ID||"",isOutOfStock:"0",type:"couponOrder"===this.$route.params.orderType?"7":"",orderType:this.$route.params.orderType};h["a"].get("purchaseOrder"===window.top.dType?"/admin/purchaseOrderManage/product/list.jhtml":f["g"].memberCardMgmt.memberCard.listProduct,t).then((function(t){e.giftList=t.content,e.dialogPagination.total=Number(t.total)})).catch((function(e){e.errorMessage&&console.log(e.errorMessage)}))},selectionChange:function(e){var t=this;e.forEach((function(e){-1===t.selectionList.indexOf(e)&&t.selectionList.push(e)}))},confirmedProduct:function(e){var t=this;this.selectedGiftIds=e.concat(),this.selectedGiftList=[],this.selectionList.map((function(e){-1!==t.selectedGiftIds.indexOf(e.id)&&(e.quantity="1",t.selectedGiftList.push(e))}));this.selectedGiftList.map((function(e){Number(e.quantity)*Number(e.price)})),this.selectedGiftList.forEach((function(e){t.handleSelect(e),t.listProduct(e)}))},print:function(){this.$refs.easyPrint.print()},certificate:function(){var e=this;if(!this.itemId)return this.$message.warning("请先生成一个订单"),!1;var t={orderId:this.itemId,shopId:window.top.SHOP_ID||""};h["a"].get("purchaseOrder"===window.dType?f["l"].delivery.queryShippingVoucherPurchase:f["l"].delivery.queryShippingVoucher,t).then((function(t){e.dialogTableVisible=!0,e.title=e.getUser().shop?e.getUser().shop.name+"发货单":"发货单",e.formData=t.order,e.shippingData=t.shipping||{},e.userCard=t.userCard,e.gridData=t.order.orderItems})).catch((function(t){e.loading=!1,console.log("ERR_REFRESH: ",t),e.$message.warning(t.errorMessage)}))},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=i+"-"+(a<10?"0"+a:a)+"-"+(r<10?"0"+r:r);return o},resize:function(){var e=document.documentElement.clientHeight||window.innerHeight;this.height=String(e-175)},operate:function(e){this[e]()},refresh:function(){this.flag=!0,this.getList()},operationSuccess:function(){this.getList()},getList:function(){var e=this;console.log("window.top.dType"+window.top.dType),this.loading=!0;var t={orderId:this.itemId,pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};c["a"].viewProducts(t,(function(t){e.loading=!1,e.tableData=t.orderItems,e.subTotal=t.order.price,e.pagination.total=Number(t.total),console.log("this.tableData",e.tableData)}),(function(e){console.log(e)}))},handleSelect:function(e){var t=!1;if(e.productId=e.id,e.id="",this.subTotal=(Number(this.subTotal)+Number(e.quantity)*Number(e.price)).toFixed(2),0!==this.tableData.length){for(var i=0;i<this.tableData.length;i++)if(this.tableData[i].productId===e.productId){this.tableData[i].quantity=(Number(this.tableData[i].quantity)+1).toString(),t=!0;break}t||this.tableData.push(e)}else this.tableData.push(e)},deleteHandeler:function(e){console.log(1),this.tableData.splice(e.$index,1),this.tableData.length>0?this.subTotal=(Number(this.subTotal)-Number(e.row.price)*Number(e.row.quantity)).toFixed(2):this.subTotal=0},quantityChange:function(e){var t=0;this.tableData.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.subTotal=t?t.toFixed(2):""},priceChange:function(e){var t=0;this.tableData.map((function(e){t+=Number(e.quantity)*Number(e.price)})),this.subTotal=t?t.toFixed(2):""},save:function(){var e=this;this.orderItems=this.tableData.map((function(e){return{id:e.id||"",productId:e.productId?e.productId:e.id,quantity:e.quantity||"",price:e.price||""}}));var t=!1;if(this.tableData.forEach((function(e){console.log(e.quantity),-1!==String(e.quantity).indexOf(".")&&(t=!0)})),t)return this.$message.warning("数量不能为小数"),!1;!this.itemId&&this.$emit("setOrderItems",this.orderItems),this.itemId&&c["a"].addOrderItems({orderId:this.itemId,orderData:{orderItems:this.orderItems},shopId:window.top.SHOP_ID},(function(t){e.$emit("setOrderItems",e.orderItems),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.getList(),e.$message.warning(t.errorMessage)}))},listProduct:function(e){var t=this;p["a"].listProduct({searchValue:e.name},(function(e){t.restaurants=e.content.map((function(e){return{fullName:e.fullName,sn:e.sn,price:e.price,quantity:"1",subTotal:e.price,productId:e.id,value:e.fullName}})),t.loading=!1}),(function(e){console.log(e),console.log("code错误")}))},querySearchAsync:function(e,t){var i=this.restaurants,a=e?i.filter(this.createStateFilter(e)):i;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t(a)}),300*Math.random())},createStateFilter:function(e){return function(e){return!0}},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()}})},_=y,I=(i("1dad"),i("2877")),w=Object(I["a"])(_,a,r,!1,null,null,null);t["a"]=w.exports},c9a3:function(e,t,i){"use strict";var a=i("349b"),r=i.n(a);r.a},cc00:function(e,t,i){},cc34:function(e,t,i){"use strict";var a=i("1e9b"),r=i.n(a);r.a},cc46:function(e,t,i){"use strict";var a=i("118c"),r=i.n(a);r.a},ce09:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-invoice-my-agency"},[i("div",{staticClass:"invoice-info-my-agency"},[i("span",{staticClass:"invoice-title"},[e._v("发票信息")]),i("el-form",{attrs:{"label-width":"100","inline-message":!0}},[i("el-form-item",{attrs:{label:"发票抬头："}},[e._v(e._s(e.curInvoice.invoiceTitle))]),i("el-form-item",{attrs:{label:"发票类型："}},[e._v(e._s("0"===e.curInvoice.invoiceType?"个人":"1"===e.curInvoice.invoiceType?"增值税普通发票":"2"===e.curInvoice.invoiceType?"增值税专用发票":""))]),i("el-form-item",{attrs:{label:"发票状态："}},[e._v(e._s(e.curInvoice.invoiceState?e.curInvoice.invoiceState:"未申请"))]),i("el-form-item",{attrs:{label:"联系人："}},[e._v(e._s(e.curInvoice.contacts))]),i("el-form-item",{attrs:{label:"联系电话："}},[e._v(e._s(e.curInvoice.mobile))]),i("el-form-item",{attrs:{label:"所在地区："}},[e._v(e._s(e.curInvoice.areaName?e.curInvoice.areaName:e.curInvoice.area.fullName))]),i("el-form-item",{attrs:{label:"详细地址："}},[e._v(e._s(e.curInvoice.address))]),e.expressName?i("el-form-item",{attrs:{label:"快递公司："}},[e._v(" "+e._s(e.expressName)+" ")]):e._e(),e.curInvoice.expressCode?i("el-form-item",{attrs:{label:"快递单号："}},[e._v(" "+e._s(e.curInvoice.expressCode)+" ")]):e._e()],1),this.shippingSn?i("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("el-collapse-item",{attrs:{title:"发票追踪",name:"1"}},[i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[e.getTraces?i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0):e._e(),this.shippingTraces&&0===this.shippingTraces.length?i("ul",[i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v(" 物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s("暂无轨迹"))])]),i("div",{staticClass:"i-item"},[e._v("快递公司："+e._s(e.expressName))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.curInvoice.expressCode))])])]):e._e()])])])],1):e._e()],1),e.invoiceInfoId?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("提交")]):e._e(),e.invoiceInfoId?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.cancle}},[e._v("取消")]):e._e()],1)},r=[],o=(i("d81d"),i("b0c0"),i("d3b7"),i("5530")),s=i("2f62"),n=i("1ab1"),l=i("c596"),d={name:"my-invoice",data:function(){return{deliverys:[],activeNames:["1"],expressName:"",shippingTraces:[],shippingSn:""}},props:{orderId:{type:String,default:""},orderIds:{type:Array},invoiceInfoId:{type:String,default:""}},components:{},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(s["c"])(["getUser"])),Object(s["c"])("Order",["orderInfo","curInvoice"])),{},{getTraces:function(){return!!(this.shippingTraces&&this.shippingTraces.length>0)}}),watch:{invoiceInfoId:function(e){}},methods:Object(o["a"])(Object(o["a"])({},Object(s["d"])("Order",["updateCurInvoice"])),{},{onContact:function(){this.$router.push({path:"/custom-service"})},getInvoiceInfo:function(){var e=this,t={clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,methodName:"QueryInvoiceBasicInfo"};n["a"].get(l["g"].hypermarketMgmt.invoiceByOrder,t).then((function(t){"0"===t.invoice.invoiceState?(t.invoice.invoiceState="待开票",t.invoice.expressState="待开票"):"1"===t.invoice.invoiceState?(t.invoice.invoiceState="未邮寄",t.invoice.expressState="未邮寄"):"2"===t.invoice.invoiceState&&(t.invoice.invoiceState="已邮寄",t.invoice.expressState="已邮寄"),e.deliverys=t.deliverys,e.shippingSn=t.shipping.sn,e.shippingSn&&e.expressInfo(),e.deliverys.map((function(i){i.id===t.invoice.express&&(e.expressName=i.name)})),t.invoice.area&&(t.invoice.areaName=t.invoice.area.fullName),e.updateCurInvoice(t.invoice)})).catch((function(t){"906"===t.resultCode&&e.updateCurInvoice({})})).finally((function(){}))},handleChange:function(){},cancle:function(){this.$emit("cancle")},submit:function(){var e=this,t={clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,orderId:this.orderInfo.id,invoiceInfoId:this.curInvoice.id,orderIds:this.orderIds,methodName:"CreateInvoiceBasicInfo"};n["a"].post(l["g"].hypermarketMgmt.applyInvoice,t).then((function(t){e.$message.success("申请成功"),e.$emit("close")})).catch((function(t){e.$message.warning(t.errorMessage),"906"===t.resultCode&&e.updateCurInvoice({})})).finally((function(){}))},expressInfo:function(){var e=this,t={methodName:"QueryLogistics",clientType:"2",shopId:this.getUser.shop.id,userId:this.getUser.id,shippingSn:this.shippingSn};n["a"].get(l["g"].hypermarketMgmt.logistics,t).then((function(t){console.log("物流追踪",t),e.shippingTraces=t.shipping.shippingTraces})).catch((function(t){e.$message.warning(t.errorMessage)}))}}),created:function(){}},c=d,p=(i("6649"),i("2877")),m=Object(p["a"])(c,a,r,!1,null,null,null);t["a"]=m.exports},cfe9:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-info-order-mgmt"},[e.isEdit&&e.judgeState?i("biz-header",{attrs:{operations:e.operations},on:{operate:e.handleOperate}},[i("template",{slot:"operation"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.handleSuccess,"on-error":e.handleError,data:{type:"0"},"file-list":e.fileList,name:"file",action:"/admin/file/uploads.jhtml"}},[e.invoiceMode?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"}},[e._v("上传电子发票")]):e._e()],1)],1)],2):e._e(),i("div",{staticClass:"invoiceInfo"},[e._v("发票详情")]),i("el-form",{ref:"formModel",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"发票类型",prop:"invoiceType"}},[i("el-select",{attrs:{placeholder:"请选择发票类型",disabled:!0},on:{change:e.invoiceTypeChange},model:{value:e.formModel.invoiceType,callback:function(t){e.$set(e.formModel,"invoiceType",t)},expression:"formModel.invoiceType"}},[i("el-option",{attrs:{label:"个人",value:"0"}}),i("el-option",{attrs:{label:"增值税普通发票",value:"1"}}),i("el-option",{attrs:{label:"增值税专用发票",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"发票抬头",prop:"invoiceTitle"}},[i("el-input",{attrs:{placeholder:"请输入发票抬头",disabled:!0},model:{value:e.formModel.invoiceTitle,callback:function(t){e.$set(e.formModel,"invoiceTitle",t)},expression:"formModel.invoiceTitle"}}),""===e.formModel.invoiceState?i("el-button",{attrs:{size:"mini",type:""},on:{click:e.selectInvoice}},[e._v("选择")]):e._e()],1),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"纳税人识别号",prop:"code"}},[i("el-input",{attrs:{placeholder:"请输入纳税人识别号",disabled:!0},model:{value:e.formModel.code,callback:function(t){e.$set(e.formModel,"code",t)},expression:"formModel.code"}})],1):e._e(),i("el-form-item",{attrs:{label:"发票金额",prop:"invoiceAmount"}},[i("el-input",{attrs:{placeholder:"请输入发票金额",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.invoiceAmount,callback:function(t){e.$set(e.formModel,"invoiceAmount",t)},expression:"formModel.invoiceAmount"}})],1),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"注册地址",prop:"registerAddress"}},[i("el-input",{attrs:{placeholder:"请输入注册地址",disabled:!0},model:{value:e.formModel.registerAddress,callback:function(t){e.$set(e.formModel,"registerAddress",t)},expression:"formModel.registerAddress"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"注册电话",prop:"registerMobile"}},[i("el-input",{attrs:{placeholder:"请输入注册电话",disabled:!0},model:{value:e.formModel.registerMobile,callback:function(t){e.$set(e.formModel,"registerMobile",t)},expression:"formModel.registerMobile"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[i("el-input",{attrs:{placeholder:"请输入开户银行",disabled:!0},model:{value:e.formModel.bank,callback:function(t){e.$set(e.formModel,"bank",t)},expression:"formModel.bank"}})],1):e._e(),"0"!==e.formModel.invoiceType?i("el-form-item",{attrs:{label:"银行账户",prop:"account"}},[i("el-input",{attrs:{placeholder:"请输入银行账户",disabled:!0},model:{value:e.formModel.account,callback:function(t){e.$set(e.formModel,"account",t)},expression:"formModel.account"}})],1):e._e(),i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("获取方式")]),i("el-form-item",{attrs:{label:"发票类型",prop:"invoiceMode"}},[i("el-radio-group",{attrs:{disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.invoiceMode,callback:function(t){e.$set(e.formModel,"invoiceMode",t)},expression:"formModel.invoiceMode"}},[i("el-radio",{attrs:{label:"0"}},[e._v("纸质发票")]),i("el-radio",{attrs:{label:"1"}},[e._v("电子发票")])],1)],1),"1"===e.formModel.invoiceMode?i("div",[i("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[i("el-input",{attrs:{placeholder:"请输入电子邮箱",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.email,callback:function(t){e.$set(e.formModel,"email",t)},expression:"formModel.email"}})],1)],1):e._e(),"0"===e.formModel.invoiceMode?i("div",[i("el-form-item",{attrs:{label:"是否邮寄",prop:"needMail"}},[i("el-radio-group",{attrs:{disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.needMail,callback:function(t){e.$set(e.formModel,"needMail",t)},expression:"formModel.needMail"}},[i("el-radio",{attrs:{label:"1"}},[e._v("是")]),i("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),"1"===e.formModel.needMail?i("div",[i("el-form-item",{attrs:{label:"收票人",prop:"contacts"}},[i("el-input",{attrs:{placeholder:"请输入收票人",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.contacts,callback:function(t){e.$set(e.formModel,"contacts",t)},expression:"formModel.contacts"}})],1),i("el-form-item",{attrs:{label:"收件人电话",prop:"mobile"}},[i("el-input",{attrs:{maxlength:"13",placeholder:"请输入电话",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),i("el-form-item",{attrs:{label:"所在地",prop:"area"}},[i("biz-area-select",{attrs:{areaId:e.formModel.area.id,disabled:""!==e.formModel.invoiceState},on:{areaChanged:e.areaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{placeholder:"请输入地址",disabled:""!==e.formModel.invoiceState},model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1)],1):e._e()],1):e._e(),e.logs&&e.logs.length>0?i("div",{staticClass:"invoiceInfo",staticStyle:{"margin-left":"-20px",width:"570px"}},[e._v("发票进度")]):e._e(),e.logs&&e.logs.length>0?i("div",{staticClass:"order-track-new",staticStyle:{"padding-left":"30px","padding-top":"15px"}},[i("el-steps",{attrs:{direction:"vertical","finish-status":"success",space:"30px"}},[i("el-step",{attrs:{title:"已申请",status:"1"===e.active?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,a){return"0"===t.type?i("div",{key:a,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)]),i("el-step",{attrs:{title:"已开票",status:"2"===e.active1?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,a){return"1"===t.type?i("div",{key:a,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)]),i("el-step",{attrs:{title:"已邮寄",status:"3"===e.active2?"success":"wait"}},[i("div",{attrs:{slot:"description"},slot:"description"},e._l(e.logs,(function(t,a){return"2"===t.type?i("div",{key:a,staticClass:"logInfo"},[i("span",{staticStyle:{"font-size":"12px","margin-right":"10px"}},[e._v(e._s(t.createTime))]),t.operator?i("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.operator))]):e._e()]):e._e()})),0)])],1)],1):e._e()],1),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showInvoiceExpress,center:"","append-to-body":"","custom-class":"close-invoice-dialog",title:"发票邮寄",width:"500px"},on:{"update:visible":function(t){e.showInvoiceExpress=t}}},[i("div",{staticClass:"reson-container"},[i("span",{staticStyle:{"margin-left":"40px"}},[e._v("请填写发票邮寄的物流公司和快递单号信息")]),i("el-form",{ref:"formModel",staticStyle:{"margin-top":"40px"},attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,"inline-message":!0}},[i("el-form-item",{attrs:{label:"快递公司",prop:"express"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择快递公司"},on:{change:e.expressChange},model:{value:e.formModel.express,callback:function(t){e.$set(e.formModel,"express",t)},expression:"formModel.express"}},e._l(e.deliverys,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"快递单号",prop:"expressCode"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入快递单号"},model:{value:e.formModel.expressCode,callback:function(t){e.$set(e.formModel,"expressCode",t)},expression:"formModel.expressCode"}})],1)],1)],1),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showInvoiceExpress=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.statusChange()}}},[e._v("确定")])],1)]),i("el-dialog",{attrs:{visible:e.showLogisticsFollowing,center:"","append-to-body":"","custom-class":"close-follow-dialog",title:"物流跟踪"},on:{"update:visible":function(t){e.showLogisticsFollowing=t}}},[i("div",{staticClass:"logistic-info"},[i("div",{staticClass:"track-list"},[e.getTraces?i("ul",e._l(e.shippingTraces,(function(t){return i("li",{key:t.id},[i("i",{staticClass:"node-icon"}),i("span",{staticClass:"txt"},[e._v(e._s(t.station))]),i("span",{staticClass:"time"},[e._v(e._s(t.happenTime))])])})),0):e._e(),this.shippingTraces&&0===this.shippingTraces.length?i("ul",[i("div",{staticClass:"info"},[i("div",{staticClass:"i-item"},[e._v(" 物流状态： "),i("span",{staticClass:"l-state"},[e._v(e._s("暂无轨迹"))])]),i("div",{staticClass:"i-item"},[e._v("快递公司："+e._s(e.expressName))]),i("div",{staticClass:"i-item"},[e._v("快递单号："+e._s(e.expressSn))])])]):e._e()])])]),i("el-dialog",{attrs:{visible:e.dialogVisiableInvoice,"append-to-body":"","custom-class":"bill-dialog"},on:{"update:visible":function(t){e.dialogVisiableInvoice=t}}},[i("invoice-info-dialog",{on:{selectedInvoice:e.selectedInvoice}})],1),i("el-dialog",{staticClass:"show-file",attrs:{"append-to-body":"",visible:e.previewInvoice,width:"950px"},on:{close:function(t){e.previewInvoice=!1}}},[i("div",[i("img",{style:e.imgStyle,attrs:{src:e.formModel.path,alt:""}})]),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-upload",{attrs:{"show-file-list":!1,"on-success":e.returnUpload,"on-error":e.handleError,data:{type:"0"},"file-list":e.fileList,limit:1,name:"file",action:"/admin/file/uploads.jhtml"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重新上传")])],1)],1)]),i("el-dialog",{staticClass:"before-upload",attrs:{"append-to-body":"",visible:e.uploadReview,width:"950px"},on:{close:e.cancelUplod}},[i("div",[i("img",{style:e.imgStyle,attrs:{src:e.formModel.path,alt:""}})]),i("div",{staticClass:"close-button",staticStyle:{"text-algin":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.uploadReview=!1}}},[e._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.conformUpload}},[e._v("确定上传")])],1)])],1)},r=[],o=(i("4160"),i("d81d"),i("b0c0"),i("d3b7"),i("159b"),i("5530")),s=i("04d3"),n=i("f36f"),l=i("e42c"),d=i("ce2e"),c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"invoice-info-mgmt"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.invoiceList,(function(t){return i("el-card",{key:t.id},[i("div",[i("div",{staticClass:"radio-i",on:{click:function(i){return e.applyFor(t)}}},[i("el-radio",{attrs:{label:"1",size:"mini"},on:{change:function(i){return e.selectChange(t)}},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"invoice.checked"}},[i("span",{staticStyle:{color:"#ffffff"}},[e._v(".")])]),i("div",[i("div",{staticClass:"default"},[i("span",[e._v("发票抬头：")]),i("span",[e._v(e._s(t.invoiceTitle))]),"1"===t.isDefault?i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"mini"}},[e._v("默认")]):e._e()],1),i("div",{staticStyle:{"padding-top":"10px"}},[i("span",[e._v("发票类型：")]),i("span",[e._v(e._s("0"===t.invoiceType?"个人":"1"===t.invoiceType?"增值税普通发票":"2"===t.invoiceType?"增值税专用发票":""))])]),i("div",{staticStyle:{padding:"10px 0px"}},[i("span",[e._v("联系人：")]),i("span",[e._v(e._s(t.contacts))])]),i("div",[i("span",[e._v("联系电话：")]),i("span",[e._v(e._s(t.mobile))])]),i("div",{staticClass:"content-d"},[i("span",[e._v("详细地址：")]),i("span",[e._v(e._s(t.areaName+t.address))])])])],1),i("div",{staticClass:"bottom-d"},["0"===t.isDefault?i("span",{on:{click:function(i){return i.stopPropagation(),e.setDefault(t)}}},[e._v("设为默认")]):e._e(),i("span",{on:{click:function(i){return i.stopPropagation(),e.editForm(t)}}},[e._v("编辑")]),i("span",{on:{click:function(i){return i.stopPropagation(),e.deleteForm(t.id)}}},[e._v("删除")])])])])})),0===e.invoiceList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"发票信息"}}),i("el-form-item",{attrs:{label:"发票类型",prop:"consignee"}},[i("el-select",{model:{value:e.form.invoiceType,callback:function(t){e.$set(e.form,"invoiceType",t)},expression:"form.invoiceType"}},[i("el-option",{attrs:{label:"个人",value:"0"}}),i("el-option",{attrs:{label:"增值税普通发票",value:"1"}}),i("el-option",{attrs:{label:"增值税专用发票",value:"2"}})],1)],1),i("el-form-item",{attrs:{label:"发票抬头",prop:"invoiceTitle"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.invoiceTitle,callback:function(t){e.$set(e.form,"invoiceTitle",t)},expression:"form.invoiceTitle"}})],1),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"纳税人识别号",prop:"code"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"注册地址",prop:"registerAddress"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.registerAddress,callback:function(t){e.$set(e.form,"registerAddress",t)},expression:"form.registerAddress"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"注册电话",prop:"registerMobile"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.registerMobile,callback:function(t){e.$set(e.form,"registerMobile",t)},expression:"form.registerMobile"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.bank,callback:function(t){e.$set(e.form,"bank",t)},expression:"form.bank"}})],1):e._e(),"0"!==e.form.invoiceType?i("el-form-item",{attrs:{label:"银行账户",prop:"account"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1):e._e(),i("el-form-item",{attrs:{label:"邮寄地址"}}),i("el-form-item",{attrs:{label:"联系人",prop:"contacts"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.contacts,callback:function(t){e.$set(e.form,"contacts",t)},expression:"form.contacts"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("el-form-item",{attrs:{label:"所在地区"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},p=[],m=(i("a9e3"),i("8330")),u=i("1ab1"),f=i("c596"),h=i("2f62"),g=i("f260"),b=i.n(g),v={components:{BizSaveButton:m["a"],BizAreaSelect:d["a"]},data:function(){return{invoiceList:[],invoiceInfoId:"",checked:"1",showForm:!1,dialogVisiable:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{invoiceType:[{required:!0,message:"请输入发票类型",trigger:"blur"}],invoiceTitle:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],code:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入注册地址",trigger:"blur"}],registerMobile:[{required:!0,message:"请输入注册电话",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],account:[{required:!0,message:"请输入银行账户",trigger:"blur"}],contacts:[{required:!0,message:"请输入联系人",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},props:{orderIds:{type:Array},invoiceAmount:{type:Number}},computed:Object(o["a"])(Object(o["a"])({},Object(h["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+b.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(o["a"])(Object(o["a"])({},Object(h["d"])("Order",["updateCurInvoice"])),{},{operate:function(e){this[e]()},applyFor:function(e){this.invoiceInfoId=e.id,this.$emit("selectedInvoice",e),this.updateCurInvoice(e)},cancle:function(){this.dialogVisiable=!1},close:function(){this.dialogVisiable=!1,this.$emit("close")},selectChange:function(e){this.invoiceList.map((function(t){t.id!==e.id&&(t.checked="0")}))},getDetaultModel:function(){return{account:"",address:"",areaId:"",area:{id:"1568"},areaName:"",bank:"",code:"",contacts:"",invoiceTitle:"",invoiceType:"0",isDefault:"",mobile:"",registerAddress:"",registerMobile:""}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除发票?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u["a"].delete(f["g"].hypermarketMgmt.invoiceInfo,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,invoice:this.form};u["a"].post(f["g"].hypermarketMgmt.invoiceInfo,t).then((function(t){e.$message.success("添加成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateCurInvoice(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,invoice:this.form};u["a"].put(f["g"].hypermarketMgmt.invoiceInfo,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateCurInvoice(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};u["a"].get(f["g"].hypermarketMgmt.invoiceInfos,t).then((function(t){e.invoiceList=t.invoices||[],e.invoiceList.map((function(t){e.$set(t,"checked",t.isDefault)}))})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},y=v,_=(i("4944"),i("2877")),I=Object(_["a"])(y,c,p,!1,null,null,null),w=I.exports,x={name:"invoiceInfo",props:{itemId:{type:String},userId:{type:String},price:{type:String},invoiceInfoId:{type:String},invoiceId:{type:String},open:{type:Boolean,default:function(){return!0}},isEdit:{type:Boolean,default:function(){return!0}},fileList:{type:Array,default:function(){return[]}}},components:{BizHeader:s["d"],BizGrid:n["a"],InvoiceInfoDialog:w,BizAreaSelect:d["a"]},data:function(){var e=this;return{loading:!1,formLoading:!1,isFirst:!0,expressName:"",expressSn:"",active:"",active1:"",active2:"",active3:"",showInvoiceExpress:!1,showLogisticsFollowing:!1,dialogVisiableInvoice:!1,shippingSn:"",shippingTraces:[],previewInvoice:!1,uploadReview:!1,logs:[],formModel:{id:"",invoiceType:"",invoiceState:"",invoiceTitle:"",price:"",code:"",registerAddress:"",registerMobile:"",bank:"",account:"",invoiceMode:"0",invoiceAmount:"",createDate:"",needMail:"0",contacts:"",mobile:"",area:{id:"1568"},address:"",express:"",expressCode:"",freight:"",zipCode:"",email:"",path:""},operations:[{label:"确认提交",name:"save",type:"primary",disabled:!1,class:"show"},{label:"撤销",name:"cancel",type:"primary",disabled:!1,class:"hidden"}],deliverys:[],rules:{mobile:[{required:!0,message:"电话不能少于5位",trigger:"blur",min:5},{pattern:/^[-0-9]*$/,message:"请输入数字",trigger:"blur"}],invoiceType:[{required:!0,message:"请选择发票类型",trigger:"blur"}],invoiceTitle:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],invoiceAmount:[{required:!0,message:"请输入发票金额",trigger:"blur"}],code:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入注册地址",trigger:"blur"}],registerMobile:[{required:!0,message:"请输入注册电话",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],account:[{required:!0,message:"请输入银行账户",trigger:"blur"}],needMail:[{required:!0,message:"请选择是否邮寄",trigger:"blur"}],contacts:[{required:!0,message:"请输入收票人",trigger:"blur"}],number:[{required:!0,message:"请输入电话",trigger:"blur"}],area:[{required:!0,message:"请选择所在地",trigger:"blur"},{trigger:"blur",validator:function(t,i,a){e.formModel.area.id?a():a(new Error("请选择所在地"))}}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],express:[{required:!0,message:"请选择快递公司",trigger:"blur"}],expressCode:[{required:!0,message:"请输入快递单号",trigger:"blur"}],freight:[{required:!0,message:"请输入物流费用",trigger:"blur"}]}}},watch:{open:function(e,t){this.formModel=this.clear(),console.log("11111111111111===="),e&&(this.$refs.formModel.clearValidate(),console.log(this.invoiceInfoId),console.log(this.invoiceId),this.invoiceInfoId&&!this.invoiceId?this.getInvoiceInit():this.getList())}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(h["c"])(["getUser"])),Object(h["c"])("Order",["orderConfim","orderInfo","curInvoice","payment","defaultReceive","clickItemSelect"])),{},{judgeState:function(){if(console.log("invoiceState="+this.formModel.invoiceState),null!==this.formModel.invoiceState&&""!==this.formModel.invoiceState){if("3"===this.formModel.invoiceState)return!1;if("0"===this.formModel.needMail&&"1"===this.formModel.invoiceState)return!1}return!0},invoiceMode:function(){return"1"===this.formModel.invoiceMode&&"0"===this.formModel.invoiceState},showShippinig:function(){return"1"===this.formModel.invoiceState||"2"===this.formModel.invoiceState||"3"===this.formModel.invoiceState},getTraces:function(){return!!(this.shippingTraces&&this.shippingTraces.length>0)},imgStyle:function(){return{width:"100%",height:"100%"}}}),mounted:function(){console.log("22222222222222===="),this.invoiceInfoId&&!this.invoiceId?this.getInvoiceInit():this.getList()},methods:Object(o["a"])(Object(o["a"])({},Object(h["d"])("Order",["updateClickItemSelect"])),{},{clear:function(){return{id:"",invoiceType:"",invoiceState:"",invoiceTitle:"",price:"",code:"",registerAddress:"",registerMobile:"",bank:"",account:"",invoiceAmount:"",createDate:"",invoiceMode:"0",needMail:"0",contacts:"",mobile:"",area:{id:"1568"},address:"",express:"",expressCode:"",freight:"",zipCode:"",email:"",path:""}},cancelUplod:function(){this.uploadReview=!1},handleSuccess:function(e,t,i){console.log(e+"1111111"),e.fis&&e.fis[0]&&(this.fileList.push({uid:t.uid,url:e.fis[0].url}),this.formModel.path=e.fis[0].url),this.uploadReview=!0},conformUpload:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="1",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("上传成功"),e.getList(),e.$emit("operationSuccess"),e.uploadReview=!1}),(function(t){e.$message.warning(t.errorMessage)}))},handleError:function(e,t,i){e?this.$message.warning(e):this.$message.warning("发生错误")},selectedInvoice:function(e){this.dialogVisiableInvoice=!1,this.formModel.invoiceType=e.invoiceType,this.formModel.invoiceTitle=e.invoiceTitle,this.formModel.code=e.code,this.formModel.registerAddress=e.registerAddress,this.formModel.registerMobile=e.registerMobile,this.formModel.bank=e.bank,this.formModel.account=e.account,this.formModel.mobile=e.mobile,this.formModel.contacts=e.contacts,this.formModel.area.id=e.area.id,this.formModel.address=e.address},selectInvoice:function(){this.updateClickItemSelect(!0),this.dialogVisiableInvoice=!0},cancel:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="4",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("撤销成功"),e.formModel.invoiceState="",e.getList(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},expressInfo:function(){var e=this,t={userId:this.userId,shippingSn:this.shippingSn,shopId:this.getUser.shop.id};u["a"].get("/admin/purchaseOrder/logistics.jhtml",t).then((function(t){e.shippingTraces=t.shipping.shippingTraces,e.expressSn=t.shipping.expressSn,e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage),e.loading=!1}))},statusChange:function(){var e=this;this.formModel.orderId=this.itemId,this.formModel.invoiceState="2",l["a"].invoiceDetailUpdate(this.formModel,(function(t){e.$message.success("保存成功"),e.showInvoiceExpress=!1,e.getList(),e.$emit("operationSuccess")}),(function(t){e.$message.warning(t.errorMessage)}))},returnUpload:function(e,t,i){var a=this;e.fis&&e.fis[0]&&(this.fileList.push({uid:t.uid,url:e.fis[0].url}),this.formModel.path=e.fis[0].url,this.formModel.orderId=this.itemId,this.formModel.invoiceState="1",l["a"].invoiceDetailUpdate(this.formModel,(function(e){a.$message.success("上传成功"),a.previewInvoice=!1,a.getList(),a.$emit("operationSuccess")}),(function(e){a.$message.warning(e.errorMessage)})))},invoiceTypeChange:function(){this.$refs.formModel.clearValidate()},expressChange:function(){this.$refs.formModel.clearValidate("express")},getLogs:function(){var e=this,t={userId:this.userId,orderId:this.itemId};u["a"].get("/rest/invoice/invoice.jhtml",t).then((function(t){e.logs=t.invoice.logs,e.active="",e.active1="",e.active2="",t.invoice.logs&&t.invoice.logs.length>0&&t.invoice.logs.forEach((function(t,i){"0"===t.type&&(e.active="1"),"1"===t.type&&(e.active1="2"),"2"===t.type&&(e.active2="3")})),e.shippingSn=t.invoice.shippingSn})).catch((function(e){console.log("ERR: ",e)})).finally((function(){}))},areaChanged:function(e){this.formModel.area.id=e},getInvoiceInit:function(){var e=this;l["a"].invoiceInfoDefault({userId:this.userId||""},(function(t){e.formModel=Object.assign(e.clear(),t.invoiceInfo),console.log("this.price"),e.$set(e.formModel,"invoiceAmount",e.price),e.$set(e.formModel,"invoiceMode","0"),e.operations[0].label="确认提交",e.operations[1].class="hidden",e.logs=[],e.formModel.area.id||(e.formModel.area.id="1568")}),(function(t){console.log(t),e.loading=!1,console.log("code错误")}))},getList:function(){var e=this;this.loading=!0,this.showForm=!1,l["a"].invoiceByOrder({orderId:this.itemId||""},(function(t){e.formModel=Object.assign(e.clear(),t.invoice),"0"===e.formModel.invoiceMode?e.formModel.invoiceState?"0"===e.formModel.invoiceState?(e.operations[0].label="确认已开票",e.operations[0].class="show",e.operations[1].label="撤销",e.operations[1].class="show"):"1"===e.formModel.invoiceState?(e.operations[0].label="邮寄",e.operations[0].class="show",e.operations[1].class="hidden"):"2"===e.formModel.invoiceState?(e.operations[0].label="物流跟踪",e.operations[0].class="show",e.operations[1].class="hidden"):"4"===e.formModel.invoiceState?(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].label="已撤销",e.operations[1].class="show",e.formModel.invoiceState=""):e.operations[1].class="hidden":(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].class="hidden"):e.formModel.invoiceState?"0"===e.formModel.invoiceState?(e.operations[0].label="",e.operations[1].class="show",e.operations[1].label="撤销",e.operations[0].class="hidden"):"5"===e.formModel.invoiceState?(e.operations[0].label="查看电子发票",e.operations[0].class="show",e.operations[1].class="hidden"):"4"===e.formModel.invoiceState?(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].label="已撤销",e.operations[1].class="show",e.formModel.invoiceState=""):e.operations[1].class="hidden":(e.operations[0].label="确认提交",e.operations[0].class="show",e.operations[1].class="hidden"),e.formModel.area.id||(e.formModel.area.id="1568"),e.deliverys=t.deliverys,e.deliverys.map((function(i){i.id===t.invoice.express&&(e.expressName=i.name)})),e.getLogs(),e.loading=!1}),(function(t){e.loading=!1,e.formModel=e.clear()}))},handleOperate:function(e){this[e]()},save:function(){var e=this;this.$refs.formModel.validate((function(t){t&&(e.loading=!0,console.log("id="),console.log(e.formModel.id),e.formModel.id?("0"===e.formModel.invoiceMode?"0"===e.formModel.invoiceState?e.formModel.invoiceState="1":"1"===e.formModel.invoiceState?e.formModel.invoiceState="2":"2"===e.formModel.invoiceState?e.formModel.invoiceState="3":e.formModel.invoiceState="0":"0"===e.formModel.invoiceState?e.formModel.invoiceState="1":"4"!==e.formModel.invoiceState&&""!==e.formModel.invoiceState||(e.formModel.invoiceState="0"),"0"===e.formModel.invoiceMode?"2"===e.formModel.invoiceState?(e.formModel.express="",e.formModel.expressCode="",e.loading=!1,e.showInvoiceExpress=!0):"3"===e.formModel.invoiceState?(e.formModel.invoiceState="2",e.expressInfo(),e.showLogisticsFollowing=!0):(e.formModel.orderId=e.itemId,l["a"].invoiceDetailUpdate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage),"3"===e.formModel.invoiceState?e.formModel.invoiceState="2":"2"===e.formModel.invoiceState?e.formModel.invoiceState="1":(e.formModel.invoiceState,e.formModel.invoiceState="0")}))):"5"===e.formModel.invoiceState?(e.getList(),e.previewInvoice=!0,e.loading=!1):(e.formModel.orderId=e.itemId,l["a"].invoiceDetailUpdate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)})))):(e.formModel.invoiceState="0",e.formModel.orderId=e.itemId,l["a"].invoiceDetailCreate(e.formModel,(function(t){e.$message.success("保存成功"),e.getList(),e.$emit("operationSuccess"),e.loading=!1}),(function(t){e.loading=!1,e.$message.warning(t.errorMessage)}))))}))}})},S=x,C=(i("db67"),Object(_["a"])(S,a,r,!1,null,null,null));t["a"]=C.exports},d13b:function(e,t,i){},d158:function(e,t,i){"use strict";var a=i("c162"),r=i.n(a);r.a},d198:function(e,t,i){},d335:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"biz-company-selector"},[i("el-select",{attrs:{placeholder:"请选择一级运营商",clearable:""},on:{change:e.firstCompanyChange},model:{value:e.firstCompany,callback:function(t){e.firstCompany=t},expression:"firstCompany"}},e._l(e.firstCompanyList,(function(e){return i("el-option",{key:e.index,attrs:{label:e.name,value:e.id}})})),1),0!==e.secondCompanyList.length?i("el-select",{attrs:{placeholder:"请选择二级运营商",clearable:""},on:{change:e.secondCompanyChange},model:{value:e.secondCompany,callback:function(t){e.secondCompany=t},expression:"secondCompany"}},e._l(e.secondCompanyList,(function(e){return i("el-option",{key:e.index,attrs:{label:e.name,value:e.id}})})),1):e._e(),0!==e.thirdCompanyList.length?i("el-select",{attrs:{placeholder:"请选择三级运营商",clearable:""},on:{change:e.thirdCompanyChange},model:{value:e.thirdCompany,callback:function(t){e.thirdCompany=t},expression:"thirdCompany"}},e._l(e.thirdCompanyList,(function(e){return i("el-option",{key:e.index,attrs:{label:e.name,value:e.id}})})),1):e._e()],1)},r=[],o=(i("d81d"),i("b0c0"),i("b64b"),i("d3b7"),i("07ac"),i("2497")),s=i("bc3a"),n=i.n(s),l="/admin/company/json/list.jhtml",d="/admin/company/queryParentCompanyTree.jhtml",c={queryList:function(e,t,i){n.a.get(l,{params:e}).then(Object(o["a"])(t,i)).catch((function(e){console.error(e)}))},queryParent:function(e,t,i){n.a.get(d,{params:e}).then(Object(o["a"])(t,i)).catch((function(e){console.error(e)}))}},p={name:"BizCompanySelector",props:{value:{type:Object,default:function(){return{id:"",name:""}}},queryParent:{type:Boolean,default:function(){return!1}}},data:function(){return{firstCompany:"",secondCompany:"",thirdCompany:"",firstCompanyList:[],secondCompanyList:[],thirdCompanyList:[]}},components:{},methods:{queryCompanyList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise((function(i,a){var r={parentId:t};c.queryList(r,(function(t){i(e.formatList(t.content))}),(function(e){a(e)}))}))},firstCompanyChange:function(e){var t=this;this.secondCompany="",this.thirdCompany="",this.secondCompanyList=[],this.thridCompanyList=[],e&&(this.$emit("input",this.findInfo(e,0)),this.queryCompanyList(e).then((function(e){t.secondCompanyList=e})))},secondCompanyChange:function(e){var t=this;this.thirdCompany="",this.thridCompanyList=[],e&&(this.$emit("input",this.findInfo(e,1)),this.queryCompanyList(e).then((function(e){t.thridCompanyList=e})))},thirdCompanyChange:function(e){e&&this.$emit("input",this.findInfo(e,2))},findInfo:function(e,t){var i={id:e,name:""};switch(t){case 0:this.firstCompanyList.map((function(t){t.id===e&&(i.name=t.name)}));break;case 1:this.secondCompanyList.map((function(t){t.id===e&&(i.name=t.name)}));break;case 2:this.thridCompanyList.map((function(t){t.id===e&&(i.name=t.name)}));break;default:break}return i},formatList:function(e){for(var t=[],i=Object.keys(e),a=Object.values(e),r=0;r<i.length;r++)t.push({id:i[r],name:a[r]});return t},queryParentCompany:function(e){return new Promise((function(t,i){var a={companyId:e};c.queryParent(a,(function(e){var i=[];e.parentCompanyTrees&&(i=e.parentCompanyTrees.map((function(e){return e.id}))),t(i)}),(function(e){i(e)}))}))}},mounted:function(){var e=this;this.queryCompanyList().then((function(t){e.firstCompanyList=t}))},watch:{value:function(e,t){var i=this;e.id?this.queryParent&&this.queryParentCompany(e.id).then((function(e){e[0]&&(i.firstCompany=e[0],i.firstCompanyChange(e[0]),e[1]&&(i.secondCompany=e[1],i.secondCompanyChange(e[1]),e[2]&&(i.thirdCompany=e[2],i.thirdCompanyChange(e[2]))))})):(this.firstCompany="",this.secondCompany="",this.thirdCompany="",this.secondCompanyList=[],this.thirdCompanyList=[])}}},m=p,u=(i("4f2a9"),i("2877")),f=Object(u["a"])(m,a,r,!1,null,null,null),h=f.exports;t["a"]=h},d437:function(e,t,i){},d438:function(e,t,i){"use strict";var a=i("e647"),r=i.n(a);r.a},d47e:function(e,t,i){},d48f:function(e,t,i){},d4c2:function(e,t,i){"use strict";var a=i("e725"),r=i.n(a);r.a},d4ec:function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i.d(t,"a",(function(){return a}))},d79d:function(e,t,i){"use strict";var a=i("2b9a"),r=i.n(a);r.a},d819:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"return-apply-base-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}):e._e(),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px",size:"small",disabled:!e.isEdit,"inline-message":!0}},[e.itemId?i("el-form-item",{attrs:{label:"编号",prop:"sn"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.sn,callback:function(t){e.$set(e.form,"sn",t)},expression:"form.sn"}})],1):e._e(),i("el-form-item",{staticClass:"isRequired",attrs:{label:"供应商",prop:"relatePartnerId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择供应商",disabled:!("0"===e.form.state||!e.itemId)},on:{change:e.relatePartnerNameChange},model:{value:e.form.relatePartnerId,callback:function(t){e.$set(e.form,"relatePartnerId",t)},expression:"form.relatePartnerId"}},e._l(e.relatePartnerList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"关联的采购入库单",prop:"relateBillSn"}},[i("el-input",{attrs:{disabled:""===e.form.relatePartnerId||e.isPend,placeholder:"请选择关联的采购入库单"},on:{focus:e.showDialog},model:{value:e.form.relateBillSn,callback:function(t){e.$set(e.form,"relateBillSn",t)},expression:"form.relateBillSn"}})],1),i("el-form-item",{attrs:{label:"优惠率(%)",prop:"discountRate"}},[i("el-input",{attrs:{disabled:e.isPend},on:{change:e.rateChange},model:{value:e.form.discountRate,callback:function(t){e.$set(e.form,"discountRate",t)},expression:"form.discountRate"}})],1),e.itemId?i("el-form-item",{attrs:{label:"优惠金额(元)",prop:"discontFee"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.discontFee,callback:function(t){e.$set(e.form,"discontFee",t)},expression:"form.discontFee"}})],1):e._e(),e.itemId?i("el-form-item",{attrs:{label:"总金额(元)",prop:"totalFee"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.totalFee,callback:function(t){e.$set(e.form,"totalFee",t)},expression:"form.totalFee"}})],1):e._e(),e.itemId?i("el-form-item",{attrs:{label:"创建人",prop:"applierName"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.applierName,callback:function(t){e.$set(e.form,"applierName",t)},expression:"form.applierName"}})],1):e._e(),e.itemId?i("el-form-item",{attrs:{label:"状态",prop:"state"}},[i("el-input",{attrs:{value:e.stateFormatter,disabled:!0}})],1):e._e(),e.itemId?i("el-form-item",{attrs:{label:"创建时间",prop:"createDate"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.form.createDate,callback:function(t){e.$set(e.form,"createDate",t)},expression:"form.createDate"}})],1):e._e(),i("el-form-item",{attrs:{label:"备注",prop:"remark"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),i("biz-dialog-selector",{staticClass:"depotInDialog",attrs:{title:"选择关联入库单",visibility:e.showRelateDialog,appendToBody:!0,tableData:e.dialogTableData,pagination:e.dialogPagination,selectionMode:"single",isClear:!1,filters:e.dialogFilters},on:{"update:visibility":function(t){e.showRelateDialog=t},open:e.opened,confirmed:e.handleConfirmed,filterDataChange:e.dialogFilterDataChange,pageSizeChange:e.dialogPageSizeChange,currentPageChange:e.dialogCurrentPageChange}},[i("el-table-column",{attrs:{label:"编号",prop:"sn","min-width":"200"}}),i("el-table-column",{attrs:{label:"商品信息","min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[i("div",{staticStyle:{width:"100%","margin-right":"30px"}},e._l(t.row.itemDatas,(function(t){return i("div",{key:t.id,staticClass:"product-info",staticStyle:{display:"flex",width:"100%"}},[i("div",{staticClass:"wrapper"},[i("div",{staticClass:"titleClass",staticStyle:{"text-overflow":"ellipsis",overflow:"hidden",width:"250px","white-space":"nowrap"},attrs:{title:t.productName}},[e._v(e._s(t.productName))])]),i("div",{staticClass:"info-bottom"},[i("div",[e._v(" *"+e._s(t.amount))])])])})),0)])]}}])}),i("el-table-column",{attrs:{label:"往来方",prop:"relatePartnerName","min-width":"200"}})],1)],1)},r=[],o=(i("d81d"),i("b0c0"),i("a9e3"),i("d3b7"),i("b85c")),s=i("5530"),n=i("f36f"),l=i("8330"),d=i("af3f"),c=i("2f62"),p=i("1ab1"),m=i("c596"),u=function(){return{relatePartnerId:"",relatePartnerName:"",relatePartnerType:"",totalFee:"",billType:"",sn:"",applierId:"",applierName:"",relateBill:"",relateBillSn:"",relateBillType:"",discountRate:"0",discontFee:"",auditLevel:"",state:"",id:"",createDate:"",shopId:"",shop:{}}},f={name:"baseInfo",props:{itemId:{type:String},isEdit:{type:Boolean,default:function(){return!0}},isPend:{type:Boolean,default:function(){return!1}}},components:{BizGrid:n["a"],BizSaveButton:l["a"],BizDialogSelector:d["a"]},data:function(){var e=this,t=function(t,i,a){""===e.form.discountRate&&a(new Error("请输入优惠率")),Number(e.form.discountRate)>=0&&Number(e.form.discountRate)<=100?a():a(new Error("优惠率必须为0~100的数字值"))};return{loading:!1,showRelateDialog:!1,dialogVisible:!1,relatePartnerList:[],relateBillList:[],form:u(),totalFee:0,itemDatas:[],operations:[{label:"保存",name:"save",type:"primary"}],dialogTableData:[],dialogPagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},dialogFilters:[{type:"input",label:"",placeholder:"请输入供应商名称",name:"searchValue",value:""}],rules:{relatePartnerId:[{required:!0,message:"请选择供应商",trigger:["blur","change"]}],discountRate:[{required:!0,trigger:"blur",validator:t}],relateBillSn:[{required:!0,message:"请选择关联的采购入库单",trigger:"blur"}]}}},computed:{stateFormatter:function(){switch(this.form.state){case"0":return"已创建";case"1":return"已提交";case"2":return"审核中";case"3":return"已通过";case"4":return"已驳回";default:return"--"}}},created:function(){this.getSupplier()},watch:{itemId:function(e){this.form=this.getDefaultModel(),this.totalFee="",this.queryPurchase()}},methods:Object(s["a"])(Object(s["a"])({},Object(c["c"])(["getUser"])),{},{operate:function(e){this[e]()},showDialog:function(){this.showRelateDialog=!0,this.form.relateBillSn&&this.$refs.form.clearValidate("relateBillSn")},initModel:function(e){e?(this.form=Object.assign(this.getDefaultModel(),e),this.totalFee=Number(e.totalFee)+Number(e.discontFee)):this.resetModel()},resetModel:function(){this.form=this.getDefaultModel(),this.$refs.form.resetFields()},rateChange:function(e){this.form.discontFee=this.totalFee*(Number(e)/100),this.form.totalFee=this.totalFee-Number(this.form.discontFee)},queryPurchase:function(){var e=this;this.loading=!0,p["a"].get(m["g"].invoicing.purchaseReturnApplyMgmt.shopPurchaseReturnApply,{shopId:window.top.SHOP_ID||"",id:this.itemId}).then((function(t){e.loading=!1,e.initModel(t.data)})).catch((function(t){e.loading=!1,console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},getDefaultModel:function(){return u()},getSaveParams:function(){return{id:this.form.id,relatePartnerId:this.form.relatePartnerId,totalFee:this.form.totalFee,discountRate:this.form.discountRate,discontFee:this.form.discontFee,relateBill:this.form.relateBill,relateBillSn:this.form.relateBillSn,remark:this.form.remark,shopId:window.top.SHOP_ID||""}},save:function(){var e=this;this.$refs.form.validate((function(t,i){if(!t)return!1;e.loading=!0;var a=function(t){e.$message.success("保存成功"),e.form.id||(e.form.id=t.id,e.$emit("setBaseItems",e.form.id)),e.$emit("operationSuccess",e.form.id)},r=function(t){t.errorMessage&&e.$message.warning(t.errorMessage)},o=function(t){e.loading=!1};e.form.id?p["a"].put(m["g"].invoicing.purchaseReturnApplyMgmt.shopPurchaseReturnApply,e.getSaveParams()).then(a).catch(r).finally(o):p["a"].post(m["g"].invoicing.purchaseReturnApplyMgmt.shopPurchaseReturnApply,e.getSaveParams()).then(a).catch(r).finally(o)}))},opened:function(){this.dialogTableData=[],this.getSupplierDepotIn(this.form.relatePartnerId)},getSupplier:function(){var e=this,t={shopId:window.top.SHOP_ID||""};p["a"].get(m["g"].invoicing.purchaseReturnApplyMgmt.relateSupplier,t).then((function(t){e.relatePartnerList=t.dataList})).catch((function(t){"店铺不存在"!==t.errorMessage&&(e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t))})).finally((function(t){e.loading=!1}))},getSupplierDepotIn:function(e){var t=this,i={shopId:window.top.SHOP_ID||"",supplierId:e};p["a"].get(m["g"].invoicing.purchaseReturnApplyMgmt.supplierDepotIn,i).then((function(e){t.dialogTableData=e.dataList,t.dialogPagination.total=Number(e.total)})).catch((function(e){t.$message.warning(e.errorMessage),console.log("ERR_REFRESH: ",e)})).finally((function(e){t.loading=!1}))},relatePartnerNameChange:function(e){var t,i=Object(o["a"])(this.relatePartnerList);try{for(i.s();!(t=i.n()).done;){var a=t.value;e===a.id&&(this.form.relatePartnerId=a.id,this.form.relatePartnerName=a.name,this.form.relateBill="")}}catch(r){i.e(r)}finally{i.f()}},setOrderItems:function(e){this.itemDatas=e;var t=0;e.map((function(e){t+=Number(e.amount)*Number(e.price)})),this.totalFee=t,this.form.discontFee=t*(this.form.discountRate/100),this.form.totalFee=t-this.form.discontFee},dialogPageSizeChange:function(e){this.dialogPagination.pageSize=e,this.getSupplierDepotIn(this.form.relatePartnerId)},dialogCurrentPageChange:function(e){this.dialogPagination.currentPage=e,this.getSupplierDepotIn(this.form.relatePartnerId)},dialogFilterDataChange:function(e){this.dialogFilters=e,this.dialogPagination.currentPage=1,this.getSupplierDepotIn(this.form.relatePartnerId)},getDepotInDiscountRate:function(e){var t=this,i={id:e};p["a"].get(m["g"].invoicing.purchaseReturnApplyMgmt.depotInDiscountRate,i).then((function(e){t.form.discountRate=e.data.discountRate})).catch((function(e){t.$message.warning(e.errorMessage),console.log("ERR_REFRESH: ",e)})).finally((function(e){t.loading=!1}))},handleConfirmed:function(e,t){this.form.relateBill=t[0].id,this.form.relateBillSn=t[0].sn,this.getDepotInDiscountRate(this.form.relateBill),this.$refs.form.clearValidate("relateBillSn")}})},h=f,g=(i("4e34"),i("2877")),b=Object(g["a"])(h,a,r,!1,null,null,null);t["a"]=b.exports},d9b9:function(e,t,i){},db67:function(e,t,i){"use strict";var a=i("d13b"),r=i.n(a);r.a},dbe8:function(e,t,i){"use strict";var a=i("2330"),r=i.n(a);r.a},e0d7:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"membership-mgmt__base-info"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}):e._e(),i("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,disabled:!e.isEdit,":inline-message":!0}},[i("el-collapse",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-collapse-item",{attrs:{title:"基本信息",name:"baseInfo"}},["1"===e.formModel.memberType?i("div",[e.formModel.photo?i("el-form-item",{attrs:{label:"人像"}},[i("img",{attrs:{src:e.formModel.photo,width:"60px"}})]):e._e(),i("el-form-item",{attrs:{label:"企业名",prop:"enterpriseName"}},[i("el-input",{model:{value:e.formModel.enterpriseName,callback:function(t){e.$set(e.formModel,"enterpriseName",t)},expression:"formModel.enterpriseName"}})],1),i("el-form-item",{attrs:{label:"关联V服店铺",prop:"enterprise"}},[i("el-input",{attrs:{disabled:""},model:{value:e.formModel.enterprise,callback:function(t){e.$set(e.formModel,"enterprise",t)},expression:"formModel.enterprise"}})],1),i("el-form-item",{attrs:{label:"联系人",prop:"contactPerson"}},[i("el-input",{model:{value:e.formModel.contactPerson,callback:function(t){e.$set(e.formModel,"contactPerson",t)},expression:"formModel.contactPerson"}})],1),i("el-form-item",{attrs:{label:"电话",prop:"contactMobile"}},[i("el-input",{model:{value:e.formModel.contactMobile,callback:function(t){e.$set(e.formModel,"contactMobile",t)},expression:"formModel.contactMobile"}})],1)],1):e._e(),"0"===e.formModel.memberType?i("div",[i("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[i("el-input",{attrs:{type:"phone",maxlength:"11",placeholder:"请输入手机号"},on:{blur:e.mobileBlur},model:{value:e.formModel.mobile,callback:function(t){e.$set(e.formModel,"mobile",t)},expression:"formModel.mobile"}})],1),i("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[i("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.formModel.userName,callback:function(t){e.$set(e.formModel,"userName",t)},expression:"formModel.userName"}})],1),i("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[i("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.formModel.nickname,callback:function(t){e.$set(e.formModel,"nickname",t)},expression:"formModel.nickname"}})],1),i("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[i("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.formModel.realName,callback:function(t){e.$set(e.formModel,"realName",t)},expression:"formModel.realName"}})],1),e.formModel.id?e._e():i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{attrs:{type:"text",placeholder:"请输入6-16位密码"},model:{value:e.formModel.password,callback:function(t){e.$set(e.formModel,"password",t)},expression:"formModel.password"}})],1),i("el-form-item",{attrs:{label:"性别",prop:"gender"}},[i("el-radio-group",{model:{value:e.formModel.gender,callback:function(t){e.$set(e.formModel,"gender",t)},expression:"formModel.gender"}},[i("el-radio",{attrs:{label:"0"}},[e._v("男")]),i("el-radio",{attrs:{label:"1"}},[e._v("女")]),i("el-radio",{attrs:{label:"2"}},[e._v("保密")])],1)],1),i("el-form-item",{attrs:{label:"出生日期",prop:"birth"}},[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入出生日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.formModel.birth,callback:function(t){e.$set(e.formModel,"birth",t)},expression:"formModel.birth"}})],1),i("el-form-item",{attrs:{label:"挪车码",prop:"moveCarCode"}},[i("el-input",{attrs:{disabled:""},model:{value:e.formModel.moveCarCode,callback:function(t){e.$set(e.formModel,"moveCarCode",t)},expression:"formModel.moveCarCode"}})],1)],1):e._e(),i("el-form-item",{attrs:{label:"专属顾问",prop:"consultant"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择专属顾问"},model:{value:e.formModel.consultant.id,callback:function(t){e.$set(e.formModel.consultant,"id",t)},expression:"formModel.consultant.id"}},e._l(e.consultant,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"地址"}},[i("biz-area-select",{attrs:{areaId:e.formModel.area.id},on:{areaChanged:e.handleAreaChanged}})],1):e._e(),"1"===e.formModel.memberType?i("el-form-item",{attrs:{label:"地址"}},[i("el-input",{model:{value:e.formModel.address,callback:function(t){e.$set(e.formModel,"address",t)},expression:"formModel.address"}})],1):e._e(),i("el-form-item",{attrs:{label:"状态",prop:"enableState"}},[i("el-switch",{attrs:{"active-value":"1","inactive-color":"#d9d9d9","active-color":"#87d068","inactive-value":"0"},model:{value:e.formModel.enableState,callback:function(t){e.$set(e.formModel,"enableState",t)},expression:"formModel.enableState"}})],1),e.formModel.id?i("el-form-item",{attrs:{label:"用户来源"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:""},model:{value:e.formModel.userSource,callback:function(t){e.$set(e.formModel,"userSource",t)},expression:"formModel.userSource"}},e._l(e.sourceList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),i("el-form-item",{attrs:{label:"会员标签"}},[i("div",{staticStyle:{display:"flex","flex-flow":"wrap"}},[e._l(e.formModel.shopTags,(function(t,a){return i("el-popover",{key:a,attrs:{placement:"bottom-end",width:"200",trigger:"hover"}},[i("div",[e._v(" "+e._s("0"===t.hierarchy?"平台级":"1"===t.hierarchy?"店铺级":"2"===t.hierarchy?"运营商级":"3"===t.hierarchy?"模板级":"用户级")+", 来源："+e._s(t.tagCategory?t.tagCategory.fullName:"")+" ")]),i("div",{staticClass:"tag-container",attrs:{slot:"reference"},slot:"reference"},[i("el-tag",{staticClass:"member-tag",attrs:{closable:!t.deletable||"0"!==t.deletable},on:{close:function(i){return e.onClose(t)}}},[e._v(" "+e._s(t.name))])],1)])})),i("div",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onClickHandle}},[e._v("+")])],1)],2)])],1),i("el-collapse-item",{attrs:{title:"所属店铺",name:"shopInfo"}},[i("el-table",{attrs:{size:"small",data:e.formModel.shops}},[i("el-table-column",{attrs:{label:"店铺名称",prop:"name"}}),i("el-table-column",{attrs:{label:"详细地址",prop:"address"}}),i("el-table-column",{attrs:{label:"销售电话",prop:"mobile"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleDeleteClick(t.row)}}},[e._v("删除")])]}}])})],1)],1),i("el-collapse-item",{attrs:{title:"扩展信息",name:"advanceInfo"}},["0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"情感状态",prop:"emotionalState"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.emotionalState,callback:function(t){e.$set(e.formModel,"emotionalState",t)},expression:"formModel.emotionalState"}},e._l(e.emotionalStateList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"家庭身份",prop:"familialIdentity"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.familialIdentity,callback:function(t){e.$set(e.formModel,"familialIdentity",t)},expression:"formModel.familialIdentity"}},e._l(e.familialIdentityList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"社会身份",prop:"socialIdentity"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.socialIdentity,callback:function(t){e.$set(e.formModel,"socialIdentity",t)},expression:"formModel.socialIdentity"}},e._l(e.socialIdentityList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"学历",prop:"education"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.education,callback:function(t){e.$set(e.formModel,"education",t)},expression:"formModel.education"}},e._l(e.educationList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"===e.formModel.memberType?i("el-form-item",{attrs:{label:"收入状况",prop:"incomeState"}},[i("el-select",{attrs:{clearable:""},model:{value:e.formModel.incomeState,callback:function(t){e.$set(e.formModel,"incomeState",t)},expression:"formModel.incomeState"}},e._l(e.incomeStateList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!!e.formModel.id,expression:"!!formModel.id"}],attrs:{label:"创建日期",prop:"name"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.formModel.createDate))])]),"0"===e.formModel.memberType?i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!!e.formModel.id,expression:"!!formModel.id"}],attrs:{label:"最后登录地址",prop:"name"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.formModel.loginAddress||e.formModel.lastLoginIp))])]):e._e(),"0"===e.formModel.memberType?i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!!e.formModel.id,expression:"!!formModel.id"}],attrs:{label:"最后登录日期",prop:"name"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.formModel.lastLoginDate))])]):e._e()],1)],1),i("el-dialog",{staticClass:"member-ship-info",attrs:{title:"添加标签",visible:e.showSelecTags,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.showSelecTags=t}}},[i("div",{staticClass:"member-ship-select-tag"},[i("div",{staticClass:"tag-type"},[i("div",{staticClass:"handel-name"},[e._v("标签种类")]),i("el-cascader",{attrs:{options:e.tagTypeOptions},on:{change:e.tagTypeChange},model:{value:e.tagClass,callback:function(t){e.tagClass=t},expression:"tagClass"}})],1),i("div",{staticClass:"tag-type"},[i("div",{staticClass:"handel-name"},[e._v("标签")]),i("el-cascader",{attrs:{options:e.tagOptions},on:{change:e.tagChange},model:{value:e.selectTag,callback:function(t){e.selectTag=t},expression:"selectTag"}})],1)]),i("biz-save-button",{attrs:{slot:"footer",operations:e.tagOperations},on:{operate:e.tagOperate},slot:"footer"})],1)],1)],1)},r=[],o=(i("4160"),i("c975"),i("d81d"),i("45fc"),i("a434"),i("b0c0"),i("d3b7"),i("159b"),i("5530")),s=i("b85c"),n=i("f36f"),l=i("8330"),d=i("ce2e"),c=i("0e5e"),p=i("c596"),m=i("1ab1"),u=i("c466"),f=i("2f62"),h={data:{activeTab:["baseInfo"],emotionalStateList:[{value:"0",label:"单身贵族"},{value:"1",label:"热恋期"},{value:"2",label:"有家室"}],familialIdentityList:[{value:"0",label:"宝妈"},{value:"1",label:"宝爸"},{value:"2",label:"我还是个宝宝"}],socialIdentityList:[{value:"0",label:"白领"},{value:"1",label:"蓝领"},{value:"2",label:"在校学生"},{value:"3",label:"自由职业"},{value:"4",label:"创业者"},{value:"5",label:"农民"},{value:"6",label:"无业游民"}],educationList:[{value:"0",label:"高中及以下"},{value:"1",label:"专科"},{value:"2",label:"本科"},{value:"3",label:"研究生"},{value:"4",label:"博士生"}],incomeStateList:[{value:"0",label:"入不敷出"},{value:"1",label:"收支平衡"},{value:"2",label:"小康家庭"},{value:"3",label:"富裕家庭"},{value:"4",label:"财务自由"}],tagClass:[],memberTags:[],showSelecTags:!1,brandList:[],seriesList:[],modeList:[],tagTypeOptions:[],tagOptions:[],selectTag:[],arryList:[],tagOperations:[{label:"取消",name:"cancel"},{label:"确认选择",name:"confirm",type:"primary"}],operations:[{label:"保存",name:"save",type:"primary"}],consultant:[],areaId:"1568",sourceList:[{value:"0",label:"推荐注册"},{value:"1",label:"潜客转化"},{value:"2",label:"正常注册"},{value:"3",label:"后台创建"},{value:"4",label:"其他"}]},events:{handleOperate:function(e){this[e]()},tagOperate:function(e){this[e]()}},methods:{}},g=function(){return{gender:"2",enableState:"1",password:"123456",area:{id:"1568"},consultant:{id:""},areaId:"1568",shopTags:[],memberType:"0",enterpriseName:"",enterprise:"",contactPerson:"",contactMobile:"",defaultCarInfo:{plateNumber:"",brand:"",series:"",type:"",vin:""},moveCarCode:"",emotionalState:"",familialIdentity:"",socialIdentity:"",education:"",incomeState:""}},b={data:{loading:!1,formModel:g(),pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}}},events:{handleAreaChanged:function(e){console.log(222),this.formModel.area.id=e}},methods:{mobileBlur:function(){this.formModel.id||this.formModel.nickname||this.$set(this.formModel,"nickname",this.formModel.mobile),this.formModel.id||this.formModel.userName||this.$set(this.formModel,"userName",this.formModel.mobile),this.$refs.form.clearValidate()},handleDeleteClick:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,m["a"].delete("/admin/member/relateShop.jhtml",{shopId:e.id,id:t.itemId.id}).then((function(i){t.formModel.shops.splice(t.formModel.shops.indexOf(e),1),t.$message.success("删除成功")})).catch((function(e){console.log(e),console.log("code错误"),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))}))},handleBrandChange:function(e){this.querySeriesList(e),this.formModel.defaultCarInfo.series="",this.formModel.defaultCarInfo.type=""},handleSeriesChange:function(e){this.queryTypeList(e),this.formModel.defaultCarInfo.type=""},querySeriesList:function(e){var t=this;c["a"].querySeriesList({brand:e},(function(e){t.seriesList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},queryBrandList:function(){var e=this;c["a"].queryBrandList({},(function(t){e.brandList=t.dataList}),(function(e){console.log(e),console.log("code错误")}))},queryTypeList:function(e){var t=this;c["a"].queryTypeList({series:e,brand:this.formModel.defaultCarInfo.brand},(function(e){t.modeList=e.dataList?e.dataList:[]}),(function(e){console.log(e),console.log("code错误")}))},cancel:function(){this.showSelecTags=!1},confirm:function(){var e;if(this.selectTag.length)if(e=this.selectTag[this.selectTag.length-1],this.containsSameTag(e))this.$message.warning("该标签已存在，请重新选择");else{var t,i,a="",r=Object(s["a"])(this.tagTypeOptions);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(2===this.tagClass.length){if(o.children){var n,l=Object(s["a"])(o.children);try{for(l.s();!(n=l.n()).done;){var d=n.value;this.tagClass[0]===o.value&&this.tagClass[1]===d.value&&(a="会员标签/"+o.label+"/"+d.label)}}catch(p){l.e(p)}finally{l.f()}}}else this.tagClass[0]===o.value&&(a="会员标签/"+o.label)}}catch(p){r.e(p)}finally{r.f()}this.arryList.map((function(i){i.name===e&&(t={id:i.id,name:i.name,hierarchy:i.hierarchy,tagCategory:{fullName:a}})})),this.showSelecTags=!1;var c=this.formModel.shopTags.some((function(e){if(e.name===t.name)return!0}));c||this.formModel.shopTags.push(t)}},onClickHandle:function(){this.showSelecTags=!0,this.selectTag=[],this.tagClass=[]},initModel:function(e){e?(this.formModel=Object.assign(this.getDefaultModel(),e),this.$set(this.formModel,"password",""),this.areaId=this.formModel.area.id||"1568"):this.resetModel()},resetModel:function(){this.formModel=this.getDefaultModel(),this.areaId="1568"},getDefaultModel:function(){return g()},query:function(e){var t=this;this.loading=!0;var i=this.itemId.id;e&&(i=e),m["a"].get(p["o"].baseInfo.query,{id:i,shopId:window.top.SHOP_ID||""}).then((function(e){t.initModel(e.memberData),t.checkIfAdmin()})).catch((function(e){console.log(e),console.log("code错误"),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},checkIfAdmin:function(){var e=this;console.log(this.consultant),m["a"].post("/admin/common/roleAdmins.jhtml",{roleTypes:["afterSaleAdmin","afterSale"]}).then((function(t){if(e.consultant=t.dataList,e.formModel.consultant.id){for(var i=!0,a=0;a<e.consultant.length;a++)e.consultant[a].id===String(e.formModel.consultant.id)&&(i=!1);i&&e.consultant.unshift({id:e.formModel.consultant.id,name:e.formModel.consultant.name})}})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},getConsultant:function(){var e=this;this.loading=!0,m["a"].post("/admin/common/roleAdmins.jhtml",{roleTypes:["afterSaleAdmin","afterSale"]}).then((function(t){e.consultant=t.dataList})).catch((function(e){console.log(e),console.log("code错误")})).finally((function(){e.loading=!1}))},getSaveParams:function(){return{token:"",shopId:window.top.SHOP_ID||"",consultant:{id:this.formModel.consultant.id},id:this.formModel.id,area:{id:this.formModel.area.id},userName:this.formModel.userName,mobile:this.formModel.mobile,password:this.formModel.password,realName:this.formModel.realName,nickname:this.formModel.nickname,gender:this.formModel.gender,birth:u["a"].dateConverter(this.formModel.birth),enableState:this.formModel.enableState,userSource:this.formModel.userSource,shopTags:this.formModel.shopTags,defaultCarInfo:{plateNumber:this.formModel.defaultCarInfo.plateNumber,brand:this.formModel.defaultCarInfo.brand,series:this.formModel.defaultCarInfo.series,type:this.formModel.defaultCarInfo.type,vin:this.formModel.defaultCarInfo.vin},emotionalState:this.formModel.emotionalState,familialIdentity:this.formModel.familialIdentity,socialIdentity:this.formModel.socialIdentity,education:this.formModel.education,incomeState:this.formModel.incomeState}},containsSameTag:function(e){var t=!1;return this.formModel.shopTags.forEach((function(i){if(e===i)return t=!0,!1})),t},save:function(){var e=this;this.$refs.form.validate((function(t,i){if(!t)return!1;e.loading=!0;var a=function(t){e.$message.success("保存成功"),e.formModel.id||(e.formModel=e.getDefaultModel()),e.$emit("operationSuccess")},r=function(t){console.log(t),console.log("code错误"),e.$message.warning(t.errorMessage),"450"!==t.resultCode&&"1121"!==t.resultCode||e.query(t.memberId)},o=function(t){e.loading=!1},s=e.getSaveParams();e.formModel.id?m["a"].put(p["o"].baseInfo.update,s).then(a).catch(r).finally(o):m["a"].post(p["o"].baseInfo.create,s).then(a).catch(r).finally(o)}))},getTagClassList:function(){var e,t=this,i={categoryType:"会员标签"};"platform"===this.getUser.roleLevel?e=p["g"].systemSetting.platformTagcategories:"shop"===this.getUser.roleLevel&&(e=p["g"].systemSetting.storeTagcategories,i.shopId=window.top.SHOP_ID||""),m["a"].get(e,i).then((function(e){var i,a=e.content;t.tagTypeOptions=[],a.forEach((function(e){i={},i.label=e.name,i.value=e.id,t.tagTypeOptions.push(i),e.children&&e.children.length&&(i.children=[],e.children.forEach((function(e){var t={};t.label=e.name,t.value=e.id,i.children.push(t),e.children&&e.children.length&&(t.children=[],e.children.forEach((function(e){var i={};i.label=e.name,i.value=e.id,t.children.push(i),e.children&&e.children.length&&(i.children=[],e.children.forEach((function(e){var t={};t.label=e.name,t.value=e.id,i.children.push(t)})))})))})))}))})).catch((function(e){"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(){}))},onClose:function(e){for(var t=this.formModel.shopTags,i=t.length,a=0;a<i;a++)if(t[a]===e){t.splice(a,1);break}},tagChange:function(e){console.log(e)},tagTypeChange:function(e){var t,i=this,a=e[e.length-1],r={tagCategoryId:a};"platform"===this.getUser.roleLevel?t=p["g"].systemSetting.getPlatformTags:"shop"===this.getUser.roleLevel&&(t=p["g"].systemSetting.storeTags,r.shopId=window.top.SHOP_ID||""),m["a"].get(t,r).then((function(e){console.log(i.tagTypeOptions),i.tagOptions=[];var t,a=Object(s["a"])(e.content);try{for(a.s();!(t=a.n()).done;){var r=t.value;i.tagOptions.push({value:r.name,label:r.name,hierarchy:r.hierarchy})}}catch(o){a.e(o)}finally{a.f()}i.arryList=e.content,console.log(e)})).catch((function(e){console.warn(e)}))}}},v={name:"MembershipMgmtBaseInfo",components:{BizSaveButton:l["a"],BizGrid:n["a"],BizAreaSelect:d["a"]},data:function(){var e=this;return Object(o["a"])(Object(o["a"])(Object(o["a"])({},h.data),b.data),{},{rules:{userName:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[0-9a-zA-Z]+$/,message:"用户名只能为数字或字母",trigger:"blur"},{min:4,max:20,message:"长度在4-20位",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"}],realName:[{required:!0,trigger:"blur",message:"请输入姓名"}],zipCode:[{len:6,message:"邮编位数错误",trigger:"blur"},{pattern:/^[0-9]*$/,message:"邮编格式错误",trigger:"blur"}],enableState:[{required:!0,trigger:"blur",message:"请选择是否启用"}],password:[{required:!0,trigger:"blur",min:6,max:16,message:"长度在6-16个字符"}],rePassword:[{required:!1,trigger:"blur",message:"请再次输入密码"},{trigger:"blur",validator:function(t,i,a){e.formModel.password===e.formModel.rePassword?a():a(new Error("两次输入密码不一致"))}}],userSource:[{required:!0,trigger:"blur",message:"请选择用户来源"}]}})},props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},b.methods),b.events),h.methods),h.events),mounted:function(){console.log(111),this.initModel()},watch:{itemId:function(e,t){this.$refs.form.$el.scrollTop=0,this.$refs.form.clearValidate(),this.activeTab=["baseInfo"],e.id?e.id!==t.id&&(this.getConsultant(),this.query()):(this.getConsultant(),this.initModel())}},computed:Object(o["a"])(Object(o["a"])({},Object(f["c"])(["getUser"])),{},{dateRange:{get:function(){return[this.formModel.beginDate,this.formModel.endDate]},set:function(e){e?(this.formModel.beginDate=e[0],this.formModel.endDate=e[1]):(this.formModel.beginDate="",this.formModel.endDate="")}}}),created:function(){this.getTagClassList(),this.queryBrandList()}},y=v,_=(i("57a5"),i("2877")),I=Object(_["a"])(y,a,r,!1,null,null,null);t["a"]=I.exports},e2f0:function(e,t,i){"use strict";var a=i("9c7b"),r=i.n(a);r.a},e42c:function(e,t,i){"use strict";var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={listOrder:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.list,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},viewOrder:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.order:s["g"].orderMgmt.orderMgmt.order,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},updateOrder:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.order:s["g"].orderMgmt.orderMgmt.order,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createOrder:function(e,t,i){o.a.post("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.order:s["g"].orderMgmt.orderMgmt.order,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},excuteOrder:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.service:s["g"].orderMgmt.orderMgmt.service,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},closeOrder:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.close:s["g"].orderMgmt.orderMgmt.close,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},confirmOrder:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.confirm:s["g"].orderMgmt.orderMgmt.confirm,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},paymentOrder:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.payment:s["g"].orderMgmt.orderMgmt.payment,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},shippingOrder:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.shipping:s["g"].orderMgmt.orderMgmt.shipping,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},repairMaintainHistory:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.repairMaintainHistory,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listAdminByRole:function(e,t,i){o.a.post(s["g"].orderMgmt.orderMgmt.listAdminByRole,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listExistCardTemplate:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.listExistCardTemplate,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},viewProducts:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.viewProducts:s["g"].orderMgmt.orderMgmt.viewProducts,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},viewOrderlogs:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.viewOrderlogs:s["g"].orderMgmt.orderMgmt.viewOrderlogs,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},viewOrderRefunds:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.viewOrderRefunds:s["g"].orderMgmt.orderMgmt.viewOrderRefunds,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryInvoiceDetailByOrderID:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.queryInvoiceDetailByOrderID:s["g"].orderMgmt.orderMgmt.queryInvoiceDetailByOrderID,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceMail:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.invoiceMail:s["g"].orderMgmt.orderMgmt.invoiceMail,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceMailUpdate:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.invoiceMail:s["g"].orderMgmt.orderMgmt.invoiceMail,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceInfoDefault:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.invoiceInfoDefault:s["g"].orderMgmt.orderMgmt.invoiceInfoDefault,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceByOrder:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.invoiceByOrder:s["g"].orderMgmt.orderMgmt.invoiceByOrder,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceDetailCreate:function(e,t,i){o.a.post("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.invoice:s["g"].orderMgmt.orderMgmt.invoice,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceDetailUpdate:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.invoice:s["g"].orderMgmt.orderMgmt.invoice,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},invoiceDetail:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.invoiceDetail:s["g"].orderMgmt.orderMgmt.invoiceDetail,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},addOrderItems:function(e,t,i){o.a.post("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.addOrderItems:s["g"].orderMgmt.orderMgmt.addOrderItems,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},brands:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.brands,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},series:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.series,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},types:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.types,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},getFinancialPlans:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.getFinancialPlans,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},memberList:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.memberList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},options:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.options,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},rescuers:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.rescuers,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},export:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.export,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},rescueOrderLogs:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.rescueOrderLogs,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},loanTerms:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.loanTerms,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryOrderKpi:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.queryOrderKpi,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},refundsAudit:function(e,t,i){o.a.put("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.refundsAudit:s["g"].orderMgmt.orderMgmt.refundsAudit,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},rescuerSetting:function(e,t,i){o.a.put(s["g"].orderMgmt.orderMgmt.rescuerSetting,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},rescuerDispath:function(e,t,i){o.a.put(s["g"].orderMgmt.orderMgmt.rescuerDispath,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},carOptions:function(e,t,i){o.a.put(s["g"].orderMgmt.orderMgmt.carOptions,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createMember:function(e,t,i){o.a.post(s["g"].orderMgmt.orderMgmt.createMember,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},certificate:function(e,t,i){o.a.get("purchaseOrder"===window.top.dType?s["g"].orderMgmt.purchaseOrderMgmt.certificate:s["g"].orderMgmt.orderMgmt.certificate,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listProductByTestDrive:function(e,t,i){o.a.get(s["g"].orderMgmt.orderMgmt.listProductByTestDrive,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))}}},e4c3:function(e,t,i){"use strict";var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={queryPeople:function(e,t,i){o.a.get(s["g"].vehicleMgmt.Component_queryPeople,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryVehicles:function(e,t,i,r){o.a.get(e,{params:t}).then(Object(a["a"])(i,r)).catch((function(e){console.error(e)}))}}},e58c:function(e,t,i){"use strict";var a=i("fc6a"),r=i("a691"),o=i("50c4"),s=i("a640"),n=i("ae40"),l=Math.min,d=[].lastIndexOf,c=!!d&&1/[1].lastIndexOf(1,-0)<0,p=s("lastIndexOf"),m=n("indexOf",{ACCESSORS:!0,1:0}),u=c||!p||!m;e.exports=u?function(e){if(c)return d.apply(this,arguments)||0;var t=a(this),i=o(t.length),s=i-1;for(arguments.length>1&&(s=l(s,r(arguments[1]))),s<0&&(s=i+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:d},e647:function(e,t,i){},e685:function(e,t,i){"use strict";var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={listMsg:function(e,t,i){o.a.get(s["g"].newsMgmt.listMsg,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryMsg:function(e,t,i){o.a.get(s["g"].newsMgmt.queryMsg,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},listMsgType:function(e,t,i){o.a.get(s["g"].newsMgmt.listMsgType,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},deleteMsg:function(e,t,i){o.a.delete(s["g"].newsMgmt.queryMsg,{data:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},orderConfirm:function(e,t,i){o.a.get(s["g"].newsMgmt.confirmOrder,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},messagePendingDeal:function(e,t,i){o.a.put(s["g"].newsMgmt.messagePendingDeal,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))}}},e6d7:function(e,t,i){"use strict";var a=i("8d37"),r=i.n(a);r.a},e700:function(e,t,i){},e725:function(e,t,i){},e7ca:function(e,t,i){"use strict";var a=i("0346"),r=i.n(a);r.a},e83a:function(e,t,i){e.exports=i.p+"static/img/pic_default_none.8bd264ad.png"},e90e:function(e,t,i){"use strict";var a=i("a5eb"),r=i.n(a);r.a},ea36:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"bill-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return i("el-card",{key:t.id},[i("div",{on:{click:function(i){return e.selectItem(t)}}},[i("div",{staticClass:"top"},[i("span",[e._v(e._s(t.consignee))]),i("span",[e._v(e._s(t.phone))])]),i("div",{staticClass:"content"},[i("span",[e._v(e._s(t.areaName+t.address))])])]),i("div",{staticClass:"bottom"},["1"===t.isDefault?i("div",[e._v("默认")]):e._e(),"0"===t.isDefault?i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(i){e.$set(t,"isDefault",i)},expression:"receiver.isDefault"}},[e._v("设为默认 ")]):e._e(),i("div",{staticClass:"handler"},[i("i",{staticClass:"el-icon-edit-outline",on:{click:function(i){return e.editForm(t)}}},[e._v("编辑")]),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small"}},[i("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"省市"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},r=[],o=(i("d3b7"),i("5530")),s=i("f36f"),n=i("8330"),l=i("1ab1"),d=i("c596"),c=i("2f62"),p=i("ce2e"),m=i("f260"),u=i.n(m),f={components:{BizSaveButton:n["a"],BizAreaSelect:p["a"],BizGrid:s["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(o["a"])(Object(o["a"])({},Object(c["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+u.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(o["a"])(Object(o["a"])({},Object(c["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"].delete(d["g"].hypermarketMgmt.receiver,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].post(d["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].put(d["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.updateSelAddress(e),this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};l["a"].get(d["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},h=f,g=(i("b442"),i("2877")),b=Object(g["a"])(h,a,r,!1,null,null,null);t["a"]=b.exports},ec50:function(e,t,i){"use strict";i("a15b");var a=i("2497"),r=i("bc3a"),o=i.n(r),s=i("c596");t["a"]={queryList:function(e,t,i){o.a.get(s["g"].communiMgmt.Card_queryList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryCompanyList:function(e,t,i){o.a.get(s["g"].communiMgmt.Card_queryCompanyList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryTeleOperator:function(e,t,i){o.a.get(s["g"].communiMgmt.Card_queryTeleOperatorList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryOwnerList:function(e,t,i){o.a.get(s["g"].communiMgmt.Card_queryOwnerList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryBaseInfo:function(e,t,i){o.a.get(s["g"].communiMgmt.Card_queryBaseInfo,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},createBaseInfo:function(e,t,i){o.a.post(s["g"].communiMgmt.Card_createBaseInfo,{},{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},updateBaseInfo:function(e,t,i){o.a.post(s["g"].communiMgmt.Card_updateBaseInfo,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},deleteBaseInfo:function(e,t,i){var r=s["g"].communiMgmt.Card_deleteBaseInfo+"?ids=";r+=e.ids.join("&ids="),o.a.get(r).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},enable:function(e,t,i){var r=s["g"].communiMgmt.Card_enable+"?ids=";r+=e.ids.join("&ids="),o.a.get(r).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},disable:function(e,t,i){var r=s["g"].communiMgmt.Card_disable+"?ids=";r+=e.ids.join("&ids="),o.a.get(r).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},sendMsg:function(e,t,i){o.a.post(s["g"].communiMgmt.Card_sendMsg,e).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryRecordsList:function(e,t,i){o.a.get(s["g"].communiMgmt.Card_queryRecordsList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))},queryConsumeList:function(e,t,i){o.a.get(s["g"].communiMgmt.Card_queryConsumeList,{params:e}).then(Object(a["a"])(t,i)).catch((function(e){console.error(e)}))}}},ef0b:function(e,t,i){"use strict";var a=i("912a"),r=i.n(a);r.a},efa0:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{staticClass:"bill-info"},[i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.operate},slot:"top"}),e._l(e.receiverList,(function(t){return i("el-card",{key:t.id},[i("div",{on:{click:function(i){return e.selectItem(t)}}},[i("div",{staticClass:"top"},[i("span",[e._v(e._s(t.consignee))]),i("span",[e._v(e._s(t.phone))])]),i("div",{staticClass:"content"},[i("span",[e._v(e._s(t.areaName+t.address))])])]),i("div",{staticClass:"bottom"},["1"===t.isDefault?i("div",[e._v("默认")]):e._e(),"0"===t.isDefault?i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",size:"mini"},on:{change:function(i){return e.setDefault(t)}},model:{value:t.isDefault,callback:function(i){e.$set(t,"isDefault",i)},expression:"receiver.isDefault"}},[e._v("设为默认 ")]):e._e(),i("div",{staticClass:"handler"},[i("i",{staticClass:"el-icon-edit-outline",on:{click:function(i){return e.editForm(t)}}},[e._v("编辑")]),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteForm(t.id)}}},[e._v("删除")])])],1)])})),0===e.receiverList.length?i("div",{style:e.styleObject}):e._e(),i("el-dialog",{attrs:{visible:e.showForm,"append-to-body":"",height:"40%",width:"30%",center:""},on:{"update:visible":function(t){e.showForm=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"收货人姓名",prop:"consignee"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.consignee,callback:function(t){e.$set(e.form,"consignee",t)},expression:"form.consignee"}})],1),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"省市"}},[i("biz-area-select",{attrs:{areaId:e.form.area.id},on:{areaChanged:e.handleAreaChanged}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{type:"area",maxlength:"100"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("biz-save-button",{attrs:{operations:e.formOperations},on:{operate:e.operate}})],1)],1)],2)},r=[],o=(i("d3b7"),i("5530")),s=i("f36f"),n=i("8330"),l=i("1ab1"),d=i("c596"),c=i("2f62"),p=i("ce2e"),m=i("f260"),u=i.n(m),f={components:{BizSaveButton:n["a"],BizAreaSelect:p["a"],BizGrid:s["a"]},data:function(){return{receiverList:[],showForm:!1,operations:[{label:"添加",name:"add",type:"primary"}],formOperations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:"primary"}],rules:{consignee:[{required:!0,message:"请输入收货人姓名",trigger:["blur","change"]}],address:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}],phone:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{len:11,message:"手机号位数错误",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"手机号格式错误",trigger:"blur"}]},form:this.getDetaultModel()}},computed:Object(o["a"])(Object(o["a"])({},Object(c["c"])(["getUser"])),{},{styleObject:function(){return{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"200px",background:"url("+u.a+") 50% 50% / 300px no-repeat"}}}),created:function(){this.query()},methods:Object(o["a"])(Object(o["a"])({},Object(c["d"])("Order",["updateSelAddress"])),{},{operate:function(e){this[e]()},getDetaultModel:function(){return{consignee:"",phone:"",address:"",area:{id:"1568"},areaName:"",isDefault:"1"}},add:function(){this.showForm=!0,this.form=this.getDetaultModel()},cancel:function(){this.showForm=!1},editForm:function(e){this.form=Object.assign(this.getDetaultModel(),e),this.showForm=!0},deleteForm:function(e){var t=this,i={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,ids:[e]};this.$confirm("是否确认删除收货地址?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"].delete(d["g"].hypermarketMgmt.receiver,i).then((function(e){t.$message.success("删除成功"),t.query()})).catch((function(e){t.$message({message:e.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",e)})).finally((function(e){}))}))},save:function(){var e=this;this.$refs.form.validate((function(t,i){t&&(e.form.areaId=e.form.area.id,e.form.id?e.update():e.create())}))},create:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].post(d["g"].hypermarketMgmt.receiver,t).then((function(t){e.updateSelAddress(t.receivers[0]),e.$message.success("添加成功"),e.query(),e.showForm=!1})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},setDefault:function(e){e.isDefault="1",this.form=Object.assign(this.getDetaultModel(),e),this.update()},update:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id,receiver:this.form};l["a"].put(d["g"].hypermarketMgmt.receiver,t).then((function(t){e.$message.success("更新成功"),e.query(),e.showForm=!1,"1"===e.form.isDefault&&e.updateSelAddress(e.form)})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))},selectItem:function(e){this.updateSelAddress(e),this.$emit("selectedItem",e)},handleAreaChanged:function(e){this.form.area.id=e},query:function(){var e=this,t={clientType:"2",userId:this.getUser.id,shopId:this.getUser.shop.id};l["a"].get(d["g"].hypermarketMgmt.receiverList,t).then((function(t){e.receiverList=t.receivers||[],0===e.receiverList.length&&e.updateSelAddress({})})).catch((function(t){e.$message({message:t.errorMessage,type:"warning"}),console.log("ERR_REFRESH: ",t)})).finally((function(e){}))}})},h=f,g=(i("0130"),i("2877")),b=Object(g["a"])(h,a,r,!1,null,null,null);t["a"]=b.exports},f1b1:function(e,t,i){},f223:function(e,t,i){},f2d4:function(e,t,i){},f3ac:function(e,t,i){e.exports=i.p+"static/img/pic_default_none_100.6603f4ac.png"},f58e:function(e,t,i){"use strict";var a=i("b755"),r=i.n(a);r.a},f604:function(e,t,i){},f606:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFGmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMTEtMTRUMTU6MDE6MjIrMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTA4LTAzVDE5OjEzOjI1KzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTA4LTAzVDE5OjEzOjI1KzA4OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmQ0NWIyMzUyLWJhMzItNDM5NS1iZTliLTgxMTVhNjk1ODBhNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpkNDViMjM1Mi1iYTMyLTQzOTUtYmU5Yi04MTE1YTY5NTgwYTUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkNDViMjM1Mi1iYTMyLTQzOTUtYmU5Yi04MTE1YTY5NTgwYTUiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ0NWIyMzUyLWJhMzItNDM5NS1iZTliLTgxMTVhNjk1ODBhNSIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xNFQxNTowMToyMiswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+kgXFvQAAApVJREFUWIXNl09IVFEYxX/vda+roT9C6EYKkqB/kiEYhLRJB6qNbVrYqhbmYMteUIySrnqLFiEOLmoRumnTpo0pBEVQIARG0cLAqNBpUzIW6L1qi3f905s7zzfDG+zAW3x8Z945zH333vM5xITykEAa6ABagEPAXtP+BXwGpoDnwLj0UXHe68QQrgMyQF9cswYDwLD0yVdsQHncrUC4yIj06S/LgPI4AfSYJwnkgJz0eb+tAeVxDphISDiMdukzWdKA8jgKfKiS+DqOSZ+P64UbavZWWbxIY8OA+eCSWvMo9BgtwCyB2WrzNrbofQMNrZVJfX2LHjpdqlsvffLCFBkrpRZoaEUPOrBYpngKxB2FaOtGvxqxMTJAv2NOuGUbQ3SNQt1J9P3jZaqb36ezcOYmum93KUqNS3C82nHkErzIViQOoMcHwRVRlLRLcLbbsarR755u1inzlKqx1NHoEAQXix0h9yK7BoC+5djre6G6rRt2Rf4DLQJoLNn+8wNxexYen4X9p2BVQ+E7orkz6C8VAqHmTlicg8LcZq1+w/khmJ+OMtDoKI8loMbargVxfRb2HIBVBU8uQ/413PgGOPCoLeBdfQkrGkbMx5r5BK6EhS/oBwejdtBytIGtSBF/K8bnLrvAQhzm+nonzF1wgZnYb04eMy5BjNopTLkEGW6nMBF5FAOIa8+gMQ0rars9HYIDM+PohxejSDVC+ijlMYAt+6WAwxcqv4yya1E7YkD6qMjrWHSNQlNXmcohTI+hx67YOvXSJ78RyRJKwHGxkZTDmXCY6qeinPQ380c4Ew5VWbxI4x8DJq22V1G8fWsiLjJgTEwCTQTDRFLIAU3hmQD+19EsZGLnhtOQEdt4vs+0f1LheP4XcCzJ/0nFX0oAAAAASUVORK5CYII="},f65f:function(e,t,i){},f8a5:function(e,t,i){},f9a5:function(e,t,i){},fb19:function(e,t,i){},fd29:function(e,t,i){},fdfa:function(e,t,i){},ff5b:function(e,t,i){},ff9d:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"membership-mgmt__certification"},[e.isEdit?i("biz-save-button",{attrs:{slot:"top",operations:e.operations},on:{operate:e.handleOperate},slot:"top"}):e._e(),i("el-form",{ref:"form",attrs:{size:"small","label-width":"110px",model:e.formModel,rules:e.rules,disabled:!e.isEdit}},[i("el-form-item",{attrs:{label:"真实姓名"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.formModel.name))])]),i("el-form-item",{attrs:{label:"证件类型"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.type))])]),i("el-form-item",{attrs:{label:"证件号码"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.formModel.number))])]),i("el-form-item",{attrs:{label:"证件照片"}},[e.formModel.backgroundImg?i("img",{staticClass:"uploaded-image",attrs:{src:e.formModel.backgroundImg},on:{click:function(t){return e.handleImageClick(t,e.formModel.backgroundImg)}}}):e._e(),e.formModel.positiveImg?i("img",{staticClass:"uploaded-image",attrs:{src:e.formModel.positiveImg},on:{click:function(t){return e.handleImageClick(t,e.formModel.positiveImg)}}}):e._e()]),i("el-form-item",{attrs:{label:"认证状态"}},[i("span",{staticClass:"form-static"},[e._v(e._s(e.state))])])],1),i("el-dialog",{staticClass:"avatar-preview-dialog",attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"review"},[i("img",{attrs:{src:e.imgUrl,alt:""}})])])],1)},r=[],o=(i("a9e3"),i("d3b7"),i("5530")),s=i("f36f"),n=i("8330"),l=i("c596"),d=i("1ab1"),c={data:{operations:[{label:"通过",name:"pass",type:"primary"},{label:"不通过",name:"unpass",type:"primary"}],typeList:[{label:"身份证 ",value:"0"},{label:"驾驶证 ",value:"1"},{label:"护照",value:"2"},{label:"军官证",value:"3"},{label:"户口簿",value:"4"}],stateList:[{label:"审核中",value:"0 "},{label:"审核通过",value:"1"},{label:"未通过",value:"2"}]},events:{handleOperate:function(e){this[e]()}},methods:{}},p=function(){return{isTop:"0",beginDate:"",endDate:""}},m={data:{loading:!1,formModel:p()},events:{},methods:{initModel:function(e){e?this.formModel=Object.assign(this.getDefaultModel(),e):this.resetModel(),this.$refs.form.resetFields()},resetModel:function(){this.formModel=this.getDefaultModel()},getDefaultModel:function(){return p()},query:function(){var e=this;this.loading=!0,d["a"].get(l["o"].certification.query,{shopId:window.top.SHOP_ID||"",userId:this.itemId.id}).then((function(t){e.initModel(t.content)})).catch((function(t){console.log(t),console.log("code错误"),t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(){e.loading=!1}))},getSaveParams:function(e){return{userId:this.itemId.id,isPass:e,shopId:window.top.SHOP_ID||""}},pass:function(){this.save("1")},unpass:function(){this.save("0")},save:function(e){var t=this;this.$refs.form.validate((function(i,a){if(!i)return t.$message.warning("表单验证失败"),!1;t.loading=!0;var r=function(e){t.$message.success("操作成功"),t.$emit("operationSuccess")},o=function(e){console.log(e),console.log("code错误"),e.errorMessage&&t.$message.warning(e.errorMessage)},s=function(e){t.loading=!1};d["a"].put(l["o"].certification.certify,t.getSaveParams(e)).then(r).catch(o).finally(s)}))}}},u={data:{dialogVisible:!1,imgUrl:""},methods:{},events:{handleImageClick:function(e,t){this.dialogVisible=!0,this.imgUrl=t}}},f={name:"MembershipMgmtCertification",components:{BizSaveButton:n["a"],BizGrid:s["a"]},data:function(){return Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},c.data),m.data),u.data),{},{rules:{}})},props:{itemId:{type:Object,default:function(){return{id:""}}},isEdit:{type:Boolean,default:function(){return!0}}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},m.methods),m.events),c.methods),c.events),u.methods),u.events),watch:{itemId:function(e,t){e.id?this.query():this.initModel()}},computed:{type:function(){var e=Number(this.formModel.type);return isNaN(e)?"--":this.typeList[e]?this.typeList[e].label:"--"},state:function(){var e=Number(this.formModel.state);return isNaN(e)?"--":this.stateList[e]?this.stateList[e].label:"--"}},created:function(){this.itemId.id&&this.query()}},h=f,g=(i("9b1a"),i("2877")),b=Object(g["a"])(h,a,r,!1,null,null,null);t["a"]=b.exports}}]);