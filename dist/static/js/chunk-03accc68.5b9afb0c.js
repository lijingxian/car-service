(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03accc68"],{"221c":function(e,t,a){"use strict";var l=a("689e"),i=a.n(l);i.a},2497:function(e,t,a){"use strict";var l=a("4360"),i=a("a18c");t["a"]=function(e,t){return function(a){var n=a.data;"100"===n.resultCode?e(n):"709"===n.resultCode?(l["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",l["a"].getters.currentUser),i["a"].push("/login")):t(n)}}},"339f":function(e,t,a){},4292:function(e,t,a){"use strict";var l=a("66d2"),i=a.n(l);i.a},"5c40":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-pagination"},[a("el-pagination",{attrs:{"page-sizes":e.pageSizes,"page-size":e.pagination.pageSize,total:e.pagination.total,"current-page":e.pagination.currentPage,"pager-count":e.pagination.pagerCount||7,layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},i=[],n={name:"BizPagination",props:{pagination:{type:Object,required:!0}},data:function(){return{pageSizes:[10,20,50,100],pageSize:20}},methods:{handleSizeChange:function(e){this.$emit("handleSizeChange",e),this.$emit("size-change",e)},handleCurrentChange:function(e){this.$emit("handleCurrentChange",e),this.$emit("current-change",e)},initData:function(){this.pageSizes=this.pagination.pageSizes||[10,20,50,100],this.pageSize=this.pagination.pageSize||20}},watch:{pagination:function(e){e.pageSizes&&this.initData()}},created:function(){this.initData()}},s=n,r=(a("ea5e"),a("2877")),c=Object(r["a"])(s,l,i,!1,null,null,null);t["a"]=c.exports},"66d2":function(e,t,a){},"689e":function(e,t,a){},"72f8":function(e,t,a){"use strict";var l=a("2497"),i=a("bc3a"),n=a.n(i),s=a("c596");t["a"]={queryCard:function(e,t,a){n.a.get(s["g"].communiMgmt.statisticsAnalysis_card,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))},queryPackage:function(e,t,a){n.a.get(s["g"].communiMgmt.statisticsAnalysis_package,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))},queryCompany:function(e,t,a){n.a.get(s["g"].communiMgmt.statisticsAnalysis_queryCompany,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))},queryPackageList:function(e,t,a){n.a.get(s["g"].communiMgmt.statisticsAnalysis_queryPackageList,{params:e}).then(Object(l["a"])(t,a)).catch((function(e){console.error(e)}))}}},"8c35":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"biz-table-filter"},e._l(e.filters,(function(t,l){return a("div",{key:l,staticClass:"filter-wrap"},[a("label",{staticClass:"filter-label",class:t.class},[e._v(e._s(t.label))]),"select"===t.type?a("div",{staticClass:"biz-select",class:t.class},[a("el-select",{attrs:{size:"mini",filterable:t.filterable,multiple:t.multiple,"collapse-tags":t.collapseTags,disabled:t.disabled||!1},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"cascader"===t.type?a("div",{staticClass:"biz-cascader",class:t.class},[a("el-cascader",{attrs:{filterable:t.filterable,"change-on-select":!!t.changeOnSelect&&t.changeOnSelect,placeholder:"全部",size:"mini","show-all-levels":!!t.showAllLevels&&t.showAllLevels,props:e.cascaderProps,value:t.value,options:t.options,clearable:!0},on:{change:e.handleCascaderChange,"active-item-change":e.activeItemChange}})],1):e._e(),"switch"===t.type?a("div",{staticClass:"biz-switch",class:t.class},[a("el-switch",{attrs:{size:"mini","active-text":t.activeText,"active-value":t.activeValue,"inactive-text":t.inactiveText,"inactive-value":t.inactiveValue},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"input"===t.type?a("div",{staticClass:"biz-input",class:t.class},[a("el-input",{attrs:{size:"mini",placeholder:t.placeholder},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.inputSearch(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}},[e._l(t.select,(function(t){return a("el-select",{key:t.index,attrs:{slot:"prepend"},on:{change:e.inputOptionChange},slot:"prepend",model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"select.value"}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.inputSearch},slot:"append"})],2)],1):e._e(),"inputValue"===t.type?a("div",{staticClass:"biz-input",class:t.class},[a("el-input",{attrs:{size:"mini",placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"year"===t.type?a("div",{staticClass:"biz-year",class:t.class},[a("el-date-picker",{attrs:{size:"mini",align:"right",type:"year",clearable:!1!==t.clearable,"value-format":"yyyy",placeholder:"选择年"},on:{change:function(a){return e.dateChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"date"===t.type?a("div",{staticClass:"biz-date",class:t.class},[a("el-date-picker",{attrs:{"unlink-panels":"","start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,clearable:!1!==t.clearable,size:"mini","value-format":"yyyy-MM-dd",type:"date","range-separator":"至"},on:{change:function(a){return e.dateChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"daterange"===t.type?a("div",{staticClass:"biz-date-range",class:t.class},[a("el-date-picker",{attrs:{"unlink-panels":"","start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,clearable:!1!==t.clearable,size:"mini","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至"},on:{change:function(a){return e.dateRangeChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"datetimerange"===t.type?a("div",{staticClass:"biz-date-time-range",class:t.class},[a("el-date-picker",{attrs:{"start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,clearable:!1!==t.clearable,"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange",size:"mini","range-separator":"至"},on:{change:function(a){return e.dateRangeChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"timerange"===t.type?a("div",{staticClass:"biz-time-range",class:t.class},[a("el-time-picker",{attrs:{"is-range":"","start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,clearable:!1!==t.clearable,placeholder:"选择时间范围","value-format":"HH:mm:ss",size:"mini"},on:{change:function(a){return e.dateRangeChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}})],1):e._e(),"inputrange"===t.type?a("div",{staticClass:"biz-input-range",class:t.class},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"",size:"mini"},model:{value:t.value1,callback:function(a){e.$set(t,"value1",e._n(a))},expression:"filter.value1"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.selectValue,callback:function(a){e.$set(t,"selectValue",a)},expression:"filter.selectValue"}},e._l(t.selectOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("div",{staticClass:"last-slot",attrs:{slot:"append"},slot:"append"},[a("span",{staticClass:"range"},[e._v("-")]),a("el-input",{attrs:{placeholder:"","controls-position":"right"},model:{value:t.value2,callback:function(a){e.$set(t,"value2",e._n(a))},expression:"filter.value2"}})],1)],1)],1):e._e(),"single"===t.type?a("div",{class:t.class},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(a){return e.indicatorChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}},e._l(t.options,(function(t){return a("el-radio-button",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e(),"radio"===t.type?a("div",{class:t.class},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(a){return e.indicatorChanged(a,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"filter.value"}},e._l(t.options,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e()])})),0)},i=[],n=(a("c975"),a("d81d"),a("b85c")),s={name:"BizFilter",data:function(){return{daterange:{Clearable:!1},cascaderProps:{label:"label",value:"value",children:"children"}}},props:{filters:{type:Array,default:function(){return[]}}},computed:{watchFilters:function(){var e,t=[],a=Object(n["a"])(this.filters);try{for(a.s();!(e=a.n()).done;){var l=e.value;"input"!==l.type&&-1===["year","date","daterange","datetimerange","timerange","cascader"].indexOf(l.type)&&("select"===l.type||"single"===l.type?t.push({value:l.value}):t.push(l))}}catch(i){a.e(i)}finally{a.f()}return t}},watch:{watchFilters:{handler:function(){this.filters.map((function(e){})),this.$emit("filterDataChange",this.filters)},deep:!0,immediate:!1}},methods:{handleCascaderChange:function(e){this.$emit("cascader-change",e)},activeItemChange:function(e){this.$emit("active-item-change",e)},inputOptionChange:function(e){this.$emit("input-option-change",this.filters)},inputSearch:function(){this.$emit("filterDataChange",this.filters)},indicatorChanged:function(e,t){this.$emit("indicatorDataChange",this.filters)},dateRangeChanged:function(e,t){var a=this;null===e?this.$nextTick((function(){t.value=[],a.$emit("filterDataChange",a.filters)})):this.$emit("filterDataChange",this.filters)},dateChanged:function(e,t){var a=this;null===e?this.$nextTick((function(){t.value="",a.$emit("filterDataChange",a.filters)})):this.$emit("filterDataChange",this.filters)}}},r=s,c=(a("4292"),a("2877")),o=Object(c["a"])(r,l,i,!1,null,null,null);t["a"]=o.exports},9723:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"communicating-card-kpi-report"},[a("biz-chart",{attrs:{chartData:e.chartData,filters:e.filters,showSearch:!1,loading:e.loading,chartHeight:e.chartHeight},on:{filterDataChange:e.filterDataChange}})],1)},i=[],n=(a("99af"),a("d81d"),a("fb6a"),a("b0c0"),a("ade3")),s=a("562e"),r=a("72f8"),c={name:"ActivityKpiReport",data:function(){return{today:"",oldCompanyValue:"",chartHeight:"600px",loading:!0,filters:[{type:"select",label:"查看类型",value:"month",options:[{value:"day",label:"按日"},{value:"month",label:"按月"}]},{type:"select",label:"运营商",value:"",options:[]},{type:"select",label:"套餐",value:"",options:[{value:"",label:"全部"}]},{type:"select",label:"统计指标",value:"price",options:[{value:"price",label:"销售额"},{value:"count",label:"销量"},{value:"profit",label:"利润"}]},{type:"daterange",label:"日期区间：",value:["2011-11-11","2012-12-12"]}],chartData:{}}},methods:{init:function(){var e=this,t=new Date(this.filters[4].value[0]),a=new Date(this.filters[4].value[1]);if("month"===this.filters[0].value&&t.getFullYear()===a.getFullYear()&&t.getMonth()===a.getMonth())return this.$message({message:"按月查询时起止时间请选择不同月份",showClose:!0,type:"warning"}),void(this.filters[0].value="day");if(this.filters[4].value[0]>this.today||this.filters[4].value[1]>this.today)return this.$message.warning({message:"不能选择将来的时间",showClose:!0}),this.filters[0].value="month",void this.getFormatDate();if("day"===this.filters[0].value&&(t.getFullYear()!==a.getFullYear()||t.getMonth()!==a.getMonth()))return this.$message({showClose:!0,message:"按日查询时开始与结束日期应在同一个月",type:"warning"}),void(this.filters[0].value="month");this.loading=!0;var l={timeType:this.filters[0].value,telecomOperatorId:this.filters[1].value,rechargePackageId:this.filters[2].value,kpi:this.filters[3].value,beginDate:this.filters[4].value[0]?this.filters[4].value[0]:"",endDate:this.filters[4].value[1]?this.filters[4].value[1]:""};r["a"].queryPackage(l,(function(t){e.loading=!1,e.chartData=e.dataFormat(t)}),(function(t){e.loading=!1,"779"===t.resultCode&&(e.filters[0].value="month"),e.$message({showClose:!0,message:t.errorMessage,type:"warning"}),console.log("ERR_INIT: ",t)}))},queryCompanyList:function(){var e=this,t={pageNumber:1,pageSize:1e3};r["a"].queryCompany(t,(function(t){e.filters[1].options=t.content.map((function(e){return{value:e.id,label:e.name}})),e.filters[1].value=e.filters[1].options[0].value,e.oldCompanyValue=e.filters[1].value,e.queryPackageList()}),(function(t){e.$message({showClose:!0,message:t.errorMessage,type:"warning"}),console.log("ERR_QUERY_COMPANY: ",t)}))},queryPackageList:function(){var e=this,t={telecomOperatorId:this.filters[1].value};r["a"].queryPackageList(t,(function(t){var a=[{value:"",label:"全部"}];e.filters[2].options=a.concat(t.dataList.map((function(e){return{value:e.id,label:e.name}})))}),(function(t){e.$message({showClose:!0,message:t.errorMessage,type:"warning"}),console.log("ERR_QUERY_PACKAGE: ",t)}))},filterDataChange:function(e){this.oldCompanyValue!==e[1].value?(this.filters[2].value="",this.queryPackageList(),this.init(),this.oldCompanyValue=e[1].value):this.init()},dataFormat:function(e){for(var t=[],a=0;a<e.histogram.length;a++){var l;t.push((l={"日期":"day"===this.filters[0].value?e.histogram[a].refDate.slice(5,10):e.histogram[a].refDate},Object(n["a"])(l,this.kpiName[0],e.histogram[a].value),Object(n["a"])(l,this.kpiName[1],0===e.lineChat.length?"":"0"===e.lineChat[a].value?"0":e.lineChat[a].value),l))}var i={type:"histogram",data:{columns:["日期",this.kpiName[0],this.kpiName[1]],rows:t},settings:{metrics:[this.kpiName[0],0===e.lineChat.length?"":this.kpiName[1]],showLine:this.kpiName[1],yAxisType:["normal","normal"],yAxisName:[this.kpiName[0],0===e.lineChat.length?"":this.kpiName[1]]}};return"month"===this.filters[0].value&&(i.settings.axisSite={right:[this.kpiName[1]]}),i},getFormatDate:function(){var e=new Date;this.filters[4].value[1]="".concat(e.getFullYear(),"-").concat(e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,"-").concat(e.getDate()<10?"0"+e.getDate():e.getDate()),this.today=this.filters[4].value[1];var t=function(){var e=new Date;return e.setMonth(e.getMonth()-6),"".concat(e.getFullYear(),"-").concat(e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,"-").concat(e.getDate()<10?"0"+e.getDate():e.getDate())};this.filters[4].value[0]=t()}},computed:{kpiName:function(){return"price"===this.filters[3].value?["  销售额","累计销售额"]:"count"===this.filters[3].value?["  销量","累计销量"]:"profit"===this.filters[3].value?["  利润","累计利润"]:[]}},created:function(){this.getFormatDate(),this.queryCompanyList()},mounted:function(){this.$message.info({message:"可在此处了解通讯卡套餐的销售,盈利情况",showClose:!0})},components:{BizChart:s["a"]}},o=c,u=(a("221c"),a("2877")),h=Object(u["a"])(o,l,i,!1,null,null,null);t["default"]=h.exports},ea5e:function(e,t,a){"use strict";var l=a("339f"),i=a.n(l);i.a}}]);