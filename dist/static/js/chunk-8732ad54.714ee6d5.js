(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8732ad54"],{"0832":function(e,t,a){"use strict";var n=a("f621"),i=a.n(n);i.a},"11e9":function(e,t,a){"use strict";var n=a("2497"),i=a("bc3a"),o=a.n(i),r=a("c596");t["a"]={getCommodityList:function(e,t,a){o.a.get(r["g"].commodity.getCommodityList,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},delete:function(e,t,a){o.a.delete(r["g"].commodity.delete,{data:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},query:function(e,t,a){o.a.get(r["g"].commodity.query,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},soldoutAndPutaway:function(e,t,a){o.a.post(r["g"].commodity.soldoutAndPutaway,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},cloneProduct:function(e,t,a){o.a.post(r["g"].commodity.cloneProduct,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryPlatformCategoryTree:function(e,t,a){o.a.get(r["g"].commodity.queryPlatformCategoryTree,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryPlatformImportInfo:function(e,t,a){o.a.get(r["g"].commodity.queryPlatformImportInfo,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},importPlatformProduct:function(e,t,a){o.a.post(r["g"].commodity.importPlatformProduct,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},audit:function(e,t,a){o.a.post(r["g"].commodity.audit,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},auditTarget:function(e,t,a){o.a.post(r["g"].commodity.auditTarget,e).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},recallProduct:function(e,t,a){o.a.get(r["g"].commodity.recallProduct,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))},queryFilters:function(e,t,a){o.a.get(r["g"].commodity.queryFilters,{params:e}).then(Object(n["a"])(t,a)).catch((function(e){console.error(e)}))}}},"7f37":function(e,t,a){"use strict";var n=a("c94d"),i=a.n(n);i.a},a7b0:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"sale-supplier-statistics"},[a("div",{attrs:{slot:"top"},slot:"top"},[a("biz-header",{attrs:{operations:e.operations,filters:e.filters},on:{operate:e.operate,filterDataChange:e.filterDataChange,"active-item-change":e.activeItemChange,"cascader-change":e.cascaderChange}}),a("div",{staticStyle:{"font-size":"14px","margin-bottom":"10px",display:"flex"}},[a("div",[e._v(" 销售金额： "),[e._v("￥"+e._s(e.sumPurchaseFee))]],2),a("div",{staticStyle:{"margin-left":"15px"}},[e._v(" 退货金额： "),[e._v("￥"+e._s(e.sumReturnFee))]],2)])],1),a("biz-list",{ref:"table",attrs:{tableData:e.tableData,size:"small",height:"100%"},on:{handleSelectionChange:e.handleSelectionChange,rowClick:e.rowClick}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),a("el-table-column",{attrs:{label:"商品","min-width":"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"product-info-content"},[t.row.thumbnail&&" "!==e.orderItem.thumbnail?a("img",{attrs:{src:t.row.thumbnail,onerror:e.errorImg}}):a("img",{attrs:{src:"/resources/admin/images/default/product-default-100.png"}}),a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"titleClass",attrs:{title:t.row.specValue}},[e._v(e._s(t.row.specValue))]),a("div",{staticClass:"overflow"},[e._v(e._s(t.row.barCode))]),a("div",{staticClass:"overflow"},[e._v("单价(不含税)：")]),a("div",{staticClass:"overflow"},[e._v("单价(含税)：")])])])])])]}}])}),a("el-table-column",{attrs:{label:"销售","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v("商品数量："+e._s(t.row.purchaseAmount))]),a("div",{staticClass:"overflow"},[e._v("金额(不含税)：")]),a("div",{staticClass:"overflow"},[e._v("税额(含税)：")]),a("div",{staticClass:"overflow"},[e._v("金额(含税)："+e._s(t.row.purchaseFee))])])]}}])}),a("el-table-column",{attrs:{label:"销售退货","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"overflow"},[e._v("商品数量："+e._s(t.row.returnAmount))]),a("div",{staticClass:"overflow"},[e._v("金额(不含税)：")]),a("div",{staticClass:"overflow"},[e._v("税额(含税)：")]),a("div",{staticClass:"overflow"},[e._v("金额(含税)："+e._s(t.row.returnFee))])])]}}])})],1),a("div",{attrs:{slot:"float"},slot:"float"},[a("biz-popup-tabs",{attrs:{open:e.open},on:{close:function(t){e.open=!1}},model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[a("base-info",{ref:"baseinfo",attrs:{itemId:e.itemId,beginTime:e.filters[1].value[0]?this.filters[1].value[0]+" 00:00:00":"",endTime:e.filters[1].value[1]?e.filters[1].value[1]+" 23:59:59":""},on:{openOrderTab:e.openOrderTab}})],1)],1),a("biz-popup-tabs",{attrs:{open:e.openOrderSupplier},on:{close:function(t){e.openOrderSupplier=!1}},model:{value:e.openTabName,callback:function(t){e.openTabName=t},expression:"openTabName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"orderSupplierInfo"}},[a("order-supplier-info",{ref:"orderSupplierInfo",attrs:{itemId:e.orderSupplierId,isEdit:e.isEdit,handler:e.handlerName,activeNames:e.activeNames}})],1),a("el-tab-pane",{attrs:{label:"商品信息",name:"orderSupplierProductinfo"}},[a("order-supplier-product-info",{ref:"orderSupplierProductinfo",attrs:{itemId:e.orderSupplierId,isEdit:e.isEdit}})],1)],1)],1),a("div",{attrs:{slot:"bottom"},slot:"bottom"},[a("biz-pagination",{attrs:{pagination:e.pagination},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)],1)},i=[],o=(a("4160"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("25f0"),a("3ca3"),a("466d"),a("1276"),a("159b"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),r=a("5530"),s=a("04d3"),l=a("f36f"),c=a("7132"),u=a("1ab1"),d=a("2f62"),p=a("11e9"),h=a("447a"),f=a("ae8d"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("biz-grid",{staticClass:"sale-item"},[a("biz-flex-table",{ref:"table",attrs:{tableData:e.tableData,loading:e.loading,pagination:e.pagination,checkable:!1},on:{operate:e.operate,"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"orderSn",label:"订单编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.clickRelateBill(a,t.row)}}},[a("span",{staticStyle:{"white-space":"normal"}},[e._v(e._s(t.row.orderSn?t.row.orderSn:""))])])]}}])}),a("el-table-column",{attrs:{prop:"depotName",label:"客户"}}),a("el-table-column",{attrs:{prop:"productName",label:"类型"}}),a("el-table-column",{attrs:{prop:"purchaseAmount",label:"数量"}}),a("el-table-column",{attrs:{prop:"purchaseFee",label:"金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.purchaseFee))]}}])}),a("el-table-column",{attrs:{prop:"createDate",label:"时间"}})],1)],1)},m=[],b={name:"BaseInfo",components:{BizFlexTable:s["c"],BizGrid:l["a"]},props:{itemId:{type:String,default:function(){return""}},beginTime:{type:String,default:function(){return""}},endTime:{type:String,default:function(){return""}}},data:function(){return{loading:!1,tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9}}},created:function(){},computed:{},mounted:function(){},watch:{itemId:function(e,t){e&&this.getList()}},methods:{operate:function(e){this[e]()},clickRelateBill:function(e,t){e.stopPropagation(),this.$emit("openOrderTab",t)},getList:function(){var e=this,t={pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,productId:this.itemId,beginTime:this.beginTime,endTime:this.endTime};u["a"].get("/admin/invoicing/purchase/supplierSalesReport.jhtml",t).then((function(t){e.tableData=t.dataList,e.pagination.total=Number(t.total),e.loading=!1})).catch((function(t){e.loading=!1,t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))},handleSizeChange:function(e){this.pagination.pageSize=e,this.getList()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.getList()}}},v=b,y=(a("7f37"),a("2877")),w=Object(y["a"])(v,g,m,!1,null,null,null),S=w.exports,C=a("bc3a"),I=a.n(C),_={name:"PurchaseStatistics",data:function(){return{title:"",loading:!1,visiable:!1,open:!1,tabName:"info",openOrderSupplier:!1,orderSupplierId:"",isEdit:!0,activeNames:["1"],handlerName:"",openTabName:"orderSupplierInfo",itemId:"",selections:[],categoryDatas:[],productCategoryId:"",sumPurchaseFee:"",sumReturnFee:"",operations:[{label:"导出",name:"export",type:""}],filters:[{type:"cascader",label:"商品分类",name:"category",filterable:!1,value:[],options:[]},{type:"daterange",label:"日期",name:"publishDate",value:[]},{type:"input",label:"",placeholder:"请输入商品名称",name:"searchValue",value:""}],tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:9}}},components:{BizHeader:s["d"],BizPagination:s["f"],BizList:s["e"],BizGrid:l["a"],BizPopupTabs:c["a"],BaseInfo:S,OrderSupplierInfo:h["a"],OrderSupplierProductInfo:f["a"]},created:function(){this.getList(),this.queryFilters()},watch:{},computed:{},mounted:function(){},methods:Object(r["a"])(Object(r["a"])({},Object(d["c"])(["getUser"])),{},{operate:function(e){this[e]()},openOrderTab:function(e){var t=this;this.openTabName="orderSupplierInfo",this.orderSupplierId=e.orderId,window.dType="purchaseOrder",this.open=!1,this.openOrderSupplier=!0,this.$nextTick((function(){t.$refs.orderSupplierInfo.init()})),this.isEdit=!1},refresh:function(){this.getList()},queryFilters:function(){var e=this,t={shopId:window.top.SHOP_ID||""};p["a"].queryFilters(t,(function(t){e.categoryDatas=t.categoryDatas,e.setCategoryFilters()}),(function(a){""!==a.errorMessage&&e.$message.error(a.errorMessage),console.log("获取过滤器失败",t)}))},setCategoryFilters:function(){var e=[{value:"",label:"全部"}];this.categoryDatas.forEach((function(t){e.push({value:t.id,label:t.name,children:[{label:"全部",value:""}]})})),this.filters[0].options=e},cascaderChange:function(e){this.productCategoryId=e[e.length-1],e.length>1&&""===this.productCategoryId&&(this.productCategoryId=e[e.length-2]),this.refresh()},activeItemChange:function(e){var t=this,a={shopId:this.getUser().shop.id,parentId:e.toString()};u["a"].get("/admin/shopProduct/productCategorys.jhtml",a).then((function(a){var n;t.setCategoryFilters(),t.filters[0].options.forEach((function(t){t.value===e[0]&&(n=t.children)})),a.dateList.forEach((function(e){n.push({value:e.id,label:e.name})}))})).catch((function(){}))},export:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n,i,o,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=[],e.selections&&e.selections.length>0&&e.selections.forEach((function(e){a.push(e.productId)})),n={ids:a,pageSize:e.pagination.pageSize,pageNumber:e.pagination.currentPage,shopId:window.top.SHOP_ID||"",searchValue:e.filters[2].value,categoryId:e.productCategoryId,beginTime:e.filters[1].value[0]?e.filters[1].value[0]+" 00:00:00":"",endTime:e.filters[1].value[1]?e.filters[1].value[1]+" 23:59:59":""},t.prev=3,t.next=6,I.a.post("/admin/invoicing/purchase/supplierSalesReports/export.jhtml",n,{responseType:"blob"});case 6:return i=t.sent,console.log("response => ",i),o=new Blob([i.data],{type:"application/vnd.ms-excel"}),console.log(decodeURI(i.headers["content-disposition"])),r=decodeURI(i.headers["content-disposition"].split("filename=")[1]),s=document.createElement("a"),s.download=r.match(/"(\S*)"/)[1],s.style.display="none",s.href=URL.createObjectURL(o),document.body.appendChild(s),s.click(),URL.revokeObjectURL(s.href),document.body.removeChild(s),t.abrupt("return");case 22:throw t.prev=22,t.t0=t["catch"](3),new Error(t.t0);case 25:case"end":return t.stop()}}),t,null,[[3,22]])})))()},getList:function(){var e=this,t={pageSize:this.pagination.pageSize,pageNumber:this.pagination.currentPage,shopId:window.top.SHOP_ID||"",searchValue:this.filters[2].value,categoryId:this.productCategoryId,beginTime:this.filters[1].value[0]?this.filters[1].value[0]+" 00:00:00":"",endTime:this.filters[1].value[1]?this.filters[1].value[1]+" 23:59:59":""};this.loading=!0,u["a"].get("/admin/invoicing/purchase/supplierSalesReports.jhtml",t).then((function(t){e.tableData=t.dataList,e.sumPurchaseFee=t.sumPurchaseFee,e.sumReturnFee=t.sumReturnFee,e.pagination.total=Number(t.total),e.loading=!1})).catch((function(t){e.$message.warning(t.errorMessage),console.log("ERR_REFRESH: ",t)})).finally((function(t){e.loading=!1}))},handleSelectionChange:function(e){this.selections=e},filterDataChange:function(e){this.filters=e,this.pagination.currentPage=1,this.refresh()},handleSizeChange:function(e){this.pagination.pageSize=e,this.refresh()},handleCurrentChange:function(e){this.pagination.currentPage=e,this.refresh()},rowClick:function(e,t,a){var n=this;this.itemId=e.productId,this.tabName="info",this.open=!0,this.$nextTick((function(){n.$refs.baseinfo.getList()}))}})},P=_,z=(a("0832"),Object(y["a"])(P,n,i,!1,null,null,null));t["default"]=z.exports},c94d:function(e,t,a){},f621:function(e,t,a){}}]);