(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b6abf02"],{"0943":function(t,e,i){"use strict";var a=i("1fac"),n=i.n(a);n.a},"0aa3":function(t,e,i){},"145f":function(t,e,i){"use strict";var a=i("0aa3"),n=i.n(a);n.a},"1fac":function(t,e,i){},2497:function(t,e,i){"use strict";var a=i("4360"),n=i("a18c");e["a"]=function(t,e){return function(i){var o=i.data;"100"===o.resultCode?t(o):"709"===o.resultCode?(a["a"].commit("updateUser",{shop:{}}),console.log("未登录: ",a["a"].getters.currentUser),n["a"].push("/login")):e(o)}}},2732:function(t,e,i){},"43af":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"process-q-a-a"},[i("biz-flex-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{operations:t.operations,filters:t.filters,tableData:t.tableData,pagination:t.pagination},on:{operate:t.operate,"filter-data-change":t.filterDataChange,"selection-change":t.onSelectionChange,"row-click":t.rowClick,"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},[i("el-table-column",{attrs:{prop:"name",label:"流程名称"}}),i("el-table-column",{attrs:{prop:"describe",label:"流程描述"}}),i("el-table-column",{attrs:{prop:"modifyDate",label:"变更时间"}})],1),i("biz-popup-tabs",{attrs:{open:t.open,contentStyle:{width:"760px"}},on:{close:function(e){t.open=!1}},model:{value:t.importtabName,callback:function(e){t.importtabName=e},expression:"importtabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"baseinfo"}},[i("base-info",{attrs:{itemObjId:t.itemObjId},on:{success:t.refresh}})],1)],1)],1)},n=[],o=(i("4160"),i("a9e3"),i("d3b7"),i("159b"),i("04d3")),s=i("7132"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("biz-grid",{staticClass:"process-qa-base-info"},[i("biz-save-button",{attrs:{slot:"top",operations:t.operations},on:{operate:t.operate},slot:"top"}),i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"100px",size:"small","inline-message":!0}},[i("el-form-item",{attrs:{label:"流程名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入流程名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"流程描述",prop:"describe"}},[i("el-input",{attrs:{placeholder:"请输入流程描述"},model:{value:t.form.describe,callback:function(e){t.$set(t.form,"describe",e)},expression:"form.describe"}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.itemObjId.id,expression:"itemObjId.id"}],staticClass:"process"},[i("node-tree",{attrs:{flowId:t.itemObjId.id,tree:t.tree,isRoot:!0},on:{refresh:t.refresh}})],1)],1)},c=[],l=(i("b0c0"),i("f36f")),u=i("8330"),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"process-node-tree"},[i("div",{class:t.topStyle}),i("div",{staticClass:"node-warp"},[i("node",{attrs:{nodeData:t.tree.nodeData,flowId:t.flowId,hasChild:t.nodes.length>0},on:{refresh:t.refresh}})],1),t.nodes.length>0?i("div",{staticClass:"node-tree-zone"},t._l(t.nodes,(function(e,a){return i("node-tree",{key:a,ref:"node-tree",refInFor:!0,attrs:{isLeft:0===a&&1!==t.nodes.length,isRight:a===t.nodes.length-1&&1!==t.nodes.length,isOnly:1===t.nodes.length,tree:e,flowId:t.flowId},on:{refresh:t.refresh}})})),1):t._e()])},f=[],p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"process-node"},[i("div",{staticClass:"operator-top"},[i("i",{staticClass:"el-icon-close",on:{click:t.remove}})]),i("div",{staticClass:"p-wrap",on:{click:t.onCLick}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.id,expression:"nodeData.id"}],staticClass:"question"},[t._v("问："+t._s(t.nodeData.question))]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.id,expression:"nodeData.id"}],staticClass:"answer"},[t._v("答："+t._s(t.answer))]),"3"===t.nodeData.type?i("div",{staticClass:"image"},[i("img",{attrs:{src:t.nodeData.answer}})]):t._e(),"2"===t.nodeData.type?i("div",{staticClass:"link"},[t._v(t._s(t.nodeData.answer))]):t._e(),"1002"===t.nodeData.type?i("div",{staticClass:"audio"},[i("audio",{attrs:{src:t.nodeData.answer,controls:"controls"}})]):t._e(),"1"===t.nodeData.type?i("div",{staticClass:"richtext",domProps:{innerHTML:t._s(t.nodeData.answer)}}):t._e(),"1001"===t.nodeData.type?i("div",{staticClass:"goods"},[i("div",{staticClass:"g-image"},[i("img",{attrs:{src:t.productList.length>0&&t.productList[0].image||t.DefaultImg}})]),i("div",{staticClass:"name-zone"},[i("div",{staticClass:"name"},[t._v(t._s(t.productName))]),i("div",{staticClass:"name"},[t._v(t._s(t.productNumber))])])]):t._e(),"1005"===t.nodeData.type||"1006"===t.nodeData.type?i("div",{staticClass:"goods"},[i("div",{staticClass:"g-image"},[i("img",{attrs:{src:t.activeAnswerList.length>0&&t.activeAnswerList[0].cover||t.DefaultImg}})]),i("div",{staticClass:"name-zone"},[i("div",{staticClass:"name"},[t._v(t._s(t.activeName))])])]):t._e()]),i("div",{staticClass:"bottom-line",class:t.bottomStyle},[i("i",{staticClass:"el-icon-plus",on:{click:t.add}})]),i("q-a",{attrs:{flowId:t.flowId,parenteId:t.parenteId,itemObjId:t.itemObjId,open:t.open},on:{close:function(e){t.open=!1},refresh:t.refresh}})],1)},h=[],m=(i("d81d"),i("ac1f"),i("3ca3"),i("1276"),i("ddb0"),i("b85c")),g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.title,visible:t.open,"append-to-body":!0},on:{close:t.onClose}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"80px",size:"small"}},[i("el-form-item",{attrs:{label:"类型",prop:"type"}},[i("el-radio-group",{on:{change:t.typeChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[i("el-radio",{attrs:{label:"0"}},[t._v("纯文本")]),i("el-radio",{attrs:{label:"1"}},[t._v("富文本")]),i("el-radio",{attrs:{label:"3"}},[t._v("图片")]),i("el-radio",{attrs:{label:"2"}},[t._v("超链接")]),i("el-radio",{attrs:{label:"1002"}},[t._v("音频")]),i("el-radio",{attrs:{label:"1001"}},[t._v("商品")]),i("el-radio",{attrs:{label:"1004"}},[t._v("功能")]),i("el-radio",{attrs:{label:"1005"}},[t._v("活动")]),i("el-radio",{attrs:{label:"1006"}},[t._v("抽奖")])],1)],1),i("el-form-item",{attrs:{label:"匹配方式",prop:"matchMode"}},[i("el-radio-group",{model:{value:t.form.matchMode,callback:function(e){t.$set(t.form,"matchMode",e)},expression:"form.matchMode"}},[i("el-radio",{attrs:{label:"0"}},[t._v("模糊")]),i("el-radio",{attrs:{label:"1"}},[t._v("精准")])],1)],1),i("el-form-item",{attrs:{label:"问题",prop:"question"}},[i("el-input",{attrs:{placeholder:"请输入问题"},model:{value:t.form.question,callback:function(e){t.$set(t.form,"question",e)},expression:"form.question"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-plus"},on:{click:t.addProblem},slot:"append"})],1)],1),t._l(t.form.similarQuestion,(function(e,a){return i("el-form-item",{key:e.key,attrs:{label:"相似问题",prop:"similarQuestion."+a+".value",rules:{required:!0,message:"请输入问题",trigger:"blur"}}},[i("el-input",{model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"question.value"}})],1)})),"0"===t.form.type||"2"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"answer"}},[i("el-input",{attrs:{placeholder:"请输入答案",type:"textarea",autosize:{minRows:4,maxRows:6}},model:{value:t.form.answer,callback:function(e){t.$set(t.form,"answer",e)},expression:"form.answer"}})],1):t._e(),"1"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"answer"}},[i("biz-editor",{directives:[{name:"show",rawName:"v-show",value:"1"===t.form.type,expression:"form.type==='1'"}],ref:"editor",attrs:{height:"400px",width:"320px"},model:{value:t.form.answer,callback:function(e){t.$set(t.form,"answer",e)},expression:"form.answer"}})],1):t._e(),"3"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"answer"}},[i("BizAvatarUploaderNew",{model:{value:t.form.answer,callback:function(e){t.$set(t.form,"answer",e)},expression:"form.answer"}})],1):t._e(),"1002"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"files"}},[i("biz-file-uploader",{attrs:{data:{type:2},fileList:t.form.fileList},on:{fileListChange:t.fileListChange},model:{value:t.form.files,callback:function(e){t.$set(t.form,"files",e)},expression:"form.files"}})],1):t._e(),"1001"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"productList"}},[i("div",{staticClass:"product-list el-upload-list el-upload-list--picture-card"},[t._l(t.productList,(function(e){return i("div",{key:e.index,staticClass:"img-preview el-upload-list__item is-success",attrs:{tabindex:"0"}},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:e.image||t.defaultImg,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(i){return t.handleRemove(e.id)}}},[i("i",{staticClass:"el-icon-delete"})])]),i("div",{staticClass:"detail_info"},[i("span",[t._v(t._s(e.fullName||e.name))]),i("span",[t._v("￥"+t._s(e.price)+"元")])])])})),i("div",{staticClass:"avatar-uploader",on:{click:t.addProduct}},[i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],2)]):t._e(),"1004"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"answer"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.answer,callback:function(e){t.$set(t.form,"answer",e)},expression:"form.answer"}},[i("el-option",{attrs:{label:"预约试驾",value:"预约试驾"}}),i("el-option",{attrs:{label:"购车计算",value:"购车计算"}}),i("el-option",{attrs:{label:"车型对比",value:"车型对比"}}),i("el-option",{attrs:{label:"我的订单",value:"我的订单"}})],1)],1):t._e(),"1005"===t.form.type||"1006"===t.form.type?i("el-form-item",{attrs:{label:"答案",prop:"activeAnswer"}},[i("div",{staticClass:"product-list el-upload-list el-upload-list--picture-card"},[t._l(t.activeAnswerList,(function(e){return i("div",{key:e.index,staticClass:"img-preview el-upload-list__item is-success",attrs:{tabindex:"0"}},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:e.cover||t.defaultImg,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(i){return t.handleRemoveActive(e.id)}}},[i("i",{staticClass:"el-icon-delete"})])]),i("div",{staticClass:"detail_info"},[i("span",[t._v(t._s(e.title))])])])})),i("div",{staticClass:"avatar-uploader",on:{click:t.addActive}},[i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],2)]):t._e(),i("el-form-item",{attrs:{label:"访问次数",prop:"count"}},[i("el-input",{attrs:{disabled:""},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}})],1),i("el-form-item",{attrs:{label:"最近访问时间",prop:"date"}},[i("el-input",{attrs:{disabled:""},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),i("el-form-item",{attrs:{label:"权重",prop:"weight"}},[i("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:t.form.weight,callback:function(e){t.$set(t.form,"weight",e)},expression:"form.weight"}})],1)],2),i("biz-save-button",{attrs:{operations:t.operations},on:{operate:t.operate}}),i("biz-dialog-selector",{attrs:{loading:t.dialogLoading,visibility:t.showDialog,tableData:t.products,pagination:t.pagination,filters:t.productFilters,selectionKeys:t.selectedItemKeys},on:{"update:visibility":function(e){t.showDialog=e},pageSizeChange:t.handleSizeChange,currentPageChange:t.handleCurrentChange,confirmed:t.confirm,filterDataChange:t.filterDataChange}},[i("el-table-column",{attrs:{property:"sn",label:"编号"}}),i("el-table-column",{attrs:{property:"name",label:"名称"}}),i("el-table-column",{attrs:{property:"price",label:"价格"}}),i("el-table-column",{attrs:{prop:"stock",label:"剩余库存/库存总数",sortable:"custom",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[i("div",{staticClass:"biz-customcol"},[t._v(" "+t._s(e.row.availableStock)+"/ "),i("span",{style:{color:t.stateColor(e.row)}},[t._v(t._s(e.row.stock))])])])}}])})],1),i("biz-dialog-selector",{attrs:{loading:t.dialogLoading,visibility:t.showDialogActive,tableData:t.actives,pagination:t.paginationActive,selectionKeys:t.selectedItemKeysActive,filters:t.activeFilters},on:{"update:visibility":function(e){t.showDialogActive=e},pageSizeChange:t.handleSizeChangeActive,currentPageChange:t.handleCurrentChangeActive,confirmed:t.confirmActive,filterDataChange:t.filterDataChangeActive}},[i("el-table-column",{attrs:{prop:"title",label:"活动名称"}}),i("el-table-column",{attrs:{prop:"shopname",label:"店铺名称"}}),i("el-table-column",{attrs:{prop:"type",formatter:t.getState,label:"状态"}}),i("el-table-column",{attrs:{prop:"beginDate",sortable:"custom",label:"开始时间"}}),i("el-table-column",{attrs:{prop:"endDate",sortable:"custom",label:"结束时间"}}),i("el-table-column",{attrs:{prop:"createDate",label:"创建时间"}})],1)],1)},v=[],b=(i("a15b"),i("a434"),i("40ae")),y=i("c17f"),w=i("f3ac"),C=i.n(w),A=i("af3f"),I=i("1ab1"),S=i("c596"),_=i("6297"),O={name:"process-qa-item",components:{BizEditor:b["a"],BizFileUploader:y["d"],BizDialogSelector:A["a"],BizAvatarUploaderNew:y["b"],BizSaveButton:u["a"]},props:{open:Boolean,flowId:{type:String,default:function(){return""}},parenteId:{type:String,default:function(){return""}},itemObjId:{type:Object,default:function(){return{id:""}}}},data:function(){var t=this;return{dialogLoading:!1,showDialog:!1,showDialogActive:!1,products:[],productList:[],selectedItemKeys:[],actives:[],selectedItemKeysActive:[],activeAnswerList:[],title:"编辑问答",loading:!1,defaultImg:C.a,operations:[{label:"保存",name:"save",type:"primary"},{label:"取消",name:"cancel",type:""}],form:{type:"0",matchMode:"0",weight:"0",question:"",similarQuestion:[],answer:""},rules:{question:[{required:!0,message:"请填写问题",trigger:"blur"}],files:[{required:!0,message:"请填写答案",trigger:"blur"}],answer:[{required:!0,message:"请填写答案",trigger:"blur"},{trigger:"blur",validator:function(e,i,a){var n=/^(http|https|ftp):\/\/([A-Z0-9][A-Z0-9_-]*(?:\.[A-Z0-9][A-Z0-9_-]*)+):?(\d+)?\/?/i;"2"!==t.form.type||n.test(i)?a():a(new Error("请输入正确的超链接地址"))}}]},productFilters:[{type:"input",placeholder:"请输入编号/商品名",name:"searchbar",value:""}],activeFilters:[{type:"radio",label:"活动类型：",name:"type",value:"2",options:[{label:"抽奖",value:"2"},{label:"活动招募",value:"9"}]}],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},paginationActive:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},computed:{},watch:{itemObjId:function(t){t.id?this.query():this.clear()}},created:function(){},methods:{operate:function(t){this[t]()},save:function(){var t=this;this.$refs.form.validate((function(e,i){if(e){if("1002"===t.form.type&&(t.form.answer=t.form.files[0]),"1001"===t.form.type){if(t.productList.length<=0)return void t.$message.warning("请添加商品");t.form.answer=t.productList.map((function(t){return t.id})).join(",")}if("1005"===t.form.type||"1006"===t.form.type){var a=t.activeAnswerList.map((function(t){return t.id}));t.form.answer=a.join(",")}t.itemObjId.id?t.update():t.create()}}))},create:function(){var t=this,e={flowId:this.flowId,parenteId:this.parenteId,type:this.form.type,matchMode:this.form.matchMode,answer:this.form.answer,question:this.form.question,similarQuestion:this.form.similarQuestion.map((function(t){return t.value}))};I["a"].post(S["f"].processQA.node,e).then((function(e){t.$message.success("保存成功"),t.$emit("refresh"),t.$emit("close"),t.clear()})).catch((function(e){t.$message.warning(e.errorMessage)}))},update:function(){var t=this,e={flowId:this.flowId,id:this.itemObjId.id,parenteId:this.parenteId,type:this.form.type,matchMode:this.form.matchMode,answer:this.form.answer,question:this.form.question,similarQuestion:this.form.similarQuestion.map((function(t){return t.value}))};I["a"].put(S["f"].processQA.node,e).then((function(e){t.$message.success("保存成功"),t.$emit("refresh"),t.$emit("close"),t.clear()})).catch((function(e){t.$message.warning(e.errorMessage)}))},cancel:function(){this.$emit("close")},typeChange:function(){this.form.answer=""},addProblem:function(){this.form.similarQuestion.push({value:"",key:Date.now()})},onClose:function(){this.$emit("close")},stateColor:function(t){return t.stock>5?"#333333":"#f56c6c"},filterDataChange:function(t){this.pagination.currentPage=1,this.queryProductList()},handleSizeChange:function(t){this.pagination.pageSize=t,this.queryProductList()},handleCurrentChange:function(t){this.pagination.currentPage=t,this.queryProductList()},confirm:function(t){this.selectedItemKeys=t||this.selectedItemKeys,this.queryProductsByIds()},confirmActive:function(t,e){console.log(e),this.selectedItemKeysActive=t||this.selectedItemKeysActive,this.activeAnswerList=e},queryProductsByIds:function(){var t,e=this,i=[],a=Object(m["a"])(this.selectedItemKeys);try{for(a.s();!(t=a.n()).done;){var n=t.value,o={id:n,shopId:window.top.SHOP_ID||""};i.push(I["a"].get(S["b"].queryProductBasicInfo,o))}}catch(s){a.e(s)}finally{a.f()}Promise.all(i).then((function(t){e.productList=t.map((function(t){return t.productBasicInfoData})),e.form.answer=e.productList.map((function(t){return t.id})).join(",")}))},queryProductList:function(){var t=this,e={searchValue:this.productFilters[0].value,state:"2",shopId:window.top.SHOP_ID||"",pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize};this.dialogLoading=!0,I["a"].get("/admin/product/union/list.jhtml",e).then((function(e){t.dialogLoading=!1,t.products=e.content,t.pagination.total=Number(e.total)})).catch((function(e){t.dialogLoading=!1,t.$message.warning(e.errorMessage||"操作错误")}))},addProduct:function(){this.productFilters[0].value="",this.pagination.currentPage=1,this.queryProductList(),this.showDialog=!0},handleRemove:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.removePic(t)}))},removePic:function(t){for(var e=this,i=0;i<this.productList.length;i++)this.productList[i].id===t&&this.productList.splice(i,1),this.selectedItemKeys.forEach((function(i,a){if(i===t)return e.selectedItemKeys.splice(a,1),!1}));this.form.answer=this.productList.map((function(t){return t.id})).join(",")},query:function(){var t=this,e={id:this.itemObjId.id};I["a"].get(S["f"].processQA.node,e).then((function(e){if(t.form.type=e.data.type,t.form.matchMode=e.data.matchMode,t.form.question=e.data.question,t.form.similarQuestion=e.data.similarQuestion.map((function(t){return{value:t,key:Date.now()}})),"1002"===t.form.type)t.form.files=[e.data.answer],t.form.fileList=[{name:e.dataanswer,url:e.data.answer}];else if("1001"===t.form.type)t.selectedItemKeys=e.data.answer.split(","),t.queryProductsByIds();else if("1005"===t.form.type||"1006"===t.form.type){var i=e.data.answer.split(",");t.queryActivesByIds(i)}else t.form.answer=e.data.answer})).catch((function(e){t.$message.warning(e.errorMessage)}))},queryActivesByIds:function(t){var e=this;I["a"].post("/admin/marketing/activityList.jhtml",{ids:t}).then((function(t){e.activeAnswerList=t.activityList})).catch()},getActivityList:function(){var t=this;this.dialogLoading=!0;var e={typeStr:this.activeFilters[0].value,pageNumber:this.paginationActive.currentPage,pageSize:this.paginationActive.pageSize};_["a"].getActivityList(e,(function(e){t.dialogLoading=!1,t.actives=e.content,t.paginationActive.total=Number(e.total)}),(function(e){t.dialogLoading=!1,console.log(e),"店铺不存在"!==e.errorMessage&&t.$message.warning(e.errorMessage)}))},getState:function(t){switch(t.stateStr){case"0":return"未开始";case"1":return"9"===t.typeStr&&t.attendCount<t.maxPersonCount?"进行中":"9"===t.typeStr&&t.attendCount===t.maxPersonCount?"已结束":"进行中";case"2":return"已结束";case"3":return"已创建";case"4":return"已提交";case"5":return"已取消";default:return""}},addActive:function(){"1006"===this.form.type?this.activeFilters=[{type:"radio",label:"活动类型：",name:"type",value:"2",options:[{label:"抽奖",value:"2"}]}]:this.activeFilters=[{type:"radio",label:"活动类型：",name:"type",value:"9",options:[{label:"招募活动",value:"9"}]}],this.showDialogActive=!0,this.getActivityList()},filterDataChangeActive:function(t){this.paginationActive.currentPage=1,this.getActivityList()},handleSizeChangeActive:function(t){this.paginationActive.pageSize=t,this.getActivityList()},handleCurrentChangeActive:function(t){this.paginationActive.currentPage=t,this.getActivityList()},clear:function(){this.form.answer="",this.form.type="0",this.form.matchMode="0",this.form.question="",this.form.similarQuestion=[],this.products=[],this.productList=[],this.selectedItemKeys=[]},fileListChange:function(t){console.log(t)}}},L=O,D=i("2877"),$=Object(D["a"])(L,g,v,!1,null,null,null),j=$.exports,k={name:"node",components:{QA:j},props:{flowId:{type:String,default:function(){return""}},nodeData:{type:Object,default:function(){return{}}},hasChild:{type:Boolean,default:function(){return!1}}},data:function(){return{DefaultImg:C.a,parenteId:"",itemObjId:{id:""},productList:[],activeAnswerList:[],open:!1}},computed:{answer:function(){return"1"===this.nodeData.type||"2"===this.nodeData.type||"3"===this.nodeData.type||"1001"===this.nodeData.type||"1002"===this.nodeData.type||"1005"===this.nodeData.type||"1006"===this.nodeData.type?"":this.nodeData.answer},bottomStyle:function(){return{"has-child":this.hasChild}},productName:function(){return 0===this.productList.length?"":this.productList[0].name},activeName:function(){return 0===this.activeAnswerList.length?"":this.activeAnswerList[0].title},productNumber:function(){return 1===this.productList.length?"":"等".concat(this.productList.length,"件商品")}},watch:{nodeData:{immediate:!0,handler:function(t){"1001"===t.type&&this.getProduct(),"1005"!==t.type&&"1006"!==t.type||this.queryActivesByIds()}}},created:function(){},methods:{onCLick:function(){this.open=!0,this.parenteId=this.nodeData.parenteId,this.nodeData.id?this.itemObjId={id:this.nodeData.id}:this.itemObjId={id:""}},add:function(){this.itemObjId={id:""},this.parenteId=this.nodeData.id,this.open=!0},refresh:function(){this.$emit("refresh")},remove:function(){var t=this;this.nodeData.id&&this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var e={flowId:t.flowId,id:t.nodeData.id};I["a"].delete(S["f"].processQA.node,e).then((function(e){t.$message.success("删除成功"),t.$emit("refresh")})).catch((function(e){e.errorMessage&&t.$message.warning(e.errorMessage)})).finally((function(e){t.loading=!1}))}))},getProduct:function(){var t=this;console.log("getProduct");var e,i=[],a=Object(m["a"])(this.nodeData.answer.split(","));try{for(a.s();!(e=a.n()).done;){var n=e.value,o={id:n,shopId:window.top.SHOP_ID||""};i.push(I["a"].get(S["b"].queryProductBasicInfo,o))}}catch(s){a.e(s)}finally{a.f()}Promise.all(i).then((function(e){t.productList=e.map((function(t){return t.productBasicInfoData}))}))},queryActivesByIds:function(){var t=this;I["a"].post("/admin/marketing/activityList.jhtml",{ids:this.nodeData.answer.split(",")}).then((function(e){t.activeAnswerList=e.activityList})).catch()}}},z=k,x=(i("145f"),Object(D["a"])(z,p,h,!1,null,null,null)),M=x.exports,P={name:"NodeTree",components:{Node:M},props:{flowId:{type:String,default:function(){return""}},tree:Object,isRoot:{type:Boolean,default:function(){return!1}},isLeft:{type:Boolean,default:function(){return!1}},isRight:{type:Boolean,default:function(){return!1}},isOnly:{type:Boolean,default:function(){return!1}}},data:function(){return{}},computed:{nodes:function(){return this.tree.subNodes||[]},topStyle:function(){return{"top-line":!this.isRoot,"top-line-only":this.isOnly,"top-line-left":this.isLeft,"top-line-center":!this.isLeft&&!this.isRight&&!this.isOnly,"top-line-right":this.isRight}}},watch:{tree:{immediate:!0,handler:function(){}}},created:function(){},methods:{refresh:function(){this.$emit("refresh")}}},N=P,B=(i("f722"),Object(D["a"])(N,d,f,!1,null,null,null)),q=B.exports,K={name:"base-info",components:{BizGrid:l["a"],BizSaveButton:u["a"],NodeTree:q},props:{itemObjId:{type:Object,default:function(){return{id:""}}}},data:function(){return{loading:!1,operations:[{label:"保存",name:"save",type:"primary"}],form:{id:"",name:"",describe:""},rules:{name:[{required:!0,message:"请输入流程名称",trigger:"blur"}],describe:[{required:!0,message:"请输入流程描述",trigger:"blur"}]},tree:{}}},computed:{},watch:{itemObjId:function(t){t.id?(this.query(),this.queryNodeList()):this.clear()}},created:function(){},methods:{operate:function(t){this[t]()},save:function(){var t=this;this.$refs.form.validate((function(e,i){e&&(t.itemObjId.id?t.update():t.create())}))},create:function(){var t=this,e={name:this.form.name,describe:this.form.describe};this.loading=!0,I["a"].post(S["f"].processQA.flow,e).then((function(e){t.$message.success("保存成功"),t.$emit("success",e.id)})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},update:function(){var t=this,e={id:this.itemObjId.id,name:this.form.name,describe:this.form.describe};this.loading=!0,I["a"].put(S["f"].processQA.flow,e).then((function(e){t.$message.success("更新成功"),t.$emit("success")})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},query:function(){var t=this,e={id:this.itemObjId.id};this.loading=!0,I["a"].get(S["f"].processQA.flow,e).then((function(e){t.form.name=e.data.name,t.form.describe=e.data.describe,t.$nextTick((function(){t.$refs.form.validate()}))})).catch((function(e){t.$message.warning(e.errorMessage)})).finally((function(){t.loading=!1}))},queryNodeList:function(){var t=this,e={flowId:this.itemObjId.id};I["a"].get(S["f"].processQA.nodeList,e).then((function(e){t.tree=e.data||{}})).catch((function(e){t.$message.warning(e.errorMessage)}))},refresh:function(){this.queryNodeList()},clear:function(){this.form.name="",this.form.describe=""}}},T=K,Q=(i("bc4c"),Object(D["a"])(T,r,c,!1,null,null,null)),R=Q.exports,F={name:"ProcessQAMgmt",components:{BizFlexTable:o["c"],BizPopupTabs:s["a"],BaseInfo:R},props:{},data:function(){return{itemObjId:{id:""},open:!1,loading:!1,importtabName:"baseinfo",tableData:[],pagination:{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0},selections:[],operations:[{label:"添加",name:"add",type:"primary"},{disabled:!0,label:"删除",name:"delete",type:""}],filters:[{type:"input",label:"",placeholder:"请输入搜索内容",name:"searchValue",value:""}]}},computed:{},watch:{},created:function(){this.getList()},methods:{operate:function(t){this[t]()},add:function(){this.itemObjId={id:""},this.open=!0},getList:function(){var t=this,e={pageNumber:this.pagination.currentPage,pageSize:this.pagination.pageSize,shopId:window.top.SHOP_ID||"",searchValue:this.filters[0].value};this.loading=!0,I["a"].get(S["f"].processQA.list,e).then((function(e){t.tableData=e.content,t.pagination.total=Number(e.total)})).catch((function(t){console.log(t)})).finally((function(){t.loading=!1}))},filterDataChange:function(){this.pagination.pageNumber=1,this.getList()},onSelectionChange:function(t){this.selections=t,this.operations[1].disabled=!0,t.length>0&&(this.operations[1].disabled=!1)},delete:function(){if(this.selections&&this.selections.length>0){var t=[];this.selections.forEach((function(e){t.push(e.id)})),this.deleteItem(t)}else this.$message("请选择一条数据")},deleteItem:function(t){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,I["a"].delete(S["f"].processQA.flow,{ids:t}).then((function(t){e.$message.success("删除成功"),e.refresh()})).catch((function(t){t.errorMessage&&e.$message.warning(t.errorMessage)})).finally((function(t){e.loading=!1}))}))},rowClick:function(t){this.itemObjId={id:t.id},this.open=!0},handleSizeChange:function(){},handleCurrentChange:function(){},refresh:function(t){this.getList(),t&&(this.itemObjId={id:t})}}},E=F,V=(i("b628"),Object(D["a"])(E,a,n,!1,null,null,null));e["default"]=V.exports},"472a":function(t,e,i){},"56e0":function(t,e,i){},"5b8e":function(t,e,i){"use strict";var a=i("9678"),n=i.n(a);n.a},6297:function(t,e,i){"use strict";i("96cf");var a=i("1da1"),n=i("2497"),o=i("bc3a"),s=i.n(o),r=i("c596");e["a"]={getKPI:function(t,e,i){s.a.get(r["g"].activityMgmt.ActivityKPI,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getShopList:function(t,e,i){s.a.get(r["g"].activityMgmt.getShopList,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getActivityList:function(t,e,i){s.a.get(r["g"].activityMgmt.ActivityList,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getInitInfo:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,i,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s.a.get(r["g"].activityMgmt.getInitInfo,{params:e}).then(Object(n["a"])(i,a)).catch((function(t){console.error(t)}));case 1:case"end":return t.stop()}}),t)})));function e(e,i,a){return t.apply(this,arguments)}return e}(),getActivity:function(t,e,i){s.a.get(r["g"].activityMgmt.Activity,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},createActivity:function(t,e,i){s.a.post(r["g"].activityMgmt.Activity,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},updateActivity:function(t,e,i){s.a.put(r["g"].activityMgmt.Activity,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},deleteActivity:function(t,e,i){s.a.delete(r["g"].activityMgmt.Activity,{data:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getMatchActivityList:function(t,e,i){s.a.get(r["g"].activityMgmt.matchActivityList,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getAwardList:function(t,e,i){s.a.get(r["g"].activityMgmt.AwardList,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},createAward:function(t,e,i){s.a.post(r["g"].activityMgmt.Award,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getAward:function(t,e,i){s.a.get(r["g"].activityMgmt.Award,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},updateAward:function(t,e,i){s.a.put(r["g"].activityMgmt.Award,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},deleteAward:function(t,e,i){s.a.delete(r["g"].activityMgmt.Award,{data:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getActivityNotice:function(t,e,i){s.a.get(r["g"].activityMgmt.ActivityNotice,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getLocalActivityNotice:function(t,e,i){s.a.get(r["g"].activityMgmt.LocalActivityNotice,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},updateActivityNotice:function(t,e,i){s.a.put(r["g"].activityMgmt.ActivityNotice,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},updateLocalActivityNotice:function(t,e,i){s.a.put(r["g"].activityMgmt.LocalActivityNotice,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},publishActivityNotice:function(t,e,i){s.a.post(r["g"].activityMgmt.PublishActivityNotice,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},publishLocalActivityNotice:function(t,e,i){s.a.post(r["g"].activityMgmt.PublishLocalActivityNotice,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getActivityParticipant:function(t,e,i){s.a.get(r["g"].activityMgmt.ActivityParticipant,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getBKRecordList:function(t,e,i){s.a.get(r["g"].activityMgmt.BKRecord,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},verification:function(t,e,i){s.a.post(r["g"].activityMgmt.Verification,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},getStatisticsAnalysis:function(t,e,i){s.a.get(r["g"].activityMgmt.StatisticsAnalysis,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},submit:function(t,e,i){s.a.post(r["g"].activityMgmt.Verified,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},PassOrNot:function(t,e,i){s.a.post(r["g"].activityMgmt.Pass,t).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},publishActivity:function(t,e,i){s.a.get(r["g"].activityMgmt.Publish,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},Revocation:function(t,e,i){s.a.get(r["g"].activityMgmt.Revocation,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))},exportAttend:function(t,e,i){s.a.get(r["g"].activityMgmt.exportAttend,{params:t}).then(Object(n["a"])(e,i)).catch((function(t){console.error(t)}))}}},"697f":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"biz-dialog-selector",attrs:{title:t.title,visible:t.dialogVisible,"append-to-body":t.appendToBody},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close,open:t.open}},[t._t("top"),i("biz-flex-table",{ref:"table",attrs:{showTable:t.showTable,operations:t.operations,filters:t.filters,tags:t.tags,rowKeys:t.rowKeys,pagination:t.pagination,tableData:t.tableData,rowClassName:t.rowClassName,loading:t.loading,memberIds:t.memberIds,checkable:t.checkable,isDepotOutNew:t.isDepotOutNew,checkedTable:t.checkedTable},on:{operate:t.operate,"row-click":t.rowClick,"filter-data-change":t.filterDataChange,"select-all":t.handleSelectAll,select:t.handleSelectionChange,"size-change":t.pageSizeChange,"current-change":t.currentPageChange,"cascader-change":t.cascaderChange,"active-item-change":t.activeItemChange,"sort-change":t.handleSortChange}},[t._t("default")],2),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.isClear?i("el-button",{attrs:{size:"small"},on:{click:t.clear}},[t._v("清除")]):t._e(),i("el-button",{attrs:{size:"small"},on:{click:t.close}},[t._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirmed}},[t._v("确定")])],1)],2)},n=[],o=(i("99af"),i("4160"),i("c975"),i("a434"),i("a9e3"),i("159b"),i("04d3")),s={name:"BizDialogSelector",components:{BizFlexTable:o["c"]},props:{selectionMode:{type:String,default:function(){return"multi"}},max:{type:Number,default:0},title:{require:!0,type:String,default:function(){return" "}},visibility:{require:!0,type:Boolean},appendToBody:{default:!0,type:Boolean},keyField:{type:String,default:function(){return"id"}},isClear:{default:!0,type:Boolean},rowClassName:{type:Function,default:function(){return null}},selectionKeys:{type:Array,default:function(){return[]}},memberIds:{type:Array,default:function(){return[]}},operations:{type:Array,default:function(){return[]}},filters:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){return{pageSize:20,currentPage:1,pageSizes:[10,20,50,100],total:0}}},isDepotOut:{type:Boolean,default:function(){return!1}},checkTable:{type:Array,default:function(){return[]}},showTable:{type:Boolean,default:function(){return!0}}},data:function(){return{dialogVisible:!1,innerSelectionKeys:[],isDepotOutNew:!1,checkedTable:[],innerSelection:[]}},methods:{rowKeys:function(t){return t.id},generateSelectionKeys:function(t,e){if(t.indexOf(e)>=0)this.innerSelectionKeys.push(e[this.keyField]),this.innerSelection.push(e);else{var i=this.innerSelectionKeys.indexOf(e[this.keyField]);this.innerSelectionKeys.splice(i,1),this.innerSelection.splice(i,1)}},open:function(t){this.innerSelectionKeys=this.selectionKeys.concat(),this.$emit("open",!1)},close:function(t){this.innerSelectionKeys=[],this.innerSelection=[],this.$emit("update:visibility",!1),this.$emit("close",!1)},confirmed:function(){if(this.innerSelectionKeys.length>0||!this.showTable){if(!this.showTable&&!/(http|https):\/\/([\w.]+\/?)\S*/.test(this.filters[2].value))return void this.$message.warning("必须以http,https开头,且需符合URL规范,检查格式是否正确");this.$emit("confirmed",this.innerSelectionKeys,this.innerSelection),this.dialogVisible=!1}else this.$message("请选择一项")},clear:function(){var t=this;this.tableData.forEach((function(e){t.$refs.table.toggleRowSelection(e,!1)})),this.innerSelectionKeys=[],this.innerSelection=[]},updateSelection:function(){var t=this;this.$refs&&this.$refs.table&&this.tableData.forEach((function(e){t.innerSelectionKeys.indexOf(e[t.keyField])>=0?(t.$refs.table.toggleRowSelection(e,!0),"single"===t.selectionMode&&(t.$refs.table.$refs.table.setCurrentRow(e),t.innerSelection=[e])):t.$refs.table.toggleRowSelection(e,!1)}))},operate:function(t){this.$emit("operate",t)},filterDataChange:function(t){this.$emit("filterDataChange",t)},handleSelectAll:function(t){var e=this;0===t.length?this.tableData.forEach((function(t){var i=e.innerSelectionKeys.indexOf(t[e.keyField]);i>=0&&e.innerSelectionKeys.splice(i,1)})):this.tableData.forEach((function(t){var i=e.innerSelectionKeys.indexOf(t[e.keyField]);i<0&&e.innerSelectionKeys.push(t[e.keyField])})),this.$emit("selectionChange",t)},handleSelectionChange:function(t,e){this.generateSelectionKeys(t,e),this.$emit("selectionChange",t)},pageSizeChange:function(t){this.$emit("pageSizeChange",t)},currentPageChange:function(t){this.$emit("currentPageChange",t)},cascaderChange:function(t){this.$emit("cascaderChange",t)},activeItemChange:function(t){this.$emit("active-item-change",t)},handleSortChange:function(t){this.$emit("sort-change",t)},rowClick:function(t,e,i){"single"===this.selectionMode&&(this.innerSelectionKeys=[t[this.keyField]],this.innerSelection=[t])}},watch:{visibility:function(t,e){this.dialogVisible=t,this.isDepotOutNew=this.isDepotOut,this.checkedTable=this.checkTable}},computed:{checkable:function(){return"single"!==this.selectionMode}},created:function(){},updated:function(){this.updateSelection()}},r=s,c=(i("0943"),i("2877")),l=Object(c["a"])(r,a,n,!1,null,null,null);e["a"]=l.exports},7132:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"biz-fade-t"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"biz-popup",on:{click:function(e){return e.target!==e.currentTarget?null:t.close(e)}}},[i("transition",{attrs:{name:"biz-fade-t-right"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"popup-content",style:t.contentStyle},[t._t("default")],2)])],1)])},n=[],o={name:"BizPopup",props:{open:{type:Boolean,default:function(){return!1}},contentStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},s=o,r=(i("5b8e"),i("2877")),c=Object(r["a"])(s,a,n,!1,null,null,null),l=c.exports,u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"biz-popup-tabs"},[i("biz-popup",{attrs:{open:t.open,contentStyle:t.contentStyle},on:{close:t.close}},[i("el-tabs",{attrs:{type:"border-card",value:t.value},on:{"tab-click":t.tabClick}},[t._t("default")],2)],1)],1)},d=[],f=(i("b0c0"),{name:"BizPopupTabs",data:function(){return{}},props:{open:{type:Boolean,default:!1},value:{type:String,required:!0},contentStyle:{type:Object,default:function(){return{}}}},components:{BizPopup:l},methods:{close:function(){var t=this;this.$confirm("是否保存当前页面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("close")}))},tabClick:function(t){this.$emit("input",t.name)}}}),p=f,h=(i("d4c2"),Object(r["a"])(p,u,d,!1,null,null,null)),m=h.exports;i.d(e,"a",(function(){return m}))},9678:function(t,e,i){},af3f:function(t,e,i){"use strict";var a=i("697f");e["a"]=a["a"]},b628:function(t,e,i){"use strict";var a=i("56e0"),n=i.n(a);n.a},bc4c:function(t,e,i){"use strict";var a=i("2732"),n=i.n(a);n.a},d4c2:function(t,e,i){"use strict";var a=i("e725"),n=i.n(a);n.a},e725:function(t,e,i){},f3ac:function(t,e,i){t.exports=i.p+"static/img/pic_default_none_100.6603f4ac.png"},f722:function(t,e,i){"use strict";var a=i("472a"),n=i.n(a);n.a}}]);